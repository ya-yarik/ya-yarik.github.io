(()=>{"use strict";var t,e,i,r={304418:(t,e,i)=>{i.d(e,{uiGetGallery:()=>o,UIGallery:()=>l});var r=i(257451),s=(0,r.makeSharedState)("ui-gallery",(()=>({galleries:{},incIndex:0})));function o(t){var e=domData(ge(t),"gallery-id");return e&&s().galleries[e]}class l{constructor(t,e){if(!t)throw new Error("No element was provided for UIGallery");if(t=ge(t),!hasClass(t,"ui_gallery"))throw new Error("Provided incorrect element for UIGallery");var i=o(t);if(i)return i;this._opts=extend({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1},e),this._id=s().incIndex,s().incIndex+=1,this._el=t,this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._itemWidth=getSize(this._items[0])[0],this._itemOffset=intval(getStyle(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=intval(getStyle(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=geByClass1("ui_gallery__inner_cont",this._el),this._inner=geByClass1("ui_gallery__inner",this._el),this._scroll=function(){var t={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return t;if(!cur._scrollInfo){var e=se('<div style="position: fixed; left: -1000; width: 0; overflow: scroll">x</div>');ge("content").appendChild(e);var i=e.scrollLeft;t.rtl=vk.rtl,t.backward=i>0,e.scrollLeft=1e3,t.delta=e.scrollLeft===i?-1:1,t.negative=!t.backward&&t.delta<0,t.rtlSame=t.rtl&&!t.backward&&!t.negative,re(e),cur._scrollInfo=t}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[]},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),domData(this._el,"gallery-id",this._id),s().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&addEvent(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this))}_initArrows(){this._opts.noArrows?addClass(this._el,"ui_gallery_no_arrows"):(this._leftArrow=geByClass1("ui_gallery__arrow_left",this._el),this._rightArrow=geByClass1("ui_gallery__arrow_right",this._el),this._arrowWidth=getSize(this._leftArrow)[0],addEvent(this._leftArrow,"click",this._onArrowScroll.bind(this,-1)),addEvent(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),addEvent(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),addEvent(this._rightArrow,"click",this._onArrowScroll.bind(this,1)),addEvent(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),addEvent(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(t){if(this._opts.scrollX||this._opts.scrollY){var e;if("wheel"==t.type)if(Math.abs(t.deltaY)>Math.abs(t.deltaX)){if(!this._opts.scrollY)return;e=-t.deltaY}else{if(!this._opts.scrollX)return;e=-t.deltaX}else if(void 0!==t.wheelDeltaY){if(!this._opts.scrollY)return;e=t.wheelDeltaY}else if(void 0!==t.wheelDelta)e=t.wheelDelta;else{if(!t.detail||1!==t.axis)return;e=-t.detail}e=this._scroll.rtlSame?-e:e,Math.abs(e)>=120&&(e=74*Math.max(-1,Math.min(1,e))),this._innerCont.scrollLeft-=e,this._checkItemsAfterScroll(this._innerCont.scrollLeft),cancelEvent(t)}}_onArrowScroll(t,e){if(!this._opts.noArrows){var i=this._innerCont.scrollLeft+(this._scroll.rtlSame?-t:t)*(this._width-2*this._arrowWidth),r=this._innerCont.scrollWidth-this._width;this._scroll.negative?(i=Math.min(i,0),i=Math.abs(i)):i=Math.max(0,i),i=Math.min(r,i);var s=this._scroll.negative||this._scroll.rtlSame?-t:t;if(s>0&&i<r)i=Math.floor(i/this._itemFullWidth)*this._itemFullWidth;else if(s<0&&i>0){i=Math.floor(i/this._itemFullWidth)*this._itemFullWidth}if(0===i||i===r){var o=this._innerCont.scrollWidth;addClass(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),i&&(i+=t*(this._innerCont.scrollWidth-o))}this._scroll.negative&&(i=-i),animate(this._innerCont,{scrollLeft:i},{duration:Math.abs(this._innerCont.scrollLeft-i)+50,transition:Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(i),setTimeout((()=>removeClass(this._inner,"ui_gallery__inner_shift_instant")),0),cancelEvent(e)}}_checkItemsAfterScroll(t,e){if(this._scroll.negative&&(t=Math.abs(t)),this._opts.markOutside||this._opts.onViewItem){var i,r=this._itemWidth/3,s=(this._scroll.backward?this._inner.scrollWidth-this._width-t:t)-this._scrollOffset,o=t&&Math.floor(s/this._itemFullWidth),l=o*this._itemFullWidth+2*r;i=this._scroll.backward?t+this._width<this._inner.scrollWidth-l:t>l;var n,a=Math.min(this._items.length-1,Math.floor((s+this._width)/this._itemFullWidth)),h=a*this._itemFullWidth+2*r;if(n=this._scroll.backward?t>this._inner.scrollWidth-h:t+this._width<h,this._opts.onViewItem){var _=i?Math.min(this._items.length-1,o+1):o,d=n?Math.max(0,a-1):a;if(e||_!==this._visible.left||d!==this._visible.right){for(var c=_;c<=d;c++)(this._visible.left<0||e&&!inArray(this._items[c],this._visible.items)||c<this._visible.left||c>this._visible.right)&&this._opts.onViewItem(this._items[c],c);this._visible.left=_,this._visible.right=d,this._visible.items=this._items.slice(_,d+1)}}this._opts.markOutside&&(e?(geByClass("ui_gallery_item_outside",this._inner).forEach((t=>{removeClass(t,"ui_gallery_item_outside")})),this._outside.left=-1,this._outside.right=-1):((o!==this._outside.left||!i)&&this._outside.left>=0&&(removeClass(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(a!==this._outside.right||!n)&&this._outside.right>=0&&(removeClass(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),i&&o!==this._outside.left&&(addClass(this._items[o],"ui_gallery_item_outside"),this._outside.left=o),n&&a!==this._outside.right&&(addClass(this._items[a],"ui_gallery_item_outside"),this._outside.right=a))}if(!this._opts.noArrows){var u=t>0,f=t+this._width<this._inner.scrollWidth;toggleClass(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?f:u),toggleClass(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?u:f)}(!this._scroll.backward&&this._inner.scrollWidth-t-this._width<1e3||this._scroll.backward&&t<1e3)&&this._onLoadMore()}_onArrowMouseOver(t){this._opts.noArrows||addClass(this._inner,"ui_gallery__inner_shift_"+t)}_onArrowMouseOut(){this._opts.noArrows||(removeClass(this._inner,"ui_gallery__inner_shift_left"),removeClass(this._inner,"ui_gallery__inner_shift_right"))}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(t,e){t=t||[],this.addItems(t),this._finised=!!e||!t.length,this._loadingMore=!1}addItems(t,e){if((t=t||[]).length){var i=e>=0&&e<this._items.length?this._items[e]:null;t.forEach((t=>{i?domInsertBefore(t,i):this._inner.appendChild(t)})),this.refresh()}}destroy(){removeEvent(this._innerCont),removeEvent(this._leftArrow),removeEvent(this._rightArrow),domData(this._el,"gallery-id",null),delete s().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),re(this._el)}removeItem(t){return isNumeric(t)&&(t=this._items[t]),!(!t||!inArray(t,this._items))&&(re(t),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}getItems(){return this._items}getVisibleItems(){return this._visible.items.map(((t,e)=>[t,this._visible.left+e]))}}},294071:(t,e,i)=>{i.d(e,{default:()=>o});const r=new WeakMap;function s(t,e,i,s){var o,l;if(!t&&!r.has(e))return!1;const n=null!==(o=r.get(e))&&void 0!==o?o:new WeakMap;if(r.set(e,n),!t&&!r.has(e))return!1;const a=null!==(l=n.get(i))&&void 0!==l?l:new Set;n.set(i,a);const h=a.has(s);return t?a.add(s):a.delete(s),h&&t}const o=function t(e,i,r,o,l){if("string"==typeof e&&(e=document.querySelectorAll(e)),"function"!=typeof e.addEventListener){const s=Array.prototype.map.call(e,(e=>t(e,i,r,o,l)));return{destroy(){s.forEach((t=>t.destroy()))}}}const n=e,a=Boolean("object"==typeof l?l.capture:l),h=t=>{const e=t.target.closest(i);e&&(t.delegateTarget=e,t.currentTarget.contains(t.delegateTarget)&&o.call(n,t))},_=JSON.stringify({selector:i,type:r,capture:a}),d={destroy(){n.removeEventListener(r,h,l),s(!1,n,o,_)}};return s(!0,n,o,_)||n.addEventListener(r,h,l),d}},938871:(t,e,i)=>{var r=i(622909);window.GroupsLikeFeedBlock=new r.GroupsLikeFeedBlock;try{window.stManager.done(window.jsc("web/groups_like_feed_block.js"))}catch(t){}},622909:(t,e,i)=>{i.d(e,{GroupsLikeFeedBlock:()=>_});var r,s=i(304418),o=i(294071),l=i(64385),n=i(116886),a=i(124961),h=i(873078);!function(t){t.BLOCK_SEEN="block_seen",t.BLOCK_HIDDEN="block_hidden",t.BLOCK_EXPANDED="block_expanded",t.GROUP_SEEN="group_seen",t.GROUP_HIDDEN="group_hidden",t.GROUP_SUBSCRIBED="group_subscribed",t.GROUP_OPENED="group_opened"}(r||(r={}));var _=function(){var t=this;this.blockTrackCode="",this.statName="",this.ref="",this.hideBlockHash="",this.init=function(e){var i,l,n,a,h,_,d,c=document.querySelector(".groups_like_gallery");if(c){t.galleryElement=c;var u=c.closest(".page_block");if(u){t.pageBlock=u,t.blockTrackCode=t.pageBlock.dataset.blockTrackCode||"",t.statName=e.statName||"",t.ref=e.ref||"",t.hideBlockHash=e.hideBlockHash||"",t.gallery=new s.UIGallery(c,{scrollY:!1}),null===(i=window.cur.destroy)||void 0===i||i.push((function(){var e;return null===(e=t.gallery)||void 0===e?void 0:e.destroy()}));var f=(0,o.default)(c,".wall_card__button","click",t.onSubscribeButtonClick).destroy;null===(l=window.cur.destroy)||void 0===l||l.push(f);var g=(0,o.default)(c,".wallCardGroupsLikes__friendPhotosText","click",t.onFriendsShowButtonClick).destroy;null===(n=window.cur.destroy)||void 0===n||n.push(g);var v=(0,o.default)(c,".wall_card__close","click",t.onGroupHideButtonClick).destroy;null===(a=window.cur.destroy)||void 0===a||a.push(v);var p=(0,o.default)(c,".ui_gallery_item","click",t.onGroupOpen).destroy;null===(h=window.cur.destroy)||void 0===h||h.push(p);var m=u.querySelector(".feed_groups_likes_block__hide");m&&(m.addEventListener("click",t.onHideBlockClick),null===(_=window.cur.destroy)||void 0===_||_.push((function(){return m.removeEventListener("click",t.onHideBlockClick)})));var w=u.querySelector(".feed_groups_likes_block__all");w&&(w.addEventListener("click",t.onShowAllButtonClick),null===(d=window.cur.destroy)||void 0===d||d.push((function(){return w.removeEventListener("click",t.onShowAllButtonClick)}))),t.logEvent(r.BLOCK_SEEN,{trackCode:t.blockTrackCode}),t.logSeenGroups()}}},this.onHideBlockClick=function(){if(t.pageBlock){t.pageBlock.style.display="none";var e={act:"a_hide_groups_like_block",track_code:t.pageBlock.dataset.blockTrackCode,hash:t.hideBlockHash};l.ajax.post("al_groups.php",e),t.logEvent(r.BLOCK_HIDDEN,{trackCode:t.blockTrackCode})}},this.onShowAllButtonClick=function(){t.logEvent(r.BLOCK_EXPANDED,{trackCode:t.blockTrackCode})},this.onGroupOpen=function(e){var i=e.target;if(i instanceof HTMLElement&&!(i.closest(".wall_card__close")||i.closest(".wallCardGroupsLikes__friendPhotosText")||i.closest(".wall_card__button"))){var s=i.closest(".ui_gallery_item");if(s instanceof HTMLElement){var o=s.dataset.groupId,l=s.dataset.groupTrackCode;void 0!==l&&t.logEvent(r.GROUP_OPENED,{trackCode:l,groupId:o})}}},this.onFriendsShowButtonClick=function(t){t.preventDefault();var e=t.target;if(e instanceof HTMLElement){var i=null==e?void 0:e.closest(".ui_gallery_item");if(i instanceof HTMLElement){var r="-"+i.dataset.groupId;window.Page.showPageMembers(t,r,"friends_likes")}}},this.onGroupHideButtonClick=function(e){var i;e.preventDefault();var s=e.target;if(s instanceof HTMLElement){var o=null==s?void 0:s.closest(".ui_gallery_item");if(o instanceof HTMLElement){var n=o.dataset.groupId,a=o.dataset.groupTrackCode,h={act:"a_hide_groups_like_block_community",group_id:n,track_code:a,hash:o.dataset.groupHideHash};null===(i=t.gallery)||void 0===i||i.removeItem(o),l.ajax.post("al_groups.php",h),void 0!==a&&t.logEvent(r.GROUP_HIDDEN,{trackCode:a,groupId:n})}}},this.onSubscribeButtonClick=function(e){e.preventDefault();var i=e.target;if(i instanceof HTMLElement){var s=i.closest(".wall_card__button");if(s instanceof HTMLElement){var o=s.closest(".ui_gallery_item");if(o instanceof HTMLElement){var a=!s.classList.contains("FlatButton--"+h.FlatButtonAppearance.SECONDARY),_=o.dataset.groupId,d=o.dataset.groupTrackCode,c={act:a?"a_enter":"a_leave",pid:_,hash:o.dataset.subscribeHash,ref:t.ref};l.ajax.post("al_public.php",c,{onDone:function(){a?(h.FlatButton.setLabel(s,(0,n.getLang)("news_recommend_subscribed")),h.FlatButton.setAppearance(s,h.FlatButtonAppearance.SECONDARY)):(h.FlatButton.setLabel(s,(0,n.getLang)("global_share_button_join_public")),h.FlatButton.setAppearance(s,h.FlatButtonAppearance.PRIMARY))},showProgress:function(){return h.FlatButton.lock(s)},hideProgress:function(){return h.FlatButton.unlock(s)}}),a&&void 0!==d&&t.logEvent(r.GROUP_SUBSCRIBED,{trackCode:d,groupId:_})}}}},this.logSeenGroups=function(){var e;null===(e=t.gallery)||void 0===e||e.getItems().forEach((function(e){var i=e.dataset.groupTrackCode,s=e.dataset.groupId;void 0!==i&&void 0!==s&&t.logEvent(r.GROUP_SEEN,{trackCode:i,groupId:s})}))},this.logEvent=function(e,i){var r;(0,a.saveStatlogEvents)({name:t.statName,value:e,keys:[i.trackCode,null!==(r=i.groupId)&&void 0!==r?r:0]})}}}},s={};function o(t){var e=s[t];if(void 0!==e)return e.exports;var i=s[t]={id:t,loaded:!1,exports:{}};return r[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=r,t=[],o.O=(e,i,r,s)=>{if(!i){var l=1/0;for(_=0;_<t.length;_++){for(var[i,r,s]=t[_],n=!0,a=0;a<i.length;a++)(!1&s||l>=s)&&Object.keys(o.O).every((t=>o.O[t](i[a])))?i.splice(a--,1):(n=!1,s<l&&(l=s));if(n){t.splice(_--,1);var h=r();void 0!==h&&(e=h)}}return e}s=s||0;for(var _=t.length;_>0&&t[_-1][2]>s;_--)t[_]=t[_-1];t[_]=[i,r,s]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var s=Object.create(null);o.r(s);var l={};e=e||[null,i({}),i([]),i(i)];for(var n=2&r&&t;"object"==typeof n&&!~e.indexOf(n);n=i(n))Object.getOwnPropertyNames(n).forEach((e=>l[e]=()=>t[e]));return l.default=()=>t,o.d(s,l),s},o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={9521:0};o.O.j=e=>0===t[e];var e=(e,i)=>{var r,s,[l,n,a]=i,h=0;for(r in n)o.o(n,r)&&(o.m[r]=n[r]);if(a)var _=a(o);for(e&&e(i);h<l.length;h++)s=l[h],o.o(t,s)&&t[s]&&t[s][0](),t[l[h]]=0;return o.O(_)},i=self.webpackChunkvk=self.webpackChunkvk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var l=o.O(void 0,[8592],(()=>o(938871)));l=o.O(l)})();