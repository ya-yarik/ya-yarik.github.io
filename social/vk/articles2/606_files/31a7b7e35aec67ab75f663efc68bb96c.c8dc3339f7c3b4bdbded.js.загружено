(self.webpackChunkvk=self.webpackChunkvk||[]).push([[8102],{857803:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var n=a(667294),o=a(887854),r=a.n(o),s=a(408091),i=a(634777),l=a(379333),c="0 0 16 16",p="article_outline_16",d=!1;function u(){d||((0,i.addSpriteSymbol)(new(r())({id:p,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="article_outline_16"><path d="M13.182 3.5c.452 0 .818.336.818.75 0 .38-.308.693-.707.743L13.182 5H2.818C2.366 5 2 4.664 2 4.25c0-.38.308-.693.707-.743l.111-.007zm0 4c.452 0 .818.336.818.75 0 .38-.308.693-.707.743L13.182 9H2.818C2.366 9 2 8.664 2 8.25c0-.38.308-.693.707-.743l.111-.007zm-3.727 4c.3 0 .545.336.545.75 0 .38-.205.694-.471.743L9.455 13h-6.91c-.3 0-.545-.336-.545-.75 0-.38.205-.694.471-.743l.074-.007z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,i.useIsomorphicLayoutEffect)((function(){u()}),[]),n.createElement(l.SvgIcon,(0,s.assign)({},e,{viewBox:c,id:p,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=u;const h=_},627155:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var n=a(667294),o=a(887854),r=a.n(o),s=a(408091),i=a(634777),l=a(379333),c="0 0 16 16",p="block_16",d=!1;function u(){d||((0,i.addSpriteSymbol)(new(r())({id:p,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="block_16"><path clip-rule="evenodd" d="M8 16A8 8 0 108 0a8 8 0 000 16zm0-1.5A6.5 6.5 0 012.904 3.965l9.131 9.131A6.472 6.472 0 018 14.5zM14.5 8A6.5 6.5 0 003.965 2.904l9.131 9.131A6.472 6.472 0 0014.5 8z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var _=function(e){return(0,i.useIsomorphicLayoutEffect)((function(){u()}),[]),n.createElement(l.SvgIcon,(0,s.assign)({},e,{viewBox:c,id:p,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=u;const h=_},394478:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var n=a(667294),o=a(887854),r=a.n(o),s=a(408091),i=a(634777),l=a(379333),c="0 0 16 16",p="cancel_16",d=!1;function u(){d||((0,i.addSpriteSymbol)(new(r())({id:p,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="cancel_16"><g fill="none" fill-rule="evenodd"><path d="M0 0h16v16H0z" /><path d="M8 6.727l3.464-3.463a.9.9 0 111.272 1.272L9.273 8l3.463 3.464a.9.9 0 11-1.272 1.272L8 9.273l-3.464 3.463a.9.9 0 11-1.272-1.272L6.727 8 3.264 4.536a.9.9 0 011.272-1.272L8 6.727z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var _=function(e){return(0,i.useIsomorphicLayoutEffect)((function(){u()}),[]),n.createElement(l.SvgIcon,(0,s.assign)({},e,{viewBox:c,id:p,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=u;const h=_},259694:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var n=a(667294),o=a(887854),r=a.n(o),s=a(408091),i=a(634777),l=a(379333),c="0 0 16 16",p="help_outline_16",d=!1;function u(){d||((0,i.addSpriteSymbol)(new(r())({id:p,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="help_outline_16"><g fill="currentColor"><path clip-rule="evenodd" d="M8 14.5a6.5 6.5 0 100-13 6.5 6.5 0 000 13zM8 16A8 8 0 108 0a8 8 0 000 16z" fill-rule="evenodd" /><path d="M7.972 9.598c.376 0 .583-.21.662-.572.07-.454.228-.686.933-1.102.746-.449 1.133-1.005 1.133-1.82 0-1.26-1.012-2.102-2.516-2.102-1.139 0-1.986.46-2.325 1.172-.106.206-.159.41-.159.643 0 .41.26.675.678.675.323 0 .561-.151.694-.497.17-.48.519-.74 1.038-.74.583 0 .985.368.985.897 0 .497-.206.767-.89 1.183-.625.373-.948.794-.948 1.431v.076c0 .443.265.756.715.756zm.01 2.404a.853.853 0 00.87-.848.853.853 0 00-.87-.848.851.851 0 00-.863.848c0 .475.387.848.864.848z" /></g></symbol>'})),d=!0)}var _=function(e){return(0,i.useIsomorphicLayoutEffect)((function(){u()}),[]),n.createElement(l.SvgIcon,(0,s.assign)({},e,{viewBox:c,id:p,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=u;const h=_},395779:(e,t,a)=>{"use strict";a.d(t,{getLexedHTML:()=>n,checkSyntax:()=>o,dictionaryLookup:()=>r,getSyntaxBlockIndex:()=>s});a(991181),a(296253),a(21466),a(59357);function n(e){for(var t="",a=0;a<e.length;a++)switch(e[a].type){case"space":t+='<span class="Input__space">'+e[a].text+"</span>";break;case"field":t+='<span class="Input__field">'+e[a].text+"</span>";break;case"text_start":t+='<span class="Input__textStart">'+e[a].text+"</span>";break;case"text":t+='<span class="Input__text">'+e[a].text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</span>";break;case"text_end":t+='<span class="Input__textEnd">'+e[a].text+"</span>";break;case"operator":t+='<span class="Input__operator">'+e[a].text+"</span>";break;case"comma":t+='<span class="Input__comma">'+e[a].text+"</span>";break;case"function":t+='<span class="Input__function">'+e[a].text+"</span>";break;case"number":t+='<span class="Input__number">'+e[a].text+"</span>";break;case"block_start":t+='<span class="Input__blockStart">'+e[a].text+"</span>";break;case"block_end":t+='<span class="Input__blockEnd">'+e[a].text+"</span>";break;default:t+='<span class="Input__genericText">'+e[a].text+"</span>"}return t}function o(e,t,a){for(var n=function(e){for(var t=[],a=[],n=[],o=null,r=0,s=0;s<e.length;s++){switch(e[s]){case" ":case"\n":o="space";break;case"@":o="function";break;case"(":o="block_start";break;case")":o="block_end";break;case"&":case"|":case"!":case"~":case"+":case"-":case"*":case"/":case"%":case"<":case">":case"=":case"^":o="operator";break;case",":o="comma";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":case".":o="number";break;case"'":switch(a[r]){case"text":case"text_start":o="text_end";break;default:o="text_start"}break;default:o="field"}s?"text"!==a[r]&&"text_start"!==a[r]||"text_end"===o?"function"===a[r]&&"field"===o?(a[r]="function",t[r]+=e[s]):a[r]!==o||"block_start"===a[r]||"block_end"===a[r]?(t[++r]=e[s],a[r]=o):t[r]+=e[s]:(a[r]="text",t[r]+=e[s]):(t[r]=e[s],a[r]=o)}for(var i=0;i<t.length;i++)n[i]={text:t[i],type:a[i]};return n}(e),o=0;o<n.length;o++)switch(n[o].type){case"field":t.fields[a]&&(t.common_fields.hasOwnProperty(n[o].text)||t.fields[a].hasOwnProperty(n[o].text))||(n[o].type="generic_text"),"IN"===n[o].text&&(o>0&&"space"===n[o-1].type?(n.splice(o,1),n[o-1].text=" IN",n[o-1].type="operator",o++):n[o].type="operator");break;case"text_end":n[o].type="text",n[o].text=n[o-1].text+"'",n.splice(o-1,1);break;case"function":for(var r=n[o].text,s=[],i=void 0,l=0;r.length>0;){if(/(@.+?)\b/.test(r)){i=r.match(/(@.+?)\b/)[0];for(var c=0;c<t.functions.length;c++)~i.indexOf(t.functions[c])&&(r=r.slice(t.functions[c].length),s.push({text:t.functions[c],type:"function"}))}s.length>l?l++:(t.common_fields.hasOwnProperty(r)||t.fields[a].hasOwnProperty(r)?s.push({text:r,type:"field"}):s.push({text:r,type:"generic_text"}),r="")}s.length>0&&n.splice.apply(n,[o,1].concat(s));break;case"operator":var p=void 0;~["&&!","&&-","&&~","||!","||-","||~"].indexOf(n[o].text)&&(p=n[o].text,n[o].text=n[o].text.slice(0,2),n.splice(o+1,0,{text:p.slice(-1),type:"operator"}))}return n}function r(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=[],r=[];"functions"===t?r=a[t]:"fields"===t&&a[t][n]&&(r=Object.keys(a[t][n]).concat(Object.keys(a.common_fields)));for(var s=0;s<e.length;s++){for(var i=0;i<r.length;i++)e.slice(0,s+1)===r[i].slice(0,s+1)&&o.push(r[i]);r=o.slice(0),o=[]}return r}function s(e,t){for(var a=0,n=0;n<e.length;n++)if((a+=e[n].text.length)>=t)return n;return 0}},953414:(e,t,a)=>{"use strict";a.d(t,{getNewCondition:()=>n});a(820075);function n(e){return function(e){var t,a,n,r,s,i,l,c=[],p=!1;function d(e){this.pos=e.pos,this.field=e.field,this.operation=e.operation,this.value=e.value,this.isIN=e.isIN||!1,this.fieldIsExp=e.fieldIsExp||!1}for(var u=0;u<e.length;u++)if("single"===e[u].type&&"unknown"!==e[u].expType)switch(e[u].expType){case"equals":case"equalsNot":(t=[])[0]=o(e[u].expRightSide),n=o(e[u].expLeftSide),e[u].expLeftSide.length>1&&(p=!0),c.push(new d({pos:u,field:n,operation:e[u].expType,value:t,isIN:!1,fieldIsExp:p}));break;case"inList":if(i=e[u].expLeftSide,l=e[u].expRightSide,s=[],a=[],"!"===i[0].text&&")"===l[l.length-1].text&&")"===l[l.length-2].text?(r="equalsNot",s=l,i.length>1&&"("===i[2].text&&")"===i[i.length-1].text?(p=!0,n=o(i).slice(3).slice(0,-1)):n=o(i).slice(2)):(r="equals",s=l,i.length>1&&"("===i[0].text&&")"===i[i.length-1].text?(p=!0,n=o(i).slice(1).slice(0,-1)):n=o(i)),s.length>0){for(var _=0;_<s.length;_++)switch(s[_].type){case"operator":_<s.length-1&&"-"===s[_].text&&"number"===s[_+1].type&&(a.push("-"+s[_+1].text),_++);break;case"number":a.push(s[_].text)}c.push(new d({pos:u,field:n,operation:r,value:a,isIN:!0,fieldIsExp:p}))}}function h(e,t,a){this.field=e,this.operation=t,this.blocks=[],this.blocks.push(a)}for(var m=[],g=0;g<c.length;g++)e:if(0===m.length)m.push(new h(c[g].field,c[g].operation,c[g]));else{for(var f=0;f<m.length;f++)if(m[f].field===c[g].field){m[f].blocks.push(c[g]);break e}m.push(new h(c[g].field,c[g].operation,c[g]))}for(var v=[],b=0;b<m.length;b++)m[b].blocks.length>1&&function(){for(var t={equals:new d({pos:null,field:m[b].blocks[0].field,operation:"equals",value:[],isIN:!0,fieldIsExp:m[b].blocks[0].fieldIsExp}),equalsNot:new d({pos:null,field:m[b].blocks[0].field,operation:"equalsNot",value:[],isIN:!0,fieldIsExp:m[b].blocks[0].fieldIsExp})},a=0;a<m[b].blocks.length;a++){var n=t[m[b].blocks[a].operation];if(null===n.pos&&(n.pos=m[b].blocks[a].pos),0===n.value.length)n.value=m[b].blocks[a].value;else for(var o=0;o<m[b].blocks[a].value.length;o++)n.value.includes(m[b].blocks[a].value[o])||n.value.push(m[b].blocks[a].value[o]),v.includes(m[b].blocks[a].pos)||v.push(m[b].blocks[a].pos)}t.equals.value=t.equals.value.filter((function(e,a){return t.equals.value.indexOf(e)===a})),t.equalsNot.value=t.equalsNot.value.filter((function(e,a){return t.equalsNot.value.indexOf(e)===a}));var r=[],s=[];if(null!==t.equals.pos&&null!==t.equalsNot.pos){for(var i=0;i<t.equalsNot.value.length;i++){var l=t.equals.value.indexOf(t.equalsNot.value[i]);~l&&(r.push(l),s.push(i))}r.sort((function(e,t){return t-e})),s.sort((function(e,t){return t-e}));for(var c=0;c<r.length;c++)t.equals.value.splice(r[c],1);for(var p=0;p<s.length;p++)t.equalsNot.value.splice(s[p],1)}var u=e[t.equals.pos],_=e[t.equalsNot.pos];null!==t.equals.pos&&(t.equals.value.length>1?(t.equals.fieldIsExp&&(t.equals.field="("+t.equals.field+")"),u.text=t.equals.field+" IN ("+t.equals.value.join(", ")+") "):1===t.equals.value.length?u.text=t.equals.field+" = "+t.equals.value[0]:0===t.equals.value.length&&(v.includes(t.equals.pos)||v.push(t.equals.pos)),0!==t.equals.pos&&(u.text=" "+u.logicOp+" "+u.text)),null!==t.equalsNot.pos&&(t.equalsNot.value.length>1?(t.equalsNot.fieldIsExp&&(t.equalsNot.field="("+t.equalsNot.field+")"),_.text="!("+t.equalsNot.field+" IN ("+t.equalsNot.value.join(", ")+")) "):1===t.equalsNot.value.length?_.text=t.equalsNot.field+" != "+t.equalsNot.value[0]:0===t.equalsNot.value.length&&(v.includes(t.equalsNot.pos)||v.push(t.equalsNot.pos)),0!==t.equalsNot.pos&&(_.text=" "+_.logicOp+" "+_.text))}();v.sort((function(e,t){return t-e}));for(var y=0;y<v.length;y++)e.splice(v[y],1);for(var k="",x=0;x<e.length;x++)k+=e[x].text;k.startsWith(" && ")&&(k=k.slice(4));return k}(function(e){if(!e)return;function t(e,t,a){this.type=e,this.logicOp=t,this.content=a,this.text="",this.level=0}var a=[],n=0,o=0;a[n]=new t("single","&&",[]);for(var r=0;r<e.length;r++)switch(!0){case"space"===e[r].type:a[n].text+=e[r].text;break;case"block_start"===e[r].type:a[n].hasOpenBrace=!0,o+=e[r].text.length,a[n].content.push(e[r]),a[n].text+=e[r].text;break;case"block_end"===e[r].type:a[n].hasClosedBrace=!0,o-=e[r].text.length,a[n].content.push(e[r]),a[n].text+=e[r].text;break;case("&&"===e[r].text||"||"===e[r].text)&&0===o:a[++n]=new t("single",e[r].text,[]),a[n].text+=e[r].text;break;case("&&"===e[r].text||"||"===e[r].text)&&o>0:a[n].content.push(e[r]),a[n].type="compound",a[n].text+=e[r].text;break;default:a[n].content.push(e[r]),a[n].text+=e[r].text}for(var s=0;s<a.length;s++)if("single"===a[s].type)for(var i=0;i<a[s].content.length;i++){switch(a[s].content[i].text){case"=":case"==":a[s].expType="equals";break;case"!=":case"&lt;&gt;":a[s].expType="equalsNot";break;case" IN":a[s].expType="inList"}if(~["equals","equalsNot","inList"].indexOf(a[s].expType)){a[s].expOperator=a[s].content[i].text,a[s].expLeftSide=a[s].content.slice(0,i),a[s].expRightSide=a[s].content.slice(i+1);break}}return a}(e))}function o(e){for(var t="",a=0;a<e.length;a++)t+=e[a].text;return t}},231451:(e,t,a)=>{"use strict";function n(e){var t,a=window.getSelection();if(a&&a.focusNode){var n,o,r,s,i,l=Array.prototype.slice.call(e.childNodes),c=null===(t=a.anchorNode)||void 0===t?void 0:t.parentNode,p=l.indexOf(c),d=a.focusOffset,u=0,_=0;if("Range"===a.type&&(n=a.getRangeAt(0),o=l.indexOf(n.startContainer.parentNode),r=l.indexOf(n.endContainer.parentNode),s=n.startOffset,i=n.endOffset,d=s,p=o),p){for(var h=0;h<p;h++)u+=l[h].textContent.length;u+=d}else 0===p&&(u=d);if(r&&r>=0){for(var m=r;m<l.length;m++)m===r?_=l[r].textContent.length-i:_+=l[m].textContent.length;_=e.innerText.length-_}else 0===r&&(_=i);return{startIndex:p,offset:d,textStart:u,textEnd:_,type:a.type,rangeStartIndex:o,rangeEndIndex:r,rangeStartOffset:s,rangeEndOffset:i}}}function o(e,t){if(void 0!==e.startIndex&&-1!==e.startIndex){var a=window.getSelection(),n=e,o=document.createRange();t&&(o.setStart(t.childNodes[n.startIndex].firstChild,n.offset),a.removeAllRanges(),a.addRange(o))}}function r(e,t,a){if(e>=t||-1===e){if(0===t)return;var n=a.childNodes.length-1;o({offset:a.childNodes[n].textContent.length,startIndex:n},a)}else{for(var r,s,i=0,l=0;l<a.childNodes.length;l++)if((i+=a.childNodes[l].textContent.length)>=e){r=l,s=e-(i-a.childNodes[l].textContent.length);break}o({offset:s,startIndex:r},a)}}function s(e,t,a){for(var n=0,o=e.rangeEndIndex-e.rangeStartIndex,r="",s="",i=0,l=0;l<o;l++)n+=t.childNodes[e.rangeStartIndex+l].textContent.length;n+=e.rangeEndOffset-e.rangeStartOffset;for(var c=0;c<e.rangeStartIndex;c++)i+=t.childNodes[c].textContent.length;i+=e.rangeStartOffset;for(var p=0;p<i;p++)r+=a[p];for(var d=i+n;d<a.length;d++)s+=a[d];return{textStart:i,textBefore:r,textAfter:s}}a.d(t,{get:()=>n,setByOffset:()=>r,handleRange:()=>s})},432338:(e,t,a)=>{"use strict";a.r(t),a.d(t,{NOSPAM_TEXT_FIELD:()=>l,noSpamPatterns:()=>n.noSpamPatterns,abortPatternMild:()=>n.abortPatternMild,noSpamSuspicious:()=>o.noSpamSuspicious,noSpamTemplates:()=>r.noSpamTemplates,dealSingleSpamer:()=>s.dealSingleSpamer,reportsTime:()=>s.reportsTime,onFiltersChange:()=>s.onFiltersChange,rollbackDocMailSpamer:()=>i.rollbackDocMailSpamer,rollbackDocWallSpamer:()=>i.rollbackDocWallSpamer,rollbackJpgMailSpamer:()=>i.rollbackJpgMailSpamer,rollbackJpgWallSpamer:()=>i.rollbackJpgWallSpamer,rollbackPngMailSpamer:()=>i.rollbackPngMailSpamer,rollbackPngWallSpamer:()=>i.rollbackPngWallSpamer,rollbackDocSpamer:()=>i.rollbackDocSpamer,rollbackPhotoSpamer:()=>i.rollbackPhotoSpamer,rollbackPhotoSpamerFromWall:()=>i.rollbackPhotoSpamerFromWall,rollbackPhotoSpamerFromMail:()=>i.rollbackPhotoSpamerFromMail,rollbackVideoSpamer:()=>i.rollbackVideoSpamer,rollbackVideoSpamerFromWall:()=>i.rollbackVideoSpamerFromWall,rollbackVideoSpamerFromMail:()=>i.rollbackVideoSpamerFromMail,entityDecode:()=>c,selectText:()=>p,removeSelectedText:()=>d,getSelectedText:()=>u,selectValue:()=>_,blockDomain:()=>h,removeFidSearch:()=>m,banFidZero:()=>g,banFidForever:()=>f,isClaimContent:()=>v,getFieldName:()=>b});var n=a(690864),o=a(752988),r=a(320902),s=a(936714),i=a(450020),l="_console_item_field_text";function c(e){return se("<textarea>"+e+"</textarea>").value}function p(e){var t=document,a=t.getElementById(e);if(t.body.createTextRange)(n=t.body.createTextRange()).moveToElementText(a),n.select();else if(window.getSelection){var n,o=window.getSelection();(n=t.createRange()).selectNodeContents(a),o.removeAllRanges(),o.addRange(n)}}function d(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function u(){var e="";return window.getSelection?e=window.getSelection():document.getSelection?e=document.getSelection():document.selection&&(e=document.selection.createRange().text),e}function _(e){var t=ge(e);return t.options[t.selectedIndex].value}function h(e,t,a,n){ajax.post("noSpam.php",{act:"a_block_domain",domain:e,type:t,hash:a,warn_users:isChecked("warn_users")||0,comment:ge("linksban_comment").value,link_ex:n},{onDone:function(a){ge("block_domain_1_"+e).innerHTML="",ge("block_domain_2_"+e).innerHTML="",ge("block_domain_3_"+e).innerHTML="",ge("block_domain_"+t+"_"+e).innerHTML=a}})}function m(e,t){ajax.post("noSpam.php",{act:"a_remove_fid_search",fid:e,hash:t},{onDone:function(t){ge("remove_fid_search_"+e).innerHTML=t}})}function g(e,t){ajax.post("noSpam.php",{act:"a_ban_fid_zero",fid:e,hash:t},{onDone:function(t){ge("ban_fid_zero_"+e).innerHTML=t}})}function f(e,t){ajax.post("noSpam.php",{act:"a_ban_fid_forever",fid:e,hash:t},{onDone:function(t){ge("ban_fid_forever_"+e).innerHTML=t}})}function v(){return window.nav&&window.nav.objLoc&&window.nav.objLoc.claim}function b(e){var t=domClosest(l,e);return!!t&&t.getAttribute("data-field")}},969211:(e,t,a)=>{"use strict";a.d(t,{init:()=>d,isEnabled:()=>u});var n=a(667294),o=a(973935),r=a(40897),s=a(460378),i=a(486353),l=a(93716),c=a(897557),p=a(516883);function d(e,t){if(u()){var a=JSON.parse(e),i=JSON.parse(t);["","2"].forEach((e=>{var t="ConditionsEditor"+e,d="uiSpamtype"+e;(0,r.registerReactApplication)(t,(e=>{o.render(n.createElement(s.ConditionsEditor,{initialText:(0,c.decodeHTMLEntities)(e.currentText),isTextStored:e.isTextStored,partIndex:e.partIndex,syntaxDictionary:a,mainTextFields:i,initialSection:cur[d].val(),ref:e=>window[t]=e,helpFunction:window.noSpamConsole.getConditionsHint,conditionsOnlyFunction:l.clearAllExceptConditions,useMonospace:(0,p.getCustomOption)("conditions_monospace")}),document.getElementById(r.rootId+t))}))}))}}function u(){return(0,i.partConfigEnabled)("nospam_use_new_conditions_editor")}},93716:(e,t,a)=>{"use strict";a.d(t,{CONSOLE_CUSTOM_NUM_FIELD:()=>w,init:()=>C,getParams:()=>I,setIp:()=>F,setUaHash:()=>j,setConditions:()=>A,setThreshold:()=>$,composeSearchLinkFromParams:()=>R,getNumericField:()=>U,getConditionsHint:()=>z,switchParams:()=>Q,conditionsClear:()=>Y,clearAllExceptConditions:()=>G,optionClear:()=>X,addPatternPart:()=>ee,mount:()=>oe});a(59357),a(820075),a(991181),a(296253),a(530522),a(21466);var n,o,r,s=a(533246),i=a(936714),l=a(516883),c=a(442699),p=a(535566),d=a(432338),u=a(969211),_=1576215,h=138305184,m=163176673,g="console_locked",f="_apply_pattern",v="_search_reports",b="debug_pattern",y="_queries_toggle",k="console_show_message",x="nospam_console_custom_num_condition",S="highlighted",w="custom";function C(e){var t=e.conditions;t&&(ls.set(J(""),t),addClass(geByClass("conditions_clear_button")[0],S));var a=e.conditions2;a&&(ls.set(J("2"),a),addClass(geByClass("conditions_clear_button")[1],S))}function T(){return hasClass(l.consoleWrap,g)}function E(){T()||addClass(l.consoleWrap,g),removeClass(l.consoleWrap,k)}function D(){var e=geByClass1(f,l.patternWrap),t=geByClass1(v,l.patternWrap);T()&&removeClass(l.consoleWrap,g),unlockButton(e),unlockButton(t)}function N(e,t){var a=geByClass1("_console_error",l.consoleWrap),n=geByClass("console_item");a.innerHTML="",e||(e="");var o=ce("div");e&&(o.innerHTML=e),o.className=t?"error":"info_msg",e.match(/\/pattern[0-9]+/)&&n&&n.forEach((function(e){e.className="console_item red_item"})),addClass(l.consoleWrap,k),a.appendChild(o),D()}function B(e){n&&clearTimeout(n),n=setTimeout((()=>{domData(l.consoleWrap,"failed",0)}),3e3),domData(l.consoleWrap,"failed",1),console.error(e),N(e,!0)}function M(){var e=ge("queries",l.consoleWrap);return geByClass1(y,l.consoleWrap).innerHTML=isVisible(e)?"Показать запросы":"Скрыть запросы",toggle(e)}function I(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a={},n=function(e){var t="conditions_input"===e.id?domPS(e):domNS(e);return hasClass(t,"option_cleared")},o=function(t){return e&&n(t)};a[`type${t}`]=cur[`uiSpamtype${t}`].val();var r=ge(`pattern_input${t}`);a[`pattern${t}`]=o(r)?L(r):r.value,a[`threshold${t}`]=ge(`threshold_input${t}`).value;var s=ge(`uid_input${t}`);a[`uid${t}`]=o(s)?L(s):s.value;var i=ge(`ip_input${t}`);a[`ip${t}`]=o(i)?L(i):i.value;var l=ge(`uahash_input${t}`);a[`uahash${t}`]=o(l)?L(l):l.value;var c=ge(`time_start_input${t}`);a[`time_start${t}`]=o(c)?L(c):c.value;var p=ge(`time_finish_input${t}`);if(a[`time_finish${t}`]=o(p)?L(p):p.value,(0,u.isEnabled)())a[`conditions${t}`]=window[`ConditionsEditor${t}`].getPlainText();else{var d=ge(`conditions_input${t}`);a[`conditions${t}`]=o(d)?ls.get(J(t)):d.value}return a},n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=[];Array.from(geByClass("option_cleared",e)).forEach((function(e){var t=geByTag1("input",domPN(e))||geByTag1("textarea",domPN(e));a.push(t.id)}));var n=[];return a.forEach((e=>{switch(e){case`pattern_input${t}`:n|=cur.hideFieldsBitMasks.substring;break;case`ip_input${t}`:n|=cur.hideFieldsBitMasks.ip;break;case`uahash_input${t}`:n|=cur.hideFieldsBitMasks.uaHash;break;case`uid_input${t}`:n|=cur.hideFieldsBitMasks.uid;break;case`time_finish_input${t}`:n|=cur.hideFieldsBitMasks.timeFinish;break;case`time_start_input${t}`:n|=cur.hideFieldsBitMasks.timeStart;break;case`conditions_input${t}`:n|=cur.hideFieldsBitMasks.conditions}})),n};t.simplify=cur.uiSimplify.val(),t.duration=cur.uiDuration.val(),t.bantype=cur.uiBan.val(),t.search_period=cur.uiSearchPeriod.val();var o=cur.uiSearchPeriod.selectedItems();return o&&o.length>0&&(t.period_in_seconds=3===o[0].length&&1===o[0][2]?1:0),t.comment=ge("comment_input").value,t.all_actions=isChecked("all_actions")||!1,t.notbannedonly=isChecked("not_banned_only")||!1,t.linksonly=isChecked("links_only")||!1,t.wrap_actions=null===ge("wrap_actions")?1:isChecked("wrap_actions"),t.encode_entities=null===ge("encode_entities")?1:isChecked("encode_entities"),t.hidden_fields=n(geByClass1("pattern_part_root")),extend(t,a(e,"")),Z()&&(t.hidden_fields2=n(geByClass1("pattern_part_child"),"2"),extend(t,a(e,"2"))),t}function L(e){return domData(e,"restore")}function H(e,t){return domData(e,"restore",t)}function O(){var e=ge("pattern_input"),t=geByClass1(v,l.patternWrap),a=I();if(!e.value)return scrollToTop(0),void notaBene(e);isButtonLocked(t)||(E(),lockButton(t),o&&(tooltips.destroy(o.el),o=!1),a.act="a_console_find_actions",ajax.post("noSpam.php",a,{onDone:e=>function(e){D(),geByClass1("_console",l.consoleWrap).innerHTML=e;var t=geByClass1("_console_numfield_ip1024",l.consoleWrap);t&&new InlineDropdown(t,{items:[[256,"/24 - 256"],[1024,"/22 - 1024"],[4096,"/20 - 4096"],[16384,"/18 - 16k"],[65536,"/16 - 65k"],[262144,"/14 - 262k"],[1048576,"/12 - 1kk"]],selected:256,withArrow:!0,keepTitle:!0,autoShow:!0,autoHide:300,onSelect:e=>U("ip"+e)})}(e),onFail:e=>B(e)}))}function P(e,t){"string"==typeof t&&(t=clean(t)),val(e,t),X(!1,ge(e),"reset")}function F(e){P("ip_input",e)}function j(e){P("uahash_input",e)}function A(e,t){(0,u.isEnabled)()?window.ConditionsEditor.update("append",e):(0!==e.length&&(ge("conditions_input").value+=ge("conditions_input").value?" "+(t?"||":"&&")+" "+e:e),Y("reset"))}function $(e){P("threshold_input",e)}function R(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(e=I(!0));var t=Object.keys(e);t.sort();for(var a=[],n=0;n<t.length;n++){var o=t[n],r=e[o];a.push(encodeURIComponent(o)+"="+encodeURIComponent(r))}return"/noSpam?"+a.join("&")}function q(){var e=R(),t=geByClass1("_get_pattern_link");t&&t.tt&&t.tt.destroy(),addClass(t,"progress"),ajax.post("noSpam.php",{act:"get_search_link",link:e},{onDone:function(e){removeClass(t,"progress"),showTooltip(t,{text:e,slide:15,center:1,black:1,nohide:1,hidedt:400,shift:[0,2,0],onShowEnd:()=>{(0,window.selectText)("shorten_link"),setTimeout(t.tthide,3e3)}})},onFail:function(e){removeClass(t,"progress"),topError(e,{dt:5})}})}function W(){var e=geByClass1(b,l.patternWrap);if(!isButtonLocked(e)){var t=extend(I(),{act:"debug_pattern"});E(),ajax.post("noSpam.php",t,{onDone:e=>N(e),onFail:e=>B(e)})}}function U(e,t){var a=isChecked("values_hist"),n=I();n.need_hist=a,n.act="numeric_field",n.field=e,n.custom_condition=t||"",cur.numFieldSel=e,ajax.post("noSpam.php",n,{onDone:function(n,o){var r=clean(t||e);showFastBox({width:a?330:710,title:r,dark:1,containerClass:"nospam_hist_wrap",hideButtons:a},n).evalBox(o)},progress:"console_query_fields_progress"})}function V(e){r=e,geByClass1("_nospam_console_custom_num_condition_patterns").innerHTML=e}function z(e){var t=2===e?cur.uiSpamtype2.val():cur.uiSpamtype.val();return showBox("noSpam.php",{act:"conditions_hint",spamtype:t},{dark:1,containerClass:"nospam_hint_wrap"})}function K(){var e=I(),t=geByClass1(f,l.patternWrap);e.act="apply_pattern",isButtonLocked(t)||null===document.querySelector(".console_failed_queries")&&(E(),lockButton(t),ajax.post("noSpam.php",e,{onDone:e=>N(e),onFail:e=>B(e)}))}function Q(e){var t=["pattern_input","threshold_input","ip_input","uahash_input","time_finish_input","time_start_input","conditions_input"];if((0,u.isEnabled)()){t.pop();var a=window.ConditionsEditor.getEditorState(),n=window.ConditionsEditor2.getEditorState();window.ConditionsEditor.setEditorState(n),window.ConditionsEditor2.setEditorState(a)}t.forEach((e=>{var t=ge(e).value;ge(e).value=ge(e+"2").value,ge(e+"2").value=t}));var o=cur.uiSpamtype.val();cur.uiSpamtype.selectItem(cur.uiSpamtype2.val()),cur.uiSpamtype2.selectItem(o),toggleClass(e,"switched")}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return`nospam_conditions${e}_${vk.id}`}function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if((0,u.isEnabled)())window.ConditionsEditor.handleClearRestore();else{var a=ge(`conditions_input${t}`),n="option_cleared",o=domPS(a),r=function(){var e=a.value;ls.set(J(t),e),a.value="",e&&addClass(o,n)},s=function(){var e=ls.get(J(t));removeClass(o,n),removeClass(o,S),e&&(ls.remove(J(t)),a.value=e)},i=function(){removeClass(o,n),removeClass(o,S),ls.remove(J(t))};switch(e){case"clear":hasClass(o,n)?s():r();break;case"reset":i()}}}function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["pattern_input","ip_input","uahash_input","uid_input","time_finish_input","time_start_input"];t.forEach((t=>{X(document.getElementById(t+e).nextElementSibling,t+e,"soft_clear")}))}function X(e,t,a){var n=ge(t),o=hasClass(e,"option_cleared");function r(a){var n=val(a);switch(H(a,n),t){case"pattern_input":case"pattern_input2":val(a,"/"),cur.uiSimplify.selectItem(32);break;case"threshold_input":case"threshold_input2":val(a,a.value&&"2"===a.value?"1":"2");break;default:val(a,"")}n&&addClass(e,"option_cleared")}switch(a){case"clear":o?function(){switch(t){case"threshold_input":case"threshold_input2":r(n);break;default:o&&(n.value=L(n))}removeClass(e,"option_cleared"),removeClass(e,S)}():r(n);break;case"reset":!function(){var e=geByClass1("option_clear",n.parentNode);H(n,""),removeClass(e,"option_cleared"),removeClass(e,S)}();break;case"reset_all":geByClass("option_clear").forEach((function(e){H(ge(e.getAttribute("data-option")),""),removeClass(e,"option_cleared"),removeClass(e,S)}));break;case"soft_clear":o||r(n)}}function Z(){var e=geByClass1("_pattern_part_child");if(!isVisible(e))return!1;for(var t=geByClass("cloneable_input",e),a=0;a<t.length;a++)if(val(t[a]))return!0;return!1}function ee(){var e=geByClass1("pattern_wrap"),t="pattern_composite";hasClass(e,t)?removeClass(e,t):addClass(e,t)}function te(){}function ae(e){var t=ge(document.activeElement);if(e.altKey)switch(-1!==[49,50,51,52,53,67,70,81,82,83,87].indexOf(e.keyCode)&&t&&t.blur(),e.keyCode){case 83:(0,l.activeTab)()===l.tabPattern?O():(0,l.activeTab)()===l.tabReports&&(0,i.prepareReport)((0,i.activeReportsType)(),(0,i.activeSubReportsType)());break;case 70:if(-1!==[_,h,m].indexOf(vk.id))return K();break;case 81:ne("pattern_input");break;case 82:ne("conditions_regex");break;case 87:ne("conditions_simple");break;case 67:Y("clear"),cur.conditions.deselectTemplate();break;case 49:cur.uiSearchPeriod.selectItem(1);break;case 50:cur.uiSearchPeriod.selectItem(24);break;case 51:cur.uiSearchPeriod.selectItem(72);break;case 52:cur.uiSearchPeriod.selectItem(240);break;case 53:cur.uiSearchPeriod.selectItem(2160)}}function ne(e){if(e){var t=getSelectionText();switch(e){case"pattern_input":P("pattern_input",t),cur.uiSimplify.selectItem("0");break;case"conditions_simple":case"conditions_regex":var a=document.getSelection().baseNode,n=(0,d.getFieldName)(a);if(!n)return;A("conditions_simple"===e?`'${t}' << ${n}`:`@check_regex('${t=t.replace(/[.|+*(){}\[\]^$?]/g,"\\\\$&")}', ${n})`)}(0,d.removeSelectedText)()}}function oe(){var e=window.pageNode,t=window.browser.msie6?e:window,a=geByClass1("_pattern_buttons",l.patternWrap),n=(0,s.createModule)({handlers:(e,n)=>{n(a,"click",v,O),n(a,"click",f,K),n(a,"click","_get_pattern_link",q),n(a,"click",b,W),n(l.consoleWrap,"click",y,M),n(l.consoleWrap,"click","_console_linkfield_action",(e=>function(e){var t=domData(e.target,"field"),a=showFastBox.pbind({width:710,title:t,dark:1}),n=I();n.act="link_field",n.field=t,ajax.post("noSpam.php",n,{onDone:a,progress:"console_query_fields_progress"})}(e))),n(l.consoleWrap,"click","_console_numfield_action",(e=>{var t=e.target,a=domData(t,"field");a!==w?U(a):function(e){var t="nospam_console_custom_num_condition",a=()=>{var e=ge(x),t=val(e);if(t){var a={act:"a_numeric_field_add_condition",custom_condition:t};ajax.post("noSpam.php",a,{onDone:V.pbind()}),U(w,t)}else notaBene(e)},n={className:"nospam_console_custom_num_condition_wrap",text:getTemplate("nospam_console_custom_num_condition"),forcetodown:1,nohide:1,forceNoHide:1,shift:[10,8],showdt:0,onShowEnd:()=>{elfocus(ge(x))},onShowStart:()=>{val(x,ls.get(t)||"")},init:n=>{o=n;var r=ge(x);addEvent(r,"keypress",(e=>onEnter(a,e))),addEvent(r,"keyup",(()=>ls.set(t,val(r))));var s=geByClass1("_nospam_console_custom_num_condition_close",domPN(r));addEvent(s,"click",(()=>e.tthide()))}};o?(o.show(),a()):showTooltip(e,n),r&&V(r)}(t)})),n(t,"click","_nospam_console_custom_num_condition_pattern",(e=>{var t=e.target,a=(0,c.unclean)(domData(t,"pattern"));val(x,a)})),n(t,"click","_nospam_console_custom_num_condition_clear",(e=>{var t=e.target,a={act:"a_numeric_field_delete_condition",custom_condition:(0,c.unclean)(domData(t,"pattern"))};ajax.post("noSpam.php",a,{onDone:V.pbind()})})),n(l.consoleWrap,"click","console_set_range",(e=>{var t=e.target,a=domData(t,"time");a<0?P("time_finish_input",-a):a>0&&function(e){P("time_start_input",e)}(a)})),n(l.consoleWrap,"click","console_uid",(e=>{e.altKey&&e.ctrlKey&&(P("uid_input",e.target.dataset.uid),cancelEvent(e))})),e(t,"scroll",te),e(document,"keydown",ae),n(l.patternWrap,"click","_option_clear",(e=>{var t=e.target;X(t,domData(t,"option"),"clear")})),n(l.patternWrap,"click","_conditions_clear",(e=>{Y("clear",domNS(e.target).id.replace("conditions_input",""))})),n(document,"click","_console_conditions",(e=>{var t=e.target;A(domData(t,"conditions"))})),n(l.consoleWrap,p.EVENT_MOUSEDOWN,"console_story",(e=>{return t=e.target,a=domData(t,"owner_id"),n=domData(t,"story_id"),o=domData(t,"moderator_hash"),cur.noStoriesBack=!0,void window.showStory(`${a}/${a}_${n}/moderator_hash:${o}`);var t,a,n,o})),n(l.consoleWrap,p.EVENT_MOUSEDOWN,"_console_item_field_length",(e=>{var t=(0,d.getFieldName)(e.target);if(t){var a=e.target.dataset.length,n="=";switch(e.target.dataset.mode){case"less":n="<",a=Math.floor(1.3*a);break;case"greater":n=">",a=Math.round(.7*a)}A(`@length(${t}) ${n} ${a}`)}})),n(l.consoleWrap,"click","console_item_exclude_uid",(e=>{addClass(e.target.closest(".console_item"),"console_item_excluded"),A(`uid != ${e.target.dataset.uid}`)})),n(l.consoleWrap,"click","console_item_pattern_from_sample",(e=>{var t={pattern:"/",simplify:"simplify",uid:e.target.dataset.uid,ip:e.target.dataset.ip,ua_hash:e.target.dataset.ua,type:cur.uiSpamtype.val(),bantype:cur.uiBan.val(),duration:cur.uiDuration.val(),search_period:cur.uiSearchPeriod.val()};(0,p.openInNewTab)(R(t))}))}});cur.destroy.push((()=>{(0,s.destroyModule)(n)}))}},811584:(e,t,a)=>{"use strict";var n;function o(){n=(new Date).getTime()}function r(){var e=(new Date).getTime(),t=(e-n)/1e3,a=Array.prototype.slice.call(arguments);a.push(t),debugLog.apply(null,a)}a.d(t,{startDebugTimer:()=>o,debugLogTimer:()=>r})},690864:(e,t,a)=>{"use strict";a.d(t,{abortPatternMild:()=>l,noSpamPatterns:()=>c});var n,o,r,s=a(516883),i={};function l(e){ajax.post("noSpam.php",{act:"a_abort_pattern_mild",pid:e},{onDone:function(){ge("abort_pattern_mild"+e).innerHTML="<span style = 'color: green'>остановлен</span>"},onFail:function(){ge("abort_pattern_mild"+e).innerHTML="<span style = 'color: red'>ошибка</span>"}})}var c={patternTooltip:function(e,t){var a={content:i[t]?i[t].tooltip:"",className:"pattern_tt_wrap",nohideover:0,showsp:150,slide:15,hasover:0,shift:[5,0,0]};return showTooltip(e,a)},updateProcess:function(e){var t=vkNow();"patterns"===(0,s.activeTab)()&&-1!=window._wf&&((t-o>5e3||e)&&(ajax.post("noSpam.php",{act:"a_in_process"},{onDone:function(e){var t=ge("in_process");if(t)return e>0?animateCount(t,e):t.innerHTML=e},onFail:function(e){ge("in_process").innerHTML=e||"Неизвестная ошибка (banProcess)"}}),o=t),(t-n>1e4||e)&&(ajax.post("noSpam.php",{act:"a_last_patterns"},{onDone:function(e){var t=geByClass1("in_process_wrap");if(t){show(t);var a=e.table;delete e.table,i=e,ge("patterns").innerHTML=a}},onFail:function(e){var t=geByClass1("in_process_wrap");if(t)return t.innerHTML=e||"Неизвестная ошибка (pProcess)"}}),n=t))},clearTimer:function(){clearInterval(r)},initUpdate:function(){this.updateProcess(!0),r||(r=setInterval(this.updateProcess,1e3),cur.destroy.push(this.clearTimer))}}},936714:(e,t,a)=>{"use strict";a.d(t,{activeReportsType:()=>k,activeSubReportsType:()=>x,prepareReport:()=>S,dealSingleSpamer:()=>B,reportsTime:()=>I,onFiltersChange:()=>P,mount:()=>F,noSpamReports:()=>j});a(530522),a(66108),a(579665),a(95767),a(820075),a(751876),a(991181),a(296253);var n=a(829327),o=a(93716),r=a(516883),s=a(811584),i=a(535566),l=a(533246),c=a(450020);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,o=!1,r=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){o=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var u="report_subfilter_active",_="active_filter",h="active_type",m=["botscore","hacked_score","secondary_score"],g={},f={},v=new Date,b=setTimeout(null),y=0;function k(){var e=geByClass1(_,r.reportTabs);return domData(e,"type")}function x(){var e=geByClass1("_reports_subtabs",r.reportTabs),t=geByClass1(_,e);return domData(t,"subtype")}function S(e,t){(0,s.startDebugTimer)();var a=geByClass1("_report_btn_update",r.reportList);if(!isButtonLocked(a)){var n=geByClass1("_reports_"+e+"_wrap",r.reportList);if(n){var o={act:"a_get_reports",encode_entities:1,type:e,sub_type:t,shift:cur.options.shift};"mail"===e&&"mail_group"===t&&(o=extend(o,function(){if("mail"===e||"mail_group"===t){var a=geByClass1("filters");return{hide_groups_with_disabled_messages:isChecked(geByClass1("hide_groups_with_disabled_messages_filter",a)),shift:isObject(cur.hoursShiftSlider)?23*cur.hoursShiftSlider._currValue:0,min_reporters_amount:val(geByClass1("min_reports_amount_filter",a)),sorting:radioval("group_messages_reports_sorting")}}console.log("Unsupported filters used")}())),ajax.post("noSpam.php",o,{onDone:function(t){if((0,s.debugLogTimer)("actions fetch"),g={},0!==t.length){for(var a=0;a<t.length;a++){var o=t[a];o.ui_type=e;var r=w(o.ui_type,a);H(o.ua_hash,o.agent_name),delete o.agent_name,delete o.remix_seed,o.index=a,g[r]=o}n.innerHTML="",C(e,0),t=""}else n.innerHTML=getTemplate("nospam_reports_type_search_empty")},onFail:function(e){(0,s.debugLogTimer)("actions fetched fail"),topError(e),n.innerHTML=getTemplate("nospam_reports_type_search_error")},showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a)}),scrollToTop()}else topError("Can't find wrap for type: "+e)}}function w(e,t){return"report_"+e+"_"+t}function C(e,t,a){(0,s.startDebugTimer)(),a||(a=20);for(var n=geByClass1("_reports_"+e+"_wrap",r.reportList),o=domPN(n),i=geByClass1("_reports_type_show_more",o),l=0,c=0,d=0;l<a;){c=d,d++;var u=w(e,c),_=g[u];if(!(c<t)){if("object"!=typeof _){debugLog("empty reports after "+c,"need to shift "+t);break}if(_.uid&&!0!==_.showed){var h=ce("div",{id:"report_"+e+"_"+c});addClass(h,"clear_fix"),addClass(h,"report");var m=_.uid_base_info;if(_.mem_banned||m){if((0,r.getCustomOption)("reports_hide_processed")&&m)continue;addClass(h,m?"processed":"banned_others")}_.ui_type=e;[D(_),p(E(_),1)[0],N(_,c)].forEach((function(e){h.appendChild(e)})),n.appendChild(h),l++}}}if(0!==l){i?isVisible(i)||show(i):(i=ce("div",{className:"reports_type_show_more _reports_type_show_more"}),o.appendChild(i));var f=parseInt(t)+20;i.innerHTML=getTemplate("nospam_reports_show_more",{need_shift:f}),(0,s.debugLogTimer)("actions to html")}else hide(i)}function T(){var e=getSelectionText();e?cur.uiSimplify.selectItem("0"):(e="/",cur.uiSimplify.selectItem("32")),val("pattern_input",e)}function E(e){var t,a="",n=e.type_name,o=parseInt(e.type),s=ce("div");addClass(s,"report_body report_body_regular"),e.api_id>0&&(a+=e.api_id>0?`<div class="report_api">Приложение ${e.app_name} (${e.api_id}):</div>`:""),e.message&&(a+=getTemplate("nospam_reports_field",{class:"report_message",value:e.message})),e.kludges&&(a+=getTemplate("nospam_reports_field",{class:"reports_kludges",value:e.kludges})),e.attaches&&(a+=getTemplate("nospam_reports_attaches",{attaches:e.attaches}));var i="";switch(o){case 500:case 510:case 545:t="<a href='/wall"+e.owner_id+"_"+e.msg_id+"' target='_blank'> "+n+"</a>";break;case 501:case 550:t="<a href='/wall"+e.owner_id+"_"+e.parent_id+"?reply="+e.msg_id+"' target='_blank'> "+n+"</a>",e.group_id&&e.group_link&&(a+=getTemplate("nospam_reports_group_id",{group_id:e.group_id,group_link:e.group_link}));break;case 100:e.score&&e.score.hasOwnProperty("phone_cheat")&&(i+=getTemplate("nospam_reports_score_block",{label:"phone_cheat",score:e.score.phone_cheat})),e.update_time&&(a+=getTemplate("nospam_reports_tag",{tag_label:e.update_time})),e.uid%2==1&&(s.classList.remove("report_body_regular"),s.classList.add("report_body_odd"));break;case 200:a+=getTemplate("nospam_reports_labeled_value",{label:"receivers_num",value:e.receivers_num}),a+=getTemplate("nospam_reports_labeled_value",{label:"chat_msg_id",value:e.chat_msg_id}),a+=getTemplate("nospam_reports_labeled_value",{label:"chat_title",value:e.chat_title});break;case 300:if(e.group_id&&e.group_link&&(a+=getTemplate("nospam_reports_group_id",{group_id:e.group_id,group_link:e.group_link})),e.admin_id&&e.admin_link){var l=e.admin_id;a+=getTemplate("nospam_reports_admin_id",{admin_id:l,admin_link:e.admin_link})}break;case 160:a+=e.title;break;case 161:a+=e.new_title;break;case 200:e.attaches;-152029297==e.uid&&e.original_user_link&&(a+=getTemplate("nospam_reports_molodec_label",{original_user_link:e.original_user_link}));case 2602:case 2647:t="<a href='/video"+e.owner_id+"_"+e.video_id+"' target='_blank'> "+n+"</a>";break;case 2600:case 2610:case 2611:case 2645:case 2650:t="<a href='/video"+e.owner_id+"_"+e.video_id+"' target='_blank'> "+n+"</a>",a+='<table class="report_video"><tr>',a+='<td style="width: 130px;"><a class="report_video_thumb" href="'+e.video.href+'" onclick="'+e.video.onclick+'" style="background-image: url(\''+e.video.thumb+'\')"><div class="report_video_duration"><span class="report_video_icon"></span><span class="report_video_duration_text">'+e.video.duration_text+"</span></div></a></td>",a+="<td>",a+=e.video.DELETED?"Видеозапись удалена":'<div class="report_video_title"><a href="'+e.video.href+'" onclick="'+e.video.onclick+'">'+e.video.title_short+"</a></div>",a+=!e.video.DELETED&&e.description?'<div class="report_video_description">'+e.video.description_short+"</div>":"",a+="</td>",a+="</tr></table>",a+='<div class="report_video_duration_second"><b>Duration:</b> <a class="_console_conditions" data-conditions="duration = '+e.duration+'">'+e.duration+"</a></div>",e.external&&(a+='<div class="report_video_external"><b>External:</b> '+e.external+"</div>");break;case 3504:case 3545:t="<a href='/photo"+e.owner_id+"_"+e.photo_id+"' target='_blank'> "+n+"</a>";break;case 13120:case 13121:t="<a href='/market"+e.owner_id+"?w=product"+e.owner_id+"_"+e.item_id+"' target='_blank'> "+n+"</a>";break;case 3500:case 3547:t="<a href='/photo"+e.owner_id+"_"+e.photo_id+"' target='_blank'> "+n+"</a>",a+='<table class="report_photo"><tr>',a+='<td><div class="report_photo_thumb">'+e.photo+"</div></td>",a+=e.description?'<td><div class="report_photo_description">'+e.description+"</div></td>":"",a+="</tr></table>",a+=e.album_id<0?'<div class="report_album_id"><b>album_id:</b> '+e.album_id+"</div>":"";break;case 3550:t="<a href='/photo"+e.owner_id+"_"+e.photo_id+"' target='_blank'> "+n+"</a>",a+=e.photo,a+=e.album_id<0?'<div class="report_album_id"><b>album_id:</b> '+e.album_id+"</div>":"";break;case 9258:a+=e.about;break;case 1800:a+=e.status;break;case 1531:case 1530:case 1534:a+=getTemplate("nospam_reports_field",{class:"report_message",value:e.text});break;case 5e3:t="<a href='/topic-"+e.group_id+"_"+e.topic_id+"' target='_blank'> "+n+"</a>",a+=e.title;break;case 5001:case 5046:t="<a href='/topic-"+e.group_id+"_"+e.topic_id+"?post="+Math.abs(e.comment_id)+"' target='_blank'> "+n+"</a>";break;case 2131:var c=e.group_id;t="Группа: "+getTemplate("nospam_reports_id_link",{type:"club",id:c,label:c,color:"black"}),a+="<b>Название:</b>"+e.group_name+"<br>",a+="<b>Описание:</b>"+e.group_description+"<br>";break;case 7530:t="<a href='/app"+e.app_id+"' target='_blank'> "+n+"</a>",a+=e.app_name+"<br>";break;case 3670:var p=e.like_ref,d=e.like_type,u=e.owner_id+"_"+e.item_id,_="";switch(Number(d)){case 11:t="<a href='wall<a href='wall"+u+"' target='_blank'> "+n+"</a>",_+="(запись на стене), <a href='wall"+u+"' target='_blank'>vk.com/wall"+u+"</a>";break;case 12:t="<a href='wall"+u+"' target='_blank'> "+n+"</a>",_+="(комментарий на стене), <a href='wall"+u+"' target='_blank'>vk.com/wall"+u+"</a>";break;case 10:t="<a href='photo"+u+"' target='_blank'> "+n+"</a>",_+="(фотография), <a href='photo"+u+"' target='_blank'>vk.com/photo"+u+"</a>";break;case 24:case 8:t="<a href='photo"+u+"' target='_blank'> "+n+"</a>",_+="(видеозапись), <a href='video"+u+"' target='_blank'>vk.com/video"+u+"</a>";break;case 6:t="<a href='audio.php?id="+e.owner_id+"&audio_id="+e.item_id+"' target='_blank'> "+n+"</a>",_+="(аудиозапись), <a href='audio.php?id="+e.owner_id+"&audio_id="+e.item_id+"' target='_blank'>vk.com/audio.php?id="+e.owner_id+"&audio_id="+e.item_id+"</a>";break;case 22:t=n,_+="(комментарий к видео)";break;case 21:t=n,_+="(комментарий к фотографии)";break;case 20:t=n,_+="(комментарий на стене)";break;default:t=n,_+=" (незвестный тип) "+u}a+=getTemplate("nospam_reports_report_like",{like_ref:p,like_ref_id:e.ref,like_type:_,like_type_id:d});break;default:console.log("No type specified")}if(e.post_tags){var h=e.post_tags;Object.keys(h).forEach((function(e){h[e]&&(a=getTemplate("nospam_reports_tag",{tag_label:h[e]})+a)}))}if(e.score){var g=function(e){if(0===e.length)return!1;var t=[];for(var a in e)m.includes(a)&&t.push([a,e[a]]);if(0===t.length)return!1;return t.sort(((e,t)=>t[1]-e[1])),t[0]}(e.score);g&&(i+=getTemplate("nospam_reports_score_block",{label:g[0],score:g[1]})),a+=getTemplate("nospam_reports_scores",{score_blocks:i})}return a+=function(e){var t,a,n=e.uid_base_info,o=e.mem_banned,s="",i="";if(n){var l=e.pattern_additional_info;t=Number(n[0].pattern_id),a=Number(n[0].state);var c=(p=l.admin_name,d=Number(n[1].admin_id),u=p.split(" ").reduce(((e,t)=>e+t[0]),""),getTemplate("nospam_reports_id_link",{type:"id",id:d,label:u,color:"black"}));s=`${0===a?"Обрабатывается: ":"Обработан: "} шаблон <a href='/pattern${t}' target='_blank'>${t}</a> (${l.pattern_type_name}; ${l.pattern_params}) от ${c}`}var p,d,u;o&&(i=`${M(new Date(1e3*o.time))}: ${o.comment}`);if(!(0,r.getCustomOption)("reports_hide_ban_info")&&(n||o))return`<div class="BannerInfo"><div class="report_processed_info">${s}</div><div>${i}</div></div>`;return""}(e),s.innerHTML=a,[s,t]}function D(e){var t,a=e.mem_banned,n=isObject(a),o=(w(e.ui_type,e.index),!1),r=ce("div");addClass(r,"report_info"),n&&(addClass(r,"report_banned"),o=Number(a.ban_time)<0);var s,i=e.uid,l=Number(e.type),c=n?"red":"blue",d=o?"forever":"";return t=i>0?getTemplate("nospam_reports_id_link",{type:"id",id:i,label:i,color:c}):getTemplate("nospam_reports_id_link",{type:"club",id:-i,label:i,color:c}),s=p(E(e),2)[1],r.innerHTML=getTemplate("nospam_reports_report_info",{action_mention_link:t,ban_time_class:d,type:l,index:e.index,ip:e.ip,report_time:M(new Date(1e3*e.report_time)),action_time:M(new Date(1e3*e.time)),ua_hash:e.ua_hash,from_uid:e.from_uid,report_count:e.report_count>1?langNumeric(e.report_count,["","%s жалоба","%s жалобы","%s жалоб"]):"",report_type_link:s}),r}function N(e,t){var a="",n="report_"+e.ui_type+"_"+e.index,o=ce("div");addClass(o,"report_steps");var r=cur.isSearchOnlyMode;if(("photo"===e.ui_type||"video"===e.ui_type)&&!r){var s=e[e.ui_type+"_id"];a+="<a id = 'spamer_by_"+n+'\' class="flat_button button_small secondary" onclick = "'+`dealSingleSpamer('${e.ui_type}', ${e.index}, ${e.uid}, '${e.deal_single_spamer_hash}', ${e.type}, ${e.time}, ${e.owner_id}, ${s})`+'">Забанить и откатить</a>'}return a+=getTemplate("nospam_reports_compose_button",{type:e.real_ui_type?e.real_ui_type:e.ui_type,ip:e.ip,ua_hash:e.ua_hash}),!r&&e.first_attached_photo_kid&&(a+=getTemplate("nospam_reports_apply_pattern_fast",{name:"Автошаблон kid (ДП)",kid:e.first_attached_photo_kid})),a+="<span id='selected_text_span"+t+"' style='display:none;'></span>",o.innerHTML=a,o}function B(e,t,a,n,o,r,s,i){var l="report_"+e+"_"+t,p=c.reportsRollbackSpamerDone,d=c.reportsRollbackSpamerFail;"photo"===e?(0,c.rollbackPhotoSpamer)(a,n,o,r,s,i,(()=>p(l)),(()=>d(l))):"video"===e&&(0,c.rollbackVideoSpamer)(a,n,o,r,s,i,(()=>p(l)),(()=>d(l)))}function M(e){var t=e.getDate(),a=e.getMonth()+1;return(t<10?"0":"")+t+"."+(a<10?"0":"")+a+" в "+e.toLocaleTimeString()}var I={_sel:[],day:v.getDate(),month:v.getMonth(),months:[[0,"Января"],[1,"Февраля"],[2,"Марта"],[3,"Апреля"],[4,"Мая"],[5,"Июня"],[6,"Июля"],[7,"Августа"],[8,"Сентября"],[9,"Октября"],[10,"Ноября"],[11,"Декабря"]],year:v.getFullYear(),generateHMS:function(e){var t,a=[];switch(e){case"hour":t=23;break;case"minute":case"second":t=59}for(var n=0;n<=t;++n)a.push([n,n<10?"0"+n:n+""]);return a},generateDays:function(e,t){for(var a=[],o=(0,n.getLastDay)(e,t),r=1;r<=o;++r)a.push([r,r+""]);return a},updateDays:function(){var e=this._sel[0],t=this._sel[1].val(),a=this._sel[2].val();e.val()>(0,n.getLastDay)(a,t)&&e.clear(),e.setData(this.generateDays(a,t))},setControls:function(){var e=I,t=[["reports_day",55],["reports_month",95],["reports_year",60],["reports_hour",50],["reports_minute",50],["reports_second",50]],a=ce("div",{id:"reports_time_wrap",className:"reports_time_wrap"}),n=geByClass1("box_body");e.clear(),n.appendChild(a),t.forEach((function(a,o){var r=[],s=[],i=ce("div",{className:a[0]+" fl_l"}),l=ce("input",{type:"hidden",name:a[0],id:a[0]}),c=a[0].split("_")[1];switch(domLC(n).appendChild(i),i.appendChild(l),c){case"year":s=(r=[[e.year,e.year+""]])[0];break;case"month":r=e.months,s=e.month;break;case"day":s=(r=e.generateDays(e.year,e.month))[e.day-1];break;case"hour":r=e.generateHMS(c),s=v.getHours();break;case"minute":r=e.generateHMS(c),s=v.getMinutes();break;case"second":r=e.generateHMS(c),s=v.getSeconds();break;default:s=r=e[c]}var p={width:t[o][1],multiselect:!1,autocomplete:!1,selectedItems:s};"month"!==c&&"year"!==c||extend(p,{onChange:function(e){I.updateDays()}}),I._sel.push(new Dropdown(l,r,p))}))},setTime:function(){boxQueue.hideLast();var e=I,t=e._sel,a={day:t[0].val(),month:t[1].val(),year:t[2].val(),hour:t[3].val(),minute:t[4].val(),second:t[5].val()},n=new Date(a.year,a.month,a.day,a.hour,a.minute,a.second),o=e.tt;val(o,n.getTime()/1e3)},set:function(e,t){var a=this.setControls,n=this.setTime,o=domData(t,"part");v=new Date;var s=o?"time_"+e+"_input2":"time_"+e+"_input";this.tt=ge(s,r.patternWrap),showFastBox({width:435,title:"Время действия ("+("start"==e?"позже":"раньше")+", чем)",dark:1,containerClass:"nospam_report_time_box",onShow:a},'<div class="reports_time_label">Укажите дату:</div>',"Применить",n)},clear:function(){return this._sel=[]}};function L(e){(0,i.isSpecialKeyPressed)(e)?function(e){var t=(0,o.getParams)();if(t.type=domData(e,"type"),null===t.type)return!1;"post"!==t.type&&"comment"!==t.type||(t.type="wall");t.ip=domData(e,"ip"),t.uahash=domData(e,"ua-hash"),t.pattern=t.pattern||getSelectionText(),t.threshold=1;var a=(0,o.composeSearchLinkFromParams)(t);(0,i.openInNewTab)(a)}(e.target):function(e){var t=domData(e,"type"),a=domData(e,"ip"),n=domData(e,"ua-hash");if(null===t)return;"post"!=t&&"comment"!=t||(t="wall");(0,o.setIp)(a),(0,o.setUaHash)(n),(0,o.setThreshold)(1),cur.uiSpamtype.selectItem(t),(0,r.switchTab)(r.tabPattern),(0,o.optionClear)(!1,"reset_all")}(e.target)}function H(e,t){var a=f[e];f[e]?a&&a!==t&&debugLog("collision for "+e,t,a):f[e]=t}function O(){if((0,r.getCurrentTab)()===r.tabReports){var e=k(),t=geByClass1("_reports_"+e+"_wrap",r.reportList),a=geByClass1("_report_show_more",domPN(t)),n=domPN(a),o=window.innerHeight||document.documentElement||bodyNode.clientHeight;y=scrollGetY(),isVisible(n)&&(0,r.activeTab)()===r.tabReports&&o+y>a.offsetTop&&a.click()}}function P(){clearTimeout(b),b=setTimeout(S.pbind(k(),x()),1e3)}function F(){var e=(0,l.createModule)({handlers:(e,t)=>{t(r.reportList,"mouseover","report_steps",T),t(r.reportList,"click","report_steps",(e=>L(e))),t(r.reportList,"click","fast_pattern",(e=>{return t=e.target,n=t.getAttribute("data-kid"),a={act:"apply_pattern",type:"photo",pattern:"/",simplify:32,search_period:72,duration:8,bantype:0,conditions:`type = 3500 && album_id IN (-7, -8) && kid = '${n}'`,comment:"#child_porn Боты или взломанные с ДП-фото для увода в Телеграм (автошаблон из жалобы на комментарий)",pattern_added_short_output:!0},void ajax.post("noSpam.php",a,{onDone:e=>{t.outerHTML=`<span>${e}</span>`},onFail:()=>{topError("Ошибка при установке шаблона"),t.outerHTML="<span>Ошибка</span>"},showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t)});var t,a,n})),t(r.reportList,"mouseover","report_info_ban_tooltip",(e=>function(e){var t=e.target,a=domData(t,"action-index"),n=g[a].ban_tt;n&&showTooltip(t,{text:n,dir:"down",hasover:1,shift:[22,5,0]})}(e))),t(r.reportList,"mouseover","report_info_ua_hash",(e=>function(e){var t=e.target,a=domData(t,"ua-hash"),n=f[a];showTooltip(t,{text:n||"[NULL]",dir:"down",hasover:1,shift:[22,5,0]})}(e))),e(document,"scroll",O),t(r.reportList,"click","_report_show_more",(e=>{var t=domData(e.target,"need-shift");C(k(),t)})),t(r.reportTabs,"click","report_filter",(e=>function(e){var t=e.target,a=domData(t,"type"),n=domData(t,"subtype"),o=geByClass("report_filter",r.reportTabs),s=geByClass("report_subfilter",r.reportTabs),i=geByClass1(h,r.reportList);if(!a)return!1;o.forEach((e=>{hasClass(e,_)&&removeClass(e,_),domData(e,"type")!==a||domData(e,"subtype")||addClass(e,_)}));var l=!1,c=!1;s.forEach((e=>{removeClass(e,u),removeClass(e,_),domData(e,"type")===a&&(addClass(e,u),l=!0),domData(e,"subtype")===n&&(addClass(e,_),c=!0)}));var p=geByClass1("hr",r.reportTabs);if(l?show(p):hide(p),l&&!c){var d=geByClass1(u,r.reportTabs);addClass(d,_)}domData(i,"type")!==a&&(removeClass(i,h),addClass(ge("reports_"+a),h)),S(a,n)}(e))),t(r.reportList,"click","_report_btn_update",(e=>{S(k(),x())})),t(r.reportTabs,"mouseover","settings_dots_wrap",(e=>{var t=geByClass1("settings_dots_wrap");showTooltip(t,{black:!0,text:getTemplate("reports_group_message_tab_tooltip"),className:"group_messages_settings_tt",slideY:15,shift:[98,100,20],dir:"top",showdt:300,hidedt:100,hasover:!0,onCreate:function(){var e;e=ge("search_shift_filter"),cur.hoursShiftSlider=new Slider(e,{width:200,height:100,debounce:10,size:2,value:parseFloat(nav.objLoc.shift/23)||0,onChange:e=>{(0,i.updateUrl)({shift:parseInt(23*e)}),P()},formatHint:e=>langNumeric(parseInt(23*e),["","%s час назад","%s часа назад","%s часов назад"])}),(0,i.initRadioButtons)("group_messages_reports_sorting","sorting_radio_filter_wrap",1)}})}))}});cur.destroy.push((()=>{(0,l.destroyModule)(e)}))}var j={initUpdate:function(){scrollToY(y)}}},450020:(e,t,a)=>{"use strict";a.d(t,{rollbackDocMailSpamer:()=>o,rollbackDocWallSpamer:()=>r,rollbackJpgMailSpamer:()=>s,rollbackJpgWallSpamer:()=>i,rollbackPngMailSpamer:()=>l,rollbackPngWallSpamer:()=>c,rollbackDocSpamer:()=>p,rollbackPhotoSpamer:()=>d,rollbackPhotoSpamerFromWall:()=>u,rollbackPhotoSpamerFromMail:()=>_,rollbackVideoSpamer:()=>h,rollbackVideoSpamerFromWall:()=>m,rollbackVideoSpamerFromMail:()=>g,reportsRollbackSpamerDone:()=>b,reportsRollbackSpamerFail:()=>y});var n="green_item";function o(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_docmail_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_docmail_spamer",uid:e,hash:t,act_type:a,spam_date:n,to_id:o,to_msg_id:r},{onDone:s,onFail:i})}function r(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_docwall_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_docwall_spamer",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,msg_id:r},{onDone:s,onFail:i})}function s(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_jpgmail_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_jpgmail_spamer",uid:e,hash:t,act_type:a,spam_date:n,to_id:o,to_msg_id_id:r},{onDone:s,onFail:i})}function i(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_jpgwall_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_jpgwall_spamer",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,msg_id:r},{onDone:s,onFail:i})}function l(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_pngmail_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_pngmail_spamer",uid:e,hash:t,act_type:a,spam_date:n,to_id:o,to_msg_id:r},{onDone:s,onFail:i})}function c(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_pngwall_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_pngwall_spamer",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,msg_id:r},{onDone:s,onFail:i})}function p(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_doc_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_doc_spamer",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,doc_id:r},{onDone:s,onFail:i})}function d(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_photo_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_photo_spamer",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,photo_id:r},{onDone:s,onFail:i})}function u(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_photo_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_photo_spamer_from_wall",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,msg_id:r},{onDone:s,onFail:i})}function _(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_photo_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_photo_spamer_from_mail",uid:e,hash:t,act_type:a,spam_date:n,to_id:o,to_msg_id:r},{onDone:s,onFail:i})}function h(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_video_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_video_spamer",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,video_id:r},{onDone:s,onFail:i})}function m(e,t,a,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_video_spamer"),i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_video_spamer_from_wall",uid:e,hash:t,act_type:a,spam_date:n,owner_id:o,msg_id:r},{onDone:s,onFail:i})}function g(e,t,a,n,o,r){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_video_spamer_from_mail",uid:e,hash:t,act_type:a,spam_date:n,to_id:o,to_msg_id:r},{onDone:oneDone,onFail:s})}function f(e,t,a){ge(a+t).innerHTML=e,function(e){var t=ge("console_item_"+e);hasClass(t,n)&&removeClass(t,n),addClass(t,"red_item")}(t)}function v(){return null}function b(e){ge("spamer_by_"+e).outerHTML="<span style = 'color: green'> Добавлен </span>",document.getElementById(e).classList.add("processed")}function y(e){ge("spamer_by_"+e).outerHTML="<span style = 'color: red'> Неудача </span>"}},752988:(e,t,a)=>{"use strict";a.d(t,{noSpamSuspicious:()=>n});var n={selected:"ua_hash",updateOnSelect:function(){return n.getByType(n.selected)},getSpamType:function(){return isObject(this.spamtype)?this.spamtype._selected[0]:"wall"},getPeriod:function(){return isObject(this.period)?this.period._selected[0]:1},getByType:function(e){var t=ge("suspicious_table"),a=geByClass1("summary_tab_sel","suspicious_tabs"),n=isVisible("suspicious_tabs")?0:1,o=this;this.selected=e;var r=ge("suspicious_spamtype"),s=ge("suspicious_period"),i=geByClass("_suspicious_msg"),l=geByClass1("_suspicious_"+e+"_msg");each(i,(function(e,t){hide(t)})),show(l),"hashtags"==e?hide(r):show(r),"users"==e&&hide(r,s),n&&(t=ge("suspicious")),removeClass(a,"summary_tab_sel");var c={act:"a_get_suspicious",type:e,spamtype:this.getSpamType(),period:this.getPeriod(),need_tabs:n};addClass("suspicious_"+e,"summary_tab_sel"),ajax.post("noSpam.php",c,{onDone:function(e){if(!e)return topError(getLang("nospam_suspicious_data_error"));t.innerHTML=e,o.initInlineDropdown()},progress:"suspicious_progress"})},initInlineDropdown:function(){var e={withArrow:!0,keepTitle:!0,autoShow:!0,autoHide:300,onSelect:n.updateOnSelect},t=extend({items:cur.options.spamtypes,selected:"wall"},e),a=extend({items:[[1,"Один час"],[2,"Два часа"],[5,"5 часов"],[10,"10 часов"],[24,"Сутки"]],selected:1},e);this.spamtype||(this.spamtype=new InlineDropdown("suspicious_spamtype",t)),this.spamtype._els.valueEl.innerHTML=this.spamtype._selected[1],this.period||(this.period=new InlineDropdown("suspicious_period",a)),this.period._els.valueEl.innerHTML=this.period._selected[1]}}},320902:(e,t,a)=>{"use strict";a.d(t,{noSpamTemplates:()=>o});a(59357),a(820075);var n=a(93716),o=function(e){this.selected=0,extend(this,e),this.templates=JSON.parse(e.templates)};o.prototype={addTemplate:function(){showBox("noSpam.php",{act:this.acts.add},{params:{width:430,dark:1,progress:"add_template"}})},saveTemplate:function(e){var t=cur[e],a=t.selected||0;if(ge("add_template_title")&&ge("add_template_text")){var n=trim(ge("add_template_title").value),o=trim(ge("add_template_text").value);if(!n)return notaBene("add_template_title");if(!o)return notaBene("add_template_text");var r={act:t.acts.save,title:n,text:o,hash:t.hash,template_id:a};ajax.post("noSpam.php",r,{onDone:function(e,a){var n=ge(t.links);n.innerHTML=e,hasClass(n,"template_links")||addClass(n,"template_links"),t.templates=JSON.parse(a),curBox().hide()},progress:a?"edit_template":"add_template"})}},editTemplate:function(){var e={act:this.acts.edit,template_id:this.selected,hash:this.hash};showBox("noSpam.php",e,{params:{width:430,dark:1,progress:"edit_template"}})},deleteTemplate:function(){var e=this;if(!this.selected)return!1;showFastBox({title:"Удаление шаблона",width:430,dark:1,progress:"delete_condition"},getLang("nospam_delete_template"),getLang("global_delete"),(function(){var t=e.selected,a={act:e.acts.remove,template_id:t,hash:e.hash};ajax.post("noSpam.php",a,{onDone:function(t,a){var n=ge(e.links);n.innerHTML=t,e.deselectTemplate(),e.templates=JSON.parse(a),isObject(e.templates)||removeClass(n,"template_links"),curBox().hide()},progress:"delete_condition"})}),getLang("global_cancel"))},selectTemplate:function(e){if(e){var t=this.templates[e];this.selected=e;var a=entityDecode(t.text);(0,n.setConditions)(a),this.label.innerHTML=t.title+": ",addClass(this.wrap,"template_selected")}},selectCommentTemplate:function(e){if(e){var t=this.templates[e];this.selected=e;var a=entityDecode(t.text);this.editComment(a),this.label.innerHTML=t.answer_name+": ",addClass(this.wrap,"template_selected")}},editComment:function(e){if(val(this.input,e),this.input.autosize)return this.input.autosize.update();autosizeSetup("comment_input",{minHeight:32})},getFromLocal:function(e){var t=localStorage.comments_templates_storage;ge("get_local_comments");try{t=JSON.parse(t)}catch(e){}return t?t&&e?(each(t,(function(e,t){var a=function(e,t){var a=ge("comment_template_links");hasClass(a,"template_links")||addClass(a,"template_links"),cur.comment.links.innerHTML=e,cur.comment.templates=JSON.parse(t)};setTimeout((function(){var e=t[1];ajax.post("noSpam.php",{act:"save_comment_template",title:e.name,text:e.comment,hash:opts.comment_hash,template_id:0},{onDone:a})}),1e3*e)})),curBox().hide()):void showBox("noSpam.php",{act:"apply_comments_export"},{params:{width:430,dark:1,progress:"export_progress"}}):showFastBox({title:"Перенос шаблонов",dark:1},"К сожалению, не удалось найти ни одного комментария.")},deselectTemplate:function(){var e=this.selected,t=this.templates[e];if(t){var a=entityDecode(this.templates[e].text);t&&this.input.value==a&&val(this.input,""),this.label.innerHTML=this.label_html,removeClass(this.wrap,"template_selected"),delete this.selected}},editSort:function(){var e={act:this.acts.sort,hash:this.hash};showBox("noSpam.php",e,{params:{width:430,dark:1,progress:"sort_template"}})},saveSort:function(e,t,a,n,o){var r=cur[e],s={hash:t,act:r.acts.sort_save,tid:a.id.replace("template",""),tpos:a.dataset.pos,after_id:n&&n.dataset?n.dataset.pos:"",before_id:o&&o.dataset?o.dataset.pos:""};ajax.post("noSpam.php",s,{onDone:function(e,t){box=curBox(),box.content(e[2]),box.evalBox(t),box.setOptions({onHide:function(){debugLog(e),r.links.innerHTML=e[0],r.templates=JSON.parse(e[1])}})},progress:"sort_template"})}}},516883:(e,t,a)=>{"use strict";a.d(t,{consoleWrap:()=>n,patternWrap:()=>o,reportList:()=>r,reportTabs:()=>s,tabReports:()=>h,tabPattern:()=>m,switchTab:()=>f,getCurrentTab:()=>v,activeTab:()=>b,getCustomOption:()=>k,init:()=>w});var n,o,r,s,i,l=a(93716),c=a(936714),p=a(690864),d=a(535566),u=a(533246),_=a(969211),h="reports",m="pattern",g="_nospam_option_action";function f(e,t){var a=geByClass1("_nospam_tab_switch_"+e);uiTabs.switchTab(domFC(a)),t&&(a=domChildren(a));var n=geByClass("nospam_tab"),o=domData(a,"tab-id");return n.forEach((function(e){domData(e,"id")!=o?hide(e):show(e)})),(0,d.updateUrl)({tab:e}),"patterns"===e?p.noSpamPatterns.initUpdate():e===h?c.noSpamReports.initUpdate():e===m&&scrollToTop(),!1}function v(){return(0,d.getUrlParam)("tab")}function b(){var e=domPN(geByClass1("ui_tab_sel"));return domData(e,"tab-id")}function y(e){geByClass(g,i).forEach((t=>{var a=domData(t,"option"),n=+e[a],o=window.cur.lang["nospam_options_"+a];o&&(t.innerHTML=o[n]),domData(t,"option-state",n)})),cur.options.custom_options=e}function k(e){var t=window.cur;return!!t.options.custom_options&&t.options.custom_options[e]}function x(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o={width:185,height:500,multiselect:!1};return(0,_.isEnabled)()&&e.includes("spamtype")&&extend(o,{onChange:e=>{window["ConditionsEditor"+n].setSection(e)}}),new Dropdown(document.getElementById(e),t,extend(o,{selectedItems:a}))}function S(e){extend(cur,{uiSpamtype:x("spamtype",e.spamtypes,cur.options.spamtype),uiSpamtype2:x("spamtype2",e.spamtypes,cur.options.spamtype2,2),uiSimplify:x("simplify_select",e.simplifies,cur.options.simplify),uiBan:x("ban_select",e.bans,cur.options.ban),uiDuration:x("duration_select",e.durations,cur.options.duration),uiSearchPeriod:x("search_period_select",e.searchperiods,cur.options.searchperiod)}),placeholderSetup("comment_input"),val("comment_input")&&autosizeSetup("comment_input",{minHeight:30}),geByClass("conditions_input").forEach((function(e){placeholderSetup("comment_input"),val(e)&&autosizeSetup("comment_input",{minHeight:30})}));var t=ge("page_body");o=geByClass1("pattern_wrap",t),n=geByClass1("console_wrap",t),s=geByClass1("reports_tabs",t),r=geByClass1("_reports_list",t),i=geByClass1("_nospam_options",t);var a=geByClass1("nospam_patterns_wrap",t),d=(0,u.createModule)({handlers:(e,t)=>{t(a,"click","_abort_pattern_mild",(e=>(0,p.abortPatternMild)(domData(e.target,"id")))),t(i,"click",g,(e=>{return t=e.target,a={act:"a_set_custom_option",name:domData(t,"option"),state:1^domData(t,"option-state")},void ajax.post("noSpam.php",a,{onDone:y,showProgress:lockActionsMenuItem.pbind(t),hideProgress:unlockActionsMenuItem.pbind(t)});var t,a}))}});cur.destroy.push((()=>{(0,u.destroyModule)(d)})),(0,l.mount)(),(0,c.mount)()}function w(e){var t=(0,u.createMutations)(S);t.callMutations;(0,t.bindMutations)(e)}},535566:(e,t,a)=>{"use strict";a.d(t,{PHP_DAY:()=>n,MILLISECONDS_MULTIPLIER:()=>o,TARGET_BLANK:()=>r,EVENT_MOUSEDOWN:()=>s,EVENT_KEYDOWN:()=>i,EVENT_SCROLL:()=>l,getCurrentUrl:()=>c,updateUrl:()=>p,getUrlParam:()=>d,getAct:()=>u,openInNewTab:()=>_,getTime:()=>h,getCurrentDayBoundaries:()=>m,getDayBoundaries:()=>g,timestampToSeconds:()=>f,showLoading:()=>v,hideLoading:()=>b,hideCurrentBox:()=>y,initRadioButtons:()=>k,isSpecialKeyPressed:()=>x,isIntegerString:()=>S});var n=86400,o=1e3,r="_blank",s="mousedown",i="keydown",l="scroll";function c(){return nav.strLoc}function p(e){var t={0:nav.objLoc[0],act:nav.objLoc.act};nav.setLoc(extend(t,e))}function d(e){return nav.objLoc[e]}function u(){return d("act")}function _(e){window.open(e,"_blank").focus()}function h(){return f(Date.now())}function m(){return g((new Date).getTime())}function g(e){var t=new Date(e),a=new Date(e);return t.setHours(0,0,0,0),a.setHours(23,59,59,999),[t.getTime(),a.getTime()]}function f(e){return Math.floor(e/o)}function v(){var e=new MessageBox;e.setOptions({title:!1,hideButtons:!0}).show(),hide(boxLayerBG),hide(e.bodyNode),show(boxLoader),boxRefreshCoords(boxLoader)}function b(){curBox&&curBox()&&curBox().hide()}function y(){curBox().hide()}function k(e,t,a){window.radioBtns[e]={val:a,els:Array.prototype.slice.apply(geByClass("radiobtn",geByClass1(t)))}}function x(e){return e.ctrlKey||e.metaKey&&browser.mac}function S(e){return/^-?(0|[1-9]\d*)$/.test(e)}},276018:(e,t,a)=>{"use strict";a.d(t,{addDelegateEvent:()=>i,removeDelegateEvent:()=>l});a(530522),a(66108),a(579665),a(95767),a(991181),a(296253),a(751876);function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,o=!1,r=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){o=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var r=new window.Map;function s(e){var t=r.get(e.currentTarget);if(t){var a=t[e.type];if(a)for(var o,s=0;s<a.length;s++){var i=n(a[s],2),l=i[0],c=i[1],p=void 0;if(hasClass(e.target,l)?p=c(e,e.target):(o=gpeByClass(l,e.target,e.currentTarget))&&(p=c(e,o)),!1===p)break}}}function i(e,t,a,n){var o=r.get(e);o||(r.set(e,{}),o=r.get(e));for(var i=t.split(" "),l=0;l<i.length;l++){var c=i[l];o[c]||(o[c]=[],addEvent(e,c,s)),o[c].push([a,n])}}function l(e,t,a,n){var o=r.get(e);o&&(t.split(" ").forEach((t=>{o[t]&&(o[t]=o[t].filter((e=>e[0]!==a||e[1]!==n)),0===o[t].length&&removeEvent(e,t,s))})),0===Object.keys(o).map((e=>o[e].length)).reduce(((e,t)=>e+t))&&r.delete(e))}},448809:(e,t,a)=>{"use strict";a.d(t,{ClearRestoreInputButton:()=>i});var n=a(570655),o=a(667294),r=a(394478),s="ClearRestoreInputButton",i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.handleClick=function(){this.props.handleClearRestore()},t.prototype.render=function(){var e=this.props.clearRestoreStatus?s+" "+s+"--active":s;return o.createElement("span",{className:e,onClick:this.handleClick.bind(this)},o.createElement(r.default,null))},t}(o.Component)},460378:(e,t,a)=>{"use strict";a.d(t,{MONOSPACE_FONTS:()=>m,UpdateMode:()=>n,Hotkeys:()=>o,ConditionsEditor:()=>g});var n,o,r=a(570655),s=a(667294),i=a(973935),l=a(328770),c=a(642945),p=a(166480),d=a(395779),u=a(231451),_=a(953414),h=a(189573),m='Roboto Mono, Monaco, "Andale Mono", "Lucida Console", "Courier New", Courier, monospace';!function(e){e.refresh="refresh",e.append="append",e.insert="insert",e.suggested="suggested",e.history="history",e.clear="clear",e.restore="restore",e.sync="sync"}(n||(n={})),function(e){e.suggestEnter="suggestEnter",e.suggestSelectUp="suggestSelectUp",e.suggestSelectDown="suggestSelectDown",e.undo="undo",e.redo="redo"}(o||(o={}));var g=function(e){function t(t){var a=e.call(this,t)||this,o=(0,d.checkSyntax)(t.initialText,t.syntaxDictionary,t.initialSection);return a.state={currentText:t.isTextStored?"":t.initialText,storedText:t.isTextStored?t.initialText:"",currentSection:t.initialSection,updateMode:n.refresh,lexedArray:o,lexedHTML:(0,d.getLexedHTML)(o),reachedLengthLimit:!1,caretPosition:0,selectionLength:0,suggestNodeIndex:0,suggestActive:!1,suggestVariants:[],suggestVariantSelected:""},a.history=new h.History(a.state.currentText),a}return(0,r.__extends)(t,e),t.prototype.getPlainText=function(){return this.state.currentText},t.prototype.handleHotkeys=function(e){var t=this.state;switch(e){case o.suggestEnter:this.handleEnterSuggestion(t.suggestVariantSelected);break;case o.suggestSelectUp:case o.suggestSelectDown:var a=t.suggestVariants.indexOf(t.suggestVariantSelected),r=a-1<0?t.suggestVariants.length-1:a-1,s=a+1===t.suggestVariants.length?0:a+1,i=e===o.suggestSelectUp?r:s;this.setState({suggestVariantSelected:t.suggestVariants[i]});break;case o.undo:case o.redo:var l=e===o.undo?this.history.getPreviousState():this.history.getNextState();if(!l)return;this.update(n.history,l.text,l.selection)}},t.prototype.createSuggestions=function(e){var t=[],a="",n=e.text;if("generic_text"===e.type){var o=n.startsWith("@")?"functions":"fields";t=(0,d.dictionaryLookup)(n,o,this.props.syntaxDictionary,this.state.currentSection)}return 0!==t.length&&(a=t[0]),{variants:t,variantSelected:a}},t.prototype.handleEnterSuggestion=function(e){this.update(n.suggested,e)},t.prototype.update=function(e,t,a){void 0===t&&(t="");var o=this.state,r=this.props,s=this.getInputElement(),i=(null==(a=a||(0,u.get)(s))?void 0:a.textStart)||0,l="",c="",p=o.currentText.slice(0,i),_=o.currentText.slice(i);if(a&&"Range"===a.type){var h=(0,u.handleRange)(a,s,o.currentText);i=h.textStart,p=h.textBefore,_=h.textAfter}switch(e){case n.history:case n.refresh:l=t;break;case n.insert:i+=t.length,l=p+t+_;break;case n.append:i=-1;var m=t;r.mainTextFields.hasOwnProperty(o.currentSection)&&r.mainTextFields[o.currentSection]&&(m=t.replace(new RegExp("message","g"),r.mainTextFields[o.currentSection])),l=0!==o.currentText.length?o.currentText+" && "+m:m;break;case n.suggested:var g=s.children[o.suggestNodeIndex].innerHTML.length;if(!g)break;i=o.caretPosition-g+t.length,l=o.currentText.slice(0,o.caretPosition-g)+t+o.currentText.slice(o.caretPosition);break;case n.clear:l="",c=o.currentText;break;case n.restore:l=o.storedText,c="",i=-1;break;case n.sync:l=s.innerText}l=l.replace(/^\n$/,"");var f=(0,d.checkSyntax)(l,r.syntaxDictionary,o.currentSection),v=(0,d.getLexedHTML)(f),b=(0,d.getSyntaxBlockIndex)(f,i),y=null,k=[],x="";f[b]&&i>0&&(k=(y=this.createSuggestions(f[b])).variants,x=y.variantSelected),this.setState({currentText:l,caretPosition:i,lexedArray:f,lexedHTML:v,suggestNodeIndex:b,suggestVariants:k,suggestVariantSelected:x,updateMode:e,storedText:c})},t.prototype.handleClearRestore=function(){var e=this.state;0===e.storedText.length?0!==e.currentText.length&&this.update(n.clear):this.update(n.restore)},t.prototype.updateHistory=function(e,t){this.history.saveState({text:this.state.currentText,selection:e},t)},t.prototype.callHelpPopup=function(){var e=this.props.partIndex?Number(this.props.partIndex):"";this.props.helpFunction(e)},t.prototype.setSection=function(e){this.setState({currentSection:e})},t.prototype.getEditorState=function(){return this.state},t.prototype.setEditorState=function(e){this.setState(e)},t.prototype.setSelectionLength=function(e){this.setState({selectionLength:e})},t.prototype.showConditionOnly=function(){this.props.conditionsOnlyFunction(this.props.partIndex)},t.prototype.removeSpacesFromText=function(){var e="";this.state.lexedArray.forEach((function(t){"space"!==t.type&&(e+=t.text)})),this.update(n.refresh,e)},t.prototype.mergeSameFieldBlocks=function(){var e=(0,_.getNewCondition)(this.state.lexedArray);this.getInputElement().blur(),this.update(n.refresh,e)},t.prototype.wrapSelection=function(e){var t="",a="",o=this.state.currentText;switch(e){case"'":t=e,a=e;break;case"!":t="!(",a=")";break;case"(":t="(",a=")"}var r=(0,u.get)(this.getInputElement());if(r){var s=o.slice(0,r.textStart)+t+o.slice(r.textStart,r.textEnd)+a+o.slice(r.textEnd);this.update(n.refresh,s)}},t.prototype.getInputElement=function(){var e=i.findDOMNode(this);return null==e?void 0:e.querySelector(".Input")},t.prototype.render=function(){var e=this.state,t=this.props;return s.createElement("div",{className:"ConditionsEditor"},s.createElement(l.Input,{currentText:e.currentText,caretPosition:e.caretPosition,onTextInput:this.update.bind(this),onHotkeyInput:this.handleHotkeys.bind(this),suggestActive:0!==e.suggestVariants.length,lexedHTML:e.lexedHTML,updateHistory:this.updateHistory.bind(this),updateMode:e.updateMode,updateSelectionLength:this.setSelectionLength.bind(this),wrapSelecion:this.wrapSelection.bind(this),useMonospace:t.useMonospace,"data-placeholder":"Дополнительные условия"}),s.createElement(p.SuggestBox,{selectSuggestion:this.handleEnterSuggestion.bind(this),suggestVariants:e.suggestVariants,suggestVariantSelected:e.suggestVariantSelected,useMonospace:t.useMonospace}),s.createElement(c.Controls,{handleClearRestore:this.handleClearRestore.bind(this),clearRestoreStatus:0!==e.storedText.length,charCount:e.currentText.length,selectionLength:e.selectionLength,charCountLimitReached:e.currentText.length>2250,helpPopup:this.callHelpPopup.bind(this),conditionsOnly:this.showConditionOnly.bind(this),removeSpaces:this.removeSpacesFromText.bind(this),mergeBlocks:this.mergeSameFieldBlocks.bind(this)}))},t}(s.Component)},642945:(e,t,a)=>{"use strict";a.d(t,{Controls:()=>u});var n=a(570655),o=a(667294),r=a(448809),s=a(857803),i=a(627155),l=a(259694),c=a(838482),p="Controls__charCount",d=1e3,u=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.charCountLimitReached?"Controls__charCount Controls__charCount--reachedLimit":p;return o.createElement("div",{className:"Controls"},o.createElement("span",{className:"Controls__conditionsOnly",onClick:e.conditionsOnly.bind(this)},o.createElement(c.default,{text:"Только доп. условия",delay:d},o.createElement(s.default,null))),o.createElement("span",{className:"Controls__removeSpaces",onClick:e.removeSpaces.bind(this)},o.createElement(c.default,{text:"Убрать пробелы",delay:d},o.createElement(i.default,null))),o.createElement("span",{className:"Controls__mergeBlocks",onClick:e.mergeBlocks.bind(this)},o.createElement(c.default,{text:"Объединить блоки",delay:d},o.createElement("span",null,"IN"))),o.createElement("span",null),o.createElement("span",{className:t},e.charCount,o.createElement(_,{length:e.selectionLength})),o.createElement("span",{className:"Controls__helpButton",onClick:e.helpPopup.bind(this)},o.createElement(c.default,{text:"Шпаргалка",delay:d},o.createElement(l.default,null))),o.createElement(r.ClearRestoreInputButton,{handleClearRestore:e.handleClearRestore,clearRestoreStatus:e.clearRestoreStatus}))},t}(o.Component);function _(e){return 0===e.length?null:o.createElement("span",null," (",e.length,")")}},189573:(e,t,a)=>{"use strict";a.d(t,{SaveMode:()=>n,History:()=>o});var n;!function(e){e.newState="newState",e.addToCurrent="addToCurrent"}(n||(n={}));var o=function(){function e(e){this.statesQueue=[{text:e,selection:null}],this.currentStateIndex=0,this.lastTimeStateAdded=0}return e.prototype.saveState=function(e,t){var a=(new Date).getTime();this.currentStateIndex!==this.statesQueue.length-1&&this.clearStatesAfterCurrent(),a-this.lastTimeStateAdded>3e3||t===n.newState?(30===this.statesQueue.length&&this.statesQueue.shift(),this.statesQueue.push(e),this.indexIncrement(),this.lastTimeStateAdded=a):this.statesQueue[this.statesQueue.length-1]=e},e.prototype.getPreviousState=function(){return this.indexDecrement(),this.statesQueue[this.currentStateIndex]},e.prototype.getNextState=function(){return this.indexIncrement(),this.statesQueue[this.currentStateIndex]},e.prototype.clearStatesAfterCurrent=function(){this.statesQueue=this.statesQueue.slice(0,this.currentStateIndex+1),this.currentStateIndex=this.statesQueue.length-1,this.lastTimeStateAdded=0},e.prototype.indexIncrement=function(){this.currentStateIndex=this.currentStateIndex<this.statesQueue.length-1?this.currentStateIndex+1:this.statesQueue.length-1},e.prototype.indexDecrement=function(){this.currentStateIndex=this.currentStateIndex>0?this.currentStateIndex-1:0},e}()},328770:(e,t,a)=>{"use strict";a.d(t,{Input:()=>p});var n=a(570655),o=a(667294),r=a(973935),s=a(231451),i=a(460378),l=a(189573),c=["Enter","Tab","ArrowRight","ArrowDown","ArrowUp"],p=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.handleChange=function(e){var t,a=this.props;switch(e.type){case"keydown":if(a.suggestActive&&c.includes(e.key)){switch(e.preventDefault(),e.key){case"Enter":case"Tab":case"ArrowRight":a.onHotkeyInput(i.Hotkeys.suggestEnter);break;case"ArrowDown":a.onHotkeyInput(i.Hotkeys.suggestSelectDown);break;case"ArrowUp":a.onHotkeyInput(i.Hotkeys.suggestSelectUp)}return}if(~["'","!","("].indexOf(e.key)&&!(null===(t=null===window||void 0===window?void 0:window.getSelection())||void 0===t?void 0:t.isCollapsed))return e.preventDefault(),void a.wrapSelecion(e.key);if((e.ctrlKey||e.metaKey)&&90===e.which){e.preventDefault();var n=e.shiftKey?i.Hotkeys.redo:i.Hotkeys.undo;return void a.onHotkeyInput(n)}if("Enter"===e.key)return e.preventDefault(),void a.onTextInput(i.UpdateMode.insert,"\n");e.key.length<2&&!(e.ctrlKey||e.metaKey||e.altKey)&&(e.preventDefault(),a.onTextInput(i.UpdateMode.insert,e.key));break;case"keyup":"Backspace"!==e.key&&"Delete"!==e.key||a.onTextInput(i.UpdateMode.sync);break;case"paste":var o=e;o.preventDefault();var r=o.clipboardData;r&&a.onTextInput(i.UpdateMode.insert,r.getData("Text"));break;case"cut":e.preventDefault(),document.execCommand("copy"),a.onTextInput(i.UpdateMode.insert,"")}},t.prototype.handleSelect=function(e){var t=(0,s.get)(e.target),a=0;t&&"Range"==t.type&&(a=t.textEnd-t.textStart),this.props.updateSelectionLength(a)},t.prototype.shouldComponentUpdate=function(e){return this.props.currentText!==e.currentText},t.prototype.componentDidUpdate=function(){var e=this.props,t=r.findDOMNode(this);if((0,s.setByOffset)(e.caretPosition,e.currentText.length,t),e.updateMode===i.UpdateMode.history)return null;var a=(0,s.get)(t),n=e.updateMode===i.UpdateMode.insert||e.updateMode===i.UpdateMode.sync?l.SaveMode.addToCurrent:l.SaveMode.newState;e.updateHistory(a,n)},t.prototype.render=function(){var e=this.props,t={width:380,height:"auto",minHeight:75,borderRadius:"2px 2px 0 0"};return e.useMonospace&&(t=Object.assign({},t,{fontFamily:i.MONOSPACE_FONTS,lineHeight:"140%",fontSize:"11px"})),o.createElement("div",{className:"Input",contentEditable:"true",suppressContentEditableWarning:!0,spellCheck:!1,style:t,onKeyDown:this.handleChange.bind(this),onKeyUp:this.handleChange.bind(this),onPaste:this.handleChange.bind(this),onCut:this.handleChange.bind(this),onSelect:this.handleSelect.bind(this),dangerouslySetInnerHTML:{__html:e.lexedHTML},placeholder:"Дополнительные условия"})},t}(o.Component)},166480:(e,t,a)=>{"use strict";a.d(t,{SuggestBox:()=>l});var n=a(570655),o=a(667294),r=a(973935),s=a(572181),i=a(460378),l=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.renderSuggestions=function(){var e=this,t=this.props,a=t.suggestVariantSelected;return t.suggestVariants.map((function(n){var r=a===n;return o.createElement(s.Suggestion,{selectSuggestion:t.selectSuggestion.bind(e),isSelected:r,fieldName:n,key:n})}))},t.prototype.componentDidUpdate=function(){var e,t,a=r.findDOMNode(this),n=null===(t=null===(e=null===window||void 0===window?void 0:window.getSelection())||void 0===e?void 0:e.focusNode)||void 0===t?void 0:t.parentElement;if(a&&n){var o=n.getBoundingClientRect();a.style.top=Number(n.offsetTop+o.bottom-o.top)+"px",a.style.left=Number(n.offsetLeft-5)+"px"}},t.prototype.render=function(){var e=this.props;if(0===e.suggestVariants.length)return null;var t={};return e.useMonospace&&(t={fontFamily:i.MONOSPACE_FONTS,fontSize:"11px"}),o.createElement("div",{className:"SuggestBox",style:t},this.renderSuggestions())},t}(o.Component)},572181:(e,t,a)=>{"use strict";a.d(t,{Suggestion:()=>r});var n=a(570655),o=a(667294),r=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.handleSelect=function(){var e=this.props;e.selectSuggestion(e.fieldName)},t.prototype.render=function(){var e=this.props,t="Suggestion";return e.isSelected&&(t+=" Suggestion--selected"),o.createElement("div",{className:t,key:e.fieldName,onClick:this.handleSelect.bind(this)},e.fieldName)},t}(o.Component)},533246:(e,t,a)=>{"use strict";a.d(t,{createMutations:()=>s,createModule:()=>c,destroyModule:()=>p});var n=a(570655),o=a(276018),r=a(917685);function s(e){return{callMutations:function(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(t)))}}}function i(e,t,a,n){(0,r.addEvent)(t,a,n),e._registeredHandlers.push({handlerType:"bind",elem:t,types:a,handler:n})}function l(e,t,a,n,r){(0,o.addDelegateEvent)(t,a,n,r),e._registeredHandlers.push({handlerType:"delegate",elem:t,types:a,selector:n,handler:r})}function c(e){var t={_registeredHandlers:[]};return e.handlers((function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return i.apply(void 0,(0,n.__spreadArray)([t],(0,n.__read)(e)))}),(function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return l.apply(void 0,(0,n.__spreadArray)([t],(0,n.__read)(e)))})),t}function p(e){e._registeredHandlers.forEach((function(e){var t=e.handlerType,a=e.elem,n=e.types,s=e.handler;"delegate"===t?(0,o.removeDelegateEvent)(a,n,e.selector,s):(0,r.removeEvent)(a,n,s)})),e._registeredHandlers=[]}}}]);try{stManager.done("dist/31a7b7e35aec67ab75f663efc68bb96c.c8dc3339f7c3b4bdbded.js")}catch(e){}