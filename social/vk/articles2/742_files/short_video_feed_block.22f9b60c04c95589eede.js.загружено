(()=>{"use strict";var e,t,r,o={155568:(e,t,r)=>{r.d(t,{ShortVideoFeedBlock:()=>l});var o=r(570655),i=r(414914),s=r(917685),n=r(917999),a="ShortVideoFeedBlock__arrow--disabled",l=function(){function e(){this.scrollPos=0,this.clipWidth=100,this.clipsLoading=!1,this.videosNextFrom=null,this.loadMoreCount=0,this.endpoint="clips.php?act=show_more_top",this.isWidget=!1}return e.prototype.init=function(){var e,t,r=this;if(this.wrapper=(0,i.ge)("short_video_feed_block_wrapper"),this.wrapper){var o=this.wrapper.parentElement;this.isWidget=!!o&&o.classList.contains("ShortVideoFeedBlock--widget"),this.container=(0,i.ge)("short_video_feed_block_container"),this.itemsWrapper=(0,i.ge)("short_video_feed_block_items"),this.itemsStub=(0,i.ge)("short_video_feed_block_items_stub"),this.leftArrowEl=(0,i.geByClass1)("ShortVideoFeedBlock__arrow--left",this.container),this.rightArrowEl=(0,i.geByClass1)("ShortVideoFeedBlock__arrow--right",this.container),this.videosNextFrom=this.wrapper.getAttribute("data-next-from"),this.isWidget?(this.endpoint="portlet_clips.php?act=show_more",this._handleTouchMove=function(){r.checkIsNeedLoadMoreOnSwipe()},this._handleTouchEnd=function(){var e=r.itemsWrapper.scrollLeft,t=function(){r.checkIsNeedLoadMoreOnSwipe(),r.itemsWrapper.scrollLeft!==e&&(e=r.itemsWrapper.scrollLeft,window.requestAnimationFrame(t))};window.requestAnimationFrame(t)},this.wrapper.addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this.wrapper.addEventListener("touchend",this._handleTouchEnd,{passive:!0})):(this._leftArrowElClickHandler=function(){r.feedPaging("prev")},this._rightArrowElClickHandler=function(){r.feedPaging("next")},this._feedMouseWheel=function(e){r.feedMouseWheel(e)},this._handleMouseEnter=function(){r.wrapper.addEventListener("wheel",r._feedMouseWheel)},this._handleMouseLeave=function(){r.wrapper.removeEventListener("wheel",r._feedMouseWheel)},this.leftArrowEl.addEventListener("click",this._leftArrowElClickHandler),this.rightArrowEl.addEventListener("click",this._rightArrowElClickHandler),this.wrapper.addEventListener("mouseenter",this._handleMouseEnter),this.wrapper.addEventListener("mouseleave",this._handleMouseLeave),this.updateArrows()),null===(t=null===(e=window.cur)||void 0===e?void 0:e.destroy)||void 0===t||t.push((function(){r.isWidget?(r.wrapper.removeEventListener("touchmove",r._handleTouchMove),r.wrapper.removeEventListener("touchend",r._handleTouchEnd)):(r.leftArrowEl.removeEventListener("click",r._leftArrowElClickHandler),r.rightArrowEl.removeEventListener("click",r._rightArrowElClickHandler),r.wrapper.removeEventListener("wheel",r._feedMouseWheel),r.wrapper.removeEventListener("mouseenter",r._handleMouseEnter),r.wrapper.removeEventListener("mouseleave",r._handleMouseLeave))}))}},e.prototype.checkIsNeedLoadMoreOnSwipe=function(){this.itemsWrapper.scrollWidth-this.itemsWrapper.scrollLeft<=1e3&&this.loadMore()},e.prototype.updateArrows=function(){var e=this.wrapper.offsetWidth,t=this.itemsWrapper.scrollWidth-e;0===this.scrollPos?(0,i.addClass)(this.leftArrowEl,a):(0,i.removeClass)(this.leftArrowEl,a),this.scrollPos===t||t<=0?(0,i.addClass)(this.rightArrowEl,a):(0,i.removeClass)(this.rightArrowEl,a)},e.prototype.feedPaging=function(e,t){void 0===t&&(t=!1);var r=this.scrollPos,o=(0,i.getSize)(this.itemsWrapper)[0],s=o-this.clipWidth;(0,n.isNumeric)(e)?r+=e:"next"===e?r+=s:r-=s,(0,i.toggleClass)(this.itemsWrapper,"ShortVideoFeedBlock__itemsWrapper--noAnimation",t),this.scrollPos=Math.max(0,Math.min(r,this.itemsWrapper.scrollWidth-o)),(0,i.setStyle)(this.itemsWrapper,"transform","translateX(-"+this.scrollPos+"px)"),this.updateArrows(),this.itemsWrapper.scrollWidth-this.scrollPos<=1e3&&this.loadMore()},e.prototype.feedMouseWheel=function(e){(0,s.cancelEvent)(e);var t=Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX;this.feedPaging(t,!0)},e.prototype.loadMore=function(){var e=this;this.loadMoreCount>=2||this.videosNextFrom&&!this.clipsLoading&&(this.clipsLoading=!0,this._fetchClips().then((function(t){var r=t.html,o=t.nextFrom;if(e.clipsLoading=!1,e.videosNextFrom=o||"",e.itemsWrapper.insertAdjacentHTML("beforeend",r||""),e.loadMoreCount++,e.isWidget||e.updateArrows(),e.isWidget&&2==e.loadMoreCount){var i=e.itemsStub.cloneNode(!0);i.classList.remove("ShortVideoFeedBlock__itemsStub--hidden"),e.itemsWrapper.insertAdjacentHTML("beforeend",i.outerHTML)}})).catch((function(){})))},e.prototype._fetchClips=function(){if(!this.videosNextFrom)return Promise.reject();var e=new FormData;return e.append("next_from",this.videosNextFrom),e.append("al","1"),fetch(this.endpoint,{method:"POST",body:e}).then(d).then((function(e){return e.text()})).then((function(e){try{e=e.replace(/^<!--/,"");var t=JSON.parse(e);if(t&&t.payload&&t.payload[1]){var r=(0,o.__read)(t.payload[1],2),i=r[0],s=r[1];return Promise.resolve({html:i,nextFrom:s})}return Promise.resolve({})}catch(e){return Promise.reject(e)}})).catch((function(e){return Promise.reject(e)}))},e}();function d(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){var t,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=Response.bind,i=(r=new TextDecoder("windows-1251")).decode,[4,e.arrayBuffer()];case 1:return[2,new(t.apply(Response,[void 0,i.apply(r,[o.sent()])]))]}}))}))}},125429:(e,t,r)=>{var o=r(155568);window.ShortVideoFeedBlock=new o.ShortVideoFeedBlock;try{window.stManager.done(window.jsc("web/short_video_feed_block.js"))}catch(e){}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return o[e].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=o,e=[],s.O=(t,r,o,i)=>{if(!r){var n=1/0;for(h=0;h<e.length;h++){for(var[r,o,i]=e[h],a=!0,l=0;l<r.length;l++)(!1&i||n>=i)&&Object.keys(s.O).every((e=>s.O[e](r[l])))?r.splice(l--,1):(a=!1,i<n&&(n=i));if(a){e.splice(h--,1);var d=o();void 0!==d&&(t=d)}}return t}i=i||0;for(var h=e.length;h>0&&e[h-1][2]>i;h--)e[h]=e[h-1];e[h]=[r,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);s.r(i);var n={};t=t||[null,r({}),r([]),r(r)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=r(a))Object.getOwnPropertyNames(a).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,s.d(i,n),i},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.e=()=>Promise.resolve(),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={3618:0};s.O.j=t=>0===e[t];var t=(t,r)=>{var o,i,[n,a,l]=r,d=0;for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var h=l(s);for(t&&t(r);d<n.length;d++)i=n[d],s.o(e,i)&&e[i]&&e[i][0](),e[n[d]]=0;return s.O(h)},r=self.webpackChunkvk=self.webpackChunkvk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=s.O(void 0,[8592],(()=>s(125429)));n=s.O(n)})();