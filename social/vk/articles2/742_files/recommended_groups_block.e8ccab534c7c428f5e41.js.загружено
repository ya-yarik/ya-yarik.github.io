(()=>{"use strict";var t,e,i,s={304418:(t,e,i)=>{i.d(e,{uiGetGallery:()=>o,UIGallery:()=>l});var s=i(257451),r=(0,s.makeSharedState)("ui-gallery",(()=>({galleries:{},incIndex:0})));function o(t){var e=domData(ge(t),"gallery-id");return e&&r().galleries[e]}class l{constructor(t,e){if(!t)throw new Error("No element was provided for UIGallery");if(t=ge(t),!hasClass(t,"ui_gallery"))throw new Error("Provided incorrect element for UIGallery");var i=o(t);if(i)return i;this._opts=extend({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1},e),this._id=r().incIndex,r().incIndex+=1,this._el=t,this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._itemWidth=getSize(this._items[0])[0],this._itemOffset=intval(getStyle(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=intval(getStyle(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=geByClass1("ui_gallery__inner_cont",this._el),this._inner=geByClass1("ui_gallery__inner",this._el),this._scroll=function(){var t={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return t;if(!cur._scrollInfo){var e=se('<div style="position: fixed; left: -1000; width: 0; overflow: scroll">x</div>');ge("content").appendChild(e);var i=e.scrollLeft;t.rtl=vk.rtl,t.backward=i>0,e.scrollLeft=1e3,t.delta=e.scrollLeft===i?-1:1,t.negative=!t.backward&&t.delta<0,t.rtlSame=t.rtl&&!t.backward&&!t.negative,re(e),cur._scrollInfo=t}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[]},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),domData(this._el,"gallery-id",this._id),r().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&addEvent(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this))}_initArrows(){this._opts.noArrows?addClass(this._el,"ui_gallery_no_arrows"):(this._leftArrow=geByClass1("ui_gallery__arrow_left",this._el),this._rightArrow=geByClass1("ui_gallery__arrow_right",this._el),this._arrowWidth=getSize(this._leftArrow)[0],addEvent(this._leftArrow,"click",this._onArrowScroll.bind(this,-1)),addEvent(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),addEvent(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),addEvent(this._rightArrow,"click",this._onArrowScroll.bind(this,1)),addEvent(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),addEvent(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(t){if(this._opts.scrollX||this._opts.scrollY){var e;if("wheel"==t.type)if(Math.abs(t.deltaY)>Math.abs(t.deltaX)){if(!this._opts.scrollY)return;e=-t.deltaY}else{if(!this._opts.scrollX)return;e=-t.deltaX}else if(void 0!==t.wheelDeltaY){if(!this._opts.scrollY)return;e=t.wheelDeltaY}else if(void 0!==t.wheelDelta)e=t.wheelDelta;else{if(!t.detail||1!==t.axis)return;e=-t.detail}e=this._scroll.rtlSame?-e:e,Math.abs(e)>=120&&(e=74*Math.max(-1,Math.min(1,e))),this._innerCont.scrollLeft-=e,this._checkItemsAfterScroll(this._innerCont.scrollLeft),cancelEvent(t)}}_onArrowScroll(t,e){if(!this._opts.noArrows){var i=this._innerCont.scrollLeft+(this._scroll.rtlSame?-t:t)*(this._width-2*this._arrowWidth),s=this._innerCont.scrollWidth-this._width;this._scroll.negative?(i=Math.min(i,0),i=Math.abs(i)):i=Math.max(0,i),i=Math.min(s,i);var r=this._scroll.negative||this._scroll.rtlSame?-t:t;if(r>0&&i<s)i=Math.floor(i/this._itemFullWidth)*this._itemFullWidth;else if(r<0&&i>0){i=Math.floor(i/this._itemFullWidth)*this._itemFullWidth}if(0===i||i===s){var o=this._innerCont.scrollWidth;addClass(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),i&&(i+=t*(this._innerCont.scrollWidth-o))}this._scroll.negative&&(i=-i),animate(this._innerCont,{scrollLeft:i},{duration:Math.abs(this._innerCont.scrollLeft-i)+50,transition:Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(i),setTimeout((()=>removeClass(this._inner,"ui_gallery__inner_shift_instant")),0),cancelEvent(e)}}_checkItemsAfterScroll(t,e){if(this._scroll.negative&&(t=Math.abs(t)),this._opts.markOutside||this._opts.onViewItem){var i,s=this._itemWidth/3,r=(this._scroll.backward?this._inner.scrollWidth-this._width-t:t)-this._scrollOffset,o=t&&Math.floor(r/this._itemFullWidth),l=o*this._itemFullWidth+2*s;i=this._scroll.backward?t+this._width<this._inner.scrollWidth-l:t>l;var n,a=Math.min(this._items.length-1,Math.floor((r+this._width)/this._itemFullWidth)),h=a*this._itemFullWidth+2*s;if(n=this._scroll.backward?t>this._inner.scrollWidth-h:t+this._width<h,this._opts.onViewItem){var _=i?Math.min(this._items.length-1,o+1):o,d=n?Math.max(0,a-1):a;if(e||_!==this._visible.left||d!==this._visible.right){for(var c=_;c<=d;c++)(this._visible.left<0||e&&!inArray(this._items[c],this._visible.items)||c<this._visible.left||c>this._visible.right)&&this._opts.onViewItem(this._items[c],c);this._visible.left=_,this._visible.right=d,this._visible.items=this._items.slice(_,d+1)}}this._opts.markOutside&&(e?(geByClass("ui_gallery_item_outside",this._inner).forEach((t=>{removeClass(t,"ui_gallery_item_outside")})),this._outside.left=-1,this._outside.right=-1):((o!==this._outside.left||!i)&&this._outside.left>=0&&(removeClass(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(a!==this._outside.right||!n)&&this._outside.right>=0&&(removeClass(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),i&&o!==this._outside.left&&(addClass(this._items[o],"ui_gallery_item_outside"),this._outside.left=o),n&&a!==this._outside.right&&(addClass(this._items[a],"ui_gallery_item_outside"),this._outside.right=a))}if(!this._opts.noArrows){var u=t>0,g=t+this._width<this._inner.scrollWidth;toggleClass(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?g:u),toggleClass(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?u:g)}(!this._scroll.backward&&this._inner.scrollWidth-t-this._width<1e3||this._scroll.backward&&t<1e3)&&this._onLoadMore()}_onArrowMouseOver(t){this._opts.noArrows||addClass(this._inner,"ui_gallery__inner_shift_"+t)}_onArrowMouseOut(){this._opts.noArrows||(removeClass(this._inner,"ui_gallery__inner_shift_left"),removeClass(this._inner,"ui_gallery__inner_shift_right"))}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(t,e){t=t||[],this.addItems(t),this._finised=!!e||!t.length,this._loadingMore=!1}addItems(t,e){if((t=t||[]).length){var i=e>=0&&e<this._items.length?this._items[e]:null;t.forEach((t=>{i?domInsertBefore(t,i):this._inner.appendChild(t)})),this.refresh()}}destroy(){removeEvent(this._innerCont),removeEvent(this._leftArrow),removeEvent(this._rightArrow),domData(this._el,"gallery-id",null),delete r().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),re(this._el)}removeItem(t){return isNumeric(t)&&(t=this._items[t]),!(!t||!inArray(t,this._items))&&(re(t),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}getItems(){return this._items}getVisibleItems(){return this._visible.items.map(((t,e)=>[t,this._visible.left+e]))}}},221943:(t,e,i)=>{i.d(e,{RecommendedGroupsEventLog:()=>o});var s=i(570655),r=i(651988),o=function(){function t(t,e){this.sendLogsTimeout=null,this.sendLogsProcess=!1,this.localStorageKey="recommended_groups",this.logsDataDelimiter="|",this.location=t,this.act=e}return t.prototype.sendLogs=function(){this.sendLogsTimeout&&clearTimeout(this.sendLogsTimeout),this.sendLogsTimeout=setTimeout(this.sendLogsAccept.bind(this),1e4)},t.prototype.sendLogsAccept=function(){var t=this;if(!this.sendLogsProcess){var e=this.getLogs(!0);e.length&&(this.sendLogsProcess=!0,this.clearLogs(),window.ajax.post(this.location,{act:this.act,logs:e},{onDone:function(){t.sendLogsProcess=!1},onFail:function(){return t.restoreLogs(e),t.sendLogsProcess=!1,!0}}))}},t.prototype.restoreLogs=function(t){var e=this,i=this.getLogs(),o=t.map((function(t){return t.split(e.logsDataDelimiter)})),l=(0,s.__spreadArray)((0,s.__spreadArray)([],(0,s.__read)(o)),(0,s.__read)(i));r.default.set(this.localStorageKey,l)},t.prototype.getLogs=function(t){var e=this,i=r.default.get(this.localStorageKey)||[];return t&&(i=i.map((function(t){return t.join(e.logsDataDelimiter)}))),i},t.prototype.addLog=function(t){var e=this.getLogs(),i=t.eventType,s=t.trackCode,o=t.groupId,l=o?[i,s,o]:[i,s];e.push(l),r.default.set(this.localStorageKey,e),this.sendLogs()},t.prototype.clearLogs=function(){r.default.remove(this.localStorageKey)},t}()},988914:(t,e,i)=>{var s=i(752174);window.RecommendedGroups=new s.RecommendedGroups;try{window.stManager.done(window.jsc("web/recommended_groups_block.js"))}catch(t){}},752174:(t,e,i)=>{i.d(e,{RecommendedGroups:()=>d});var s=i(414914),r=i(304418),o=i(64385),l=i(791563),n=i(116886),a=i(705456),h=i(917685),_=i(221943),d=function(){function t(){}return t.prototype.init=function(){var t=this;if(this.gallery=(0,s.geByClass1)("groups_recomm_gallery"),this.block=(0,s.geByClass1)("feed_groups_recomm"),this.eventLog=new _.RecommendedGroupsEventLog("al_groups.php","a_group_recommends_logs"),this.gallery){var e=(0,s.domData)(this.gallery,"code"),i={scrollY:!1,onViewItem:function(e){var i;(null===(i=t.gallery)||void 0===i?void 0:i.visible)&&t.onViewGroup(e)}};(0,s.domData)(this.gallery,"next")&&(i.onLoadMore=function(){o.ajax.post("al_groups.php",{act:"a_recomm_groups_gallery",next:(0,s.domData)(t.gallery,"next"),track_code:e},{onDone:function(e,i){var o,l=[];e&&(l=(0,s.domChildren)((0,s.ce)("div",{innerHTML:e}))),null===(o=(0,r.uiGetGallery)(t.gallery))||void 0===o||o.addMore(l,!i),(0,s.domData)(t.gallery,"next",i||null)}})}),new r.UIGallery(this.gallery,i)}},t.prototype.subscribe=function(t,e,i){e.preventDefault();var s=t.closest(".wall_card"),r=s.dataset,h=r.groupId,_=r.trackCode;if(h&&_){this.eventLog.addLog({eventType:"group_subscribed",groupId:h,trackCode:_});var d={act:"a_subscribe_from_recomm_groups",hash:i,oid:-h,track_code:s.dataset.code};o.ajax.post("al_groups.php",d,{onDone:function(e){t.classList.add("secondary"),t.innerHTML=e,t.onclick=null},onFail:function(t){if(t)return(0,l.showFastBox)({title:(0,n.getLang)("global_error")},t),!0},showProgress:function(){return(0,a.lockButton)(t)},hideProgress:function(){return(0,a.unlockButton)(t)}})}},t.prototype.closeGroup=function(t,e,i){var _=this,d=t.closest(".wall_card").dataset,c=d.groupId,u=d.trackCode;if(c&&u)return this.eventLog.addLog({eventType:"group_hidden",groupId:c,trackCode:u}),o.ajax.post("al_groups.php",{act:"a_hide_recomm_groups_block_group",group_id:c,track_code:u,hash:i},{onDone:function(){var e=(0,r.uiGetGallery)(_.gallery);if(e){var i=(0,s.gpeByClass)("ui_gallery_item",t);e.removeItem(i)}},onFail:function(t){if(t)return(0,l.showFastBox)((0,n.getLang)("global_error"),t),!0},showProgress:function(){return(0,a.lockButton)(t)},hideProgress:function(){return(0,a.unlockButton)(t)}}),(0,h.cancelEvent)(e),!1},t.prototype.hideBlock=function(t,e,i){(0,s.hide)(this.block),e.preventDefault();var r=(0,s.domData)(this.gallery,"code");this.eventLog.addLog({eventType:"block_hidden",trackCode:r}),o.ajax.post("al_groups.php",{act:"a_hide_recomm_groups_block",hash:i,track_code:r})},t.prototype.onViewGroup=function(t){if(!t.viewed&&(0,s.hasClass)(t,"ui_gallery_item")){var e=t.dataset,i=e.groupId,r=e.trackCode;i&&r&&(this.eventLog.addLog({trackCode:r,groupId:i,eventType:"group_seen"}),t.viewed=!0)}},t.prototype.clickOnGroup=function(t){var e=t.closest(".wall_card").dataset,i=e.groupId,s=e.trackCode;i&&s&&this.eventLog.addLog({trackCode:s,groupId:i,eventType:"group_opened"})},t.prototype.clickOnViewAll=function(){var t=(0,s.domData)(this.gallery,"code");t&&this.eventLog.addLog({trackCode:t,eventType:"block_expanded"})},t.prototype.viewBlock=function(t){this.eventLog.addLog({trackCode:t,eventType:"block_seen"})},t}()}},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var i=r[t]={id:t,loaded:!1,exports:{}};return s[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=s,t=[],o.O=(e,i,s,r)=>{if(!i){var l=1/0;for(_=0;_<t.length;_++){for(var[i,s,r]=t[_],n=!0,a=0;a<i.length;a++)(!1&r||l>=r)&&Object.keys(o.O).every((t=>o.O[t](i[a])))?i.splice(a--,1):(n=!1,r<l&&(l=r));if(n){t.splice(_--,1);var h=s();void 0!==h&&(e=h)}}return e}r=r||0;for(var _=t.length;_>0&&t[_-1][2]>r;_--)t[_]=t[_-1];t[_]=[i,s,r]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(t,s){if(1&s&&(t=this(t)),8&s)return t;if("object"==typeof t&&t){if(4&s&&t.__esModule)return t;if(16&s&&"function"==typeof t.then)return t}var r=Object.create(null);o.r(r);var l={};e=e||[null,i({}),i([]),i(i)];for(var n=2&s&&t;"object"==typeof n&&!~e.indexOf(n);n=i(n))Object.getOwnPropertyNames(n).forEach((e=>l[e]=()=>t[e]));return l.default=()=>t,o.d(r,l),r},o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={6925:0};o.O.j=e=>0===t[e];var e=(e,i)=>{var s,r,[l,n,a]=i,h=0;for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(a)var _=a(o);for(e&&e(i);h<l.length;h++)r=l[h],o.o(t,r)&&t[r]&&t[r][0](),t[l[h]]=0;return o.O(_)},i=self.webpackChunkvk=self.webpackChunkvk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var l=o.O(void 0,[8592],(()=>o(988914)));l=o.O(l)})();