(()=>{var e,t,n,a={595318:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},750008:e=>{function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},337057:(e,t,n)=>{"use strict";n.d(t,{VkIndexer:()=>a});var a=function(){function e(e,t,n){this.delimiter=new RegExp("[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\#\\+\\?\\\\]+","g"),this.trimmer=new RegExp("^[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\+\\?\\\\]+|[\\s\\-,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\\\]+$","g"),this.toTranslit={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1078:"zh",1079:"z",1080:"i",1081:"y",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"ts",1095:"ch",1096:"sh",1097:"sh",1099:"y",1101:"e",1102:"yu",1103:"ya",1105:"e",1098:"",1100:""},this.toLocalCase={f:"a",",":"b","<":"b",d:"v",u:"g",l:"d",t:"e",";":"zh",":":"zh",p:"z",b:"i",q:"y",r:"k",k:"l",v:"m",y:"n",j:"o",g:"p",h:"r",c:"s",n:"t",e:"u",a:"f","[":"h","{":"kh",w:"ts",x:"ch",i:"sh",o:"sh",s:"y","'":"e",'"':"e",".":"yu",">":"yu",z:"ya","`":"e","~":"e",m:"","]":"","}":""},this.toLocalTranslit={1072:"f",1074:"d",1075:"u",1076:"l",1077:"t",1079:"p",1080:"b",1081:"q",1082:"r",1083:"k",1084:"v",1085:"y",1086:"j",1087:"g",1088:"h",1089:"c",1090:"n",1091:"e",1092:"a",1094:"w",1095:"x",1096:"i",1097:"o",1099:"s",1103:"z",1098:"m"},this.list=e||[],this.iterCur=0,this.iterEnd=e?e.length:0,this.index={},this.callback=n||function(){},this.prepareFunc=t||function(e){return e},setTimeout(this.indexIteration.bind(this),10)}return e.prototype.indexIteration=function(){for(var e=Math.min(this.iterEnd,this.iterCur+200),t=this.iterCur;t<e;t++){var n=this.list[t];try{n._order=t}catch(e){}this.add(n)}this.iterCur=t,t>=this.iterEnd?this.callback(this):setTimeout(this.indexIteration.bind(this),10)},e.prototype.strToPrefixes=function(e){for(var t,n={},a=(t=e,t.replace(/&#(\d\d+);/g,(function(e,t){return(t=!0===(n=t)?1:parseInt(n)||0)>=32?String.fromCharCode(t):e;var n})).replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")).toLowerCase().split(this.delimiter),r=a.length;r--;){var i=a[r],o="";if(i){for(var l=0;l<6;l++){var s=i.charCodeAt(l);if(s){var c=this.toTranslit[s],u=i.substr(l,1);o+=null!=c?c:u}}n[o]=1}}return n},e.prototype.strToSearchPrefixes=function(e){for(var t=[],n=e.toLowerCase().split(this.delimiter),a=n.length;a--;){var r={},i=n[a],o="",l="",s="",c=i.length>1;if(i){for(var u=0;u<6;u++){var d=i.charCodeAt(u);if(d){var p=this.toTranslit[d],A=i.substr(u,1);if(o+=null!=p?p:A,c){var _=this.toLocalCase[A],m=this.toLocalTranslit[d];l+=null!=_?_:A,s+=null!=m?m:A}}}r[o]=1,c&&(r[l]=2,r[s]=3),t.push(r)}}return t},e.prototype.toIndexTree=function(e,t){for(var n=this.index,a=0;a<6;a++){var r=e.substr(a,1)||-1;n=n[r]?n[r]:n[r]=5==a?[]:{}}n.push(t)},e.prototype.remove=function(e){var t=this.prepareFunc(e),n=this.strToPrefixes(t);for(var a in n)if(n.hasOwnProperty(a)){for(var r=this.index,i=0;i<6;i++){var o=a.substr(i,1)||-1;if(!r[o])break;r=r[o]}if(r.length)for(var i in r)if(this.equals(r[i],e)){r.splice(i,1);break}}},e.prototype.equals=function(e,t){for(var n in e)if(e.hasOwnProperty(n))switch(typeof e[n]){case"object":if(!this.equals(e[n],t[n]))return!1;break;case"function":if(void 0===e[n]||e[n].toString()!=t[n].toString())return!1;break;default:if(e[n]!=t[n])return!1}for(var n in t)if(void 0===t[n])return!1;return!0},e.prototype.intersect=function(e,t){var n=[];if(r(e[0])||r(t[0]))return e.filter((function(e){return-1!==t.indexOf(e)}));for(;e.length>0&&t.length>0;)if(e[0]._order<t[0]._order)e.shift();else if(e[0]._order>t[0]._order)t.shift();else{if(this.equals(e[0],t[0])){var a=e.shift();a&&n.push(a)}t.shift()}return n},e.prototype.add=function(e){var t=this.prepareFunc(e),n=this.strToPrefixes(t);for(var a in n)n.hasOwnProperty(a)&&this.toIndexTree(a,e)},e.prototype.search=function(e){var t=this.index,n=this.strToSearchPrefixes(e),a=[],r=!1;for(var i in n)if(n.hasOwnProperty(i)){if(r&&!a)break;var o=this.localSearch(n[i],0,t);o.sort((function(e,t){return e._order-t._order})),a=r?this.intersect(a,o):o,r=!0}for(var l=a[0],s=a.length+1,c=[],u=1;u<s;u++){var d=a[u];d!=l&&(c.push(l),l=d)}return c},e.prototype.localSearch=function(e,t,n){if(!n)return[];var a={};for(var r in e)e.hasOwnProperty(r)&&(a[o=r.substr(t,1)||-1]||(a[o]={}),a[o][r]=1);if(6==t++)return n;var i=[];for(var o in a)if("-1"===o)for(var l in n)n.hasOwnProperty(l)&&i.push.apply(i,this.localSearch(a[o],t,n[l]));else{var s=this.localSearch(a[o],t,n[o]);i.push.apply(i,s)}return i},e}();function r(e){return!isNaN(e)}},774351:(e,t,n)=>{"use strict";function a(e,t){return new Promise((function(n){setTimeout(n.bind(null,t),1e3*e)}))}n.d(t,{pause:()=>a})},788822:(e,t,n)=>{"use strict";n.d(t,{decodeHTMLEntities:()=>i,escape:()=>r});var a=[["&amp;","&"],["&lt;","<"],["&gt;",">"],["&quot;",'"']];function r(e){return a.reduce((function(e,t){var n=t[0],a=t[1];return e.replace(new RegExp(a,"ig"),n)}),e)}function i(e){return a.reduce((function(e,t){var n=t[0],a=t[1];return e.replace(new RegExp(n,"ig"),a)}),e).replace(/&#(\d+);/g,(function(e,t){return String.fromCodePoint(t)}))}},389953:(e,t,n)=>{"use strict";function a(e){return e>0&&e<2e9}function r(e){return e>2e9}n.d(t,{isChatPeer:()=>r,isUserPeer:()=>a})},700881:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 12 12",u="cancel_outline_12",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="cancel_outline_12"><path clip-rule="evenodd" d="M9.03 2.97a.75.75 0 010 1.06L7.06 6l1.97 1.97a.75.75 0 01-1.06 1.06L6 7.06 4.03 9.03a.75.75 0 01-1.06-1.06L4.94 6 2.97 4.03a.75.75 0 011.06-1.06L6 4.94l1.97-1.97a.75.75 0 011.06 0z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};A.mountIcon=p;const _=A},297627:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="connection_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="connection_16"><g fill="currentColor"><path d="M12 3a1 1 0 00-1 1v8a1 1 0 102 0V4a1 1 0 00-1-1zM7 6a1 1 0 012 0v6a1 1 0 11-2 0zM3 8a1 1 0 012 0v4a1 1 0 11-2 0z" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},722254:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="microphone_slash_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="microphone_slash_16"><path d="M5.498 7.06v.44a2.501 2.501 0 002.909 2.467l1.2 1.198a4.005 4.005 0 01-5.521-2.822.75.75 0 00-1.47.314A5.508 5.508 0 007.25 12.95v1.301a.75.75 0 001.502 0v-1.3a5.473 5.473 0 001.972-.669l1.25 1.25a.751.751 0 001.062-1.061L3.88 3.32a.75.75 0 10-1.06 1.06l2.678 2.68zm6.356 1.529c-.089.314-.03.66.2.89.37.37.993.284 1.16-.211a5.44 5.44 0 00.17-.61.75.75 0 10-1.469-.315 3.943 3.943 0 01-.061.246zM6.303 2.662c-.332.307-.254.818.066 1.138l3.428 3.424a.4.4 0 00.683-.279l.022-2.445a2.501 2.501 0 00-4.199-1.838z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},607350:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="pin_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin_16"><path d="M10.235 2.106l3.657 3.663c.225.226.064.633-.263.633h-.523a.895.895 0 00-.633.263L10.758 8.38a.896.896 0 00-.262.633v2.996c0 .554-.7.858-1.1.456l-2.301-2.3-3.57 3.57a.893.893 0 11-1.264-1.263L5.83 8.898l-2.29-2.29c-.391-.392-.109-1.102.456-1.102H6.99a.895.895 0 00.633-.262L9.338 3.53a.896.896 0 00.263-.634V2.37c0-.32.403-.495.634-.263z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},86339:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="pin_dot_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin_dot_16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.25 4a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5zm7.642 1.77l-3.657-3.664c-.231-.232-.634-.057-.634.263v.526a.896.896 0 01-.263.634L7.623 5.244a.895.895 0 01-.633.262H3.995c-.565 0-.847.71-.455 1.102l2.29 2.29-3.569 3.574a.894.894 0 001.263 1.264l3.57-3.572 2.301 2.301c.402.402 1.101.098 1.101-.456V9.013a.9.9 0 01.262-.633l1.715-1.715a.895.895 0 01.633-.263h.523c.327 0 .488-.407.263-.633z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},733024:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="cancel_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="cancel_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M18.3 5.7a.99.99 0 00-1.4 0L12 10.6 7.1 5.7a.99.99 0 00-1.4 1.4l4.9 4.9-4.9 4.9a.99.99 0 001.4 1.4l4.9-4.9 4.9 4.9a.99.99 0 001.4-1.4L13.4 12l4.9-4.9a.99.99 0 000-1.4z" fill="currentColor" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};A.mountIcon=p;const _=A},25347:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="door_arrow_left_outline_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="door_arrow_left_outline_24"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.754 20.366c-.763.407-1.512.534-3.082.534H13a.9.9 0 110-1.8h2.672c1.487 0 1.87-.128 2.233-.322.336-.18.594-.437.773-.773.194-.362.322-.746.322-2.233V8.228c0-1.487-.128-1.87-.322-2.233a1.847 1.847 0 00-.773-.774c-.362-.193-.746-.321-2.233-.321H13a.9.9 0 110-1.8h2.672c1.57 0 2.32.127 3.082.534.65.348 1.164.863 1.512 1.512.407.762.534 1.512.534 3.082v7.544c0 1.57-.127 2.32-.534 3.082a3.646 3.646 0 01-1.512 1.512zm-9.39-5.002l2.463-2.464H3.9a.9.9 0 110-1.8h7.927L9.364 8.636a.9.9 0 111.272-1.272l4 4a.9.9 0 010 1.272l-4 4a.9.9 0 11-1.272-1.272z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};A.mountIcon=p;const _=A},573669:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="live_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="live_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M12 22.5C6.201 22.5 1.5 17.799 1.5 12S6.201 1.5 12 1.5 22.5 6.201 22.5 12 17.799 22.5 12 22.5zm0-2a8.5 8.5 0 100-17 8.5 8.5 0 000 17zm0-2a6.5 6.5 0 110-13 6.5 6.5 0 010 13zm0-2a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2a2.5 2.5 0 110-5 2.5 2.5 0 010 5z" fill="currentColor" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};A.mountIcon=p;const _=A},835849:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="download_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="download_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M21 22a1 1 0 110 2H7a1 1 0 010-2h14zM14 2a1 1 0 011 1v13.585l5.293-5.292a1 1 0 011.414 1.414l-7 7a1 1 0 01-1.414 0l-7-7a1 1 0 011.414-1.414L13 16.585V3a1 1 0 011-1z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},196287:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="laptop_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="laptop_outline_28"><path clip-rule="evenodd" d="M8 5h-.151c-.781 0-1.4-.001-1.93.171A3.5 3.5 0 003.67 7.418C3.5 7.95 3.5 8.568 3.5 9.348V19H2.162a1.162 1.162 0 00-.367 2.265l1.466.489c.276.092.415.138.556.17.125.029.253.05.38.062.145.014.29.014.582.014H23.22c.291 0 .437 0 .581-.014.128-.012.256-.033.381-.062.141-.032.28-.078.556-.17l1.466-.49A1.162 1.162 0 0025.838 19H24.5V9.349c0-.781.001-1.4-.171-1.93a3.5 3.5 0 00-2.247-2.248C21.55 5 20.932 5 20.152 5H20zM6.536 7.073C6.724 7.013 6.992 7 8 7h12c1.008 0 1.276.012 1.464.073a1.5 1.5 0 01.963.963c.06.188.073.456.073 1.464V19h-17V9.5c0-1.008.012-1.276.073-1.464a1.5 1.5 0 01.963-.963z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},590439:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="user_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="user_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M17.5 8.5C17.5 6.566 15.934 5 14 5a3.499 3.499 0 00-3.5 3.5c0 1.934 1.566 3.5 3.5 3.5s3.5-1.566 3.5-3.5zm2 0c0 3.039-2.461 5.5-5.5 5.5a5.499 5.499 0 01-5.5-5.5C8.5 5.461 10.961 3 14 3s5.5 2.461 5.5 5.5zM7 20.643c0 .943-.08.857.456.857h13.588c.536 0 .456.086.456-.857 0-2.288-3.304-3.643-7.25-3.643S7 18.355 7 20.643zm-2 0C5 16.763 9.299 15 14.25 15s9.25 1.763 9.25 5.643c0 2.016-.781 2.857-2.456 2.857H7.456C5.78 23.5 5 22.66 5 20.643z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},443774:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 29 28",u="videocam_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 28" id="videocam_outline_28"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.857 5h4.286c1.084 0 1.958 0 2.666.058.729.06 1.369.185 1.961.487a5 5 0 012.185 2.185c.231.454.36.936.433 1.464l.437-.284.903-.585c.239-.155.52-.338.773-.471.255-.134.794-.395 1.482-.348a2.7 2.7 0 011.975 1.07c.415.552.49 1.148.516 1.434.026.285.026.62.026.904v6.172c0 .284 0 .619-.026.904-.026.286-.1.882-.516 1.434a2.7 2.7 0 01-1.975 1.07c-.688.047-1.227-.214-1.482-.348a10.407 10.407 0 01-.773-.47l-.905-.588-.435-.282c-.074.528-.202 1.01-.433 1.464a5 5 0 01-2.185 2.185c-.592.302-1.232.428-1.961.487C16.1 23 15.227 23 14.143 23H9.857c-1.084 0-1.958 0-2.666-.058-.728-.06-1.369-.185-1.96-.487a5 5 0 01-2.186-2.185c-.302-.592-.428-1.232-.487-1.961C2.5 17.6 2.5 16.727 2.5 15.643v-3.286c0-1.084 0-1.958.058-2.666.06-.728.185-1.369.487-1.961A5 5 0 015.23 5.545c.592-.302 1.233-.428 1.961-.487C7.9 5 8.773 5 9.857 5zM21.5 15.643v-4.138l2.27-1.472c.563-.365.844-.548 1.077-.532a.7.7 0 01.513.277c.14.187.14.522.14 1.192v6.06c0 .67 0 1.005-.14 1.192a.7.7 0 01-.513.277c-.233.016-.514-.167-1.077-.532l-2.27-1.472v-.852zM7.354 7.05c-.605.05-.953.142-1.216.276a3 3 0 00-1.311 1.311c-.134.263-.226.611-.276 1.216-.05.617-.051 1.41-.051 2.546v3.2c0 1.137 0 1.929.051 2.546.05.605.142.953.276 1.216a3 3 0 001.311 1.311c.263.134.611.226 1.216.276.617.05 1.41.051 2.546.051h4.2c1.137 0 1.929 0 2.546-.051.605-.05.953-.142 1.216-.276a3 3 0 001.311-1.311c.134-.263.226-.611.276-1.216.05-.617.051-1.41.051-2.546v-3.2c0-1.137 0-1.929-.051-2.546-.05-.605-.142-.953-.276-1.216a3 3 0 00-1.311-1.311c-.263-.134-.611-.226-1.216-.276-.617-.049-1.41-.05-2.546-.05H9.9c-1.137 0-1.929 0-2.546.051z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?29:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},76854:(e,t,n)=>{"use strict";n.d(t,{IconSettingsContext:()=>i,IconSettingsProvider:()=>o});var a=n(667294);function r(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=(0,a.createContext)({}),o=function(e){var t=e.children,n=r(e,["children"]),o=(0,a.useMemo)((function(){return n}),[n.classPrefix,n.globalClasses]);return a.createElement(i.Provider,{value:o},t)}},379333:(e,t,n)=>{"use strict";n.d(t,{SvgIcon:()=>d});var a=n(667294),r=n(76854);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u={display:"block"};var d=function(e){var t=e.width,n=e.height,o=e.viewBox,s=e.id,d=e.className,p=e.style,A=e.fill,_=e.getRootRef,m=e.Component,g=c(e,["width","height","viewBox","id","className","style","fill","getRootRef","Component"]),f=Math.max(t,n),v=(0,a.useContext)(r.IconSettingsContext),E=function(e,t){for(var n=t.classPrefix,a=t.globalClasses,r="",i=0;i<e.length;i++)n&&(r+=" "+(n+e[i])),n&&!a||(r+=" "+e[i]);return r}(["Icon","Icon--".concat(f),"Icon--w-".concat(t),"Icon--h-".concat(n),"Icon--".concat(s)],v);return a.createElement(m,i({role:"presentation"},g,{ref:_,className:"".concat(E," ").concat(d),style:l(l({},p),{},{width:t,height:n})}),a.createElement("svg",{viewBox:o,width:t,height:n,style:u},a.createElement("use",{xlinkHref:"#".concat(s),style:{fill:"currentColor",color:A}})))};d.defaultProps={Component:"div",className:"",style:{}}},634777:(e,t,n)=>{"use strict";n.d(t,{addSpriteSymbol:()=>u,useIsomorphicLayoutEffect:()=>d});var a,r=n(362548),i=n.n(r),o=n(667294),l=!("undefined"==typeof window||!window.document||!window.document.createElement);if(l){var s="__SVG_SPRITE_NODE__";a=new(i())({attrs:{id:s}});var c=function(){var e=document.getElementById(s);e?a.attach(e):a.mount()};document.querySelector("body")?c():document.addEventListener("DOMContentLoaded",c)}else a=null;function u(e){a&&a.add(e)}var d=l?o.useLayoutEffect:o.useEffect},911099:(e,t,n)=>{"use strict";var a=n(595318);t.classNames=function(){for(var e=[],t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.forEach((function(t){if(t)switch((0,r.default)(t)){case"string":e.push(t);break;case"object":Object.keys(t).forEach((function(n){t[n]&&e.push(n)}));break;default:e.push("".concat(t))}})),e.join(" ")};var r=a(n(750008))},408091:e=>{"use strict";function t(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),a=1;a<arguments.length;a++){var r=arguments[a];if(null!=r)for(var i=Object.keys(Object(r)),o=0,l=i.length;o<l;o++){var s=i[o],c=Object.getOwnPropertyDescriptor(r,s);void 0!==c&&c.enumerable&&(n[s]=r[s])}}return n}e.exports={assign:t,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:t})}}},362548:function(e,t,n){e.exports=function(){"use strict";function e(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var t=e((function(e,t){!function(t,n){e.exports=n()}(0,(function(){function e(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function t(e){return Array.isArray(e)?[]:{}}function n(n,a){return a&&!0===a.clone&&e(n)?i(t(n),n,a):n}function a(t,a,r){var o=t.slice();return a.forEach((function(a,l){void 0===o[l]?o[l]=n(a,r):e(a)?o[l]=i(t[l],a,r):-1===t.indexOf(a)&&o.push(n(a,r))})),o}function r(t,a,r){var o={};return e(t)&&Object.keys(t).forEach((function(e){o[e]=n(t[e],r)})),Object.keys(a).forEach((function(l){e(a[l])&&t[l]?o[l]=i(t[l],a[l],r):o[l]=n(a[l],r)})),o}function i(e,t,i){var o=Array.isArray(t),l=(i||{arrayMerge:a}).arrayMerge||a;return o?Array.isArray(e)?l(e,t,i):n(t,i):r(e,t,i)}return i.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((function(e,n){return i(e,n,t)}))},i}))}));function a(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).map((function(e){e(n)})),(e["*"]||[]).map((function(e){e(t,n)}))}}}var r=e((function(e,t){var n={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}};t.default=n,e.exports=t.default})),i=function(e){return Object.keys(e).map((function(t){return t+'="'+e[t].toString().replace(/"/g,"&quot;")+'"'})).join(" ")},o=r.svg,l=r.xlink,s={};s[o.name]=o.uri,s[l.name]=l.uri;var c,u=function(e,n){void 0===e&&(e="");var a=t(s,n||{});return"<svg "+i(a)+">"+e+"</svg>"},d=r.svg,p=r.xlink,A={attrs:(c={style:["position: absolute","width: 0","height: 0"].join("; "),"aria-hidden":"true"},c[d.name]=d.uri,c[p.name]=p.uri,c)},_=function(e){this.config=t(A,e||{}),this.symbols=[]};_.prototype.add=function(e){var t=this.symbols,n=this.find(e.id);return n?(t[t.indexOf(n)]=e,!1):(t.push(e),!0)},_.prototype.remove=function(e){var t=this.symbols,n=this.find(e);return!!n&&(t.splice(t.indexOf(n),1),n.destroy(),!0)},_.prototype.find=function(e){return this.symbols.filter((function(t){return t.id===e}))[0]||null},_.prototype.has=function(e){return null!==this.find(e)},_.prototype.stringify=function(){var e=this.config.attrs,t=this.symbols.map((function(e){return e.stringify()})).join("");return u(t,e)},_.prototype.toString=function(){return this.stringify()},_.prototype.destroy=function(){this.symbols.forEach((function(e){return e.destroy()}))};var m=function(e){var t=e.id,n=e.viewBox,a=e.content;this.id=t,this.viewBox=n,this.content=a};m.prototype.stringify=function(){return this.content},m.prototype.toString=function(){return this.stringify()},m.prototype.destroy=function(){var e=this;["id","viewBox","content"].forEach((function(t){return delete e[t]}))};var g=function(e){var t=!!document.importNode,n=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;return t?document.importNode(n,!0):n},f=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={isMounted:{}};return n.isMounted.get=function(){return!!this.node},t.createFromExistingNode=function(e){return new t({id:e.getAttribute("id"),viewBox:e.getAttribute("viewBox"),content:e.outerHTML})},t.prototype.destroy=function(){this.isMounted&&this.unmount(),e.prototype.destroy.call(this)},t.prototype.mount=function(e){if(this.isMounted)return this.node;var t="string"==typeof e?document.querySelector(e):e,n=this.render();return this.node=n,t.appendChild(n),n},t.prototype.render=function(){var e=this.stringify();return g(u(e)).childNodes[0]},t.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(t.prototype,n),t}(m),v={autoConfigure:!0,mountTo:"body",syncUrlsWithBaseTag:!1,listenLocationChangeEvent:!0,locationChangeEvent:"locationChange",locationChangeAngularEmitter:!1,usagesToUpdate:"use[*|href]",moveGradientsOutsideSymbol:!1},E=function(e){return Array.prototype.slice.call(e,0)},h={isChrome:function(){return/chrome/i.test(navigator.userAgent)},isFirefox:function(){return/firefox/i.test(navigator.userAgent)},isIE:function(){return/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)},isEdge:function(){return/edge/i.test(navigator.userAgent)}},C=function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent(e,!1,!1,t),window.dispatchEvent(n)},S=function(e){var t=[];return E(e.querySelectorAll("style")).forEach((function(e){e.textContent+="",t.push(e)})),t},y=function(e){return(e||window.location.href).split("#")[0]},N=function(e){angular.module("ng").run(["$rootScope",function(t){t.$on("$locationChangeSuccess",(function(t,n,a){C(e,{oldUrl:a,newUrl:n})}))}])},T="linearGradient, radialGradient, pattern, mask, clipPath",I=function(e,t){return void 0===t&&(t=T),E(e.querySelectorAll("symbol")).forEach((function(e){E(e.querySelectorAll(t)).forEach((function(t){e.parentNode.insertBefore(t,e)}))})),e};function P(e,t){return E(e).reduce((function(e,n){if(!n.attributes)return e;var a=E(n.attributes),r=t?a.filter(t):a;return e.concat(r)}),[])}var b=r.xlink.uri,w="xlink:href",L=/[{}|\\\^\[\]`"<>]/g;function M(e){return e.replace(L,(function(e){return"%"+e[0].charCodeAt(0).toString(16).toUpperCase()}))}function O(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function k(e,t,n){return E(e).forEach((function(e){var a=e.getAttribute(w);if(a&&0===a.indexOf(t)){var r=a.replace(t,n);e.setAttributeNS(b,w,r)}})),e}var D=["clipPath","colorProfile","src","cursor","fill","filter","marker","markerStart","markerMid","markerEnd","mask","stroke","style"],R=D.map((function(e){return"["+e+"]"})).join(","),B=function(e,t,n,a){var r=M(n),i=M(a);P(e.querySelectorAll(R),(function(e){var t=e.localName,n=e.value;return-1!==D.indexOf(t)&&-1!==n.indexOf("url("+r)})).forEach((function(e){return e.value=e.value.replace(new RegExp(O(r),"g"),i)})),k(t,r,i)},G={MOUNT:"mount",SYMBOL_MOUNT:"symbol_mount"};return function(e){function n(n){var r=this;void 0===n&&(n={}),e.call(this,t(v,n));var i=a();this._emitter=i,this.node=null;var o=this.config;if(o.autoConfigure&&this._autoConfigure(n),o.syncUrlsWithBaseTag){var l=document.getElementsByTagName("base")[0].getAttribute("href");i.on(G.MOUNT,(function(){return r.updateUrls("#",l)}))}var s=this._handleLocationChange.bind(this);this._handleLocationChange=s,o.listenLocationChangeEvent&&window.addEventListener(o.locationChangeEvent,s),o.locationChangeAngularEmitter&&N(o.locationChangeEvent),i.on(G.MOUNT,(function(e){o.moveGradientsOutsideSymbol&&I(e)})),i.on(G.SYMBOL_MOUNT,(function(e){o.moveGradientsOutsideSymbol&&I(e.parentNode),(h.isIE()||h.isEdge())&&S(e)}))}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var r={isMounted:{}};return r.isMounted.get=function(){return!!this.node},n.prototype._autoConfigure=function(e){var t=this.config;void 0===e.syncUrlsWithBaseTag&&(t.syncUrlsWithBaseTag=void 0!==document.getElementsByTagName("base")[0]),void 0===e.locationChangeAngularEmitter&&(t.locationChangeAngularEmitter=void 0!==window.angular),void 0===e.moveGradientsOutsideSymbol&&(t.moveGradientsOutsideSymbol=h.isFirefox())},n.prototype._handleLocationChange=function(e){var t=e.detail,n=t.oldUrl,a=t.newUrl;this.updateUrls(n,a)},n.prototype.add=function(t){var n=this,a=e.prototype.add.call(this,t);return this.isMounted&&a&&(t.mount(n.node),this._emitter.emit(G.SYMBOL_MOUNT,t.node)),a},n.prototype.attach=function(e){var t=this,n=this;if(n.isMounted)return n.node;var a="string"==typeof e?document.querySelector(e):e;return n.node=a,this.symbols.forEach((function(e){e.mount(n.node),t._emitter.emit(G.SYMBOL_MOUNT,e.node)})),E(a.querySelectorAll("symbol")).forEach((function(e){var t=f.createFromExistingNode(e);t.node=e,n.add(t)})),this._emitter.emit(G.MOUNT,a),a},n.prototype.destroy=function(){var e=this,t=e.config,n=e.symbols,a=e._emitter;n.forEach((function(e){return e.destroy()})),a.off("*"),window.removeEventListener(t.locationChangeEvent,this._handleLocationChange),this.isMounted&&this.unmount()},n.prototype.mount=function(e,t){void 0===e&&(e=this.config.mountTo),void 0===t&&(t=!1);var n=this;if(n.isMounted)return n.node;var a="string"==typeof e?document.querySelector(e):e,r=n.render();return this.node=r,t&&a.childNodes[0]?a.insertBefore(r,a.childNodes[0]):a.appendChild(r),this._emitter.emit(G.MOUNT,r),r},n.prototype.render=function(){return g(this.stringify())},n.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},n.prototype.updateUrls=function(e,t){if(!this.isMounted)return!1;var n=document.querySelectorAll(this.config.usagesToUpdate);return B(this.node,n,y(e)+"#",y(t)+"#"),!0},Object.defineProperties(n.prototype,r),n}(_)}()},887854:function(e,t,n){e.exports=function(){"use strict";var e=function(e){var t=e.id,n=e.viewBox,a=e.content;this.id=t,this.viewBox=n,this.content=a};e.prototype.stringify=function(){return this.content},e.prototype.toString=function(){return this.stringify()},e.prototype.destroy=function(){var e=this;["id","viewBox","content"].forEach((function(t){return delete e[t]}))};var t=function(e){var t=!!document.importNode,n=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;return t?document.importNode(n,!0):n};function a(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var r=a((function(e,t){!function(t,n){e.exports=n()}(0,(function(){function e(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function t(e){return Array.isArray(e)?[]:{}}function n(n,a){return a&&!0===a.clone&&e(n)?i(t(n),n,a):n}function a(t,a,r){var o=t.slice();return a.forEach((function(a,l){void 0===o[l]?o[l]=n(a,r):e(a)?o[l]=i(t[l],a,r):-1===t.indexOf(a)&&o.push(n(a,r))})),o}function r(t,a,r){var o={};return e(t)&&Object.keys(t).forEach((function(e){o[e]=n(t[e],r)})),Object.keys(a).forEach((function(l){e(a[l])&&t[l]?o[l]=i(t[l],a[l],r):o[l]=n(a[l],r)})),o}function i(e,t,i){var o=Array.isArray(t),l=(i||{arrayMerge:a}).arrayMerge||a;return o?Array.isArray(e)?l(e,t,i):n(t,i):r(e,t,i)}return i.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((function(e,n){return i(e,n,t)}))},i}))})),i=a((function(e,t){var n={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}};t.default=n,e.exports=t.default})),o=function(e){return Object.keys(e).map((function(t){return t+'="'+e[t].toString().replace(/"/g,"&quot;")+'"'})).join(" ")},l=i.svg,s=i.xlink,c={};c[l.name]=l.uri,c[s.name]=s.uri;var u=function(e,t){void 0===e&&(e="");var n=r(c,t||{});return"<svg "+o(n)+">"+e+"</svg>"};return function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var a={isMounted:{}};return a.isMounted.get=function(){return!!this.node},n.createFromExistingNode=function(e){return new n({id:e.getAttribute("id"),viewBox:e.getAttribute("viewBox"),content:e.outerHTML})},n.prototype.destroy=function(){this.isMounted&&this.unmount(),e.prototype.destroy.call(this)},n.prototype.mount=function(e){if(this.isMounted)return this.node;var t="string"==typeof e?document.querySelector(e):e,n=this.render();return this.node=n,t.appendChild(n),n},n.prototype.render=function(){var e=this.stringify();return t(u(e)).childNodes[0]},n.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(n.prototype,a),n}(e)}()},366206:(e,t,n)=>{"use strict";var a=n(294757),r=n(933294),i=n(124961),o=n(76238),l=n(41437),s=n(116886),c=n(663527),u=n(621260);if(!window.Calls){var d=new o.ActionStatCollector(new o.ProductionStatCollector),p={getLang:l.getLang,langSex:function(e,t,n){return(0,s.langSex)(e,n)},langNumeric:function(e,t,n,a){return(0,s.langNumeric)(e,n,a)},langShortDateTime:function(e){return(0,s.langDate)(e,(0,l.getLang)("global_short_date_time",!0),0,(0,l.getLang)("months_of"),!0)}},A={onScreenSharingEnabled:null,onScreenSharingDisabled:null,onErrorStartCall:null,onHandCountChanged:null,onSuccessFeedback:function(){(0,u.showDoneBox)((0,l.getLang)("calls_feedback_success"))},onError:null};window.Calls=(0,a.init)({apiWrapper:r.apiWrapper,apiWrapperWithAuth:r.apiWrapperWithAuth,actionStatCollector:d,saveStatlogEvents:i.saveStatlogEvents,langUtils:p,navigateToConvo:function(e){window.nav.go((0,c.getConvoLocation)(e))},callSounds:{end:"/mp3/call_end.mp3",incoming:"/mp3/call_incoming.mp3",outgoing:"/mp3/call_outgoing.mp3",connected:"/mp3/call_connected.mp3",connecting:"/mp3/call_connecting.mp3"},navigateToProfile:function(e,t){!e.target.href&&window.Calls&&(window.Calls.collapseCall(),t&&window.nav.go(t))},eventHandlers:A})}try{window.stManager.done(window.jsc("web/calls.js"))}catch(e){}},820717:(e,t,n)=>{"use strict";n.d(t,{loadFriendsAction:()=>u,loadChatMembersAction:()=>d,loadAllowedToCallGroupMembersAction:()=>p,loadCallPeersWithWaitingImagesAction:()=>A,loadCallPeersWithoutWaitingImagesAction:()=>_,loadActiveCallDataAction:()=>m,loadCallParticipantsAccumulate:()=>f,loadCallUrlLink:()=>v,setActiveCallData:()=>E,startUpcomingStream:()=>h,startCallStream:()=>C,setAnonymousJoin:()=>S,setWaitingHall:()=>y,serverSearchGroupMembers:()=>N});var a=n(570655),r=n(121255),i=n(298811),o=n(329538),l=n(613335),s=n(834735),c=n(464380);function u(e,t,n){if(e.authorizedGroupId)return Promise.resolve();if((0,i.unpackState)(t).friends.length>0)return Promise.resolve();if(e.getFriends){var a=e.getFriends();if(null!==a)return n({type:r.SET_FRIENDS,data:a}),Promise.resolve()}return(0,o.loadFriends)().then((function(e){return e.items.map(l.normalizeUser)})).then((function(e){n({type:r.SET_FRIENDS,data:e})}))}function d(e,t,n,a){return(0,o.loadChatMembers)(n).then((function(n){var o=n.profiles;o&&t({type:r.SET_CHAT_INFO,data:o.map(l.normalizeUser).sort((function(t,n){var a=(0,i.unpackState)(e).me;return t.peerId===a?-1:n.peerId===a?1:0})),conversation:a})}))}function p(e,t,n){return e.authorizedGroupId?t.groupMembers.length>0?Promise.resolve():(0,o.getGroupMembers)(-e.authorizedGroupId,0,r.COUNT_OF_GROUP_MEMBERS_TO_LOAD).then((function(e){var t=e.items,n=e.count,a=[],r=[];return t.forEach((function(e){e.deactivated||(a.push((0,l.normalizeUser)(e)),e.can_call_from_group||r.push(e.id))})),[a,r,n]})).then((function(e){var t=(0,a.__read)(e,3),i=t[0],o=t[1],l=t[2];return n({type:r.SET_GROUP_MEMBERS,groupMembersCount:l,groupMembers:i,unableToCallGroupMembersIds:o}),Promise.resolve()})):Promise.resolve()}function A(e,t,n){return(0,o.retryLoadCallPeers)(n).then((function(e){var n=(0,a.__read)((0,i.convertServerData)(e),3),r=n[0],o=n[1],l=n[2];return E(t,l),(0,s.preloadImagesFromResponse)([r,o])})).then((function(e){var i=(0,a.__read)(e,2),o=i[0],l=i[1];t({type:r.LOAD_PEERS,conversation:o,members:l,peerId:n})}))}function _(e,t,n,l){return(0,o.retryLoadCallPeers)(l).then((function(e){var o=(0,a.__read)((0,i.convertServerData)(e),3),l=o[0],u=o[1],d=o[2];E(t,d),(0,s.preloadImagesFromResponse)([l,u]).catch((function(e){n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)})),t({type:r.LOAD_PEERS,conversation:l,members:u})}))}function m(e,t,n){return n?(0,o.loadCallPeers)(n).then((function(e){var n=e.items,r=(0,a.__read)(n,1)[0];E(t,r)})):Promise.resolve()}var g={acc:[],timer:0,tasks:0,timeout:300};function f(e,t,n,u,d,p){var A;(A=g.acc).push.apply(A,(0,a.__spreadArray)([],(0,a.__read)(d))),g.timer&&clearTimeout(g.timer),g.timer=window.setTimeout((function(){var d=g.acc;g.acc=[],function(e,t,n,u,d,p){var A=(0,i.unpackState)(e).me,_=(0,i.unpackState)(e).anonymSecret,m=A<0?A:void 0;return(0,o.getCallParticipants)(u,d,m,A<0,_).then((function(e){var i=e.profiles,o=void 0===i?[]:i,c=e.anonyms,A=void 0===c?[]:c,_=e.secret,m=e.groups,g=void 0===m?[]:m;_&&t({type:r.UPDATE_ANON_SECRET,secret:_});var f=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(o)),(0,a.__read)(A)),(0,a.__read)(g)),v=d.filter((function(e){return!f.find((function(t){return t&&t.id===e}))}));v.length>0&&n.eventHandlers.onError&&n.eventHandlers.onError(new Error("callId: "+u+", timestamp: "+Date.now()+", cant find in participants: "+v.join(", ")));var E=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(A)),(0,a.__read)(o)).map(l.normalizeUser);(null==g?void 0:g.length)>0&&(E=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(E)),(0,a.__read)(g.map(l.normalizeGroup))));var h=(0,s.preloadImagesFromResponse)([{},E]);return p.awaitImages?h.then((function(){return[null,E]})):[null,E]})).then((function(e){var n=(0,a.__read)(e,2)[1];t({type:r.LOAD_PEERS,members:n})})).catch((function(e){n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}(e,t,n,u,d,p).catch((function(e){n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}),g.timeout)}function v(e,t,n,a){return void 0===a&&(a=0),(0,o.getCallUrlLink)(t,n,a).then((function(t){var n=t.join_link;return e({type:r.CALL_STATE,callData:{callUrlLink:n}}),n}))}function E(e,t){if(t&&t.call_in_progress){var n=t.unread_count,a=t.last_message_id,i=t.call_in_progress.has_link,o=t.call_in_progress.can_finish_call;e({type:r.CALL_STATE,callData:{canFinishCall:o,hasUrlLink:i}}),(n||a)&&e({type:r.SET_UNREAD_COUNT,chatUnreadCount:n,chatUpToMsgId:a})}}function h(e){return(0,c.startStream)(!1,null,e).catch((function(e){(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function C(e){return(0,o.videoStartStreaming)(e).then((function(e){return(0,c.startStream)(!1,null,e.stream.ov_id)})).catch((function(e){(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function S(e){var t;return(0,c.changeConversationOptions)(((t={})[c.ConversationOption.REQUIRE_AUTH_TO_JOIN]=e,t))}function y(e){var t;return(0,c.changeConversationOptions)(((t={})[c.ConversationOption.WAITING_HALL]=e,t))}function N(e,t,n,i){return void 0===t&&(t=""),(0,o.searchGroupMembers)(e,t).then((function(e){var t=e.items,o=[],s=[];return t&&t.forEach((function(e){e.deactivated||e.id in n.groupMembersCache||(o.push((0,l.normalizeUser)(e)),e.can_call_from_group||s.push(e.id))})),o.length>0&&i({type:r.SET_GROUP_MEMBERS,groupMembersCount:n.groupMembersCount,groupMembers:(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n.groupMembers)),(0,a.__read)(o)),unableToCallGroupMembersIds:(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n.unableToCallGroupMembersIds)),(0,a.__read)(s))}),o}))}},444083:(e,t,n)=>{"use strict";n.d(t,{onForceCallFinish:()=>i});var a=n(121255),r=n(329538);function i(e,t,n,i){var o=t.callData.callId||"";n({type:a.SHOW_LOADER,isLoaderVisible:!0}),(0,r.forceCallFinish)(o).catch((function(e){console.error(e),n({type:a.ERROR,text:i("calls_error_force_call_finish"),handleType:a.ErrorHandleType.FATAL})})).finally((function(){n({type:a.SHOW_LOADER,isLoaderVisible:!1})}))}},719481:(e,t,n)=>{"use strict";n.d(t,{promoteUserAndRemoveFromWaitingHall:()=>c,removeUserFromWaitingHall:()=>u,clearWaitingList:()=>d,loadWaitingHall:()=>p,loadAdditionalWaitingHall:()=>A,resetWaitingHallNew:()=>_});var a=n(570655),r=n(121255),i=n(613335),o=n(464380),l=n(329538),s=n(834735);function c(e,t,n){var a=(0,i.getExternalIdByUserId)(e);return(0,o.promoteParticipant)(a).then((function(){u(e,t,n)}))}function u(e,t,n){t&&(t.totalCount-=1,t.members.delete(e),n({type:r.SET_WAITING_HALL,data:t}))}function d(e){e({type:r.SET_WAITING_HALL,data:null})}function p(e,t,n,c){return new Promise((function(n){0!==t.length?e>t.length?(0,o.getWaitingHall)(null,e).then((function(e){n(e.participants)})):n(t):n([])})).then((function(t){var r={totalCount:e,members:new Map,hasNew:!1},o=[];if(n.waitingHall){var c=n.waitingHall,u=c.members,d=c.hasNew;r.hasNew=d,t.forEach((function(e){var t=+e.id;if(u.has(t)){var n=u.get(t);n&&r.members.set(t,n)}else o.push(t)}))}else o=t.map((function(e){return+e.id}));if(o.length>0){r.hasNew=!0;var p=n.me,A=n.callData,_=n.anonymSecret,m=A.callId||"",g=p<0,f=g?p:0;return(0,l.getCallParticipantsApiCall)(m,o,g,_,f).then((function(e){var t=e.profiles,n=void 0===t?[]:t,o=e.anonyms,l=void 0===o?[]:o,c=e.groups,u=void 0===c?[]:c,d=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(l)),(0,a.__read)(n)).map(i.normalizeUser);return(null==u?void 0:u.length)>0&&(d=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(d)),(0,a.__read)(u.map(i.normalizeGroup)))),(0,s.preloadImagesFromResponse)([{},d]),d.forEach((function(e){e&&e.peerId&&r.members.set(e.peerId,e)})),r})).catch((function(){return r}))}return r})).then((function(e){e.members&&c({type:r.SET_WAITING_HALL,data:e})}))}function A(e,t,n){var a;if(void 0===n&&(n=!1),n)a=void 0;else{if(!e.waitingHall)return Promise.resolve();if(!((a=e.waitingHall.totalCount)>e.waitingHall.members.size))return Promise.resolve()}return new Promise((function(n){(0,o.getWaitingHall)(null,a).then((function(a){p(a.totalCount,a.participants,e,t).then((function(){n()}))}))}))}function _(e,t){e&&(e.hasNew=!1,t({type:r.SET_WAITING_HALL,data:e}))}},734273:(e,t,n)=>{"use strict";n.d(t,{AdminPinUnmuteRequestModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.onClose,n=e.actionButtons,i=e.title,o=e.description;return a.createElement(r.default,{className:"AdminPinUnmuteRequestModal",appearance:"blue",title:i,actionButtons:n,onClose:t},a.createElement("div",{className:"AdminPinUnmuteRequestModal__content"},o))}},908651:(e,t,n)=>{"use strict";n.d(t,{AssignAdminModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.title,n=e.description,i=e.onClose,o=e.actionButtons;return a.createElement(r.default,{className:"AssignAdminModal",appearance:"blue",title:t,actionButtons:o,onClose:i},a.createElement("div",{className:"AssignAdminModal__content"},n))}},853055:(e,t,n)=>{"use strict";n.d(t,{BlurredBackground:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.id,n=e.className,i=e.children,o=(0,a.useMemo)((function(){return"radial-gradient(circle, rgb("+(48+Math.abs(t)%3*4)+","+(48+Math.abs(t)%4*5)+","+(52+Math.abs(t)%5*6)+") 40%, #0a0a0a 100%)"}),[]),l=(0,r.classNames)("BlurredBackground",n);return a.createElement("div",{className:l,style:{background:o}},i)}},492512:(e,t,n)=>{"use strict";n.d(t,{Call:()=>P});var a=n(570655),r=n(667294),i=n(309605),o=n(995141),l=n(423197),s=n(826988),c=n(815155),u=n(884609),d=n(747212),p=n(818114),A=n(659397),_=n(156482),m=n(748972),g=n(167903),f=n(172397),v=n(701683),E=n(722959),h=n(641221),C=n(112877),S=n(662208),y=n(498110),N=n(968125),T=n(573669),I=n(343379);function P(e){var t,n,P=e.info,b=e.chatUnreadCount,w=void 0===b?0:b,L=e.callMenuActions,M=e.isAudioAllowed,O=void 0!==M&&M,k=e.isVideoAllowed,D=void 0!==k&&k,R=e.isVideoEnabled,B=void 0!==R&&R,G=e.isAudioEnabled,x=void 0!==G&&G,H=e.isScreenSharingEnabled,U=void 0!==H&&H,V=e.isOratorMode,F=void 0===V||V,W=e.isFullScreen,z=void 0!==W&&W,j=e.onToggleVideo,Q=e.onToggleAudio,Y=e.onLeaveCall,K=e.onCollapseCall,J=e.onToggleOratorMode,q=e.onChat,Z=e.onHandClick,X=e.onToggleScreenShare,$=e.onFullScreenToggle,ee=e.onDeferredStreamStart,te=e.isParticipantControlActive,ne=void 0!==te&&te,ae=e.isLayoutSwitchShown,re=void 0!==ae&&ae,ie=e.isScreenShareControlShown,oe=void 0!==ie&&ie,le=e.isHandRaised,se=void 0!==le&&le,ce=e.isHandControlShown,ue=void 0!==ce&&ce,de=e.isChatControlShown,pe=void 0!==de&&de,Ae=e.isStreamingControlShown,_e=void 0!==Ae&&Ae,me=e.onParticipantsClick,ge=e.onTooltipChange,fe=e.onHidePanel,ve=e.notification,Ee=e.tooltips,he=e.amISpeaking,Ce=void 0!==he&&he,Se=e.onChainClick,ye=e.waitingHallNotification,Ne=e.withoutPadding,Te=void 0!==Ne&&Ne,Ie=e.participantCount,Pe=void 0===Ie?0:Ie,be=e.children,we=r.useContext(y.ConfigContext),Le=we.withAnimation,Me=we.isModalView,Oe=r.useContext(S.LangContext).getLang,ke=(0,A.classNames)("Call",{"Call--fullscreen":z||!Me}),De=(0,A.classNames)("Call__content",{"Call__content--withoutPadding":Te}),Re=300,Be=null===(n=null===(t=window.location)||void 0===t?void 0:t.host)||void 0===n?void 0:n.includes("vk.com"),Ge=r.useRef(null),xe=r.useRef(null),He=r.useRef(null),Ue=r.useRef(null),Ve=(0,a.__read)(r.useState(!1),2),Fe=Ve[0],We=Ve[1],ze=(0,a.__read)(function(e,t,n,i,o,l){var s=(0,a.__read)(r.useState(!0),2),c=s[0],u=s[1],d=r.useRef(null),p=r.useRef(!1),_=r.useRef(!1),m=r.useRef(!1);m.current!==l&&(m.current=l);var g=r.useRef(!1),f=function(){p.current||g.current?g.current=!1:(d.current&&window.clearTimeout(d.current),u(!0),_.current||m.current||(d.current=window.setTimeout((function(){u(!1),d.current=null,o&&o()}),5e3)))};return r.useEffect((function(){f();var a=(0,A.throttle)((function(){f()}),1e3),r=function(){_.current=!0},o=function(){_.current=!1};return t.current.addEventListener("mouseenter",r),t.current.addEventListener("mouseleave",o),n.current.addEventListener("mouseenter",r),n.current.addEventListener("mouseleave",o),i.current.addEventListener("mouseenter",r),i.current.addEventListener("mouseleave",o),e.current.addEventListener("mousemove",a),function(){p.current=!0,d.current&&window.clearTimeout(d.current),t.current&&(t.current.removeEventListener("mouseenter",r),t.current.removeEventListener("mouseleave",o)),n.current&&(n.current.removeEventListener("mouseenter",r),n.current.removeEventListener("mouseleave",o)),i.current&&(i.current.removeEventListener("mouseenter",r),i.current.removeEventListener("mouseleave",o)),e.current&&e.current.removeEventListener("mousemove",a)}}),[_,m.current]),[c,function(e){e?u(!0):(u(!1),g.current=!0)}]}(Ge,xe,He,Ue,fe,Fe),2),je=ze[0],Qe=ze[1],Ye=(0,A.classNames)({"Call__controlPanel--withAnimation":Le,"Call__controlPanel--hideBottomWithAnimation":Le,"Call__controlPanel--hideBottom":!je}),Ke=(0,A.classNames)({"Call__controlPanel--withAnimation":Le,"Call__controlPanel--hideBottomWithAnimation":Le,"Call__controlPanel--hideBottom":!je},"Call__curtain"),Je=(0,A.classNames)("Call__buttons",{"Call__controlPanel--withAnimation":Le,"Call__controlPanel--hideBottomWithAnimation":Le,"Call__controlPanel--hideBottom":!je});return r.createElement("section",{className:ke,onMouseEnter:function(){return Qe(!0)},onMouseLeave:function(){Fe||(Qe(!1),Ee.streaming&&ge("streaming",!1))},ref:Ge},P,ve,r.createElement("div",{className:De,"data-calls-id":"content"},be),r.createElement("div",{className:Ke}),r.createElement(l.CallIconButtonGroup,{alignX:"l",alignY:"b",className:Ye,ref:He},r.createElement(r.Fragment,null,pe&&r.createElement(h.TooltipNew,{content:Oe("calls_chat"),open:Ee.chat,delay:Re,onOpen:function(){return ge("chat",!0)},onClose:function(){return ge("chat",!1)}},r.createElement(u.ChatIconButton,{unreadCount:w,onClick:q})),ue&&r.createElement(h.TooltipNew,{content:Oe(se?"calls_tooltip_lower_hand":"calls_tooltip_raise_hand"),open:Ee.hand,delay:Re,onOpen:function(){return ge("hand",!0)},onClose:function(){return ge("hand",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(m.RaiseHandIcon,null),type:"hand",isActive:se,onClick:Z})),oe&&r.createElement(h.TooltipNew,{content:Oe(U?"calls_stop_screen_share":"calls_start_screen_share"),open:Ee.screenShare,delay:Re,onOpen:function(){return ge("screenShare",!0)},onClose:function(){return ge("screenShare",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(_.ShareScreenIcon,null),isActive:U,onClick:X})),_e&&r.createElement(h.TooltipNew,{content:Oe("calls_call_menu_translation"),open:Ee.streaming,delay:Re,onOpen:function(){return ge("streaming",!0)},onClose:function(){return ge("streaming",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(T.default,null),isActive:_e,onClick:ee})))),r.createElement(l.CallIconButtonGroup,{alignX:"r",alignY:"b",style:z&&Be?{right:"78px"}:void 0,className:Ye,ref:Ue},r.createElement(r.Fragment,null,re&&r.createElement(h.TooltipNew,{content:Oe(F?"calls_show_grid":"calls_show_orator"),open:Ee.layout,delay:Re,onOpen:function(){return ge("layout",!0)},onClose:function(){return ge("layout",!1)}},r.createElement(o.CallIconButton,{type:F?"changeToGrid":"changeToOrator",onClick:J})),L&&r.createElement(E.CallsDropdown,{items:L,open:Fe,setOpen:We},r.createElement(o.CallIconButton,{type:"settings"})),K&&r.createElement(h.TooltipNew,{content:Oe("calls_collapse"),open:Ee.collapse,delay:Re,onOpen:function(){return ge("collapse",!0)},onClose:function(){return ge("collapse",!1)}},r.createElement(o.CallIconButton,{type:"collapse",onClick:K})),$&&r.createElement(h.TooltipNew,{content:Oe(z?"calls_tooltip_fullscreen_off":"calls_tooltip_fullscreen_on"),open:Ee.fullscreen,delay:Re,onOpen:function(){return ge("fullscreen",!0)},onClose:function(){return ge("fullscreen",!1)}},r.createElement(o.CallIconButton,{onClick:$,icon:z?r.createElement(g.FullScreenOffIcon,null):r.createElement(f.FullScreenIcon,null)})))),r.createElement("footer",{className:"Call__footer",ref:xe},ye&&r.createElement("div",{className:"Call__notificationWaitingHall"},ye),r.createElement("div",{className:Je},Se&&r.createElement(i.CallButton,{type:i.CallButtonTypes.ON,icon:r.createElement(N.ChainIcon,null),onClick:Se,className:"Call__footerButton"}),me&&r.createElement(I.ParticipantIconButton,{isParticipantControlActive:ne,onClick:me,participantCount:Pe}),r.createElement(i.CallButton,{type:D?B?i.CallButtonTypes.ON:i.CallButtonTypes.OFF:i.CallButtonTypes.DISABLED,icon:B?r.createElement(s.VideoIcon,null):r.createElement(v.DisabledVideoIcon,null),onClick:j,className:"Call__footerButton"}),Q&&r.createElement(i.CallButton,{type:O?x?i.CallButtonTypes.ON:i.CallButtonTypes.OFF:i.CallButtonTypes.DISABLED,icon:x?Ce?r.createElement(C.MicIconWithSpeakingIndicator,null):r.createElement(p.MicIcon,null):r.createElement(d.MutedMicIcon,null),onClick:Q,className:"Call__footerButton"}),r.createElement(i.CallButton,{type:i.CallButtonTypes.NEGATIVE,icon:r.createElement(c.EndCallIcon,null),onClick:Y,className:"Call__footerButton"}))))}},309605:(e,t,n)=>{"use strict";n.d(t,{CallButtonTypes:()=>a,CallButton:()=>l});var a,r=n(570655),i=n(667294),o=n(659397);!function(e){e.POSITIVE="positive",e.NEGATIVE="negative",e.REGULAR="regular",e.ON="on",e.OFF="off",e.CLEAR="clear",e.DISABLED="disabled"}(a||(a={}));var l=function(e){var t=e.icon,n=e.text,l=e.type,s=e.className,c=(0,r.__rest)(e,["icon","text","type","className"]),u=(0,o.classNames)("CallButton","CallButton--"+l,s,{"CallButton--withText":!!n},"CallButton--withAnimation"),d=(0,o.classNames)("CallButton__icon","CallButton__icon--withAnimation"),p=(0,r.__assign)((0,r.__assign)({},c),{onMouseDown:function(e){e.preventDefault(),c.onMouseDown&&c.onMouseDown(e)}});return i.createElement("button",(0,r.__assign)({className:u},p,{disabled:l===a.DISABLED}),i.createElement("figure",{className:d},t),n)}},790281:(e,t,n)=>{"use strict";n.d(t,{CallByNameModal:()=>m});var a=n(667294),r=n(138671),i=n(838480),o=n(774415),l=n(662208),s=n(736434),c=n(295886),u=n(670546),d=n(248586),p=n(279060),A=n(750598),_=n(884143),m=function(e){var t=e.items,n=e.actionButtons,m=e.onListItemClick,g=e.selectedId,f=e.onClose,v=e.onSearchChange,E=a.useContext(l.LangContext).getLang;return a.createElement(r.default,{className:"CallByNameModal",onClose:f},a.createElement(i.ModalHeader,{title:E("calls_call_by_name_title"),onClose:f,appearance:"blue"}),a.createElement("div",{className:"CallByNameModal__content"},a.createElement(s.BlockSearchInput,{className:"CallByNameModalList__input",placeholder:E("calls_call_by_name_search_placeholder"),onChange:v,onInput:v,onPaste:v}),a.createElement(c.ListHeader,{extra:t.length||""},E("calls_call_by_name_list_header")),0!==t.length&&a.createElement(u.default,{border:!1,className:"CallByNameModalList__list"},t.map((function(e){return function(e,t){var n=null;return n=t===e.id?a.createElement("span",{className:"CallByNameModalList__selected"},E("calls_call_by_name_selected")):a.createElement("span",{className:"CallByNameModalList__select"},E("calls_call_by_name_select")),a.createElement(A.default,{key:e.id,onClick:function(){return m(e.id)},className:"CallByNameModalList__listItem",aside:n},a.createElement(d.default,{photo:a.createElement(p.CallPhoto,{id:e.id,photo:e.photo,alt:e.name||"",size:"xxxs"}),title:e.name,href:e.link,target:"_blank"}))}(e,g)}))),0===t.length&&a.createElement(_.default,null,E("calls_call_by_name_not_found"))),a.createElement(o.ModalFooter,{actionButtons:n}))}},440896:(e,t,n)=>{"use strict";n.d(t,{CallError:()=>o});var a=n(667294),r=n(7692),i=n(952907),o=function(e){var t=e.title,n=e.onClose,o=e.actionButtons,l=e.text;return a.createElement(r.default,{appearance:"blue",title:t,onClose:n,actionButtons:o,className:"CallError"},a.createElement(i.ErrorPopupText,null,l))}},225652:(e,t,n)=>{"use strict";n.d(t,{CallExitModal:()=>o});var a=n(667294),r=n(7692),i=n(662208),o=function(e){var t=e.onClose,n=e.actionButtons,o=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:o("calls_exit_menu"),appearance:"blue",actionButtons:n,className:"CallExitModal"},a.createElement("div",{className:"CallExitModal__text"},o("calls_sure_leave_call")))}},362542:(e,t,n)=>{"use strict";n.d(t,{CallGridNew:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.limit,n=e.onScroll,i=e.scrollPosition,o=e.children,l=a.Children.toArray(o),s=Math.min(l.length,t),c=(0,r.classNames)("CallGridNew","CallGridNew--c"+s),u=(0,a.useRef)(null);return(0,a.useEffect)((function(){var e=function(){null!==u.current&&n(u.current.scrollTop)};return null!==u.current&&u.current.addEventListener("scroll",e),function(){u.current&&u.current.removeEventListener("scroll",e)}}),[]),(0,a.useEffect)((function(){var e;null===(e=u.current)||void 0===e||e.scrollTo(0,i)}),[u.current]),a.createElement("section",{className:c,ref:u},a.createElement("div",{className:"CallGridNew__in"},l.map((function(e,t){return a.createElement("article",{className:"CallGridNew__item",key:e.key||t,"data-calls-id":"grid-item"},e)}))))}},503592:(e,t,n)=>{"use strict";n.d(t,{CallHeader:()=>s});var a=n(667294),r=n(659397),i=n(796726),o=n(297627),l=n(838482),s=(0,a.memo)((function(e){var t=e.translation,n=e.speakers,s=e.hands,c=e.time,u=e.network,d=e.networkTooltipText,p=(0,r.classNames)("CallHeader__hands",{"CallHeader__hands--visible":s>0});return a.createElement("div",{className:"CallHeader"},a.createElement("div",{className:"CallHeader__main"},a.createElement("div",{className:"CallHeader__timeAndNetwork"},u<.6&&a.createElement(l.default,{text:d,align:"left",className:"Call__oldTooltip"},a.createElement("div",{className:"CallHeader__network"},a.createElement(o.default,{fill:u<=.3?"#ff5c5c":"#FECE00"}))),c),t&&a.createElement("div",{className:"CallHeader__translation"},t)),a.createElement("div",{className:"CallHeader__aside"},a.createElement("div",{className:"CallHeader__participants"},n),a.createElement("div",{className:p},a.createElement(i.RaisedHandIconXs,null)," ",s)))}))},995141:(e,t,n)=>{"use strict";n.d(t,{CallIconButton:()=>o});var a=n(570655),r=n(667294),i=n(659397),o=(0,r.forwardRef)((function(e,t){var n,o=e.type,l=e.isActive,s=e.icon,c=e.className,u=(0,a.__rest)(e,["type","isActive","icon","className"]),d=(0,i.classNames)("CallIconButton",c,"CallIconButton--withAnimation",((n={"CallIconButton--active":l})["CallIconButton--"+o]=!!o,n)),p=(0,a.__assign)((0,a.__assign)({},u),{onMouseDown:function(e){e.preventDefault(),u.onMouseDown&&u.onMouseDown(e)}});return r.createElement("button",(0,a.__assign)({},p,{className:d,ref:t}),s)}))},423197:(e,t,n)=>{"use strict";n.d(t,{CallIconButtonGroup:()=>o});var a=n(570655),r=n(667294),i=n(659397),o=(0,r.forwardRef)((function(e,t){var n=e.children,o=e.className,l=e.alignX,s=e.alignY,c=e.size,u=void 0===c?"m":c,d=(0,a.__rest)(e,["children","className","alignX","alignY","size"]),p=(0,i.classNames)("CallIconButtonGroup","CallIconButtonGroup--"+l,"CallIconButtonGroup--"+s,"CallIconButtonGroup--size-"+u,o);return r.createElement("div",(0,a.__assign)({className:p,ref:t},d),n)}))},177774:(e,t,n)=>{"use strict";n.d(t,{CallLink:()=>c});var a=n(667294),r=n(595775),i=n(629142),o=n(385177),l=n(880767),s=n(662208),c=function(e){var t=e.link,n=void 0===t?"":t,c=e.isLinkLoading,u=e.isCopied,d=e.hideCopiedText,p=a.useContext(s.LangContext).getLang;return a.createElement("div",{className:"CallLink"},a.createElement("p",{className:"CallLink__info"},p("calls_management_link_info_desc")),c?a.createElement(o.default,{className:"CallLink__input"},a.createElement(l.default,null)):a.createElement("div",{className:"CallLink__input"},a.createElement(r.default,{readOnly:"readonly",value:n}),a.createElement("div",null,a.createElement("div",{className:"CallLink__hint"},p("calls_management_add_warning"),a.createElement(i.default,{className:"CallLink__copied",shown:u,callback:d},p("calls_link_copied"))))))}},562192:(e,t,n)=>{"use strict";n.d(t,{CallLinkSettings:()=>A});var a=n(570655),r=n(667294),i=n(662208),o=n(277256),l=n(750598),s=n(670546),c=n(594504),u=n(560301),d=n(448625),p=n(25347),A=function(e){var t=e.requireAuthToJoin,n=void 0!==t&&t,A=e.onRequireAuthToJoinChanged,_=e.isWaitingHallBlockShown,m=void 0!==_&&_,g=e.isWaitingHallEnabled,f=void 0!==g&&g,v=e.onWaitingHallEnabledChanged,E=(0,r.useContext)(i.LangContext).getLang,h=(0,a.__read)((0,r.useState)(!n),2),C=h[0],S=h[1],y=(0,a.__read)((0,r.useState)(f),2),N=y[0],T=y[1],I=!1,P=(0,r.useCallback)((function(){if(!I){I=!0;var e=!C;S(e),A&&A(!e)}}),[n]),b=!1,w=(0,r.useCallback)((function(){if(!b){b=!0;var e=!N;T(e),v&&v(e)}}),[f]);return r.createElement(s.default,null,m&&r.createElement(u.ListItemWithHint,{onClick:w,canBeHovered:!1,icon:r.createElement(d.ListIcon,{icon:r.createElement(p.default,{width:20,height:20}),color:d.ListIconColors.BLUE}),hint:E("calls_menu_waiting_hall_description"),selectable:!0,aside:r.createElement(o.default,{onChange:w,checked:N})},E("calls_menu_waiting_hall_title")),r.createElement(l.default,{border:!0,canBeHovered:!1,onClick:P,selectable:!0,icon:r.createElement(c.AnonymousIcon,null),aside:r.createElement(o.default,{onChange:P,checked:C})},E("calls_management_link_allow_anonymous")))}},445586:(e,t,n)=>{"use strict";n.d(t,{CallManagementMenu:()=>d});var a=n(667294),r=n(670546),i=n(750598),o=n(448625),l=n(489685),s=n(607691),c=n(662208),u=n(498110),d=function(e){var t=e.isLinkBlockShown,n=e.linkBlockTitle,d=e.onLinkBlockClick,p=e.callUrlLink,A=(0,a.useContext)(u.ConfigContext).allowWaitingHall,_=a.useContext(c.LangContext).getLang;return a.createElement(r.default,null,t&&a.createElement(i.default,{onClick:d,chevron:!0,icon:a.createElement(o.ListIcon,{icon:a.createElement(l.LinkIcon,null),color:o.ListIconColors.GREEN}),aside:A?a.createElement("span",{className:"CallManagementMenu__asideHint"},_("calls_menu_link_setup")):""},n,p&&a.createElement(s.ListCopyControl,{value:p,copyText:_("calls_menu_link_copy"),doneText:_("calls_menu_link_copied")})))}},186983:(e,t,n)=>{"use strict";n.d(t,{CallManagementModal:()=>s});var a=n(667294),r=n(138671),i=n(838480),o=n(774415),l=n(662208),s=function(e){var t=e.title,n=e.onCloseModal,s=e.hint,c=e.actionButtons,u=e.isWithBackButton,d=e.onBackClick,p=e.children,A=a.useContext(l.LangContext).getLang;return a.createElement(r.default,{className:"CallManagementModal",disableBodyScroll:!1,onClose:n},a.createElement(i.ModalHeader,{title:t,onClose:n,appearance:"blue",backText:u?A("calls_back"):void 0,onBack:d}),a.createElement("div",{className:"CallManagementModal__content"},a.Children.toArray(p).map((function(e,t){return a.createElement("div",{className:"CallManagementModal__section",key:t},e)}))),(c||s)&&a.createElement(o.ModalFooter,{actionButtons:c||[],hint:s}))}},269481:(e,t,n)=>{"use strict";n.d(t,{CallModal:()=>u});var a=n(667294),r=n(50533),i=n(138671),o=n(431469),l=n(121255),s=n(659397),c=n(498110),u=function(e){var t=e.onClose,n=e.onBackdropClick,u=e.isIncoming,d=void 0!==u&&u,p=e.isCautionBoxShown,A=void 0!==p&&p,_=e.children,m=(0,r.useDispatch)(),g=(0,a.useContext)(c.ConfigContext).withAnimation,f=(0,s.classNames)("CallModal",{"CallModal--withAnimation":g});(0,o.usePseudoLayer)();var v=(0,a.useCallback)((function(){return A?void m({type:l.SHOW_CAUTION_BOX,isOpen:!0,isIncoming:d||!1}):t()}),[A]);return a.createElement(i.default,{className:f,disableBodyScroll:!0,onClose:v,onBackdropClick:n},_)}},925082:(e,t,n)=>{"use strict";n.d(t,{CallNotification:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.children,n=e.className,i=(0,r.classNames)("CallNotification",n);return a.createElement("div",{className:i},t)}},548237:(e,t,n)=>{"use strict";n.d(t,{CallOrator:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.children,n=e.orator,i=e.oratorTitle,o=e.onToggleParticipantsAside,l=e.isShownParticipantsAside,s=e.onScroll,c=e.scrollPosition,u=a.Children.toArray(t),d=(0,r.classNames)({CallOrator__toggleIcon:!0,"CallOrator__toggleIcon--withAnimation":!0}),p=(0,r.classNames)({CallOrator:!0,"CallOrator--withoutOthers":!l}),A=(0,r.classNames)({CallOrator__others:!0,"CallOrator__others--hide":!l}),_=(0,r.classNames)({CallOrator__toggleArrow:!0,"CallOrator__toggleArrow--toLeft":l,"CallOrator__toggleArrow--toRight":!l}),m=(0,a.useRef)(null);return(0,a.useEffect)((function(){var e=function(){null!==m.current&&s(m.current.scrollTop)};return null!==m.current&&m.current.addEventListener("scroll",e),function(){m.current&&m.current.removeEventListener("scroll",e)}}),[]),(0,a.useEffect)((function(){var e;null===(e=m.current)||void 0===e||e.scrollTo(0,c)}),[m.current]),a.createElement("article",{className:p,ref:m},a.createElement("main",{className:"CallOrator__orator"},n),a.createElement("button",{className:"CallOrator__toggleOthers",onClick:o},a.createElement("div",{className:d},a.createElement("div",{className:_}))),a.createElement("aside",{className:A},a.createElement("ul",{className:"CallOrator__list"},u.map((function(e){return a.createElement("li",{className:"CallOrator__participant",key:"key"in e?e.key:void 0,"data-calls-id":"participant"},e)})))),i)}},813245:(e,t,n)=>{"use strict";n.d(t,{CallParticipantList:()=>s});var a=n(667294),r=n(736434),i=n(295886),o=n(670546),l=n(662208),s=function(e){var t=e.searchQuery,n=e.onSearchChange,s=e.length,c=e.children,u=e.waitingHallList,d=a.useContext(l.LangContext).getLang;return a.createElement("div",{className:"CallParticipantList"},a.createElement(r.BlockSearchInput,{value:t,placeholder:d("calls_search_participants_placeholder"),onChange:n,onInput:n,onPaste:n,className:"CallParticipantList__input"}),!!u&&u,a.createElement(i.ListHeader,{extra:s||""},d("calls_participant_list_header")),a.createElement(o.default,{border:!1,className:"CallParticipantList__list"},c))}},279060:(e,t,n)=>{"use strict";n.d(t,{CallPhoto:()=>u});var a=n(667294),r=n(906942),i=n(659397),o=n(121255),l=n(690128),s=n(498110),c=n(697483),u=function(e){var t,n=e.id,u=e.waves,d=void 0!==u&&u,p=e.size,A=void 0===p?"m":p,_=e.photo,m=void 0===_?"":_,g=e.alt,f=e.letter,v=e.showCreatorBadge,E=e.showAdminBadge,h=(0,a.useContext)(s.ConfigContext),C=h.withAnimation,S=h.anonymPhoto,y=(0,c.isParticipantAnonym)(n),N=(0,i.classNames)("CallPhoto__photo","CallPhoto--"+A,{"CallPhoto--waves":C&&!!d}),T=null!=f?f:String.fromCodePoint(null!==(t=g.codePointAt(0))&&void 0!==t?t:32);return!m||m.includes(o.DEFAULT_AVATAR)||y&&!S?a.createElement("div",{className:"CallPhoto"},a.createElement(r.ConversationNoPhoto,{id:Math.abs(n),text:T,size:A,className:N}),v?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"creator"}):E?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"admin"}):null):a.createElement("div",{className:"CallPhoto"},a.createElement("img",{src:m,className:N,alt:g}),v?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"creator"}):E?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"admin"}):null)}},471304:(e,t,n)=>{"use strict";n.d(t,{CallSettings:()=>A});var a=n(570655),r=n(667294),i=n(539503),o=n(385177),l=n(662208),s=n(969135),c=n(838482),u=n(121255),d=n(498110),p=n(731585);function A(e){var t=e.cameras,n=e.mics,u=e.noiseCancellationOptions,A=e.videoResolutionOptions,g=e.currentCamId,f=e.currentMicId,v=e.currentNoiseCancellation,E=e.currentVideoResolution,h=e.isCamAvailable,C=void 0!==h&&h,S=e.isMicAvailable,y=void 0!==S&&S,N=e.onCameraChange,T=e.onMicChange,I=e.onNoiseCancellationChange,P=e.onVideoResolutionChange,b=e.pushToTalkEnabled,w=e.onPushToTalkChange,L=r.useContext(l.LangContext).getLang,M=r.useContext(d.ConfigContext).allowPushToTalk,O=(0,r.useRef)(null),k=(0,r.useRef)(null),D=(0,r.useRef)(null),R=(0,r.useRef)(null),B={controls:!1,crossOrigin:"anonymous",playsInline:!0};return m({kind:"video",resolution:E,mediaElRef:O,streamRef:D,deviceId:g,isActive:C}),m({kind:"audio",mediaElRef:k,streamRef:R,deviceId:f,isActive:y}),r.createElement("div",{className:"CallSettings"},r.createElement("div",{className:"CallSettings__camera"},C?r.createElement("video",(0,a.__assign)({ref:O},B,{className:"CallSettings__cameraStream CallSettings__cameraContent"})):r.createElement("div",{className:"CallSettings__cameraStub CallSettings__cameraContent"},L("calls_no_camera"))),y&&r.createElement("audio",(0,a.__assign)({ref:k},B)),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},L("calls_settings_camera")),C?r.createElement(i.default,{options:t.map(_),value:g,onChange:function(e){var t=e.selected;return N(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},L("calls_settings_no_camera"))),C&&r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},L("calls_settings_video_resolution")),r.createElement(i.default,{options:A,value:E,onChange:function(e){var t=e.selected;return P(t.value)},appearance:"secondary",className:"CallSettings__field"})),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},L("calls_settings_mic")),y?r.createElement(i.default,{options:n.map(_),value:f,onChange:function(e){var t=e.selected;return T(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},L("calls_settings_no_mic"))),M&&r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"}),r.createElement(p.default,{className:"CallSettings__field",onChange:w,checked:b},L("calls_settings_push_to_talk_mode_description")),r.createElement(c.default,{className:"CallSettings__tooltip",text:L("calls_settings_push_to_talk_mode_hint"),position:"t",appearance:"light",maxWidth:320},r.createElement(s.default,{className:"CallSettings__hint","aria-label":L("calls_settings_push_to_talk_mode_hint")}))),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},r.createElement("span",{dangerouslySetInnerHTML:{__html:L("calls_settings_noise")}})),y?r.createElement(i.default,{options:u,value:v,onChange:function(e){var t=e.selected;return I(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},L("calls_settings_no_mic")),r.createElement(c.default,{className:"CallSettings__tooltip",text:L("calls_settings_noise_description"),position:"t",appearance:"light",maxWidth:320},r.createElement(s.default,{className:"CallSettings__hint","aria-label":L("calls_settings_noise_description")}))))}function _(e){return{value:e.deviceId,label:e.label}}function m(e){var t=e.kind,n=e.resolution,i=e.mediaElRef,o=e.streamRef,l=e.deviceId,s=e.isActive,c={video:!1,audio:!1},d={deviceId:l};"video"===t&&n&&(d.width={min:428,max:u.VideoWidth[n]||u.VideoWidth.SD,ideal:u.VideoWidth[n]||u.VideoWidth.SD},d.height={min:240,max:u.VideoHeight[n]||u.VideoHeight.SD,ideal:u.VideoHeight[n]||u.VideoHeight.SD}),(0,r.useEffect)((function(){var e;s&&navigator.mediaDevices.getUserMedia((0,a.__assign)((0,a.__assign)({},c),(e={},e[t]=d,e))).then((function(e){var t=o.current;t&&t.getTracks().forEach((function(e){return e.stop()}));var n=i.current;n&&(o.current=e,n.srcObject=e,n.volume=0,n.play())})).catch((function(e){console.error("Error occurred: "+e)}))}),[l,s,n]),(0,r.useEffect)((function(){return function(){var e=o.current;e&&e.getTracks().forEach((function(e){return e.stop()}));var t=i.current;t&&(t.srcObject=null)}}),[])}},555700:(e,t,n)=>{"use strict";n.d(t,{CallSettingsModal:()=>l});var a=n(667294),r=n(7692),i=n(881150),o=n(662208);function l(e){var t=e.onClose,n=e.onSubmit,l=e.children,s=a.useContext(o.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:s("calls_settings"),appearance:"blue",actionButtons:a.createElement(a.Fragment,null,a.createElement(i.default,{onClick:t,appearance:"tertiary"},s("calls_cancel")),a.createElement(i.default,{onClick:n},s("calls_save"))),className:"CallSettingsModal"},l)}},52777:(e,t,n)=>{"use strict";n.d(t,{CallTimer:()=>r});var a=n(667294),r=function(e){var t=e.duration;return a.createElement("div",{className:"CallTimer","aria-label":t,"data-duration":t})}},180474:(e,t,n)=>{"use strict";n.d(t,{CallVideoWidget:()=>p});var a=n(570655),r=n(667294),i=n(423197),o=n(838482),l=n(995141),s=n(952152),c=n(75794),u=n(662208),d=n(464380),p=function(e){var t=e.localVideoStream,n=e.isLocalAudioEnabled,p=e.isLocalAudioAllowed,A=e.isLocalScreenSharing,_=e.participantId,m=e.isMe,g=void 0!==m&&m,f=e.isWithVideo,v=e.isWithAudio,E=e.isScreenSharing,h=e.stream,C=e.photo,S=e.name,y=e.status,N=void 0===y?d.ParticipantStatus.CONNECTED:y,T=e.networkStatus,I=e.onRestoreCall,P=e.onToggleAudio,b=e.children,w=r.useContext(u.LangContext).getLang,L=(0,a.__read)((0,r.useState)(!1),2),M=L[0],O=L[1];(0,r.useEffect)((function(){t||O(!1)}),[t,M]);var k=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),I()}),[I]),D=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),P&&P()}),[P]);return r.createElement("div",{className:"CallVideoWidget",onClick:I},t&&r.createElement(s.Video,{className:"CallVideoWidget__local",stream:t,isMirrored:!A,isContained:!1,isStartWithVisible:!0}),r.createElement(c.Participant,{id:_,hasVideo:f,hasAudio:v,isSharingScreen:E,isMe:g,stream:h,photo:C,name:S,status:N,allowContain:!1,networkStatus:T,photoSize:"s"}),b,r.createElement(i.CallIconButtonGroup,{alignX:"l",alignY:"b",size:"s",className:"CallVideoWidget__buttons"},r.createElement(o.default,{position:"t",align:"left",marginTop:6,text:w(n?"calls_mute":"calls_unmute")},r.createElement(l.CallIconButton,{type:n?"mute":"unmute",onClick:D,disabled:!p}))),r.createElement(i.CallIconButtonGroup,{alignX:"r",alignY:"b",size:"s",className:"CallVideoWidget__buttons"},r.createElement(o.default,{position:"t",align:"right",text:w("calls_restore"),marginTop:6},r.createElement(l.CallIconButton,{type:"restore",onClick:k}))))}},400412:(e,t,n)=>{"use strict";n.d(t,{CallWidget:()=>o});var a=n(667294),r=n(853055),i=n(279060),o=function(e){var t=e.id,n=e.photo,o=e.title,l=e.status,s=e.isIncoming,c=e.onClick,u=e.children;return a.createElement("div",{className:"CallWidget",onClick:c},a.createElement(r.BlurredBackground,{id:t,className:"CallWidget__background"}),a.createElement(i.CallPhoto,{id:t,photo:n,size:"xs",waves:s,alt:o||""}),a.createElement("h1",{className:"CallWidget__name"},o),a.createElement("div",{className:"CallWidget__status"},l),u)}},647686:(e,t,n)=>{"use strict";n.d(t,{default:()=>i});var a=n(667294),r=n(659397);function i(e){var t=e.isInverted,n=(0,r.classNames)("CallingStatus",{"CallingStatus--inverted":!!t}),i=(0,r.classNames)("CallingStatus__part","CallingStatus__part--withAnimation");return a.createElement("div",{className:n},a.createElement("span",{className:i}),a.createElement("span",{className:i}),a.createElement("span",{className:i}))}},722959:(e,t,n)=>{"use strict";n.d(t,{CallsDropdown:()=>l});var a=n(570655),r=n(667294),i=n(617841),o=n(659397),l=function(e){var t=e.children,n=e.items,l=e.open,s=void 0!==l&&l,c=e.setOpen,u=(0,r.useRef)(null),d=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),c(!s)}),[s]),p=function(e){u.current&&u.current.contains(e.target)||c(!1)};return(0,r.useEffect)((function(){return s?document.documentElement.addEventListener("click",p,!0):document.documentElement.removeEventListener("click",p,!0),function(){return document.documentElement.removeEventListener("click",p,!0)}}),[s]),s?r.createElement(i.Popper,{content:r.createElement("ul",{className:"CallsDropdown",ref:u},n.map((function(e,t){return r.createElement("li",{className:"CallsDropdown__item",key:e.key||t},function(e,t,n){void 0===n&&(n=!1);var a=(0,o.classNames)("CallsDropdown__button",{"CallsDropdown__button--disabled":n});return"href"in e&&"onClick"in e&&void 0!==e.onClick?r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank",onClick:n?void 0:function(n){n.stopPropagation(),e.onClick(n),t(!1)},className:a},e.text):"href"in e?r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank",onClick:n?void 0:function(e){e.stopPropagation(),t(!1)},className:a},e.text):"onClick"in e?r.createElement("button",{onClick:n?void 0:function(n){n.stopPropagation(),e.onClick(n),t(!1)},className:a},e.text):null}(e,c,e.disabled))}))),mode:"point"},r.cloneElement(t,(0,a.__assign)((0,a.__assign)({},t.props),{onClick:d,"data-active":s}))):r.cloneElement(t,(0,a.__assign)((0,a.__assign)({},t.props),{onClick:d}))}},587551:(e,t,n)=>{"use strict";n.d(t,{CallsMultiSelect:()=>o});var a=n(667294),r=n(167578),i=n(662208),o=function(e){var t=e.tokens,n=e.onRemoveToken,o=e.value,l=e.onChange,s=e.onSelect,c=e.renderSuggest,u=e.data,d=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{className:"CallsMultiSelect",tokens:t,removeTokenPlaceholder:d("calls_remove_token"),onRemoveToken:n,placeholder:d("calls_search_participants_placeholder"),value:o,onChange:l,onSelect:s,useInfiniteScroll:!1,hasMore:!1,virtualized:!1,loadMore:function(){},notFoundText:d("calls_participants_not_found"),autoFocus:!0,isSearching:!1,renderSuggest:c,data:u})}},152205:(e,t,n)=>{"use strict";n.d(t,{CallsSearchResult:()=>d});var a=n(667294),r=n(295886),i=n(750598),o=n(677247),l=n(121255),s=n(956462),c=n(881150),u=n(780573),d=function(e){var t=e.data,n=e.onClick,d=e.selected,p=e.disabled;if("type"in t)switch(t.type){case l.SearchResultType.HEADER:return a.createElement(r.ListHeader,{className:"CallsSearchResult CallsSearchResult--header",extra:t.count},t.text);case l.SearchResultType.CALL_ALL_IN_CHAT:return a.createElement("div",{className:"CallsSearchResult CallsSearchResult--select"},a.createElement(c.default,{appearance:"secondary",wide:!0,onClick:n},a.createElement("span",{className:"CallsSearchResult__icon"},a.createElement(u.PhoneIconS,null)),t.text));case l.SearchResultType.MEMBERS_MORE:case l.SearchResultType.FRIENDS_MORE:case l.SearchResultType.GROUP_MEMBERS_MORE:return a.createElement(s.ListMore,{onClick:n},t.text)}return a.createElement(i.default,{"data-id":t.peerId,onClick:n,selectable:!p},a.createElement(o.ParticipantSuggest,{member:t,selected:d,disabled:p}))}},884609:(e,t,n)=>{"use strict";n.d(t,{ChatIconButton:()=>l});var a=n(570655),r=n(667294),i=n(659397),o=n(498110),l=(0,r.forwardRef)((function(e,t){var n=e.unreadCount,l=void 0===n?0:n,s=(0,a.__rest)(e,["unreadCount"]),c=(0,r.useContext)(o.ConfigContext).withAnimation,u="",d="";switch(!0){case!l:u="none";break;case l<=9:u="single",d=l.toString();break;case l<=99:u="double",d=l.toString();break;case l>99:u="max",d="99+"}var p=(0,i.classNames)("ChatIconButton","ChatIconButton--"+u,{"ChatIconButton--withAnimation":c});return r.createElement("button",(0,a.__assign)({className:p},s,{ref:t}),d&&r.createElement("div",{className:"ChatIconButton__count "},d))}))},275109:(e,t,n)=>{"use strict";n.d(t,{CollapsedCall:()=>o});var a=n(667294),r=n(498110),i=n(659397),o=function(e){var t=e.children,n=(0,a.useContext)(r.ConfigContext).withAnimation,o=(0,i.classNames)("CollapsedCall",{"CollapsedCall--withAnimation":n});return a.createElement("div",{className:o},t)}},952907:(e,t,n)=>{"use strict";n.d(t,{ErrorPopupText:()=>r});var a=n(667294),r=function(e){var t=e.children;return a.createElement("div",{className:"ErrorPopupText"},t)}},25947:(e,t,n)=>{"use strict";n.d(t,{FeedbackScreen:()=>o});var a=n(667294),r=n(662208),i=n(881150),o=function(e){var t=e.title,n=e.children,o=e.sendButtonClick,l=e.skipButtonClick,s=e.sendButtonDisabled,c=void 0===s||s,u=a.useContext(r.LangContext).getLang;return a.createElement("div",{className:"FeedbackScreen"},a.createElement("div",{className:"FeedbackScreen__close",onClick:l}),a.createElement("div",{className:"FeedbackScreen__title"},t),n,a.createElement("div",{className:"FeedbackScreen__actions"},a.createElement(i.default,{appearance:"overlay_secondary",onClick:l},u("calls_feedback_skip")),a.createElement(i.default,{appearance:"overlay_primary",onClick:o,disabled:c},u("calls_feedback_send"))))}},789241:(e,t,n)=>{"use strict";n.d(t,{IncomingCall:()=>u});var a=n(667294),r=n(853055),i=n(279060),o=n(782117),l=n(995141),s=n(838482),c=n(662208);function u(e){var t=e.id,n=e.photo,u=e.title,d=e.description,p=e.onCollapseCall,A=e.children,_=a.useContext(c.LangContext).getLang;return a.createElement("section",{className:"IncomingCall"},a.createElement(r.BlurredBackground,{id:t}),a.createElement(s.default,{position:"b",text:_("calls_collapse"),marginTop:-6},a.createElement(l.CallIconButton,{type:"collapse",className:"IncomingCall__collapse",onClick:p})),a.createElement(o.IncomingCallHeader,{title:u,description:d}),a.createElement(i.CallPhoto,{id:t,waves:!0,photo:n,alt:u||""}),a.createElement("footer",{className:"IncomingCall__footer"},A))}},782117:(e,t,n)=>{"use strict";n.d(t,{IncomingCallHeader:()=>i});var a=n(667294),r=n(659397);function i(e){var t=e.title,n=e.description,i=e.className;return a.createElement("header",{className:(0,r.classNames)("IncomingCallHeader",i)},a.createElement("h1",{className:"IncomingCallHeader__title"},t),a.createElement("div",{className:"IncomingCallHeader__description"},n))}},991989:(e,t,n)=>{"use strict";n.d(t,{JoinHeader:()=>r});var a=n(667294),r=function(e){var t=e.children;return a.createElement("h2",{className:"JoinHeader"},t)}},991390:(e,t,n)=>{"use strict";n.d(t,{JoinScreen:()=>m});var a=n(667294),r=n(991989),i=n(685537),o=n(881150),l=n(168634),s=n(780573),c=n(595775),u=n(659397),d=n(196287),p=n(590439),A=n(670546),_=n(750598),m=function(e){var t=e.isAnonym,n=e.title,m=e.label,g=e.items,f=e.onChangeName,v=e.name,E=e.namePlaceholder,h=e.joinWithVideoText,C=e.joinWithAudioText,S=e.onJoinWithVideo,y=e.onJoinWithAudio,N=e.disabled,T=e.inputDisabled,I=e.callByNameShow,P=e.onCallByNameClick,b=e.onCallViaNativeAppClick,w=e.callViaNativeAppShow,L=e.callByNameTitle,M=e.callViaNativeAppTitle;return a.createElement("div",{className:(0,u.classNames)("JoinScreen",{"JoinScreen--anonym":t})},a.createElement(r.JoinHeader,null,n),a.createElement("div",{className:"JoinScreen__members"},a.createElement(i.AvatarsStack,{items:g}),a.createElement("div",{className:"JoinScreen__membersLabel"},m)),a.createElement("footer",{className:"JoinScreen__footer"},t&&a.createElement(c.default,{onChange:f,className:"JoinScreen__input",value:v,placeholder:E,disabled:T,maxLength:25,onKeyDown:function(e){"Enter"===e.key&&S()}}),a.createElement(o.default,{appearance:"primary",onClick:S,disabled:N,type:"submit"},a.createElement(l.VideoIconS,{className:"JoinScreen__icon"}),a.createElement("span",null,h)),a.createElement(o.default,{appearance:"primary",title:C,"aria-label":C,onClick:y,disabled:N},a.createElement(s.PhoneIconS,{className:"JoinScreen__icon"}))),(I||w)&&a.createElement(A.default,{border:!1,className:"JoinScreen__options"},w&&a.createElement(_.default,{border:!1,selectable:!0,chevron:!0,onClick:b,icon:a.createElement(d.default,{className:"JoinScreen__optionIcon"})},M),I&&a.createElement(_.default,{border:!1,selectable:!0,chevron:!0,onClick:P,icon:a.createElement(p.default,{className:"JoinScreen__optionIcon"})},L)))}},963985:(e,t,n)=>{"use strict";n.d(t,{KickParticipantModal:()=>c});var a=n(570655),r=n(667294),i=n(7692),o=n(662208),l=n(731585),s=n(498110),c=function(e){var t=e.onClose,n=e.actionButtons,c=e.onAllowReconnectChange,u=e.description,d=e.allowBan,p=e.banText,A=(0,r.useContext)(o.LangContext).getLang,_=(0,r.useContext)(s.ConfigContext).allowBanParticipant,m=(0,a.__read)((0,r.useState)(!0),2),g=m[0],f=m[1],v=(0,r.useCallback)((function(e,t){c&&c(t),f(t)}),[]);return r.createElement(i.default,{className:"KickParticipantModal",appearance:"blue",title:A("calls_kick_participant_title"),actionButtons:n,onClose:t,hasScroll:!1},r.createElement("div",{className:"KickParticipantModal__content"},u,_&&d&&r.createElement("div",null,r.createElement(l.default,{className:"KickParticipantModal__checkbox",onChange:v,checked:g},p))))}},560301:(e,t,n)=>{"use strict";n.d(t,{ListItemWithHint:()=>l});var a=n(570655),r=n(667294),i=n(750598),o=n(911099),l=function(e){var t=e.hint,n=e.className,l=e.children,s=(0,a.__rest)(e,["hint","className","children"]),c=!!t,u={"ListItem--withHint":c};return r.createElement(i.default,(0,a.__assign)({},s,{className:(0,o.classNames)(u,n)}),l,c&&r.createElement("div",{className:"ListItem--hint"},t))}},112877:(e,t,n)=>{"use strict";n.d(t,{MicIconWithSpeakingIndicator:()=>i});var a=n(667294),r=n(911099),i=function(){var e=(0,r.classNames)({MicIconWithSpeakingIndicator__scale:!0});return a.createElement("svg",{height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",className:"MicIconWithSpeakingIndicator"},a.createElement("mask",{id:"MicIconWithSpeakingIndicatorMask"},a.createElement("path",{d:"M8 0a4 4 0 00-4 4v5a4 4 0 008 0V4a4 4 0 00-4-4z"})),a.createElement("path",{d:"M1.1 10c-.55 0-.98.49-.84 1.02a8 8 0 006.84 5.93v2.15a.9.9 0 101.8 0v-2.15a8 8 0 006.84-5.93c.14-.53-.29-1.02-.84-1.02-.45 0-.83.33-.95.76a6.2 6.2 0 01-11.9 0c-.12-.43-.5-.76-.95-.76z"}),a.createElement("g",{mask:"url(#MicIconWithSpeakingIndicatorMask)"},a.createElement("g",{className:e},a.createElement("path",{d:"M8 0a4 4 0 00-4 4v7h8V4a4 4 0 00-4-4z"}),a.createElement("path",{d:"M8 7a4 4 0 00-4 4v5a4 4 0 008 0v-5a4 4 0 00-4-4z",className:"MicIconWithSpeakingIndicator__filled"}))))}},467667:(e,t,n)=>{"use strict";n.d(t,{MuteParticipantModal:()=>o});var a=n(667294),r=n(7692),i=n(731585),o=function(e){var t=e.onClose,n=e.onUnmuteToggle,o=e.allowUnmute,l=e.unmuteToggleDisabled,s=e.actionButtons,c=e.title,u=e.description,d=e.toggleSign;return a.createElement(r.default,{className:"MuteParticipantModal",appearance:"blue",title:c,actionButtons:s,onClose:t},a.createElement("div",{className:"MuteParticipantModal__content"},u,a.createElement(i.default,{className:"MuteParticipantModal__checkbox",onChange:n,checked:o,disabled:l},d)))}},170181:(e,t,n)=>{"use strict";n.d(t,{NotificationWithButton:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.children,n=e.className,i=(0,r.classNames)("NotificationWithButton",n);return a.createElement("div",{className:i},t)}},242422:(e,t,n)=>{"use strict";n.d(t,{OneToOne:()=>o});var a=n(667294),r=n(659397),i=n(75794),o=function(e){var t=e.id,n=e.name,o=e.letter,l=e.hasAudio,s=e.hasVideo,c=e.isSharingScreen,u=e.stream,d=e.wasConnected,p=e.networkStatus,A=e.opponentId,_=e.opponentHasAudio,m=e.opponentHasVideo,g=e.opponentIsSharingScreen,f=e.opponentStream,v=e.opponentPhoto,E=e.opponentName,h=e.opponentWasConnected,C=e.opponentNetworkStatus,S=(0,r.classNames)("OneToOne",{"OneToOne--hasVideo":s,"OneToOne--opponentHasVideo":m});return a.createElement("div",{className:S},a.createElement("aside",{className:"OneToOne__local"},a.createElement(i.Participant,{id:t,hasVideo:s,hasAudio:l,isSharingScreen:c,stream:u,isMe:!0,name:n,letter:o,photoSize:"m",wasConnected:d,allowContain:!0,networkStatus:p})),a.createElement("main",{className:"OneToOne__remote"},a.createElement(i.Participant,{id:A,hasVideo:m,hasAudio:_,isSharingScreen:g,stream:f,photo:v,name:E,photoSize:"l",allowContain:!0,wasConnected:h,networkStatus:C})))}},766610:(e,t,n)=>{"use strict";n.d(t,{OratorTitle:()=>u});var a=n(667294),r=n(641221),i=n(662208),o=n(297627),l=n(722254),s=n(86339),c=n(607350),u=(0,a.memo)((function(e){var t,n,u,d,p,A=e.orator,_=e.me,m=e.isPinned,g=e.isPinnedByAdmin,f=e.isPinnedByShareScreen,v=e.isUnpinAllowed,E=e.onTooltipChange,h=e.onUnpin,C=e.tooltips,S=(0,a.useContext)(i.LangContext).getLang,y=g||f||m,N=(0,a.useCallback)((function(){E("oratorPin",!1),h()}),[h]),T=(0,a.useCallback)((function(){return E("oratorPin",!0)}),[]),I=(0,a.useCallback)((function(){return E("oratorPin",!1)}),[]),P=(A.wasConnected||A.peerId===_)&&!(null===(t=A.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),b=null===(n=A.mediaSettings)||void 0===n?void 0:n.isScreenSharingEnabled,w=A.shortName||A.name,L=A.shortNameGen||A.shortName||A.name,M=((null===(u=A.mediaSettings)||void 0===u?void 0:u.isAudioEnabled)||(null===(d=A.mediaSettings)||void 0===d?void 0:d.isScreenSharingEnabled)||(null===(p=A.mediaSettings)||void 0===p?void 0:p.isVideoEnabled))&&A.networkStatus<.6,O=a.createElement(a.Fragment,null,M&&a.createElement(o.default,{fill:A.networkStatus<=.3?"#ff5c5c":"#FECE00"}),b&&a.createElement("span",{className:"OratorTitle__additionInfo"},S("calls_orator_screen_sharing")),b?L:w,P&&a.createElement(l.default,null),g&&a.createElement(s.default,null),!g&&(f||m)&&a.createElement(c.default,null));return y?a.createElement(r.TooltipNew,{position:"b",align:"center",content:S(g&&v?"calls_hint_admin_pin_for_admin":g?"calls_hint_admin_pin_for_user":"calls_hint_user_pin"),open:C.oratorPin,delay:300,onOpen:T,onClose:I},a.createElement("button",{className:"OratorTitle OratorTitle--button",onClick:N,disabled:!v},O)):a.createElement("div",{className:"OratorTitle"},O)}))},75794:(e,t,n)=>{"use strict";n.d(t,{Participant:()=>h});var a=n(570655),r=n(667294),i=n(853055),o=n(952152),l=n(659397),s=n(426110),c=n(595285),u=n(830810),d=n(722959),p=n(662208),A=n(711034),_=n(498110),m=n(697483),g=n(122317),f=n(647686),v=n(464380),E=n(297627),h=(0,r.memo)((function(e){var t=e.id,n=e.isVisible,h=void 0===n||n,C=e.isOrator,S=void 0!==C&&C,y=e.isInfoShown,N=e.isPinned,T=e.isPinnedByAdmin,I=e.isHandRaised,P=e.photo,b=e.hasVideo,w=e.hasAudio,L=e.isSharingScreen,M=e.isSpeaking,O=void 0!==M&&M,k=e.stream,D=void 0===k?null:k,R=e.isMe,B=void 0!==R&&R,G=e.photoSize,x=e.name,H=e.letter,U=e.status,V=void 0===U?v.ParticipantStatus.CONNECTED:U,F=e.wasConnected,W=void 0===F||F,z=e.networkStatus,j=void 0===z?1:z,Q=e.onClickParticipant,Y=e.onDblClickParticipant,K=e.onStopScreenShare,J=e.allowContain,q=e.actions,Z=r.useContext(p.LangContext).getLang,X=(0,r.useContext)(_.ConfigContext),$=X.withAnimation,ee=X.anonymPhoto,te=r.useRef(null),ne=(0,m.isParticipantAnonym)(t),ae=!!Q||!!Y,re=S&&L&&B,ie=(0,l.classNames)("Participant",{"Participant--isInteractive":ae,"Participant--isPinned":N,"Participant--isSpeaking":O,"Participant--isOrator":S,"Participant--withAnimation":$}),oe=(0,l.classNames)("Participant__more",{"Participant__more--withAnimation":$}),le=(0,a.__read)(r.useState(!1),2),se=le[0],ce=le[1],ue=(0,r.useCallback)((function(e){Q&&Q(e,Number(t))}),[Q]),de=(0,r.useCallback)((function(e){Y&&Y(e,t)}),[Y]);return r.createElement("article",{ref:te,className:ie,onClick:ue,onDoubleClick:de,"participant-id":t},!h&&r.createElement(r.Fragment,null,r.createElement(i.BlurredBackground,{id:t,className:"Participant__main"},r.createElement(s.ParticipantCard,{id:t,photo:!ee&&ne?"":P,photoSize:G,alt:x||"",letter:H,className:y?"Participant__offsetCard":""})),y&&r.createElement("footer",{className:"Participant__footer"},r.createElement("span",{className:"Participant__name"},x),(W||B)&&!w&&r.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"}))),h&&r.createElement(r.Fragment,null,q&&q.length>0&&r.createElement(d.CallsDropdown,{items:q,open:se,setOpen:ce},r.createElement("button",{className:oe,"aria-label":Z("calls_actions")},r.createElement(u.MoreIcon,null))),!(b&&S)&&r.createElement(i.BlurredBackground,{id:t,className:"Participant__main"},r.createElement(s.ParticipantCard,{id:t,photo:!ee&&ne?"":P,photoSize:G,alt:x||"",className:y?"Participant__offsetCard":""})),I&&r.createElement("div",{className:"Participant__handIndicator"},r.createElement(c.RaisedHandContourIcon,{className:"Participant__handIcon"})),re&&r.createElement("div",{className:"Participant__screenSharer"},r.createElement(g.ShareScreenBigIcon,null),r.createElement("div",{className:"Participant__screenSharerText"},Z("calls_you_are_screen_sharer")),r.createElement("button",{className:"Participant__screenSharerButton",onClick:K},Z("calls_screen_share_stop"))),D&&b&&!re&&r.createElement(o.Video,{className:"Participant__main",stream:D,isMirrored:B&&!L,isContained:J||L,isStartWithVisible:B}),V!==v.ParticipantStatus.CONNECTED&&!B&&r.createElement("div",{className:"Participant__status"},r.createElement(f.default,{isInverted:!0})),!S&&y&&r.createElement("footer",{className:"Participant__footer"},(w||D||L)&&j<.6&&r.createElement(E.default,{fill:j<=.3?"#ff5c5c":"#FECE00"}),r.createElement("span",{className:"Participant__name"},x),(W||B)&&!w&&r.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"}))),!T&&N&&r.createElement("header",{className:"Participant__header"},r.createElement("div",{className:"Participant__pin"})),T&&r.createElement("header",{className:"Participant__header"},r.createElement(A.PinDotIcon,{className:"Participant__icon"})))}))},426110:(e,t,n)=>{"use strict";n.d(t,{ParticipantCard:()=>l});var a=n(667294),r=n(279060),i=n(884143),o=n(659397),l=function(e){var t=e.id,n=e.photo,l=e.photoSize,s=void 0===l?"m":l,c=e.alt,u=e.letter,d=e.className;return a.createElement(i.default,{className:(0,o.classNames)("ParticipantCard",d)},a.createElement("span",{className:"ParticipantCard__in"},a.createElement(r.CallPhoto,{id:t,photo:n,size:s,alt:c||"",letter:u})))}},343379:(e,t,n)=>{"use strict";n.d(t,{ParticipantIconButton:()=>o});var a=n(667294),r=n(309605),i=n(494549),o=function(e){var t=e.participantCount,n=e.onClick,o=e.isParticipantControlActive,l=a.createElement(i.ParticipantsIcon,null);if(t&&t>0){var s="";(s=t>99?"99+":null==t?void 0:t.toString())&&(l=a.createElement("div",null,a.createElement("div",{className:"ParticipantIconButton__count"},s),l))}return a.createElement(r.CallButton,{type:o?r.CallButtonTypes.OFF:r.CallButtonTypes.ON,icon:l,onClick:n,className:"Call__footerButton"})}},51247:(e,t,n)=>{"use strict";n.d(t,{ParticipantIndicators:()=>d});var a=n(667294),r=n(659397),i=n(838482),o=n(647686),l=n(942775),s=n(135063),c=n(449587),u=n(662208),d=function(e){var t=e.showSpeaking,n=e.showAudioDisabled,d=e.showRaisedHand,p=e.showConnecting,A=e.showRaisedHandTooltip,_=e.onRaisedHandClick,m=(0,a.useContext)(u.LangContext).getLang,g=a.createElement("span",{className:(0,r.classNames)("ParticipantIndicators__item",{"ParticipantIndicators__item--interactive":void 0!==_}),onClick:null!=_?_:void 0},a.createElement(s.RaisedHandIconS,{className:"ParticipantIndicators__hand"}));return a.createElement("span",{className:"ParticipantIndicators"},t&&a.createElement("span",{className:"ParticipantIndicators__item"},a.createElement(c.VolumeMeterAnimation,null)),n&&a.createElement("span",{className:"ParticipantIndicators__item"},a.createElement(l.MutedMicIconS,{className:"ParticipantIndicators__muted"})),d?A?a.createElement(i.default,{className:"ParticipantIndicators__tooltip",text:m("calls_participant_menu_enable_media_request"),position:"t",align:"center",appearance:"light"},g):g:null,p&&a.createElement("span",{className:"ParticipantIndicators__item"},a.createElement(o.default,null)))}},95939:(e,t,n)=>{"use strict";n.d(t,{ParticipantMenu:()=>o});var a=n(667294),r=n(919535),i=n(309739),o=function(e){var t=e.position,n=e.align,o=e.trigger,l=e.marginTop,s=e.marginLeft,c=e.actions;return c.length>0?a.createElement(i.default,{position:t,align:n,trigger:o,marginTop:l,marginLeft:s,className:"ParticipantMenu__dropdown",data:c},a.createElement(r.ListActionsControl,null)):null}},677247:(e,t,n)=>{"use strict";n.d(t,{ParticipantSuggest:()=>o});var a=n(667294),r=n(248586),i=n(659397);function o(e){var t=e.member,n=e.selected,o=void 0!==n&&n,l=e.disabled,s=void 0!==l&&l,c=(0,i.classNames)("ParticipantSuggest",{"ParticipantSuggest--selected":o,"ParticipantSuggest--disabled":s});return a.createElement("div",{className:c,"data-id":t.id},a.createElement(r.default,{size:"34",title:t.name,photo:t.photo}))}},338374:(e,t,n)=>{"use strict";n.d(t,{TransferAdminRightsModal:()=>g});var a=n(667294),r=n(50533),i=n(881150),o=n(138671),l=n(838480),s=n(774415),c=n(662208),u=n(670546),d=n(295886),p=n(750598),A=n(248586),_=n(595775),m=n(884143),g=function(e){var t=e.participants,n=e.selected,g=e.onSelect,f=e.onClose,v=e.onCallForceFinish,E=e.onRightsTransfer,h=e.onSearch,C=(0,a.useContext)(c.LangContext).getLang,S=(0,r.useSelector)((function(e){return e.me}));return a.createElement(o.default,{className:"TransferAdminRightsModal",disableBodyScroll:!1,onClose:f},a.createElement(l.ModalHeader,{title:C("calls_dialog_creator_exit_title"),onClose:f,appearance:"blue"}),a.createElement("div",{className:"TransferAdminRightsModal__content"},a.createElement(_.default,{onChange:function(e){return h(e.target.value)},placeholder:C("calls_search_participants_placeholder"),className:"TransferAdminRightsModal__searchInput"}),a.createElement(u.default,{border:!1},a.createElement(d.ListHeader,{extra:t.length},C("calls_call_participants")),0===t.filter((function(e){return e.peerId!==S})).length&&a.createElement(m.default,null,C("calls_participants_not_found")),t.filter((function(e){return e.peerId!==S})).map((function(e){return a.createElement(p.default,{key:e.peerId,className:"TransferAdminRightsModal__item",onClick:function(){return g(n!==e.peerId?e:null)},aside:a.createElement("span",{className:"TransferAdminRightsModal__label","aria-selected":n===e.peerId},n===e.peerId?C("calls_dialog_creator_exit_selected"):C("calls_dialog_creator_exit_select"))},a.createElement(A.default,{size:"34",title:e.name,photo:e.photo}))})))),a.createElement(s.ModalFooter,{actionButtons:[a.createElement(i.default,{key:"force",appearance:"secondary",onClick:v},C("calls_force_call_finish")),a.createElement(i.default,{key:"action",onClick:E},C(null===n?"calls_leave_call":"calls_dialog_creator_exit_action"))]}))}},958713:(e,t,n)=>{"use strict";n.d(t,{TranslationCreateForm:()=>S});var a,r,i=n(570655),o=n(667294),l=n(595775),s=n(244809),c=n(662208),u=n(942019),d=n(750598),p=n(448625),A=n(670546),_=n(539503),m=n(823694),g=n(449608),f=n(329538),v=n(326542),E=n(874023),h=n(613335),C=n(50533);function S(e){var t=e.onSubmit,n=e.onClose,S=(0,o.useContext)(c.LangContext),y=S.getLang,N=S.langShortDateTime,T=(0,C.useSelector)((function(e){return e})),I=function(){var e=(new Date).toISOString().split("T")[0];return y("calls_translation_title_default_value").replace("%s",e)},P=function(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=""),{id:e,name:t,photo:n,isGroup:e<0}},b=function(e){var t=[{value:a.ONLY_ME,label:y("calls_translation_privacy_only_me_and_chat")},{value:a.FRIENDS,label:y("calls_translation_privacy_friends_and_chat")}];return e&&t.push({value:a.ALL,label:y("calls_translation_privacy_all_users")}),t},w=(0,h.getMe)(T),L=T.config,M=(0,i.__read)((0,o.useState)(I()),2),O=M[0],k=M[1],D=(0,i.__read)((0,o.useState)(""),2),R=D[0],B=D[1],G=(0,i.__read)((0,o.useState)(T.groupId?a.ALL:a.ONLY_ME),2),x=G[0],H=G[1],U=(0,i.__read)((0,o.useState)((function(){return b(!w.isClosed||!!T.groupId)})),2),V=U[0],F=U[1],W=(0,i.__read)((0,o.useState)((function(){var e,t;return T.groupId?P(T.groupId,null===(e=T.meGroup)||void 0===e?void 0:e.name,null===(t=T.meGroup)||void 0===t?void 0:t.photo):P(w.peerId,w.name,w.photo)})),2),z=W[0],j=W[1],Q=(0,i.__read)((0,o.useState)(r.MAIN),2),Y=Q[0],K=Q[1],J=(0,i.__read)((0,o.useState)({}),2),q=J[0],Z=J[1],X=(0,i.__read)((0,o.useState)((function(){return T.groupId&&T.meGroup?[{value:T.meGroup.peerId,label:T.meGroup.name}]:[{value:w.peerId,label:w.name}]})),2),$=X[0],ee=X[1],te=(0,i.__read)((0,o.useState)([]),2),ne=te[0],ae=te[1],re=(0,i.__read)((0,o.useState)(!1),2),ie=re[0],oe=re[1],le=(0,i.__read)((0,o.useState)([]),2),se=le[0],ce=le[1],ue=(0,i.__read)((0,o.useState)([]),2),de=ue[0],pe=ue[1],Ae=(0,o.useCallback)((function(){var e=O.trim(),n=R.trim(),a={};if(Object.keys(q).length>0){e||(e=q.title),n||(n=q.description);var r=n!=q.title||e!=q.description;r||(r=z.id>0&&q.privacy_view.category!=x),r&&(0,f.sendVideoEdit)(z.id,q.id,e,n,x).catch((function(e){return console.error(e)}));var i={ovId:q.ov_id};q.live_start_time&&(i.startTime=q.live_start_time),a.upcomingStreamParams=i}else a.streamParams={name:e||I(),description:n,privacy_view:x,group_id:z.id<0?-z.id:0,call:!0};t(a)}),[O,R,x,z,q]);(0,o.useEffect)((function(){T.groupId||(0,f.loadUserAdminedGroupsAction)(L.sferum).then((function(e){var t=(0,i.__spreadArray)([],(0,i.__read)($));e.count>0&&(e.items.forEach((function(e){e.can_upload_video&&t.push({value:-e.id,label:e.name})})),ee(t),ae(e.items))})).catch((function(e){return console.error(e)}))}),[]),(0,o.useEffect)((function(){Z({}),oe(!1),ce([]),(0,f.getUpcomingLives)([z.id]).then((function(e){var t=[];e.count>0&&(t=e.items.filter((function(e){return""!==e.ov_id})));var n=t.length>0;if(oe(n),ce(t),n){var a=[];t.forEach((function(e){e.owner_id&&e.owner_id>0&&a.push(e.owner_id.toString())})),a&&(0,f.loadUsers)({user_ids:a.join(",")}).then((function(e){var t=[];e.forEach((function(e){t.push({id:e.id,name:e.first_name+" "+e.last_name})})),pe(t)})).catch((function(e){return console.error(e)}))}})).catch((function(e){return console.error(e)}))}),[z]);var _e=function(e){var t=e.date;e.live_start_time&&(t=e.live_start_time);var n=t-Date.now()/1e3;return n>0&&n<E.WEEK?y("calls_translation_date_label_soon"):""};return o.createElement(o.Fragment,null,Y===r.MAIN&&o.createElement(u.TranslationCreateModal,{onClose:n,onSubmit:Ae,title:y("calls_translation_box_title")},o.createElement("div",{className:"TranslationCreateForm__link"},o.createElement(A.default,null,$.length>0&&o.createElement(d.default,{border:!0,canBeHovered:!1,selectable:!1,icon:o.createElement(p.ListIcon,{icon:o.createElement("img",{className:"TranslationCreateForm__ownerIcon",src:z.photo,alt:z.name}),color:p.ListIconColors.GRAY}),aside:o.createElement(_.default,{className:"TranslationCreateFormOptions__longselect",options:$,value:z.id,onChange:function(e){var t=e.selected.value;t<0?ne.forEach((function(e){e.id==-t&&(H(a.ALL),F(b(!0)),j(P(-e.id,e.name,e.photo_100)))})):(F(b(!w.isClosed)),H(a.ONLY_ME),j(P(w.peerId,w.name,w.photo)))},disabled:$.length<=1})},y("calls_translation_owner_title")),ie&&o.createElement(d.default,{onClick:function(){ie&&K(r.SELECT_POSTPONE)},chevron:!0,border:!0,icon:o.createElement(p.ListIcon,{icon:o.createElement(g.TimeIcon,null),color:p.ListIconColors.GREEN})},y("calls_translation_postponed_title"),Object.keys(q).length>0&&o.createElement("div",{className:"TranslationCreateForm__copyControl"},o.createElement(v.default,{className:"TranslationCreateForm__copyButton",onClick:function(e){e.preventDefault(),e.stopPropagation(),Z({}),k(I()),B("")}},y("calls_translation_postponed_reset")))),!L.sferum&&o.createElement(d.default,{border:!1,canBeHovered:!1,selectable:!1,icon:o.createElement(p.ListIcon,{icon:o.createElement(m.PrivacyIcon,null),color:p.ListIconColors.GRAY}),aside:o.createElement(_.default,{className:"TranslationCreateForm__privacySelector TranslationCreateFormOptions__longselect",disabled:z.isGroup,options:V,value:x,onChange:function(e){H(e.selected.value)}})},y("calls_translation_who_can_see_video_privacy"))),o.createElement("div",{className:"TranslationCreateForm__privacyHint"},y("calls_translation_who_can_see_video_privacy_hint"))),o.createElement("form",{className:"TranslationCreateForm__main",onSubmit:Ae},o.createElement("div",{className:"TranslationCreateForm__section"},o.createElement("div",{className:"TranslationCreateForm__block"},o.createElement("label",{className:"TranslationCreateForm__label"},y("calls_translation_title"),o.createElement(l.default,{className:"TranslationCreateForm__field",value:O,onChange:function(e){var t=e.target;k(t.value)},placeholder:y("calls_translation_name_placeholder")}))),o.createElement("div",{className:"TranslationCreateForm__block"},o.createElement("label",{className:"TranslationCreateForm__label"},y("calls_translation_description"),o.createElement(s.default,{className:"TranslationCreateForm__field",placeholder:y("calls_translation_description_placeholder"),value:R,onChange:function(e){var t=e.target;B(t.value)}})))),o.createElement("div",{className:"TranslationCreateForm__tabSection"},o.createElement("div",{className:"TranslationCreateForm__warning"},y("calls_translation_notification_warning"))))),Y===r.SELECT_POSTPONE&&o.createElement(u.TranslationCreateModal,{title:y("calls_translation_select_upcoming_box_title"),isWithBackButton:!0,onBackClick:function(){return K(r.MAIN)},onClose:n,contentClassName:"TranslationCreateForm__modalVideo"},o.createElement("div",null,se.length>0&&o.createElement(A.default,{className:"TranslationCreateForm__VideoList"},se.map((function(e,t){return o.createElement(d.default,{className:"TranslationCreateForm__videoItem",active:e.id===q,key:t,border:!0,canBeHovered:!0,selectable:!0,onClick:function(){return(t=e).owner_id>0&&(0,f.getVideos)(t.owner_id,[t.owner_id+"_"+t.id],!0).then((function(e){if(e.count>0){var n=e.items.filter((function(e){return e.id==t.id}));n.length>0&&(t.privacy_view=n[0].privacy_view,Z(t),t.privacy_view&&H(t.privacy_view.category))}})),Z(t),K(r.MAIN),k(t.title),void B(t.description);var t},aside:o.createElement("span",{className:"TranslationCreateForm__videoLink"},y("calls_translation_select_video_link"))},o.createElement("div",{className:"TranslationCreateForm__videoImagePreview"},o.createElement("img",{className:"TranslationCreateForm__videoImage",src:e.image&&e.image[0]&&e.image[0].url?e.image[0].url:"",alt:e.title}),_e(e)&&o.createElement("span",{className:"TranslationCreateForm__videoImageLabel"},_e(e))),o.createElement("div",{className:"TranslationCreateForm__videoDescription"},o.createElement("div",{className:"TranslationCreateForm__videoTitle"},e.title),o.createElement("div",{className:"TranslationCreateForm__videoOwner"},function(e){if(!(e>0))return z.name;var t=de.filter((function(t){return t.id==e}));if(t.length>0){var n=t[0];if(n)return n.name}return""}(e.owner_id)),o.createElement("div",{className:"TranslationCreateForm__videoDate"},(a=(n=e).date,n.live_start_time&&(a=n.live_start_time),N(1e3*a)))));var n,a}))))))}!function(e){e.ONLY_ME="only_me",e.FRIENDS="friends",e.ALL="all"}(a||(a={})),function(e){e[e.MAIN=0]="MAIN",e[e.SELECT_POSTPONE=1]="SELECT_POSTPONE"}(r||(r={}))},942019:(e,t,n)=>{"use strict";n.d(t,{TranslationCreateModal:()=>c});var a=n(667294),r=n(881150),i=n(662208),o=n(138671),l=n(838480),s=n(774415);function c(e){var t=e.onClose,n=e.onSubmit,c=e.title,u=e.children,d=e.isWithBackButton,p=e.onBackClick,A=e.contentClassName,_=void 0===A?"TranslationCreateModal__content":A,m=a.useContext(i.LangContext).getLang,g=n&&t;return a.createElement(o.default,{disableBodyScroll:!0,onClose:t,className:"TranslationCreateModal",hasScroll:!1},a.createElement(l.ModalHeader,{title:c,onClose:t,appearance:"blue",backText:d?m("calls_back"):void 0,onBack:p}),a.createElement("div",{className:_},u),g&&a.createElement(s.ModalFooter,{actionButtons:a.createElement(a.Fragment,null,a.createElement(r.default,{onClick:t,appearance:"tertiary"},m("calls_cancel")),a.createElement(r.default,{onClick:n},m("calls_translation_start")))}))}},162144:(e,t,n)=>{"use strict";n.d(t,{TranslationLink:()=>u});var a=n(570655),r=n(667294),i=n(595775),o=n(881150),l=n(629142),s=n(58600),c=n(662208),u=function(e){var t=e.link,n=r.useContext(c.LangContext).getLang,u=(0,a.__read)((0,r.useState)(!1),2),d=u[0],p=u[1],A=(0,r.useCallback)((function(){return p(!0)}),[]),_=(0,r.useCallback)((function(){return p(!1)}),[]);return r.createElement("div",{className:"TranslationLink"},r.createElement("p",{className:"TranslationLink__info"},n("calls_translation_link_info")),r.createElement(i.default,{readOnly:"readonly",className:"TranslationLink__input",value:t}),t&&r.createElement(s.CopyText,{text:t,onCopyDone:A},r.createElement(o.default,null,n("calls_translation_link_copy"))),r.createElement(l.default,{className:"TranslationLink__copied",shown:d,callback:_},n("calls_translation_link_copied")))}},979414:(e,t,n)=>{"use strict";n.d(t,{TranslationStartCountdownModal:()=>l});var a=n(667294),r=n(138671),i=n(662208),o=n(881150),l=function(e){var t=e.onCloseModal,n=e.counter,l=e.onStopTranslation,s=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{disableBackdropClick:!0,disableEscapeClose:!0,className:"TranslationStartCountdownModal",onClose:t},a.createElement("div",{className:"TranslationStartCountdownModal__content"},a.createElement("div",{className:"TranslationStartCountdownModal__counter"},n),a.createElement(o.default,{className:"TranslationStartCountdownModal__stop",onClick:l,appearance:"overlay_secondary"},s("calls_translation_cancel_button"))))}},880076:(e,t,n)=>{"use strict";n.d(t,{TranslationStatus:()=>u});var a=n(667294),r=n(801513),i=n(30933),o=n(659397),l=n(309739),s=n(607910),c=n(641221),u=function(e){var t=e.translationTimer,n=e.viewersCount,u=void 0===n?0:n,d=e.isLiveIndicatorOff,p=void 0!==d&&d,A=e.actions,_=void 0===A?[]:A,m=e.tooltipText,g=void 0===m?"":m,f=(0,o.classNames)("TranslationStatus__translationIndicator",{"TranslationStatus__translationIndicator--disabled":p}),v=(null==_?void 0:_.length)>0,E=(0,o.classNames)("TranslationStatus__translationTimer",{"TranslationStatus__translationTimer--hasIndicator":!p}),h=a.createElement("div",{className:"TranslationStatus__translation",key:"translation"},a.createElement(r.LiveIcon,{className:f}),a.createElement(a.Fragment,null,!!t&&a.createElement("div",{className:E},t),!p&&a.createElement("div",{className:"TranslationStatus__translationViewersCount"},a.createElement(i.ViewersCountIcon,null),a.createElement("div",{className:"TranslationStatus__translationViewersCountNumber"},u)),v&&a.createElement("div",{className:"TranslationStatus__translationDropdown"},a.createElement(s.TranslationStatusChevronIcon,null))));return v?h=a.createElement(l.default,{position:"b",align:"center",horizontalPosition:"right",trigger:"hover",marginLeft:-10,data:_,className:"TranslationStatus_dropdown"},h):g&&(h=a.createElement(c.TooltipNew,{content:a.createElement(a.Fragment,null,g)},h)),a.createElement("div",{className:"TranslationStatus"},h)}},389809:(e,t,n)=>{"use strict";n.d(t,{TranslationStopModal:()=>o});var a=n(667294),r=n(7692),i=n(662208),o=function(e){var t=e.onClose,n=e.actionButtons,o=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:o("calls_translation_stop_confirmation"),appearance:"blue",actionButtons:n,className:"TranslationStopModal"},a.createElement("div",{className:"TranslationStopModal__text"},o("calls_translation_stop_sure")))}},904992:(e,t,n)=>{"use strict";n.d(t,{UnbanMembersModal:()=>l});var a=n(667294),r=n(7692),i=n(662208),o=n(685537),l=function(e){var t=e.onClose,n=e.actionButtons,l=e.description,s=e.subDescription,c=e.avatarsItems,u=(0,a.useContext)(i.LangContext).getLang;return a.createElement(r.default,{className:"UnbanMembersModal",appearance:"blue",title:u("calls_unban_participant_title"),actionButtons:n,onClose:t,hasScroll:!1},a.createElement("div",{className:"UnbanMembersModal__content"},a.createElement(o.AvatarsStack,{items:c}),a.createElement("div",{className:"UnbanMembersModal__description"},l),a.createElement("div",{className:"UnbanMembersModal__subDescription"},s)))}},860925:(e,t,n)=>{"use strict";n.d(t,{UnmuteRequestModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.onClose,n=e.actionButtons,i=e.title,o=e.description;return a.createElement(r.default,{className:"UnmuteRequestModal",appearance:"blue",title:i,actionButtons:n,onClose:t},a.createElement("div",{className:"UnmuteRequestModal__content"},o))}},690128:(e,t,n)=>{"use strict";n.d(t,{UserBadge:()=>o});var a=n(667294),r=n(659397),i=n(995811),o=function(e){var t=e.className,n=e.type;return a.createElement("div",{className:(0,r.classNames)("UserBadge","UserBadge--"+n,t)},a.createElement(i.StarIcon,null))}},952152:(e,t,n)=>{"use strict";n.d(t,{Video:()=>l});var a=n(667294),r=n(659397),i=n(604233),o=new WeakMap,l=(0,a.memo)((function(e){var t=e.stream,n=e.isMirrored,l=void 0!==n&&n,s=e.isContained,c=void 0!==s&&s,u=e.isStartWithVisible,d=void 0!==u&&u,p=e.className,A=a.useRef(null),_=a.useRef(null),m=a.useRef(t);return a.useEffect((function(){var e,n,a,s;if(!(null===(e=A.current)||void 0===e?void 0:e.lastElementChild)||m.current!==t){var u=d;if(t&&(o.has(t)?null===(null===(n=o.get(t))||void 0===n?void 0:n.closest("body"))?(_.current=null!==(a=o.get(t))&&void 0!==a?a:null,u=!0):_.current=(0,i.createVideoTag)(t):(_.current=(0,i.createVideoTag)(t),o.set(t,_.current))),_.current&&A.current&&A.current.lastElementChild!==_.current){var p=(0,r.classNames)("Video",{"Video--contain":c,"Video--mirrored":l,"Video--visible":u||(null===(s=_.current)||void 0===s?void 0:s.classList.contains("Video--visible"))});A.current.lastElementChild&&(A.current.innerHTML=""),_.current.className=p,A.current.appendChild(_.current),_.current.play()}return function(){_.current&&_.current!==o.get(t)&&(_.current.srcObject=null,_.current.src="",_.current.pause(),_.current.removeAttribute("src"),_.current.load()),A.current&&(A.current.innerHTML="")}}}),[t,A.current]),a.createElement("div",{ref:A,className:p})}))},449587:(e,t,n)=>{"use strict";n.d(t,{VolumeMeterAnimation:()=>i});var a=n(667294),r=n(911099),i=function(){var e=(0,r.classNames)("VolumeMeterAnimation","VolumeMeterAnimation--withAnimation");return a.createElement("div",{className:e})}},100741:(e,t,n)=>{"use strict";n.d(t,{WaitingHall:()=>i});var a=n(667294),r=n(75794),i=function(e){var t=e.id,n=e.name,i=e.letter,o=e.hasAudio,l=e.hasVideo,s=e.stream,c=e.wasConnected;return a.createElement("div",{className:"WaitingHall"},a.createElement("main",{className:"WaitingHall__main"},a.createElement(r.Participant,{id:t,hasVideo:l,hasAudio:o,isSharingScreen:!1,stream:s,isMe:!0,name:n,letter:i,photoSize:"m",allowContain:!0,wasConnected:c,networkStatus:1})))}},51443:(e,t,n)=>{"use strict";n.d(t,{WaitingHallInfo:()=>r});var a=n(667294),r=function(e){var t=e.text;return a.createElement("div",{className:"WaitingHallInfo"},a.createElement("div",{className:"WaitingHallInfo__text"},t))}},428990:(e,t,n)=>{"use strict";n.d(t,{WaitingHallList:()=>d});var a=n(667294),r=n(295886),i=n(662208),o=n(248586),l=n(279060),s=n(750598),c=n(881150),u=n(670546),d=function(e){var t=e.members,n=void 0===t?[]:t,d=e.totalCount,p=void 0===d?0:d,A=e.navigateToProfile,_=e.onPromote,m=e.onForbid,g=a.useContext(i.LangContext).getLang;return 0===n.length?a.createElement(a.Fragment,null):a.createElement(a.Fragment,null,a.createElement(r.ListHeader,{extra:p||""},g("calls_waiting_hall_list_header")),a.createElement(u.default,{border:!1,className:"CallParticipantList__list CallParticipantList__list--waitingList"},n.map((function(e){return a.createElement(s.default,{selectable:!1,border:!1,key:e.peerId,aside:a.createElement(a.Fragment,null,a.createElement(c.default,{onClick:function(){return m(e.peerId)},appearance:"secondary"},g("calls_waiting_hall_forbid")),a.createElement(c.default,{onClick:function(){return _(e.peerId)}},g("calls_waiting_hall_join")))},a.createElement(o.default,{onLinkClick:A,photo:a.createElement(l.CallPhoto,{id:e.peerId,photo:e.photo,alt:e.name||"",size:"xxxs"}),title:e.name,href:e.link,target:"_blank"}))}))))}},782605:(e,t,n)=>{"use strict";n.d(t,{AddParticipantContainer:()=>E});var a,r=n(570655),i=n(667294),o=n(50533),l=n(121255),s=n(587551),c=n(697483),u=n(389953),d=n(431469),p=n(152205),A=n(662208),_=n(788822),m=n(820717),g=n(745284),f=function(e){return e?(0,_.escape)(e.replace(/\t/g,"\n")):""},v=!1,E=function(e){var t=e.onChange,n=e.onClickCallAll,u=e.groupId,_=(0,o.useSelector)((function(e){return e})),E=i.useContext(A.LangContext).getLang,N=(0,o.useDispatch)(),T=(0,r.__read)((0,i.useState)(""),2),I=T[0],P=T[1],b=(0,r.__read)((0,i.useState)({}),2),w=b[0],L=b[1],M=(0,r.__read)((0,i.useState)(!1),2),O=M[0],k=M[1],D=(0,r.__read)((0,i.useState)(!1),2),R=D[0],B=D[1],G=(0,r.__read)((0,i.useState)(!1),2),x=G[0],H=G[1],U=(0,r.__read)((0,i.useState)(h(_.chatMembers,u?[]:_.friends)),1)[0],V=(0,r.__read)((0,i.useState)(C(_.chatMembers,U,_.groupMembers)),2),F=V[0],W=V[1],z=(0,r.__read)((0,i.useState)(h(_.chatMembers,_.groupMembers)),2),j=z[0],Q=z[1],Y=(_.preselectedIds||[]).filter((function(e){return!(0,c.isParticipantAnonym)(e)&&F[e]})),K=(0,r.__read)((0,i.useState)(Y),2),J=K[0],q=K[1],Z=(0,r.__read)((0,i.useState)(!1),2),X=Z[0],$=Z[1],ee=(0,i.useCallback)((function(e){return e.name}),[]),te=(0,i.useCallback)((function(e){return e.peerId}),[]),ne=(0,d.useIndexer)((0,r.__spreadArray)((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(_.chatMembers)),(0,r.__read)(U)),(0,r.__read)(j)),ee,te),ae=_.groupMembersCount>l.COUNT_OF_GROUP_MEMBERS_TO_LOAD,re=(0,i.useCallback)((function(e){if(e){var t=ne.search(e);if(v){var n={};return t.forEach((function(e){n[e.id]=e})),Object.values(n)}return t}return function(e,t,n,a,i,o,s,c,u){var d=5,p=10,A=10,_={type:l.SearchResultType.MEMBERS_MORE,text:u("calls_show_all_members")},m={type:l.SearchResultType.FRIENDS_MORE,text:u("calls_show_all_friends")},g={type:l.SearchResultType.GROUP_MEMBERS_MORE,text:u("calls_show_all_group_members")},f={type:l.SearchResultType.HEADER,text:u("calls_chat_members"),count:e.length},v={type:l.SearchResultType.HEADER,text:u("calls_chat_group_members"),count:s},E={type:l.SearchResultType.HEADER,text:u("calls_friends")},h={type:l.SearchResultType.CALL_ALL_IN_CHAT,text:u("calls_call_all")},C=[];if(e.length>0)if(C.push(f),e.length<=c&&C.push(h),a||e.length<=d)C.push.apply(C,(0,r.__spreadArray)([],(0,r.__read)(e)));else{for(var S=0;S<d;S++)C.push(e[S]);C.push(_)}if(t.length>0)if(C.push(E),i||t.length<=p)C.push.apply(C,(0,r.__spreadArray)([],(0,r.__read)(t)));else{for(S=0;S<p;S++)C.push(t[S]);C.push(m)}if(n.length>0)if(C.push(v),o||n.length<=A)C.push.apply(C,(0,r.__spreadArray)([],(0,r.__read)(n)));else{for(S=0;S<A;S++)C.push(n[S]);C.push(g)}return C}(_.chatMembers,U,j,O,R,x,_.groupMembersCount,_.participantLimit,E)}),[_,O,R,x]),ie=(0,r.__read)((0,i.useState)(re(I)),2),oe=ie[0],le=ie[1],se=function(e){q(e),t(e)},ce=(0,i.useCallback)((function(e){return se((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(J)),[+e]))}),[J]),ue=(0,i.useCallback)((function(e){return se(J.filter((function(t){return t!==+e})))}),[J]),de=(0,c.getActiveParticipants)(_.participants,_.me,_.groupId,_.meGroup).map((function(e){return{id:e.peerId.toString(),text:f(e.name),locked:!0}})).concat(J.map((function(e){return{text:f(F[e].name),id:e.toString(),locked:!1}})));(0,i.useEffect)((function(){L(J.reduce((function(e,t){return e[t]=!0,e}),{}))}),[]),(0,i.useEffect)((function(){le(re(I))}),[J,O,R,x]),(0,i.useEffect)((function(){var e=I;return ae&&(e.length>=3&&!X?a=setTimeout((function(){(0,m.serverSearchGroupMembers)(-_.groupId,e,_,N).then((function(t){if($(!1),t.length>0){v=!0;var n=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(j)),(0,r.__read)(t));Q(h(_.chatMembers,n)),W(C(_.chatMembers,U,n)),t.forEach((function(e){ne.add(e)})),le(re(e))}}))}),1e3):a&&($(!1),clearTimeout(a))),function(){clearTimeout(a)}}),[I]);var pe=(0,i.useCallback)((function(e){P(e.target.value),le(re(e.target.value))}),[]),Ae=(0,i.useCallback)((function(e){var t;return ue(e),L((0,r.__assign)((0,r.__assign)({},w),((t={})[e]=!1,t))),Promise.resolve()}),[w]),_e=(0,i.useCallback)((function(e){var t,n;return S(e,_,w)?(ue(e),L((0,r.__assign)((0,r.__assign)({},w),((t={})[e]=!1,t)))):y(F[e],_,de,w,(0,g.isAuthedByGroupId)(_))||(ce(e),L((0,r.__assign)((0,r.__assign)({},w),((n={})[e]=!0,n))),P(""),le(re(""))),Promise.resolve()}),[J,_,w]),me=(0,i.useCallback)((function(){var e=(0,c.getActiveParticipants)(_.participants,_.me,_.groupId,_.meGroup).reduce((function(e,t){return e[t.peerId]=!0,e}),{}),t=_.chatMembers.reduce((function(t,n){var a=n.peerId;return e[a]||y(n,_,de,w,(0,g.isAuthedByGroupId)(_))||t.push(a),t}),[]);n(t)}),[_,J,w]),ge=(0,i.useCallback)((function(e,t){if(!("type"in e))return t;switch(e.type){case l.SearchResultType.CALL_ALL_IN_CHAT:return function(){return me()};case l.SearchResultType.MEMBERS_MORE:return function(){return k(!0)};case l.SearchResultType.FRIENDS_MORE:return function(){return B(!0)};case l.SearchResultType.GROUP_MEMBERS_MORE:return function(){return H(!0)};default:return function(){}}}),[me]);return i.createElement(s.CallsMultiSelect,{tokens:de,onRemoveToken:Ae,value:I,onChange:pe,onSelect:_e,renderSuggest:function(e,t){return function(e,t){var n="peerId"in e?e.peerId:0;return i.createElement(p.CallsSearchResult,{data:e,onClick:ge(e,t),selected:S(n,_,w),disabled:y(F[n],_,de,w,(0,g.isAuthedByGroupId)(_)),key:n||"text"in e&&e.text||void 0})}(e,t)},data:oe})};function h(e,t){var n=e.reduce((function(e,t){return e[t.id]=!0,e}),{});return t.filter((function(e){return!n[e.id]}))}function C(e,t,n){return[].concat(t,e,n).reduce((function(e,t){return e[t.id]=t,e}),{})}function S(e,t,n){return n&&n[e]||(0,c.isParticipantInCall)(t,e)}function y(e,t,n,a,r){void 0===r&&(r=!1);var i=(null==e?void 0:e.peerId)||0;if((0,c.isParticipantInCall)(t,i))return!0;if(S(i,t,a))return!1;if(r){if((0,c.isParticipantUnavailableToCallFromGroup)(t,i))return!0}else if(!(null==e?void 0:e.canCall))return!0;return n.length>=t.participantLimit||!(0,u.isUserPeer)(i)}},358898:(e,t,n)=>{"use strict";n.d(t,{AdminPinUnmuteRequestContainer:()=>d});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(169610),c=n(734273),u=n(464380),d=function(e){var t=e.SDK,n=(0,r.useDispatch)(),d=a.useContext(l.LangContext).getLang,p=(0,r.useSelector)((function(e){return e})),A=p.participants[p.me].mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},_=function(){n({type:o.TOGGLE_POPUP})};return a.createElement(c.AdminPinUnmuteRequestModal,{onClose:_,title:d("calls_admin_pin_dialog_title"),description:d("calls_admin_pin_dialog_description"),actionButtons:[a.createElement(i.default,{onClick:_,appearance:"secondary",key:"cancel"},d("calls_admin_pin_dialog_cancel")),a.createElement(i.default,{onClick:function(){(A.isAudioEnabled?Promise.resolve():(0,s.checkPermissions)(t,[u.MediaOption.AUDIO])).then((function(){var e;(null===(e=p.notification)||void 0===e?void 0:e.type)===o.NotificationType.SPEAKING_ON_MUTE&&n({type:o.CALL_NOTIFICATION,notification:null}),t.toggleLocalAudio(!0).catch(console.log)})).then((function(){return _()}))},key:"mic"},d("calls_admin_pin_dialog_action"))]})}},262891:(e,t,n)=>{"use strict";n.d(t,{App:()=>U});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(536559),s=n(410531),c=n(923947),u=n(108519),d=n(187252),p=n(48755),A=n(165999),_=n(139230),m=n(656504),g=n(599648),f=n(94303),v=n(431469),E=n(474803),h=n(963532),C=n(325496),S=n(927229),y=n(353506),N=n(706885),T=n(485525),I=n(537817),P=n(410038),b=n(978335),w=n(358898),L=n(152532),M=n(350594),O=n(989819),k=n(379981),D=n(450273),R=n(858101),B=n(174635),G=n(241715),x=n(637880),H=n(464380),U=function(e){var t,n,U,V,F=e.SDK,W=e.bridge,z=e.onBeforeCallStart,j=e.onAfterCallFinish,Q=e.tabIsMaster,Y=e.navigateToConvo,K=e.callSounds,J=e.navigateToProfile,q=e.onHandCountChanged,Z=e.onSuccessFeedback,X=e.okPublicKey,$=e.config,ee=e.streamUrlExtractor,te=$.allowAddMembers,ne=$.incomingCall,ae=$.showFeedbackScreen,re=(0,i.useSelector)((function(e){return e})),ie=(0,i.useDispatch)(),oe=r.useCallback((function(){ie({type:o.CHANGE_MODE,mode:o.Mode.READY})}),[]),le=(0,a.__read)(r.useState(null),2),se=le[0],ce=le[1],ue=r.useCallback((function(e){ie({type:o.ERROR,text:e})}),[]),de=r.useCallback((function(){return ie({type:o.CHANGE_MODE,mode:o.Mode.READY})}),[]);return r.useEffect((function(){return re.mode===o.Mode.CALL?((0,T.wakeLockRequest)(),function(){(0,T.wakeLockRelease)()}):function(){}}),[re.mode]),(0,v.useFullScreen)(re.uiMode===o.UIMode.FULLSCREEN&&re.mode===o.Mode.CALL,(function(){var e;window.FastChat&&(ce(window.FastChat.getFullScreenState()),window.FastChat.toggleFullScreenState(!0)),(null===(e=null===window||void 0===window?void 0:window.reforgedME)||void 0===e?void 0:e.setCollapsed)&&window.reforgedME.setCollapsed(!0,"call")}),(function(){var e;re.uiMode===o.UIMode.FULLSCREEN&&ie({type:o.CHANGE_UI_MODE,mode:o.UIMode.DEFAULT}),window.FastChat&&(window.FastChat.toggleFullScreenState(se),ce(null)),(null===(e=null===window||void 0===window?void 0:window.reforgedME)||void 0===e?void 0:e.setCollapsed)&&window.reforgedME.setCollapsed(!1,"call")}),[re.uiMode,re.mode]),(0,E.usePriorities)(F,re),r.createElement(A.CallsErrorBoundary,{SDK:F,mode:re.mode,onReset:de},r.createElement(r.Fragment,null,(ne||Q())&&r.createElement(u.AudioContainer,{onBeforeCallStart:z,onAfterCallFinish:j,callSounds:K}),re.localStatus!==H.ParticipantStatus.WAITING_HALL&&re.mode===o.Mode.CALL&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(s.CallContainer,{SDK:F,navigateToConvo:Y,navigateToProfile:J,onHandCountChanged:q}),re.localStatus===H.ParticipantStatus.WAITING_HALL&&re.mode===o.Mode.CALL&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(x.WaitingHallContainer,{SDK:F,navigateToConvo:Y,navigateToProfile:J}),re.mode===o.Mode.INCOMING&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(l.IncomingCallContainer,{SDK:F,bridge:W}),re.localStatus!==H.ParticipantStatus.WAITING_HALL&&re.mode!==o.Mode.READY&&re.uiMode===o.UIMode.COLLAPSED&&r.createElement(c.CollapsedCallContainer,{SDK:F}),re.localStatus===H.ParticipantStatus.WAITING_HALL&&re.mode!==o.Mode.READY&&re.uiMode===o.UIMode.COLLAPSED&&r.createElement(G.CollapsedWaitingHallContainer,{SDK:F}),re.mode===o.Mode.START&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(R.StartCallContainer,null),ae&&re.mode===o.Mode.FEEDBACK&&r.createElement(k.FeedbackContainer,{onSuccessFeedback:Z}),re.mode===o.Mode.CALL_BY&&r.createElement(B.CallByNameContainer,{bridge:W}),re.mode===o.Mode.JOIN&&r.createElement(m.JoinScreenContainer,(0,a.__assign)({},re.join,{bridge:W,withPopup:!0,onClose:oe,onError:ue,okPublicKey:X})),re.errorShown&&r.createElement(g.ErrorContainer,{title:null===(t=re.error)||void 0===t?void 0:t.title,text:null===(n=re.error)||void 0===n?void 0:n.text,handleType:null===(U=re.error)||void 0===U?void 0:U.handleType,callId:null===(V=re.error)||void 0===V?void 0:V.callId,bridge:W,onCloseFatal:oe}),re.cautionShown&&r.createElement(h.CautionContainer,{isIncoming:re.isIncoming}),re.groupCallSetup&&r.createElement(d.GroupCallSetupContainer,{bridge:W,SDK:F}),re.isManagementOpen&&r.createElement(_.CallManagementContainer,{bridge:W,SDK:F,navigateToProfile:J,navigateToConvo:Y,allowAddMembers:te}),re.popup===o.POPUP_SETTINGS&&r.createElement(p.SettingsContainer,{SDK:F}),re.popup===o.POPUP_TRANSLATION&&r.createElement(I.TranslationContainer,null),re.popup===o.POPUP_TRANSLATION_START_COUNTDOWN&&r.createElement(M.TranslationStartCountdownContainer,null),re.popup===o.POPUP_TRANSLATION_STOP&&r.createElement(P.TranslationStopContainer,null),re.popup===o.POPUP_TRANSLATION_SHARE&&r.createElement(b.TranslationShareContainer,{link:re.translation.link,linkExtractor:ee}),re.popup===o.POPUP_EXIT&&r.createElement(f.CallExitContainer,{SDK:F}),re.popup===o.POPUP_TRANSFER_ADMIN_RIGHTS&&r.createElement(L.TransferAdminRightsContainer,{SDK:F}),re.popup===o.POPUP_UNMUTE_REQUEST&&r.createElement(S.UnmuteRequestContainer,{SDK:F}),re.popup===o.POPUP_ADMIN_PIN_UNMUTE_REQUEST&&r.createElement(w.AdminPinUnmuteRequestContainer,{SDK:F}),re.participantKick&&r.createElement(O.KickParticipantContainer,{SDK:F}),re.membersUnban&&r.createElement(D.UnbanParticipantContainer,{SDK:F}),re.participantsManagement&&r.createElement(C.MuteParticipantContainer,{SDK:F}),re.adminAssignment&&r.createElement(y.AssignAdminContainer,{SDK:F}),re.isLoaderVisible&&r.createElement(N.default,null)))}},353506:(e,t,n)=>{"use strict";n.d(t,{AssignAdminContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(881150),l=n(121255),s=n(697483),c=n(662208),u=n(329538),d=n(908651),p=n(614914),A=n(745284),_=n(464380),m=function(e){var t=e.SDK,n=(0,i.useSelector)((function(e){return e.adminAssignment?e.participants[e.adminAssignment.participant.peerId]:void 0})),m=(0,i.useSelector)((function(e){return e})),g=(0,i.useDispatch)(),f=(0,a.__read)((0,r.useState)(!0),2),v=f[0],E=f[1],h=(0,a.__read)((0,r.useState)(""),2),C=h[0],S=h[1],y=r.useContext(c.LangContext).getLang;(0,r.useEffect)((function(){g({type:l.SHOW_LOADER,isLoaderVisible:!0}),new Promise((function(e,t){n&&n.peerId<0?(0,u.getGroupById)(-n.peerId).then((function(t){var n,a=t.groups;e(a&&a.length>0?null===(n=a[0])||void 0===n?void 0:n.name:"")})).catch((function(e){return t(e)})):(0,u.loadUsers)({user_ids:n&&String(n.peerId),name_case:"dat"}).then((function(t){var n=(0,a.__read)(t,1)[0];e((null==n?void 0:n.first_name)+" "+(null==n?void 0:n.last_name))})).catch((function(e){return t(e)}))})).then((function(e){S(e),E(!1),g({type:l.SHOW_LOADER,isLoaderVisible:!1})})).catch(console.log)}),[n]);var N=(0,r.useCallback)((function(){g({type:l.TOGGLE_ADMIN_ASSIGNMENT})}),[]),T=(0,r.useCallback)((function(){var e=(0,s.getParticipantExternalId)(n);e?(t.grantRoles(e,[_.UserRole.ADMIN],!1).then((function(){n&&g({type:l.CHANGE_PARTICIPANT_ROLES,participantId:n.peerId,data:n.roles?(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n.roles)),[_.UserRole.ADMIN]):[_.UserRole.ADMIN]})})).catch(console.log),p.callStats.logEvent({call_event_type:l.CallActionEventType.ASSIGN_ADMIN,session_id:m.callData.callId,peer_id:m.peer,is_group_call:(0,A.isGroupCallByPeer)(m.peer)}),N()):N()}),[]);return v?null:r.createElement(d.AssignAdminModal,{onClose:N,title:y("calls_dialog_assign_admin_role_title"),description:y("calls_dialog_assign_admin_role_description").replace("{name}",C),actionButtons:[r.createElement(o.default,{onClick:N,appearance:"secondary",key:"cancel"},y("calls_dialog_assign_admin_role_action_later")),r.createElement(o.default,{onClick:T,key:"primary"},y("calls_dialog_assign_admin_role_action_primary"))]})}},108519:(e,t,n)=>{"use strict";n.d(t,{AudioContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(483379),s=n(745284),c=n(464380),u="incoming",d="outgoing",p="connecting",A="connected",_="end";function m(e){var t,n=e.onBeforeCallStart,m=e.onAfterCallFinish,g=e.callSounds,f=(0,i.useSelector)((function(e){return e})),v=(0,r.useRef)(),E=((t={}).incoming=(0,r.useRef)(null),t.outgoing=(0,r.useRef)(null),t.connecting=(0,r.useRef)(null),t.connected=(0,r.useRef)(null),t.end=(0,r.useRef)(null),t),h={controls:!1,preload:"auto"},C=(0,r.useCallback)((function(e){var t=E[e].current;t&&t.paused&&t.play().catch((function(){}))}),[]),S=(0,r.useCallback)((function(e){var t=E[e].current;t&&!t.paused&&(t.pause(),t.currentTime=0)}),[]),y=(0,r.useCallback)((function(){Object.keys(E).forEach(S)}),[]),N=(0,r.useCallback)((function(e){var t=E[e].current;if(t){var n=t.volume;t.volume=0,t.play().catch((function(){})),t.pause(),t.currentTime=0,t.volume=n}}),[]),T=(0,r.useCallback)((function(){n&&n()}),[n]),I=(0,r.useCallback)((function(){m&&m()}),[m]);return(0,r.useEffect)((function(){return l.browser.safari&&document.body.addEventListener("mousedown",(function e(){Object.keys(E).forEach(N),document.body.removeEventListener("mousedown",e)})),function(){y(),I()}}),[]),(0,r.useEffect)((function(){var e,t,n=v.current||f,r=f;n.mode!==r.mode&&(n.mode!==o.Mode.READY||r.mode!==o.Mode.INCOMING&&r.mode!==o.Mode.CALL||T(),n.mode===o.Mode.INCOMING&&S(u),r.mode===o.Mode.INCOMING&&C(u),r.mode!==o.Mode.READY||n.mode!==o.Mode.INCOMING&&n.mode!==o.Mode.CALL||(y(),C(_),I()));var i=r.me,l=n.participants,m=r.participants,g=null===(e=l[i])||void 0===e?void 0:e.status,E=null===(t=m[i])||void 0===t?void 0:t.status;g!==E&&(g===c.ParticipantStatus.CONNECTING&&S(p),E===c.ParticipantStatus.CONNECTING&&C(p));var h=Object.keys(m).some((function(e){return l[e]&&l[e].status===c.ParticipantStatus.CONNECTED})),N=Object.keys(m).some((function(e){var t=l[e],n=m[e];return t&&t.status!==n.status&&n.status===c.ParticipantStatus.CONNECTED}));!h&&N&&C(A),r.mode===o.Mode.CALL&&(!function(e,t,n,r){var i,o,l=!1;try{for(var s=(0,a.__values)(Object.values(e)),u=s.next();!u.done;u=s.next()){var d=u.value;if(d.peerId!==t){if(d.status===c.ParticipantStatus.CONNECTED)return!1;d.status===c.ParticipantStatus.WAITING&&(!r||n.has(d.peerId))&&(l=!0)}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return l}(m,i,r.participantsAddedByMe,(0,s.isGroupCallByPeer)(f.peer))?S(d):C(d)),v.current=f}),[f]),r.createElement(r.Fragment,null,r.createElement("audio",(0,a.__assign)({src:g.incoming,ref:E.incoming,loop:!0},h)),r.createElement("audio",(0,a.__assign)({src:g.outgoing,ref:E.outgoing,loop:!0},h)),r.createElement("audio",(0,a.__assign)({src:g.connected,ref:E.connected,loop:!1},h)),r.createElement("audio",(0,a.__assign)({src:g.connecting,ref:E.connecting,loop:!0},h)),r.createElement("audio",(0,a.__assign)({src:g.end,ref:E.end,loop:!1},h)))}},174635:(e,t,n)=>{"use strict";n.d(t,{CallByNameContainer:()=>_});var a=n(570655),r=n(667294),i=n(790281),o=n(662208),l=n(50533),s=n(121255),c=n(329538),u=n(881150),d=n(706885),p=n(431469),A=n(788822),_=function(e){var t=e.bridge,n=(0,l.useSelector)((function(e){return e})),_=(0,l.useDispatch)(),m=(0,a.__read)((0,r.useState)([]),2),g=m[0],f=m[1],v=(0,a.__read)((0,r.useState)(n.me),2),E=v[0],h=v[1],C=r.useContext(o.LangContext).getLang,S=(0,a.__read)((0,r.useState)(""),2),y=S[0],N=S[1],T=(0,r.useCallback)((function(e){return e.name}),[]),I=(0,r.useCallback)((function(e){return e.id}),[]),P=(0,p.useIndexer)([],T,I),b=n.participants[n.me],w=y?P.search(y):g,L=(0,r.useCallback)((function(e){N(e.target.value)}),[]),M=function(e,t){void 0===t&&(t=!1);var n="id"in e?e.id:e.peerId,a="screen_name"in e?"/"+e.screen_name:e.link,r="photo_100"in e?e.photo_100:e.photo;return{id:t?n:-n,name:(0,A.escape)(e.name),link:a,photo:r}};(0,r.useEffect)((function(){var e=[M(b,!0)];(0,c.getGroupsForCall)().then((function(t){t.count>0&&t.items.forEach((function(t){e.push(M(t))}))})).finally((function(){f(e),e.forEach((function(e){return P.add(e)}))}))}),[]);var O=(0,r.useCallback)((function(e){if(n.callByName){var a=n.callByName,r=a.peerId,i=a.entryPoint,o=a.joinLink;o?t.joinCallByLink(o,void 0,e,i,E>0?0:E):r?t.call(r,e,void 0,i,E>0?0:E):t.startCall(e,i,!0,E>0?0:E)}}),[E]);if(!g.length)return r.createElement(d.default,null);var k=[r.createElement(u.default,{onClick:function(){return O(!1)},key:"callByNameByAudio",appearance:"secondary"},C("calls_call_by_name_audio_button")),r.createElement(u.default,{onClick:function(){return O(!0)},key:"callByNameByVideo"},C("calls_call_by_name_video_button"))];return r.createElement(i.CallByNameModal,{items:w,actionButtons:k,selectedId:E,onListItemClick:function(e){h(e)},onClose:function(){_({type:s.CHANGE_MODE,mode:s.Mode.READY})},participantMe:b,onSearchChange:L})}},410531:(e,t,n)=>{"use strict";n.d(t,{CallContainer:()=>R});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(242422),s=n(492512),c=n(362542),u=n(548237),d=n(269481),p=n(75794),A=n(884143),_=n(279060),m=n(169610),g=n(690015),f=n(745284),v=n(697483),E=n(614914),h=n(561235),C=n(662208),S=n(498110),y=n(774351),N=n(464380),T=n(139230),I=n(613335),P=n(674543),b=n(659397),w=n(768606),L=n(290514),M=n(147853),O=n(259684),k=n(662727),D=n(766610);function R(e){var t,n,I,R,G,x=e.SDK,H=e.navigateToConvo,U=e.navigateToProfile,V=e.onHandCountChanged,F=(0,i.useSelector)((function(e){return e})),W=(0,i.useDispatch)(),z=(0,r.useContext)(C.LangContext).getLang,j=(0,r.useContext)(S.ConfigContext),Q=j.isModalView,Y=j.debugLog,K=j.enableScreenTrack,J=j.enableProducerScreenTrack,q=j.allowPushToTalk,Z=F.peer,X=(0,r.useMemo)((function(){var e,t,n,a;return(0,f.isGroupCallByPeer)(Z)||(null===(t=null===(e=F.participants[F.me])||void 0===e?void 0:e.mediaSettings)||void 0===t?void 0:t.isScreenSharingEnabled)||(null===(a=null===(n=F.participants[Z])||void 0===n?void 0:n.mediaSettings)||void 0===a?void 0:a.isScreenSharingEnabled)}),[F.peer,F.participants]),$=X?F.callData.conversation:F.participants[Z],ee=F.participants[F.me],te=ee.mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},ne=ee.permissions,ae=(0,r.useMemo)((function(){return(0,v.getActiveParticipants)(F.participants,F.me,F.groupId,F.meGroup,F.adminPinnedParticipant)}),[F.participants,F.me,F.groupId,F.meGroup,F.adminPinnedParticipant,F.screenSharingPinnedParticipant,F.pinnedParticipant,F.speakers]),re=ae.length>1,ie=re||(0,v.isParticipantWithVideo)(ee),oe=(0,v.getNonAnonymousConnectParticipantsCount)(F),le=X&&((0,v.isAdmin)(ee)||(0,v.isCreator)(ee))&&oe>1&&1===(0,v.getConnectedAdminsCount)(F),se=X||ae.length>2,ce=se&&ie&&!F.isOratorMode,ue=se&&ie&&F.isOratorMode,de=null!==F.adminPinnedParticipant,pe=!de&&null!==F.pinnedParticipant,Ae=!pe&&null!==F.screenSharingPinnedParticipant,_e=F.uiMode===o.UIMode.FULLSCREEN,me=(0,r.useMemo)((function(){return x.browser.isScreenCapturingSupported()}),[]),ge=(null===(t=F.callData)||void 0===t?void 0:t.canFinishCall)||X&&0===Z&&(0,v.participantIsAdmin)(ee),fe=!!F.translation.deferredId&&!F.translation.isOn,ve=(0,a.__read)((0,r.useState)(!1),2),Ee=ve[0],he=ve[1],Ce=(0,a.__read)((0,r.useState)(!1),2),Se=Ce[0],ye=Ce[1],Ne=(0,a.__read)((0,r.useState)(0),2),Te=Ne[0],Ie=Ne[1],Pe=function(e){return W({type:o.CHANGE_UI_MODE,mode:e})},be=function(){(0,m.checkPermissions)(x,[N.MediaOption.AUDIO,N.MediaOption.VIDEO]).then((function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_SETTINGS})}))},we=function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION})},Le=(0,r.useCallback)((function(){Q&&(F.uiMode===o.UIMode.FULLSCREEN?((0,y.pause)(.3,null).then((function(){Pe(o.UIMode.COLLAPSED)})),Pe(o.UIMode.DEFAULT)):Pe(o.UIMode.COLLAPSED))}),[F.uiMode]),Me=(0,r.useCallback)((function(){W({type:o.TOGGLE_ORATOR_MODE,isOratorMode:!F.isOratorMode})}),[F.isOratorMode]),Oe=(0,r.useCallback)((function(){W({type:o.TOGGLE_PARTICIPANTS_ASIDE,isShownParticipantsAside:!F.isShownParticipantsAside})}),[F.isShownParticipantsAside]),ke=(0,r.useCallback)((function(e,t){var n=F.pinnedParticipant===t?null:t;F.screenSharingPinnedParticipant===t&&(n=null),F.screenSharingPinnedParticipant&&W({type:o.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:null}),W({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:n})}),[F.pinnedParticipant,F.screenSharingPinnedParticipant]),De=(0,r.useCallback)((function(e,t){F.isOratorMode||W({type:o.TOGGLE_ORATOR_MODE,isOratorMode:!0}),F.pinnedParticipant!==t&&W({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:t})}),[F.isOratorMode,F.pinnedParticipant]),Re=(0,r.useCallback)((function(){W({type:o.MANAGEMENT,isOpen:!0})}),[]),Be=(0,r.useCallback)((function(){W({type:o.MANAGEMENT,isOpen:!0,managementView:T.ManagementViews.CALL_LINK})}),[]),Ge=(0,r.useCallback)((function(){if(!Se){var e=!te.isVideoEnabled||te.isScreenSharingEnabled&&!K;(e?(0,m.checkPermissions)(x,[N.MediaOption.VIDEO]):Promise.resolve()).then((function(){ye(!0),K||te.isScreenSharingEnabled&&x.captureScreen(!1),x.toggleLocalVideo(e).finally((function(){ye(!1)}))})),E.callStats.logEvent({call_event_type:e?o.CallActionEventType.VIDEO_ENABLED:o.CallActionEventType.VIDEO_DISABLED,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,f.isGroupCallByPeer)(F.peer),reason:e?void 0:"manual"})}}),[te,Se]),xe=(0,r.useCallback)((function(){x.captureScreen(!te.isScreenSharingEnabled).catch((function(){W({type:o.ERROR,text:z("calls_error_disabled_screen_sharing")})})),E.callStats.logEvent({call_event_type:te.isScreenSharingEnabled?o.CallActionEventType.SCREEN_SHARING_STOPPED:o.CallActionEventType.SCREEN_SHARING_STARTED,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,f.isGroupCallByPeer)(F.peer)})}),[te.isScreenSharingEnabled,F.screenSharers,F.callData.callId,F.peer]),He=(0,r.useCallback)((function(){Le(),H(F.peer)}),[F.peer,F.uiMode]),Ue=(0,r.useCallback)((function(){if(!Ee){var e=!te.isAudioEnabled;(e?(0,m.checkPermissions)(x,[N.MediaOption.AUDIO]):Promise.resolve()).then((function(){var t;he(!0),(null===(t=F.notification)||void 0===t?void 0:t.type)===o.NotificationType.SPEAKING_ON_MUTE&&W({type:o.CALL_NOTIFICATION,notification:null}),x.toggleLocalAudio(e).finally((function(){he(!1)}))}))}}),[te,Ee]),Ve=(0,r.useCallback)((function(){var e,t,n=!(null===(e=ee.statusData)||void 0===e?void 0:e.hand);x.changeParticipantState({hand:n?o.SdkHandType.RAISED:o.SdkHandType.LOWERED}),W({type:o.CHANGE_PARTICIPANT_STATE,participantId:ee.peerId,data:(0,a.__assign)((0,a.__assign)({},ee.statusData),{hand:!(null===(t=ee.statusData)||void 0===t?void 0:t.hand)})}),E.callStats.logEvent({call_event_type:n?o.CallActionEventType.HAND_RAISED:o.CallActionEventType.HAND_LOWERED,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,f.isGroupCallByPeer)(F.peer)})}),[null===(n=ee.statusData)||void 0===n?void 0:n.hand]),Fe=(0,r.useCallback)((function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_EXIT})}),[]),We=(0,r.useCallback)((function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSFER_ADMIN_RIGHTS})}),[]),ze=(0,r.useCallback)((function(){x.hangup(),E.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,f.isGroupCallByPeer)(F.peer),reason:"none",group_call_users_count:ae.length})}),[F.callData.callId,F.peer,ae]),je=(0,r.useCallback)((function(){W({type:o.CHANGE_UI_MODE,mode:_e?o.UIMode.DEFAULT:o.UIMode.FULLSCREEN}),W({type:o.SET_TOOLTIP,tooltips:null})}),[F.uiMode]),Qe=(0,r.useCallback)((function(e,t){var n;W({type:o.SET_TOOLTIP,tooltips:(n={},n[e]=t,n)})}),[]),Ye=(0,r.useCallback)((function(){W({type:o.SET_TOOLTIP,tooltips:null})}),[]);(0,r.useEffect)((function(){fe&&Qe("streaming",!0)}),[fe]);(0,r.useEffect)((function(){F.isOratorMode||function(e){var t;console.log("onScrollGrid");for(var n=(null===(t=document.querySelectorAll('[data-calls-id="grid-item"]')[0])||void 0===t?void 0:t.offsetWidth)||1/0,a=6*Math.floor(e/n),r=0;r<ae.length;r++){var i=r>=a&&r<a+30;ae[r].visible!==i&&(0,w.throttleAccumulateDispatchParticipant)(W,ae[r].peerId,{visible:i})}}(F.gridScrollPosition)}),[F.isOratorMode,F.gridScrollPosition,ae]),(0,r.useEffect)((function(){F.isOratorMode&&function(e){var t;console.log("onScrollOrator");for(var n=document.querySelectorAll('[data-calls-id="participant"]')[0],a=n?n.offsetWidth+8:1/0,r=(null===(t=document.querySelectorAll('[data-calls-id="content"]')[0])||void 0===t?void 0:t.offsetHeight)||0,i=Math.floor(e/a)-1,o=Math.min(F.config.videoSlotsCount,r/a+3),l=0;l<ae.length;l++){var s=l>=i&&l<i+o;ae[l].visible!==s&&(0,w.throttleAccumulateDispatchParticipant)(W,ae[l].peerId,{visible:s})}}(F.oratorScrollPosition)}),[F.isOratorMode,F.oratorScrollPosition,ae]);var Ke=(0,r.useCallback)((0,b.debounce)((function(e){W({type:o.SET_GRID_SCROLL_POSITION,data:e})}),200),[F]),Je=(0,r.useCallback)((0,b.debounce)((function(e){W({type:o.SET_ORATOR_SCROLL_POSITION,data:e})}),200),[F]),qe=(0,r.useMemo)((function(){var e,t=[{text:z("calls_call_menu_settings"),key:"settings",onClick:be,disabled:!1}];F.config.streaming&&!(0,v.isParticipantAnonym)(F.me)&&t.push({text:z("calls_call_menu_translation"),key:"translation",onClick:we,disabled:!!(null===(e=F.translation)||void 0===e?void 0:e.isOn)&&(0,P.canStopTranslation)(F)}),(0,v.canMuteParticipants)(ee)&&X&&t.push({text:z("calls_call_menu_mute_audio_video_all"),key:"muteAll",onClick:function(){W({type:o.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:o.ParticipantsManagementMode.ALL}})}}),(0,v.canMuteParticipants)(ee)&&X&&re&&t.push({text:z("calls_call_menu_enable_media_request"),key:"unmuteRequest",onClick:function(){x.unmuteRequest(void 0,[N.MediaOption.AUDIO,N.MediaOption.VIDEO,N.MediaOption.SCREEN_SHARING]).catch(console.log),E.callStats.logEvent({call_event_type:o.CallActionEventType.ASK_ALL_TO_UNMUTE,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,f.isGroupCallByPeer)(F.peer)})}});return Y&&t.push({text:z("calls_call_menu_debug"),key:"debugLog",onClick:function(){window.__VKCallsSDKLogs__()},disabled:!1}),t}),[F.config.streaming,F.me,null===(I=F.translation)||void 0===I?void 0:I.isOn,F.participants[F.me],F.conversationOptions]);(0,r.useEffect)((function(){return function(){W({type:o.SET_TOOLTIP,tooltips:null})}}),[]);var Ze=(0,r.useCallback)((function(){de&&(0,v.canPinParticipants)(ee)?(x.pinParticipant(F.adminPinnedParticipant,!0).then((function(){W({type:o.SET_ADMIN_PINNED_PARTICIPANT,data:null})})).catch(console.log),E.callStats.logEvent({call_event_type:o.CallActionEventType.ADMIN_UNPIN,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,f.isGroupCallByPeer)(F.peer)})):(W({type:o.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:null}),W({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:null}))}),[F.adminPinnedParticipant,F.participants[F.me].roles,F.peer,F.callData.callId]),Xe=(0,r.useCallback)((function(e){ne.audio>0&&(0,M.onPushToTalkHandler)(e,te.isAudioEnabled,W,F)}),[ne.audio,te.isAudioEnabled,F.speakers,F.notification]);(0,r.useEffect)((function(){q&&ne.audio>0&&(0,M.pushToTalkToggleAudio)(F.pushToTalkEnabled,te,!1)}),[]),(0,r.useEffect)((function(){return q&&!(0,O.isCollapsedLayout)(F)&&F.pushToTalkEnabled?((0,M.pushToTalkActivate)(Xe),function(){(0,M.pushToTalkDeactivate)(Xe)}):function(){}}),[F.uiMode,F.pushToTalkEnabled,Xe]);var $e=(0,r.useMemo)((function(){var e;return r.createElement(g.CallNotificationContainer,{dispatch:W,notification:F.notification,participant:F.participants[null===(e=F.notification)||void 0===e?void 0:e.data]})}),[F.notification,F.participants[null===(R=F.notification)||void 0===R?void 0:R.data]]),et=(0,r.useMemo)((function(){return r.createElement(L.NotificationWithButtonContainer,null)}),[F.waitingHall]);(0,r.useEffect)((function(){if(!F.callData.localTimeStamp&&!(0,f.isGroupCallByPeer)(F.peer)&&!(0,k.getHangupStatus)(F,z)){var e=F.participants[F.peer];e&&e.status===N.ParticipantStatus.CONNECTED&&W({type:o.LOCAL_TIME_START,data:Date.now()})}}),[F]);var tt=(0,r.useMemo)((function(){return(0,v.getActiveParticipantsCount)(F)}),[F.participants]);return(0,r.useEffect)((function(){X&&Ie(tt)}),[tt]),r.createElement(d.CallModal,{onClose:le?We:ze,isCautionBoxShown:!le,onBackdropClick:Le},r.createElement(s.Call,{info:r.createElement(h.CallHeaderContainer,{onHandCountChanged:V}),callMenuActions:qe,isVideoAllowed:te.isVideoEnabled||ne.video>0,isAudioAllowed:te.isAudioEnabled||ne.audio>0,isVideoEnabled:K?te.isVideoEnabled:te.isVideoEnabled&&!te.isScreenSharingEnabled,isAudioEnabled:te.isAudioEnabled,isScreenSharingEnabled:te.isScreenSharingEnabled,isOratorMode:F.isOratorMode,isFullScreen:_e,onToggleVideo:Ge,onToggleAudio:Ue,onToggleScreenShare:xe,onLeaveCall:le?We:ge?Fe:ze,onCollapseCall:Q?Le:null,onToggleOratorMode:Me,onFullScreenToggle:je,onTooltipChange:Qe,onHidePanel:Ye,onChat:He,onHandClick:Ve,isParticipantControlActive:F.isManagementOpen,isLayoutSwitchShown:X&&re,isHandRaised:null===(G=ee.statusData)||void 0===G?void 0:G.hand,isHandControlShown:X,isChatControlShown:!!Z&&!F.groupId,isScreenShareControlShown:ne.screenSharing>0&&me,isStreamingControlShown:fe,onDeferredStreamStart:function(){if(F.translation.deferredId){var e={isOn:!1,startStreamParams:{upcomingStreamParams:{ovId:F.translation.deferredId}}};W({type:o.SET_TRANSLATION,data:e}),W({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_START_COUNTDOWN})}},onParticipantsClick:Re,chatUnreadCount:F.chatUnreadCount,notification:$e,tooltips:F.tooltips,amISpeaking:!!F.speakers[F.me],onChainClick:Be,waitingHallNotification:et,participantCount:Te},r.createElement(r.Fragment,null,!se&&r.createElement(l.OneToOne,(0,a.__assign)({},function(e,t,n,a){var r,i=e[t]||{},o=e[n]||{},l=i.mediaSettings,s=o&&o.mediaSettings?o.mediaSettings:{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},c=(0,v.isParticipantWithVideo)(i),u=(0,v.getStream)(i),d=(0,v.isParticipantWithVideo)(o),p=(0,v.getStream)(o);return{hasAudio:!!(null==l?void 0:l.isAudioEnabled),hasVideo:c,isSharingScreen:!!(null==l?void 0:l.isScreenSharingEnabled),stream:u,id:t,name:a("calls_own_label"),letter:null===(r=i.name)||void 0===r?void 0:r.slice(0,1),wasConnected:!!i.wasConnected,networkStatus:i.networkStatus,opponentHasAudio:!!(null==s?void 0:s.isAudioEnabled),opponentHasVideo:d,opponentIsSharingScreen:!!(null==s?void 0:s.isScreenSharingEnabled),opponentStream:p,opponentPhoto:o.photo,opponentId:n,opponentName:o.name||n.toString(),opponentWasConnected:!!o.wasConnected,opponentNetworkStatus:o.networkStatus}}(F.participants,F.me,F.peer,z))),ce&&r.createElement(c.CallGridNew,{limit:F.participantLimit,onScroll:Ke,scrollPosition:F.gridScrollPosition},ae.map((function(e,t,n){var a,i,o,l=e.mediaSettings||{},s=l.isAudioEnabled,c=l.isScreenSharingEnabled,u=e.peerId===F.me?z("calls_own_label"):e.shortName?e.shortName:e.name,d=(0,v.isParticipantWithVideo)(e),A=(0,v.getStream)(e),_=F.localStatus===N.ParticipantStatus.CONNECTED?e.status:N.ParticipantStatus.CONNECTED,m=(0,v.getParticipantActions)(F,x,W,e,!0,z,H,U,!1);return r.createElement(p.Participant,{id:e.peerId,key:e.peerId,isVisible:e.visible,isInfoShown:!0,isMe:e.peerId===F.me,isHandRaised:null===(a=e.statusData)||void 0===a?void 0:a.hand,hasVideo:!!d,hasAudio:!!s,isSharingScreen:!!c,isSpeaking:s&&F.speakers[e.peerId]&&e.visible,stream:A,photo:e.photo,photoSize:n.length<=8||_e?"s":"xs",name:u,letter:null!==(o=null===(i=null==e?void 0:e.name)||void 0===i?void 0:i[0])&&void 0!==o?o:"",status:_,allowContain:!1,wasConnected:e.wasConnected,networkStatus:e.networkStatus,onDblClickParticipant:De,actions:m})}))),ue&&r.createElement(u.CallOrator,{orator:B(F,z,xe),oratorTitle:r.createElement(D.OratorTitle,{orator:(0,v.getOrator)(F),me:F.me,isPinned:pe,isPinnedByAdmin:de,isPinnedByShareScreen:Ae,isUnpinAllowed:(0,v.canPinParticipants)(ee)||!de,onUnpin:Ze,tooltips:F.tooltips,onTooltipChange:Qe}),onToggleParticipantsAside:Oe,isShownParticipantsAside:F.isShownParticipantsAside,onScroll:Je,scrollPosition:F.oratorScrollPosition},ae.map((function(e){var t,n,a,i=e.mediaSettings||{},o=i.isVideoEnabled,l=i.isAudioEnabled,s=i.isScreenSharingEnabled,c=e.peerId===F.me,u=c?z("calls_own_label"):e.shortName?e.shortName:e.name,d=(0,v.getStream)(e,!0),A=!!s;(K||J)&&(o?A=!1:d=(0,v.getStream)(e));var _=(0,v.isParticipantWithVideo)(e),m=F.localStatus===N.ParticipantStatus.CONNECTED?e.status:N.ParticipantStatus.CONNECTED,g=(0,v.getParticipantActions)(F,x,W,e,!0,z,H,U,!1);return r.createElement(p.Participant,{id:e.peerId,key:e.peerId,isVisible:e.visible,isInfoShown:!0,isMe:c,isPinned:Number(e.peerId)===Number(F.pinnedParticipant)||Number(e.peerId)===Number(F.screenSharingPinnedParticipant),isPinnedByAdmin:e.peerId===Number(F.adminPinnedParticipant),isHandRaised:null===(t=e.statusData)||void 0===t?void 0:t.hand,hasVideo:!!_,hasAudio:!!l,isSharingScreen:A,isSpeaking:l&&F.speakers[e.peerId]&&e.visible,stream:d,photo:e.photo,photoSize:"xxs",name:u,letter:null!==(a=null===(n=null==e?void 0:e.name)||void 0===n?void 0:n[0])&&void 0!==a?a:"",status:m,allowContain:!1,wasConnected:e.wasConnected,networkStatus:e.networkStatus,onClickParticipant:ke,actions:g})}))),se&&!ie&&r.createElement(A.default,null,r.createElement(_.CallPhoto,{id:Z,photo:$&&$.photo||"",size:"l",waves:!0,alt:$&&$.tab||""})))))}function B(e,t,n){var a,i=null!==(a=e.participants[e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me])&&void 0!==a?a:{},o=i.mediaSettings||{},l=o.isAudioEnabled,s=o.isScreenSharingEnabled,c=i.peerId===e.me;c&&e.groupId&&e.meGroup&&(i=(0,I.mergeGroupToParticipant)(e.meGroup,i));var u=(0,v.isParticipantWithVideo)(i),d=(0,v.getStream)(i);return r.createElement(p.Participant,{id:i.peerId,key:i.peerId,isOrator:!0,isInfoShown:!0,isMe:c,hasVideo:!!u,hasAudio:!!l,isSharingScreen:!!s,stream:d,photo:i.photo,photoSize:"l",name:c?t("calls_own_label"):i.name,status:i.status,wasConnected:i.wasConnected,networkStatus:i.networkStatus,allowContain:!0,onStopScreenShare:n})}},94303:(e,t,n)=>{"use strict";n.d(t,{CallExitContainer:()=>A});var a=n(667294),r=n(50533),i=n(225652),o=n(881150),l=n(121255),s=n(444083),c=n(614914),u=n(745284),d=n(697483),p=n(662208),A=function(e){var t=e.SDK,n=(0,r.useSelector)((function(e){return e})),A=(0,r.useDispatch)(),_=a.useContext(p.LangContext).getLang,m=function(){return c.callStats.logEvent({call_event_type:l.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:n.callData.callId,peer_id:n.peer,is_group_call:(0,u.isGroupCallByPeer)(n.peer),reason:"none",group_call_users_count:(0,d.getActiveParticipantsCount)(n)})},g=(0,a.useCallback)((function(){A({type:l.TOGGLE_POPUP})}),[]);return a.createElement(i.CallExitModal,{onClose:g,actionButtons:[a.createElement(o.default,{onClick:function(){A({type:l.TOGGLE_POPUP}),m(),(0,s.onForceCallFinish)(t,n,A,_)},key:"forceCallFinish",appearance:"secondary"},_("calls_force_call_finish")),a.createElement(o.default,{onClick:function(){return A({type:l.TOGGLE_POPUP}),m(),t.hangup()},key:"leave"},_("calls_leave_call"))]})}},561235:(e,t,n)=>{"use strict";n.d(t,{CallHeaderContainer:()=>A});var a=n(570655),r=n(667294),i=n(50533),o=n(910472),l=n(745284),s=n(503592),c=n(697483),u=n(298811),d=n(662208),p=n(662727);function A(e){var t,n,A=e.onHandCountChanged,_=(0,i.useSelector)((function(e){return e})),m=(0,l.isGroupCallByPeer)(_.peer),g=(0,r.useContext)(d.LangContext),f=g.getLang,v=g.langNumeric,E=(0,a.__read)((0,r.useState)(null),2),h=E[0],C=E[1],S=(0,a.__read)((0,r.useState)(0),2),y=S[0],N=S[1],T=(0,a.__read)((0,r.useState)(null),2),I=T[0],P=T[1],b=(0,a.__read)((0,r.useState)(""),2),w=b[0],L=b[1];return r.useEffect((function(){var e=(0,l.isGroupCallByPeer)(_.peer)?_.callData.ts:_.callData.localTimeStamp;P((0,p.getCallTimer)(e));var t=setInterval((function(){return P((0,p.getCallTimer)(e))}),1e3);return function(){return clearInterval(t)}}),[_.peer,_.callData.localTimeStamp,_.callData.ts]),(0,r.useEffect)((function(){var e=(0,c.getRaisedHands)(_);e!==y&&(N(e),A&&A(e))}),[_.participants]),(0,r.useEffect)((function(){if(m){var e=_.speakersInHeader.reduce((function(e,t){return _.participants[t]&&(_.participants[t].shortName||_.participants[t].name)&&e.push(_.participants[t]),e}),[]);if(e.length>0){var t=f("calls_participants_speak",e.length).split(" ");C(r.createElement(r.Fragment,null,r.createElement("span",{className:"CallHeader__speak"},t[0]," "),(0,u.getParticipantsListLabel)(e,e.slice(0,2),(function(e){return e.shortName||e.name}),f,v,0,2)))}else C(null)}}),[_.participants,_.speakersInHeader]),(0,r.useEffect)((function(){var e="";_.translation.isOn&&(e=r.createElement(o.TranslationStatusContainer,null)),L(e)}),[_.translation.isOn]),r.createElement(s.CallHeader,{translation:w,speakers:m?h:null,hands:y,time:I,network:null!==(n=null===(t=_.participants[_.me])||void 0===t?void 0:t.networkStatus)&&void 0!==n?n:1,networkTooltipText:f("calls_status_bad_internet_connection")})}},139230:(e,t,n)=>{"use strict";n.d(t,{ManagementViews:()=>a,CallManagementContainer:()=>T});var a,r=n(570655),i=n(667294),o=n(50533),l=n(121255),s=n(186983),c=n(445586),u=n(177774),d=n(154463),p=n(881150),A=n(187252),_=n(820717),m=n(444083),g=n(389953),f=n(662208),v=n(697483),E=n(562192),h=n(58600),C=n(745284),S=n(498110),y=n(719481),N=n(564840);!function(e){e[e.MAIN=0]="MAIN",e[e.CALL_LINK=1]="CALL_LINK",e[e.ADD_PARTICIPANTS=2]="ADD_PARTICIPANTS",e[e.WAITING_HALL=3]="WAITING_HALL"}(a||(a={}));var T=function(e){var t,n,T=e.bridge,I=e.SDK,P=e.navigateToConvo,b=e.navigateToProfile,w=e.allowAddMembers,L=void 0!==w&&w,M=(0,o.useSelector)((function(e){return e})),O=(0,o.useDispatch)(),k=(0,i.useContext)(S.ConfigContext).allowWaitingHall,D=(0,r.__read)((0,i.useState)(M.callData.callUrlLink||""),2),R=D[0],B=D[1],G=M.managementView||a.MAIN,x=(0,r.__read)((0,i.useState)(G),2),H=x[0],U=x[1],V=(0,r.__read)((0,i.useState)(!1),2),F=V[0],W=V[1],z=(0,r.__read)((0,i.useState)(!1),2),j=z[0],Q=z[1],Y=(0,r.__read)((0,i.useState)(!1),2),K=Y[0],J=Y[1],q=(0,r.__read)((0,i.useState)(!1),2),Z=q[0],X=q[1],$=(0,r.__read)((0,i.useState)(!1),2),ee=$[0],te=$[1],ne=L||!!(null===(t=M.callData.conversation)||void 0===t?void 0:t.canAddMembers),ae=null===(n=M.callData)||void 0===n?void 0:n.canFinishCall,re=i.useContext(f.LangContext).getLang,ie=(0,C.isRequireAuthToJoin)(M),oe=(0,C.isWaitingHallEnabled)(M),le=(0,i.useCallback)((function(){O({type:l.MANAGEMENT,isOpen:!1})}),[]),se=(0,i.useCallback)((function(){U(a.MAIN)}),[]),ce=function(e){var t=M.callData.callId||"";return W(!0),(0,_.loadCallUrlLink)(O,t,e,(0,C.isAuthedByGroupId)(M)?M.groupId:0).then((function(e){B(e),W(!1)})).catch((function(e){console.error(e),W(!1),O({type:l.ERROR,text:re("calls_get_url_link_error_text")})}))},ue=(0,i.useCallback)((function(){U(a.CALL_LINK),R||ce(!1).catch((function(){U(a.MAIN)}))}),[M.callData.callId,R]),de=(0,i.useCallback)((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!0});var e=[(0,_.loadFriendsAction)(T,M,O)].concat((0,g.isChatPeer)(M.peer)?[(0,_.loadChatMembersAction)(M,O,M.peer,M.callData.conversation)]:[]).concat(T.authorizedGroupId?[(0,_.loadAllowedToCallGroupMembersAction)(T,M,O)]:[]);return Promise.all(e).then((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!1}),U(a.ADD_PARTICIPANTS)})).catch((function(e){console.error(e),O({type:l.SHOW_LOADER,isLoaderVisible:!1})}))}),[M.peer,M.callData,M.friends,M.groupMembers]),pe=(0,i.useCallback)((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!0});var e=[(0,y.loadAdditionalWaitingHall)(M,O)];return Promise.all(e).then((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!1}),U(a.WAITING_HALL)})).catch((function(e){console.error(e),O({type:l.SHOW_LOADER,isLoaderVisible:!1})}))}),[M.waitingHall]),Ae=(0,i.useCallback)((function(){O({type:l.TOGGLE_POPUP}),(0,m.onForceCallFinish)(I,M,O,re)}),[M.callData.callId,M.imHash]);(0,i.useEffect)((function(){G===a.CALL_LINK&&ue()}),[]),(0,i.useEffect)((function(){var e=M.participants[M.me],t=(0,v.participantIsAdmin)(e),n=t;J(t),X(n),te(k&&t)}),[M.participants[M.me]]);var _e=(0,i.useCallback)((function(e){(0,_.setAnonymousJoin)(e)}),[]),me=(0,i.useCallback)((function(e){(0,_.setWaitingHall)(e)}),[]),ge=(0,i.useCallback)((function(){return Q(!0)}),[]),fe=(0,i.useCallback)((function(){return Q(!1)}),[]),ve=(0,i.useCallback)((function(){ce(!0).catch((function(){U(a.MAIN)}))}),[M.callData.callId,R]);return i.createElement(i.Fragment,null,H===a.MAIN&&i.createElement(s.CallManagementModal,{title:re("calls_management_participants"),actionButtons:(ae?[i.createElement(p.default,{onClick:Ae,key:"forceCallFinish",appearance:"secondary"},re("calls_force_call_finish"))]:[]).concat([i.createElement(p.default,{onClick:I.hangup,key:"leave"},re("calls_leave_call"))]),onCloseModal:le},i.createElement(c.CallManagementMenu,{isLinkBlockShown:ne,linkBlockTitle:re("calls_menu_link"),onLinkBlockClick:ue,callUrlLink:R}),i.createElement(d.CallParticipantListContainer,{SDK:I,onAddClick:de,onShowMoreWaitingHall:pe,navigateToProfile:b,navigateToConvo:P})),H===a.CALL_LINK&&i.createElement(s.CallManagementModal,{title:re("calls_management_link"),hint:ie?re("calls_management_link_anonymous_disallowed_hint"):"",onCloseModal:le,isWithBackButton:G!==a.CALL_LINK,onBackClick:se,actionButtons:(Z?[i.createElement(p.default,{key:"invalidate-link",appearance:"tertiary",onClick:ve},re("calls_link_invalidate"))]:[]).concat([i.createElement(h.CopyText,{key:"copy-link",text:R},i.createElement(p.default,{className:"CallManagementModal__copyTextButton",disabled:F,onClick:ge},re("calls_link_copy")))])},i.createElement(u.CallLink,{link:R,isLinkLoading:F,isCopied:j,hideCopiedText:fe}),K&&i.createElement(E.CallLinkSettings,{onRequireAuthToJoinChanged:_e,requireAuthToJoin:ie,isWaitingHallBlockShown:ee,onWaitingHallEnabledChanged:me,isWaitingHallEnabled:oe})),H===a.ADD_PARTICIPANTS&&i.createElement(A.GroupCallSetupContainer,{bridge:T,SDK:I,isWithBackButton:!0,onBackClick:se}),H===a.WAITING_HALL&&i.createElement(N.WaitingHallListContainer,{isModal:!0,isWithBackButton:!0,onBackClick:se,navigateToProfile:b}))}},690015:(e,t,n)=>{"use strict";n.d(t,{CallNotificationContainer:()=>g});var a=n(570655),r=n(667294),i=n(121255),o=n(80125),l=n(662208),s=n(925082),c=n(112877),u=n(818114),d=n(911099),p=n(50533),A=n(745284),_=n(662727),m=n(697483),g=function(e){var t=e.dispatch,n=e.notification,g=e.participant,f=r.useContext(l.LangContext),v=f.getLang,E=f.langSex,h=(0,p.useSelector)((function(e){return e})),C=(0,r.useMemo)((function(){return function(e,t,n,a){void 0===a&&(a={name:"",sex:"0",shortName:""});if(!e)return null;switch(e.type){case i.NotificationType.SPEAKING_ON_MUTE:return t("calls_notification_mic_is_mute");case i.NotificationType.SCREEN_SHARING_STARTED:if(!a||!a.name)return r.createElement("span",null,t("calls_notification_screen_sharing_started"));var l=n(a.sex,"calls_notification_user_started_screen_sharing",t("calls_notification_user_started_screen_sharing",!0));return r.createElement("span",null,l.replace("{user}",a.name));case i.NotificationType.RAISED_HAND:if(!a||!a.name)return null;l=n(a.sex,"calls_notification_raised_hand",t("calls_notification_raised_hand",!0));return r.createElement("span",null,l.replace("{user}",a.name));case i.NotificationType.BAD_NETWORK_CONNECTION:return r.createElement("span",null,t("calls_notification_bad_network_connection"));case i.NotificationType.BAD_NETWORK_CONNECTION_DISABLE_CAMERA:return[r.createElement(o.DisabledVideoIconS,{key:"icon"}),r.createElement("span",{key:"text"},t("calls_notification_bad_network_connection_disable_camera"))];case i.NotificationType.ADMIN_MUTE:return r.createElement("span",{key:"text"},t("calls_notification_admin_mute"));case i.NotificationType.ADMIN_MUTE_PERMANENT:return r.createElement("span",{key:"text"},t("calls_notification_admin_permanent_mute"));case i.NotificationType.ADMIN_ROLE_GRANTED:return r.createElement("span",{key:"text"},t("calls_notification_admin_role_granted"));case i.NotificationType.USER_GRANTED_WITH_ADMIN_ROLE:var s=t("calls_notification_user_granted_with_admin_role").replace("{name}",a.shortName||a.name);return r.createElement("span",{key:"text"},s);case i.NotificationType.PINNED_BY_ADMIN:return r.createElement("span",{key:"text"},t("calls_notification_admin_pinned_self"));case i.NotificationType.USER_PINNED_BY_ADMIN:s=t("calls_notification_admin_pinned_user").replace("{name}",a.shortName||a.name);return r.createElement("span",{key:"text"},s);case i.NotificationType.PUSH_TO_TALK:s=t("calls_notification_push_to_talk_enabled");return[e.data?r.createElement(c.MicIconWithSpeakingIndicator,{key:"icon"}):r.createElement(u.MicIcon,{key:"icon"}),r.createElement("div",{key:"text",className:"CallNotification__pushToTalkText"},s)];default:return null}}(n,v,E,g)}),[n]),S=(0,r.useRef)(0);(0,r.useEffect)((function(){return S.current&&window.clearTimeout(S.current),n&&0!==n.timer&&(S.current=window.setTimeout((function(){t({type:i.CALL_NOTIFICATION,notification:null}),S.current=0}),n.timer||i.defaultNotificationLifeSpan)),function(){S.current&&window.clearTimeout(S.current)}}),[n]);var y=(0,r.useMemo)((function(){return(0,m.getActiveParticipants)(h.participants,h.me,h.groupId,h.meGroup)}),[h.participants,h.me,h.groupId,h.meGroup]),N=(0,r.useMemo)((function(){return(0,A.isGroupCallByPeer)(h.peer)}),[h.peer]),T=y.length>1,I=N||y.length>2,P=T||(0,m.isParticipantWithVideo)(h.participants[h.me]),b=I&&P&&h.isOratorMode,w=(0,d.classNames)("",{CallNotification__pushToTalk:(null==n?void 0:n.type)===i.NotificationType.PUSH_TO_TALK,CallNotification__orator:b&&h.isShownParticipantsAside}),L=h.peer,M=(0,A.isGroupCallByPeer)(L)?h.callData.conversation:h.participants[L],O=(0,a.__read)(r.useState(),2),k=O[0],D=O[1],R=(0,a.__read)(r.useState(""),2),B=R[0],G=R[1];return(null==M?void 0:M.status)!==k&&(G((0,_.getCallStatus)(h,v)),D(null==M?void 0:M.status)),r.useEffect((function(){G((0,_.getCallStatus)(h,v))}),[h]),n||B?r.createElement(s.CallNotification,{className:w},B||C):null}},154463:(e,t,n)=>{"use strict";n.d(t,{CallParticipantListContainer:()=>h});var a=n(570655),r=n(667294),i=n(50533),o=n(813245),l=n(750598),s=n(248586),c=n(884143),u=n(431469),d=n(279060),p=n(310765),A=n(51247),_=n(916972),m=n(697483),g=n(662208),f=n(613335),v=n(564840),E=n(464380),h=function(e){var t=e.SDK,n=e.onAddClick,h=e.navigateToProfile,C=e.navigateToConvo,S=e.onShowMoreWaitingHall,y=(0,i.useSelector)((function(e){return e})),N=r.useContext(g.LangContext).getLang,T=(0,a.__read)(function(e){var t=!!e.groupId;return Object.values(e.participants).reduce((function(n,a){var r=a,i=!1;return a.peerId===e.me?(t&&(null==e?void 0:e.meGroup)&&(r=(0,f.mergeGroupToParticipant)(e.meGroup,a)),i=!0):a.status&&(i=!0),i&&(n[0].push(r),r.name&&n[1].push(r)),n}),[[],[]])}(y),2),I=T[0],P=T[1],b=(0,a.__read)((0,r.useState)(""),2),w=b[0],L=b[1],M=(0,r.useCallback)((function(e){return e.name}),[]),O=(0,r.useCallback)((function(e){return e.peerId}),[]),k=(0,u.useIndexer)(P,M,O),D=(0,m.canMuteParticipants)(y.participants[y.me]),R=w?k.search(w):I,B=(0,r.useCallback)((function(e){L(e.target.value)}),[]),G=!(0,m.isParticipantAnonym)(y.me);return r.createElement(o.CallParticipantList,{searchQuery:w,onSearchChange:B,length:R.length,waitingHallList:y.waitingHall&&r.createElement(v.WaitingHallListContainer,{isModal:!1,navigateToProfile:h,onMore:S})},!w&&G&&r.createElement(l.default,{selectable:!1,border:!1,key:"add"},r.createElement(_.ListAddControl,{onClick:n},N("calls_add_participants"))),R.length>0&&R.map((function(e){var n,a,i,o=e.peerId!==y.me&&e.status===E.ParticipantStatus.WAITING,c=!o&&!(null===(n=e.mediaSettings)||void 0===n?void 0:n.isAudioEnabled),u=!o&&!(null===(a=e.mediaSettings)||void 0===a?void 0:a.isVideoEnabled),_=!o&&!!(null===(i=e.statusData)||void 0===i?void 0:i.hand),g=!!y.speakers[e.peerId],f=o||c||_||g,v=e.peerId===y.me,S=!o&&(c||u)&&D&&!v;return r.createElement(l.default,{selectable:!1,border:!1,key:e.peerId,aside:r.createElement(r.Fragment,null,f&&r.createElement(A.ParticipantIndicators,{showSpeaking:g,showRaisedHand:_,showAudioDisabled:c,showConnecting:o,showRaisedHandTooltip:S,onRaisedHandClick:S?function(){return function(e){var n=y.participants[e],a=(0,m.getParticipantExternalId)(n);a&&t.unmuteRequest(a,[E.MediaOption.AUDIO,E.MediaOption.VIDEO,E.MediaOption.SCREEN_SHARING]).catch(console.log)}(e.peerId)}:void 0,key:"indicators"}),r.createElement(p.ParticipantMenuContainer,{SDK:t,participant:e,key:"menu",navigateToConvo:C,navigateToProfile:h}))},r.createElement(s.default,{onLinkClick:h,photo:r.createElement(d.CallPhoto,{id:e.peerId,photo:e.photo,alt:e.name||"",size:"xxxs",showCreatorBadge:(0,m.isCreator)(e),showAdminBadge:(0,m.isAdmin)(e)}),title:e.name,href:e.link,target:"_blank"}))})),w&&0===R.length&&r.createElement(c.default,null,N("calls_participants_not_found")))}},165999:(e,t,n)=>{"use strict";n.d(t,{CallsErrorBoundary:()=>o});var a=n(570655),r=n(667294),i=n(121255),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return(0,a.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e){switch(this.props.mode){case i.Mode.CALL:this.props.SDK.hangup();break;case i.Mode.INCOMING:this.props.SDK.declineCall()}this.props.onReset(),this.setState({hasError:!1}),console.error("Calls crashed:",e,e)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(r.Component)},963532:(e,t,n)=>{"use strict";n.d(t,{CautionContainer:()=>A});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(464380),s=n(614914),c=n(745284),u=n(697483),d=n(662208),p=n(440896),A=function(e){var t=e.isIncoming,n=void 0!==t&&t,A=(0,r.useSelector)((function(e){return e})),_=(0,r.useDispatch)(),m=(0,a.useContext)(d.LangContext).getLang,g=m(n?"calls_reject_title":"calls_hangup_description"),f=m(n?"calls_reject_description":"calls_hangup_description"),v=(0,a.useCallback)((function(){_({type:o.SHOW_CAUTION_BOX,isOpen:!1})}),[]);return a.createElement(p.CallError,{title:g,onClose:v,actionButtons:a.createElement(a.Fragment,null,a.createElement(i.default,{onClick:function(){v(),n?(0,l.declineCall)().catch((function(){})):((0,l.hangup)().catch((function(){})),s.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:A.callData.callId,peer_id:A.peer,is_group_call:(0,c.isGroupCallByPeer)(A.peer),reason:"none",group_call_users_count:(0,u.getActiveParticipants)(A.participants,A.me,A.groupId,A.meGroup).length}))}},m("calls_yes")),a.createElement(i.default,{onClick:v},m("calls_no"))),text:a.createElement("span",{dangerouslySetInnerHTML:{__html:f}})})}},923947:(e,t,n)=>{"use strict";n.d(t,{CollapsedCallContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(275109),l=n(400412),s=n(180474),c=n(121255),u=n(298811),d=n(745284),p=n(697483),A=n(662208),_=n(464380),m=function(e){var t,n,m,g,f=e.SDK,v=(0,i.useSelector)((function(e){return e})),E=(0,i.useDispatch)(),h=r.useContext(A.LangContext).getLang,C=v.peer,S=(0,u.isAnyoneWithVideo)(v),y=(0,d.isGroupCallByPeer)(C)?v.callData.conversation:v.participants[C],N=v.participants[v.me],T=(0,p.getCallVisibleParticipant)(v,S),I=(0,p.isParticipantWithVideo)(N)&&T&&T.peerId!==v.me,P=(0,r.useCallback)((function(){E({type:c.CHANGE_UI_MODE,mode:c.UIMode.DEFAULT})}),[]),b=(null===(t=null==N?void 0:N.mediaSettings)||void 0===t?void 0:t.isAudioEnabled)||(null===(n=N.permissions)||void 0===n?void 0:n.audio)>0,w=(0,r.useCallback)((function(){var e;f.toggleLocalAudio(!(null===(e=N.mediaSettings)||void 0===e?void 0:e.isAudioEnabled))}),[v]);return r.createElement(o.CollapsedCall,null,v.mode===c.Mode.INCOMING&&r.createElement(l.CallWidget,{id:C,title:(null==y?void 0:y.tab)||"",photo:(null==y?void 0:y.photo)||"",status:h("calls_incoming_collapsed"),isIncoming:!0,onClick:P}),v.mode!==c.Mode.INCOMING&&r.createElement(s.CallVideoWidget,(0,a.__assign)({localVideoStream:I?(0,p.getStream)(N):void 0,isLocalAudioEnabled:!!(null===(m=N.mediaSettings)||void 0===m?void 0:m.isAudioEnabled),isLocalAudioAllowed:b,isLocalScreenSharing:!!(null===(g=N.mediaSettings)||void 0===g?void 0:g.isScreenSharingEnabled)},function(e,t,n){var a,r;return e?{participantId:e.peerId,isMe:e.peerId===n,isWithVideo:(0,p.isParticipantWithVideo)(e),isWithAudio:!!(null===(a=e.mediaSettings)||void 0===a?void 0:a.isAudioEnabled),isScreenSharing:!!(null===(r=e.mediaSettings)||void 0===r?void 0:r.isScreenSharingEnabled),stream:(0,p.getStream)(e),photo:e.photo,name:e.name,status:e.status,networkStatus:e.networkStatus}:{participantId:t&&t.peerId||0,isMe:!1,isWithVideo:!1,isWithAudio:!1,isScreenSharing:!1,stream:void 0,photo:t&&t.photo||"",name:t&&t.tab||"",status:t&&t.status||_.ParticipantStatus.CONNECTED,networkStatus:1}}(T,y,v.me),{onRestoreCall:P,onToggleAudio:w})))}},241715:(e,t,n)=>{"use strict";n.d(t,{CollapsedWaitingHallContainer:()=>u});var a=n(570655),r=n(667294),i=n(50533),o=n(275109),l=n(180474),s=n(121255),c=n(697483),u=function(e){var t,n=e.SDK,u=(0,i.useSelector)((function(e){return e})),d=(0,i.useDispatch)(),p=u.participants[u.me],A=(0,r.useCallback)((function(){d({type:s.CHANGE_UI_MODE,mode:s.UIMode.DEFAULT})}),[]),_=(0,r.useCallback)((function(){var e;n.toggleLocalAudio(!(null===(e=p.mediaSettings)||void 0===e?void 0:e.isAudioEnabled))}),[u]);return r.createElement(o.CollapsedCall,null,r.createElement(l.CallVideoWidget,(0,a.__assign)({},function(e){var t,n;return{participantId:e.peerId,isMe:!0,isWithVideo:(0,c.isParticipantWithVideo)(e),isWithAudio:!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),isScreenSharing:!!(null===(n=e.mediaSettings)||void 0===n?void 0:n.isScreenSharingEnabled),stream:(0,c.getStream)(e),photo:e.photo,name:e.name,status:e.status,networkStatus:e.networkStatus}}(p),{onRestoreCall:A,isMe:!0,isLocalAudioEnabled:!!(null===(t=p.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),isLocalAudioAllowed:!0,isLocalScreenSharing:!1,onToggleAudio:_})))}},599648:(e,t,n)=>{"use strict";n.d(t,{ErrorContainer:()=>u});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(464380),c=n(440896),u=function(e){var t=e.title,n=e.text,u=e.onCloseFatal,d=e.handleType,p=e.callId,A=e.bridge,_=(0,r.useDispatch)(),m=a.useContext(l.LangContext).getLang,g=function(){switch(_({type:o.ERROR,isClosed:!0}),d){case o.ErrorHandleType.FATAL:u();break;case o.ErrorHandleType.DECLINE:(0,s.declineCall)().catch((function(){}));break;case o.ErrorHandleType.PROCESS:(0,s.processPush)(p||"").then((function(){(0,s.declineCall)().catch((function(){}))})).catch((function(e){A.debug&&console.error("Delayed by error push process error",e)}))}},f=n||m("calls_error"),v=f.match(/<\s?[a-zA-Z0-9]+\s?\/?>/)?a.createElement("span",{dangerouslySetInnerHTML:{__html:f}}):f;return a.createElement(c.CallError,{title:t||m("calls_oops"),onClose:g,actionButtons:a.createElement(i.default,{onClick:g},m("calls_close")),text:v})}},379981:(e,t,n)=>{"use strict";n.d(t,{FeedbackContainer:()=>v});var a,r=n(570655),i=n(667294),o=n(50533),l=n(269481),s=n(121255),c=n(25947),u=n(662208),d=n(614914),p=n(745284),A=n(950890),_=n(659397),m=n(254060),g=n(731585),f=n(244809);!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ADVANCE=1]="ADVANCE"}(a||(a={}));var v=function(e){var t=e.onSuccessFeedback,n=(0,o.useDispatch)(),v=(0,o.useSelector)((function(e){return e})),E=i.useContext(u.LangContext).getLang,h=(0,r.__read)((0,i.useState)(a.DEFAULT),2),C=h[0],S=h[1],y=(0,r.__read)((0,i.useState)(!0),2),N=y[0],T=y[1],I=(0,r.__read)((0,i.useState)(!1),2),P=I[0],b=I[1],w=new Map([["DID_NOT_HEAR_INTERLOCUTOR",E("calls_feedback_reason_did_not_hear_interlocutor")],["DID_NOT_SEE_INTERLOCUTOR",E("calls_feedback_reason_did_not_see_interlocutor")],["BAD_VIDEO_QUALITY",E("calls_feedback_reason_bad_video_quality")],["VIDEO_FREEZES",E("calls_feedback_reason_video_freezes")],["VERY_QUIET_SOUND",E("calls_feedback_reason_very_quiet_sound")],["BAD_SOUND_QUALITY",E("calls_feedback_reason_bad_sound_quality")],["SOUND_DID_NOT_MATCH_THE_VIDEO",E("calls_feedback_reason_sound_did_not_match_the_video")],["FAILED_TO_TURN_ON_CAMERA_OR_MICROPHONE",E("calls_feedback_reason_failed_to_turn_on_camera_or_microphone")]]),L=(0,r.__read)((0,i.useState)({user_response:0,feedback:[],custom_feedback:void 0}),2),M=L[0],O=L[1],k=(0,r.__read)((0,i.useState)(Array.from(w,(function(e){return{name:(0,r.__read)(e,1)[0],checked:!1}}))),1)[0],D=function(){n({type:s.CHANGE_MODE,mode:s.Mode.READY})},R=function(e){var t=e.target.getAttribute("data-response");if(t){var n=parseInt(t,10);n<=3&&S(a.ADVANCE),O((0,r.__assign)((0,r.__assign)({},M),{user_response:n})),T(!1)}},B=function(e,t){k.forEach((function(n){n.name===e&&(n.checked=t)})),O((function(e){return(0,r.__assign)((0,r.__assign)({},e),{feedback:k.filter((function(e){return e.checked})).map((function(e){return e.name}))})}))},G=function(e,t){b(t)},x=function(e){O((0,r.__assign)((0,r.__assign)({},M),{custom_feedback:e.currentTarget.value}))};return i.createElement(l.CallModal,{onClose:D,onBackdropClick:D},i.createElement("section",{className:"Call"},i.createElement(c.FeedbackScreen,{title:C===a.DEFAULT?E("calls_feedback_default_title"):E("calls_feedback_advance_title"),sendButtonClick:function(){var e=v.lastCallData?v.lastCallData.peerId:0;d.callStats.logEvent({call_event_type:s.CallActionEventType.USER_FEEDBACK_RECEIVED,session_id:v.lastCallData?v.lastCallData.callId:"",peer_id:e,is_group_call:(0,p.isGroupCallByPeer)(e),user_response:M.user_response,feedback:M.feedback,custom_feedback:P&&M.custom_feedback?M.custom_feedback:void 0}),n({type:s.CHANGE_MODE,mode:s.Mode.READY}),t&&t()},skipButtonClick:D,sendButtonDisabled:N},C===a.DEFAULT?i.createElement("div",{className:"FeedbackScreen__stars",onClick:R},[1,2,3,4,5].map((function(e,t){return i.createElement("div",{className:(0,_.classNames)("FeedbackScreen__star",{"FeedbackScreen__star--active":e<=M.user_response}),"data-response":e,key:t},i.createElement(A.StarOutline,{className:"FeedbackScreen__starIcon FeedbackScreen__starIcon--outline"}),i.createElement(m.StarFilled,{className:"FeedbackScreen__starIcon FeedbackScreen__starIcon--filled"}))}))):i.createElement("div",{className:"FeedbackScreen__voting"},Array.from(w,(function(e){var t=(0,r.__read)(e,2),n=t[0],a=t[1];return i.createElement("div",{className:"FeedbackScreen__votingItem",key:n},i.createElement(g.default,{name:n,className:"FeedbackScreen__votingItemCheckbox",onChange:B},a))})),i.createElement("div",{className:"FeedbackScreen__votingItem FeedbackScreen__votingItem--custom"},i.createElement(g.default,{name:"CUSTOM_FEEDBACK",className:"FeedbackScreen__votingItemCheckbox",onChange:G}),i.createElement(f.default,{className:"FeedbackScreen__votingItemTextArea",placeholder:E("calls_feedback_custom_reason_placeholder"),grow:!1,disabled:!P,onChange:x}))))))}},187252:(e,t,n)=>{"use strict";n.d(t,{GroupCallSetupContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(881150),s=n(186983),c=n(782605),u=n(298811),d=n(614914),p=n(745284),A=n(697483),_=n(662208),m=function(e){var t=e.SDK,n=e.bridge,m=e.isWithBackButton,f=e.onBackClick,v=(0,i.useSelector)((function(e){return e})),E=(0,i.useDispatch)(),h=r.useContext(_.LangContext).getLang,C=(0,a.__read)((0,r.useState)(v.preselectedIds||[]),2),S=C[0],y=C[1],N=(0,a.__read)((0,r.useState)((0,A.getActiveParticipantsCount)(v)),1)[0]+S.length,T=function(){E({type:o.GROUP_CALL_SETUP,open:!1,preselectedIds:null}),E({type:o.MANAGEMENT,isOpen:!1})},I=0===S.length,P=function(e){T(),E({type:o.MANUAL_ADD_PARTICIPANTS,participants:e});var n=e.map((function(e){return new Promise((function(n){t.addParticipant(String(e)).then(n).catch((function(t){"auth.banned"===t.message?n(e):"vk-participant-is-rejected-error"===t.message?E({type:o.ERROR,text:h("calls_error_cant_add_because_of_privacy")}):n(null)}))}))}));Promise.all(n).then((function(e){if((e=e.filter((function(e){return void 0!==e}))).length){var t=function(e,t){var n=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(e.friends)),(0,a.__read)(e.chatMembers)),(0,a.__read)(e.groupMembers)),r=[];return n.filter((function(e){var n=e.id;return!(!t.includes(n)||r.includes(n))&&(r.push(n),!0)}))}(v,e);E({type:o.UNBAN_PARTICIPANTS,data:{members:t}})}}));var r=(0,a.__read)((0,u.convertClientData)(function(e,t){var n=e.chatData||e.callData.conversation,r=t.reduce((function(t,n){return e.participants[n]||t.set(n,!0),t}),new Map);if(0===r.size)return[n,[]];var i=e.chatMembers.length<e.friends.length?e.chatMembers:e.friends,o=e.chatMembers.length<e.friends.length?e.friends:e.chatMembers,l=i.reduce((function(e,t){return r.get(t.id)&&(e.smallerListData.push(t),e.smallerListMap.set(t.id,!0)),e}),{smallerListData:[],smallerListMap:new Map}),s=l.smallerListData,c=l.smallerListMap;if(s.length===r.size)return[n,s];var u=o.filter((function(e){return!c.get(e.id)&&r.get(e.id)}));return[n,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(s)),(0,a.__read)(u))]}(v,e)),2),i=r[0],l=r[1];E({type:o.LOAD_PEERS,conversation:i,members:l}),d.callStats.logEvent({call_event_type:o.CallActionEventType.OUTGOING_CALL_ADD_PARTICIPANTS_SENT,session_id:v.callData.callId,peer_id:v.peer.toString(),is_group_call:(0,p.isGroupCallByPeer)(v.peer),group_call_users_count:S.length})},b=(0,r.useCallback)((function(){P(S)}),[S]);return r.createElement(s.CallManagementModal,{title:h("calls_add_participants_to_call"),onCloseModal:T,actionButtons:r.createElement(l.default,{key:"add",disabled:I,onClick:b},h("calls_add")),hint:g(N,v.participantLimit,h),isWithBackButton:m,onBackClick:m?f:function(){}},r.createElement(c.AddParticipantContainer,{groupId:n.authorizedGroupId||0,onChange:y,onClickCallAll:function(e){P(e)}}))};function g(e,t,n){return e<2?n("calls_management_add_warning"):n("calls_selected").replace("{selected}",""+e).replace("{limit}",""+t)}},536559:(e,t,n)=>{"use strict";n.d(t,{IncomingCallContainer:()=>m});var a=n(667294),r=n(50533),i=n(309605),o=n(826988),l=n(995420),s=n(44781),c=n(789241),u=n(269481),d=n(745284),p=n(121255),A=n(614914),_=n(662208);function m(e){var t=e.SDK,n=e.bridge,m=(0,r.useSelector)((function(e){return e})),g=m.peer,f=m.callData,v=m.participants,E=m.caller,h=(0,r.useDispatch)(),C=a.useContext(_.LangContext).getLang,S=E;S||(S=(0,d.isGroupCallByPeer)(g)?f.conversation:v[g]);var y=f.type===p.CallType.VIDEO,N=C(y?"calls_incoming_videocall":"calls_incoming_audiocall"),T=C(y?"calls_reply_with_audio":"calls_reply"),I=C(y?"calls_reject_call":"calls_reject"),P=function(){t.declineCall(),A.callStats.logEvent({call_event_type:p.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:f.callId,peer_id:g,is_group_call:(0,d.isGroupCallByPeer)(g),reason:"none"})};return a.createElement(u.CallModal,{onClose:P,isIncoming:!0,isCautionBoxShown:!0},a.createElement(c.IncomingCall,{id:g,title:(null==S?void 0:S.tab)||"",description:N,photo:(null==S?void 0:S.photo)||"",onCollapseCall:function(){h({type:p.CHANGE_UI_MODE,mode:p.UIMode.COLLAPSED})}},a.createElement(a.Fragment,null,y&&a.createElement(i.CallButton,{text:C("calls_reply_with_video"),type:i.CallButtonTypes.POSITIVE,icon:a.createElement(o.VideoIcon,null),onClick:function(){return n.acceptCall(!0,!0)}}),a.createElement(i.CallButton,{text:T,type:y?i.CallButtonTypes.REGULAR:i.CallButtonTypes.POSITIVE,icon:a.createElement(l.PhoneIcon,null),onClick:function(){return n.acceptCall(!1,!0)}}),a.createElement(i.CallButton,{text:I,type:i.CallButtonTypes.NEGATIVE,icon:a.createElement(s.RejectIcon,null),onClick:P}))))}},656504:(e,t,n)=>{"use strict";n.d(t,{JoinScreenContainer:()=>g});var a=n(570655),r=n(667294),i=n(991390),o=n(138671),l=n(838480),s=n(121255),c=n(298811),u=n(788822),d=n(329538),p=n(662208),A=n(253312),_=n(498110),m=n(697483),g=function(e){var t=e.isAnonym,n=e.joinLink,g=e.vkJoinLink,v=e.title,E=e.members,h=e.membersCount,C=e.conversationData,S=e.withPopup,y=e.onBeforeCallStart,N=e.onAfterCallFinish,T=e.onClose,I=e.bridge,P=e.entryPoint,b=e.tabIsMaster,w=e.tabIsIdle,L=e.onError,M=e.isDev,O=e.okPublicKey,k=r.useContext(p.LangContext),D=k.getLang,R=k.langNumeric,B=(0,a.__read)((0,r.useState)(""),2),G=B[0],x=B[1],H=(0,a.__read)((0,r.useState)(null),2),U=H[0],V=H[1],F=(0,a.__read)((0,r.useState)(!1),2),W=F[0],z=F[1],j=!1,Q=r.useContext(_.ConfigContext),Y=Q.allowCallByName,K=Q.nativeAppJoin,J=E?E.slice(0,3).map((function(e){var t=e.firstName||e.shortName||e.name||"";return e.photo_100?{src:e.photo_100,alt:t,key:e.peerId}:{id:e.peerId,text:t.slice(0,1)}})):[],q=(0,r.useCallback)((function(e){x(e.target.value)}),[]),Z=(0,r.useCallback)((function(e){if(t)return j?Promise.resolve():(j=!0,function(e,t,n,a,r,i){if(e)return Promise.resolve(e);return(0,d.getJoinLinkDetails)(n,!0).then((function(e){var o=e.secret,l=void 0===o?"":o,c=e.user_id,u=void 0===c?0:c,p=e.preview;return(0,d.getAnonymCallToken)(n,u,a,l).then((function(e){var n=e.token,o=e.secret,l=void 0===o?"":o,c={is_dev:f(i),key:r,token:n,ok_user:u,secret:l,is_anonym:!0,me:{canAddMembers:!1,firstName:a,peerId:u,id:u,sex:"0",shortName:a,name:a,lastName:"",link:"",photo:"",photo_100:""}},d={callPreview:{tab:p.title,photo:p.photo.photo_200},callsCredentials:c,participantLimit:128,callsOkStaging:f(i),callsLogging:!1,CallsIncomingCall:!1,callsAllowBanParticipant:!1,callsFeedbackScreenEnabled:!1,callsVideoSlotsEnabled:!0,videoSlotsCount:s.VIDEO_SLOTS_COUNT,callsAllowCallByName:!1,callsNativeApp:!1,callsNativeAppJoin:!1,callsEnableScreenTrack:!0,callsEnableProducerScreenTrack:!0,callsAllowWaitingHall:!1,callsAllowPushToTalk:!1,callsBadNetwork:!1,callsBadNetworkP2P:!1};return t(d),d}))}))}(U,V,g,G,O,M).then((function(e){return function(e){var t=e.bridge,n=e.inited,a=e.setInited,r=e.data,i=e.onBeforeCallStart,o=e.onAfterCallFinish,l=e.tabIsMaster,s=e.tabIsIdle,c=e.langUtils;if(n)return Promise.resolve();var u=r.callPreview,d=r.callsCredentials,p=r.participantLimit,A=r.callsOkStaging,_=r.callsLogging,m=r.CallsIncomingCall,g=r.callsAllowBanParticipant,f=r.callsFeedbackScreenEnabled,v=r.callsVideoSlotsEnabled,E=r.videoSlotsCount,h=r.callsAllowCallByName,C=r.callsNativeApp,S=r.callsNativeAppJoin,y=r.callsEnableScreenTrack,N=r.callsEnableProducerScreenTrack,T=r.callsAllowWaitingHall,I=r.callsAllowPushToTalk,P=r.callsBadNetwork,b=r.callsBadNetworkP2P;return t.init({callPreview:u,callsCredentials:d,imHash:"",participantLimit:p,callsOkStaging:A,onBeforeCallStart:i,onAfterCallFinish:o,tabIsMaster:l,tabIsIdle:s,langUtils:c,toggles:{debugLog:_,incomingCall:m,allowBanParticipant:g,showFeedbackScreen:f,enableVideoSlots:v,videoSlotsCount:E,allowCallByName:h,nativeApp:C,nativeAppJoin:S,enableScreenTrack:y,enableProducerScreenTrack:N,allowWaitingHall:T,allowPushToTalk:I,badNetwork:P,badNetworkP2P:b}}).then((function(){return a(!0)}))}({bridge:I,inited:W,setInited:z,data:e,onBeforeCallStart:y,onAfterCallFinish:N,tabIsMaster:b,tabIsIdle:w,langUtils:k})})).then((function(){return I.joinCallByLink(n,null,e,P)})).catch((function(e){I.eventHandlers.onError&&e&&I.eventHandlers.onError(e);var t="";t="string"==typeof e?e:e&&e.error&&e.error.error_code?(0,c.getTextForApiErrorByCode)(e.error.error_code,!0,D):(0,A.getCallStartErrorText)(e,!0,D)||D("calls_unknown_error"),L&&L(t)})).finally((function(){j=!1})));if(T&&T(),!C)throw Error("no peer_id to join");return I.joinCallByLink(n,[C,E],e,P).catch((function(e){var t="";t="string"==typeof e?e:e&&e.error&&e.error.error_code?(0,c.getTextForApiErrorByCode)(e.error.error_code,!0,D):D("calls_unknown_error"),L&&L(t)})),Promise.resolve()}),[n,T,G,U,W,O]),X=(0,r.useCallback)((function(){T&&T()}),[T]),$=(0,r.useMemo)((function(){return(0,u.escape)((0,u.decodeHTMLEntities)(v))}),[v]),ee=(0,r.useCallback)((function(){I.showCallByNamePopup(null,P,n)}),[]),te=(0,r.useCallback)((function(){I.showStartCallModal(null,n)}),[]),ne=r.createElement(i.JoinScreen,{isAnonym:t,name:G,onChangeName:q,namePlaceholder:D("calls_name_placeholder"),title:$,label:(0,c.getParticipantsListLabel)(E||[],J,(function(e){return(0,m.isParticipantGroup)(e.peerId)?e.name:e.firstName}),D,R,h),items:J,joinWithVideoText:D("calls_join_with_video"),joinWithAudioText:D("calls_join_with_audio"),onJoinWithVideo:function(){return Z(!0)},onJoinWithAudio:function(){return Z(!1)},disabled:t&&!/^[A-Za-zА-Яа-яЁё0-9_\- ]{2,25}$/.test(G),inputDisabled:!!U,callByNameShow:Y&&!t,callByNameTitle:D("calls_call_by_name_join_by"),callByNameDescription:"",onCallByNameClick:ee,callViaNativeAppShow:K&&!t,callViaNativeAppTitle:D("calls_call_via_native_app_join"),onCallViaNativeAppClick:te});return S?r.createElement(o.default,{onClose:X},r.createElement(l.ModalHeader,{appearance:"blue",title:D("calls_invite"),onClose:X}),ne):ne},f=function(e){return void 0!==e?e:!(!window.vk||void 0===window.vk.isCallsDevEnv)&&window.vk.isCallsDevEnv}},989819:(e,t,n)=>{"use strict";n.d(t,{KickParticipantContainer:()=>p});var a=n(570655),r=n(667294),i=n(50533),o=n(881150),l=n(121255),s=n(662208),c=n(963985),u=n(697483),d=n(719481),p=function(){var e,t,n,p=(0,i.useDispatch)(),A=r.useContext(s.LangContext),_=A.getLang,m=A.langSex,g=(0,i.useSelector)((function(e){return e})),f=null===(e=g.participantKick)||void 0===e?void 0:e.participant,v=(null===(t=g.participantKick)||void 0===t?void 0:t.type)===l.KickParticipantType.CALL,E=(0,a.__read)((0,r.useState)(!0),2),h=E[0],C=E[1],S=!!f&&(!(0,u.participantIsAdmin)(f)&&!(0,u.participantIsChatAdmin)(f,g.callData.conversation)),y=(0,r.useCallback)((function(){p({type:l.TOGGLE_PARTICIPANTS_KICK})}),[]),N=(0,r.useCallback)((function(){(0,u.kickParticipant)(f,!h).then((function(){!v&&g.waitingHall&&(null==f?void 0:f.peerId)&&(0,d.removeUserFromWaitingHall)(null==f?void 0:f.peerId,g.waitingHall,p)})),y()}),[g.participantKick,h]),T=(0,r.useCallback)((function(e){C(e)}),[]),I=v?"calls_kick_participant_text":"calls_kick_participant_from_waiting_hall_text",P=m(null==f?void 0:f.sex,I,_(I,!0)).replace("{user}",null!==(n=null==f?void 0:f.name)&&void 0!==n?n:""),b=_(v?"calls_kick_participant_kick_button_text":"calls_kick_participant_from_waiting_hall_button_text"),w=_(v?"calls_kick_participant_with_ban_setting":"calls_kick_participant_from_waiting_hall_with_ban_setting");return r.createElement(c.KickParticipantModal,{onClose:y,onAllowReconnectChange:T,description:P,allowBan:S,banText:w,actionButtons:[r.createElement(o.default,{onClick:y,appearance:"secondary",key:"cancel"},_("calls_cancel")),r.createElement(o.default,{onClick:N,key:"stop"},b)]})}},325496:(e,t,n)=>{"use strict";n.d(t,{MuteParticipantContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(881150),l=n(467667),s=n(121255),c=n(697483),u=n(662208),d=n(614914),p=n(745284),A=n(329538),_=n(464380),m=function(e){var t,n,m,g=e.SDK,f=(0,i.useSelector)((function(e){return e})),v=(0,a.__read)((0,r.useState)(!0),2),E=v[0],h=v[1],C=(0,a.__read)((0,r.useState)(""),2),S=C[0],y=C[1],N=(0,a.__read)((0,r.useState)(!0),2),T=N[0],I=N[1],P=(0,i.useDispatch)(),b=r.useContext(u.LangContext).getLang,w=null===(t=f.participantsManagement)||void 0===t?void 0:t.mode,L=null===(n=f.participantsManagement)||void 0===n?void 0:n.participant,M=w===s.ParticipantsManagementMode.SINGLE&&((0,c.isAdmin)(L)||(0,c.isCreator)(L));(0,r.useEffect)((function(){var e;if(w!==s.ParticipantsManagementMode.SINGLE||(0,c.isParticipantAnonym)((null==L?void 0:L.peerId)||0))h(!1);else{P({type:s.SHOW_LOADER,isLoaderVisible:!0});var t=null===(e=f.participantsManagement)||void 0===e?void 0:e.participant;new Promise((function(e,n){t&&t.peerId<0?(0,A.getGroupById)(-t.peerId).then((function(t){var n,a=t.groups;e(a&&a.length>0?null===(n=a[0])||void 0===n?void 0:n.name:"")})).catch((function(e){return n(e)})):(0,A.loadUsers)({user_ids:t&&String(t.peerId),name_case:"acc"}).then((function(t){var n=(0,a.__read)(t,1)[0];e(null==n?void 0:n.first_name)})).catch((function(e){return n(e)}))})).then((function(e){y(e),h(!1),P({type:s.SHOW_LOADER,isLoaderVisible:!1})})).catch(console.log)}}),[w,null===(m=f.participantsManagement)||void 0===m?void 0:m.participant]);var O=(0,r.useCallback)((function(){P({type:s.TOGGLE_PARTICIPANTS_MANAGEMENT})}),[]),k=(0,r.useCallback)((function(){if(w===s.ParticipantsManagementMode.SINGLE){var e=(0,c.getParticipantExternalId)(L);g.muteParticipant(e,[_.MediaOption.AUDIO,_.MediaOption.VIDEO,_.MediaOption.SCREEN_SHARING],!T).catch(console.log).finally(O),d.callStats.logEvent({call_event_type:s.CallActionEventType.USER_MICS_AND_VIDEO_DISABLED,session_id:f.callData.callId,peer_id:f.peer,is_group_call:(0,p.isGroupCallByPeer)(f.peer),mute_permanent:T?s.CallStatMuteType.ONCE:s.CallStatMuteType.PERMANENT})}else w===s.ParticipantsManagementMode.ALL&&(g.muteParticipant(void 0,[_.MediaOption.AUDIO,_.MediaOption.VIDEO,_.MediaOption.SCREEN_SHARING],!T).catch(console.log).finally(O),d.callStats.logEvent({call_event_type:s.CallActionEventType.ALL_MICS_AND_VIDEO_DISABLED,session_id:f.callData.callId,peer_id:f.peer,is_group_call:(0,p.isGroupCallByPeer)(f.peer),mute_permanent:T?s.CallStatMuteType.ONCE:s.CallStatMuteType.PERMANENT}))}),[T]);return w===s.ParticipantsManagementMode.SINGLE&&E?null:r.createElement(l.MuteParticipantModal,{onClose:O,allowUnmute:T,unmuteToggleDisabled:M,onUnmuteToggle:function(e,t){return I(t)},title:w===s.ParticipantsManagementMode.SINGLE?b("calls_mute_participant_dialog_title").replace("{name}",null!=S?S:null==L?void 0:L.name):b("calls_mute_all_participants_dialog_title"),description:w===s.ParticipantsManagementMode.SINGLE?b("calls_mute_participant_dialog_description").replace("{name}",null!=S?S:null==L?void 0:L.name):b("calls_mute_all_participants_dialog_description"),toggleSign:w===s.ParticipantsManagementMode.SINGLE?b("calls_mute_participant_dialog_permanent_toggle"):b("calls_mute_all_participants_dialog_permanent_toggle"),actionButtons:[r.createElement(o.default,{onClick:O,appearance:"secondary",key:"cancel"},b("calls_cancel")),r.createElement(o.default,{onClick:k,key:"disable"},b("calls_mute_participant_dialog_action"))]})}},290514:(e,t,n)=>{"use strict";n.d(t,{NotificationWithButtonContainer:()=>A});var a=n(667294),r=n(121255),i=n(662208),o=n(50533),l=n(881150),s=n(298811),c=n(719481),u=n(139230),d=n(700881),p=n(170181),A=function(){var e,t,n,A=(0,o.useSelector)((function(e){return e})),_=(0,o.useDispatch)(),m=a.useContext(i.LangContext),g=m.getLang,f=m.langNumeric,v=(0,a.useCallback)((function(e){var t,n=null===(t=A.waitingHall)||void 0===t?void 0:t.members.get(e);n&&_({type:r.TOGGLE_PARTICIPANTS_KICK,data:{type:r.KickParticipantType.WAITING_HALL,participant:n}})}),[null===(e=A.waitingHall)||void 0===e?void 0:e.members]),E=(0,a.useCallback)((function(){var e=[(0,c.loadAdditionalWaitingHall)(A,_)];return Promise.all(e).then((function(){_({type:r.MANAGEMENT,isOpen:!0,managementView:u.ManagementViews.WAITING_HALL})}))}),[A.waitingHall]),h=(0,a.useCallback)((function(e){A.waitingHall&&(0,c.promoteUserAndRemoveFromWaitingHall)(e,A.waitingHall,_)}),[null===(t=A.waitingHall)||void 0===t?void 0:t.members]),C=(0,a.useCallback)((function(){(0,c.resetWaitingHallNew)(A.waitingHall,_)}),[null===(n=A.waitingHall)||void 0===n?void 0:n.hasNew]);if(!A.waitingHall)return null;if(0===A.waitingHall.members.size)return null;if(!A.waitingHall.hasNew)return null;var S=Array.from(A.waitingHall.members.values()),y=g("calls_notification_users_in_waiting_hall_notification",A.waitingHall.totalCount).replace("{names}",(0,s.getParticipantsListLabel)(S,S.slice(0,3),(function(e){return e.shortName||e.name}),g,f,A.waitingHall.totalCount)),N=null;if(1===S.length){var T=S[0];N=a.createElement(a.Fragment,null,a.createElement(l.default,{onClick:function(){return h(T.peerId)},appearance:"overlay_primary"},g("calls_waiting_hall_join")),a.createElement(l.default,{onClick:function(){return v(T.peerId)},appearance:"overlay_secondary"},g("calls_waiting_hall_forbid")))}else N=a.createElement(l.default,{onClick:function(){return E()},appearance:"overlay_primary"},g("calls_waiting_show_participants"));return a.createElement(p.NotificationWithButton,null,a.createElement("div",null,a.createElement(d.default,{className:"NotificationWithButton--close",onClick:C}),a.createElement("span",null,y),a.createElement("div",{className:"NotificationWithButton--buttons"},N)))}},310765:(e,t,n)=>{"use strict";n.d(t,{ParticipantMenuContainer:()=>s});var a=n(667294),r=n(50533),i=n(697483),o=n(662208),l=n(95939),s=function(e){var t=e.SDK,n=e.participant,s=e.navigateToConvo,c=e.navigateToProfile,u=(0,r.useSelector)((function(e){return e})),d=(0,r.useDispatch)(),p=a.useContext(o.LangContext).getLang,A=(0,i.getParticipantActions)(u,t,d,n,!1,p,s,c,!0);return A.length>0?a.createElement(l.ParticipantMenu,{position:"b",align:"right",trigger:"hover",marginTop:-8,marginLeft:1,actions:A}):null}},670778:(e,t,n)=>{"use strict";n.d(t,{ParticipantStatusContainer:()=>l});var a=n(667294),r=n(580248),i=n(662208),o=n(464380),l=function(e){var t=e.status,n=a.useContext(i.LangContext).getLang;switch(t){case o.ParticipantStatus.WAITING:return a.createElement(r.default,null,n("calls_status_waiting"));case o.ParticipantStatus.CONNECTING:case o.ParticipantStatus.RECONNECT:return a.createElement(r.default,null,n("calls_status_connecting"));case o.ParticipantStatus.ERROR:return n("calls_error");case o.ParticipantStatus.HANGUP:return a.createElement(r.default,null,n("calls_status_hangup"));case o.ParticipantStatus.PERMISSIONS:return n("calls_status_no_permissions");case o.ParticipantStatus.CONNECTED:default:return null}}},48755:(e,t,n)=>{"use strict";n.d(t,{SettingsContainer:()=>_});var a=n(570655),r=n(667294),i=n(659397),o=n(50533),l=n(471304),s=n(555700),c=n(121255),u=n(662208),d=n(498110),p=n(147853),A=r.useState;function _(e){var t=e.SDK,n=r.useContext(u.LangContext).getLang,_=r.useContext(d.ConfigContext).fullHD,m=[{label:n("calls_noise_neural"),value:c.NoiseCancellationTypes.NEURAL,data:{denoise:!0,denoiseAnn:!0}},{label:n("calls_noise_simple"),value:c.NoiseCancellationTypes.SIMPLE,data:{denoise:!0,denoiseAnn:!1}},{label:n("calls_noise_none"),value:c.NoiseCancellationTypes.NONE,data:{denoise:!1,denoiseAnn:!1}}],g=[{label:n("calls_video_resolution_sd"),value:c.VideoResolutionTypes.SD},{label:n("calls_video_resolution_hd"),value:c.VideoResolutionTypes.HD}];_&&g.push({label:n("calls_video_resolution_fhd"),value:c.VideoResolutionTypes.FHD});var f=(0,o.useSelector)((function(e){return e})),v=(0,a.__read)((0,o.useSelector)((function(e){var t;return[e.mode,null===(t=e.participants[e.me].mediaSettings)||void 0===t?void 0:t.isVideoEnabled]})),2),E=v[0],h=v[1],C=(0,o.useDispatch)(),S=t.browser.getCameras(),y=t.browser.getMicrophones(),N=t.browser.hasCamera()&&t.browser.hasCameraPermission(),T=t.browser.hasMicrophone()&&t.browser.hasMicrophonePermission(),I=t.browser.getSavedCamera(),P=t.browser.getSavedMicrophone(),b=N&&(I&&I.deviceId||S[0].deviceId),w=T&&(P&&P.deviceId||y[0].deviceId),L=(0,a.__read)(A(!1===b?void 0:b),2),M=L[0],O=L[1],k=(0,a.__read)(A(!1===w?void 0:w),2),D=k[0],R=k[1],B=(0,a.__read)(A(f.noiseCancellation),2),G=B[0],x=B[1],H=i.localStorage.getItem(c.VIDEO_RESOLUTION_STORAGE_KEY),U=(0,a.__read)(A(H===c.VideoResolutionTypes.FHD?c.VideoResolutionTypes.FHD:H===c.VideoResolutionTypes.HD?c.VideoResolutionTypes.HD:c.VideoResolutionTypes.SD),2),V=U[0],F=U[1],W=(0,a.__read)(A(f.pushToTalkEnabled),2),z=W[0],j=W[1];return r.createElement(s.CallSettingsModal,{onClose:function(){C({type:c.TOGGLE_POPUP})},onSubmit:function(){var e,n=[Promise.resolve()];if(!I&&b===M&&E!==c.Mode.READY&&!h||!M||I&&I.deviceId===M||n.push(t.changeDevice("videoinput",M)),!D||P&&P.deviceId===D||n.push(t.changeDevice("audioinput",D)),f.noiseCancellation!==G&&n.push(t.setMediaModifiers((null===(e=m.find((function(e){return e.value===G})))||void 0===e?void 0:e.data)||{denoise:!0,denoiseAnn:!0}).then((function(){C({type:c.SET_NOISE_CANCELLATION,data:G})}))),f.localVideoResolution!==V&&(console.debug("set resolution from -> to: ",f.localVideoResolution,V,c.VideoWidth[V],c.VideoHeight[V]),n.push(t.setLocalResolution(c.VideoWidth[V],c.VideoHeight[V]).catch((function(e){console.error(e)})).finally((function(){i.localStorage.setItem(c.VIDEO_RESOLUTION_STORAGE_KEY,V),C({type:c.CHANGE_LOCAL_VIDEO_RESOLUTION,data:V})})))),f.pushToTalkEnabled!==z){var a=f.participants[f.me];a.permissions.audio>0&&(0,p.pushToTalkToggleAudio)(z,a.mediaSettings),C({type:c.SET_PUSH_TO_TALK_ENABLE,data:z})}Promise.all(n).then((function(){C({type:c.TOGGLE_POPUP})})).catch((function(e){console.error("Device change failed",e),C({type:c.TOGGLE_POPUP})}))}},r.createElement(l.CallSettings,{mics:y,cameras:S,noiseCancellationOptions:m,videoResolutionOptions:g,currentCamId:M,currentMicId:D,currentNoiseCancellation:G,currentVideoResolution:V,isCamAvailable:N,isMicAvailable:T,onCameraChange:function(e){return O(e)},onMicChange:function(e){return R(e)},onNoiseCancellationChange:function(e){return x(e)},onVideoResolutionChange:function(e){return F(e)},pushToTalkEnabled:z,onPushToTalkChange:function(){j(!z)}}))}},858101:(e,t,n)=>{"use strict";n.d(t,{StartCallContainer:()=>v});var a=n(570655),r=n(667294),i=n(659397),o=n(86894),l=n(835849),s=n(443774),c=n(121255),u=n(233194),d=n(662208),p=n(394886),A=n(767497),_=n(50533),m=n(269481),g=n(153907),f=n(30081);function v(){var e,t=(0,_.useSelector)((function(e){return e})),n=(0,_.useDispatch)(),v=r.useContext(d.LangContext).getLang,E=!(null===(e=t.join)||void 0===e?void 0:e.joinLink),h=(0,a.__read)((0,r.useState)(null!==i.localStorage.getItem(c.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED)),2),C=h[0],S=h[1],y=(0,a.__read)((0,r.useState)(!C),2),N=y[0],T=y[1],I=(0,r.useRef)(null);u.Platform.OS===u.OS.MAC?I.current={url:c.DESKTOP_CALLS_DOWNLOAD[u.OS.MAC],filename:c.DESKTOP_CALLS_FILENAME[u.OS.MAC]}:u.Platform.OS===u.OS.WINDOWS&&(I.current={url:c.DESKTOP_CALLS_DOWNLOAD[u.OS.WINDOWS],filename:c.DESKTOP_CALLS_FILENAME[u.OS.WINDOWS]});var P=null!==I.current,b=(0,a.__read)((0,r.useState)(!C),2),w=b[0],L=b[1],M=function(){i.localStorage.setItem(c.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED,"true")},O=function(){var e,n;return(null===(e=t.join)||void 0===e?void 0:e.joinLink)?(0,p.openDesktopDeepLink)((0,A.generateJoinCallsDeepLink)({joinLink:null===(n=t.join)||void 0===n?void 0:n.joinLink,userId:window.vk.id})):(0,p.openDesktopDeepLink)((0,A.generateStartCallsDeepLink)({peerId:t.peer,userId:window.vk.id}))};(0,r.useEffect)((function(){O().then((function(){T(!1)})).catch((function(){T(!1)}))}),[C]);var k=function(){n({type:c.CHANGE_MODE,mode:c.Mode.READY})};return r.createElement(m.CallModal,{onClose:k,onBackdropClick:k},r.createElement(o.ModalCard,{nav:"StartCallModal",header:r.createElement(f.default,null,v(N&&P?"calls_download_started":C?"calls_app_title":E?"calls_start_call_after_install_app":"calls_join_call_after_install_app")),subheader:w?v("calls_download_and_install_app_for_pc"):C?v(E?"calls_try_manual_start_lesson":"calls_try_manual_join_lesson"):N?v("calls_wait_until_app_downloaded"):"",className:"StartCallModal"},N&&P&&I.current?r.createElement(r.Fragment,null,r.createElement(o.Spinner,{size:"large",className:"StartCallModal__action"}),r.createElement("div",{className:"StartCallModal__text"},v("calls_downloading_file").replace("{file}",I.current.filename))):w?I.current&&P?r.createElement(o.Button,{size:"l",before:r.createElement(l.default,null),onClick:function(){return e=I.current.url,t=I.current.filename,M(),(0,g.download)(e,t),T(!0),void setTimeout((function(){S(!0),T(!1),L(!1)}),3e3);var e,t},className:"StartCallModal__action"},v("calls_download_app")):r.createElement(o.Button,{size:"l",before:r.createElement(l.default,null),href:c.DESKTOP_CALLS_DOWNLOAD_PAGE,target:"_blank",onClick:function(){M(),L(!1)},className:"StartCallModal__action"},v("calls_download_app")):r.createElement(o.Button,{mode:"secondary",size:"l",before:r.createElement(s.default,null),onClick:O,className:"StartCallModal__action"},v(E?"calls_start_in_app":"calls_join_call_in_app")),!w&&r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},r.createElement("div",null,v("calls_apps_for_all_platform")),r.createElement(o.Link,{href:c.DESKTOP_CALLS_DOWNLOAD_PAGE,target:"_blank"},v("calls_open_app_list"))),r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},v("calls_calls_troubles_with_app"),r.createElement("br",null),r.createElement(o.Link,{onClick:function(){var e,n,a=t.peer;if(window.Calls)if(null===(e=t.join)||void 0===e?void 0:e.joinLink)window.Calls.joinCallByLink(null===(n=t.join)||void 0===n?void 0:n.joinLink,void 0,!1,c.CallStatSource.CONVO_JOIN_SNIPPET);else{var r=c.CallStatSource.CONVO_LIST;if(a)a>2e9?window.Calls.startGroupCall(a,void 0,null,!1,r):window.Calls.call(a,!1,void 0,r);else window.Calls.startCall(!1,r)}}},v(E?"calls_calls_start_lesson_in_browser":"calls_join_call_in_browser")))))}},152532:(e,t,n)=>{"use strict";n.d(t,{TransferAdminRightsContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(431469),s=n(338374),c=n(662208),u=n(614914),d=n(745284),p=n(697483),A=n(444083),_=n(464380),m=function(e){var t=e.SDK,n=(0,i.useDispatch)(),m=(0,i.useSelector)((function(e){return e})),g=r.useContext(c.LangContext).getLang,f=(0,a.__read)((0,r.useState)(Object.values(m.participants).filter((function(e){return e.peerId===m.me||e.status===_.ParticipantStatus.CONNECTED&&!(0,p.isParticipantAnonym)(e.peerId)}))),2),v=f[0],E=f[1],h=(0,a.__read)((0,r.useState)(null),2),C=h[0],S=h[1],y=(0,r.useCallback)((function(e){return e.name}),[]),N=(0,r.useCallback)((function(e){return e.peerId}),[]),T=(0,l.useIndexer)(v,y,N),I=(0,r.useMemo)((function(){return(0,p.getActiveParticipantsCount)(m)}),[m.participants]),P=function(){return u.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:m.callData.callId,peer_id:m.peer,is_group_call:(0,d.isGroupCallByPeer)(m.peer),reason:"none",group_call_users_count:I})},b=(0,r.useCallback)((function(e){E(e?T.search(e):T.list),S(null)}),[m]),w=function(){n({type:o.TOGGLE_POPUP})},L=function(){n({type:o.TOGGLE_POPUP}),P(),t.hangup().catch(console.log)},M=(0,r.useCallback)((function(e){S(null===e?null:e.peerId)}),[]);return(0,r.useEffect)((function(){C&&!v.find((function(e){return e.peerId===C}))&&S(null)}),[C]),r.createElement(s.TransferAdminRightsModal,{participants:v,onClose:w,onSelect:M,selected:C,onCallForceFinish:function(){n({type:o.TOGGLE_POPUP}),P(),t.hangup(),(0,A.onForceCallFinish)(t,m,n,g)},onRightsTransfer:function(){if(null!==C){var e=(0,p.getParticipantExternalId)(m.participants[C]);e&&(t.grantRoles(e,[_.UserRole.ADMIN],!1).then((function(){return L()})).catch(console.log),w())}else L()},onSearch:b})}},537817:(e,t,n)=>{"use strict";n.d(t,{TranslationContainer:()=>A});var a=n(667294),r=n(958713),i=n(121255),o=n(50533),l=n(881150),s=n(186983),c=n(445586),u=n(662208),d=n(820717),p=n(674543);function A(){var e,t=(0,o.useSelector)((function(e){return e})),n=(0,o.useDispatch)(),A=a.useContext(u.LangContext).getLang,_=(0,a.useCallback)((function(){n({type:i.TOGGLE_POPUP})}),[]),m=(0,p.canStopTranslation)(t),g=(0,a.useCallback)((function(){n({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_STOP})}),[]),f=(0,a.useCallback)((function(e){if(null==e?void 0:e.upcomingStreamParams){var t=e.upcomingStreamParams,a=t.startTime,r=t.ovId;if(a&&a>Date.now()/1e3+4)return(0,d.startUpcomingStream)(r).finally(_)}var o={isOn:!1,startStreamParams:e};return n({type:i.SET_TRANSLATION,data:o}),n({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_START_COUNTDOWN}),Promise.resolve()}),[]),v=(0,a.useCallback)((function(){n({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_SHARE})}),[]);return(null===(e=t.translation)||void 0===e?void 0:e.isOn)?a.createElement(s.CallManagementModal,{title:A("calls_translation_menu_title"),actionButtons:m?[a.createElement(l.default,{onClick:g,appearance:"negative",key:"stop"},A("calls_translation_menu_stop"))]:[],onCloseModal:_},a.createElement(c.CallManagementMenu,{isLinkBlockShown:!0,linkBlockTitle:A("calls_translation_menu_link"),onLinkBlockClick:v,callUrlLink:t.translation.link})):a.createElement(r.TranslationCreateForm,{onSubmit:f,onClose:_})}},978335:(e,t,n)=>{"use strict";n.d(t,{TranslationShareContainer:()=>c});var a=n(667294),r=n(50533),i=n(121255),o=n(662208),l=n(186983),s=n(162144),c=function(e){var t,n=e.onBack,c=e.link,u=e.linkExtractor,d=(0,r.useDispatch)(),p=a.useContext(o.LangContext).getLang,A=(0,r.useSelector)((function(e){return e.translation})),_=(0,a.useCallback)((function(){d({type:i.TOGGLE_POPUP})}),[]);return a.createElement(l.CallManagementModal,{title:p("calls_translation_link"),onCloseModal:_,isWithBackButton:!!n,onBackClick:n},a.createElement(s.TranslationLink,{link:null!==(t=null==u?void 0:u(A))&&void 0!==t?t:c}))}},350594:(e,t,n)=>{"use strict";n.d(t,{TranslationStartCountdownContainer:()=>d});var a=n(570655),r=n(667294),i=n(121255),o=n(50533),l=n(979414),s=n(874023),c=n(820717),u=n(329538);function d(){var e=(0,o.useDispatch)(),t=(0,o.useSelector)((function(e){return e})),n=(0,a.__read)((0,r.useState)(3),2),d=n[0],p=n[1],A=(0,r.useCallback)((function(){e({type:i.TOGGLE_POPUP})}),[]),_=(0,r.useCallback)((function(){var e,n=null===(e=t.translation)||void 0===e?void 0:e.startTime;n&&n>=Date.now()&&(0,u.stopVideoStream)(),A()}),[]);return(0,r.useEffect)((function(){var e=setInterval((function(){return p(d-1)}),s.SECOND_JS);return function(){return clearInterval(e)}}),[d]),(0,r.useEffect)((function(){var e;if(d<=0){var n=null===(e=t.translation)||void 0===e?void 0:e.startStreamParams;(null==n?void 0:n.streamParams)?(0,c.startCallStream)(n.streamParams):(null==n?void 0:n.upcomingStreamParams)&&(0,c.startUpcomingStream)(n.upcomingStreamParams.ovId),A()}}),[d]),r.createElement(l.TranslationStartCountdownModal,{onCloseModal:A,counter:d,onStopTranslation:_})}},910472:(e,t,n)=>{"use strict";n.d(t,{TranslationStatusContainer:()=>g});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(880076),s=n(52777),c=n(659397),u=n(462480),d=n(923522),p=n(662208),A=n(874023),_=n(329538),m=n(674543);function g(){var e=(0,r.useContext)(p.LangContext),t=e.getLang,n=e.langNumeric,s=(0,i.useSelector)((function(e){return e})),c=(0,i.useDispatch)(),g=(0,a.__read)((0,r.useState)(null),2),S=g[0],y=g[1],N=(0,a.__read)((0,r.useState)(!1),2),T=N[0],I=N[1],P=(0,a.__read)((0,r.useState)(""),2),b=P[0],w=P[1],L=(0,a.__read)((0,r.useState)(0),2),M=L[0],O=L[1],k=(0,a.__read)((0,r.useState)([]),2),D=k[0],R=k[1],B=(0,a.__read)((0,r.useState)(C(s.translation.startTime)),2),G=B[0],x=B[1],H=(0,a.__read)((0,r.useState)(h(G)),2),U=H[0],V=H[1],F=(0,a.__read)((0,r.useState)(""),2),W=F[0],z=F[1],j=(0,a.__read)((0,r.useState)(!1),2),Q=j[0],Y=j[1];return(0,r.useEffect)((function(){var e=(0,m.canStopTranslation)(s);I(e)}),[s.translation,s.participants[s.me]]),(0,r.useEffect)((function(){var e,t;if(null===(e=s.translation.host)||void 0===e?void 0:e.id){var n=s.participants[null===(t=s.translation.host)||void 0===t?void 0:t.id],a=(null==n?void 0:n.shortName)||(null==n?void 0:n.name);a!==S&&y(a)}else S&&y(null)}),[s.translation,s.participants]),(0,r.useEffect)((function(){var e=[];if(T){if(U){var n={text:r.createElement("div",{className:"TranslationStatus__dropdownItemWillStartSoon"},t("calls_info_translation_will_start_soon"))};e.push(n)}e.push(f(r.createElement(u.ShareIcon,null),t("calls_info_translation_share_menu_item"),(function(){return c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_SHARE})}))),e.push(f(r.createElement(d.CancelIcon,null),t("calls_translation_stop_menu_item"),(function(){return c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_STOP})})))}R(e)}),[T,U]),(0,r.useEffect)((function(){var e=h(G);e&&G>-4&&T&&!Q&&(Y(!0),c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_START_COUNTDOWN})),V(e)}),[G]),(0,r.useEffect)((function(){var e=C(s.translation.startTime);x(e);var t=setInterval((function(){return x(C(s.translation.startTime))}),A.SECOND_JS);return function(){return clearInterval(t)}}),[s.translation.startTime]),(0,r.useEffect)((function(){var e="";if(U){var a=Math.abs(G);if(a>A.DAY){var r=Math.floor(a/A.DAY);e=n(r,"calls_translation_upcoming_time_more_day_short",t("calls_translation_upcoming_time_more_day_short",r)).replace("%s",r)}else e=v("-"+E(a))}else e=v(E(G));w(e)}),[G,U]),(0,r.useEffect)((function(){var e,t=s.translation,n=t.ownerId,a=t.videoId;if(n&&a&&!U){var r=function(){var e={owner_id:n,video_id:a};(0,_.videoLiveGetSpectators)(e).then((function(e){var t;O(null===(t=e.spectators)||void 0===t?void 0:t.count)}))};r(),e=setInterval(r,15*A.SECOND_JS)}return function(){return clearInterval(e)}}),[U,s.translation.ownerId,s.translation.videoId]),(0,r.useEffect)((function(){if(!T){var e="";e=U?t("calls_info_translation_will_start_soon"):S?t("calls_translation_host_info").replace("{name}",S):t("calls_translation_host_info_unknown"),z(e)}}),[U,S,T]),r.createElement(l.TranslationStatus,{translationTimer:b,viewersCount:M,isLiveIndicatorOff:U,actions:D,tooltipText:W})}function f(e,t,n){return{text:r.createElement("div",{className:"TranslationStatus__dropdownItem"},e,r.createElement("div",{className:"TranslationStatus__dropdownItemText"},t)),onClick:n}}function v(e){return r.createElement(s.CallTimer,{duration:e})}function E(e){return 0===e?"00:00":e<=599?"0"+(0,c.formatDuration)(e):(0,c.formatDuration)(e)}function h(e){return e<0}function C(e){var t=Date.now();return Math.floor((t-e)/1e3)}},410038:(e,t,n)=>{"use strict";n.d(t,{TranslationStopContainer:()=>u});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(389809),c=n(329538),u=function(){var e=(0,r.useDispatch)(),t=a.useContext(l.LangContext).getLang,n=(0,a.useCallback)((function(){e({type:o.TOGGLE_POPUP})}),[]);return a.createElement(s.TranslationStopModal,{onClose:n,actionButtons:[a.createElement(i.default,{onClick:n,appearance:"secondary",key:"cancel"},t("calls_cancel")),a.createElement(i.default,{onClick:function(){(0,c.stopVideoStream)().then((function(){e({type:o.TOGGLE_POPUP})}))},key:"stop"},t("calls_translation_stop"))]})}},450273:(e,t,n)=>{"use strict";n.d(t,{UnbanParticipantContainer:()=>d});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(697483),c=n(904992),u=function(e){var t=e.name||"";return e.photo?{src:e.photo,alt:t,key:e.peerId}:{id:e.peerId,text:t.slice(0,1)}},d=function(e){var t,n=e.SDK,d=(0,r.useDispatch)(),p=a.useContext(l.LangContext),A=p.getLang,_=p.langNumeric,m=p.langSex,g=(0,r.useSelector)((function(e){return e})),f=g.participants[g.me],v=(0,s.participantIsAdmin)(f),E=null===(t=g.membersUnban)||void 0===t?void 0:t.members,h=(0,a.useCallback)((function(){d({type:o.UNBAN_PARTICIPANTS})}),[]),C=(0,a.useCallback)((function(){null==E||E.forEach((function(e){n.addParticipant(String(e.id),{unban:!0})})),h()}),[g.membersUnban]);if(!E||0===E.length)return a.createElement(a.Fragment,null);var S=null==E?void 0:E.length,y=_(S,"calls_unban_participant_text",A("calls_unban_participant_text",!0)),N="",T=[];if(1===S){var I=E[0];N=m(I.sex,"calls_unban_participant_description_text_one_person",A("calls_unban_participant_description_text_one_person",!0)).replace("{user}",I.name),T.push(u(I))}else{var P=[E[0].name,E[1].name];T=E.slice(0,2).map((function(e){return u(e)}));if(S<=3)3===S&&(P.push(E[2].name),T.push(u(E[2]))),N=A("calls_unban_participant_description_text_two_persons").replace("{users}",P.join(", "));else{var b=S-2;N=_(b,"calls_unban_participant_description_text_more_persons",A("calls_unban_participant_description_text_more_persons",!0)).replace("{users}",P.join(", ")).replace("{users_count}",b),T.push({id:b,text:"+"+b})}}var w=v?[a.createElement(i.default,{onClick:h,appearance:"secondary",key:"cancel"},A("calls_unban_participant_cancel_button_text")),a.createElement(i.default,{onClick:C,key:"stop"},A("calls_unban_participant_ok_button_text"))]:[a.createElement(i.default,{onClick:h,key:"cancel"},A("calls_unban_participant_disallowed_button_text"))];return a.createElement(c.UnbanMembersModal,{onClose:h,description:y,subDescription:N,actionButtons:w,avatarsItems:T})}},927229:(e,t,n)=>{"use strict";n.d(t,{UnmuteRequestContainer:()=>d});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(860925),c=n(169610),u=n(464380),d=function(e){var t=e.SDK,n=(0,r.useDispatch)(),d=a.useContext(l.LangContext).getLang,p=(0,r.useSelector)((function(e){return e})),A=p.participants[p.me],_=A.mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},m=function(){n({type:o.TOGGLE_POPUP})},g=function(){var e=A.mediaSettings;(null==e?void 0:e.isAudioEnabled)||(_.isAudioEnabled?Promise.resolve():(0,c.checkPermissions)(t,[u.MediaOption.AUDIO])).then((function(){var e;(null===(e=p.notification)||void 0===e?void 0:e.type)===o.NotificationType.SPEAKING_ON_MUTE&&n({type:o.CALL_NOTIFICATION,notification:null}),t.toggleLocalAudio(!0).catch(console.log)}))};return a.createElement(s.UnmuteRequestModal,{onClose:m,title:d("calls_dialog_unmute_request_title"),description:d("calls_dialog_unmute_request_description"),actionButtons:[a.createElement(i.default,{onClick:function(){g(),m()},appearance:"secondary",key:"mic"},d("calls_dialog_unmute_request_mic_only_action")),a.createElement(i.default,{onClick:function(){var e;g(),(null==(e=A.mediaSettings)?void 0:e.isVideoEnabled)||(null==e?void 0:e.isScreenSharingEnabled)||(!_.isVideoEnabled||_.isScreenSharingEnabled?(0,c.checkPermissions)(t,[u.MediaOption.VIDEO]):Promise.resolve()).then((function(){t.toggleLocalVideo(!0).catch(console.log)})),m()},key:"all"},d("calls_dialog_unmute_request_action"))]})}},699637:(e,t,n)=>{"use strict";n.d(t,{WaitingContainer:()=>o});var a=n(667294),r=n(50533),i=n(706885);function o(){return(0,r.useSelector)((function(e){return e})).isLoaderVisible?a.createElement(i.default,null):null}},637880:(e,t,n)=>{"use strict";n.d(t,{WaitingHallContainer:()=>v});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(492512),s=n(269481),c=n(169610),u=n(690015),d=n(697483),p=n(662208),A=n(498110),_=n(774351),m=n(100741),g=n(464380),f=n(51443);function v(e){var t,n=e.SDK,v=e.navigateToConvo,E=(0,i.useSelector)((function(e){return e})),h=(0,i.useDispatch)(),C=(0,r.useContext)(p.LangContext).getLang,S=(0,r.useContext)(A.ConfigContext),y=S.isModalView,N=S.enableScreenTrack,T=E.peer,I=E.participants[E.me].mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},P=(0,r.useMemo)((function(){return(0,d.getActiveParticipants)(E.participants,E.me,E.groupId,E.meGroup)}),[E.participants,E.me,E.groupId,E.meGroup]),b=E.uiMode===o.UIMode.FULLSCREEN,w=(0,a.__read)((0,r.useState)(!1),2),L=w[0],M=w[1],O=(0,a.__read)((0,r.useState)(!1),2),k=O[0],D=O[1],R=function(e){return h({type:o.CHANGE_UI_MODE,mode:e})},B=(0,r.useCallback)((function(){y&&(E.uiMode===o.UIMode.FULLSCREEN?((0,_.pause)(.3,null).then((function(){R(o.UIMode.COLLAPSED)})),R(o.UIMode.DEFAULT)):R(o.UIMode.COLLAPSED))}),[E.uiMode]),G=(0,r.useCallback)((function(){if(!L){var e=!I.isAudioEnabled;(e?(0,c.checkPermissions)(n,[g.MediaOption.AUDIO]):Promise.resolve()).then((function(){var t;M(!0),(null===(t=E.notification)||void 0===t?void 0:t.type)===o.NotificationType.SPEAKING_ON_MUTE&&h({type:o.CALL_NOTIFICATION,notification:null}),n.toggleLocalAudio(e).finally((function(){M(!1)}))}))}}),[I,L]),x=(0,r.useCallback)((function(){if(!k){var e=!I.isVideoEnabled||I.isScreenSharingEnabled&&!N;(e?(0,c.checkPermissions)(n,[g.MediaOption.VIDEO]):Promise.resolve()).then((function(){D(!0),N||I.isScreenSharingEnabled&&n.captureScreen(!1),n.toggleLocalVideo(e).finally((function(){D(!1)}))}))}}),[I,k]),H=(0,r.useCallback)((function(){B(),v(E.peer)}),[E.peer,E.uiMode]),U=(0,r.useCallback)((function(){n.hangup()}),[E.callData.callId,E.peer,P]),V=(0,r.useCallback)((function(){h({type:o.CHANGE_UI_MODE,mode:b?o.UIMode.DEFAULT:o.UIMode.FULLSCREEN}),h({type:o.SET_TOOLTIP,tooltips:null})}),[E.uiMode]),F=(0,r.useCallback)((function(e,t){var n;h({type:o.SET_TOOLTIP,tooltips:(n={},n[e]=t,n)})}),[]),W=(0,r.useCallback)((function(){h({type:o.SET_TOOLTIP,tooltips:null})}),[]);(0,r.useEffect)((function(){return function(){h({type:o.SET_TOOLTIP,tooltips:null})}}),[]);var z=(0,r.useMemo)((function(){var e;return r.createElement(u.CallNotificationContainer,{dispatch:h,notification:E.notification,participant:E.participants[null===(e=E.notification)||void 0===e?void 0:e.data]})}),[E.notification,E.participants[null===(t=E.notification)||void 0===t?void 0:t.data]]),j=E.hangupType===o.HANGUP_TYPE_REMOVED?C("calls_waiting_hall_removed"):C("calls_waiting_hall_info");return r.createElement(s.CallModal,{onClose:U,onBackdropClick:B},r.createElement(l.Call,{info:null,isVideoAllowed:!0,isAudioAllowed:!0,isVideoEnabled:I.isVideoEnabled,isAudioEnabled:I.isAudioEnabled,isFullScreen:b,onToggleAudio:G,onToggleVideo:x,onLeaveCall:U,onCollapseCall:y?B:null,onFullScreenToggle:V,onTooltipChange:F,onHidePanel:W,onChat:H,isChatControlShown:!!T&&!E.groupId,chatUnreadCount:E.chatUnreadCount,notification:z,tooltips:E.tooltips,amISpeaking:!!E.speakers[E.me],waitingHallNotification:null,withoutPadding:!0},r.createElement(r.Fragment,null,I.isVideoEnabled&&r.createElement(m.WaitingHall,(0,a.__assign)({},function(e,t){var n,a=e[t],r=a.mediaSettings,i=(0,d.isParticipantWithVideo)(a),o=(0,d.getStream)(a);return{id:t,name:"",letter:null===(n=a.name)||void 0===n?void 0:n.slice(0,1),hasAudio:!!(null==r?void 0:r.isAudioEnabled),hasVideo:i,stream:o,wasConnected:!!a.wasConnected}}(E.participants,E.me))),r.createElement(f.WaitingHallInfo,{text:j}))))}},564840:(e,t,n)=>{"use strict";n.d(t,{WaitingHallListContainer:()=>m});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(662208),s=n(428990),c=n(956462),u=n(719481),d=n(186983),p=n(736434),A=n(431469),_=n(884143),m=function(e){var t,n,m,f,v,E=e.isModal,h=e.onMore,C=e.navigateToProfile,S=e.isWithBackButton,y=e.onBackClick,N=S?y:function(){},T=(0,i.useSelector)((function(e){return e})),I=(0,i.useDispatch)(),P=r.useContext(l.LangContext).getLang,b=(0,a.__read)((0,r.useState)(g(T,E)),2),w=b[0],L=b[1],M=(0,a.__read)((0,r.useState)(""),2),O=M[0],k=M[1],D=T.waitingHall?Array.from(null===(t=T.waitingHall)||void 0===t?void 0:t.members.values()):[],R=(0,r.useCallback)((function(e){return e.name}),[]),B=(0,r.useCallback)((function(e){return e.peerId}),[]),G=(0,A.useIndexer)(E?D:[],R,B),x=(0,r.useCallback)((function(e){k(e.target.value)}),[]),H=E?D:D.slice(0,5);O&&(H=G.search(O)),(0,r.useEffect)((function(){L(g(T,E))}),[null===(n=T.waitingHall)||void 0===n?void 0:n.totalCount]);var U=(0,r.useCallback)((function(e){var t,n=null===(t=T.waitingHall)||void 0===t?void 0:t.members.get(e);n&&I({type:o.TOGGLE_PARTICIPANTS_KICK,data:{type:o.KickParticipantType.WAITING_HALL,participant:n}})}),[null===(m=T.waitingHall)||void 0===m?void 0:m.members]),V=(0,r.useCallback)((function(e){T.waitingHall&&(0,u.promoteUserAndRemoveFromWaitingHall)(e,T.waitingHall,I)}),[null===(f=T.waitingHall)||void 0===f?void 0:f.members]),F=(0,r.useCallback)((function(){h&&h()}),[T.waitingHall]),W=r.createElement(r.Fragment,null,r.createElement(s.WaitingHallList,{members:H,totalCount:null===(v=T.waitingHall)||void 0===v?void 0:v.totalCount,navigateToProfile:C,onPromote:V,onForbid:U}),w&&r.createElement(c.ListMore,{onClick:F},P("calls_waiting_hall_more_text")));return E?r.createElement(d.CallManagementModal,{title:P("calls_waiting_hall_title"),onCloseModal:function(){I({type:o.GROUP_CALL_SETUP,open:!1,preselectedIds:null}),I({type:o.MANAGEMENT,isOpen:!1})},isWithBackButton:S,onBackClick:N},r.createElement("div",{className:"CallParticipantList"},D.length>0&&r.createElement(r.Fragment,null,r.createElement(p.BlockSearchInput,{value:O,placeholder:P("calls_search_participants_placeholder"),onChange:x,onInput:x,onPaste:x,className:"CallParticipantList__input"}),W,O&&0===H.length&&r.createElement(_.default,null,P("calls_participants_not_found"))),0===D.length&&r.createElement(_.default,null,P("calls_waiting_hall_not_users")))):W};function g(e,t){if(t)return!1;var n=e.waitingHall;return!!n&&n.totalCount>5}},498110:(e,t,n)=>{"use strict";n.d(t,{ConfigContext:()=>i});var a=n(667294),r=n(121255),i=a.createContext({isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,incomingCall:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:r.VIDEO_SLOTS_COUNT,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,sferum:!1})},662208:(e,t,n)=>{"use strict";n.d(t,{LangContext:()=>a});var a=n(667294).createContext({getLang:function(e){return e},langSex:function(e,t){return t},langNumeric:function(e,t){return""+t},langShortDateTime:function(e){return""+e}})},641196:(e,t,n)=>{"use strict";n.d(t,{setApiWrappers:()=>i,getApiWrapper:()=>o});var a=null,r=null,i=function(e,t){a=e,r=t},o=function(e){return void 0===e&&(e=!0),e?a:r}},483379:(e,t,n)=>{"use strict";n.d(t,{browser:()=>r});var a=navigator.userAgent.toLowerCase(),r={version:(a.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:!/chrome/i.test(a)&&/webkit|safari|khtml/i.test(a)}},745284:(e,t,n)=>{"use strict";n.d(t,{isGroupCallByPeer:()=>o,isActiveGroupCallMessage:()=>l,isRequireAuthToJoin:()=>s,isWaitingHallEnabled:()=>c,getDefaultConversation:()=>u,isAuthedByGroupId:()=>d,getMediaOptions:()=>p,isIAmSpeaking:()=>A});var a=n(389953),r=n(121255),i=n(464380),o=function(e){return 0===e||(0,a.isChatPeer)(e)||null===e};function l(e){return e&&e.attaches&&e.attaches[0]&&"group_call_in_progress"===e.attaches[0].type}function s(e){return e.conversationOptions.includes(i.ConversationOption.REQUIRE_AUTH_TO_JOIN)}function c(e){return e.conversationOptions.includes(i.ConversationOption.WAITING_HALL)}function u(e){return{peerId:0,canAddMembers:!0,tab:e("calls_new_call_title"),photo:r.DEFAULT_GROUP_CALL_PHOTO}}function d(e){return!!e.groupId}function p(e){var t=e.audio,n=e.video,a=[];return t&&a.push(i.MediaOption.AUDIO),n&&a.push(i.MediaOption.VIDEO),a}function A(e){return!!e.speakers[e.me]}},874023:(e,t,n)=>{"use strict";n.d(t,{DAY:()=>a,WEEK:()=>r,SECOND_JS:()=>i});var a=86400,r=7*a,i=1e3},767497:(e,t,n)=>{"use strict";n.d(t,{generateStartCallsDeepLink:()=>r,generateJoinCallsDeepLink:()=>i});var a=n(121255),r=function(e){var t=e.peerId,n=e.userId,r=""+a.DESKTOP_CALLS_SCHEME+a.DESKTOP_CALLS_HOST+"/start?peerId="+t+"&userId="+n;return console.log("deeplink: ",r),r},i=function(e){var t=e.joinLink,n=e.userId;return""+a.DESKTOP_CALLS_SCHEME+a.DESKTOP_CALLS_HOST+"/join?joinLink="+t+"&userId="+n}},307915:(e,t,n)=>{"use strict";n.d(t,{getPermissionsErrorMessage:()=>r,getMediaErrorMessage:()=>i});var a=n(121255);function r(e,t,n){void 0===t&&(t=!0);var a="";return e&&t?a=n("calls_error_no_cam_and_mic"):e?a=n("calls_error_no_cam"):t&&(a=n("calls_error_no_mic")),a}function i(e,t){var n;return((n={})[a.MediaError.CAMERA_PERMISSION]=t("calls_error_no_cam"),n[a.MediaError.MIC_PERMISSION]=t("calls_error_no_mic"),n[a.MediaError.CAMERA_ACCESS]=t("calls_error_cameralock"),n[a.MediaError.MIC_ACCESS]=t("calls_error_miclock"),n[a.MediaError.MIC_NOT_FOUND]=t("calls_error_nomic"),n[a.MediaError.SCREEN_PERMISSION]=t("calls_error_screenpermission"),n[a.MediaError.SCREEN_ACCESS]=t("calls_error_screenlock"),n)[e]}},153907:(e,t,n)=>{"use strict";n.d(t,{download:()=>a});var a=function(e,t){var n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),n.remove()}},298811:(e,t,n)=>{"use strict";n.d(t,{fetchUserShortName:()=>_,convertClientData:()=>m,convertServerData:()=>g,convertCallerFromLongpoll:()=>f,convertChatFromLongpoll:()=>v,getPeerIdFromLongpoll:()=>E,isGroupCallEvent:()=>h,isAnyoneWithVideo:()=>C,calculateCallDuration:()=>S,getTextForApiErrorByCode:()=>y,getTextForServerError:()=>N,getTextForClientError:()=>T,createPayload:()=>I,isInReconnect:()=>P,compose:()=>b,exponentialRetry:()=>w,startCallRetryWrapper:()=>L,getParticipantsListLabel:()=>M,unpackState:()=>O,normalizePreviewData:()=>k});var a=n(570655),r=n(389953),i=n(745284),o=n(121255),l=n(774351),s=n(659397),c=n(788822),u=n(613335),d=n(464380),p=n(697483);function A(e){var t,n=e.shortName,r=e.firstName;e.lastName;return n&&r||(n=_(r=(t=(0,a.__read)(e.name.split(" "),2))[0],t[1],e.name)),(0,a.__assign)((0,a.__assign)({},e),{peerId:+e.id,tab:e.name,shortName:n,firstName:r})}function _(e,t,n){if(e){var a=t?t.length>2?t.substring(0,1)+".":t:"";return a?e+" "+a:e}return n}function m(e){var t=(0,a.__read)(e,2),n=t[0],r=t[1],i=n&&function(e){var t=e.callInProgress,n=void 0!==t&&t,r=(0,a.__rest)(e,["callInProgress"]);return!r.call_in_progress&&n&&(r.call_in_progress=n),r}(n);return[i&&("peerId"in i?i:A(i)),r?r.map(A):[]]}function g(e){var t,n=e.items,i=e.profiles,o=(0,a.__read)(n,1)[0],l=function(e){if(e.chat_settings){var t={peerId:e.peer.id,tab:e.chat_settings.title,name:e.chat_settings.title,canAddMembers:e.chat_settings.acl.can_invite,adminIds:e.chat_settings.admin_ids,ownerId:e.chat_settings.owner_id||-1};return e.chat_settings.photo&&(t.photo=e.chat_settings.photo.photo_100),t}return{canAddMembers:!0,peerId:e.peer.id}}(o),s=function(e){return e.map(u.normalizeUser)}(i);return[(0,a.__assign)((0,a.__assign)({},l),{tab:l.name}),(0,r.isUserPeer)(null!==(t=l.peerId)&&void 0!==t?t:0)?[(0,a.__assign)((0,a.__assign)({},s&&s.filter((function(e){return e.peerId===l.peerId}))[0]),l)]:s,o]}function f(e){var t=e.caller_info,n=t.first_name+" "+t.last_name;return{peerId:+t.user_id,name:n,tab:n,photo:t.photo_400,firstName:t.first_name,lastName:t.last_name,shortName:_(t.first_name,t.last_name,n)}}function v(e){var t=e.chat_info;return{peerId:2e9+t.chat_id,tab:t.title,name:t.title,photo:t.photo_400}}function E(e){var t=e.caller_info,n=e.chat_info;return n?2e9+n.chat_id:t.user_id}function h(e){return!!e.payload.chat_info}function C(e){return!!Object.values(e.participants).find((function(t){return(t.peerId===e.me||t.wasConnected)&&t.mediaSettings&&(0,p.isParticipantWithVideo)(t)}))}function S(e){var t=Date.now(),n=Math.max(0,Math.floor((t-e)/1e3));return 0===n?"00:00":n<=599?"0"+(0,s.formatDuration)(n):(0,s.formatDuration)(n)}function y(e,t,n){switch(+e){case o.SERVER_ERROR_MESSAGES_CALL_JOIN_NOT_ALLOWED:return n("calls_join_error_require_access");case o.SERVER_ERROR_MESSAGES_CALL_NOT_FOUND:return n("calls_join_error_text");case o.SERVER_ERROR_PRIVACY:return n("calls_privacy_error");case o.SERVER_ERROR_BUSY:return n(t?"calls_chat_busy_error":"calls_busy_error");case o.SERVER_ERROR_FLOOD_CONTROL:return n("calls_flood_error");case o.SERVER_ERROR_REQUIRE_AUTH:return n("calls_join_error_require_auth");case o.SERVER_ERROR_UNKNOWN:case o.SERVER_ERROR_INVALID_REQUEST:case o.SERVER_ERROR_INTERNAL:case o.SERVER_ERROR_OLD_RECEIVER_APP:default:return n("calls_start_error")}}function N(e,t,n){var a,r,i=0===e.search("EXTERNAL_API_ERROR"),l=e.match(/\d+/g),s=l?Number(null===(a=e.match(/\d+/g))||void 0===a?void 0:a[1]):o.CLIENT_ERROR_UNKNOWN,c=l?Number(null===(r=e.match(/\d+/g))||void 0===r?void 0:r[0]):o.CLIENT_ERROR_UNKNOWN;if(!i||Number.isNaN(s)){switch(c){case o.SDK_ERROR_AUTH:return n("calls_start_error_auth")}return function(e,t,n){switch(!0){case-1!==e.search("error.webrtc.auth.required"):return n("calls_join_error_require_auth");case-1!==e.search("error.webrtc.auth.banned"):case-1!==e.search("error.webrtc.participant.check.privacy"):return n("calls_join_error_banned");case-1!==e.search("error.webrtc.participant.check.killed_call"):return n("calls_join_error_killed_call");case-1!==e.search("not.found.webrtc.conversation"):return n("calls_join_error_not_found_conversation");default:return n("calls_start_error")}}(e,0,n)}switch(e){case d.HangupType.CANCELED:return n("calls_hangup_error_canceled");case d.HangupType.REJECTED:return n("calls_hangup_error_rejected");case d.HangupType.REMOVED:return n("calls_hangup_error_removed");case d.HangupType.HUNGUP:return n("calls_hangup_error_hangup");case d.HangupType.MISSED:return n("calls_hangup_error_missed");case d.HangupType.BUSY:return n("calls_hangup_error_busy");case d.HangupType.FAILED:return n("calls_hangup_error_failed");case d.HangupType.NETWORK_ERROR:return n("calls_hangup_error_network_error");case d.HangupType.CALLER_IS_BLOCKED:return n("calls_hangup_error_caller_is_blocked");case d.HangupType.NOT_FRIENDS:return n("calls_hangup_error_not_friends");case d.HangupType.CALLEE_IS_OFFLINE:return n("calls_hangup_error_callee_is_offline");case d.HangupType.UNKNOWN_ERROR:return n("calls_hangup_error_unknown_error");case d.HangupType.UNSUPPORTED:return n("calls_hangup_error_unsupported");case d.HangupType.OLD_VERSION:return n("calls_hangup_error_old_version");case d.HangupType.SERVICE_DISABLED:return n("calls_hangup_error_service_disabled");case d.HangupType.EXTERNAL_API_ERROR:return n("calls_hangup_error_external_api_error");case d.HangupType.SOCKET_CLOSED:return n("calls_hangup_error_socket_closed")}return y(+s,t,n)}function T(e,t,n){return n("calls_sorry_error")}function I(e,t){return JSON.stringify({is_video:t.includes(d.MediaOption.VIDEO),chat_id:(0,r.isChatPeer)(e)?e-2e9:void 0,with_join_link:(0,i.isGroupCallByPeer)(e),join_by_link:(0,i.isGroupCallByPeer)(e)})}function P(e){return!!Object.values(e.participants).find((function(e){return e.status===d.ParticipantStatus.RECONNECT}))}var b=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.reduce((function(e,t){return t(e)}),e).apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))}};function w(e,t){return void 0===t&&(t={attempts:10,timeout:0}),function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.attempts>0?(0,l.pause)(t.timeout,null).then((function(){return e.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))})).catch((function(r){return!t.timeout&&(t.timeout=1),t.attempts=r.type===o.SdkErrorType.API?0:t.attempts-1,t.timeout=Math.min(2*t.timeout,300),w(e,t).apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))})):Promise.reject(o.CallErrorType.CANT_REACH_API)}}var L=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n))).catch((function(r){if(r.error===o.FatalError.AUTH)return e().then((function(){return t.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))}));throw r}))}};function M(e,t,n,a,r,i,o){void 0===i&&(i=0),void 0===o&&(o=3);var l=function(e){return(0,c.decodeHTMLEntities)(n(e)||"")};if(0===i&&e.length>0&&(i=e.length),i>t.length){var s=i-t.length,u=e.slice(0,o).map(l).join(", ");return r(s,"calls_members_list_label",a("calls_members_list_label",s)).replace("{name}",u)}if(t.length>1){var d=t.length>2?e.slice(0,2).map(l).join(", "):l(e[0]),p=l(e[t.length-1]);return a("calls_and").replace("{before}",d).replace("{after}",p)}return 1===t.length?l(e[0]):""}function O(e){return"current"in e?e.current:e}function k(e,t){var n=t.join_link,r=t.preview,i=t.profiles,o=t.anonyms,l=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(o)),(0,a.__read)(i)).map(u.normalizeUser);return{joinLink:n,title:r.title,membersCount:r.members_count,photo_100:r.photo.photo_100,photo_200:r.photo.photo_200,members:l,conversationData:{peerId:0,canAddMembers:!0,tab:e("calls_new_call_title"),photo:"https://vk.com/images/call_convo_stub.png"}}}},697483:(e,t,n)=>{"use strict";n.d(t,{isParticipantAnonym:()=>c,isParticipantGroup:()=>u,getParticipantExternalId:()=>d,getParticipantActions:()=>A,isParticipantInCall:()=>_,isParticipantUnavailableToCallFromGroup:()=>m,getCallVisibleParticipant:()=>g,getActiveParticipants:()=>v,getActiveParticipantsCount:()=>E,getNonAnonymousConnectParticipantsCount:()=>h,getConnectedAdminsCount:()=>C,canPinParticipants:()=>T,isAdmin:()=>I,isCreator:()=>P,canMuteParticipants:()=>b,getRaisedHands:()=>L,kickParticipant:()=>M,participantIsChatAdmin:()=>O,participantIsAdmin:()=>k,isMutedPermanently:()=>D,getMeId:()=>R,getStream:()=>B,isParticipantWithVideo:()=>G,getOrator:()=>x});var a=n(570655),r=n(121255),i=n(745284),o=n(464380),l=n(614914),s=n(613335),c=function(e){return e>-19e8&&e<-189e7},u=function(e){return e<0&&e>-1e9},d=function(e){return(null==e?void 0:e.peerId)?c(e.peerId)?e.peerId.toString():{id:e.peerId.toString(),type:o.ExternalIdType.USER}:null},p={},A=function(e,t,n,a,s,A,_,m,g){void 0===g&&(g=!1);var f=a.peerId===e.me,v=c(a.peerId),E=(0,i.isGroupCallByPeer)(e.peer),h=e.participants[e.me],C=!!e.groupId,S=[],y=[],L=e.config.isModalView,M=u(a.peerId);if(f||!s||v||void 0===m||S.push({text:A(M?"calls_go_to_community":"calls_go_to_profile"),onClick:function(e){m(e,a.link)}}),f||v||c(e.me)||void 0===_||C||S.push({text:A(M?"calls_go_to_chat_with_community":"calls_go_to_chat_with_participant"),onClick:function(){L&&n({type:r.CHANGE_UI_MODE,mode:r.UIMode.COLLAPSED}),n({type:r.MANAGEMENT,isOpen:!1}),_(a.peerId)}}),!f&&E&&!c(e.me)&&function(e){return k(e)}(h)&&!P(a)){var O={negative:!0,text:A("calls_participant_menu_kick"),onClick:function(){n({type:r.TOGGLE_PARTICIPANTS_KICK,data:{type:r.KickParticipantType.CALL,participant:a}})}};g?y.push(O):S.push(O)}if(!f&&E&&!c(e.me)&&b(h)&&S.push({text:A("calls_participant_menu_mute_audio_video"),onClick:function(){n({type:r.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:r.ParticipantsManagementMode.SINGLE,participant:a}})}}),f||E||c(e.me)||!b(h)||S.push({text:A("calls_participant_menu_mute"),onClick:function(){var e=d(a);e&&t.muteParticipant(e,[o.MediaOption.AUDIO],!1).catch(console.log)}}),f||!E||c(e.me)||!b(e.participants[e.me])||function(e){if(!e.mediaSettings)return!1;var t=e.mediaSettings,n=t.isAudioEnabled,a=t.isVideoEnabled,r=t.isScreenSharingEnabled;return n&&(a||r)}(a)||S.push({text:A("calls_participant_menu_enable_media_request"),onClick:function(){t.unmuteRequest(d(a),[o.MediaOption.AUDIO,o.MediaOption.VIDEO,o.MediaOption.SCREEN_SHARING]).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ASK_USER_TO_UNMUTE,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)})}}),f||!E||c(e.me)||c(a.peerId)||!w(e.participants[e.me])||I(a)||P(a)||a.status!==o.ParticipantStatus.CONNECTED||S.push({text:A("calls_participant_menu_assign_admin_role"),onClick:function(){n({type:r.TOGGLE_ADMIN_ASSIGNMENT,data:{participant:a}})}}),!f&&E&&!c(e.me)&&w(e.participants[e.me])&&I(a)&&S.push({text:A("calls_participant_menu_revoke_admin_role"),onClick:function(){var s=d(a);s&&(t.grantRoles(s,[o.UserRole.ADMIN],!0).then((function(){n({type:r.CHANGE_PARTICIPANT_ROLES,participantId:a.peerId,data:a.roles.filter((function(e){return e!==o.UserRole.ADMIN}))})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.RETRIEVE_ADMIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),E&&!c(e.me)&&T(e.participants[e.me])&&!N(e,a)&&S.push({text:A("calls_participant_menu_pin"),onClick:function(){var o=d(a);o&&(t.pinParticipant(o,!1).then((function(){n({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:a.peerId}),n({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ADMIN_PIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),E&&!c(e.me)&&T(e.participants[e.me])&&N(e,a)&&S.push({text:A("calls_participant_menu_pin_cancel"),onClick:function(){var o=d(a);o&&(t.pinParticipant(o,!0).then((function(){n({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:null})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ADMIN_UNPIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),g&&y.length>0&&(S.push({separator:!0}),S=S.concat(y)),p[a.peerId]){var D=S.length===p[a.peerId].length;if(D)for(var R=0;R<S.length;R++)S[R].text!==p[a.peerId].text&&(D=!1);D?S=p[a.peerId]:p[a.peerId]=S}else p[a.peerId]=S;return S},_=function(e,t){var n=e.participants[t];return n&&(n.peerId===e.me||!!n.status)},m=function(e,t){return!!e.unableToCallGroupMembersIds&&e.unableToCallGroupMembersIds.indexOf(t)>-1};function g(e,t){var n,r,o=(0,i.isGroupCallByPeer)(e.peer)?e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator:e.peer;if(o)return e.participants[o];var l=e.participants[e.me];try{for(var s=(0,a.__values)(Object.values(e.participants)),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.peerId!==e.me&&u.wasConnected&&(l||(l=u),!t||G(u)))return u}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return null!=l?l:e.participants[e.me]}var f=[];function v(e,t,n,r,i){var o,l,c,u,d,p=[],A=[],_=[],m=[],g=[],v=[];try{for(var E=(0,a.__values)(Object.values(e)),h=E.next();!h.done;h=E.next()){var C=h.value;C.status&&((null===(c=C.statusData)||void 0===c?void 0:c.hand)?p.push(C):C.peerId===i?A.push(C):C.peerId===t?_.push(n&&r?(0,s.mergeGroupToParticipant)(r,e[t]):e[t]):(null===(u=C.mediaSettings)||void 0===u?void 0:u.isScreenSharingEnabled)?m.push(C):(null===(d=C.mediaSettings)||void 0===d?void 0:d.isVideoEnabled)?g.push(C):v.push(C))}}catch(e){o={error:e}}finally{try{h&&!h.done&&(l=E.return)&&l.call(E)}finally{if(o)throw o.error}}var S=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(p)),(0,a.__read)(A)),(0,a.__read)(_)),(0,a.__read)(m)),(0,a.__read)(g)),(0,a.__read)(v));if(S.length!==f.length)f=S;else for(var y=0;y<S.length;y++)if(S[y]!==f[y]){f=S;break}return f}function E(e){var t=e.participants,n=0;for(var a in t)t.hasOwnProperty(a)&&y(e,t[a])&&n++;return n}function h(e){return S(e).filter((function(e){return!c(e.peerId)})).length}function C(e){return S(e).filter((function(e){return I(e)||P(e)})).length}function S(e){return Object.values(e.participants).filter((function(e){return e.status===o.ParticipantStatus.CONNECTED})).concat(e.participants[e.me])}function y(e,t){return t.peerId===e.me||t.status}function N(e,t){return e.adminPinnedParticipant===t.peerId}function T(e){return I(e)||P(e)}function I(e){return!!(null==e?void 0:e.roles)&&e.roles.some((function(e){return e===o.UserRole.ADMIN}))}function P(e){return!!(null==e?void 0:e.roles)&&e.roles.some((function(e){return e===o.UserRole.CREATOR}))}function b(e){return!!e.roles&&(P(e)||I(e))}function w(e){return!!e.roles&&(P(e)||I(e))}function L(e){var t,n,a=e.participants,r=0;for(var i in a)a.hasOwnProperty(i)&&y(e,a[i])&&(null===(n=null===(t=a[i])||void 0===t?void 0:t.statusData)||void 0===n?void 0:n.hand)&&r++;return r}function M(e,t){void 0===t&&(t=!1);var n=d(e);return n?(0,o.removeParticipant)(n,t):Promise.resolve()}function O(e,t){if(!t)return!1;var n=null==e?void 0:e.peerId;return!!n&&(n===t.ownerId||!!t.adminIds&&t.adminIds.includes(n))}function k(e){return I(e)||P(e)}function D(e){var t=e.permissions||{};return[t.audio,t.video,t.screenSharing].some((function(e){return e===r.MediaPermissionType.DENY}))}function R(e){return(0,i.isAuthedByGroupId)(e)?e.groupId:e.me}function B(e,t){return void 0===t&&(t=!1),t?e.stream:e.screenSharingStream?e.screenSharingStream:e.stream}function G(e){var t;return!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isVideoEnabled)||function(e){var t;return!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isScreenSharingEnabled)&&!!e.screenSharingStream}(e)}function x(e){var t;return null!==(t=e.participants[e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me])&&void 0!==t?t:{}}},757054:(e,t,n)=>{"use strict";n.d(t,{getParticipantLayout:()=>c,getParticipantsLayoutDiff:()=>u});var a,r=n(121255),i=n(298811),o=n(464380),l=n(697483),s=n(745284);!function(e){e.CONTAIN="cn",e.COVER="cv"}(a||(a={}));function c(e,t,n){return(0,s.isGroupCallByPeer)(e.peer)?e.uiMode===r.UIMode.COLLAPSED?function(e){var t=(0,i.isAnyoneWithVideo)(e),n=(0,l.getCallVisibleParticipant)(e,t),a=(0,l.getActiveParticipants)(e.participants,e.me,e.groupId,e.meGroup),r=e.config,s=r.enableScreenTrack,c=r.enableProducerScreenTrack;return a.reduce((function(e,t){var a=t.peerId,r=t.mediaSettings;if(s||c){var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),l=Boolean(null==r?void 0:r.isVideoEnabled),u=a===(null==n?void 0:n.peerId);u&&i&&(e.set(f(a,o.MediaType.SCREEN),p(n,o.MediaType.SCREEN)),e.set(f(a,o.MediaType.CAMERA),d(t,o.MediaType.CAMERA))),u&&!i&&l&&(e.set(f(a,o.MediaType.CAMERA),p(n,o.MediaType.CAMERA)),e.set(f(a,o.MediaType.SCREEN),d(t,o.MediaType.SCREEN))),u&&(i||l)||(e.set(f(a,o.MediaType.SCREEN),d(t,o.MediaType.SCREEN)),e.set(f(a,o.MediaType.CAMERA),d(t,o.MediaType.CAMERA)))}else a===(null==n?void 0:n.peerId)&&g(r)?e.set(a,p(n)):e.set(a,d(t));return e}),new Map)}(e):e.isOratorMode?function(e,t,n){var a,i,s,c,u=e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me,p=(0,l.getActiveParticipants)(e.participants,e.me,e.groupId,e.meGroup),A=0,v=e.config,E=v.enableScreenTrack,h=v.enableProducerScreenTrack;if(E||h){var C=new Map,S=Boolean(null===(i=null===(a=e.participants[u])||void 0===a?void 0:a.mediaSettings)||void 0===i?void 0:i.isScreenSharingEnabled),y=Boolean(null===(c=null===(s=e.participants[u])||void 0===s?void 0:s.mediaSettings)||void 0===c?void 0:c.isVideoEnabled),N=e.uiMode===r.UIMode.FULLSCREEN;return S&&(A++,C.set(f(u,o.MediaType.SCREEN),_(e.participants[u],N,!1,t,n,o.MediaType.SCREEN))),S&&y&&(A++,C.set(f(u,o.MediaType.CAMERA),m(e.participants[u],o.MediaType.CAMERA))),S&&!y&&C.set(f(u,o.MediaType.CAMERA),d(e.participants[u],o.MediaType.CAMERA)),!S&&y&&(A++,C.set(f(u,o.MediaType.CAMERA),_(e.participants[u],N,!1,t,n,o.MediaType.CAMERA)),C.set(f(u,o.MediaType.SCREEN),d(e.participants[u],o.MediaType.SCREEN))),S||y||(C.set(f(u,o.MediaType.CAMERA),d(e.participants[u],o.MediaType.CAMERA)),C.set(f(u,o.MediaType.SCREEN),d(e.participants[u],o.MediaType.SCREEN))),p.reduce((function(t,n){var a=n.peerId,r=n.mediaSettings;if(a===e.me||a===u)return t;var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),l=Boolean(null==r?void 0:r.isVideoEnabled),s=n.visible&&A<=e.config.videoSlotsCount;return s&&l&&(A++,t.set(f(a,o.MediaType.CAMERA),m(n,o.MediaType.CAMERA)),t.set(f(a,o.MediaType.SCREEN),d(n,o.MediaType.SCREEN))),s&&!l&&i&&(A++,t.set(f(a,o.MediaType.SCREEN),m(n,o.MediaType.SCREEN)),t.set(f(a,o.MediaType.CAMERA),d(n,o.MediaType.CAMERA))),s&&(l||i)||(t.set(f(a,o.MediaType.SCREEN),d(n,o.MediaType.SCREEN)),t.set(f(a,o.MediaType.CAMERA),d(n,o.MediaType.CAMERA))),t}),C),C}return p.reduce((function(a,i){var o=i.peerId,l=i.mediaSettings;if(o===e.me)return a;if(u===o&&g(l)){var s=_(i,e.uiMode===r.UIMode.FULLSCREEN,!1,t,n);a.set(i.peerId,s)}else g(l)&&i.visible&&A<=e.config.videoSlotsCount?(A++,a.set(i.peerId,m(i))):a.set(i.peerId,d(i));return a}),new Map)}(e,t,n):function(e,t,n){var a=e.uiMode===r.UIMode.FULLSCREEN,i=a?t:900,s=a?n:504,c=(0,l.getActiveParticipants)(e.participants,e.me,e.groupId,e.meGroup),u=function(e,t,n){switch(n){case 1:return t;case 2:return Math.round(e/2);case 3:return Math.round(e/3);case 4:case 5:case 6:return Math.round(t/2);case 7:case 8:return Math.round(e/4);case 9:case 10:return Math.round(e/5);case 11:case 12:case 13:case 14:case 15:return Math.round(t/3);default:return Math.round(e/6)}}(i,s,c.length),p=u<200?1:2,_=0,m=e.config,v=m.enableScreenTrack,E=m.enableProducerScreenTrack;return c.reduce((function(t,n){if(!(0,l.getParticipantExternalId)(n)||n.peerId===e.me)return t;var a=n.peerId,r=n.mediaSettings;if(v||E){var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),s=Boolean(null==r?void 0:r.isVideoEnabled),c=n.visible&&_<=e.config.videoSlotsCount;return c&&i&&(_++,t.set(f(a,o.MediaType.SCREEN),A(n,u,p,o.MediaType.SCREEN)),t.set(f(a,o.MediaType.CAMERA),d(n,o.MediaType.CAMERA))),c&&!i&&s&&(_++,t.set(f(a,o.MediaType.CAMERA),A(n,u,p,o.MediaType.CAMERA)),t.set(f(a,o.MediaType.SCREEN),d(n,o.MediaType.SCREEN))),c&&(i||s)||(t.set(f(a,o.MediaType.CAMERA),d(n,o.MediaType.CAMERA)),t.set(f(a,o.MediaType.SCREEN),d(n,o.MediaType.SCREEN))),t}return g(r)&&n.visible&&_<=e.config.videoSlotsCount?(t.set(n.peerId,A(n,u,p)),_++):t.set(n.peerId,d(n)),t}),new Map)}(e,t,n):function(e,t,n){var a=new Map,i=e.participants[e.peer];if(!i)return a;var l=e.config,s=l.enableScreenTrack,c=l.enableProducerScreenTrack,u=e.uiMode===r.UIMode.FULLSCREEN,p=e.uiMode===r.UIMode.COLLAPSED,A=i.peerId,v=i.mediaSettings;if(A===e.me)return a;if(s||c){var E=Boolean(null==v?void 0:v.isScreenSharingEnabled),h=Boolean(null==v?void 0:v.isVideoEnabled);if(E&&h&&(a.set(f(A,o.MediaType.SCREEN),_(i,u,p,t,n,o.MediaType.SCREEN)),a.set(f(A,o.MediaType.CAMERA),m(i,o.MediaType.CAMERA))),E!==h){var C=E?o.MediaType.SCREEN:o.MediaType.CAMERA,S=E?o.MediaType.CAMERA:o.MediaType.SCREEN;a.set(f(A,C),_(i,u,p,t,n,C)),a.set(f(A,S),d(i,S))}return E||h||(a.set(f(A,o.MediaType.SCREEN),d(i,o.MediaType.SCREEN)),a.set(f(A,o.MediaType.CAMERA),d(i,o.MediaType.CAMERA))),a}return a.set(i.peerId,g(v)?_(i,u,p,t,n):d(i)),a}(e,t,n)}function u(e,t){var n=[];return t.forEach((function(t,a){var r=e.get(a);r&&function(e,t){var n=e,a=t;if(!0===n.stopStream&&!0===a.stopStream)return!0;if(!0===n.stopStream||!0===a.stopStream)return!1;var r=e,i=t;return r.fit===i.fit&&r.width===i.width&&r.height===i.height&&r.priority===i.priority}(r,t)||n.push(t)})),n}function d(e,t){return void 0===t&&(t=null),{stopStream:!0,uid:(0,l.getParticipantExternalId)(e)||"",mediaType:t}}function p(e,t){void 0===t&&(t=null);var n=(0,l.getParticipantExternalId)(e);return{fit:a.CONTAIN,width:265,height:200,priority:2,uid:n||"",keyFrame:!1,mediaType:t}}function A(e,t,n,r){void 0===r&&(r=null);var i=(0,l.getParticipantExternalId)(e);return{fit:a.COVER,width:t,height:t,priority:n,uid:i||"",keyFrame:!1,mediaType:r}}function _(e,t,n,r,i,o){void 0===o&&(o=null);var s=(0,l.getParticipantExternalId)(e);return{fit:a.CONTAIN,width:t?r:n?265:900,height:t?i:n?200:504,priority:3,uid:s||"",keyFrame:!1,mediaType:o}}function m(e,t){void 0===t&&(t=null);var n=e.mediaSettings,r=(0,l.getParticipantExternalId)(e);return{fit:(null==n?void 0:n.isScreenSharingEnabled)?a.CONTAIN:a.COVER,width:140,height:140,priority:1,uid:r||"",keyFrame:!1,mediaType:t}}function g(e){var t;return null!==(t=!!(null==e?void 0:e.isVideoEnabled)||!!(null==e?void 0:e.isScreenSharingEnabled))&&void 0!==t&&t}function f(e,t){return void 0===t&&(t=null),t?e+":"+t:e}},768606:(e,t,n)=>{"use strict";n.d(t,{throttleAccumulateDispatchParticipant:()=>l,applyParticipantsBatch:()=>s});var a=n(570655),r=n(121255),i=n(464380),o={acc:{},timer:0,tasks:0};function l(e,t,n,i){!function(e,t,n,r,i){void 0===r&&(r=100);i.acc[e]=i.acc[e]&&"object"==typeof i.acc[e]?(0,a.__assign)((0,a.__assign)({},i.acc[e]),t):t,i.tasks++,i.timer&&clearTimeout(i.timer);i.timer=window.setTimeout((function(){i.tasks>0&&(n(i.acc),i.acc={},i.tasks=0),i.timer=0}),r)}(t,n,(function(t){e({type:r.UPDATE_PARTICIPANTS_BATCH,data:t})}),i,o)}function s(e,t){var n,r=(0,a.__assign)((0,a.__assign)({},e),{participants:(0,a.__assign)({},e.participants)});for(var o in t)if(t.hasOwnProperty(o))if(void 0===(null===(n=e.participants[o])||void 0===n?void 0:n.status)&&t[o].status===i.ParticipantStatus.HANGUP)delete r.participants[o];else{var l=e.participants[o]||{},s=t[o],c=s.statusData?(0,a.__assign)((0,a.__assign)({},l.statusData),s.statusData):l.statusData,u=l.wasConnected||s.status===i.ParticipantStatus.CONNECTED;r.participants[o]=(0,a.__assign)((0,a.__assign)((0,a.__assign)({peerId:o},e.participants[o]),t[o]),{statusData:c,wasConnected:u})}return r}},674543:(e,t,n)=>{"use strict";n.d(t,{canStopTranslation:()=>i});var a=n(697483),r=n(613335);function i(e){var t,n,i,o,l=(0,r.getMe)(e);return!(!(0,a.isAdmin)(l)&&!(0,a.isCreator)(l))||!!(null===(n=null===(t=e.translation)||void 0===t?void 0:t.host)||void 0===n?void 0:n.id)&&+(null===(o=null===(i=e.translation)||void 0===i?void 0:i.host)||void 0===o?void 0:o.id)===(0,a.getMeId)(e)}},613335:(e,t,n)=>{"use strict";n.d(t,{normalizeUser:()=>s,normalizeGroup:()=>c,createFriendsCache:()=>u,getMe:()=>d,mergeGroupToParticipant:()=>p,getExternalIdByUserId:()=>A});var a=n(570655),r=n(298811),i=n(788822),o=n(697483),l=n(464380),s=function(e){var t=e.id,n=e.photo_400_orig,l=e.sex,s=e.first_name,c=e.last_name,u=e.screen_name,d=e.first_name_gen,p=e.name,A=e.photo_400,_=e.can_call;return(0,o.isParticipantGroup)(+t)&&(s=(0,i.escape)(s)),(0,a.__assign)({id:+t,peerId:+t,name:p||s+" "+c,firstName:s,shortName:(0,r.fetchUserShortName)(s,c,p),shortNameGen:(0,r.fetchUserShortName)(d,c,p),link:u&&"/"+u,sex:l,canCall:_},n||A?{photo:n||A}:{})},c=function(e){var t=e.id,n=e.name,a=e.screen_name,r=e.photo_400_orig,o=e.photo_100;return{id:-t,peerId:-t,name:(0,i.escape)(n),firstName:"",lastName:"",shortName:"",shortNameGen:"",link:a&&"/"+a,photo:r||o,photo_100:o}};function u(e){return e.reduce((function(e,t){return e[t.id]=!0,e}),{})}function d(e){return e.participants[e.me]}function p(e,t){var n=(0,a.__assign)({},t);return e.photo&&(n.photo=e.photo),e.name&&(n.name=e.name),e.link&&(n.link=e.link),n}function A(e){var t=l.ExternalIdType.USER;return(0,o.isParticipantGroup)(e)&&(t=l.ExternalIdType.GROUP),{id:e.toString(),type:t}}},604233:(e,t,n)=>{"use strict";function a(e,t){return"/video"+e+"_"+t}function r(e){var t=document.createElement("video"),n=function(){t.classList.add("Video--visible"),t.removeEventListener("loadeddata",n)};return t.addEventListener("loadeddata",n),t.autoplay=!0,t.controls=!1,t.crossOrigin="anonymous",t.playsInline=!0,t.preload="metadata",t.srcObject=e,t.volume=0,t}n.d(t,{getShortVideoUrl:()=>a,createVideoTag:()=>r})},474803:(e,t,n)=>{"use strict";n.d(t,{usePriorities:()=>l});var a=n(570655),r=n(667294),i=n(757054),o=n(121255),l=function(e,t){var n=(0,a.__read)((0,r.useState)([0,0]),2),l=(0,a.__read)(n[0],2),s=l[0],c=l[1],u=n[1],d=(0,r.useRef)(new Map);(0,r.useEffect)((function(){var e=function(){return u([window.innerWidth,window.innerHeight])};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((function(){if(t.mode===o.Mode.CALL){var n=(0,i.getParticipantLayout)(t,s,c),a=(0,i.getParticipantsLayoutDiff)(d.current,n);a.length>0&&(d.current=n,e.updateDisplayLayout(a))}else d.current=new Map}),[s,c,t.participants,t.mode,t.uiMode,t.isOratorMode,t.orator,t.pinnedParticipant,t.adminPinnedParticipant,t.screenSharingPinnedParticipant,t.translation])}},594504:(e,t,n)=>{"use strict";n.d(t,{AnonymousIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28",height:"28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#paint0_linear)"}),r.createElement("path",{d:"M6.746 14.391c-.165-1.078-.204-1.206-.493-1.614-.363-.513-.415-1.1.38-1.255 2.042-.397 4.252-.1 6.265.268a5.546 5.546 0 002.204 0c2.013-.368 4.223-.665 6.264-.268.796.154.744.742.38 1.255-.288.408-.327.536-.492 1.614-.248 1.617-1.607 2.275-3.29 2.276-1.85 0-2.465-1.055-3.04-2.494-.557-1.398-1.29-1.398-1.849 0-.574 1.439-1.19 2.494-3.038 2.494-1.684 0-3.043-.66-3.29-2.276z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"paint0_linear",x1:"0",y1:"0",x2:"28.733",y2:".773",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#99A2AD"}),r.createElement("stop",{offset:"1",stopColor:"#99A2AD"}))))}},923522:(e,t,n)=>{"use strict";n.d(t,{CancelIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"20",height:"20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.72 4.72a.75.75 0 011.06 0L10 8.94l4.22-4.22a.75.75 0 111.06 1.06L11.06 10l4.22 4.22a.75.75 0 11-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 01-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 010-1.06z",fill:"#99A2AD"}))}},968125:(e,t,n)=>{"use strict";n.d(t,{ChainIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.49 4.293a4.402 4.402 0 116.225 6.225l-1.072 1.072a.9.9 0 01-1.273-1.273l1.071-1.072a2.601 2.601 0 10-3.678-3.678l-3.537 3.537a2.601 2.601 0 000 3.678.9.9 0 01-1.274 1.273 4.402 4.402 0 010-6.225l3.537-3.537zm-.708 5.66a.9.9 0 011.273 0 4.402 4.402 0 010 6.225l-3.537 3.537a4.402 4.402 0 11-6.225-6.226l1.122-1.121a.9.9 0 111.273 1.273l-1.121 1.122a2.601 2.601 0 103.678 3.678l3.537-3.537a2.601 2.601 0 000-3.678.9.9 0 010-1.274z",fill:"#fff"}))}},701683:(e,t,n)=>{"use strict";n.d(t,{DisabledVideoIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"16",width:"22",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M1.514.242A.9.9 0 00.286 1.558l1.092 1.02C1.13 3.053 1 3.548 1 4.846v6.308c0 1.338.14 1.822.4 2.311.262.49.646.873 1.135 1.134.489.262.974.401 2.31.401h7.31c1.207 0 1.72-.114 2.168-.328l1.163 1.086a.9.9 0 001.228-1.316L1.514.242zM15.999 11.346L4.924 1h7.23c1.338 0 1.822.14 2.311.4.49.262.873.646 1.134 1.135.262.489.401.974.401 2.31 0 2.167.023 4.335-.001 6.501zM22 4.497v7.006c0 .815-.964 1.277-1.6.8l-2.2-1.653a.5.5 0 01-.2-.4v-4.5a.5.5 0 01.2-.4l2.2-1.652c.651-.49 1.6.003 1.6.8z"}))}},80125:(e,t,n)=>{"use strict";n.d(t,{DisabledVideoIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"14",height:"12",fill:"currentColor"},t,{xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M9.574 11.13a.751.751 0 001.061-1.06L1.48.92A.75.75 0 10.42 1.98l.82.82c-.153.282-.24.606-.24.95v4.5a2 2 0 002 2h5a2 2 0 00.601-.092l.973.972zM13.897 3.664A.454.454 0 0114 3.95v4.075c0 .415-.392.602-.825.382-.475-.24-1.572-.789-1.572-.789a.233.233 0 01-.103-.19v-2.88c0-.075.038-.146.103-.19 0 0 1.378-.694 1.572-.79.193-.094.55-.115.722.096zM10 7.425V3.75a2 2 0 00-2-2H4.32L10 7.425z"}))}},815155:(e,t,n)=>{"use strict";n.d(t,{EndCallIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4.3 4.3a1 1 0 011.4 0l6.3 6.29 6.3-6.3a1 1 0 111.4 1.42L13.42 12l6.3 6.3a1 1 0 01-1.42 1.4L12 13.42l-6.3 6.3a1 1 0 01-1.4-1.42L10.58 12l-6.3-6.3a1 1 0 010-1.4z"}))}},172397:(e,t,n)=>{"use strict";n.d(t,{FullScreenIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6.5 15a1 1 0 01-1 1H1a1 1 0 01-1-1v-4.5a1 1 0 012 0v2.071l3.363-3.364a1 1 0 011.414 0l.016.016a1 1 0 010 1.414L3.428 14H5.5a1 1 0 011 1zM14 3.428l-3.363 3.365a1 1 0 01-1.414 0l-.016-.016a1 1 0 010-1.414L12.571 2H10.5a1 1 0 010-2H15a1 1 0 011 1v4.5a1 1 0 01-2 0z"}))}},167903:(e,t,n)=>{"use strict";n.d(t,{FullScreenOffIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6.1 9a.9.9 0 01.9.9v4.2a.9.9 0 11-1.8 0v-2.027l-3.664 3.663a.9.9 0 11-1.272-1.272L3.927 10.8H1.9a.9.9 0 110-1.8zM15.736.264a.9.9 0 010 1.272L12.073 5.2h2.025a.9.9 0 010 1.8H9.9a.9.9 0 01-.9-.9V1.9a.9.9 0 111.8 0v2.027L14.464.264a.9.9 0 011.272 0z"}))}},801513:(e,t,n)=>{"use strict";n.d(t,{LiveIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28px",height:"10px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 28 10"},t),r.createElement("path",{fill:"#F2F3F5",fillRule:"evenodd",d:"M1 0a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 100-2H2V1a1 1 0 00-1-1zm7 1a1 1 0 112 0v8a1 1 0 11-2 0V1zm15-1a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 100-2h-3V6h3a1 1 0 100-2h-3V2h3a1 1 0 100-2h-4zm-8.325 9.31l-2.55-7.824a.993.993 0 01-.117-.363L12 1.1h.005A1 1 0 1113.995.9L14 .9l2 6.4 2-6.4h.005a1 1 0 011.99.2H20l-.008.023a.993.993 0 01-.118.363l-2.55 7.824a1 1 0 01-.95.69h-.748a1 1 0 01-.95-.69z",clipRule:"evenodd"}))}},818114:(e,t,n)=>{"use strict";n.d(t,{MicIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M8 0a4 4 0 00-4 4v5a4 4 0 008 0V4a4 4 0 00-4-4z"}),r.createElement("path",{d:"M1.1 10c-.551 0-.982.486-.843 1.02A8.007 8.007 0 007.1 16.95v2.15a.9.9 0 101.8 0v-2.15a8.007 8.007 0 006.843-5.93c.139-.534-.292-1.02-.843-1.02-.45 0-.826.329-.953.76a6.203 6.203 0 01-11.894 0C1.926 10.33 1.55 10 1.1 10z"}))}},830810:(e,t,n)=>{"use strict";n.d(t,{MoreIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"12",height:"20",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4 3a2 2 0 104 0 2 2 0 00-4 0zm0 7a2 2 0 104 0 2 2 0 00-4 0zm2 9a2 2 0 110-4 2 2 0 010 4z",fill:"currentColor"}))}},747212:(e,t,n)=>{"use strict";n.d(t,{MutedMicIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M1.721 2.307L4 4.586v-.002l7.029 7.029 4.693 4.695a1 1 0 01-1.414 1.414l-1.938-1.937A8.482 8.482 0 019 16.941V19a1 1 0 01-1.993.117L7.001 19v-2.06c-3.234-.384-5.995-2.611-6.955-5.646a.995.995 0 01.681-1.25 1.035 1.035 0 011.287.662C2.808 13.216 5.257 15 7.999 15c1.03 0 2.016-.25 2.89-.695l-1.538-1.539A4 4 0 014 9V7.414L.307 3.721a1 1 0 011.414-1.414zm13.55 7.737c.544.162.85.72.684 1.249a7.825 7.825 0 01-.75 1.666l-1.51-1.51c.113-.239.21-.487.29-.742a1.035 1.035 0 011.287-.663zM8 0a4 4 0 014 4v5c0 .237-.02.468-.06.694L4.433 2.188A4 4 0 018 0z"}))}},942775:(e,t,n)=>{"use strict";n.d(t,{MutedMicIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"13",width:"12",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 13",fill:"currentColor"},t),r.createElement("path",{d:"M3.497 5.06v.44a2.501 2.501 0 002.91 2.467l1.199 1.198a4.005 4.005 0 01-5.521-2.822.75.75 0 00-1.469.314A5.508 5.508 0 005.25 10.95v1.301a.75.75 0 001.501 0v-1.3a5.472 5.472 0 001.973-.669l1.25 1.25a.751.751 0 001.062-1.061L1.88 1.32A.75.75 0 10.82 2.38l2.677 2.68zM9.672 7.097l1.117 1.117a5.463 5.463 0 00.594-1.557.75.75 0 10-1.468-.314 3.963 3.963 0 01-.243.754zM3.827 1.258l4.644 4.64c.02-.13.031-.263.031-.398v-3a2.502 2.502 0 00-4.675-1.242z"}))}},494549:(e,t,n)=>{"use strict";n.d(t,{ParticipantsIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M17 12.5c2.294 0 6.5.857 6.5 4.286 0 1.5-.382 1.714-1.147 1.714h-6.09c.158-.488.237-1.062.237-1.714 0-1.723-.631-3.067-1.672-4.062.783-.16 1.548-.224 2.172-.224zm-9 0c2.294 0 6.5.857 6.5 4.286 0 1.5-.382 1.714-1.147 1.714H2.647c-.765 0-1.147-.214-1.147-1.714C1.5 13.357 5.706 12.5 8 12.5zM8 5a3 3 0 110 6 3 3 0 110-6zm9 0a3 3 0 110 6 3 3 0 110-6z"}))}},995420:(e,t,n)=>{"use strict";n.d(t,{PhoneIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"18",width:"18",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M11.112 12.259c1.354-1.354 3.486-1.48 4.903-.287l1.025.863c1.168.983 1.287 2.757.263 3.96a3.318 3.318 0 01-2.195 1.133c-3.273.44-6.707-1.137-10.303-4.733C1.21 9.6-.369 6.165.072 2.892a3.25 3.25 0 01.159-.752c.19-.56.527-1.058.974-1.443C2.41-.327 4.181-.21 5.165.96l.862 1.024c1.194 1.416 1.07 3.55-.284 4.903l-.736.735a.712.712 0 00-.164.748c.267.732.95 1.645 2.046 2.74 1.096 1.097 2.01 1.78 2.74 2.048.26.095.553.03.749-.166z"}))}},780573:(e,t,n)=>{"use strict";n.d(t,{PhoneIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.3 9.99c.93-.93 2.32-.75 3.63.35.94.79.82 2.85-1.18 3.12s-4.11-.7-6.32-2.9c-2.2-2.2-3.1-4.1-2.9-6.3a1.8 1.8 0 013.12-1.18c1.06 1.25 1.38 2.6.36 3.62-.48.48-.67.6-.56.91.41 1.1 2.19 2.65 2.94 2.93.35.13.46-.1.9-.55z"}))}},711034:(e,t,n)=>{"use strict";n.d(t,{PinDotIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"25",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M10 8a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"}),r.createElement("path",{d:"M6.558 10a.024.024 0 00-.017.04l3.254 3.255-2.947 2.948a1 1 0 001.414 1.414l2.948-2.948 3.25 3.25c.015.015.04.005.04-.017v-2.114c0-1.81.72-3.547 2-4.828l1.658-.414a.2.2 0 00.093-.336l-4-4a.2.2 0 00-.336.093L13.5 8a6.828 6.828 0 01-4.829 2H6.558z"}))}},748972:(e,t,n)=>{"use strict";n.d(t,{RaiseHandIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6 5.18c.65 0 1 .54 1 1.2v5.48c0 .22.26.4.47.4.23 0 .52-.18.52-.4V4c0-.66.33-1.2.99-1.2.65 0 1.02.54 1.02 1.2v7.08c0 .22.29.4.5.4.22 0 .5-.18.5-.4V3.19c0-.66.31-1.2.97-1.2.66 0 1.04.54 1.04 1.2v7.88c0 .22.24.4.46.4.22 0 .52-.18.52-.4V4.79c0-.67.32-1.18.98-1.18.66 0 1.02.51 1.02 1.17v10.73l2.29-2.67c.33-.45 1-.68 1.65-.26.34.2.86.81.2 1.68 0 0-2.45 3.09-3.81 4.74-1.3 1.65-3.81 2.5-5.51 2.5C5.25 21.5 5 17.71 5 16.43V6.37c0-.65.33-1.19 1-1.19z"}))}},595285:(e,t,n)=>{"use strict";n.d(t,{RaisedHandContourIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 21 24"},t),r.createElement("path",{d:"M21.442 10.058c.513.77.588 1.831.192 2.663l-2.679 5.625C17.435 21.538 13.54 24 9.998 24H9c-4.422 0-8-3.58-8-8.009V8.128a2.746 2.746 0 013.5-2.642v-.732a2.75 2.75 0 013.571-2.629A2.749 2.749 0 0110.75 0c1.47 0 2.67 1.15 2.746 2.604A2.748 2.748 0 0117 5.254v4.264c1.299-1.278 3.357-1.087 4.442.54zM3.75 7.383a.746.746 0 00-.75.745v7.863A5.998 5.998 0 009 22h.998c2.773 0 5.964-2.02 7.152-4.514l2.678-5.625a.787.787 0 00-.05-.694c-.428-.642-1.123-.65-1.55-.01l-2.177 3.267c-.576.864-1.051.726-1.051-.323V5.255a.748.748 0 00-.75-.755.746.746 0 00-.75.747v5.757c0 .55-.448.996-1 .996-.556 0-1-.446-1-.995V2.752a.75.75 0 10-1.5 0v8.253c0 .54-.448.995-1 .995-.556 0-1-.446-1-.997v-6.25A.756.756 0 007.25 4a.75.75 0 00-.75.754v6.738c0 .551-.448 1.008-1 1.008-.556 0-1-.447-1-.999V8.138a.751.751 0 00-.75-.755z"}))}},135063:(e,t,n)=>{"use strict";n.d(t,{RaisedHandIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"15",height:"15",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M2.75 3a.75.75 0 01.75.75V7.5a.5.5 0 001 0V2A.75.75 0 016 2v4.75a.5.5 0 001 0v-5.5a.75.75 0 011.5 0v5.5a.5.5 0 001 0V2.5a.75.75 0 011.5 0v7.25l1.614-1.796a.9.9 0 011.36 1.177c-.73.873-2.044 2.449-2.809 3.367C9.913 14 8.08 14.5 6.701 14.5 2.2 14.5 2 11.47 2 10.444V3.75A.75.75 0 012.75 3z"}))}},796726:(e,t,n)=>{"use strict";n.d(t,{RaisedHandIconXs:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"10px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 10 11"},t),r.createElement("path",{fill:"#F5F5F5",d:"M.5 2.5A.5.5 0 011 3v2.5a.5.5 0 001 0v-4a.5.5 0 011 0V5a.5.5 0 001 0V1a.5.5 0 011 0v4.063a.5.5 0 001 0V1.938a.5.5 0 011 0V7.5l-.28-.032L8.494 5.57a.67.67 0 01.995.9 232.32 232.32 0 00-2.615 3.029C5.935 10.624 4.56 11 3.526 11 .15 11 0 8.727 0 7.958V3a.5.5 0 01.5-.5z"}))}},44781:(e,t,n)=>{"use strict";n.d(t,{RejectIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"14",width:"14",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M13.3.7a.99.99 0 00-1.4 0L7 5.6 2.1.7A.99.99 0 00.7 2.1L5.6 7 .7 11.9a.99.99 0 001.4 1.4L7 8.4l4.9 4.9a.99.99 0 001.4-1.4L8.4 7l4.9-4.9a.99.99 0 000-1.4z"}))}},462480:(e,t,n)=>{"use strict";n.d(t,{ShareIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"20",height:"20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.978 3.423a1.792 1.792 0 00-1.645 1.785v1.765l-.1.021a8.254 8.254 0 00-6.44 8.917.75.75 0 001.343.379l.175-.22a7.577 7.577 0 015.022-2.721v2.08a1.792 1.792 0 002.897 1.41l6.52-5.11a1.792 1.792 0 000-2.82l-6.52-5.11a1.791 1.791 0 00-1.105-.382l-.147.006zm.147 1.494c.065 0 .129.021.18.062l6.52 5.11a.292.292 0 010 .459l-6.52 5.11a.292.292 0 01-.472-.23v-2.873a.75.75 0 00-.767-.75l-.215.005-.305.016a9.065 9.065 0 00-5.162 2.056l-.037.032.004-.027a6.752 6.752 0 015.823-5.533.75.75 0 00.659-.744V5.208c0-.16.13-.291.292-.291z",fill:"#99A2AD"}))}},122317:(e,t,n)=>{"use strict";n.d(t,{ShareScreenBigIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"56",height:"56",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M28.5 37.5A1.5 1.5 0 0030 36V22.622l4.94 4.939a1.5 1.5 0 002.007.103l.114-.103a1.5 1.5 0 000-2.122l-7.5-7.5a1.5 1.5 0 00-2.122 0l-7.5 7.5a1.5 1.5 0 002.122 2.122l4.938-4.939L27 36a1.5 1.5 0 001.355 1.493l.145.007z"}),r.createElement("path",{d:"M19.883 8c-5.019 0-7.117.465-9.244 1.603a10.924 10.924 0 00-4.536 4.536C4.965 16.266 4.5 18.364 4.5 23.383v9.234c0 5.019.465 7.117 1.603 9.244a10.924 10.924 0 004.536 4.536C12.766 47.535 14.864 48 19.883 48h17.234c5.019 0 7.117-.465 9.244-1.603a10.924 10.924 0 004.536-4.536c1.138-2.127 1.603-4.225 1.603-9.244v-9.234c0-5.019-.465-7.117-1.603-9.244a10.924 10.924 0 00-4.536-4.536C44.234 8.465 42.136 8 37.117 8H19.883zm-7.83 4.248c1.486-.794 3-1.248 7.83-1.248h17.234c4.83 0 6.344.454 7.83 1.248a7.925 7.925 0 013.305 3.306c.794 1.485 1.248 3 1.248 7.83v9.233c0 4.83-.454 6.344-1.248 7.83a7.925 7.925 0 01-3.306 3.305c-1.485.794-3 1.248-7.83 1.248H19.884c-4.83 0-6.344-.454-7.83-1.248a7.925 7.925 0 01-3.305-3.306c-.794-1.485-1.248-3-1.248-7.83v-9.233c0-4.83.454-6.344 1.248-7.83a7.925 7.925 0 013.306-3.305z"}))}},156482:(e,t,n)=>{"use strict";n.d(t,{ShareScreenIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M20.465 4.4c-.489-.26-.974-.4-2.31-.4H5.844c-1.336 0-1.821.14-2.31.4A2.726 2.726 0 002.4 5.536C2.139 6.024 2 6.509 2 7.845v8.31c0 1.336.14 1.821.4 2.31.262.49.646.873 1.135 1.134.489.262.974.401 2.31.401h12.31c1.336 0 1.821-.14 2.31-.4a2.726 2.726 0 001.134-1.135c.262-.489.401-.974.401-2.31v-8.31c0-1.336-.14-1.821-.4-2.31A2.726 2.726 0 0020.464 4.4zm-11.81 5.728l2.97-2.978c.207-.2.543-.2.75 0l2.97 2.978c.33.318.077.872-.376.872H13v4.979c0 .564-.442 1.021-1 1.021s-1-.457-1-1.021V11H9.031c-.44 0-.715-.545-.375-.872z"}))}},254060:(e,t,n)=>{"use strict";n.d(t,{StarFilled:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"28",width:"28",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M14 21.5l-4.6 2.9A2.2 2.2 0 016 22l1.2-5.3L3.2 13a2.2 2.2 0 011.2-3.8l5.5-.5 2-5a2.2 2.2 0 014.1 0l2.1 5 5.5.5a2.2 2.2 0 011.2 3.8l-4.1 3.6 1.2 5.3a2.2 2.2 0 01-3.3 2.4L14 21.5z"}))}},995811:(e,t,n)=>{"use strict";n.d(t,{StarIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"10",height:"10",viewBox:"0 0 10 10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M6.80486 3.06621L9.19457 3.30079C10.0261 3.38241 10.2811 4.21346 9.63901 4.75944L7.76813 6.35033L8.46267 8.94201C8.69075 9.79313 7.98312 10.3084 7.27435 9.79614L5.0011 8.15325L2.72785 9.79614C2.02194 10.3063 1.31141 9.79324 1.53953 8.94201L2.23406 6.35033L0.363183 4.75944C-0.281598 4.21116 -0.0275869 3.38278 0.807493 3.30079L3.19677 3.06621L4.24943 0.583062C4.57908 -0.194562 5.42332 -0.194173 5.75269 0.583142L6.80486 3.06621Z"}))}},950890:(e,t,n)=>{"use strict";n.d(t,{StarOutline:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"28",width:"28",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M14 19.2l5.7 3.5a.2.2 0 00.3-.3L18.4 16l5.1-4.3a.2.2 0 00-.1-.4l-6.7-.5-2.5-6.1a.2.2 0 00-.4 0l-2.5 6.1-6.7.5a.2.2 0 00-.1.4l5 4.3L8 22.4a.2.2 0 00.3.3zm0 2.3l-4.6 2.9A2.2 2.2 0 016 22l1.2-5.3L3.2 13a2.2 2.2 0 011.2-3.8l5.5-.5 2-5a2.2 2.2 0 014.1 0l2.1 5 5.5.5a2.2 2.2 0 011.2 3.8l-4.1 3.6 1.2 5.3a2.2 2.2 0 01-3.3 2.4z"}))}},607910:(e,t,n)=>{"use strict";n.d(t,{TranslationStatusChevronIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"4",viewBox:"0 0 10 5",fill:"currentColor","aria-hidden":"true"},t),r.createElement("path",{d:"M5 4.8c-.2 0-.3 0-.4-.1l-4.3-3.2c-.3-.3-.4-.8-.2-1.1.2-.3.7-.4 1-.2l3.9 2.9 3.8-2.9c.3-.3.8-.2 1 .1.3.3.2.8-.1 1.1l-4.2 3.2c-.2.1-.3.2-.5.2z"}))}},826988:(e,t,n)=>{"use strict";n.d(t,{VideoIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"14",width:"21",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M11.154 0c1.337 0 1.822.14 2.311.4.49.262.873.646 1.134 1.135.262.489.401.974.401 2.31v6.31c0 1.336-.14 1.821-.4 2.31a2.726 2.726 0 01-1.135 1.134c-.489.262-.974.401-2.31.401h-7.31c-1.336 0-1.821-.14-2.31-.4A2.726 2.726 0 01.4 12.464C.139 11.976 0 11.491 0 10.155v-6.31c0-1.336.14-1.821.4-2.31A2.726 2.726 0 011.536.4C2.024.139 2.509 0 3.845 0zM20.8 2.897a1 1 0 01.2.6v7.006a1 1 0 01-1.6.8L17.2 9.65a.5.5 0 01-.2-.4v-4.5a.5.5 0 01.2-.4l2.2-1.652a1 1 0 011.4.199z"}))}},168634:(e,t,n)=>{"use strict";n.d(t,{VideoIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"16",fill:"currentColor"},t,{xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M3.14 3C1.96 3 1 3.96 1 5.14v5.72C1 12.04 1.96 13 3.14 13h5.72c1.18 0 2.14-.96 2.14-2.14V5.14C11 3.96 10.04 3 8.86 3H3.14zM14.95 4.87c.23-.17.55 0 .55.28v5.7c0 .28-.32.45-.55.28L12 9.01V6.99l2.95-2.12z"}))}},30933:(e,t,n)=>{"use strict";n.d(t,{ViewersCountIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 0C4.546 0 1.596 2.073.4 5c1.196 2.927 4.146 5 7.6 5 3.455 0 6.405-2.073 7.6-5-1.195-2.927-4.145-5-7.6-5zm3.5 5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zM8 7a2 2 0 100-4 2 2 0 000 4z",fill:"#F5F5F5"}))}},294757:(e,t,n)=>{"use strict";n.d(t,{init:()=>N});var a=n(570655),r=n(667294),i=n(973935),o=n(659397),l=n(262891),s=n(656504),c=n(641196),u=n(89085),d=n(253312),p=n(464380),A=n(662208),_=n(498110),m=n(170794),g=n(614914),f=n(699637),v=n(14890),E=n(989189),h=n(815615),C=n(50533),S=n(121255),y=n(613335);n(329538);function N(e){var t=e.actionStatCollector,n=e.saveStatlogEvents,N=e.langUtils,I=e.navigateToConvo,P=e.navigateToProfile,b=e.apiWrapperWithAuth,w=e.apiWrapper,L=e.callSounds,M=e.config,O=void 0===M?{isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,incomingCall:!1,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:S.VIDEO_SLOTS_COUNT,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,sferum:!1}:M,k=e.eventHandlers,D=e.streamUrlExtractor;return(0,c.setApiWrappers)(b,w),{initialized:!1,initializing:!1,eventHandlers:null!=k?k:{},init:function(e){var s,c=this,b=e.callPreview,w=e.callsCredentials,M=e.imHash,R=e.participantLimit,B=e.callsOkStaging,G=e.tabIsMaster,x=e.onBeforeCallStart,H=e.onAfterCallFinish,U=e.onError,V=e.toggles,F=void 0===V?{}:V,W=e.friends,z=e.isFriend,j=e.getFriends,Q=e.pushToTalkEnabled;if(!(null==w?void 0:w.me))return console.log("Calls were not initialized as there are no callsCredentials.me"),!1;this.initialized=!0,this.isFriend=z,this.getFriends=j;var Y=(0,a.__assign)((0,a.__assign)({},O),F);if(!p.browser.isBrowserSupported()){var K=function(){var e=N.getLang("calls_unsupported_browser_error");return U&&U({msg:e}),(null==k?void 0:k.onError)&&k.onError(new Error(e)),console.error(e),Promise.resolve()};return this.call=K,this.startGroupCall=K,this.startCall=K,this.acceptCall=K,this.joinCallByLink=K,this.showJoinPopup=K,void(this.showCallByNamePopup=K)}this.id=window.vk&&window.vk.id||w.me.peerId;var J=G||function(){return!0},q=null!==(s=o.localStorage.getItem(S.VIDEO_RESOLUTION_STORAGE_KEY))&&void 0!==s?s:S.VideoResolutionTypes.SD,Z=(0,v.createStore)(h.callsReducer,(0,E.getInitialState)(w.me,M,b,{participantLimit:R,isDev:!!w.is_dev,token:w.secret,config:Y,localVideoResolution:Y.fullHD?q:q===S.VideoResolutionTypes.HD?S.VideoResolutionTypes.HD:S.VideoResolutionTypes.SD,friends:W||[],friendsCache:(0,y.createFriendsCache)(W||[]),ipSettingEnabled:w.ip_setting_enabled,privacySettings:w.privacySettings,pushToTalkEnabled:Q}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());return this.collapseCall=function(){Z.dispatch({type:S.MANAGEMENT,isOpen:!1}),Z.dispatch({type:S.CHANGE_UI_MODE,mode:S.UIMode.COLLAPSED})},this.restoreCall=function(){Z.dispatch({type:S.CHANGE_UI_MODE,mode:S.UIMode.DEFAULT})},this.showStartCallModal=function(e,t){Z.dispatch({type:S.CHANGE_MODE,mode:S.Mode.START,peerId:e,joinLink:t})},n&&(0,m.setStatlogEventsHandler)(n),t&&g.callStats.setActionStatCollector(t),i.render(r.createElement(C.Provider,{store:Z},r.createElement(A.LangContext.Provider,{value:N},r.createElement(_.ConfigContext.Provider,{value:Y},r.createElement(f.WaitingContainer,null)))),T("calls")),this.initializing=(0,d.sdkService)(this,p,w,Z,N.getLang,B).finally((function(){(0,u.longpollService)(c,p,N.getLang,Z);var e=T("calls");i.unmountComponentAtNode(e),i.render(r.createElement(C.Provider,{store:Z},r.createElement(A.LangContext.Provider,{value:N},r.createElement(_.ConfigContext.Provider,{value:Y},r.createElement(l.App,{bridge:c,SDK:p,tabIsMaster:J,onBeforeCallStart:x,onAfterCallFinish:H,callSounds:L,navigateToConvo:I,onHandCountChanged:null==k?void 0:k.onHandCountChanged,onSuccessFeedback:null==k?void 0:k.onSuccessFeedback,navigateToProfile:P,okPublicKey:w.key,config:Y,streamUrlExtractor:D})))),e)})),this.initializing.catch((function(e){if(null==k?void 0:k.onError){var t=e?e.message||e.msg:"sdk did not send the reasons for the error",n=e?e.error:"";[401].includes(n)||k.onError(new Error("Could not init calls. "+t+": "+n))}console.error("Could not init calls",e.error,e)}))},showJoinScreen:function(e,o,l,c,u){var d=function(e){c&&c({msg:e}),(null==k?void 0:k.onError)&&k.onError(new Error(e)),console.error(e)};if(!p.browser.isBrowserSupported())return d(N.getLang("calls_unsupported_browser_error"));(0,m.setStatlogEventsHandler)(n),g.callStats.setActionStatCollector(t);var f=e.callsAllowCallByName,v=e.callsAllowWaitingHall,E=document.querySelector(o),h=(0,a.__assign)((0,a.__assign)({},O),{allowCallByName:f,allowWaitingHall:v});i.render(r.createElement(A.LangContext.Provider,{value:N},r.createElement(_.ConfigContext.Provider,{value:h},r.createElement(s.JoinScreenContainer,(0,a.__assign)({},e,{withPopup:!1,bridge:this,entryPoint:l,onError:d,okPublicKey:u})))),E)},debug:!1,setDebug:function(e){this.debug=e,p.debug(e)}}}function T(e){var t=document.getElementById(e);if(t)return t;var n=document.createElement("section");return n.setAttribute("id",e),document.body.appendChild(n),n}},169610:(e,t,n)=>{"use strict";n.d(t,{checkPermissions:()=>r});var a=n(464380);function r(e,t){var n=e.browser.hasMicrophonePermission(),r=e.browser.hasCameraPermission(),i=t.includes(a.MediaOption.AUDIO)&&!n,o=t.includes(a.MediaOption.VIDEO)&&!r;return(i||o)&&function(e,t,n){e.browser.getUserMedia(t,n).then((function(e){e.getTracks().forEach((function(e){return e.stop()}))}))}(e,o,i),Promise.resolve()}},989189:(e,t,n)=>{"use strict";n.d(t,{getInitialState:()=>o});var a=n(570655),r=n(121255),i=n(464380),o=function(e,t,n,o){var l,s=o.participantLimit,c=void 0===s?128:s,u=o.isDev,d=void 0!==u&&u,p=o.token,A=o.config,_=void 0===A?{isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,incomingCall:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:r.VIDEO_SLOTS_COUNT,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,sferum:!1}:A,m=o.localVideoResolution,g=void 0===m?r.VideoResolutionTypes.SD:m,f=o.friends,v=void 0===f?[]:f,E=o.friendsCache,h=o.privacySettings,C=o.ipSettingEnabled,S=o.pushToTalkEnabled,y=void 0!==S&&S,N=window.vk&&window.vk.id||e.peerId;return{anonymSecret:p,me:N,groupId:0,mode:r.Mode.READY,peer:0,participants:(l={},l[N]=(0,a.__assign)((0,a.__assign)({},e),{mediaSettings:{isAudioEnabled:!0,isVideoEnabled:!1,isScreenSharingEnabled:!1},statusData:{hand:!1},roles:[],permissions:{audio:r.MediaPermissionType.ALLOW,video:r.MediaPermissionType.ALLOW,screenSharing:r.MediaPermissionType.ALLOW}}),l),callData:{type:null,ts:null,localTimeStamp:null,conversation:n},imHash:t,participantLimit:c,isDev:d,popup:null,uiMode:r.UIMode.DEFAULT,orator:null,adminPinnedParticipant:null,screenSharingPinnedParticipant:null,screenSharingNeedDisableOratorModeAfterStop:!0,screenSharingOldPinnedParticipant:null,pinnedParticipant:null,screenSharers:{},isShownParticipantsAside:!0,isOratorMode:!0,chatMembers:[],groupMembers:[],groupMembersCount:0,preselectedIds:null,friends:v,speakers:{},speakersInHeader:[],chatUnreadCount:0,chatUpToMsgId:null,tooltips:{chat:!1,hand:!1,screenShare:!1,layout:!1,collapse:!1,fullscreen:!1},participantsAddedByMe:new Set,groupCallSetup:!1,isManagementOpen:!1,notification:null,errorShown:!1,cautionShown:!1,isLoaderVisible:!1,translation:{deferredId:null,isOn:!1},participantsManagement:null,adminAssignment:null,participantKick:null,membersUnban:null,noiseCancellation:r.NoiseCancellationTypes.NEURAL,config:_,localVideoResolution:g,conversationOptions:[],privacySettings:{callsIp:(null==h?void 0:h.callsIp)||"friends"},friendsCache:E||{},groupMembersCache:{},unableToCallGroupMembersIds:[],ipSettingEnabled:C||!1,localStatus:i.ParticipantStatus.WAITING,isIncoming:!1,pushToTalkEnabled:y,gridScrollPosition:0,oratorScrollPosition:0}}},815615:(e,t,n)=>{"use strict";n.d(t,{callsReducer:()=>s});var a=n(570655),r=n(121255),i=n(989189),o=n(768606),l=n(613335);function s(e,t){var n,s,u,d;switch(t.type){case r.LOAD_PEERS:var p=t.conversation||e.callData.conversation,A=t.members;return(0,a.__assign)((0,a.__assign)({},e),{participants:(0,a.__assign)((0,a.__assign)({},e.participants),A.reduce((function(t,n){return n&&n.peerId&&(t[n.peerId]=(0,a.__assign)((0,a.__assign)({mediaSettings:{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1}},e.participants[n.peerId]||{}),n)),t}),{})),callData:(0,a.__assign)((0,a.__assign)({},e.callData),{conversation:p}),peer:"peerId"in t?t.peerId:e.peer,caller:"caller"in t?t.caller:e.caller});case r.CHANGE_MODE:var _=t.mode!==r.Mode.READY&&t.data&&t.data.type?t.data.type:null;if(t.mode===r.Mode.READY||t.mode===r.Mode.FEEDBACK){p=e.callData&&e.callData.conversation;var m=(0,i.getInitialState)(e.participants[e.me],e.imHash,p,{participantLimit:e.participantLimit,token:e.anonymSecret,config:e.config,localVideoResolution:e.localVideoResolution,friends:e.friends,privacySettings:e.privacySettings,friendsCache:e.friendsCache,ipSettingEnabled:e.ipSettingEnabled,isDev:e.isDev});return t.mode===r.Mode.FEEDBACK&&(m.mode=r.Mode.FEEDBACK,m.lastCallData={callId:null!==(u=null===(s=e.callData)||void 0===s?void 0:s.callId)&&void 0!==u?u:"",peerId:null!==(d=e.peer)&&void 0!==d?d:0}),m}return(0,a.__assign)((0,a.__assign)({},e),{mode:t.mode,peer:"peerId"in t?t.peerId:e.peer,callData:(0,a.__assign)((0,a.__assign)({},e.callData),{type:_,ts:t.ts||e.callData.ts||null}),hangupType:e.hangupType,join:t.joinLink?{joinLink:t.joinLink}:e.join});case r.HANGUP:return(0,a.__assign)((0,a.__assign)({},e),{hangupType:t.data});case r.TIME_START:return(0,a.__assign)((0,a.__assign)({},e),{callData:(0,a.__assign)((0,a.__assign)({},e.callData),{ts:t.data})});case r.LOCAL_TIME_START:return(0,a.__assign)((0,a.__assign)({},e),{callData:(0,a.__assign)((0,a.__assign)({},e.callData),{localTimeStamp:t.data})});case r.REMOVE_USER:var g=c(e,t.participantId,{status:void 0,statusData:void 0,wasConnected:void 0});if(e.screenSharers[t.participantId]&&delete g.screenSharers[t.participantId],e.orator===t.participantId&&(g.orator=null),e.pinnedParticipant===t.participantId&&(g.pinnedParticipant=null),e.adminPinnedParticipant===t.participantId&&(g.adminPinnedParticipant=null),e.screenSharingPinnedParticipant===t.participantId&&(g.screenSharingPinnedParticipant=null),e.participantsAddedByMe.has(t.participantId)){var f=new Set(e.participantsAddedByMe);f.delete(t.participantId),g.participantsAddedByMe=f}return g;case r.SET_CHAT_INFO:return(0,a.__assign)((0,a.__assign)({},e),{chatMembers:t.data,chatData:t.conversation});case r.GROUP_CALL_SETUP:return(0,a.__assign)((0,a.__assign)({},e),{groupCallSetup:t.open,peer:t.peerId||e.peer||0,preselectedIds:t.preselectedIds});case r.TOGGLE_POPUP:return(0,a.__assign)((0,a.__assign)({},e),{popup:t.data||null});case r.UPDATE_HASH:return(0,a.__assign)((0,a.__assign)({},e),{imHash:t.hash});case r.CHANGE_UI_MODE:return(0,a.__assign)((0,a.__assign)({},e),{uiMode:t.mode||r.UIMode.DEFAULT});case r.TOGGLE_ORATOR_MODE:return(0,a.__assign)((0,a.__assign)({},e),{isOratorMode:t.isOratorMode});case r.TOGGLE_PARTICIPANTS_ASIDE:return(0,a.__assign)((0,a.__assign)({},e),{isShownParticipantsAside:t.isShownParticipantsAside});case r.SET_ORATOR:return(0,a.__assign)((0,a.__assign)({},e),{orator:t.orator||null});case r.SET_PINNED_PARTICIPANT:return(0,a.__assign)((0,a.__assign)({},e),{pinnedParticipant:t.pinnedParticipant});case r.SET_ADMIN_PINNED_PARTICIPANT:return(0,a.__assign)((0,a.__assign)({},e),{adminPinnedParticipant:t.data});case r.SET_SCREEN_SHARING_PINNED_PARTICIPANT:return(0,a.__assign)((0,a.__assign)({},e),{screenSharingPinnedParticipant:t.screenSharingPinnedParticipant,screenSharingNeedDisableOratorModeAfterStop:t.screenSharingNeedDisableOratorModeAfterStop,screenSharingOldPinnedParticipant:t.screenSharingOldPinnedParticipant});case r.MANAGEMENT:return(0,a.__assign)((0,a.__assign)({},e),{isManagementOpen:t.isOpen,managementView:t.managementView});case r.CALL_STATE:return(0,a.__assign)((0,a.__assign)({},e),{callData:(0,a.__assign)((0,a.__assign)({},e.callData),t.callData)});case r.CALL_NOTIFICATION:return(0,a.__assign)((0,a.__assign)({},e),{notification:t.notification});case r.JOIN:return(0,a.__assign)((0,a.__assign)({},e),{mode:r.Mode.JOIN,join:t.data});case r.CALL_BY_NAME:return(0,a.__assign)((0,a.__assign)({},e),{mode:r.Mode.CALL_BY,callByName:t.data});case r.ERROR:return(0,a.__assign)((0,a.__assign)({},e),{mode:t.handleType===r.ErrorHandleType.FATAL?r.Mode.ERROR:e.mode,errorShown:!t.isClosed,error:{title:t.title,text:t.text,handleType:t.handleType,callId:t.callId}});case r.CHANGE_PARTICIPANT_STATE:var v=e.participants[t.participantId].statusData;return c(e,t.participantId,{statusData:(0,a.__assign)((0,a.__assign)({},v),t.data)});case r.CHANGE_PARTICIPANT_ROLES:return c(e,t.participantId,{roles:t.data});case r.CHANGE_PARTICIPANT_PERMISSIONS:var E=e.participants[t.participantId];return c(e,t.participantId,{permissions:(0,a.__assign)((0,a.__assign)({},E.permissions),t.data)});case r.SET_SCREEN_SHARER:return(0,a.__assign)((0,a.__assign)({},e),{screenSharers:(0,a.__assign)((0,a.__assign)({},e.screenSharers),(n={},n[t.participantId]=t.isScreenSharingEnabled,n))});case r.SET_FRIENDS:return(0,a.__assign)((0,a.__assign)({},e),{friends:t.data,friendsCache:(0,l.createFriendsCache)(t.data)});case r.SET_GROUP_MEMBERS:return(0,a.__assign)((0,a.__assign)({},e),{groupMembersCount:t.groupMembersCount,groupMembers:t.groupMembers,unableToCallGroupMembersIds:t.unableToCallGroupMembersIds,groupMembersCache:(0,l.createFriendsCache)(t.groupMembers)});case r.SET_SPEAKERS:var h=t.data,C=h.speakers,S=h.speakersInHeader;return(0,a.__assign)((0,a.__assign)({},e),{speakers:C||e.speakers,speakersInHeader:S||e.speakersInHeader});case r.UPDATE_PARTICIPANTS_BATCH:return(0,o.applyParticipantsBatch)(e,t.data);case r.SET_UNREAD_COUNT:return(0,a.__assign)((0,a.__assign)({},e),{chatUnreadCount:t.chatUnreadCount,chatUpToMsgId:"chatUpToMsgId"in t?t.chatUpToMsgId:e.chatUpToMsgId});case r.SHOW_CAUTION_BOX:return(0,a.__assign)((0,a.__assign)({},e),{cautionShown:t.isOpen,isIncoming:t.isIncoming});case r.SHOW_LOADER:return(0,a.__assign)((0,a.__assign)({},e),{isLoaderVisible:t.isLoaderVisible});case r.SET_TOOLTIP:var y=t.tooltips?t.tooltips:Object.keys(e.tooltips).reduce((function(e,t){return e[t]=!1,e}),{});return(0,a.__assign)((0,a.__assign)({},e),{tooltips:(0,a.__assign)((0,a.__assign)({},e.tooltips),y)});case r.MANUAL_ADD_PARTICIPANTS:return(0,a.__assign)((0,a.__assign)({},e),{participantsAddedByMe:(t.participants||[]).reduce((function(e,t){return e.add(t)}),new Set(e.participantsAddedByMe))});case r.SET_TRANSLATION:return(0,a.__assign)((0,a.__assign)({},e),{translation:(0,a.__assign)((0,a.__assign)({},e.translation),t.data)});case r.UPDATE_ANON_SECRET:return(0,a.__assign)((0,a.__assign)({},e),{anonymSecret:t.secret});case r.TOGGLE_PARTICIPANTS_KICK:return(0,a.__assign)((0,a.__assign)({},e),{participantKick:t.data?{participant:t.data.participant,type:t.data.type}:null});case r.UNBAN_PARTICIPANTS:return(0,a.__assign)((0,a.__assign)({},e),{membersUnban:t.data?{members:t.data.members}:null});case r.TOGGLE_PARTICIPANTS_MANAGEMENT:return(0,a.__assign)((0,a.__assign)({},e),{participantsManagement:t.data?{mode:t.data.mode,participant:t.data.participant}:null});case r.TOGGLE_ADMIN_ASSIGNMENT:return(0,a.__assign)((0,a.__assign)({},e),{adminAssignment:t.data?{participant:t.data.participant}:null});case r.SET_NOISE_CANCELLATION:return(0,a.__assign)((0,a.__assign)({},e),{noiseCancellation:t.data});case r.CHANGE_LOCAL_VIDEO_RESOLUTION:return(0,a.__assign)((0,a.__assign)({},e),{localVideoResolution:t.data});case r.SET_CONVERSATION_OPTIONS:return(0,a.__assign)((0,a.__assign)({},e),{conversationOptions:t.data});case r.SET_PRIVACY_SETTINGS:return(0,a.__assign)((0,a.__assign)({},e),{privacySettings:t.data});case r.SET_GROUP:return(0,a.__assign)((0,a.__assign)({},e),{groupId:t.groupId,meGroup:t.meGroup});case r.SET_WAITING_HALL:return(0,a.__assign)((0,a.__assign)({},e),{waitingHall:t.data});case r.SET_LOCAL_STATUS:return(0,a.__assign)((0,a.__assign)({},e),{localStatus:t.data});case r.SET_PUSH_TO_TALK_ENABLE:return(0,a.__assign)((0,a.__assign)({},e),{pushToTalkEnabled:t.data});case r.SET_GRID_SCROLL_POSITION:return(0,a.__assign)((0,a.__assign)({},e),{gridScrollPosition:t.data});case r.SET_ORATOR_SCROLL_POSITION:return(0,a.__assign)((0,a.__assign)({},e),{oratorScrollPosition:t.data})}return e}function c(e,t,n){var r;return(0,a.__assign)((0,a.__assign)({},e),{participants:(0,a.__assign)((0,a.__assign)({},e.participants),(r={},r[t]=(0,a.__assign)((0,a.__assign)({},e.participants[t]),n),r))})}},329538:(e,t,n)=>{"use strict";n.d(t,{loadCallPeers:()=>u,retryLoadCallPeers:()=>_,loadChatMembers:()=>m,getCallAuthToken:()=>g,getCallUrlLink:()=>f,getJoinLinkDetails:()=>v,loadFriends:()=>E,forceCallFinish:()=>h,getConversationsByCall:()=>C,getAnonymCallToken:()=>S,getCallParticipants:()=>y,videoStartStreaming:()=>N,loadUserAdminedGroupsAction:()=>T,getGroupById:()=>I,getUpcomingLives:()=>P,getVideos:()=>b,sendVideoEdit:()=>w,loadUsers:()=>L,logCallReceived:()=>M,videoLiveGetSpectators:()=>O,stopVideoStream:()=>k,loadPrivacySettings:()=>D,getGroupsForCall:()=>R,getGroupMembers:()=>B,searchGroupMembers:()=>G,getCallParticipantsApiCall:()=>x});var a=n(570655),r=n(298811),i=n(641196),o=n(464380),l=["photo_400","photo_400_orig","sex","screen_name","first_name_gen"].join(","),s=["photo_400","photo_400_orig","sex","screen_name","first_name_gen"].join(","),c=["name","photo_100","photo_400_orig","can_upload_video"].join(","),u=function(e){return(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:[e],extended:1,fields:s})},d=0,p=[],A=[],_=(0,r.exponentialRetry)((function(e,t){return void 0===t&&(t=50),p.push(e),new Promise((function(e){A.push(e),d||(d=window.setTimeout((function(){(function(e){return(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:e,extended:1,fields:s})})(p).then((function(e){A.forEach((function(t){t(e)})),A=[]})),p=[],d=0}),t))}))})),m=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationMembers",data:{peerId:e}}),(0,i.getApiWrapper)()()("messages.getConversationMembers",{peer_id:e,fields:l.concat(",can_call")}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationMembers",data:e}),e}))},g=function(e,t){return void 0===t&&(t=0),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:{isDev:e,groupId:t}}),(0,i.getApiWrapper)()()("messages.getCallToken",{env:e?"development":"production",group_id:t},{version:"5.149"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallToken",data:e}),e}))},f=((0,r.exponentialRetry)(g),function(e,t,n){void 0===n&&(n=0);var a={call_id:e,invalidate:t?1:0,group_id:n};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:a}),(0,i.getApiWrapper)()()("messages.getJoinLink",a).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getJoinLink",data:e}),e}))}),v=function(e,t){return void 0===t&&(t=!1),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallPreview",data:{link:e,fields:s,device_id:"anyId"}}),(0,i.getApiWrapper)(!t)()("messages.getCallPreview",{link:e,fields:s,device_id:"anyId"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallPreview",data:e}),e}))},E=function(){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"friends.get",data:{fields:l,order:"hints"}}),(0,i.getApiWrapper)()()("friends.get",{fields:l.concat(",can_call"),order:"hints"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"friends.get",data:e}),e}))},h=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.forceCallFinish",data:{call_id:e}}),(0,i.getApiWrapper)()()("messages.forceCallFinish",{call_id:e}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.forceCallFinish",data:e}),e}))},C=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationsByCall",data:{call_ids:e,fields:s}}),(0,i.getApiWrapper)()()("messages.getConversationsByCall",{call_ids:e,fields:s}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationsByCall",data:e}),e}))},S=function(e,t,n,a){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getAnonymCallToken",data:{link:e,user_id:t,name:n,secret:a,device_id:"anyId"}}),(0,i.getApiWrapper)(!1)()("messages.getAnonymCallToken",{link:e,user_id:t,name:n,secret:a,device_id:"anyId"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getAnonymCallToken",data:e}),e}))},y=function(e,t,n,a,o){void 0===a&&(a=!1);for(var l=[],c=Array.from(new Set(t));c.length;)c.length>100?(l.push(c.slice(0,100)),c=c.slice(100)):(l.push(c),c=[]);var u=(0,r.exponentialRetry)((function(t,r){var o=a?{call_id:e,peer_ids:r.join(","),fields:s,device_id:"anyId",secret:t.secret,user_id:n}:{call_id:e,peer_ids:r.join(","),fields:s};return(0,i.getApiWrapper)(!a)()("messages.getCallParticipants",o,{version:"5.149"}).then((function(e){return{count:e.count+t.count,secret:e.secret,profiles:(t.profiles||[]).concat(e.profiles||[]),anonyms:(t.anonyms||[]).concat(e.anonyms||[]),groups:(t.groups||[]).concat(e.groups||[])}}))})),d=Promise.resolve({secret:o,count:0});return l.reduce((function(e,t){return e.then((function(e){return u(e,t)}))}),d)},N=function(e){return(0,i.getApiWrapper)()()("video.startStreaming",e)},T=function(e){return(0,i.getApiWrapper)()()("groups.get",{fields:c,filter:e?void 0:"admin",extended:!0})},I=function(e){return(0,i.getApiWrapper)()()("groups.getById",{group_id:e,fields:c},{version:"5.149"})},P=function(e){return(0,i.getApiWrapper)()()("video.getUpcomingLives",{owner_ids:e})},b=function(e,t,n){return(0,i.getApiWrapper)()()("video.get",{owner_id:e,videos:t,need_privacy:n})},w=function(e,t,n,a,r){return(0,i.getApiWrapper)()()("video.edit",{owner_id:e,video_id:t,name:n,desc:a,privacy_view:r})},L=function(e){return(0,i.getApiWrapper)()()("users.get",e)},M=function(e){return(0,i.getApiWrapper)()()("messages.callReceived",{call_id:e})},O=function(e){return(0,i.getApiWrapper)()()("video.liveGetSpectators",{owner_id:e.owner_id,video_id:e.video_id})},k=function(){return(0,o.stopStream)()},D=function(e){return(0,i.getApiWrapper)()()("account.getPrivacySettings",e)},R=function(){return(0,i.getApiWrapper)()()("messages.getGroupsForCall",{count:200})},B=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=10);var a={fields:l.concat(",can_call_from_group"),group_id:e,offset:t,count:n,sort:"time_asc"};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"groups.getMembers",params:a}),(0,i.getApiWrapper)()()("groups.getMembers",a).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"groups.getMembers",data:e}),e}))},G=function(e,t){return void 0===t&&(t=""),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"users.search",data:{groupId:e,q:t}}),(0,i.getApiWrapper)()()("users.search",{fields:l.concat(",can_call_from_group"),group_id:e,q:t}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"users.search",data:e}),e}))};function x(e,t,n,r,l){void 0===n&&(n=!1),void 0===r&&(r=""),void 0===l&&(l=0);var c={call_id:e,peer_ids:t.join(","),fields:s};return n&&(c=(0,a.__assign)((0,a.__assign)({},c),{device_id:"anyId",secret:r,user_id:l})),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallParticipants",data:c}),(0,i.getApiWrapper)(!n)()("messages.getCallParticipants",c,{version:"5.149"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallParticipant",response:e}),e}))}},394886:(e,t,n)=>{"use strict";n.d(t,{openDesktopDeepLink:()=>r});var a=n(233194);function r(e){return new Promise((function(t,n){if(a.Platform.isMobile)n("is_mobile");else if(document.body.focus(),"hidden"===document.visibilityState||document.hidden)n("hidden_page");else{var r,i=function(){r&&clearTimeout(r),window.removeEventListener("blur",i),t(!0)};if(window.addEventListener("blur",i),r=setTimeout((function(){window.removeEventListener("blur",i),n("timed_out")}),3e3),a.Platform.BROWSER===a.BROWSER.SAFARI||a.Platform.BROWSER===a.BROWSER.FIREFOX){var o=document.createElement("iframe");o.style.display="none",document.body.appendChild(o);var l=o.contentWindow;l?(l.location.href=e,setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o)}),100)):window.location.href=e}else window.location.href=e}}))}},834735:(e,t,n)=>{"use strict";n.d(t,{preloadImage:()=>r,preloadImagesFromResponse:()=>i});var a=n(570655);function r(e){return new Promise((function(t,n){var a=new Image;a.src=e,a.onload=t,a.onerror=n}))}function i(e){var t=[].concat.apply([],(0,a.__spreadArray)([],(0,a.__read)(e))).map((function(e){var t=e.photo;return t?r(t):Promise.resolve()}));return Promise.all(t).then((function(){return e})).catch((function(){return e}))}},431469:(e,t,n)=>{"use strict";n.d(t,{useIndexer:()=>o,usePseudoLayer:()=>l,useFullScreen:()=>s});var a=n(570655),r=n(667294),i=n(337057),o=function(e,t,n){var o=(0,r.useRef)(null);o.current=o.current?o.current:new i.VkIndexer(e,t);var l=o.current,s=(0,r.useCallback)((function(e){return e.reduce((function(e,t){return e[n(t)]=!0,e}),{})}),[]),c=(0,a.__read)((0,r.useState)(e),2),u=c[0],d=c[1],p=(0,a.__read)((0,r.useState)(s(e)),2),A=p[0],_=p[1];return(0,r.useEffect)((function(){var t=s(e),a=e.filter((function(e){return!A[n(e)]})),r=u.filter((function(e){return!t[n(e)]}));(a.length||r.length)&&(a.forEach((function(e){l.add(e)})),r.forEach((function(e){l.remove(e)})),d(e),_(t))}),[e]),l};function l(){(0,r.useEffect)((function(){return document.body.classList.add("layers_shown"),function(){document.body.classList.remove("layers_shown")}}),[])}var s=function(e,t,n,a){void 0===a&&(a=[]);var i=window.document,o=i.documentElement,l=o.requestFullscreen||o.webkitRequestFullscreen;if(l){var s=!o.requestFullscreen,c=s?i.webkitExitFullscreen:i.exitFullscreen,u=s?"webkitfullscreenchange":"fullscreenchange",d=s?"webkitFullscreenElement":"fullscreenElement";(0,r.useEffect)((function(){var e=function(){i.fullscreenElement?t&&t():n&&n()};return i.addEventListener(u,e),function(){return i.removeEventListener(u,e)}}),[]),(0,r.useEffect)((function(){e&&!i[d]?l.call(i.documentElement):!e&&i[d]&&c.call(i)}),a)}}},259684:(e,t,n)=>{"use strict";n.d(t,{isCollapsedLayout:()=>r});var a=n(121255);function r(e){return e.uiMode===a.UIMode.COLLAPSED}},89085:(e,t,n)=>{"use strict";n.d(t,{longpollService:()=>_});var a=n(570655),r=n(121255),i=n(298811),o=n(788822),l=n(834735),s=n(862191),c=n(614914),u=n(389953),d=n(745284),p=n(820717),A=n(329538);function _(e,t,n,l){var _=l.dispatch,f=function(){for(var f=[],v=0;v<arguments.length;v++)f[v]=arguments[v];f.forEach((function(e){e.type===r.INCOMING_CALL&&(0,A.logCallReceived)(e.payload.call_id)}));var E=l.getState();m(E,_,e,f,n).then((function(){f.forEach((function(n){switch(n.type){case r.INCOMING_CALL:if(g(E,n))l.getState().ipSettingEnabled&&t.forceRelayPolicy(!n.payload.p2p_allowed),t.processPush(n.payload.call_id).then((function(){var e=JSON.parse((0,o.decodeHTMLEntities)(n.payload.payload)),t=e.is_video?r.CallType.VIDEO:r.CallType.AUDIO,l=(0,i.getPeerIdFromLongpoll)(n.payload),u=(0,i.isGroupCallEvent)(n);l<0&&(u=e.with_join_link),_({type:r.CHANGE_MODE,mode:r.Mode.INCOMING,peerId:l<0&&u?0:l,data:(0,a.__assign)((0,a.__assign)({},n.payload),{type:t,payload:e})}),s.callStatDataStorage.set({timeStart:Date.now(),startType:t}),c.callStats.logEvent({call_event_type:r.CallActionEventType.INCOMING_CALL_RECEIVED,session_id:n.payload.call_id,peer_id:l,is_group_call:u,reason:e.is_video?r.CallType.VIDEO:r.CallType.AUDIO})})).catch((function(t){if(e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug)if("object"==typeof t){var n=t.hangup,a=t.message;console.error("Push process error",n,a)}else console.error("Push process error",t)}));else if(n.type===r.INCOMING_CALL){var A=function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(new Error(t)),e.debug&&console.warn("Incoming push skipped:",t,n)};switch(!0){case!n.payload.call_id:A("old lib call");break;case E.mode===r.Mode.CALL||E.mode===r.Mode.INCOMING:A("already in a call"),t.processPush(n.payload.call_id).then((function(){e.eventHandlers.onError&&e.eventHandlers.onError(new Error("processPush was incorrect accepted with call_id: "+n.payload.call_id)),e.debug&&console.warn("processPush was incorrect accepted",n.payload.call_id)})).catch((function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug&&console.warn("processPush rejected:",t,n.payload.call_id)}));break;default:A("reason of decline is unknown")}}break;case r.ADD_MESSAGE:var m=l.getState(),f=(0,u.isChatPeer)(m.peer),v=m.callData.callId;if(m.peer!==n.peerId||n.flags&r.FLAG_OUTBOUND||m.me===n.userId||_({type:r.SET_UNREAD_COUNT,chatUnreadCount:m.chatUnreadCount?m.chatUnreadCount+1:1}),f||!(0,d.isActiveGroupCallMessage)(n))return;var h=n.peerId;if(v===n.kludges.attach1_call_id)return(0,p.loadCallPeersWithWaitingImagesAction)(l.getState(),_,h);break;case r.READ_INBOUND:null!==n.chatUnreadCount&&l.getState().peer===n.peerId&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:n.unread,chatUpToMsgId:n.upToId});break;case r.SET_FLAGS:(m=l.getState()).peer===n.peerId&&null!==m.chatUpToMsgId&&n.messageId>m.chatUpToMsgId&&!(n.flags&r.FLAG_OUTBOUND)&&(n.flags&r.FLAG_DELETED||n.flags&r.FLAG_SPAM)&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:m.chatUnreadCount?m.chatUnreadCount-1:0});break;case r.DELETE_DIALOG:l.getState().peer===n.peerId&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:0,chatUpToMsgId:null});break;case r.EDIT_MESSAGE:case r.REPLACE_MESSAGE:(m=l.getState()).peer===n.peerId&&null!==m.chatUpToMsgId&&n.messageId>m.chatUpToMsgId&&n.kludges.is_expired&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:m.chatUnreadCount?m.chatUnreadCount-1:0});break;case r.CONVERSATION_UPDATED:h=n.peerId;var C=n.updateType;if(l.getState().peer!==h)return;if(C!==r.MAIL_CHAT_UPDATE_TYPE_CALL_IN_PROGRESS_CHANGED)return;void 0!==l.getState().callData.canFinishCall&&l.getState().callData.hasUrlLink||(0,p.loadActiveCallDataAction)(l.getState(),_,h)}}))})).catch((function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug&&console.error("Resource loading error",t),f.forEach((function(e){switch(e.type){case r.INCOMING_CALL:if(!g(E,e))return;_({type:r.ERROR,text:n("calls_incoming_process_error"),handleType:r.ErrorHandleType.PROCESS,callId:e.payload.call_id})}}))}))};if(e.handleEvent=f,void 0!==window.Notifier){var v=window.Notifier.getLpInstance();v&&v.onData(f)}}function m(e,t,n,a,s){var c=a.reduce((function(a,c){switch(c.type){case r.INCOMING_CALL:if(!g(e,c)){a.push(Promise.resolve());break}var u=(0,i.isGroupCallEvent)(c),A=u,_=(0,i.convertCallerFromLongpoll)(c.payload);if(!u&&_.peerId<0)JSON.parse((0,o.decodeHTMLEntities)(c.payload.payload)).with_join_link&&(A=!0);if(A){var m=u?(0,i.convertChatFromLongpoll)(c.payload):(0,d.getDefaultConversation)(s);if(t({type:r.LOAD_PEERS,conversation:m,members:[_],peerId:m.peerId,caller:u?m:_}),m.photo&&a.push((0,l.preloadImage)(m.photo)),u){var f=(0,p.loadCallPeersWithoutWaitingImagesAction)(e,t,n,m.peerId);a.push(f)}}else t({type:r.LOAD_PEERS,conversation:_,members:[_],peerId:_.peerId});_.photo&&a.push((0,l.preloadImage)(_.photo))}return a}),[]);return Promise.all(c)}function g(e,t){return function(e){return!!e.payload.call_id}(t)&&e.mode!==r.Mode.INCOMING&&e.mode!==r.Mode.CALL}},147853:(e,t,n)=>{"use strict";n.d(t,{pushToTalkToggleAudio:()=>l,pushToTalkActivate:()=>s,pushToTalkDeactivate:()=>c,onPushToTalkHandler:()=>p});var a=n(745284),r=n(121255),i=n(464380),o=!1;function l(e,t,n){if(void 0===n&&(n=!0),e){var a=!(!t||!t.isAudioEnabled);n&&(o=a),a&&(0,i.toggleLocalAudio)(!1)}else o&&(0,i.toggleLocalAudio)(!0)}function s(e){window.addEventListener("keydown",e),window.addEventListener("keyup",e)}function c(e){window.removeEventListener("keydown",e),window.removeEventListener("keyup",e)}var u,d=!1;function p(e,t,n,o){var l=e.keyCode,s=e.type,c=e.repeat,p="keydown"===s;if(32===l){if(e&&e.target){if(["FCComposer__input","FCSearch__input","fc_editable","fc_clist_filter_text"].some((function(t){return e.target.classList.contains(t)})))return}if(e.preventDefault(),c)return;if(d)return clearTimeout(u),void(d=!1);d=!0,u=setTimeout((function(){(function(e,t,n,o){var l=function(){var t,i,l=(null===(t=o.notification)||void 0===t?void 0:t.type)===r.NotificationType.PUSH_TO_TALK,s=!1;if(e&&!l?s=!0:e&&l?s=(null===(i=o.notification)||void 0===i?void 0:i.data)!==(0,a.isIAmSpeaking)(o):!e&&l&&(s=!0),s){var c=null;e&&(c={type:r.NotificationType.PUSH_TO_TALK,timer:0,data:(0,a.isIAmSpeaking)(o)}),n({type:r.CALL_NOTIFICATION,notification:c})}};return e&&t||!e&&!t?Promise.resolve().then(l):(0,i.toggleLocalAudio)(e).then(l)})(p,t,n,o).then((function(){d=!1}))}),p?200:100)}}},253312:(e,t,n)=>{"use strict";n.d(t,{sdkService:()=>T,getCallStartErrorText:()=>k});var a=n(570655),r=n(121255),i=n(329538),o=n(298811),l=n(834735),s=n(387691),c=n(169610),u=n(525046),d=n(774351),p=n(389953),A=n(745284),_=n(170794),m=n(862191),g=n(614914),f=n(820717),v=n(307915),E=n(697483),h=n(768606),C=n(464380),S=n(604233),y=n(613335),N=n(719481);function T(e,t,n,y,T,k){var B=y.dispatch,G=y.getState(),x=G.me,H=(0,o.compose)(L,o.startCallRetryWrapper.bind(null,P.bind(null,t,e,y))),U=(0,o.compose)(t.joinCallByLink,o.startCallRetryWrapper.bind(null,P.bind(null,t,e,y))),V={apiKey:n.key,apiEnv:n.is_dev?"VIDEOTEST":"PROD",anonymToken:n.is_anonym?n.token:"",filteredMessages:!0,voiceParams:{speakerLevelMultiplier:1.3,smoothing:.5},domain:k?"vk_corp":void 0,consumerScreenDataChannel:!0,producerNotificationDataChannel:!0,producerCommandDataChannel:!0,producerScreenDataChannel:!0,preferVP9:!0,videoTracksCount:G.config.enableVideoSlots?G.config.videoSlotsCount:void 0,videoMaxHeight:G.localVideoResolution===r.VideoResolutionTypes.SD?r.VideoHeight.SD:r.VideoHeight.HD,videoMaxWidth:G.localVideoResolution===r.VideoResolutionTypes.SD?r.VideoWidth.SD:r.VideoWidth.HD,debugLog:G.config.debugLog,onDemandTracks:!0,consumerScreenTrack:G.config.enableScreenTrack,producerScreenTrack:G.config.enableProducerScreenTrack,onLocalStream:function(t,n){e.debug&&console.warn("onLocalStream",t,n),(0,h.throttleAccumulateDispatchParticipant)(B,x,{stream:t,mediaSettings:n}),m.callStatDataStorage.set({hadVideoEnabled:n.isVideoEnabled})},onLocalStreamUpdate:function(t,n){e.debug&&console.warn("onLocalStreamUpdate",t,n);var a=y.getState(),i=a.participants[x],o=i.mediaSettings,l=i.permissions,s={mediaSettings:t};l.audio!==r.MediaPermissionType.ONCE&&l.video!==r.MediaPermissionType.ONCE&&l.screenSharing!==r.MediaPermissionType.ONCE||(s.permissions={},l.audio===r.MediaPermissionType.ONCE&&(null==o?void 0:o.isAudioEnabled)&&!t.isAudioEnabled&&(s.permissions.audio=r.MediaPermissionType.DENY),l.video===r.MediaPermissionType.ONCE&&(null==o?void 0:o.isVideoEnabled)&&!t.isVideoEnabled&&(s.permissions.video=r.MediaPermissionType.DENY),l.screenSharing===r.MediaPermissionType.ONCE&&(null==o?void 0:o.isScreenSharingEnabled)&&!t.isScreenSharingEnabled&&(s.permissions.screenSharing=r.MediaPermissionType.DENY)),(0,h.throttleAccumulateDispatchParticipant)(B,x,s),t.isScreenSharingEnabled!==(null==o?void 0:o.isScreenSharingEnabled)&&(R(a,B,t.isScreenSharingEnabled,x),t.isScreenSharingEnabled?e.eventHandlers.onScreenSharingEnabled&&e.eventHandlers.onScreenSharingEnabled():e.eventHandlers.onScreenSharingDisabled&&e.eventHandlers.onScreenSharingDisabled()),m.callStatDataStorage.set({hadVideoEnabled:t.isVideoEnabled})},onRemoteStream:function(t,n){e.debug&&console.warn("onRemoteStream",t.id,n),(0,h.throttleAccumulateDispatchParticipant)(B,t.id,{stream:n})},onScreenStream:function(t,n){e.debug&&console.warn("onScreenStream",t,n);var a={screenSharingStream:t,mediaSettings:n};(0,h.throttleAccumulateDispatchParticipant)(B,x,a)},onRemoteScreenStream:function(t,n){e.debug&&console.warn("onRemoteScreenStream",t.id,n),(0,h.throttleAccumulateDispatchParticipant)(B,t.id,{screenSharingStream:n})},onConversation:function(t){if(e.debug&&console.warn("onConversation",t),!y.getState().callData.ts){var n=Date.now();B({type:r.TIME_START,data:n})}var a=y.getState().peer;0!==a&&(0,f.loadActiveCallDataAction)(G,B,a)},onRemoteMediaSettings:function(t,n){var a,r;e.debug&&console.warn("onRemoteMediaSettings",t.id,n);var i=+t.id,o=y.getState(),l=(null===(r=null===(a=o.participants[i])||void 0===a?void 0:a.mediaSettings)||void 0===r?void 0:r.isScreenSharingEnabled)||!1;n.isScreenSharingEnabled!==l&&R(o,B,n.isScreenSharingEnabled,i,!0),(0,h.throttleAccumulateDispatchParticipant)(B,i,{mediaSettings:n}),m.callStatDataStorage.set({hadVideoEnabled:n.isVideoEnabled})},onParticipantStatus:function(t,n,a){var i=+t.id,o=y.getState(),l=n;e.debug&&console.warn("onParticipantStatus",i,l,a);var s=o.peer;if(!(0,A.isGroupCallByPeer)(s)){var c=Object.keys(o.participants).length;2!==c||i in o.participants?c>2&&(s=0):s=0}if(!(o.participants[i]&&o.participants[i].mediaSettings&&o.participants[i].shortName||l!==C.ParticipantStatus.WAITING)){var u=[i],d=o.callData.callId||"",p={withConversation:!y.getState().callData.conversation,awaitImages:!1};(0,f.loadCallParticipantsAccumulate)(o,B,e,d,u,p)}if((0,h.throttleAccumulateDispatchParticipant)(B,i,{status:l,statusData:a}),m.callStatDataStorage.set({connectionStep:l}),i===o.peer){var _=function(e,t){var n={call_event_type:e,session_id:o.callData.callId,peer_id:o.peer,is_group_call:!1};t&&(n.reason=t),g.callStats.logEvent(n)};if(l===C.ParticipantStatus.CONNECTED){if(_(r.CallActionEventType.CALL_CONNECTED),!o.participants[o.peer].wasConnected&&(0,E.isCreator)(o.participants[o.me])){var v=m.callStatDataStorage.get().startType;_(r.CallActionEventType.OUTGOING_CALL_ACCEPTED_REMOTELY,null==v?void 0:v.toString())}}else l===C.ParticipantStatus.WAITING&&_(r.CallActionEventType.OUTGOING_CALL_REMOTE_RINGING)}},onPermissionsError:function(n){if(e.debug&&console.warn("onPermissionsError",n),y.getState().mode===r.Mode.CALL){switch(n){case r.MediaError.CAMERA_PERMISSION:case r.MediaError.CAMERA_ACCESS:t.toggleLocalVideo(!1);break;case r.MediaError.MIC_ACCESS:case r.MediaError.MIC_NOT_FOUND:t.toggleLocalAudio(!1);break;case r.MediaError.SCREEN_PERMISSION:case r.MediaError.SCREEN_ACCESS:t.captureScreen(!1)}B({type:r.ERROR,text:(0,v.getMediaErrorMessage)(n,T)})}},onPermissionsRequested:function(){e.debug&&console.warn("onPermissionsRequested")},onRemoteRemoved:function(t){e.debug&&console.warn("onRemoteRemoved",t.id),B({type:r.REMOVE_USER,participantId:+t.id})},onCallState:function(t,n,i){e.debug&&console.warn("onCallState",t,n,i);var o=i.id,l=i.direction;if(!o||!y.getState().callData.callId){if(B({type:r.CALL_STATE,callData:{callId:o}}),!y.getState().peer){var s=Object.keys(y.getState().participants||{}).map((function(e){return Number(e)}));s.length&&(0,f.loadCallParticipantsAccumulate)(G,B,e,o,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(s)),[y.getState().me]),{withConversation:!0,withChatMembers:!0,withCallParticipants:!0,awaitImages:!1})}!(0,A.isGroupCallByPeer)(y.getState().peer||0)||"JOINING"!==l&&"OUTGOING"!==l||g.callStats.logEvent({call_event_type:r.CallActionEventType.CALL_CONNECTED,session_id:o,peer_id:y.getState().peer||0,is_group_call:!0})}},onRateNeeded:function(){e.debug&&console.warn("onRateNeeded")},onSpeakerChanged:function(t){var n=t.id;e.debug&&console.warn("onSpeakerChanged",n),B({type:r.SET_ORATOR,orator:+n})},onJoinStatus:function(t,n){e.debug&&console.warn("onJoinStatus",t,n)},onHangup:function(n,a){var i=n.hangup;e.debug&&console.warn("onHangup",i,a);var l=i&&![r.HANGUP_TYPE_CANCELED,r.HANGUP_TYPE_MISSED,r.HANGUP_TYPE_HUNGUP,r.HANGUP_TYPE_REMOVED].includes(i),s=i&&i===r.HANGUP_TYPE_HUNGUP,c=(0,A.isGroupCallByPeer)(y.getState().peer);if(y.getState().mode===r.Mode.CALL&&l||y.getState().localStatus===C.ParticipantStatus.WAITING_HALL&&i===r.HANGUP_TYPE_REMOVED)B({type:r.HANGUP,data:i}),(0,d.pause)(r.HANGUP_DELAY,null).finally((function(){B({type:r.CHANGE_MODE,mode:r.Mode.READY})}));else if(G.config.showFeedbackScreen&&s){var u=y.getState().callData.ts,p=(u?Math.floor((Date.now()-u)/1e3):0)>10&&0===Math.floor(3*Math.random()),f=0===Math.floor(5*Math.random());c&&p||f?(B({type:r.MANAGEMENT,isOpen:!1}),B({type:r.CHANGE_MODE,mode:r.Mode.FEEDBACK})):y.getState().mode!==r.Mode.ERROR&&B({type:r.CHANGE_MODE,mode:r.Mode.READY})}else y.getState().mode!==r.Mode.ERROR&&B({type:r.CHANGE_MODE,mode:r.Mode.READY});e.isInActiveCall=!1;var v=(0,o.isInReconnect)(y.getState());if(a=a||"",(0,_.addCallStatEvent)(i,a,v,e.debug),!v&&!c){var E="none";i===C.HangupType.MISSED?E="timeout":i===C.HangupType.BUSY&&(E="busy");var h=y.getState().callData.conversation,S={call_event_type:r.CallActionEventType.CALL_DECLINED_OR_HANGED_REMOTELY,session_id:a,peer_id:(null==h?void 0:h.peerId)||0,is_group_call:!1,reason:E};g.callStats.logEvent(S)}e.authorizedGroupId&&function(e,t,n,a){w(e,t,n,0,a)}(t,e,y,B),m.callStatDataStorage.reset()},onCallAccepted:function(){e.debug&&console.warn("onCallAccepted"),(0,A.isGroupCallByPeer)(y.getState().peer)&&g.callStats.logEvent({call_event_type:r.CallActionEventType.CALL_CONNECTED,session_id:y.getState().callData.callId,peer_id:y.getState().peer,is_group_call:(0,A.isGroupCallByPeer)(y.getState().peer)})},onTokenExpired:function(){e.debug&&console.warn("onTokenExpired"),(e.tokenAttempts||0)<3&&(P(t,e,y),e.tokenAttempts=(e.tokenAttempts||0)+1)},onDeviceChange:function(){e.debug&&console.warn("onDeviceChange")},onMultipartyChatCreated:function(){e.debug&&console.warn("onMultipartyChatCreated")},onFingerprintChange:function(t){e.debug&&console.warn("onFingerprintChange",t)},onVolumesDetected:(0,s.volumesDetectorGenerator)({onUpdate:function(e){B({type:r.SET_SPEAKERS,data:e})},volumeLevelDetection:r.VOLUME_LEVEL_DETECTION,debugCallback:function(){e.debug}}),onLocalVolume:(0,s.localVolumeDetectorGenerator)({onVolumeLevelReached:function(){var e=y.getState();B({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.SPEAKING_ON_MUTE}}),g.callStats.logEvent({call_event_type:r.CallActionEventType.MIC_OFF_WHILE_TALKING_ALERT,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,A.isGroupCallByPeer)(e.peer)})},onVolumeLevelUpdated:function(e){var t,n=null===(t=y.getState().participants[x].mediaSettings)||void 0===t?void 0:t.isAudioEnabled,a=y.getState().speakers,i=Object.assign({},a);e&&n?i[x]=!0:e||delete i[x],i[x]!==a[x]&&B({type:r.SET_SPEAKERS,data:{speakers:i}})},needCheckMicEnabled:!0,volumeLevelDetection:r.VOLUME_LEVEL_DETECTION,vectorLength:5,callbackFactorStep:0,sensitivityCoefficient:.45,debugCallback:function(){e.debug}}),onChatMessage:function(t,n,a){e.debug&&console.warn("onChatMessage",t,n,a)},onCustomData:function(t,n){e.debug&&console.warn("onCustomData",t,n)},onNetworkStatusChanged:function(t){var n,r;if(e.debug&&console.warn("onNetworkStatusChanged",t),(0,A.isGroupCallByPeer)(G.peer)&&G.config.badNetwork||!(0,A.isGroupCallByPeer)(G.peer)&&G.config.badNetworkP2P)try{for(var i=(0,a.__values)(t),o=i.next();!o.done;o=i.next()){var l=o.value;(0,h.throttleAccumulateDispatchParticipant)(B,+l.uid.id,{networkStatus:l.rating})}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},onLocalNetworkStatusChanged:function(t){e.debug&&console.warn("onLocalNetworkStatusChanged",t),((0,A.isGroupCallByPeer)(G.peer)&&G.config.badNetwork||!(0,A.isGroupCallByPeer)(G.peer)&&G.config.badNetworkP2P)&&(0,h.throttleAccumulateDispatchParticipant)(B,G.me,{networkStatus:t})},onDebugMessage:function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e.debug&&console.warn.apply(console,(0,a.__spreadArray)(["onDebugMessage",t],(0,a.__read)(n)))},onRemoteParticipantState:function(t,n){var i,o,l;e.debug&&console.warn("onRemoteParticipantState",t,n);var s=function(e){return e.hand?(0,a.__assign)((0,a.__assign)({},e),{hand:e.hand===r.SdkHandType.RAISED}):e}(n),c=t.id,u=!!(null===(o=null===(i=y.getState().participants[c])||void 0===i?void 0:i.statusData)||void 0===o?void 0:o.hand),d=!!(null===(l=y.getState().participants[c])||void 0===l?void 0:l.name);(0,h.throttleAccumulateDispatchParticipant)(B,c,{statusData:s}),(null==s?void 0:s.hand)&&!u&&d&&B({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.RAISED_HAND,data:c}})},onRolesChanged:function(t,n){e.debug&&console.warn("onRolesChanged",t,n);var a=y.getState().participants[t.id];n.includes(C.UserRole.ADMIN)&&a&&B({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.USER_GRANTED_WITH_ADMIN_ROLE,data:t.id}}),(0,h.throttleAccumulateDispatchParticipant)(B,t.id,{roles:n})},onLocalRolesChanged:function(t){e.debug&&console.warn("onLocalRolesChanged",t),(t.includes(C.UserRole.ADMIN)||t.includes(C.UserRole.CREATOR))&&(0,h.throttleAccumulateDispatchParticipant)(B,x,{permissions:{audio:r.MediaPermissionType.ALLOW,video:r.MediaPermissionType.ALLOW,screenSharing:r.MediaPermissionType.ALLOW}}),t.includes(C.UserRole.ADMIN)&&B({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.ADMIN_ROLE_GRANTED}}),t.includes(C.UserRole.ADMIN)||t.includes(C.UserRole.CREATOR)?G.config.allowWaitingHall&&(0,A.isWaitingHallEnabled)(y.getState())&&(0,N.loadAdditionalWaitingHall)(y.getState(),B,!0):y.getState().waitingHall&&(0,N.clearWaitingList)(B),B({type:r.CHANGE_PARTICIPANT_ROLES,participantId:x,data:t})},onDeviceSwitched:function(t,n){e.debug&&console.warn("onDeviceSwitched",t,n)},onUnmutePermission:function(t){e.debug&&console.warn("onUnmutePermission",t);var n=y.getState(),a=n.participants[x],i=n.popup;if(t||i!==r.POPUP_UNMUTE_REQUEST||B({type:r.TOGGLE_POPUP}),!(0,E.isAdmin)(a)&&!(0,E.isCreator)(a)){var o=a.permissions,l=o.audio,s=o.video,c=o.screenSharing;l===r.MediaPermissionType.DENY&&s===r.MediaPermissionType.DENY&&c===r.MediaPermissionType.DENY||B({type:r.CALL_NOTIFICATION,notification:{type:t?r.NotificationType.ADMIN_MUTE:r.NotificationType.ADMIN_MUTE_PERMANENT}}),(0,h.throttleAccumulateDispatchParticipant)(B,x,{permissions:{audio:t?r.MediaPermissionType.ALLOW:r.MediaPermissionType.DENY,video:t?r.MediaPermissionType.ALLOW:r.MediaPermissionType.DENY,screenSharing:t?r.MediaPermissionType.ALLOW:r.MediaPermissionType.DENY}}),t&&g.callStats.logEvent({call_event_type:r.CallActionEventType.MIC_OFF_WHILE_TALKING_ENABLE_CLICK,session_id:n.callData.callId,peer_id:n.peer,is_group_call:(0,A.isGroupCallByPeer)(n.peer)})}},onUnmuteRequest:function(n){var i;if(e.debug&&console.warn("onUnmuteRequest",n),n!==C.MediaOption.VIDEO){var o=y.getState(),l=o.participants[o.me],s=l.permissions,c=s.audio,u=s.video,d=s.screenSharing,p=(0,E.isMutedPermanently)(l),A=!!(null===(i=l.statusData)||void 0===i?void 0:i.hand);A&&t.changeParticipantState({hand:r.SdkHandType.LOWERED}).catch(console.log),(0,h.throttleAccumulateDispatchParticipant)(B,x,(0,a.__assign)({permissions:{audio:p?r.MediaPermissionType.ONCE:c,video:p?r.MediaPermissionType.ONCE:u,screenSharing:p?r.MediaPermissionType.ONCE:d}},A&&{statusData:(0,a.__assign)((0,a.__assign)({},l.statusData),{hand:!1})})),B({type:r.TOGGLE_POPUP,data:r.POPUP_UNMUTE_REQUEST})}},onRecordStarted:function(t,n,a,i,o,l){e.debug&&console.warn("onRecordStarted",t,n,a,i);var s={isOn:!0,videoId:parseInt(o),ownerId:parseInt(l),host:t,startTime:a,link:"https://"+window.location.host+(0,S.getShortVideoUrl)(l,o),startStreamParams:void 0};B({type:r.SET_TRANSLATION,data:s})},onRecordStopped:function(){e.debug&&console.warn("onRecordStopped"),B({type:r.SET_TRANSLATION,data:{isOn:!1,hasPermission:!1}})},onLocalPin:function(t){var n;e.debug&&console.warn("onLocalPin",{unpin:t});var a=y.getState(),i=a.participants[x];t||B({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.PINNED_BY_ADMIN}}),!t&&(0,E.isMutedPermanently)(i)&&(0,h.throttleAccumulateDispatchParticipant)(B,x,{permissions:{audio:r.MediaPermissionType.ONCE,video:r.MediaPermissionType.ONCE,screenSharing:r.MediaPermissionType.ONCE}}),t||(null===(n=i.mediaSettings)||void 0===n?void 0:n.isAudioEnabled)||B({type:r.TOGGLE_POPUP,data:r.POPUP_ADMIN_PIN_UNMUTE_REQUEST}),t||a.isOratorMode||B({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0}),B({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:t?null:x})},onPinnedParticipant:function(t,n){e.debug&&console.warn("onPinnedParticipant",t,n);var a=y.getState(),i=a.participants[t.id];!n&&i&&((null==i?void 0:i.shortName)||(null==i?void 0:i.name))&&B({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.USER_PINNED_BY_ADMIN,data:t.id}}),a.isOratorMode||B({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0}),B({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:n?null:Number(t.id)})},onOptionsChanged:function(t){e.debug&&console.warn("onOptionsChanged",t),B({type:r.SET_CONVERSATION_OPTIONS,data:t})},onLocalStatus:function(t){e.debug&&console.warn("onLocalStatus",t);var n=y.getState(),o=n.localStatus,s=n.callData,c=n.me;o!==C.ParticipantStatus.WAITING_HALL||t!==C.ParticipantStatus.WAITING||(0,E.isParticipantAnonym)(c)||(null==s?void 0:s.callId)&&(0,i.getConversationsByCall)([s.callId]).then((function(e){var t=e.items,n=(0,a.__read)(t,1)[0].peer.id;return M(y,n,void 0).then((function(e){return(0,l.preloadImagesFromResponse)(e)})).then((function(){return n}))})).catch((function(e){var t;8===(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_code)&&Promise.resolve(0)})),B({type:r.SET_LOCAL_STATUS,data:t}),(0,h.throttleAccumulateDispatchParticipant)(B,G.me,{status:t,wasConnected:!0})},onChatRoomUpdated:function(t,n,a){e.debug&&console.warn("onChatRoomUpdated",t,n,a),t===C.ChatRoomEventType.ATTENDEE&&(0,N.loadWaitingHall)(n,a,y.getState(),B)}};e.authorized=!1,e.authorizedGroupId=0,e.debugMessage=C.debugMessage,e.call=function(e,t,n,a,i){var o=a.dispatch;return function(s,u,d,p,_){void 0===_&&(_=0);var f=(0,A.getMediaOptions)({video:u,audio:!0});return e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(I):(e.isInActiveCall=!0,Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return b(e)})).then((function(){return w(t,e,a,_,o)})).then((function(){return(0,c.checkPermissions)(t,f)})).then((function(){return M(a,s,d)})).then((function(n){return Promise.all([(0,l.preloadImagesFromResponse)(n),i(e,t,a,f,s)])})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:s}),m.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,entryPoint:p,startType:u?r.CallType.VIDEO:r.CallType.AUDIO}),g.callStats.logEvent({call_event_type:u?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:a.getState().callData.callId,peer_id:s,is_group_call:!1,source:p,group_call_users_count:2}),O(a,s,d)})).catch((function(a){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),D(a,t,e,(0,A.isGroupCallByPeer)(s),n,o)})))}}(e,t,T,y,H),e.startGroupCall=function(e,t,n,a,i){var o=a.dispatch;return function(l,s,u,d,_,v,E){void 0===v&&(v=!0),void 0===E&&(E=null);var h=(0,A.getMediaOptions)({video:d,audio:!0}),C=u?u.filter(p.isUserPeer):[];return e.debug&&u&&u.length!==C.length&&console.warn("Some ids cannot get into the call.",u.filter((function(e){return!(0,p.isUserPeer)(e)}))),e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(I):(e.isInActiveCall=!0,Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return b(e)})).then((function(){return w(t,e,a,0,o)})).then((function(){return(0,c.checkPermissions)(t,h)})).then((function(){return M(a,l,s)})).then((function(e){return(0,f.loadChatMembersAction)(a.getState(),o,l,e[0])})).then((function(){return i(e,t,a,h,l)})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:l}),v&&(C&&C.length?o({type:r.GROUP_CALL_SETUP,open:!0,peerId:l,preselectedIds:C}):o({type:r.MANAGEMENT,isOpen:!0})),E&&o({type:r.SET_TRANSLATION,data:{deferredId:E}}),O(a,l,s),m.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,startType:d?r.CallType.VIDEO:r.CallType.AUDIO,entryPoint:_,isGroupCall:!0}),g.callStats.logEvent({call_event_type:d?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:a.getState().callData.callId,peer_id:l,is_group_call:!0,source:_,group_call_users_count:1})})).catch((function(a){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),D(a,t,e,(0,A.isGroupCallByPeer)(l),n,o)})))}}(e,t,T,y,H),e.startCall=function(e,t,n,a,i){var o=a.dispatch;return function(s,u,d,p){void 0===d&&(d=!0),void 0===p&&(p=0);var _=(0,A.getMediaOptions)({video:s,audio:!0});if(e.isInActiveCall)return Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(I);e.isInActiveCall=!0;var f=(0,A.getDefaultConversation)(n);return Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return b(e)})).then((function(){return w(t,e,a,p,o)})).then((function(){return(0,c.checkPermissions)(t,_)})).then((function(){return Promise.all([i(e,t,a,_),(0,l.preloadImagesFromResponse)([f])])})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.LOAD_PEERS,conversation:f,members:[],peerId:0}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL}),d&&o({type:r.MANAGEMENT,isOpen:!0}),m.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,entryPoint:u,startType:s?r.CallType.VIDEO:r.CallType.AUDIO,isGroupCall:!0}),g.callStats.logEvent({call_event_type:s?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:a.getState().callData.callId,peer_id:0,is_group_call:!0,source:u,group_call_users_count:1})})).catch((function(a){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),D(a,t,e,!0,n,o)}))}}(e,t,T,y,H),e.joinCallByLink=function(e,t,n,o,s){var u=o.dispatch;return function(d,p,_,m,f,v){void 0===_&&(_=!1),void 0===f&&(f=0),void 0===v&&(v=void 0);var h=(0,A.getMediaOptions)({video:_,audio:!0});return e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(I):(e.isInActiveCall=!0,(0,E.isParticipantAnonym)(o.getState().me)?Promise.resolve().then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return b(e)})).then((function(){return(0,c.checkPermissions)(t,h)})).then((function(){return s(d,h).then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!1}),u({type:r.CHANGE_MODE,mode:r.Mode.CALL})}))})).catch((function(a){e.isInActiveCall=!1,u({type:r.SHOW_LOADER,isLoaderVisible:!1}),D(a,t,e,!0,n,u)})):Promise.resolve().then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return b(e)})).then((function(){return w(t,e,o,f,u)})).then((function(){return(0,c.checkPermissions)(t,h)})).then((function(){return s(d,h)})).then((function(e){var t=e.id;return(0,i.getConversationsByCall)([t])})).then((function(e){var t=e.items,n=(0,a.__read)(t,1)[0].peer.id;return M(o,n,p).then((function(e){return(0,l.preloadImagesFromResponse)(e)})),n})).catch((function(e){var t,n;if(8===(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_code))return 0;if(951===(null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.error_code))return 0;throw e})).then((function(e){u({type:r.SHOW_LOADER,isLoaderVisible:!1}),u({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:e}),v&&u({type:r.SET_TRANSLATION,data:{deferredId:v}}),e&&O(o,e,p),g.callStats.logEvent({call_event_type:r.CallActionEventType.GROUP_CALL_JOINED,session_id:o.getState().callData.callId,peer_id:null!=e?e:0,is_group_call:!0,source:m,group_call_users_count:(0,E.getActiveParticipants)(o.getState().participants,o.getState().me,o.getState().groupId,o.getState().meGroup).length})})).catch((function(a){e.isInActiveCall=!1,u({type:r.SHOW_LOADER,isLoaderVisible:!1}),D(a,t,e,!0,n,u)})))}}(e,t,T,y,U),e.showJoinPopup=function(e,t,n){var l=n.dispatch;return function(s,c){var u=n.getState().mode;return u===r.Mode.CALL||u===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch((function(){l({type:r.ERROR,text:t("calls_already_in_call_error")})})):(l({type:r.SHOW_LOADER,isLoaderVisible:!0}),(0,i.getJoinLinkDetails)(s).then(o.normalizePreviewData.bind(null,t)).then((function(e){l({type:r.SHOW_LOADER,isLoaderVisible:!1}),l({type:r.JOIN,data:(0,a.__assign)((0,a.__assign)({},e),{entryPoint:c})})})).catch((function(n){var a;e.eventHandlers.onError&&n&&e.eventHandlers.onError(n),e.debug&&console.warn("getJoinLinkDetails",n);var i=(0,o.getTextForApiErrorByCode)(null===(a=null==n?void 0:n.error)||void 0===a?void 0:a.error_code,!0,t);console.error(i),l({type:r.SHOW_LOADER,isLoaderVisible:!1}),l({type:r.ERROR,text:i,handleType:r.ErrorHandleType.FATAL})})))}}(e,T,y),e.acceptCall=function(e,t,n,a){var i=a.dispatch;return function(o,l){var s=a.getState(),u=s.peer,d=s.callData,p=(0,A.getMediaOptions)({video:o,audio:l});return(0,c.checkPermissions)(t,p).then((function(){return t.acceptCall(p)})).then((function(t){var n=t.acceptTime;i({type:r.CHANGE_MODE,mode:r.Mode.CALL,ts:n}),e.isInActiveCall=!0,g.callStats.logEvent({call_event_type:r.CallActionEventType.INCOMING_CALL_ACCEPTED,session_id:d.callId,peer_id:u,is_group_call:(0,A.isGroupCallByPeer)(u),reason:o?r.CallType.VIDEO:r.CallType.AUDIO})})).catch((function(t){i({type:r.ERROR,text:(0,v.getPermissionsErrorMessage)(o,!0,n),handleType:r.ErrorHandleType.DECLINE}),e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),(0,C.debugMessage)(C.DebugMessageType.ERROR,t),console.error(t)}))}}(e,t,T,y),e.showCallByNamePopup=function(e,t,n,a){var i=a.dispatch;return function(e,t,o){var l=a.getState().mode;return l===r.Mode.CALL||l===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch((function(){i({type:r.ERROR,text:n("calls_already_in_call_error")})})):Promise.resolve().then((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!1}),i({type:r.CALL_BY_NAME,data:{peerId:e,joinLink:o,entryPoint:t}})})).catch((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!1})}))}}(0,0,T,y),e.store=y;var F=n.token?Promise.resolve(n.token):(0,u.fetchToken)(n.is_dev);return F.then((function(n){return t.init(V).then((function(){G.config.debugLog&&e.setDebug(!0)})).then((function(){return function(n){return Promise.resolve().then((function(){return(0,E.isParticipantAnonym)(y.getState().me)?Promise.resolve():t.authorize(n).then((function(){return(0,u.saveLocalToken)(n)})).then((function(){return e.authorized=!0})).catch((function(e){throw(0,u.removeLocalToken)(),e}))}))}(n)}))}))}function I(e){switch(e){case r.CallErrorType.ALREADY_IN_CALL:console.log("Already in call");break;default:console.log(e)}}function P(e,t,n){return function(e,t,n){return(0,i.getCallAuthToken)(n.getState().isDev).then((function(n){var a=n.token;return e.authorize(a).then((function(){return(0,u.saveLocalToken)(a)})).then((function(){return t.authorized=!0}))}))}(e,t,n).catch((function(e){t.eventHandlers.onError&&e&&t.eventHandlers.onError(e),console.error("Could not authorize with token request",e)}))}function b(e){return new Promise((function(t){e.initializing.finally((function(){t()}))}))}function w(e,t,n,a,o){return new Promise((function(l,s){a||t.authorizedGroupId||l(),a&&t.authorizedGroupId===a&&l(),g.callStats.setEventCommonData(),o({type:r.SET_GROUP_MEMBERS,groupMembersCount:0,groupMembers:[],unableToCallGroupMembersIds:[]}),(0,i.getCallAuthToken)(n.getState().isDev,a).then((function(n){var c=n.token;e.authorize(c).then((function(){t.authorizedGroupId=a,a?(0,i.getGroupById)(-a).then((function(e){if(e.groups){var t=e.groups[0];o({type:r.SET_GROUP,groupId:a,meGroup:(0,y.normalizeGroup)(t)}),g.callStats.setEventCommonData({group_id:a}),l()}})).catch((function(e){s(e)})):l()}))}))}))}function L(e,t,n,a,r,i){void 0===r&&(r=0),void 0===i&&(i=[]);var l=(0,o.createPayload)(r,a);if(!r)return t.callTo(void 0,a,l,!0);if(!(0,A.isGroupCallByPeer)(r))return B(e,n,r).then((function(e){return t.forceRelayPolicy(e),t.callTo(r.toString(),a,l)}));var s=i.filter((function(e){return e=Number(e),(0,p.isUserPeer)(e)&&e!==n.getState().me}));return t.callTo(s,a,l,!0)}function M(e,t,n){var l=e.dispatch;return!!n||t?(n?Promise.resolve((0,o.convertClientData)(n)):(0,i.retryLoadCallPeers)(t).then(o.convertServerData)).then((function(e){var n=(0,a.__read)(e,3),i=n[0],o=n[1],s=n[2];return(0,f.setActiveCallData)(l,s||i),l({type:r.LOAD_PEERS,conversation:i,members:o,peerId:t}),e})):Promise.reject("Cannot load data")}function O(e,t,n){var s=e.dispatch;return!!n&&t?(0,i.retryLoadCallPeers)(t).then((function(e){var t=(0,a.__read)((0,o.convertServerData)(e),2),n=t[0],r=t[1];return(0,f.setActiveCallData)(s,e.items[0]),(0,l.preloadImagesFromResponse)([n,r])})).then((function(e){var t=(0,a.__read)(e,2),n=t[0],i=t[1];s({type:r.LOAD_PEERS,conversation:n,members:i})})):Promise.resolve()}function k(e,t,n){switch(!0){case function(e){var t=e||{},n=t.hangup,a=t.message;return!(!n||!a)}(e):case function(e){var t=e||{},n=t.hangup;return t.message&&void 0===n}(e):return(0,o.getTextForServerError)(e.message,t,n);case function(e){var t;return["TypeError","SyntaxError","RangeError","EvalError","URIError"].includes(null===(t=null==e?void 0:e.__proto__)||void 0===t?void 0:t.name)}(e):return n("calls_error");case function(e){return!!e.error_msg}(e):return(0,o.getTextForServerError)(e.error_msg,t,n);case function(e){return"number"==typeof e}(e):return(0,o.getTextForClientError)(e,t,n);case function(e){return!!e}(e):default:return n("calls_sorry_error")}}function D(e,t,n,a,i,o){var l,s;try{var c=k(e,a,i);t.hangup(),n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,C.debugMessage)(C.DebugMessageType.ERROR,e),console.error(e),o({type:r.ERROR,text:c,handleType:r.ErrorHandleType.FATAL}),(null===(l=n.eventHandlers)||void 0===l?void 0:l.onErrorStartCall)&&(null===(s=n.eventHandlers)||void 0===s||s.onErrorStartCall())}catch(n){throw(0,C.debugMessage)(C.DebugMessageType.ERROR,n),console.error(n),t.hangup(),e}}function R(e,t,n,a,i){var o,l,s=Object.keys(e.screenSharers).filter((function(t){return e.screenSharers[t]})).length,c=function(n,a){var i=function(e){t({type:r.TOGGLE_ORATOR_MODE,isOratorMode:e})},o=function(e){t({type:r.SET_PINNED_PARTICIPANT,pinnedParticipant:e})};n&&!e.isOratorMode&&i(!0),!n&&e.screenSharingNeedDisableOratorModeAfterStop&&i(!1),t({type:r.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:a,screenSharingNeedDisableOratorModeAfterStop:!e.isOratorMode,screenSharingOldPinnedParticipant:e.pinnedParticipant}),a&&e.pinnedParticipant&&o(null),a||e.pinnedParticipant||!e.screenSharingOldPinnedParticipant||o(e.screenSharingOldPinnedParticipant)};0===s&&n?c(!0,a):1!==s||n||c(!(!e.adminPinnedParticipant&&!e.pinnedParticipant),null),!!(null===(l=null===(o=e.participants[a])||void 0===o?void 0:o.mediaSettings)||void 0===l?void 0:l.isScreenSharingEnabled)!==n&&t({type:r.SET_SCREEN_SHARER,participantId:a,isScreenSharingEnabled:n}),n&&i&&t({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.SCREEN_SHARING_STARTED,data:a}})}function B(e,t,n){var a=t.getState();return a.ipSettingEnabled&&"all"!==a.privacySettings.callsIp?(0,p.isChatPeer)(n)?Promise.resolve(!0):e.isFriend?Promise.resolve(!e.isFriend(n)):Object.keys(a.friendsCache).length>0?Promise.resolve(!a.friendsCache[n]):(0,o.exponentialRetry)(f.loadFriendsAction)(e,a,t.dispatch).then((function(){return B(e,t,n)})):Promise.resolve(!1)}},662727:(e,t,n)=>{"use strict";n.d(t,{getCallTimer:()=>p,getHangupStatus:()=>A,getCallStatus:()=>_});var a=n(121255),r=n(52777),i=n(298811),o=n(667294),l=n(464380),s=n(670778),c=n(580248),u=n(745284),d=n(697483);function p(e){return e?o.createElement(r.CallTimer,{duration:(0,i.calculateCallDuration)(e)}):null}function A(e,t){if(e.hangupType)switch(e.hangupType){case a.HANGUP_TYPE_BUSY:return t("calls_busy");case a.HANGUP_TYPE_CALLEE_IS_OFFLINE:return t("calls_callee_is_offline");case a.HANGUP_TYPE_REJECTED:return t("calls_rejected_status");case a.HANGUP_TYPE_CANCELED:case a.HANGUP_TYPE_MISSED:case a.HANGUP_TYPE_HUNGUP:case a.HANGUP_TYPE_REMOVED:return null;case a.HANGUP_TYPE_CALLER_IS_BLOCKED:case a.HANGUP_TYPE_EXTERNAL_API_ERROR:case a.HANGUP_TYPE_FAILED:case a.HANGUP_TYPE_NOT_FRIENDS:case a.HANGUP_TYPE_OLD_VERSION:case a.HANGUP_TYPE_SERVICE_DISABLED:case a.HANGUP_TYPE_UNKNOWN_ERROR:case a.HANGUP_TYPE_UNSUPPORTED:return t("calls_error")}return null}var _=function(e,t){return e?A(e,t)||function(e,t){var n,a=e.participants[t];return a&&a.status===l.ParticipantStatus.CONNECTED||a&&a.status===l.ParticipantStatus.WAITING_HALL||(0,d.getActiveParticipantsCount)(e)<2?null:o.createElement(s.ParticipantStatusContainer,{status:null!==(n=null==a?void 0:a.status)&&void 0!==n?n:l.ParticipantStatus.WAITING})}(e,(0,u.isGroupCallByPeer)(e.peer)?e.me:e.peer)||function(e,t){return void 0===((0,u.isGroupCallByPeer)(e.peer)?e.callData.ts:e.callData.localTimeStamp)?o.createElement(c.default,null,t("calls_status_waiting")):null}(e,t):""}},387691:(e,t,n)=>{"use strict";n.d(t,{localVolumeDetectorGenerator:()=>r,volumesDetectorGenerator:()=>i});var a=n(570655);function r(e){var t=e.onVolumeLevelReached,n=e.needCheckMicEnabled,r=e.vectorLength,i=e.volumeLevelDetection,o=e.callbackFactorStep,l=e.sensitivityCoefficient,s=e.onVolumeLevelUpdated,c=e.debugCallback,u=function(e){var t=[],n=0;return function(a){if(t.push(a),n+=a,t.length>e){var r=t.shift();n-=r||0}return n/t.length}}(r),d=0,p=!1;return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];c&&c(e);var A=(0,a.__read)(e,2),_=A[0],m=A[1],g=_>i;p!==g&&s&&s(g),p=g,0!==d&&m&&(d=0);var f=u(_);n&&m||_/f>(1+d)/l&&_>i&&(d+=o,t())}}function i(e){var t=e.onUpdate,n=e.volumeLevelDetection,r=e.debugCallback,i={},s=[],c={},u=[];return function(){for(var e=[],d=0;d<arguments.length;d++)e[d]=arguments[d];r&&r(e);var p=(0,a.__read)(e,1),A=p[0];c=Object.keys(c).reduce((function(e,t){return c[t]-1>0&&(e[t]=c[t]-1),e}),{});var _=A.reduce((function(e,t){var a=t.uid.id;return t.volume>n&&(e[a]=!0,c[a]=3),e}),{});u=Object.keys(c);var m=!1,g={speakers:null,speakersInHeader:null};o(i,_)||(g.speakers=_,i=_,m=!0),l(s,u)||(g.speakersInHeader=u,s=u,m=!0),m&&t(g)}}function o(e,t){var n=Object.keys(e),a=Object.keys(t);return n.length===a.length&&n.every((function(e){return t[e]}))}function l(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}},485525:(e,t,n)=>{"use strict";n.d(t,{wakeLockRequest:()=>c,wakeLockRelease:()=>u});var a,r="wakeLock"in navigator&&!0,i=null,o=!1,l=function(){null!==i&&"visible"===document.visibilityState&&c()},s=function(){var e,t,n,r;a||((a=document.createElement("video")).setAttribute("title","Wake lock"),a.setAttribute("playsinline",""),e=a,t="mp4",n="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA=",(r=document.createElement("source")).src=n,r.type="video/"+t,e.appendChild(r),a.addEventListener("loadedmetadata",(function(){a&&a.addEventListener("timeupdate",(function(){a&&a.currentTime>.5&&(a.currentTime=Math.random())}))}))),a.play().catch((function(){}))};function c(){if(!r)return s();o||(o=!0,document.addEventListener("visibilitychange",l));try{navigator.wakeLock.request("screen").then((function(e){(i=e).addEventListener("release",(function(){}))}))}catch(e){console.error(e.name+", "+e.message)}}function u(){r?i&&i.release().then((function(){i=null})):a&&a.pause()}},862191:(e,t,n)=>{"use strict";n.d(t,{callStatDataStorage:()=>l});var a=n(570655),r=n(464380),i={timeStart:null,entryPoint:null,startType:null,isGroupCall:!1,hadVideoEnabled:!1,isOutgoingCall:!1,connectionStep:null};function o(e){switch(e){case r.ParticipantStatus.WAITING:return 1;case r.ParticipantStatus.CONNECTING:return 2;case r.ParticipantStatus.CONNECTED:return 3;default:return 0}}var l={get:function(){return i},set:function(e){var t,n;i=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},i),e),{connectionStep:(t=e.connectionStep,n=i.connectionStep,t&&o(t)&&o(t)>o(n)?t:n)})},reset:function(){i={timeStart:null,entryPoint:null,startType:null,isGroupCall:!1,hadVideoEnabled:!1,isOutgoingCall:!1,connectionStep:null}}}},614914:(e,t,n)=>{"use strict";n.d(t,{callStats:()=>o});var a=n(570655),r=n(697483),i="type_voip_call_item",o=new(function(){function e(){this.eventCommonData={}}return e.prototype.setActionStatCollector=function(e){this.actionStatCollector=e},e.prototype.setEventCommonData=function(e){void 0===e&&(e={}),this.eventCommonData=e},e.prototype.logEvent=function(e){var t,n=e.peer_id,o=(0,r.isParticipantGroup)(n)?n:0,l=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},e),{peer_id:e.peer_id.toString(),session_id:e.session_id||"",lib_version:"calls_v2",group_id:o}),this.eventCommonData);this.actionStatCollector&&this.actionStatCollector.logEvent(((t={type:i}).type_voip_call_item=l,t))},e}())},170794:(e,t,n)=>{"use strict";n.d(t,{setStatlogEventsHandler:()=>l,addCallStatEvent:()=>s});var a,r=n(121255),i=n(862191),o=n(464380);function l(e){a=e}function s(e,t,n,o){var l,s,u,d=i.callStatDataStorage.get(),p=d.startType,A=d.entryPoint,_=d.timeStart,m=d.isGroupCall,g=d.hadVideoEnabled,f=d.isOutgoingCall,v=!e||e===r.HANGUP_TYPE_HUNGUP&&!n,E={type:p&&function(e,t,n){var a;a=e===r.CallType.VIDEO?t?r.CallStatReachedType.GROUP_VIDEO:r.CallStatReachedType.VIDEO:n?t?r.CallStatReachedType.GROUP_AUDIO_TO_VIDEO:r.CallStatReachedType.AUDIO_TO_VIDEO:t?r.CallStatReachedType.GROUP_AUDIO:r.CallStatReachedType.AUDIO;return a}(p,m,g),result:v?r.CallStatResult.SUCCESS:r.CallStatResult.FAIL,failReason:v?null:c(e,n),callSource:A,totalDuration:_?Date.now()-_:0};f&&(o&&console.log(E),l=t,u=[(s=E).type||"",s.result,s.failReason||"",s.callSource||"",s.totalDuration],a&&a({name:"call_stats",value:l,keys:u}))}function c(e,t){var n=i.callStatDataStorage.get().isOutgoingCall,a=i.callStatDataStorage.get().connectionStep;switch(!0){case t:return r.CallStatFailReason.CONNECTION_LOST;case e===r.HANGUP_TYPE_CANCELED:return r.CallStatFailReason.LOCAL_DECLINE;case e===r.HANGUP_TYPE_REJECTED:return r.CallStatFailReason.REMOTE_DECLINE;case e===r.HANGUP_TYPE_BUSY:return r.CallStatFailReason.REMOTE_BUSY;case e===r.HANGUP_TYPE_MISSED:return n?r.CallStatFailReason.REMOTE_TIMEOUT:null;case a===o.ParticipantStatus.CONNECTING:return r.CallStatFailReason.REMOTE_FAILED_ACCEPT;case!a:return r.CallStatFailReason.REMOTE_NO_CONNECT;default:return null}}},525046:(e,t,n)=>{"use strict";n.d(t,{saveLocalToken:()=>o,removeLocalToken:()=>l,fetchToken:()=>s});var a=n(659397),r=n(329538),i="calls_token";function o(e){a.localStorage.setItem(i,e)}function l(){a.localStorage.removeItem(i)}function s(e){var t=a.localStorage.getItem(i);return t?Promise.resolve(t):(0,r.getCallAuthToken)(e).then((function(e){return e.token}))}},580248:(e,t,n)=>{"use strict";n.d(t,{default:()=>c});var a=n(570655),r=n(667294),i=n(45697),o=n.n(i),l=n(659397),s=function(e){var t=e.children,n=e.className,i=(0,a.__rest)(e,["children","className"]),o=(0,l.classNames)("ActivityIndicator",n);return r.createElement("span",(0,a.__assign)({},i,{className:o}),t)};s.propTypes={className:o().string,children:o().node};const c=s},685537:(e,t,n)=>{"use strict";n.d(t,{AvatarsStack:()=>o});var a=n(667294),r=n(211941),i=n(906942),o=function(e){var t=e.items;return a.createElement("figure",{className:"AvatarsStack"},a.createElement(r.default,null,a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},a.createElement("defs",null,a.createElement("clipPath",{id:"users-mask"},a.createElement("path",{d:"M43.56 8.25a25 25 0 100 33.5A27.88 27.88 0 0138 25c0-6.28 2.07-12.08 5.56-16.75z"}))))),t.map((function(e,t){return"src"in e?a.createElement("img",{src:e.src,className:"AvatarsStack__item",alt:e.alt,key:e.key||t}):a.createElement(i.ConversationNoPhoto,{text:e.text,id:e.id,size:"50",className:"AvatarsStack__item",key:e.key||t})})))}},58600:(e,t,n)=>{"use strict";n.d(t,{CopyText:()=>r});var a=n(667294),r=function(e){var t=e.text,n=e.onCopyDone,r=e.children,i=(0,a.useRef)(null),o=(0,a.useCallback)((function(e){i.current&&(i.current.focus(),i.current.select(),document.execCommand("copy"),e.preventDefault(),e.stopPropagation(),n&&n())}),[n]);return a.createElement("div",{className:"CopyText",onClick:o},a.createElement("input",{type:"text",readOnly:!0,value:t||"",ref:i,className:"CopyText__input"}),r)}},607691:(e,t,n)=>{"use strict";n.d(t,{ListCopyControl:()=>c});var a=n(570655),r=n(667294),i=n(58600),o=n(326542),l=n(629142),s=n(659397),c=function(e){var t=e.value,n=e.copyText,c=e.doneText,u=e.className,d=(0,a.__read)((0,r.useState)(!1),2),p=d[0],A=d[1],_=(0,r.useCallback)((function(){A(!0)}),[]),m=(0,r.useCallback)((function(){A(!1)}),[]),g=(0,s.classNames)("ListCopyControl",u,{"ListCopyControl--copied":p});return r.createElement("div",{className:g},r.createElement(i.CopyText,{text:t,onCopyDone:_},r.createElement(o.default,{className:"ListCopyControl__copyButton"},n)),r.createElement(l.default,{shown:p,callback:m,className:"ListCopyControl__copyDone"},c))}},295886:(e,t,n)=>{"use strict";n.d(t,{ListHeader:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.headingElement,n=void 0===t?"h3":t,i=e.extra,o=e.className,l=e.children,s=n;return a.createElement("header",{className:(0,r.classNames)("ListHeader",o)},a.createElement(s,{className:"ListHeader__text"},l),a.createElement("span",{className:"ListHeader__extra"},i))}},489685:(e,t,n)=>{"use strict";n.d(t,{LinkIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"14",height:"14",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t,{"aria-hidden":"true"}),r.createElement("path",{d:"M6.022 9.184a.837.837 0 01-1.187-.001 3.861 3.861 0 010-5.419l2.618-2.643a3.772 3.772 0 015.366 0c1.261 1.274 1.557 3.033.67 4.508-.296.49-.947.47-1.325.09-.275-.276-.254-.707-.077-1.019.465-.817.24-1.683-.456-2.379a2.094 2.094 0 00-2.997 0L6.023 4.956a2.143 2.143 0 00-.001 3.025.83.83 0 010 1.202zm1.95-3.166c.833.835.832 2.19-.001 3.025L5.36 11.68a2.094 2.094 0 01-2.998 0c-.695-.696-.91-1.555-.446-2.371.178-.313.199-.744-.076-1.019-.379-.38-1.03-.4-1.325.09-.888 1.474-.602 3.226.659 4.5a3.772 3.772 0 005.367 0l2.617-2.643a3.861 3.861 0 000-5.419.837.837 0 00-1.187 0 .83.83 0 000 1.2z"}))}},823694:(e,t,n)=>{"use strict";n.d(t,{PrivacyIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"20",height:"20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4 9.6c0-.56 0-.84.109-1.054a1 1 0 01.437-.437C4.76 8 5.04 8 5.6 8h8.8c.56 0 .84 0 1.054.109a1 1 0 01.437.437C16 8.76 16 9.04 16 9.6v4.8c0 .56 0 .84-.109 1.054a1 1 0 01-.437.437C15.24 16 14.96 16 14.4 16H5.6c-.56 0-.84 0-1.054-.109a1 1 0 01-.437-.437C4 15.24 4 14.96 4 14.4V9.6z",fill:"#fff"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2 6a2.2 2.2 0 00-4.4 0v4a2.2 2.2 0 104.4-.001V6zM10 2a4 4 0 00-4 4v4a4 4 0 108-.001V6A4 4 0 0010 2z",fill:"#fff"}))}},449608:(e,t,n)=>{"use strict";n.d(t,{TimeIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.8 8a6.2 6.2 0 1112.4 0A6.2 6.2 0 011.8 8zM0 8a8 8 0 1116 0A8 8 0 010 8zm8.9-3a.9.9 0 00-1.8 0v4a.9.9 0 00.498.805l2 1a.9.9 0 10.804-1.61L8.9 8.444V5z",fill:"#fff"}))}},641221:(e,t,n)=>{"use strict";n.d(t,{TooltipNew:()=>s});var a,r=n(570655),i=n(667294),o=n(617841),l=n(659397);function s(e){var t=e.children,n=e.content,s=e.position,c=void 0===s?"auto":s,u=e.align,d=void 0===u?"auto":u,p=e.appearance,A=void 0===p?"dark":p,_=e.open,m=void 0!==_&&_,g=e.onOpen,f=e.onClose,v=e.delay,E=void 0===v?50:v,h=(0,r.__rest)(e,["children","content","position","align","appearance","open","onOpen","onClose","delay"]),C=(0,r.__read)((0,i.useState)(m?a.OPENED:a.CLOSED),2),S=C[0],y=C[1],N=(0,i.useRef)(null);(0,i.useEffect)((function(){var e=null,t=null,n=function(){e&&(clearTimeout(e),e=null)},r=function(){n(),e=window.setTimeout((function(){y(a.OPENED),g&&g()}),E)},i=function(){n(),t=window.setTimeout((function(){S===a.OPENED?y(a.IS_CLOSING):(y(a.CLOSED),f&&f())}),0)};return N&&N.current&&(N.current.addEventListener("mouseenter",r),N.current.addEventListener("mouseleave",i)),function(){N&&N.current&&(N.current.removeEventListener("mouseenter",r),N.current.removeEventListener("mouseleave",i)),n(),t&&(window.clearTimeout(t),t=null)}}),[N,S]),(0,i.useEffect)((function(){var e=m?a.OPENED:a.CLOSED;S!==e&&y(e)}),[m]);var T=(0,i.useCallback)((function(){S===a.IS_CLOSING&&(y(a.CLOSED),f&&f())}),[S]),I=(0,l.classNames)("TooltipNew",{"TooltipNew--removed":"isClosing"===S,"TooltipNew--dark":"dark"===A,"TooltipNew--light":"light"===A}),P=i.createElement("div",{className:I,onTransitionEnd:T},n);return i.createElement(o.Popper,(0,r.__assign)({open:S!==a.CLOSED,position:c,align:d,content:P,ref:N},h),t)}!function(e){e.OPENED="opened",e.IS_CLOSING="isClosing",e.CLOSED="closed"}(a||(a={}))},211941:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});var a=n(667294);const r=function(e){var t=e.children;return a.createElement("div",{className:"VisuallyHidden"},t)}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=a,e=[],i.O=(t,n,a,r)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,a,r]=e[u],l=!0,s=0;s<n.length;s++)(!1&r||o>=r)&&Object.keys(i.O).every((e=>i.O[e](n[s])))?n.splice(s--,1):(l=!1,r<o&&(o=r));if(l){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,a,r]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var r=Object.create(null);i.r(r);var o={};t=t||[null,n({}),n([]),n(n)];for(var l=2&a&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(r,o),r},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.e=()=>Promise.resolve(),i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={4387:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,[o,l,s]=n,c=0;for(a in l)i.o(l,a)&&(i.m[a]=l[a]);if(s)var u=s(i);for(t&&t(n);c<o.length;c++)r=o[c],i.o(e,r)&&e[r]&&e[r][0](),e[o[c]]=0;return i.O(u)},n=self.webpackChunkvk=self.webpackChunkvk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i.O(void 0,[8592,4509,2760,2801,9429,1690],(()=>i(366206)));o=i.O(o)})();