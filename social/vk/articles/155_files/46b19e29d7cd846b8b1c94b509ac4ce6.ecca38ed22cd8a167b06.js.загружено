(self.webpackChunkvk=self.webpackChunkvk||[]).push([[1140],{455518:(_,e,t)=>{"use strict";function o(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="user_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_outline_20__Icons-20/user_outline_20"><g id="user_outline_20__user_outline_20"><path opacity=".1" d="M0 0h20v20H0z"/><path d="M12.5 5a2.5 2.5 0 10-5 0 2.5 2.5 0 005 0zM14 5a4 4 0 11-8 0 4 4 0 018 0zM4 15.5c0 .72.36 1 1 1h10c.64 0 1-.28 1-1 0-2.33-2.57-3.5-6-3.5s-6 1.17-6 3.5zm-1.5 0c0-3.48 3.33-5 7.5-5s7.5 1.52 7.5 5c0 1.63-1.1 2.5-2.5 2.5H5c-1.4 0-2.5-.87-2.5-2.5z" id="user_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"user_outline_20"}}t.d(e,{getIcon20UserOutline:()=>o})},750238:(_,e,t)=>{"use strict";function o(){return{icon:'<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.73 11.48a.75.75 0 01.94-.5 7.26 7.26 0 011.64.71 4.22 4.22 0 012.15 3.2.75.75 0 01-1.49.19 2.72 2.72 0 00-1.43-2.1 5.76 5.76 0 00-1.3-.56.75.75 0 01-.5-.94zM6 5a4 4 0 114 4 .75.75 0 010-1.5A2.5 2.5 0 107.5 5 .75.75 0 016 5zM3.22 17.36c.45.42 1.08.64 1.78.64h9.44l.78.78a.75.75 0 101.06-1.06L3.78 5.22a.75.75 0 00-1.06 1.06l4.48 4.48c-.95.2-1.8.5-2.51.93A4.23 4.23 0 002.5 15.5c0 .81.27 1.44.72 1.86zm2.24-4.38A2.74 2.74 0 004 15.5c0 .46.14.67.25.77.12.11.35.23.75.23h7.94l-4.42-4.42c-1.27.13-2.31.45-3.06.9z" fill="currentColor"/></svg>',name:"user_slash_outline_20"}}t.d(e,{getIcon20UserSlashOutline:()=>o})},88181:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(991181),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(579665),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(95767),core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(530522),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(976142),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(66108),core_js_modules_es6_promise__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(940851),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(296253),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(283946),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(751876),core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(175115),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(59357),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(21466),_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(414914),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(469433),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(917685),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(719016),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(791563),_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(705456),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(651988),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(442699),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(621260),_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(109847),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(927663),_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(190148),_web_lib_video__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(900233),_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(116886),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(182408),_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(627556),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(653439),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(519921),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(313020),_web_lib_utils__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(907851),_web_donut__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(944890),_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(647796),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(47886),_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(885682),_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(897499),_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(924507),_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(917999),_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(97194),_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(816662),_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(588842),_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(828190),_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(422047),_internal_nospam_common__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(432338),_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(513349),_web_lib_date__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(829327),_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(275951),_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(41437),_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(550344),_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(774),_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(452365),_web_reports_reports__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(496495),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(486353),_web_likes_helpers__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(283767),_icons_desktop_getIcon20UserOutline__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(455518),_icons_desktop_getIcon20UserSlashOutline__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(750238),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(124961);function _extends(){return(_extends=Object.assign||function(_){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(_[o]=t[o])}return _}).apply(this,arguments)}function _slicedToArray(_,e){return _arrayWithHoles(_)||_iterableToArrayLimit(_,e)||_unsupportedIterableToArray(_,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(_,e){if(_){if("string"==typeof _)return _arrayLikeToArray(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);return"Object"===t&&_.constructor&&(t=_.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(_,e):void 0}}function _arrayLikeToArray(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}function _iterableToArrayLimit(_,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(_)){var t=[],o=!0,l=!1,i=void 0;try{for(var a,r=_[Symbol.iterator]();!(o=(a=r.next()).done)&&(t.push(a.value),!e||t.length!==e);o=!0);}catch(_){l=!0,i=_}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return t}}function _arrayWithHoles(_){if(Array.isArray(_))return _}var Wall={LS_ADS_EVENTS:"ads.events",deleteAll:function(_,e,t){ajax.post("al_wall.php",{act:"delete_all",post:e,hash:t},{onDone:function(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_));t.oldt=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t,e)},showProgress:function(){hide(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{className:"progress"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_))}})},restoreAll:function(_,e,t){var o=Math.floor(1e5*Math.random());cur.wallRnd=o,ajax.post("al_wall.php",{act:"restore_all",post:e,hash:t,rnd:o},{onDone:function(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t,t.oldt)},showProgress:function(){hide(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span",{className:"progress_inline"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_))}})},deleteThread:function(_,e,t){ajax.post("al_wall.php",{act:"delete_thread",post:e,hash:t,from_deleted:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e),"reply_deleted")},{onDone:function(t){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("dld_inner",_);if(o)o.oldElements=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o,t);else{var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e),i=geByClass1("reply_wrap",l);hide(i),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{id:"post_del"+e,className:"dld",innerHTML:'<span class="dld_inner">'+t+"</span>"}),l.appendChild(o)}hide("replies_wrap_deep"+e)},showProgress:function(){hide(_);var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post_actions",_);if(e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"post_actions_progress");else{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_);t||(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_).appendChild(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(t))}},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(_);var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post_actions",_);e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(e,"post_actions_progress"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_))}})},restoreThread:function(_,e,t){ajax.post("al_wall.php",{act:"restore_thread",post:e,hash:t},{onDone:function(){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("replies_wrap_deep"+e),t.oldElements)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t,t.oldElements);else{var o=geByClass1("reply_wrap","post"+e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("post_del"+e)}},showProgress:function(){hide(_);var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(e))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_))}})},block:function(_,e,t,o,l){ajax.post("al_wall.php",{act:"block",post:e,hash:t,bl:o,from:l},{onDone:function(e){o?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span",{innerHTML:e}),_),hide(_)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_)))},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.showProgress)(_,"post_inline_progress","post_inline_progress",!0)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("post_inline_progress")}})},blockEx:function(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showBox)("groupsedit.php",{act:"bl_edit",name:"id"+e,gid:_,auto:1},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})},withMentions:!(browser.mozilla&&browser.version.match(/^2\./)||browser.mobile),editPost:function(_,e,t,o,l){if(cur.editingPost&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wpe_text")){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wall_posts",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wpe_text"));if(!i||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(i))return o&&o(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.notaBene)("wpe_text");Wall.cancelEdit()}cur.editingPost=[e],Wall.withMentions?stManager.add(["ui_controls.css","ui_controls.js","mentions.js",jsc("web/wall_edit.js")]):stManager.add([jsc("web/wall_edit.js")]),ajax.post("al_wall.php",extend({act:"edit",post:e,mention:Wall.withMentions?1:""},t),{onDone:function(){var _=Array.prototype.slice.call(arguments);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(_[4])&&cur.options&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(cur.options.filter_media_types)){var o=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(_[4],(function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(cur.options.filter_media_types,(function(_,t){if(e[0]===t[0])return o.push(t),!1}))})),_[4]=o}_.unshift(e),t&&t.fromAds&&_.push(t.fromAds),WallEdit.editPost.apply(window,_),l&&l()},onFail:function(){cur.editingPost=!1,o&&o()},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"flat_button")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(geByClass1("post_actions","post"+e),"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"flat_button")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(geByClass1("post_actions","post"+e),"post_actions_progress")},noSort:!0})},fixPost:function fixPost(link,post,hash,value){return ajax.post("al_wall.php",{act:"a_fix_post",post,hash,value},{onDone:function onDone(js){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.logEvalError)(_,js)}var postEl=cur.wallLayer==post?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+post);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post_fixed"),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(this,"post_fixed")})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(postEl,"post_fixed",value),link&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(link,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)(value?"wall_unfix_post":"wall_fix_post")),link.onclick=function(){return Wall.fixPost(link,post,hash,value?0:1)}),cur.onWKFix&&(cur.onWKFix(value),delete cur.onWKFix)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind("wpe_fix"+post)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind("wpe_fix"+post)}}),!1},cancelEdit:function(_){if(cur.editingPost){if(!0===_&&cur.editingPost[0].match(/^-?\d+_/))return;window.WallEdit?WallEdit.cancelEditPost():cur.editingPost=!1}},searchWall:function(){},switchTabContent:function(_){switch(hide("page_wall_posts","page_postponed_posts","page_suggested_posts","page_search_posts","page_top_posts","page_archive_posts","page_donut_posts"),_){case"own":case"all":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_wall_posts");break;case"postponed":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_postponed_posts"),hide("wall_more_link");break;case"suggested":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_suggested_posts");break;case"search":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_search_posts");break;case"top":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_top_posts");break;case"archive":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_archive_posts");break;case"donut":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_donut_posts")}},switchWall:function(_,e,t){var o;if(e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(e))return!0;if(t||(t="own"==cur.wallType?"all":"own"),e&&"click"==e.type&&e.clientX&&e.offsetX&&cur.wallTab==t&&cur.wallType==t&&"top"!==t)return nav.go(_,e);if("postponed"==cur.wallTab&&wall.checkPostponedCount(),"archive"!==cur.wallTab&&"archive"!==t||((cur.wallLayer?wkcur:cur).wallMyDeleted={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(cur.wallArchiveFeatureTooltipHide)&&cur.wallArchiveFeatureTooltipHide(),!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(t,["top","archive","donut"])){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(l,"own"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(l,"all"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(l,t)}cur.wallType=t,cur.wallTab=t,uiTabs.switchTab(_),uiTabs.hideProgress(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(t,["top","archive","donut"])?(cur.baseWallModule=cur.module,cur.module="wall_"+t,cur.topWallFeatureTT&&cur.topWallFeatureTT.hide()):cur.baseWallModule&&(cur.module=cur.baseWallModule,delete cur.baseWallModule);var i="donut"===t&&Wall.cantAccessDonutPosts();return Wall.hasPosts()||i?(Wall.update(),Wall.showWall()):(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,cur.wallArchiveRestored=0,cur.wallArchiveArchived=0,cur.wallArchiveRolledback=0,cur.wallDonutNextFrom=0,"top"===t?delete cur.wallTopFinished:"archive"===t?delete cur.wallArchiveFinished:"donut"===t&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_)),(null==_||null===(o=_.dataset)||void 0===o?void 0:o.donutLogEvent)&&(0,_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_46__.logDonutEvent)(_.dataset.donutLogEvent),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)},resetWall:function(){if(cur.wallType&&cur.wallTab){var _=geByClass1("_wall_tab_"+cur.wallType);_&&(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,(cur.wallLayer?wkcur:cur).wallMyDeleted={},"top"===cur.wallType?delete cur.wallTopFinished:"archive"===cur.wallType?delete cur.wallArchiveFinished:"donut"===cur.wallType&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_,!0))}},hasPosts:function(_){_=_||cur.wallType;var e=Wall.getPostsWrap(_);return!!geByClass1("post",e)},getPostsWrap:function(_){switch(_){case"archive":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_archive_posts");case"top":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_top_posts");case"donut":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_donut_posts");default:return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts")}},showSuggested:function showSuggested(ev,rows,notAll){if(ev&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(ev))return!0;if(!cur.oid)return!1;var el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_suggest");if(el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(el,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domQuery1)("#page_wall_suggest_more .ui_tab_group_item"):geByClass1("ui_tab",el),!el)return!1;if(uiTabs.switchTab(el),cur.wallTab="suggested",delete cur.suggestedDeletedCount,void 0!==rows)wall.suggestLoaded(rows,notAll);else{if(cur.suggestedLoading)return!1;var curOid=cur.suggestedLoading=cur.oid;uiTabs.showProgress(el),ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid},{onDone:function onDone(rows,notAll,js,count){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.logEvalError)(_,js)}cur.suggestedLoading=!1,uiTabs.hideProgress(el),Wall.updateTabCounter("page_wall_suggested_cnt",count),curOid===cur.oid&&"suggested"==cur.wallTab&&wall.suggestLoaded.apply(window,arguments)}})}return!1},deleteSuggested:function(_,e,t,o){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isButtonLocked)(o)){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(o);var l=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)({title:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_action_confirmation"),onHide:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(o)}},(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_delete_suggested_box"),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_delete_suggested_btn"),(function(o){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isButtonLocked)(o)||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(o),ajax.post("al_wall.php",{act:"delete_suggested",post_id:_,hash:t,group_id:e},{onDone:function(_){if("full_own"==cur.wallType||"full_all"==cur.wallType){var e=(Math.ceil(_/cur.pgPerPage)-1)*cur.pgPerPage;e<cur.pgOffset&&(e>0?nav.objLoc.offset=e:delete nav.objLoc.offset,nav.setLoc(nav.objLoc)),nav.reload()}else Wall.showSuggested();l.hide()},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind(o)}))}),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_cancel"))}},suggestLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_suggested_posts",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)("wall_more_link",e),wall.switchTabContent("suggested")},suggestMore:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_suggested_posts"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_more_link");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isButtonLocked)(e)||ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid,offset:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("dld",_).length},{onDone:function(t,o){for(var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:t}),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(l);i;)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(i.id)||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"post")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(i):_.appendChild(i),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(l);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)(e,o)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind(e)})},suggestUpdate:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_suggests_count"),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e));e&&(-1!==_&&1!==_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,t+=_),Wall.updateTabCounter("page_wall_suggested_cnt",t))},suggestPublished:function(_,e,t){if(cur.onepost)return nav.go("/wall"+cur.oid);if(Wall.suggestUpdate(-1),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(e),cur.wallMyDeleted[_]=1,cur.editingPost=!1,Wall.deinitComposer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wpe_text")),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),cur.postWpeIsPoster=!!cur.posterWpeSendParams,cur.posterWpe&&cur.posterWpeSendParams&&WallEdit.posterDestroy(),t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_postponed_posts",t),wall.postponeUpdateCount()),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_suggests_count")))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("post"+_);else{var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_rmenu");o?(geByClass1("ui_rmenu_item",o).click(),hide(geByClass1("_wall_menu_suggested",o))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_tabs")&&(geByClass1("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_suggest",!1))}},showDonutWall:function(_){if(!cur.oid)return!1;var e="donut";Wall.updateTabVisibility("page_wall_donut",!0);var t=Wall.getWallTabLink(e);if(!t)return!1;uiTabs.switchTab(t),cur.wallTab=e,cur.wallType=e,void 0!==_&&Wall.donutWallSetRows(_)},donutWallSetRows(_){var e="donut",t=Wall.getPostsWrap(e);t&&(t.innerHTML=_,Wall.switchTabContent(e),Wall.update())},getWallTabLink:_=>{var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(`page_wall_${_}`);return((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domQuery1)(`#page_wall_${_}_more .ui_tab_group_item`):geByClass1("ui_tab",e))||null},showPostponedFull:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("ui_rmenu_postponed"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts");if(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"ui_rmenu_item_sel")||!t){var o={0:nav.objLoc[0],postponed:1};return nav.go(o)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t,_),FullWall.updateSummary((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post",t).length)},showPostponed:function(_,e){if(_&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(_))return!0;if(!cur.oid)return!1;var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_postponed");if(!(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domQuery1)("#page_wall_postponed_more .ui_tab_group_item"):geByClass1("ui_tab",t)))return!1;if(uiTabs.switchTab(t),cur.wallTab="postponed",void 0!==e)Wall.postponedLoaded(e);else{if(cur.postponedLoading)return!1;var o=cur.postponedLoading=cur.oid;uiTabs.showProgress(t),ajax.post("al_wall.php",{act:"get_postponed",owner_id:cur.oid},{onDone:function(_){cur.postponedLoading=!1,uiTabs.hideProgress(t),o===cur.oid&&"postponed"==cur.wallTab&&Wall.postponedLoaded(_)}})}return!1},postponedLoaded:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_postponed_posts",_),wall.postponeUpdateCount(),wall.switchTabContent("postponed")},postponeUpdateCount:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_postponed_posts"),e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("dld",_).length||0;_&&Wall.updateTabCounter("page_wall_postponed_cnt",e)},checkPostponedCount:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post","page_postponed_posts"),e=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(_,(function(){var _=this.id.replace("post","");cur.wallMyDeleted[_]||e++})),e||wall.updateTabVisibility("page_wall_postponed",!1)},updateTabCounter:function(_,e){e=e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langNumeric)(e,"%s",!0):"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)(_).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_,e);var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"ui_tab_group_item")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"default-label",t.innerHTML)}))},updateTabVisibility:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_more_tab");if(t)if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(t))if(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"unshown")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_+"_more","unshown")){var o=!1;cur.wallTabsMorePriority.forEach((function(e){o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(e+"_more","unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(_,"unshown"),o=!0)})),o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(_+"_more","unshown")}}else{var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"unshown"))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_+"_more"),"unshown");else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(l,"unshown");var i=cur.wallTabsLimit-1-(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_44__.getNavigableTabs)(t).length;if(i>0){var a=i;cur.wallTabsMorePriority.forEach((function(_){if(!(a<=0)){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_+"_more");e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"unshown"),a--)}}))}}var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("ui_tab_group_item",t);r.length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("unshown",t).length<=1&&(r.forEach((function(_){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_.id.replace(/_more$/,"")),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"unshown"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(t,"unshown"))}else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_),"unshown",!e);var s=(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_44__.getNavigableTabs)(t).length;if(s>cur.wallTabsLimit){var n=s-(cur.wallTabsLimit-1);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("ui_tab_group_item",t).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"unshown")})),cur.wallTabsMorePriority.forEach((function(_){if(!(n<=0)){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_);e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_+"_more"),"unshown"),n--)}})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(t,"unshown"),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.statlogsValueEvent)("wall_more_tab_shown",cur.oid)}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_),"unshown",!e)},postponedPublished:function(_,e){if(cur.onepost)return nav.go("/wall"+cur.oid);"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(e),cur.wallMyDeleted[_]=1;var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_postponed_posts")),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);if(t.length<=1&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(o,t)){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_rmenu");l?(geByClass1("ui_rmenu_item",l).click(),hide(geByClass1("_wall_menu_postponed",l))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_tabs")&&(geByClass1("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_postponed",!1))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(o),wall.postponeUpdateCount()},onWallSearchSend:function(_,e){e?Wall.showSearch(e,0):Wall.hideSearch()},showSearch:function(_,e){if(cur.searchLoading&&cur.searchLoading==_||!cur.oid)return!1;var t=cur.oid;cur.wallQuery=cur.searchLoading=_,"search"!=cur.wallTab&&(cur.prevWallTab=cur.wallTab,cur.wallTab="search");var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_more_link"),l=+new Date;return ajax.post("al_wall.php",{act:"s",search:1,q:_,owner_id:cur.oid,offset:e,inline:1,owners_only:1},{onDone:function(i,a,r){if(t===cur.oid&&"search"==cur.wallTab){var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_search_posts");e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(s,""),s.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(i)),wall.switchTabContent("search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)(o,a<r),o.onclick=Wall.showSearch.pbind(_,a);var n=cur.oid>0?_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.serviceWallUsers:_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.serviceWallGroups,E=+new Date-l;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.saveSearchAttemptStats)(n,0,r,_,0,0,E)}},showProgress:function(){uiSearch.showProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(o)},hideProgress:function(){cur.searchLoading=!1,uiSearch.hideProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(o)}}),!1},hideSearch:function(){if(delete cur.wallQuery,cur.prevWallTab){var _=(cur.oid,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.serviceWallUsers);(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.removeSearchPositionTracker)(_),cur.wallTab=cur.prevWallTab,cur.prevWallTab=!1,wall.switchTabContent(cur.wallTab),wall.update()}},publishPostponedPost:function(_,e,t){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("publish_postponed_title"),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("publish_postponed_confirm"),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("publish_postponed_btn"),(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)().hide(),ajax.post("al_wall.php",{act:"publish_postponed",post:_,from:t,hash:e},{onDone:Wall.postponedPublished.pbind(_),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind("wpe_publish"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind("wpe_publish"+_)})}),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_cancel"))},publishFreeDonutCopy:function(_,e,t,o){var l=_.currentTarget,i=o?{title:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_warning"),content:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_publish_donut_as_free_confirmation_warn")}:{title:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_publish_donut_as_free_confirmation_title"),content:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_publish_donut_as_free_confirmation_confirm")},a=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(i.title,i.content,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_publish_donut_as_free_confirmation_btn"),(()=>{var _=()=>{a.hide()},o=a.btns.ok[0];ajax.post("al_wall.php",{act:"publish_free_donut_copy",post_id:e,hash:t},{onDone:e=>{Wall.publishFreeDonutCopyDone({menuActionEl:l,message:e}),_()},onFail:()=>{_()},showProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(o)},hideProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(o)}})}),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_cancel"))},publishFreeDonutCopyDone(_){var e=_.message,t=_.menuActionEl;"full_own"!==cur.wallType&&"full_all"!==cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(e,{timeout:3e3}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t)},cmp:function(_,e){var t=_.length,o=e.length;return t<o?-1:t>o?1:_<e?-1:_>e?1:0},receive:function(_,e,t,o){o=!0===o;var l,i,a,r,s="top"===(t=t||cur.wallType),n="archive"===t,E="donut"===t,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:_}),c=!!cur.options.revert,b=Wall.getPostsWrap(t),p=[],u=[],P=["page_top_posts","page_wall_posts","page_archive_posts","page_donut_posts"],D=0;if(o)u=P;else{var m=[[n,"page_archive_posts"],[s,"page_top_posts"],[E,"page_donut_posts"],[!0,"page_wall_posts"]].find((_=>_slicedToArray(_,1)[0])),w=_slicedToArray(m,2)[1];u=P.filter((_=>_!==w)),a=c?b.firstChild:b.lastChild}function M(_){return!!(_&&_.tagName&&"div"===_.tagName.toLowerCase()&&_.id&&"post"===_.id.substr(0,4))&&_.id}u.forEach((function(_){if("page_donut_posts"!==_||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_donut_info"))for(var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_));e;){var t=e;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(e),t.tagName&&"input"===t.tagName.toLowerCase()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t)}}));for(var O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(c?d.firstChild:d.lastChild);O;O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(c?d.firstChild:d.lastChild))if("input"!=O.tagName.toLowerCase()){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(O,"post_fixed")||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(O.id))if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(O,"_ads_promoted_post"))p.push({el:O,beforePost:M(c?d.firstChild:l),afterPost:M(c?l:d.lastChild)});else{for(;a&&a.tagName&&"div"==a.tagName.toLowerCase()&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(a,"post_fixed")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(a,"_ads_promoted_post")||!s&&!n&&Wall.cmp(a.id,O.id)<0);)a=c?a.nextSibling:a.previousSibling;++D,a?Wall.cmp(a.id,O.id)?(r=a,(i=c?a.previousSibling:a.nextSibling)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"_ads_promoted_post")&&(r=i),c?(b!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(r)&&Wall.sendInsertBeforeError(),b.insertBefore(O,r)):(b!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(r.nextSibling)&&Wall.sendInsertBeforeError(),b.insertBefore(O,r.nextSibling))):(b.replaceChild(O,a),a=O,--D):c?b.appendChild(O):b.insertBefore(O,b.firstChild),l=O,(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_31__.placeholderSetup)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByTag1)("textarea",O),{fast:1})}}else{var C=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(O.id);C?b.replaceChild(O,C):b.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(O,b.firstChild):b.appendChild(O)}if(p.length)for(var g=0,T=p.length;g<T;++g){var R=p[g];if(R.beforePost||R.afterPost){for(var A="no_position",L=c?b.firstChild:b.lastChild;L;L=c?L.nextSibling:L.previousSibling){r=null;var B=M(L);if(B){if(R.beforePost===B?r=L:R.afterPost===B&&(r=L.nextSibling),r&&(r.previousSibling&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(r.previousSibling,"_ads_promoted_post")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(r,"_ads_promoted_post"))){r=null,A="ads_sibling";break}if(r){b!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(r)&&Wall.sendInsertBeforeError(),b.insertBefore(R.el,r),A=!1;break}}}A&&(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.statlogsValueEvent)("debug_watch",1,"js_page_ads_promoted_post_no_position",A)}}s&&!D?cur.wallTopFinished=cur.oid:n&&!D?cur.wallArchiveFinished=cur.oid:E&&!D&&(cur.wallDonutFinished=cur.oid),"full_own"!==t&&"full_all"!==t||(Pagination.recache(D),FullWall.updateSummary(cur.pgCount)),Wall.update(),wall.addReplyNames(e),Wall.updateMentionsIndex(),D&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateCurrentPlaying()},showMore:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox();if(!cur.wallLayer){if("suggested"===cur.wallTab)return Wall.suggestMore();if(!(cur.wallTypeLoading&&cur.wallTypeLoading[cur.wallType]||"top"===cur.wallType&&cur.wallTopFinished===cur.oid||"archive"===cur.wallType&&cur.wallArchiveFinished===cur.oid||"donut"===cur.wallType&&cur.wallDonutFinished===cur.oid)){var o=cur.wallType,l="top"===o,i="archive"===o,a="donut"===o,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_more_link"),s=cur.wallLoading=cur.oid,n=l&&!!cur.wallTopOnlyCache,E="";0!==_&&(E=i?cur.wallArchiveNextFrom:l?cur.wallTopNextFrom:a?cur.wallDonutNextFrom:cur.wallNextFrom),cur.wallTypeLoading=cur.wallTypeLoading||{},cur.wallTypeLoading[o]=!0,t=!0===t&&!_,ajax.post("al_wall.php",{act:"get_wall",owner_id:cur.oid,offset:_,type:o,fixed:cur.options.fixed_post_id||"",wall_start_from:E,onlyCache:n},{onDone:function(r,n,E,d){return e&&uiTabs.hideProgress(e),s!==cur.oid||o!==cur.wallType?(delete cur.wallLoading,void delete cur.wallTypeLoading[o]):l&&isObject(r)&&r.wait?(cur.wallTopLoadingDelay=cur.wallTopLoadingDelay?cur.wallTopLoadingDelay+100:200,void(cur.wallTopLoadingDelay<500?setTimeout((function(){delete cur.wallLoading,delete cur.wallTypeLoading[o],Wall.showMore(_)}),cur.wallTopLoadingDelay):(delete cur.wallLoading,delete cur.wallTypeLoading[o],cur.wallTopOnlyCache=!1,Wall.showMore(_)))):(delete cur.wallTopLoadingDelay,cur.wallVideos&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(E,(function(_,e){cur.wallVideos[_]&&(cur.wallVideos[_].list=cur.wallVideos[_].list.concat(e.list))})),i?cur.wallArchiveNextFrom=d:l?cur.wallTopNextFrom=d:a?cur.wallDonutNextFrom=d:cur.wallNextFrom=d,void setTimeout((function(){Wall.receive(r,n,o,t),_||o!==cur.wallType||Wall.showWall(),delete cur.wallLoading,delete cur.wallTypeLoading[o]}),0))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind(r),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind(r)})}}},showWall:function(){wall.switchTabContent(cur.wallType);var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("wall_module",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts")))[1];_<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)()&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(_-15)},checkTextLen:function(_,e,t){var o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(Emoji.editableVal(_).replace(/\n\n\n+/g,"\n\n"));if(_.lastLen!==o.length||t){var l=_.lastLen=o.length,i=(cur.options||{}).max_post_len||(window.mvcur||{}).maxReplyLength,a=l-o.replace(/\n/g,"").length;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(e),l>i-100||a>4?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(e),e.innerHTML=l>i?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_recommended_exceeded",l-i):a>4?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_recommended_lines",a-4):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("text_N_symbols_remain",i-l)):hide(e),window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()}else window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()},checkPostLen:function(_,e,t,o){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_);if(t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(t).replace(/\n\n\n+/g,"\n\n"),l&&(l.lastLen!==t.length||o)){var i=l.lastLen=t.length,a=cur.options.max_post_len,r=i-t.replace(/\n/g,"").length,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(e);i>a-100||r>4?(s.innerHTML=i>a?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_recommended_exceeded",i-a):r>4?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_recommended_lines",r-4):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("text_N_symbols_remain",a-i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(s)):hide(s)}},postChanged:function(_){var e,t=Wall.isPosterEditorOpen();if((t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("submit_post"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"),"shown")||Wall.showEditPost(),vk.id&&!vk.widget&&!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)){clearTimeout(cur.postAutosave);var o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(cur.oid)==vk.id?Wall.saveDraft:Wall.saveOwnerDraftText.pbind(cur.oid);!0===_?o():cur.postAutosave=setTimeout(o,10===_?10:1e3)}t||setTimeout(Wall.checkPosterAvailability)},ownerDraftKey:function(_){return"wall_draft"+vk.id+"_"+_},ownerDraftData:function(){return cur.wallDraftData||(cur.wallDraftData={}),cur.wallDraftData},addOwnerDraftMedia:function(_,e){var t;if(!(null===(t=cur.options)||void 0===t?void 0:t.no_draft)){var o=Wall.ownerDraftData(),l=e[0],i=e[1],a=e[2];o._attach_cache=o._attach_cache||{},a?o._attach_cache[l+i]=a:a=o._attach_cache[l+i],o.attaches=o.attaches||[];var r=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.get(Wall.ownerDraftKey(_))||{};!1!==l?o.attaches.push([l,i,a,o.attaches.length]):!1===l&&void 0!==i&&(o.attaches=o.attaches.filter((function(_){return _[3]!==i}))),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.set(Wall.ownerDraftKey(_),extend(r,{txt:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)(Wall.getDraftData().message||""),medias:o.attaches}))}},cleanOwnerDraftMedia:function(_){var e;if(!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)){var t=Wall.ownerDraftData(),o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.get(Wall.ownerDraftKey(_))||{};t.attaches=[],_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.set(Wall.ownerDraftKey(_),extend({txt:""},o,{medias:[]}))}},saveOwnerDraftText:function(_){var e;if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)){var t=Wall.ownerDraftData(),o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.get(Wall.ownerDraftKey(_))||{},l=Wall.getDraftData(),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)(l.message||""),a=null;if(t.txt=i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(o.medias||{},(function(_,e){switch(e[0]){case"postpone":l.postpone&&(o.medias[_][1]=l.postpone,o.medias[_][2].draft=1);break;case"poll":var t=(cur.wallAddMedia||{}).pollData(!0,!0);t&&extend(o.medias[_][2],t);break;case"copyright":var i=(cur.wallAddMedia||{}).copyrightData(!0);i&&extend(o.medias[_][2],i);break;case _web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION:l[_web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION]&&(o.medias[_][2]=Object.assign(o.medias[_][2]||{},{[_web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION]:l[_web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION]}))}})),i&&l.bkg_id&&(a={id:l.bkg_id},cur.poster&&cur.poster.isCustomBkgId(l.bkg_id)&&extend(a,cur.poster.getCustomBkg()),o.bkg_id&&delete o.bkg_id),extend(o,{txt:i,bkg:a}),cur.shareShowImg&&extend(o,{shareShowImg:cur.shareShowImg}),_<0){var r=cur.poster?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("official"));extend(o,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"from-oid")||vk.id,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("signed")?1:0}),(0,_web_donut__WEBPACK_IMPORTED_MODULE_33__.fieldValueIsDonutOnlyPost)(r,cur.wallAddMedia)?o.donutOnly=1:delete o.donutOnly}_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.set(Wall.ownerDraftKey(_),o)}},getOwnerDraft:function(_){var e;if(null===(e=cur.options)||void 0===e?void 0:e.no_draft)return[];var t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.get(Wall.ownerDraftKey(_))||[],o={from:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(t.from),signed:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(t.signed),shareShowImg:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(t.shareShowImg)};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(t.donutOnly)&&(o.donutOnly=1),[t.txt,t.medias,!0,o,t.bkg]},saveOwnerDraftMedia:function(_,e,t,o){var l;if(!(null===(l=cur.options)||void 0===l?void 0:l.no_draft)){Wall.cleanOwnerDraftMedia(_);var i=cur.wallAddMedia||{},a=[],r=(cur.wallAddMedia?i.getMedias():[]).slice().map((function(_){return _.slice(0,2)}));void 0!==t&&e?a=[[e,t,o]]:e||void 0===t||r.splice(t,1),r=r.concat(a),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(r,(function(){Wall.addOwnerDraftMedia(_,this)}))}},saveDraft:function(){var _;if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),!(null===(_=cur.options)||void 0===_?void 0:_.no_draft))if(cur.noDraftSave)cur.noDraftSave=!1;else if(!cur.postSent&&vk.id==(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(cur.oid)){var e=Wall.getDraftData();e.delayed||ajax.post("al_wall.php",Wall.fixPostParams(extend({act:"save_draft",hash:cur.options.post_hash},e)),{onFail:function(){return!0}})}},getDraftData:function(){var _;if(null===(_=cur.options)||void 0===_?void 0:_.no_draft)return{};var e=cur.wallAddMedia||{},t=e.chosenMedia||{},o=cur.wallAddMedia?e.getMedias():[],l=e.shareData||{},i="",a=0,r=null;if(Wall.isPosterEditorOpen())r=(i=cur.poster.getText())?cur.poster.getBkgId():null;else{var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field");i=window.Emoji?Emoji.editableVal(s):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(s),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(i)}var n={message:i,bkg_id:r};return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(t)&&t.length&&o.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)(t)),o.length&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(o,(function(_,t){if(t){var o=this[0],r=this[1];switch(o){case"poll":var s=e.pollData(!0,!0);if(!s)return n.delayed=!0,!1;r=s.question,delete s.question,n=extend(n,s);break;case"copyright":var E=e.copyrightData(!0);if(E)return void(n=extend(n,E));break;case"share":if(l.failed||!l.title&&(!l.images||!l.images.length)&&!l.photo_url&&!l.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(n.delayed=!0,!1):void 0;l.video?(r=l.video_owner_id+"_"+l.video_id,n.snippet_video=1):r=l.user_id&&l.photo_id&&!l.noPhoto?l.user_id+"_"+l.photo_id:"",l.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(i)==l.initialPattern&&(n.message=""),l.is_vk_mini_app&&(n.is_vk_mini_app=!0,n.is_photo_edit=l.isPhotoEdit,n.image_offset=cur.shareShowImg),n=extend(n,{url:l.url,module:cur.module,mode:l.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(l.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(l.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(l.button_text),button_action:l.button_action,extra:l.extra,extra_data:l.extraData,photo_url:l.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(l.photo_url),open_graph_data:(l.openGraph||{}).data,open_graph_hash:(l.openGraph||{}).hash});break;case"page":l.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(i)==l.initialPattern&&(n.message="");break;case"postpone":var d=+e.postponeDate;return void(n=extend(n,{postpone:d}));case"mark_as_ads":return void(n=extend(n,{mark_as_ads:1}));case _web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION:return void(n=extend(n,(0,_web_donut__WEBPACK_IMPORTED_MODULE_33__.getPostParamsFromDurationMedia)(t)))}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(i)==this[3]&&(n.message=""),n["attach"+(a+1)+"_type"]=o,n["attach"+(a+1)]=r,a++}})),n},setDraft:function(_){var e;if(!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)&&(_[0]||_[1]&&_[1].length||null!=_[4])){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field");if(t){var o=_[4];o||Emoji.val(t,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(_[0]||"")).replace(/\n/g,"<br/>")),Wall.showEditPost((function(){setTimeout((function(){if(o&&cur.poster){Wall.hidePosterFeatureTooltip();var e={text:_[0]||""};if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isString)(o)?e.bkgId=_[4]:isObject(o)&&(cur.poster.isCustomBkgId(o.id)&&cur.poster.addCustomBkg(o),e.bkgId=o.id),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(Wall.getMainPostBlock()))return cur.poster.setBkg(e.bkgId,!0),cur.poster.setText(e.text),void Emoji.val(t,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(_[0])).replace(/\n/g,"<br/>"));Wall.openPosterEditor(e)}if(_[1]&&cur.wallAddMedia)for(var l in _[1])cur.noDraftSave=!0,cur.wallAddMedia.chooseMedia.apply(cur.wallAddMedia,_[1][l]);Wall.checkPosterAvailability(),Wall.saveDraft()}),0)})),_[2]&&wall.focusOnEnd(),_[3]&&(wall.setReplyAsGroup((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("official"),_[3]),_[3].shareShowImg&&(cur.shareShowImgRestored=_[3].shareShowImg),_[3].donutOnly&&cur.wallAddMedia&&cur.wallAddMedia.donutPostSettings&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly()),cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}}},initPostEditable:function(_){var e=cur.postField;if(!e||e.emojiInited)return!1;e.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.init(e,{ttDiff:-42,rPointer:!0,controlsCont:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(e),noStickers:!0,onSend:Wall.sendPost,noEnterSend:!0,ref:"post",checkEditable:Wall.postChanged,initUploadForImagePasteCallback:function(_,e,t){window.Upload&&Upload.onFileApiSend(cur.wallUploadInd,[t])}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"submit_post_inited"),_?setTimeout(Wall.setDraft.pbind(_),0):cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)})),setTimeout((function(){cur.postFieldZoomText&&addEvent(e,"keydown paste",(function(){setTimeout((function(){cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}),0)}))}),0)},showEditPost:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field");if(cur.viewAsBox)return setTimeout((function(){e.blur()}),0),cur.viewAsBox();0!==cur.editing&&(setTimeout(WallUpload.init,0),Wall.initComposer(e,{lang:{introText:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("profile_mention_start_typing"),noResult:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("profile_mention_not_found")},checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect},_),Wall.hideEditPostReply(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)("submit_post_box","shown"),cur.editing=0,Wall.showPosterFeatureTooltip(),Wall.showPostCopyrightFeatureTooltip(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(cur.onShowEditPost)&&cur.onShowEditPost(),stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")]))},postBoxFocus:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.stopEvent)(_||window.event);var t=Wall.isPosterEditorOpen();(cur.postField&&window.Emoji||t)&&setTimeout((function(){e?t?(cur.poster.focusPoster(),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(cur.poster.getPosterElement())[1]-15)):(Emoji.focus(cur.postField),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(cur.postField)[1]-15)):t?cur.poster.focusPoster():Emoji.focus(cur.postField,!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"))}),0)},initComposer:function(_,e,t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"composer"))t&&t();else if(cur.composerAdded){var o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}else stManager.add(["wide_dd.css","wide_dd.js"],(function(){cur.composerAdded=!0;var o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}))},deinitComposer:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"composer");e&&Composer.destroy(e),_.emojiId&&window.Emoji&&Emoji.destroy(_.emojiId)},hasComposerMedia:function(_){var e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"composer");return!(!e||!e.addMedia)&&e.addMedia.attachCount()>0},composerListShown:function(_){var e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"composer");if(!e)return!1;var t=e.wdd,o=0;for(var l in t.shown)o+=1;return!!(t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(t.listWrap)&&o)},onPostValChange:function(_){if(cur.wallAddMedia&&cur.wallAddMedia.checkMessageURLs.apply(window,arguments),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||Pagination.pageTopUpdated(),browser.msie&&!_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field");hide(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)(e)}},onPostItemSelect:function(_){if(_&&!((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_[0])>=0)&&cur.wallAddMedia){var e="vk.com/event"+-_[0];cur.wallAddMedia.checkMessageURLs(e,!0)}},hideEditPost:function(_){cur.editing=!1;var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field"),t=cur.wallAddMedia||{},o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e));!browser.opera_mobile&&e&&(!_&&(o||t.chosenMedia||t.getMedias&&t.getMedias().length>0||t.activeState||t.attachCount&&t.attachCount()>0)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)("submit_post_box","shown"),e&&!o&&cur.postMention&&(cur.postMention.options.minHeight=cur.emptyPostheight||14),cur.onWallSendCancel&&cur.onWallSendCancel(),window.WallUpload&&WallUpload.hide(),cur.wallAddMedia&&cur.wallAddMedia._hideAddMedia(!0)))},clearInput:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("page_add_media");var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field");if(Wall.withMentions){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"mention");e&&(e.rtaEl.innerHTML="",hide(e.cont),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(_))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_,""),_.blur(),_.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),Wall.resetPostVisibilityAccess(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)("export_status",!1),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)("close_comments",!1),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.forEach((_=>{_()}));var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"composer");t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t.articleConvertEl),t.articleConvertEl=!1)},fixPostParams:function(_){var e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)(_);return e.Message=_.message,delete e.message,e},focusOnEnd:function(_){if(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field"))if("TEXTAREA"!=_.tagName){var e=_.innerHTML?_.innerHTML.length:_.length?_.length:_.childNodes.length-1;if(_.focus(),document.selection){var t=document.selection.createRange();t.moveStart("character",e),t.select()}else window.getSelection().collapse(_,_.childNodes.length)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)(_)},showPostSettings:function(_,e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"ett")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_),o=t&&t.querySelector(".Post__copyrightButton");new ElementTooltip(_,{cls:"post_settings_tooltip"+(o?" post_settings_tooltip_with_custom_btn":""),content:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(t),defaultSide:"top",offset:[0,-5],appendTo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_)}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t)}e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkKeyboardEvent)(e)&&"click"===e.type&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"ett").toggle()},togglePostVisibilityAccess:function(_,e,t,o){t=t||"";var l="post_visibility_btn",i=cur[l+t];i&&i.hide(),(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_40__.updatePostTooltipActionRadioBtn)(_,e,"post_settings_btn"+l+t);var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_visibility_btn"+t),r=geByClass1("post_action_btn_text",a),s=![_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS].includes(e);if(e===_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS){var n=(window.event||{}).target,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("best_friends_only"+t).querySelector(".PostVisibilityBestFriendsOnlyOption"),d=Number(E.dataset.count);n&&n.closest(".PostVisibilityBestFriendsOnlyOption__editLink")||0===d?((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_48__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_48__.BestFriendsEventType.editBestFriends),this.resetPostVisibilityAccess(),stManager.add([jsc("web/best_friends.js"),"BestFriends.css"],(()=>{window.bestFriendsBoxSettings((_=>{var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("best_friends_only"+t);if(0===_)e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.getTemplate)("visibility_access_best_friends_only_option",{html:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_choose_best_friends"),count:_}),this.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("no_friends_only"+t),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,t,!0);else{var o=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_best_friends_settings_box_conversation_friends_count",_);e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.getTemplate)("visibility_access_best_friends_only_option",{html:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.getTemplate)("visibility_access_best_friends_only_item",{count_text:o}),count:_}),this.togglePostVisibilityAccess(e,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,t,!0)}}))}))):((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_48__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_48__.BestFriendsEventType.selectBestFriends),r.innerHTML=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_best_friends_only"),r.setAttribute("aria-label",(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_best_friends_only")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(a,"best_friends_only"))}else if(s){var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("no_friends_only"+t).querySelector(".FancyElementTT__itemLabel").innerHTML;r.innerHTML=c,r.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(c)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(a,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(a,"best_friends_only")}else{var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("friends_only"+t).querySelector(".FancyElementTT__itemLabel").innerHTML;r.innerHTML=b,r.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(b)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(a,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(a,"best_friends_only")}o||Wall.postChanged()},resetPostVisibilityAccess(){Wall.canChangeVisibilityForNewPost()&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("no_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,!1,!0)},canChangeVisibilityForNewPost:()=>!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_visibility_btn"),initPostVisibilitySelector(_){Wall.canChangeVisibilityForNewPost()&&(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_40__.createPostTooltip)("post_visibility_btn",_.id)},cantAccessDonutPosts:()=>!1===window.cur.donutGroupUserHasWallAccess,togglePostMarkAsAds:function(_,e){e=e||"mute_notifications";var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(e);if(t){var o=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(_);if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(t,o),o)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"prev-state",+(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(t,"on");else{var l=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"prev-state");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(t,"on",l)}}},needCheckSign:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("check_sign");return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(_)},saveCheckSign:function(_){var e=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(_),t=_.querySelector(".PostOption__iconWrapper"),o="",l="";e?(o=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_check_sign_disabled"),l=(0,_icons_desktop_getIcon20UserOutline__WEBPACK_IMPORTED_MODULE_54__.getIcon20UserOutline)().icon):(o=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_check_sign_enabled"),l=(0,_icons_desktop_getIcon20UserSlashOutline__WEBPACK_IMPORTED_MODULE_55__.getIcon20UserSlashOutline)().icon),t.innerHTML=l,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"title",o),window.tooltips&&tooltips.hide(_,{onHide:_.onmouseover.bind(_)}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)(_,!e)},checkAsGroup:function(_){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)(_),wall.setReplyAsGroup(_,{fromGroup:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(_)})},sendPost:function(_,e){var t=cur.wallAddMedia||{},o=t.chosenMedia||{},l=cur.wallAddMedia?t.getMedias():[],i=t.shareData||{},a=cur.poster&&!!e,r=a?e.text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field"))),s=!1,n=a?null:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("send_post"),E=cur.options.suggesting?"suggest":cur.wallType;"top"===E&&(E="all"),a&&(l=l.filter((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(_)){var e=_slicedToArray(_,1)[0];return["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION].includes(e)}})));var d=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("official")),c=(0,_web_donut__WEBPACK_IMPORTED_MODULE_33__.fieldValueIsDonutOnlyPost)(d,t),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"from-oid")==cur.postTo?1:"";d&&cur.postTo||b||cur.defaultPostSettings&&(b=cur.defaultPostSettings.official?1:"");var p={act:"post",message:r,to_id:cur.postTo,type:E,friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("friends_only"),best_friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("best_friends_only"),check_sign:Wall.needCheckSign(),close_comments:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("close_comments")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("close_comments")?1:0:"",mute_notifications:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mute_notifications")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("mute_notifications")?1:0:"",mark_as_ads:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("mark_as_ads")?1:0,official:b,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)("signed"),hash:cur.options.post_hash,from:cur.from?cur.from:"",fixed:cur.options.fixed_post_id||"",situational_suggest_id:cur.options.situational_suggest_id||null},u=0;extend(p,(0,_web_donut__WEBPACK_IMPORTED_MODULE_33__.getDonutPostParams)(c,t)),cur.options.additional_save_params&&(p=extend(p,cur.options.additional_save_params));var P,D=cur.wallAddMedia&&cur.wallAddMedia.id||"";function m(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("submit_post_error")||((0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.slideDown)("submit_post_error",100),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.animate)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("box_layer_wrap"),{scrollTop:0})),Wall.isPosterEditorOpen()){var t=cur.poster.getErrorWrapperElement();t.innerHTML="",t.appendChild(e)}}if(extend(p,(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_38__.getPostTopicSelectorParams)(String(D))),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(o)&&o.length&&l.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)(o)),a&&(p.poster_bkg_id=e.bkgId,p.poster_bkg_access_hash=e.accessHash,e.fallbackObj&&(l.push(["photo",e.fallbackObj.owner_id+"_"+e.fallbackObj.id,!1]),p.poster_photo_hash=e.fallbackObj.post_hash),p.poster_bkg_id!==cur.posterCtaBkgId&&(p.poster_author_bkg_check=!0)),hide("submit_post_error"),l.length){var w=0;P=!1,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(l,(function(_,e){var o;if(e){var a=this[0],d=this[1];switch(a){case"video":if(s||"suggest"==E)break;var c=Wall.getOwnerDraft(cur.oid)[1];if(!c)break;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(c,(function(_,e){e[1]===d&&e[2]&&e[2].upload_new&&w++}));break;case"poll":var b=t.pollData();if(!b)return P=!0,!1;d=b.question,delete b.question,p=extend(p,b);break;case"copyright":var D=t.copyrightData();if(D)return void(p=extend(p,D));break;case"share":if(i.failed||!i.title&&(!i.images||!i.images.length)&&!i.photo_url&&!i.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(P=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&i.button_text&&i.button_action){var M;l.length>1&&(M=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_too_many_attachments")),r.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(M=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_too_many_newlines")),r.length>(cur.options.share||{}).button_exclusive_max_message_len&&(M=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_too_long_message"));var O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.extractUrls)(" "+r+" "),C=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.extractUrls)(" "+i.url+" ")[0];if(C&&O.length){"/"===C.query&&(C.query=""),"www."===C.domain.substr(0,4)&&(C.domain=C.domain.substr(4));for(var g=0;g<O.length;++g){var T=O[g];if("/"===T.query&&(T.query=""),"www."===T.domain.substr(0,4)&&(T.domain=T.domain.substr(4)),C.domain!=T.domain||C.query!=T.query){M=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_too_many_links");break}}}if(M)return m(M),P=!0,!1}if(!i.title)return m((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_title_required")),P=!0,!1;if(!i.url)return m((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_url_required")),P=!0,!1;if(i.url=new URL(i.url).href,i.video?(d=i.video_owner_id+"_"+i.video_id,p.snippet_video=1):d=i.user_id&&i.photo_id&&!i.noPhoto?i.user_id+"_"+i.photo_id:"",i.share_upload_failed&&!d)return void(i.share_upload_failed=0);if(i.images&&i.images.length&&!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(i.images[cur.shareShowImg])&&!d&&!i.noPhoto&&!i.share_own_image&&!i.video)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(n),t.uploadShare((function(){Wall.sendPost(!0)})),P=!0,!1;if((cur.options.share||{}).require_image&&!d)return m((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_share_image_required")),P=!0,!1;i.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(r)==i.initialPattern&&(p.message=""),i.is_vk_mini_app&&(p.is_vk_mini_app=!0,p.is_photo_edit=i.isPhotoEdit,p.image_offset=cur.shareShowImg),p=extend(p,{url:i.url,module:cur.module,mode:i.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(i.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(i.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(i.button_text),button_action:i.button_action,extra:i.extra,extra_data:i.extraData,photo_url:i.noPhoto||i.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.replaceEntities)(i.photo_url),open_graph_data:(i.openGraph||{}).data,open_graph_hash:(i.openGraph||{}).hash});break;case"page":i.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(r)==i.initialPattern&&(p.message="");break;case"postpone":var R=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("postpone_date"+t.lnkId);return p=extend(p,{postpone:R}),cur.postponedLastDate=R,void(s=!0);case"mark_as_ads":return void(p=extend(p,{mark_as_ads:1}));case"pretty_cards":if(!t.prettyCardGallery)return;if(t.prettyCardGallery.needSendData())return t.prettyCardGallery.saveCards(Wall.sendPost,(function(_){m(_)})),P=!0,!1;var A=t.prettyCardGallery.getSendData();d=A.attachVal;break;case"podcast":if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(this[2],"attach_disabled"))return!1;break;case _web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION:return;case"donut_link":p["attach"+(u+1)+"_owner_id"]=null===(o=this[5])||void 0===o?void 0:o.owner_id}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(r)==this[3]&&(p.message=""),p["attach"+(u+1)+"_type"]=a,p["attach"+(u+1)]=d,u++}}));var M=cur.postTo<0||cur.postTo===vk.id;if(cur.wallUploadVideoOpts&&cur.wallUploadVideoOpts.vars.is_wall_postponed_allowed&&M&&w&&!_&&!cur.postponeVideoPost)return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)().hide(),void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showBox)("al_video.php?act=postponed_post_box",{videos_count:w},{onDone:function(_,e){_.removeButtons(),_.addButton(e.video_post_later_text,(function(){cur.postponeVideoPost=!0,Wall.sendPost(!0),_.hide()})),_.addButton(e.video_post_now_text,(function(){Wall.sendPost(!0),_.hide()}),"no")}});if(P)return void(_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(n))}if(!u&&!r)return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(n),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)("post_field");if(!n||_||!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isButtonLocked)(n)){cur.postponeVideoPost&&(p=extend(p,{postpone_video:!0,postpone_video_hd:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("postponed_post_hd"))})),cur.postAutosave&&clearTimeout(cur.postAutosave),hide("submit_post_error"),cur.postSent=!0;var O=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0;p.update_admin_tips=O;var C=(0,_web_donut__WEBPACK_IMPORTED_MODULE_33__.isPaidAttachPicked)(t,cur.oid);p.donut_duration&&-1!==p.donut_duration&&C&&!cur.donutAttachesApproved?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)({title:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("publish_postponed_title"),onHide:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(n)}},(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_publish_donut_freeing_attaches_confirmation_title"),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("publish_postponed_btn"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)().hide(),cur.donutAttachesApproved=!0,Wall.sendPost(_,e)}),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_cancel"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)().hide(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(n)})):setTimeout((function(){ajax.post("al_wall.php",Wall.fixPostParams(p),{onDone:function(_,e,o,l){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isString)(o)||(o=null),cur.poster&&a&&(cur.poster.unlockEditPoster(),cur.poster.closeEditor(),cur.poster.resetPoster(),cur.posterCtaBkgId&&(cur.posterCtaBkgId=null)),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),Wall.clearInput(),cur.postSent=!1,cur.postponeVideoPost=!1,cur.donutAttachesApproved=!1;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mark_as_ads"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mute_notifications");if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(i)&&r&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(r,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(r,0)),i&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(i,"on"),t.donutUpdateVisibility()),cur.options.onSendPostDone)cur.options.onSendPostDone.apply(window,arguments);else{if(l&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(l),!isObject(_)||!_.redirect){if((0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_44__.showHiddenNavigableTabs)(),s){if("feed"==E)(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(_,{out:3e3});else if("full_own"==E||"full_all"==E)return Wall.showPostponedFull(_);return wall.updateTabVisibility("page_wall_postponed",!0),void Wall.showPostponed(!1,_)}if(("full_own"==E||"full_all"==E)&&(cur.pgStart||nav.objLoc.postponed)){var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)(nav.objLoc);return delete n.offset,delete n.postponed,vk.id!=cur.oid&&delete n.own,nav.go(n)}if(vk.id!=cur.oid&&"full_own"==E){var d=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)(nav.objLoc);return delete d.own,nav.go(d)}return"feed"==E?cur.wallPostCb():"suggest"==E?(wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(!1,_,e),Wall.suggestUpdate()):void(c?Wall.showDonutWall(_):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_tabs")&&geByClass1("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_tabs")).click(),Wall.receive(_,e),cur.onWallSendPost&&cur.onWallSendPost(),O&&null!==o&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(o)))}nav.go(_.redirect)}},onFail:function(_){if(cur.postSent=!1,cur.postponeVideoPost=!1,cur.donutAttachesApproved=!1,cur.poster&&a&&cur.poster.unlockEditPoster(),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),!cur.options.onSendPostFail){if(!_)return!0;var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("submit_post_error")||(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.slideDown)("submit_post_error",100),Wall.isPosterEditorOpen()){var t=cur.poster.getErrorWrapperElement();t.innerHTML="",t.appendChild(e)}return!0}cur.options.onSendPostFail.apply(window,arguments)},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(n)},hideProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(n)},noSort:!0})}),0)}},_repliesLoaded:function(_,e,t,o,l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_);if(i){var a=i.nextSibling;if(e){var r=i.offsetHeight;i.innerHTML=t,(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)()+(i.offsetHeight-r),0,void 0,!0),setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)}else i.innerHTML=t;if(a&&"replies_open"==a.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(a),ajax._framenext(),_==cur.wallLayer){var s=wkcur.reverse;extend(wkcur,{offset:!s&&l.offset||0,loaded:l.num||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",i,"div").length,count:l.count}),wall.addReplyNames(o),WkView.wallUpdateReplies(),s||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll())}else wall.addReplyNames(o),Wall.repliesSideSetup(_);Wall.updateMentionsIndex(),setTimeout((function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateCurrentPlaying()}),10),l&&Likes.updateComments("wall"+_,l.count)}},repliesSideSetup:function(_){if(cur.wallLayer!=_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_);if(e){var t=geByClass1("wr_header",e,"a"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,"deep_active"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_side"+_);if(cur.wallMyOpened[_]&&(t||l)){if(!i){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)('<div class="replies_side_wrap"><div id="replies_side'+_+'" class="replies_side"></div></div>');e.parentNode.insertBefore(a,e),(i=a.firstChild).onmouseover=Wall.repliesSideOver.pbind(_),i.onmouseout=Wall.repliesSideOut.pbind(_),i.onclick=l?Wall.hideDeepReplies.pbind(_):Wall.repliesSideClick.pbind(_)}e.onmouseover=Wall.repliesSideOver.pbind(_),e.onmouseout=Wall.repliesSideOut.pbind(_),Wall.repliesSideOver(_)}else hide(i),e.onmouseover=null,e.onmouseout=null}}else WkView.wallUpdateReplies()},repliesSideClick:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),t=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(e)[1];return t>o&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(o-100,0),hide("replies_side"+_),Wall.showReplies(_,3,!1)},repliesSideOver:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_side"+_);if(e){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(t))[1],l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(t)[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(e)[1],a=e.offsetHeight,r=window.lastWindowHeight||0,s=o+l-r+15,n=i+a-r;cur.wallRepliesSideOver=[_,t,s,n],Wall.repliesSideUpdate()}},repliesSideOut:function(_){cur.wallRepliesSideOver&&cur.wallRepliesSideOver[0]==_&&delete cur.wallRepliesSideOver},repliesSideUpdate:function(_){var e=cur.wallRepliesSideOver;if(e){var t,o=e[1],l=e[4]||{},i=e[5]||"",a="replies_side";void 0===_&&(_=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)()),_<e[2]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o),t={marginTop:0,opacity:1}):_<e[3]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(o),a+=" replies_side_fixed",t={opacity:Math.max(0,Math.min(1,(e[3]-_)/200))}):(a+=" replies_side_hidden",t={marginTop:e[3]-e[2],opacity:0,display:null}),JSON.stringify(l)!==JSON.stringify(t)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(l,(function(_,e){l[_]=null})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(o,extend(l,t)),e[4]=t),i!=a&&(o&&(o.className=a),e[5]=a)}},highlightReply:function(_){(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"reply_highlighted"),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(_,"reply_highlighted")}),1500))},scrollHighlightReply:function(_){if(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_))if(cur.wallLayer||_.id.match(/^post-?\d+(photo|video|market)?_\d+$/)&&(window.wkcur&&wkcur.shown||window.mvcur&&mvcur.mvShown||cur.pvShown)){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(_,!0)[1];e<0||e>lastWindowHeight-200?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+e-50},300,Wall.highlightReply.pbind(_)):Wall.highlightReply(_)}else{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(_)[1];t<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)()+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_header")[1]?((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(t,300),setTimeout(Wall.highlightReply.pbind(_),300)):Wall.highlightReply(_)}},showReply:function(_,e,t,o){if(cur.viewAsBox)return!1;if(o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(o))return!0;if(window.mvcur&&mvcur.post==e)return Videoview.showComment(t),!1;var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+t);if(l)Wall.scrollHighlightReply(l);else if(cur.wallLayer==e)WkView.wallShowPreviousReplies(t);else if(e.match(/market/))Market.comments(e);else{if(_.tt&&_.tt.hide&&_.tt.hide(),"full"==cur.wallType){var i=t.split("_");return delete nav.objLoc.offset,nav.go(extend(nav.objLoc,{reply:i[1]}))}Wall.showReplies(e,!1,t)}return!1},showReplies:function(_,e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(o||window.event))return!0;if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer!=_||!wkcur.reverse){cur.wallMyOpened[_]=3!=e;var l={act:"get_replies",post:_,count:e},i={onDone:Wall._repliesLoaded.pbind(_,t),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind("wrh"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind("wrh"+_),local:1};if(t||e&&!(e>20)||(extend(l,{cont:"replies"+_}),extend(i,{frame:1}),cur.onFrameBlocksDone=function(){setTimeout(Wall.repliesSideSetup.pbind(_),browser.msie?100:10)}),ajax.post("al_wall.php",l,i),!browser.msie&&e>0&&e<10){for(var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),r=a&&a.lastChild,s=[];s.length<e&&r;)"DIV"==r.tagName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(r,"reply")&&s.push(r),r=r.previousSibling;if(s.length==e){var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",a,"div").length;for((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a,'<a class="wr_header wrh_all"></a>'),Wall.updateRepliesHeader(_,a.firstChild,e,n),hide("replies_side"+_);s.length;)a.appendChild(s.pop());(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)("wrh"+_)}}return!1}},moreReplies:function(_,e,t,o){var l;if(o.deep){var i=_.split("_");l={act:"get_post_replies",offset:e,owner_id:i[0],item_id:i[1],count:t},o.order&&(l.order=o.order)}else l={act:"get_replies",offset:e,post:_,count:t};return extend(l,{rev:o.rev,from:o.from}),ajax.post("al_wall.php",l,{onDone:function(e,t,l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_);o.clear?i.innerHTML=e:o.rev||o.append?i.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(e)):i.innerHTML=e+i.innerHTML,wall.addReplyNames(t),o.onDone&&o.onDone(e,t,l),Wall.updateMentionsIndex()},onFail:()=>!1,showProgress:o.showProgress,hideProgress:o.hideProgress}),!1},openDeepShortReplies:function(_,e){var t=geByClass1("replies_next",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_));return t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(t),t.focus(),t.click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)},collapseDeepReplies:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+e);if(t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"replies_list_deep")){var o=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(_)[1],i=Math.round((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.clientHeight)()/2);cur.wallLayer?(l-=o)<i&&(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+l-i},300):o>l-i&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(l-i),(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e));var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span",{className:"progress_inline replies_next_loader"});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_),t.innerHTML="";var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box_wrap"+e);r&&hide(r);var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+e),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",t),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"post-id"),d=wall.getRepliesOrder(E);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(s,"replies_deep_has_field"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(s,"replies_deep_has_short"),wall.updateRepliesOnScroll(),ajax.post("al_wall.php",{act:"get_collapsed_replies",reply_id:e,order:d},{onDone:function(_){t.innerHTML=_},onFail:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(cur.wallTpl.reply_deep_next,{post_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"post-id"),reply_id:e,offset:0,text:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_next_n_replies",cur.options&&cur.options.replies_page_count||20),class:" replies_next_deep"}));t.appendChild(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(_)},showProgress:function(){t.appendChild(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(a)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(a)}})}},overCollapseDeepReplies:function(_){var e=geByClass1("replies_deep_collapse_icon",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(e),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getStyle)(e,"bottom")),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(_),a=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),r=cur.wallLayer?wkLayerWrap.scrollTop:a;cur.wallLayer&&(i[1]-=a);var s,n,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.clientHeight)(),d=i[1]+l[1],c=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_56__.getFixedReplyField)(),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(c)[1];cur.wallLayer?(s=r+d-E,n=r+i[1]+t[1]+o+o-E):(s=d-E,n=i[1]+t[1]+o+o-E),cur.onScrollCollapseDeepReplies=wall.updCollapseDeepRepliesIcon.pbind(_,e,{iconSize:t,iconBottom:o,collapseSize:l,collapsePos:i,fixedField:c,fixedFieldSize:b,maxFixedScroll:s,topMaxScroll:n}),addEvent(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),addEvent(window,"resize",cur.onScrollCollapseDeepReplies),cur.onScrollCollapseDeepReplies()},outCollapseDeepReplies:function(_){cur.onScrollCollapseDeepReplies&&(removeEvent(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),removeEvent(window,"resize",cur.onScrollCollapseDeepReplies),delete cur.onScrollCollapseDeepReplies);var e=geByClass1("replies_deep_collapse_icon",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updCollapseDeepRepliesIcon:function(_,e,t){var o=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),l=t.maxFixedScroll;if((cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t.fixedField,"wl_reply_form_fixed")||"full"===cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t.fixedField,"fixed"))&&(l+=t.fixedFieldSize),o<l){var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((t.collapseSize[0]-t.iconSize[0])/2),a=t.topMaxScroll+t.fixedFieldSize-o,r=t.fixedFieldSize+t.iconBottom;a>0&&(r-=a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(e,{position:"fixed",bottom:r,left:t.collapsePos[0]+i,right:"auto"})}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updateCollapseDeepReplies:function(_){if(cur.wallTpl&&cur.wallTpl.reply_deep_collapse){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_));if(e){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"post-id");var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_);if(!t)return t;var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",t).length>=2,l=geByClass1("replies_deep_collapse",e);if(o){if(l)return;l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(cur.wallTpl.reply_deep_collapse,{reply_id:_})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(l,t)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(l)}}},showNextReplies:function(_,e,t){var o=e.split("_"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"offset"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"count"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"collapse"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"replies_prev"),s=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)("post"+e,"reply"),E={act:"get_post_replies",owner_id:o[0],item_id:o[1],offset:l,count:i,collapse:a},d=r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPS)(_);if(d&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(d,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(d,"replies_wrap_deep"))){var c=((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"post-id")||"").split("_")[1];r?E.next_id=c:E.prev_id=c}if(n)cur.wallLayer||(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",s));else{var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+e),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(b,"top-ids");p&&(E.top_replies=p)}var u=s.offsetHeight,P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"post-id");E.order=wall.getRepliesOrder(P);var D=n&&wall.isDescRepliesOrder(P,E.order);D&&(r=!r);var m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span",{className:"progress_inline replies_next_loader"});return ajax.post("al_wall.php",E,{onDone:function(t,o,i){var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domChildren)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:t})),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(),d=!1;n.forEach((function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"wr_header")){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_.id);e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"replies_wrap_deep"))||(E.appendChild(_),d=!0)}}));var c,b,p=r&&!D||!r&&D,m=!1;if(p){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+e),"replies_deep_has_short")){var w=window.innerHeight||document.documentElement.clientHeight,M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_header")[1],O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_),C=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(O)[1];c=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),m=cur.wallLayer?C<w:C<c+w-M}b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(E,_)}else b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domLC)(E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)(E,_);var g=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(i.num),T=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(i.offset),R=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(i.count),A=Math.max(0,T+(r?-g:g)),L=R-A,B=0;if(d&&(r&&T>0||!r&&L>0)&&(B=r?l-A:Math.min(L,g),i.closest_inx>=0&&(B=Math.min(B,i.closest_inx))),document.activeElement===_?addEvent(_,"focusout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_)})):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_),B){var W=_.cloneNode(!0);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(W,"replies_next_pre_deleted"),a||(p?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(W,b),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(W,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_prev_n_replies",B))):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)(W,b),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(W,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_next_n_replies",B))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(W,"count",B),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(W,"offset",A))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+e),"replies_deep_has_short");var h=s.offsetHeight-u;if(m&&h){var I=c+h;cur.wallLayer?wkLayerWrap.scrollTop=I:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(I,0,!1,!0)}wall.updateCollapseDeepReplies(e),wall.updateMentionsIndex(),wall.addReplyNames(o),wall.addDeepRepliesBlock(e),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[P]=1,wall.repliesSideSetup(P),wall.updateRepliesOnScroll()},onFail:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(_,"replies_next_pre_deleted")},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"replies_next_pre_deleted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)(m,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(m)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(m)}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(!1)},emojiOpts:{},emojiShowTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttShow(Wall.emojiOpts[_],e,t)},emojiHideTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttHide(Wall.emojiOpts[_],e,t)},initReplyEditable:function(_,e,t,o,l){if(_.emojiInited)return!1;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+t),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_media_preview"+t);_.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){var r=Emoji.init(_,{ttDiff:o?-40:-42,rPointer:!0,controlsCont:e,shouldFocus:!l,ref:"reply",onSend:function(){Wall.sendReply(t),_.blur()},ctrlSend:function(){return Wall.customCur().wallTpl.reply_multiline||Wall.composerListShown(_)},checkEditable:function(){cur.onReplyChanged&&cur.onReplyChanged(_,t),Wall.checkTextLen(_,"reply_warn"+t)},onChange:function(){i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(i,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(Emoji.editableVal(_))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(a,"media_preview_has_medias")),Wall.hideCheckTimer(t,"editing")},onStickerSend:function(_,e){Wall.sendReply(t,!1,{stickerId:_,sticker_referrer:e})},initUploadForImagePasteCallback:Page.initUploadForImagePaste});if(vk.widget&&!window.emojiStickers&&Emoji.updateTabs(),Wall.emojiOpts[t]=r,cur.afterEmojiInit&&cur.afterEmojiInit[t]){var s=geByClass1("emoji_smile",Emoji.opts[r].controlsCont);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(s)&&(cur.afterEmojiInit[t](),delete cur.afterEmojiInit[t])}}))},initEditReply:function(_,e,t,o){var l,i=_,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(r,"reply"),d=cur.wallLayer?wkcur:cur,c=!1;if(E){if(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",r)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",r),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"deep_active")){if(!cur.reply_to){var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"answering-id");if(b){var p=_.split("_")[1];cur.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(b),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(p)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_,p)}}wall.addDeepRepliesBlock(_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+_)}i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"post-id")}else cur.wallLayer?(c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"),"deep_active"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_reply_form_inner")):(l=r,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"deep_active"));if(!l&&s?l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_wrap",s):!l&&n&&(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_wrap",n)),s){var u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+i),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(u,"can_reply_as_group"),D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(u,"can_reply_as_any_group"),m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"owner-photo")||"",w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"owner-href")||"",M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"owner-name")||"",O="";D?O=d.wallTpl.reply_form_any_group:P&&(O=d.wallTpl.reply_form_group),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(c&&d.wallTpl.reply_form_new?d.wallTpl.reply_form_new:d.wallTpl.reply_form,{add_buttons:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(O,{post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_),owner_photo:m||"/images/blank.gif"}),post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_),owner_photo:m,owner_href:w,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.unclean)(M))})),s.parentNode.replaceChild(n,s),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_)}if(!a)throw new Error("Failed to init new reply or edit reply: no reply field");if(Wall.initReplyEditable(a,n,_,e,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(a,"composer"))o&&o();else{var C,g,T,R,A=[],L=!1;window.mvcur&&mvcur.mvShown?C=mvcur.mvMediaTypes:cur.wallLayer==i?C=wkcur.options.rmedia_types:window.pvcur&&cur.pvShown?(C=pvcur.rmedia_types,g=0,T=0):C=d.options&&d.options.rmedia_types,(c||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l.parentElement,"VerticalVideoLayerInfo__commentsReply"))&&(L=!0,g=0,T=0),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(C||d.options&&d.options.media_types||[],(function(){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(this[0],["photo","video","audio","doc","link","page"])&&A.push(this)}));var B=!1,W=i.match(/^(\d+_)?-?\d+_(photo|video|topic|market)?\d+(mv)?(_\d+)?$/);A.length>0&&W?(R={lnk:c?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_more_attaches"+_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_add_media_"+_),preview:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_media_preview"+_),actionsEl:!1,gearEl:!1,types:A,options:{from:"topic"===W[2]?"board":"comment",limit:2,disabledTypes:["album","market","market_album","poll",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_37__.MEDIA_SELECTOR_GROUP],toggleLnk:!0,maxShown:void 0!==g?g:void 0,hideAfterCount:void 0!==T?T:void 0,vectorIcon:L,hideLabel:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_reply_add_attach_label"),toId:"full"===cur.wallType?cur.oid:cur.postTo,onToggleBlock:function(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_),o=geByClass1("reply_box_photo",t);o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)(o,e)},onMediaChanged:function(){Wall.hideCheckTimer(_,"editing"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)("reply_button"+_,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(Emoji.editableVal(a))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)("reply_media_preview"+_,"media_preview_has_medias"))}}},i.match(/^-?\d+_topic/)&&(extend(R.options,{disabledTypes:["album","share","link","page"],limit:10,editable:1,sortable:1,teWidth:280,teHeight:200}),B=!0)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_add_media_"+_),Wall.initComposer(a,{lang:{introText:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("profile_mention_start_typing"),noResult:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("profile_mention_not_found")},toup:B,wddClass:"reply_composer_dd",width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(a.parentNode)[0],media:R,isReply:!0},o)}return void 0!==a.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),{postId:i,postEl:l,isReply:E,rf:a}},showEditReply:function(_,e,t,o,l,i){if(cur.viewAsBox)return setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_).blur()}),0),cur.viewAsBox();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)("post"+_,"Post--with_closed_comments_donut"))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)("replies_wrap"+_,{display:""}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e);var a=wall.initEditReply(_,t,l,i);if(a.rf){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("reply_box_wrap",a.rf));var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",a.rf);r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(r,"replies_deep_has_field")}return cur.wallMyOpened&&(cur.wallMyOpened[_]=cur.wallMyOpened[_]||!1),cur.editing===_?(Emoji.editableFocus(a.rf,!1,!0),!1):(Wall.hideEditPostReply(),a.isReply?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(a.postEl,"reply_box_open"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(a.postEl,"post--replyBoxWasOpened")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)("replies_wrap"+_,{display:""}),cur.editing=_,window.Emoji&&setTimeout((function(){Emoji.editableFocus(a.rf,!1,!0),Wall.repliesSideOver(_)}),0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.triggerEvent)(window,"scroll"),void 0!==a.rf.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),cur.wallTpl&&cur.wallTpl.reply_multiline_intro&&ajax.post("al_wall.php",{act:"a_ctrl_submit_intro",hash:cur.wallTpl.poll_hash},{onDone:function(e){e&&cur.editing===a.postId&&Wall.replySubmitTooltip(_,1)},onFail:function(){return!0}}),window.mvcur&&(mvcur.post==a.postId&&Videoview.onShowEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),mvcur.scrollBottom&&mvcur.scrollBottom()),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(cur.onReplyFormSizeUpdate)&&cur.onReplyFormSizeUpdate(a.rf),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(cur.onReplyFormFocus)&&cur.onReplyFormFocus(a.rf),!1)},hideEditReply:function(_,e){cur.editing=!1;var t,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_),a=cur.reply_to&&Wall.getReplyName(cur.reply_to[0]),r=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(window.Emoji?Emoji.editableVal(o):""),s=Wall.hasComposerMedia(o),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"reply");if(!(t=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_reply_form_inner"):n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",l):l)&&i&&(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_wrap",i)),o&&(!s||e)){if(a&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(a)&&a[1]&&(r&&a[1].indexOf(r)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o,""),r="")),e&&(r||s)){var E=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(o,"composer");E?Composer.reset(E):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o,""),r="",hide(geByClass1("reply_warn",t))}if(!(browser.opera_mobile||browser.safari_mobile||r)){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)().isVisible()||(n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(t,"reply_box_open")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_link"+_)&&hide("replies_wrap"+_),window.tooltips&&i&&tooltips.hideAll(i),o.blur(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.triggerEvent)(window,"scroll"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_,""),hide("reply_to_title"+_),cur.reply_to=!1;var d=Wall.emojiOpts[_];d>=0&&Emoji.opts[d]&&Emoji.opts[d].onChange&&Emoji.opts[d].onChange(),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate();var c=cur.replySubmitSettings;c&&c.tt&&c.tt.el&&c.tt.destroy(),window.mvcur&&mvcur.post==_&&(Videoview.onHideEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate())}}},replyNamesRE:function(){wall.addReplyNames({});var _=wall.getReplyNames();if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isEmpty)(_))return!1;var e=[];return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(_,(function(_,t){t&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(t)&&(t=t[1]),"string"==typeof t&&e.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.escapeRE)(t)))})),new RegExp("^("+e.join("|")+")")},replyTo:function(_,e,t,o){var l=window.cur.wallLayer==_?wkcur:window.cur;Wall.showEditReply(_,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_,e);var i=l.reply_to&&Wall.getReplyName(l.reply_to[0]);l.reply_to=[t,e];var a=Wall.getReplyName(t),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_as_group"+_),s=_.match(/^(-?\d+)_([a-z]+)?(\d+)([a-z]+)?$/),n=s[1],E=s[2]||"",d=s[4]||"",c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+n+E+"_"+e),b=c&&geByClass1("reply_to",c,"a"),p=Wall.replyNamesRE(),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",c)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",c),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(u,"deep_active"),D=P?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",c):null,m=D?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(D,"post-id"):_,w="";if(!P||D){var M=((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(a)?a[0]:a)||"";M='<a class="reply_to_mem" onclick="return wall.showReply(this, \''+m+"', '"+n+E+"_"+e+d+"', event);\">"+M+"</a>";var O='<span class="reply_to_cancel" onclick="return Wall.cancelReplyTo(\''+m+"', event);\"></span>",C='<div class="reply_to_label">'+langStr((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_reply_to"),"user",M)+"</div>";w=P?C+O:O+C}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to_title"+m,w);var g=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+m);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(a)&&a[1]&&window.Emoji){var T=g,R=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(Emoji.val(T)));!(R=R.replace(/&nbsp;/g," "))||i&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(i)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.winToUtf)(i[1]).indexOf((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.winToUtf)(R))?Emoji.val(T,a[1]):p&&(R=R.replace(p,a[1]),Emoji.val(T,R));var A=Wall.emojiOpts[_];A>=0&&Emoji.opts[A]&&Emoji.opts[A].onChange&&Emoji.opts[A].onChange(),Emoji.focus(T,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)("reply_to_title"+m,w),r){var L=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(r.parentNode)&&n<0&&b&&b.getAttribute("rid")===n;Wall.setReplyAsGroup(r,{from:L?n:vk.id})}var B=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_56__.getFixedReplyField)();return P&&g&&B&&(0,_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_41__.scrollOutsideFixedReplyArea)(g,B),l.onReplyFormSizeUpdate&&l.onReplyFormSizeUpdate(),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.stopEvent)(o),!1},cancelReplyTo:function(_,e){var t=window.cur.wallLayer==_?wkcur:window.cur,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),l=t.reply_to&&Wall.getReplyName(t.reply_to[0]),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(window.Emoji?Emoji.editableVal(o):"")),a=Wall.replyNamesRE(),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",r)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",r),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"deep_active");if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(l)&&l[1]&&window.Emoji){i&&l[1].indexOf(i)?a&&(i=i.replace(a,""),Emoji.val(o,i)):(i="",Emoji.val(o,i));var E=Wall.emojiOpts[_];E>=0&&Emoji.opts[E]&&Emoji.opts[E].onChange&&Emoji.opts[E].onChange(),Emoji.focus(o,!0)}if(hide("reply_to_title"+_),n){var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"answering-id");if(d){var c=_.split("_")[1];t.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(d),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(c)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_,c)}else t.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_,"")}else window.mvcur&&mvcur.post==_?mvcur.mvReplyTo=!1:t.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_,"");return t.onReplyFormSizeUpdate&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(t.onReplyFormSizeUpdate)&&t.onReplyFormSizeUpdate(o),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.stopEvent)(e),!1},replySubmitTooltip:function(_,e,t){var o=_&&window.cur.wallLayer==_?wkcur:window.cur,l=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+_)),i=l&&geByClass1("button_blue",l,"div"),a=o.replySubmitSettings;if(!(t&&i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(i)))if(t=t||i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"flat_button")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isButtonLocked)(t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"button_disabled"))!e&&a&&a.tt&&a.tt.hide&&a.tt.hide();else if(a||(a=o.replySubmitSettings=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{className:"reply_submit_hint_tt_point"})),e){if(t)if(a.parentNode==t&&a.tt&&a.tt.show)a.tt.show();else{a.tt&&a.tt.el&&a.tt.destroy(),t.insertBefore(a,t.firstChild);var r=Wall.customCur().wallTpl.reply_multiline?1:0,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(Wall.customCur().wallTpl.reply_multiline_hint,{enabled:r?"on":"",disabled:r?"":"on"}),n=l&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",l)),E=n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(n,"deep_active");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(a,{text:s,typeClass:"tt_default_right",slide:15,shift:E?[15,8]:[0,8],asrtl:1,hasover:1,toup:!1,showdt:700,hidedt:700,dir:"auto",noZIndex:!0,onCreate:function(){radioBtns.reply_submit={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_submit_hint_opts"))),val:s?1:0}}})}}else a&&a.tt&&a.tt.hide&&a.tt.hide()},onReplySubmitChanged:function(_,e){if(cur.wallTpl?cur.wallTpl.reply_multiline=_:mvcur.wallTpl&&(mvcur.wallTpl.reply_multiline=_),Wall.customCur().wallTpl&&(Wall.customCur().wallTpl.reply_multiline=_),e){var t=cur.replySubmitSettings;t&&t.tt&&t.tt.el&&t.tt.destroy()}else ajax.post("al_wall.php",{act:"a_save_ctrl_submit",value:_,hash:Wall.customCur().wallTpl.poll_hash}),window.Notifier&&Notifier.lcSend("wall_reply_multiline",{value:_})},getReplyFromId:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_as_group"+_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(e.parentNode))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_submit_post_box",e),"from-oid")},showCheckTimer(_,e,t){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_),i=l&&geByClass1("WallCheckComment__timer",l);if(o&&i){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(o,{text:t.description,showdt:0,hidedt:0,shift:[0,-1],width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(o)[0],forcetoup:!0,nohide:!0,noZIndex:browser.msie_edge,className:"WallCheckComment__tt"}),geByTag("span",i).forEach((_=>{_.style.animationDuration=`${t.delay}s`})),l.classList.add("WallCheckComment--shown");var a=setTimeout((()=>{l.classList.remove("WallCheckComment--shown"),Wall.sendReply(_,void 0,e)}),1e3*t.delay);i.timeout=a,i.onclick=()=>{Wall.hideCheckTimer(_,"button")},cur.destroy||(cur.destroy=[]),cur.destroy.push((()=>{a&&clearTimeout(a)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)(o)}},hideCheckTimer(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_),l=o&&geByClass1("WallCheckComment__timer",o);if(t&&l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"check_timestamp");e&&i&&Wall.isCheckTimerShown(_)&&ajax.post("al_wall.php",{act:"check_comment_cancelled",post_raw:_,timestamp:i,reason:e}),l.timeout&&clearTimeout(l.timeout),t.tt&&t.tt.hide&&t.tt.hide(),o.classList.remove("WallCheckComment--shown"),"button"===e&&setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)(t)),0)}},isCheckTimerShown(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_);return e&&e.classList.contains("WallCheckComment--shown")},sendReply:function(_,e,t){t=extend({},t);var o,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("reply_to"+_);if(l?(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",l),"post-id"),i=i||_.split("_")[1]):o=_,window.mvcur&&mvcur.post==o)return Videoview.sendComment(o,e,t);var a,r,s,n=window.cur.wallLayer==o,E=n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+o),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(E,"deep_active"),b=n?wkcur:window.cur,p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),u=p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(p,"composer"),P=b.reply_to&&Wall.getReplyName(b.reply_to[0]),D=p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(p,"send");if(D&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(D))return D(_,e,t);if(t.stickerId)r={message:"",attach1_type:"sticker",attach1:t.stickerId,sticker_referrer:t.sticker_referrer};else if(t.suggest)r={message:t.suggest};else{if((r=u?Composer.getSendParams(u,Wall.sendReply.pbind(_)):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)(Emoji.editableVal(p))}).delayed)return;if(!r.attach1_type&&(!r.message||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(P)&&P[1]&&!P[1].indexOf(r.message)))return void Emoji.editableFocus((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_),!1,!0)}var m=window.wkcur&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wk_content");if(p&&(m&&m.contains(p)?wkcur.wallCheckComments:b.wallCheckComments)){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_in_progress"))return;if(!(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_timestamp")||void 0))return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.stopEvent)(e),void ajax.post("al_wall.php",{act:"check_comment",post_raw:o,text:r.message},{onDone(e){e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_timestamp",e.timestamp),e.description&&e.delay)?Wall.showCheckTimer(_,t,e):Wall.sendReply(_,void 0,t)},onFail:()=>((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_timestamp",Date.now()),Wall.sendReply(_,void 0,t),!0),showProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_in_progress",!0)},hideProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_in_progress",null)}});if(Wall.isCheckTimerShown(_))return void Wall.hideCheckTimer(_,"button");Wall.hideCheckTimer(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(p,"check_timestamp",null)}t.stickerId||t.suggest||(u?a=Composer.reset(u):window.Emoji&&Emoji.val(p,""),p.autosize&&p.autosize.update()),b.wallMyOpened=b.wallMyOpened||{},b.wallMyReplied[o]=1,b.wallMyOpened[o]=1;var w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_hash"+o)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_hash"+o).value:b.options.post_hash,M=null,O=c&&(l||!n&&"full"!==b.wallType),C=wall.getRepliesOrder(o),g=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"top-ids"),T=!1;if(O&&d){var R=!l&&wall.isDescRepliesOrder(o,C)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(d):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domLC)(d);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(R,"replies_next")&&(O=!1,T=!0)}extend(r,{act:"post",type:b.wallType,reply_to:o,reply_to_msg:i,reply_to_user:b.reply_to&&b.reply_to[0]||0,start_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("start_reply"+o),from:n?"wkview":"",hash:w,only_new:O?1:0,need_last:T?1:0,order:C,top_replies:g||null,timestamp:s}),b.reverse&&(r.rev=1);var A,L=wall.getReplyFromId(_);if(L&&(r.from_oid=L),A=b.wallType?"feed"==b.wallType?"news"==b.section?"feed_"+(b.subsection?b.subsection:b.section):"recommended"==b.section?"feed_recommended"+("recent"!=b.subsection?"_"+b.subsection:""):-1!==["friends","groups","videos","photos","list"].indexOf(b.section)?"feed_"+b.section+(b.subsection?"_"+b.subsection:""):"feed_"+b.section:"top"==b.wallType?"wall_top":"wall_"+(b.onepost?"one":(b.wallType||"").indexOf("full_")?"page":"full"):b.module,extend(r,{ref:A}),browser.mobile?Wall.hideEditReply(_):(Emoji.editableFocus(p,!1,!0),Wall.cancelReplyTo(_,e)),hide("reply_warn"+_),ajax.post("al_wall.php",Wall.fixPostParams(r),{onDone:function(e,t,l,i){if(c){if(O)return wall.onOnlyNewReplySent.apply(window,arguments);if(T)return wall.onLastChunkReplySent.apply(window,arguments);if(n)return wall.onNewReplySentLayer.apply(window,arguments)}if("full"===b.wallType)return c?FullWall.onNewReplySent.apply(window,arguments):FullWall.onReplySent.apply(window,arguments);b.wallMyReplied[o]=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_link"+o),hide("reply_warn"+o),Wall._repliesLoaded(_,!1,t,l,i),Wall.processPostReplyActions(e)},onFail:function(_){if(M&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(M),u?a=Composer.restore(u,a):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(p,r.message),p.autosize&&p.autosize.update(),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_error"),_),!0},showProgress:function(){c?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+_),!0):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+_))},hideProgress:function(){c?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+_),!1):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_button"+_))}}),window.cur.onPostReply&&window.cur.onPostReply(_),!r.from_oid&&r.message&&!O){var B=-++b.wallMyRepliesCnt,W=Emoji.emojiToHTML((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)(r.message),!0),h=wall.getReplyNames(),I=r.reply_to_user<0?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_replied_to_group"):h[r.reply_to_user]&&h[r.reply_to_user][0],f=I?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(b.wallTpl.reply_link_to,{to_user:I}):"";if(M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(b.wallTpl.reply_fast,{reply_id:"0_"+B,message:W.replace(/\n/g,"<br/>"),to_link:f,date:Wall.getNowRelTime(b)})),d&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(d)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_link"+_))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_link"+_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("replies_wrap"+_);else if(!b.onepost){var v=d.nextSibling;if(v&&"replies_open"==v.className&&Wall.openNewComments(_),!n){var U=geByClass1("wr_header",d,"a"),K=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",d,"div").length+1,y=K;U&&(y=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(U.getAttribute("offs").split("/")[1])+1),(y>5||K<y)&&(U||d.insertBefore(U=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{className:"wr_header"}),d.firstChild),Wall.updateRepliesHeader(_,U,K,y))}}b.reverse?d.insertBefore(M,d.firstChild):d.appendChild(M),n&&(WkView.wallUpdateReplies(),b.reverse||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()))}},onOnlyNewReplySent:function(_,e,t){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,"reply"),i=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",o):o,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"post-id"),r=!l&&wall.isDescRepliesOrder(a);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"deep_active")){var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",o);l&&s&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"post-id"));var n=cur.wallLayer===a,E=Wall._getRepliesInfoBeforeAddNewReply(_,n),d=Wall._checkVisibilityBeforeAddNewReply(_,E,r,n);l&&wall.addDeepRepliesBlock(_);var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(e);r&&E.repliesListEl.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(c,E.repliesListEl.firstChild):E.repliesListEl.appendChild(c),Wall._fixScrollAfterAddNewReply(_,E,d,r,n),l&&wall.updateCollapseDeepReplies(_),(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(c),wall.incReplyCounter(i),wall.addReplyNames(t)}},onLastChunkReplySent:function(_,e,t,o,l,i){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+l),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(a,"reply"),s=r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",a):a,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"post-id"),E=!r&&wall.isDescRepliesOrder(n);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"deep_active")){var d=cur.wallLayer===n,c=Wall._getRepliesInfoBeforeAddNewReply(l,d),b=Wall._checkVisibilityBeforeAddNewReply(l,c,E,d);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(c.repliesListEl,e),Wall._fixScrollAfterAddNewReply(l,c,b,E,d);var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+i);(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(p),r&&wall.updateCollapseDeepReplies(l),wall.incReplyCounter(s,1,_),wall.addReplyNames(o)}},_getRepliesInfoBeforeAddNewReply:function(_,e){var t=e?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),o=window.innerHeight||document.documentElement.clientHeight,l=t+(e?0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_header_cont")[1]),i=t+o,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(a,e)[1],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(a)[1];return{repliesListEl:a,scrollY:t,topY:l,bottomY:i,viewportHeight:o,repliesListY:r,repliesListH:s,repliesListEndY:r+s,layerFieldH:e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("wl_reply_form")[1]:0}},_checkVisibilityBeforeAddNewReply:function(_,e,t,o){return t?o?e.repliesListY>0&&e.repliesListY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListY&&e.bottomY>e.repliesListY:o?e.repliesListEndY>0&&e.repliesListEndY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListEndY&&e.bottomY>e.repliesListEndY},_fixScrollAfterAddNewReply:function(_,e,t,o,l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(e.repliesListEl)[1];if(o)t||(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(e.repliesListY-100,300,!1,!0);else if(t){var a=e.scrollY+i-e.repliesListH;l?wkLayerWrap.scrollTop=a:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(a,0,!1,!0)}else{var r=e.repliesListY+i-300;l?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.animate)(wkLayerWrap,{scrollTop:e.scrollY+r},300):(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(r,300,!1,!0)}},incReplyCounter:function(_,e,t){e=e||1;var o,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"post-id"),i=geByClass1("comment",_);i&&(t||(o=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"count"),t=Math.max(0,o+e)),Likes.update("wall"+l,{comment_num:t}))},onNewReplySentLayer:function(_,e,t,o){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"),i=geByClass1("wl_replies",l);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(i,e);var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domChildren)(i).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"reply")})).length;extend(wkcur,{offset:t,loaded:a,count:_}),wall.addReplyNames(o),WkView.wallUpdateReplies();var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"post-id");wall.isDescRepliesOrder(r)?wkLayerWrap.scrollTop=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(l)[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("wl_replies_wrap")[1]-30:wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()},postTooltip:function(_,e,t,o){if(!cur.viewAsBox){var l=(t||{}).reply,i=(t||{}).className||"",a=l&&!(l%2)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(_)[0]>420;o=o||{},l||(o.appendEl=bodyNode),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(_,extend({url:"al_wall.php",params:extend({act:"post_tt",post:e},t||{}),slide:15,shift:[a?417:27,6,6],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",className:"rich wall_tt"+i,typeClass:a?"tt_default_right":"tt_default"},o))}},adsMarkTooltip:function(_){cur.viewAsBox||(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(_,{black:1,shift:[15,7,0],text:_.getAttribute("data-tooltip")})},hideEditPostReply:function(_,e){if(!1!==cur.editing&&(cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)("wl_post","deep_active")&&(e=!0),e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(boxLayerBG)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(layerBG))){var t=_&&_.target?_.target:{},o=t.id;cur.editing?cur.editingHide?cur.editingHide(cur.editing,t):_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_reply_wrap",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"reply_link")||o=="reply_field"+cur.editing||"reply_to_link"==t.className)||Wall.hideEditReply(cur.editing):(cur.wallAddMedia||{}).chosenMedia||_&&"post_field"==o||Wall.hideEditPost()}},postShowDeletedMessage:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);if(t){var o=geByClass1("_post_content",t)||geByClass1("feedback_row_t",t);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(o),hide(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(o),"post_publish")&&hide((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(o));var l="post_del"+_,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(l),a='<span class="dld_inner">'+e+"</span>";return i?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(i,a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(i)):t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{id:l,className:"dld",innerHTML:a})),!0}return!1},postHideDeletedMessage:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);if(e){var t=geByClass1("_post_content",e)||geByClass1("feedback_row_t",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(t),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(t));var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_del"+_);return hide(o),!0}return!1},isArchiveWall:function(){return cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module},rollbackPostsArchiveState:function(_,e,t){if(Wall.isArchiveWall()&&!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.linkLocked)(_)){var o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_rollback_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){cur.wallArchiveRolledback=!0,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockLink)(_)})}},restoreLastRollbackPostsArchiveState:function(_,e,t){if(Wall.isArchiveWall()&&!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.linkLocked)(_)){var o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_restore_last_rollback",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){delete cur.wallArchiveRolledback,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockLink)(_)})}},postSetArchiveState:function postSetArchiveState(actionEl,postRaw,hash,state,isRollback){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.actionsMenuItemLocked)(actionEl)&&!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.linkLocked)(actionEl)){var postId=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(postRaw.split("_")[1]),isActionMenuItem=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(actionEl,"ui_actions_menu_item"),localCur=cur.wallLayer?wkcur:cur;localCur&&(localCur.wallMyDeleted||(localCur.wallMyDeleted={}),localCur.wallMyDeleted[postRaw]=!Wall.isArchiveWall()==!state?0:1);var extended=!isRollback&&(Wall.isArchiveWall()?cur.wallArchiveRestored>=3&&!cur.wallArchiveRolledback:!cur.wallArchiveArchived);ajax.post("al_wall_archive.php",{act:"a_set_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_more_tab")?"profile":cur.pid?"post":"wall",hash,state:state?1:void 0,extended:extended?1:void 0,postId},{onDone:function onDone(msg,js){if(Wall.isArchiveWall()&&(state=!state,isRollback||(cur.wallArchiveRestored||(cur.wallArchiveRestored=0),cur.wallArchiveRestored++)),state&&(cur.wallArchiveArchived=!0),isRollback?Wall.postHideDeletedMessage(postRaw):Wall.postShowDeletedMessage(postRaw,msg)){"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(state?-1:1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(postEl,"reply")&&(state?--cur.pgOffset:++cur.pgOffset,state?--cur.pgCount:++cur.pgCount,FullWall.repliesSummary(cur.pgCount));var postEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+postRaw);"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(postEl,"own")&&(state?++cur.deletedCnts.own:--cur.deletedCnts.own),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(postEl,"all")&&(state?++cur.deletedCnts.all:--cur.deletedCnts.all),Wall.isArchiveWall()&&(state?--cur.deletedCnts.archive:++cur.deletedCnts.archive),Wall.update())}if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.logEvalError)(_,js)}},showProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockLink)(actionEl),hideProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockLink)(actionEl)})}},deletePost:function(_,e,t,o,l){(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=1;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e),a=geByClass1("post_actions",i),r={act:"delete",post:e,hash:t,root:o?1:0,confirm:l?1:0,from:"wall"};cur.suggestedDeletedCount&&cur.suggestedDeletedCount>=2&&(r.delete_all=1),(0,_internal_nospam_common__WEBPACK_IMPORTED_MODULE_43__.isClaimContent)()&&(r._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_wall.php",r,{onDone:function(l,a,r){if(r)var s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(l,r,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_delete"),(function(){s.hide(),wall.deletePost(_,e,t,o,1)}),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("box_cancel"));else{Wall.postShowDeletedMessage(e,l),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount));var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_publish_wrap"+e);n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"suggest")&&(void 0===cur.suggestedDeletedCount&&(cur.suggestedDeletedCount=0),cur.suggestedDeletedCount++),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"suggest")?Wall.suggestUpdate(-1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"postponed")?wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"own")&&++cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"all")&&++cur.deletedCnts.all,Wall.isArchiveWall()&&++cur.deletedCnts.archive,Wall.update())}},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"flat_button")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(a,"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"flat_button")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(a,"post_actions_progress")}});var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("delete_post"+e);s&&s.tt&&s.tt.el&&s.tt.destroy()},markAsSpam:function(_,e,t,o,l){if(this.isAdPostMarkingAsSpam(e))this.markAdAsSpam(t,e,o,l);else{var i=_slicedToArray(e.split("_"),2),a=i[0],r=i[1];(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_51__.showReportForm)(_,a,r,(()=>{var _=document.querySelector(`#post${a}_${r}`);null!==_?_.innerHTML=`<div class="dld">${(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_report_sent")}</div>`:debugLog("unable to find wall item")}))}},isAdPostMarkingAsSpam:function(_){var e="block_market-items"===_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);return!!e&&null!==e.getAttribute("data-ad")},markAdAsSpam:function markAdAsSpam(el,post,hash,inline){var adDataPost="block_market-items"===post?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(post):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+post),adData=adDataPost.getAttribute("data-ad");ajax.post("al_wall.php",{act:"spam",post,ad_data:adData,hash,from:inline?"inline":""},{onDone:function onDone(msg,js,js2){if("string"!=typeof js&&js2&&(js=js2),inline)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(el).replaceChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:msg}),el);else{var postSelector=`#post${post}`,r=el.closest(postSelector)||document.querySelector(postSelector),t=geByClass1("_post_content",r)||geByClass1("feedback_row_t",r);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(r);var pd=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_del"+post);if(pd?(pd.innerHTML=msg,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(pd)):r.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{id:"post_del"+post,innerHTML:msg})),hide(t),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.logEvalError)(_,js)}adData&&Wall._setAdReportHandler(post,adData,hash)}},showProgress:function(){el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(el,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem)(el):inline&&(hide(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(el)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(el).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span",{className:"progress_inline"}))))},hideProgress:function(){el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(el,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem)(el):inline&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(el)))},stat:[jsc("web/privacy.js"),"privacy.css"]});var btn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("delete_post"+post);btn&&btn.tt&&btn.tt.el&&btn.tt.destroy()},_setAdReportHandler(_,e,t){var o="ad_report_"+_,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(o+"_send");if(l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("radiobtn",o),a=geByClass1("radiobtn on",o);window.radioBtns[o]={val:a.dataset.value||1,els:i};var r=()=>{var i=_slicedToArray(_.split("_"),2),a=i[0],s=i[1],n=window.radioBtns[o].val;ajax.post("reports.php",{act:"report_ad_common",type:"ad",oid:a,item_id:s,hash:t,reason:n,ad_data:e},{onDone:()=>{delete window.radioBtns[o],l.removeEventListener("click",r),window.closeChosenReportReasonBlock(a,s),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("reports_warning_sent"))},onFail:_=>((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(_),!1),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(l),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(l)})};l.addEventListener("click",r)}},showIgnoreItemReasons:function(_,e,t,o,l,i,a){var r="block_market-items"===e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e);if(r){var s=r.getAttribute("data-ad");(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(r),ajax.post("/al_wall.php?misc",{act:"get_ignore_reasons",post_raw:e,feed_raw:t,caption_type:l,uids:i,hash:o,ad_data:s,mode:a},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(r,_);var s="ad_hide_"+e,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(s+"_send");if(n){var E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("radiobtn",s),d=geByClass1("radiobtn on",s);window.radioBtns[s]={val:d.dataset.value||1,els:E},n.addEventListener("click",(()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(n);var _=window.radioBtns[s].val;("feed"===a?window.feed.ignoreItem:wall.ignoreAdsItem)(e,t,o,l,i,_).then((()=>{delete window.radioBtns[s]})).catch((()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(n)))}))}},showProgress:function(){_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"ui_actions_menu_item")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem)(_)},hideProgress:function(){_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"ui_actions_menu_item")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem)(_)}})}},ignoreAdsItem:function(_,e,t,o,l){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_),r=a.getAttribute("data-ad"),s=geByClass1("ui_actions_menu_wrap",a);if(a)return s&&uiActionsMenu.toggle(s,!1),(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(a),new Promise(((o,l)=>{ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:_,feed_raw:e,hash:t,ad_data:r,no_html:1,reason_id:i},{onDone:function(){hide(a),o()},onFail:l})}))},ignoreAdsOwner:function(_,e,t,o){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);l&&ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:_,owner_id:e,hash:t,list:0,no_html:1},{onDone:function(_){hide(l)},showProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind(o),hideProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind(o)})},markAsAds:function(_,e,t,o){ajax.post("al_wall.php",{act:"mark_as_ads",post:_,hash:e,full:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(o)},{onDone:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("ui_actions_menu_item_mark_as_ads"+_).innerHTML=e}})},restorePost:function(_,e,t){return(cur.wallLayer?wkcur:cur).wallMyDeleted[_]=0,ajax.post("al_wall.php",{act:"restore",post:_,hash:e,root:t?1:0},{onDone:function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("post_del_btn"+_),Wall.postHideDeletedMessage(_)){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"suggest")?Wall.suggestUpdate(1):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"postponed")?wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"own")&&--cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"all")&&--cur.deletedCnts.all,Wall.isArchiveWall()&&--cur.deletedCnts.archive,Wall.update())}}}),!1},blockPostApp:function(_,e,t,o){ajax.post("al_wall.php",{act:"block_post_app",aid:_,from:e,hash:t},{onDone:function(_){o.parentNode.parentNode.innerHTML=_},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind(o)})},checkPostClick:function(_,e,t){if(e=e||window.event,!_||!e)return!0;var o=e.target||e.srcElement,l=8,i=!1,a=/wall_post_text|published_comment|post_media|page_event_share|page_public_share|page_group_share|feed_friends|feed_videos|feed_explain_list|explain|feed_photos|feedback_row/;do{if(!o||o==_||o.onclick||o.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(o.tagName,["A","IMG","TEXTAREA","EMBED","OBJECT"])||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(o.className,["play_new","video_box_wrap"])||(i=o.className.match&&o.className.match(a)))break}while(l--&&(o=o.parentNode));if(!i)return!1;if(cur.postClicked||(cur.postClicked={}),!t||!cur.postClicked[_]){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return!1;t&&(cur.postClicked[_]=!0,setTimeout((function(){cur.postClicked[_]=!1}),2e3))}return o||!0},postClick:function(_,e,t){t=t||{};var o,l=(_||"").match(/^(-?\d+)_(wall)?(\d+)$/),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);if(o=!!t.skipCheck||Wall.checkPostClick(i,e)){if(!0!==o){var a=geByClass1("wall_post_more",o,"a");if(a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(a))return a.onclick(),void(l||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(i,"wall_post_over"))}if(l&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(i,"suggest")&&!cur.onepost){var r=i&&i.getAttribute("data-ad"),s=i&&i.getAttribute("data-ad-block-uid"),n="/wall"+l[1]+"_"+l[3];if(browser.mobile&&e){var E={};r&&s&&(E.params={_post_ad_data:r,_post_ad_block_unique_id:s}),nav.go(n,null,E)}else(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.checkEvent)(e)?window.open(n,"_blank"):(r&&s&&(t.ads_params={post_ad_data:r,ad_block_unique_id:s}),Wall.hideEditPostReply(),Wall.postFull("wall"+l[1]+"_"+l[3],!1,t))}}},postClickStat:function(_){var e=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.normEvent)(_)).currentTarget,t=[];e.getAttribute("data-ad-view")&&(t.push(Wall.postsGetRaws(e)),Page.postsSeen(t));var o=_.target;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(o.getAttribute("data-post-click-type"),["post_owner_img","post_owner_link"])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,"author")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,"post_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,"post_img")?Wall.triggerAdStat(e,"click_post_owner"):("A"==_.target.nodeName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wall_post_text",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("page_media_thumbed_link",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_.target,"lnk")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("lnk",_.target,e))&&Wall.triggerAdStat(e,"click_post_link")},adBlockClickStat:function(_,e){var t="_ads_block_data_w",o=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.normEvent)(_)).currentTarget;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,t)||(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)(t,o));var l=[];o.getAttribute("data-ad-view")&&(l.push(Wall.postsGetRaws(o)),Page.postsSeen(l)),Wall.triggerAdStat(o,e)},getAdsEvents:function(){var _=Wall._lsAdsEvents;return _||(_=Wall._lsAdsEvents=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.get(Wall.LS_ADS_EVENTS)||{}),_},cleanAdsEvents:function(){var _=Wall.getAdsEvents(),e=(new Date).getTime()/1e3|0,t=!1;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(_,(function(o,l){e-l>=3600&&(delete _[o],t=!0)})),t&&_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.set(Wall.LS_ADS_EVENTS,_)},triggerAdPostStat:function(_,e){Wall.triggerAdStat(_,e)},triggerAdStat:function triggerAdStat(elIdOrEl,event){for(var el="string"==typeof elIdOrEl?Wall.domPost(elIdOrEl):elIdOrEl,pixels=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-stat-"+event);pixels;){var adBlockUID=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-block-uid"),isUniqueEvent=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(event,["load","impression","impression_long","video_start","video_play_3s","video_play_10s","video_play_25","video_play_50","video_play_75","video_play_95","video_play_100"]);if(isUniqueEvent&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-disabled-stat-"+event,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-stat-"+event)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-stat-"+event,null)),adBlockUID&&isUniqueEvent)try{var eventKey=(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_32__.hashCode)(""+event+adBlockUID),lsData=Wall.getAdsEvents();if(lsData[eventKey])break;var now=(new Date).getTime()/1e3|0;lsData[eventKey]=now,_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.default.set(Wall.LS_ADS_EVENTS,lsData)}catch(_){try{console.log(_.message)}catch(_){}}pixels=pixels.split("$$$"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(pixels,(function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.vkImage)().src=e}));break}var statHtml=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-stat-html-"+event);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(el,"ad-stat-html-"+event,null),statHtml)for(var statElemWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:statHtml}),elem;elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.logEvalError)(_,elem.innerHTML)}},copyHistory:function(_,e,t,o){var l=(_=_||window.event).target||_.srcElement,i=8,a=!1,r=/published_a_quote/;do{if(!l||(a=l.className.match(r))||l.onclick||l.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(l.tagName,["A","IMG"]))break}while(i--&&(l=l.parentNode));if(a&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return ajax.post("al_wall.php",{act:"copy_history",post:t,offset:o,from:cur.module},{onDone:function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(e)&&(hide(e),_)){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(e),"published_by_quote")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(e):e;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(t).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isAncestor)(t,"im_rows")?IM.updateScroll(!0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isAncestor)(t,"wl_post")&&WkView.wallUpdateReplies()}}}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(_)},postFull:function(_,e,t){if(_.match(/^wall-?\d+_\d+$/)&&!(t||{}).nolist&&(!cur.pgParams||!cur.pgParams.owners_only&&!cur.pgParams.q))switch(cur.wallType){case"all":case"full_all":_+="/all"}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.showWiki)({w:_},!1,e,t)},checkReplyClick:function(_,e){if(e=e||window.event,!_||!e)return!1;var t=e.target||e.srcElement,o=8,l=!1;do{if(!t||t==_||t.onclick||t.onmousedown||"A"==t.tagName&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"_reply_lnk")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(t.tagName,["IMG","TEXTAREA","EMBED","OBJECT"])&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"emoji")||"wpe_cont"==t.id||(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"_reply_content")))break}while(o--&&(t=t.parentNode));return!l||!!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())},replyClick:function(_,e,t,o){var l=_.split("_"),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(l[0]),a=l[1].replace(/-?\d+$/,""),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+i+a+"_"+e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);if(!((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"closed_comments")||!cur.stickerClicked&&Wall.checkReplyClick(r,t))){(t||{}).cancelBubble=!0;var n=geByClass1("wall_reply_more",r,"a");if(n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(n))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(r,"reply_moreable"),void n.onclick();if(o){s=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"):s;var E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"deep_active"),d=cur.stickerClicked||!1,c=_;if(E){var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",r);c=b?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(b,"post-id"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"post-id")}var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+c);cur.stickerClicked=!1,!d||p&&p.emojiInited||(cur.afterEmojiInit=cur.afterEmojiInit||{},cur.afterEmojiInit[c]=function(){Emoji.clickSticker(d,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+c))}),Wall.replyTo(c,e,o,t),d&&p&&p.emojiInited&&Emoji.clickSticker(d,p)}}},stickerClick:function(_,e,t){if((t||{}).cancelBubble=!0,window.Emoji)if(e){var o=Emoji.isStickerPackEnabled(_,Wall.stickerClick.pbind(_,e));if(0!==o)if(o){var l=e.parentNode,i=8;do{if(!l||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"reply"))break}while(i--&&(l=l.parentNode));l&&l.onclick&&(cur.stickerClicked=_,l.onclick())}else Emoji.clickSticker(_,!1)}else Emoji.clickSticker(_,!1);else stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Wall.stickerClick(_,e)}))},domPost:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_)},formatCount:function(_,e){return e=e||{},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.formatCount)(_,e)},likeFullUpdate:function(_,e,t){var o=e.match(/^(wall|photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(-?\d+_)(\d+)/);Likes.update(o?(o[1]||"wall")+o[2]+o[3]:e,t)},likeUpdate:function(_,e,t,o,l,i,a){a||(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(o)),!1===_&&cur.wallLayer===e&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post_body"));var r=e.match(/(-?\d+)(_?)(photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),s=r[1]+"_"+r[4],n=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",_))||wall.domPost(s),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(n,a?"_views_wrap":i?"_share_wrap":"_like_wrap"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(E,"_count");if(d){if(!a&&!i){var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(n,"_views_wrap"),b=c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(c,"_count");!b||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(c,"_auto_update")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(b)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(b)!=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(d)||wall.likeUpdate(_,e,0,this.formatCount(o),void 0,void 0,1)}var p=E.tt||{},u=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)(p.opts||{}),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(p.container,"_value"),D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(p.container,"_content"),m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(p.container,"_title");l&&m&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(m,l),p&&(p.likeInvalidated=!0),P&&(P.value=o),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.animateCount)(d,a?o:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langNumeric)(o,"%s",!0),{str:"auto",noWrapWidth:!!a}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(E,i?"my_share":"my_like",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(E,a?"no_views":i?"no_shares":"no_likes",!o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(D,"me_hidden",!t&&!a),o?p.el&&(!1===l?p.destroy&&p.destroy():(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(p.container)||l||!1===l||tooltips.show(p.el,extend(u,{showdt:0}))):p.el&&p.hide();var w=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langNumeric)(o,"%s",!0);if(a){var M=geByClass1("feedback_views",n),O=0;O=o.match(/^\d+$/)?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(o):5,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(M,"<em>"+o+"</em> "+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_X_post_views",O,!0))}else if(i){var C="";o>0&&(C="<em>"+w+"</em> "+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_X_shared",o,!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(geByClass1("feedback_share",n),C)}else{var g="";o>0&&(g="<em>"+w+"</em> "+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_like")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(geByClass1("feedback_like",n),g)}Wall.updateFeedbackVisibility(n)}},updateFeedbackVisibility:function(_){var e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(geByClass1("feedback_views",_))),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(geByClass1("feedback_share",_))),o=!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(geByClass1("feedback_like",_)))&&!t&&!e;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(geByClass1("post_feedback_info",_),"empty",o)},likeShareUpdate:function(_,e,t,o,l){return Wall.likeUpdate(_,e,t,o,l,!0)},like:function(_,e){if(vk.id&&!cur.viewAsBox){var t=wall.domPost(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(t,"_like_wrap"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(o,"_icon"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(o,"_count"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(l,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(o,"my_like"),r=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),s=(r[3]||"wall")+r[1]+"_"+r[4],n=cur.module;cur.wallType&&(n="feed"==cur.wallType?"feed_"+("news"==cur.section&&cur.subsection?cur.subsection:cur.section):"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full")),ajax.post("like.php",{act:"a_do_"+(a?"un":"")+"like",object:s,hash:e,wall:2,from:n},{onDone:Wall.likeFullUpdate.pbind(!1,_)});var E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(i);Wall.likeUpdate(!1,_,!a,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(E)+(a?-1:1)),cur.onWallLike&&cur.onWallLike()}},bookmark:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"bookmarked")},likeShare:function(_,e){if(vk.id&&!cur.viewAsBox){var t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4],l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("like_share_"+o),i=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(l),a=cur.wallType?"feed"==cur.wallType?"feed_"+cur.section:"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module;"top"==cur.wallType&&(a="wall_top"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)(l),ajax.post("like.php",{act:"a_do_"+(i?"un":"")+"publish",object:o,hash:e,wall:2,ref:a},{onDone:Wall.likeFullUpdate.pbind(!1,_)});var r=wall.domPost(_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(r,"_like_wrap"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(s,"_icon"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(r,"_count")),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(n,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(n,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(s,"my_like");Wall.likeUpdate(!1,_,!0,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(E)+(d?0:1))}},likeShareCustom:function(_,e){var t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4];(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showBox)("like.php",extend({act:"publish_box",object:o},e))},likeShareCheckLen:function(_,e,t){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(e),t=t||255;var o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen!==o.length){var l=_.lastLen=o.length,i=l-o.replace(/\n/g,"").length;l>t-50||i>4?(l>t?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("text_exceeds_symbol_limit",l-t)):i>4?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_recommended_lines",i-4)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("text_N_symbols_remain",t-l)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(e)):hide(e)}},showLikesPage:function(_,e,t){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:_,published:e,offset:t,wall:1},e)},clearLikesCache:function(_,e){var t="^/like.php#"+(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_27__.toQueryString)({act:"a_get_members",object:_,published:e,offset:12345,wall:1,tab:e,only_content:1}).replace("12345","\\d+")+"$",o=new RegExp(t,"i");for(var l in ajaxCache)o.test(l)&&delete ajaxCache[l]},subscribeByButton:function(_,e,t,o,l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"_subscribed"),a={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton.pbind(_),onDone:function(){i=!i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(_,"_subscribed",i)}},r={};e>0&&l&&(r.from=l),Wall.subscribeToAuthor(i,e,t,o,a,r)},subscribeByAction:function(_,e,t,o){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.actionsMenuItemLocked)(_)){var l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"value"))?1:0,i={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem.pbind(_)},a={};e>0&&o?a.from=o:e<0&&(i=extend(i,{onDone:function(o,a,r){if(a){var s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_warning"),a,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("group_leave_group"),(function(){s.hide(),Wall.subscribeToAuthor(l,e,t,i,"",{confirm:1})}),(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_cancel"));return!0}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_,o),_.setAttribute("data-value",1-l),r&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_))}})),Wall.subscribeToAuthor(l,e,t,"",i,a)}},subscribeToAuthor:function(_,e,t,o,l,i){l=extend({onFail:function(_){setTimeout((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)((0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_error"),_).hide,3e3)}},l),i=i||{},e>0?ajax.post("al_friends.php",extend({act:_?"remove":"add",mid:e,hash:t,from:"feed"},i),l):ajax.post("al_groups.php",extend({act:_?"list_leave":"list_enter",gid:-e,hash:t},i),l),o&&ajax.post("al_feed.php?act=viral_subscribe_stat",{author_id:e,subscribe:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(!_),hash:o})},showPhoto:function(_,e,t,o,l){return!(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showBox)("al_photos.php",{act:"photo_box",to_id:_,photo:e,hash:t},{cache:1},!!o.href&&l)},_animDelX:function(_,e,t,o){},domFC:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(_);return _},domPS:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPS)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPS)(_);return _},scrollCheck:function(_,e,t){var o,l,i=null==e?(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)():e,a=0,r=[],s=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight;if(window.scrollAnimation)return!1;if((Wall.repliesSideUpdate(i),cur.wallPage)&&(l="suggested"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_suggested_posts"):"top"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_top_posts"):"donut"===cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_donut_posts"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts"),((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(cur.topRow)!=l||((cur.topRow||{}).id||"").match(/page_wall_count_/))&&(cur.topRow=Wall.domFC(l)),vk.id&&cur.topRow&&!cur.topRow.id.match(/page_wall_count_/)&&!((window.curNotifier||{}).idle_manager||{}).is_idle)){for(var n=[],E=Wall.domPS(cur.topRow);E;E=Wall.domPS(E))cur.topRow.offsetTop>i&&(cur.topRow=E),E.unseen||(E.unseen=!0,n.push(Wall.postsGetRaws(E)));Page.postsUnseen(n);for(var d=cur.topRow;d;d=o){LongView&&LongView.register(d,"Wall");var c=a||d.offsetTop;if(c>=i+s)break;(((o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(d))||{}).id||"").match(/page_wall_count_/)&&(o=null),(a=o?o.offsetTop:c+d.offsetHeight)<i&&o&&(cur.topRow=o);var b=d.bits||0;b>=3||(b|=(c>=i&&c<i+s?1:0)|(a>=i&&a<i+s?2:0))&&(d.bits=b,3==b&&r.push(Wall.postsGetRaws(d)))}LongView&&LongView.onScroll(i,s),Page.postsSeen(r)}if(cur.wallAutoMore&&!cur.wallLoading&&!cur.viewAsBox){var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_more_link");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(p)&&i+lastWindowHeight+1500>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(p)[1]&&p.onclick()}},postsGetRaws:function(_){var e,t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.indexOf)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_).children,_),o={};if(!_)return o;o.module=cur.module,o.index=t;var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"_ads_promoted_post"),i=_.getAttribute("data-ad-view");i&&(o["ad_"+i]=1,l&&(o.module+="_ads_promoted_post"));var a=_.getAttribute("post_view_hash");if(a&&(o.hash=a),"block_"===_.id.substr(0,6)){o[_.id]=1,o.block=_.id.substr(6);var r=attr(_,"data-contain");r&&(r=r.split(",")).forEach((function(_){_=_.split(":"),o[_[0]]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_[1])||1}))}else(e=_.id.match(/^post(-?\d+_\d+)$/))&&(o[e[1]]=1,(e=(_.getAttribute("data-copy")||"").match(/^(-?\d+_\d+)$/))&&(o[e[1]]=-1));return o},votingExtendParams:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"fixed")&&(_.is_fixed=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"preview")&&(_.is_preview=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"board")&&(_.is_board=1),vk.widget&&(_.is_widget=1,_.width=cur.widgetWidth,_.url=cur.url),cur.voteHash&&(_.vote_hash=cur.voteHash);var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"id");t&&(_.voting_id=t);var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"ref");o&&(_.ref=o);var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"hash");l&&(_.hash=l);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"material");return!i||_.is_board||_.is_widget||(_.material=i),_},votingRevote:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"id");if(this.votingIsLocked(t))return;var o=this.votingExtendParams({act:"revote"},e);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,t),showProgress:this.votingLock.bind(this,t),hideProgress:this.votingUnlock.bind(this,t)})}},votingIsLocked:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_media_voting"+_),t=!1;return e.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"media_voting_locked")&&(t=!0)})),t},votingLock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"disabled")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"queue")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"media_voting_locked")}))},votingUnlock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(_,"media_voting_locked")}))},votingUpdate:function(_,e){ajax.post("al_voting.php",{act:"get_layout",voting_id:_},{onDone:t=>{(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(e)&&!1===e(t)||(this.votingUpdateFull(_,t),this.votingUnlock(_))},onFail:()=>this.votingUnlock(_),showProgress:()=>this.votingLock(_)})},votingUpdateFull:function(_,e){if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isString)(e)){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_media_voting"+_);t.length&&(t.forEach((_=>{if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"disabled")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"queue"))if(""===e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_);else{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"media_voting_can_vote")){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(o,"media_voting_just_voted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domReplaceEl)(_,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClassDelayed)(o,"media_voting_just_voted")}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domReplaceEl)(_,t)}})),window.IMBRIDGE&&setTimeout(IMBRIDGE.syncHistory.bind(IMBRIDGE),0),vk.widget&&window.WPoll&&window.WPoll.resizeWidget())}},votingUpdatePartly:function(_,e){if(_&&isObject(e)&&!this.votingIsLocked(_)){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_media_voting"+_);if(t.length){var o=e.answers.reduce(((_,e)=>Math.max(_,e.rate)),0),l={};e.answers.forEach((_=>{_.isLeader=_.rate===o,l[_.id]=_})),t.some((t=>{if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"disabled")){if(t.classList.contains("media_voting_voted")&&!e.votes)return this.votingUpdate(_),!0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("media_voting_option_wrap",t).forEach((_=>{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"id"),o=l[t];if(_.tt&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(_.tt.destroy)&&_.tt.destroy(),o){var i=geByClass1("media_voting_option_bar",_),a=geByClass1("media_voting_option_percent",_),r=geByClass1("media_voting_option_count",_),s=geByClass1("media_voting_option_counter",_),n=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langNumeric)(o.votes,"%s",!0),E=new Array((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(n).textContent.split("").length+2).join("0");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domLC)(r),E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domLC)(s),n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(a,e.votes?o.rate:""),i.style.transform=`scaleX(${.01*o.rate})`,i.style.oTransform=`scaleX(${.01*o.rate})`,o.votes?r.classList.remove("media_voting_option_count_hidden"):(r.classList.add("media_voting_option_count_hidden"),_.classList.remove("media_voting_option_voted")),o.isLeader?_.classList.add("media_voting_option_leader"):_.classList.remove("media_voting_option_leader")}}));var o=geByClass1("_media_voting_footer_voted_text",t);if(o){var i;i=e.votes?vk.widget?"voting_x_voted_short":"voting_x_voted":"voting_nobody_voted",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(o,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)(i,e.votes,!0));var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("media_voting_footer_voted_friend",t);a.length>e.votes&&a.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(_)}))}}})),window.IMBRIDGE&&window.IMBRIDGE.syncHistory(),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()}}},votingUpdateByPostRaw:function(_){if(vk.id){_=_.split("_");var e=positive(_[1]),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_[0]),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_post_media_voting"+t+"_"+e);if(o&&o.length){var l=geByClass1("media_voting",o[0]);if(l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"id");this.votingUpdate(i)}}}},votingVote:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"id");if(!this.votingIsLocked(t)&&vk.id){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"queue"))return this.votingUpdate(t,(_=>{if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isString)(_)){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(_));if(t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"queue")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"disabled"))return this.votingVote(t,e,!0),!1}}));if(e.length){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_),"wk_voting_box"),l=this.votingExtendParams({act:"vote",option_ids:e.join(",")},_);ajax.post("al_voting.php",l,{onDone:(_,e)=>{o?nav.reload():(vk.widget&&window.WPoll&&window.WPoll.updateShareMessage(e),this.votingUpdateFull(t,_))},showProgress:this.votingLock.bind(this,t),hideProgress:()=>{o||this.votingUnlock(t)}})}}else vk.widget&&Widgets.oauth()},votingButtonVote:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"media_voting_multiple")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("media_voting_option_selected",e),o=[];t.forEach((function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"id");e&&o.push(e)})),this.votingVote(e,o)}},votingOptionVote:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"media_voting_multiple")){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"id");if(this.votingIsLocked(o)||!vk.id)return void(vk.widget&&Widgets.oauth());(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(_,"media_voting_option_selected");var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("media_voting_option_selected",t).length;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(t,"media_voting_has_selected_options",l)}else{var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"id");this.votingVote(t,[i])}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)}},votingOptionVoteAttempt:function(_,e,t,o){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"ref");(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.statlogsValueEvent)("voting_vote_attempt",i,t,o)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)},votingOptionTooltip:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"owner-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"board");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(_,{url:"al_voting.php",params:{act:"option_tt",option_id:t,owner_id:o,is_board:i,voting_id:l},slide:15,ajaxdt:100,showdt:400,hidedt:200,dir:"auto",shift:[0,10,10],typeClass:"voting_tt"})}},votingLayer:function(_,e){var t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"media_voting_option_wrap")&&_,o=t?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"id"):0,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"media_voting")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"id"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"owner-id"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"board"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"ref"),n={w:(r?"board_poll":"poll")+a+"_"+i};if(o&&(n.opt_id=o),vk.widget)window.open(location.origin+"/"+n.w,"poll");else{var E={queue:1,noloader:!!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)()};"story"===s&&(E.customRef="story"),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.showWiki)(n,!1,void 0,E)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(e)}},votingExport:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"board")){var t=this.votingExtendParams({act:"export_box"},e);(vk.widget?window.showBox:_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showBox)("al_voting.php",t,{onDone:function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.curBox)().setOptions({width:500})}})}},votingOnMain:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(t){if(this.votingIsLocked(o))return;var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"id"),l=this.votingExtendParams({act:"onmain",state:e?1:0},t);ajax.post("al_voting.php",l,{onDone:this.votingUpdateFull.bind(this,o),showProgress:this.votingLock.bind(this,o),hideProgress:this.votingUnlock.bind(this,o)})}},votingClosed:function(_,e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);if(t){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"id");if(this.votingIsLocked(o))return;var l=this.votingExtendParams({act:"closed",state:e?1:0},t);ajax.post("al_voting.php",l,{onDone:this.votingUpdateFull.bind(this,o),showProgress:this.votingLock.bind(this,o),hideProgress:this.votingUnlock.bind(this,o)})}},votingNarrowAction:function votingNarrowAction(votingId,hash,action){var act,state;switch(action){case 101:act="closed",state=0;break;case 102:act="closed",state=1;break;case 103:act="onmain",state=0;break;case 104:act="onmain",state=1}act&&!cur.votingNarrowActionProgress&&ajax.post("al_voting.php",{act,voting_id:votingId,is_fixed:1,state,narrow:1,hash},{onDone:function onDone(html,js){var votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("group_voting");if(votingModuleEl&&(votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(votingModuleEl),html?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domReplaceEl)(votingModuleEl,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cf)(html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(votingModuleEl)),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.logEvalError)(_,js)}},showProgress:function(){cur.votingNarrowActionProgress=!0},hideProgress:function(){cur.votingNarrowActionProgress=!1}})},showReportVotingForm:function(_){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.actionsMenuItemLocked)(_)){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("media_voting",_);null===e&&debugLog("Unable to show report voting form because there is no .media_voting element");var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"id");if(!this.votingIsLocked(t)){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"board")?"board_poll":"poll";(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_51__.showReportForm)(o,0,t,(()=>{var _=e.querySelector("._report_voting_button");null!=_?(_.innerHTML=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_report_sent"),_.onclick=null):debugLog("Unable to disable report voting button, because it cannot be found")}))}}},foTT:function(_,e,t){t&&t.oid&&(e=t.oid==vk.id?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_my_friends_only"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("wpfo"+t.pid)),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTitle)(_,e)},update:function(){if(cur.wallLayer)WkView.wallUpdateReplies();else{var _="top"===cur.wallType,e="archive"===cur.wallType,t="donut"===cur.wallType;if(("all"===cur.wallType||"own"===cur.wallType||_||e||t)&&("all"===cur.wallTab||"own"===cur.wallTab||"top"===cur.wallTab||"archive"===cur.wallTab||"donut"===cur.wallTab)){var o=e?"all":_||t?"own":cur.wallType,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_more_link"),i=Wall.getPostsWrap(cur.wallType),a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(cur.deletedCnts[o]),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)(o,i).length-a,s=!1;if((_||e||t)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(geByClass1("no_posts",i))||_&&cur.wallTopFinished===cur.oid||e&&cur.wallArchiveFinished===cur.oid||t&&(cur.wallDonutFinished===cur.oid||Wall.cantAccessDonutPosts())))s=!0;else{var n;if(n=e?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_archive")):_?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_top")):t?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_donut")):"own"===o?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own")):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all")),"suggested"!==cur.wallTab){var E=n;cur.oid<0&&cur.options.fixed_post_id&&(E-=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_posts_count",E?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langNumeric)(E,cur.options.wall_counts):cur.options.wall_no)}var d=r;!_&&!e&&cur.options.fixed_post_id&&cur.options.wall_oid<0&&(d+=1),s=d>=n-a}s?hide(l):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(l),l.onclick=Wall.showMore.pbind(r)),cur.wallTab==cur.wallType&&(shortCurrency(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler())}}},getAbsDate:function(_,e){e=e||window.cur;var t,o=new Date(_||Date.now()),l=o.getHours(),i=o.getMinutes(),a="";return e.wallTpl.time_system&&(a=e.wallTpl.time_system[l>11?1:0],l=l%12||12),t=l>9?l:"0"+l,i=i>9?i:"0"+i,e.wallTpl.date_format.replace("{am_pm}",a).replace("{hour}",l).replace("{num_hour}",t).replace("{minute}",i)},getNowRelTime:function(_){_=_||window.cur;var e=Date.now();return'<span class="rel_date rel_date_needs_update" time="'+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e/1e3-(_.tsDiff||0))+'" abs_time="'+Wall.getAbsDate(e,_)+'">'+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_just_now")+"</span>"},getNewPostHTML:function(_,e,t,o){var l,i=(o=o||window.cur).wallTpl.post;if(i){var a,r=[],s=_[2],n=s.split("_")[0],E="",d=_[4].split("|"),c=Wall.getNowRelTime(o),b="1"===_[8];b?E=o.wallTpl.reply_link||"":n!=vk.id&&(E=o.wallTpl.own_reply_link||"");var p=_[3].replace("mem_link","author").replace("memLink","author"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(p),P=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.unclean)(u.innerText||u.textContent||""));-1!=_[6].indexOf('id="wpfo')&&(c+=`<span class="page_friends_only inl_bl dvd">${(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_post_privacy_friends")}</span>`),o.wallTpl.custom_del&&(e>(_[9]==n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)||n==vk.id||_[9]==vk.id||_[2].split("_")[0]!=_[4])&&r.push(o.wallTpl.custom_del),e>(_[9]==n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)||n==vk.id||_[9]==vk.id?r.push(o.wallTpl.del):_[2].split("_")[0]!=_[4]&&r.push(o.wallTpl.spam);var D=e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&_[9]==n||n==vk.id||_[9]==vk.id;D&&"rss"!==_[13]&&r.push(o.wallTpl.edit),n!=vk.id&&_[9]!=vk.id||!_[6]||(_[6]=_[6].replace("vk2017_snippet_show_layer_button","vk2017_snippet_show_layer_button_hidden"));var m=n<0&&_[9]==n&&e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR,w=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_36__.getReactionsButtonPostTemplate)(_,o);return a={oid:n,name:p,actions:r.length&&(null===(l=o.wallTpl)||void 0===l?void 0:l.post_actions)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(o.wallTpl.post_actions,{actions:r.join("")}):"",replies:"",reply_link:E,own_reply_link:o.wallTpl.own_reply_link,reply_box:b&&o.wallTpl.reply_box?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(o.wallTpl.reply_box,{actions:"",class:m?" reply_fakebox_with_official":""}):"",photo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)(d[0]),link:_[5],text:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)(_[6]),date:c,post_id:_[2],poll_hash:o.wallTpl.poll_hash,date_postfix:"",user_image:"",post_url:"/wall"+s.replace("_wall_reply","_"),can_reply_as_group:m?1:"",owner_photo:m?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)(d[1]||d[0]):"",owner_href:m?_[5]:"",owner_name:m?P:"",online_class:n>0?" online":"",likes:Likes.makeTemplate(o.wallTpl.post_likes,{buttons_prepend:null==w?void 0:w.template,like_class_name:null==w?void 0:w.likeClassName,object_raw:_[2]}),class:""},t&&extend(a,t(a,_)),D&&o.wallTpl.author_data&&(a.date=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(o.wallTpl.author_data,{date:a.date,post_id:s})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i,a),a)}console.error(new Error("Missing wall post template"))},getNewReplyHTML:function(_,e,t,o){var l=o||window.cur,i=l.wallTpl.reply,a=[],r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_field"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("fwr_text"),s="",n="",E="",d=_[10]||"",c=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_36__.getReactionsButtonReplyTemplate)(_,l);if(i){if(e>constants.Groups.GROUPS_ADMIN_LEVEL_USER||!_[2].indexOf(vk.id+"_")||_[4]==vk.id?a.push(l.wallTpl.del_reply):_[2].split("_")[0]!=_[4]&&a.push(l.wallTpl.spam_reply),(e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&_[4]==(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_[2])||_[4]==vk.id)&&a.push(l.wallTpl.edit_reply),-1!=_[8].indexOf('class="wall_reply_more"')&&(s+="reply_moreable"),r)s+=" reply_replieable",n=l.wallTpl.reply_link_wrap,wall.getReplyNames()[_[4]]||wall.addReplyName(_[4],[_[11],_[12]]);s&&(E=" onclick=\"Wall.replyClick('%post_id%', %reply_msg_id%, event, %reply_uid%)\""),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(l.wallTpl.reply_actions,{actions:a.join("")});var b={name:_[5].replace("mem_link","author"),photo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)(_[6]),link:_[7],text:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)(_[8]),classname:s,actions:a,attr:E,date:Wall.getNowRelTime(l),to_link:d,answer_link:n,post_id:_[2],reply_id:_[3],like_id:_[3].replace("_","_wall_reply"),reply_msg_id:_[3].split("_")[1],reply_uid:_[4]||"false",object_full:(0,_web_likes_helpers__WEBPACK_IMPORTED_MODULE_57__.likeReplyObjectId)(_[3]),likes:Likes.makeTemplate(l.wallTpl.reply_likes,{buttons_prepend:null==c?void 0:c.template,like_class_name:null==c?void 0:c.likeClassName,object_raw:_[2]})};return t&&extend(b,t(b)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i,b)}console.error(new Error("Missing wall reply template"))},updatePostImages:function(_){return _.replace(/<img[^>]+>/g,(function(_){return _.match(/class=/)?_.replace("src=","data-src=").replace('class="','class="__need_img '):_}))},loadPostImages:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("__need_img",_,"img"),(function(){var _=this.getAttribute("data-src");_&&(this.src=_,this.removeAttribute("data-src")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(this,"__need_img")}))},openNewComments:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),t=e.nextSibling,o=geByClass1("wr_header",e,"a"),l=0,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",e,"div").length,a=i,r=t.newCnt;Wall.loadPostImages(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clone)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("new_reply",e,"div")),(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(this,"new_reply"),(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(this),100==++l)return!1})),o&&(a=l+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(o.getAttribute("offs").split("/")[1])),i+=-r+l,(a>3||i<a)&&(o||e.insertBefore(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{className:"wr_header"}),e.firstChild),Wall.updateRepliesHeader(_,o,i,a)),cur.wallMyOpened[_]=1,t&&"replies_open"==t.className&&(r>100?(t.innerHTML=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("news_x_new_replies_more",Math.min(100,r-l)),t.newCnt-=l):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t)),Wall.repliesSideSetup(_)},langWordNumeric:function(_,e,t){return(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langWordNumeric)(_,e,t)},updateTimes:function(_){var e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(Date.now()/1e3),t=[];e-=cur.tsDiff,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("rel_date_needs_update",_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts"),"span"),(function(_,o){if(o){var l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(o.getAttribute("time")),i=e-l,a=(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_45__.getFormattedDiffTimeText)(i);a||(a=o.getAttribute("abs_time"),t.push(o)),o.innerHTML=a}})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(t,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(this,"rel_date_needs_update")}))},updateRepliesHeader:function(_,e,t,o){if(!cur.onepost){var l,i,a=e.href,r=3,s=0;if(!a&&(i=_.match(/^(-?\d+)_(photo|video|note|topic|video|)(\d+)$/))){var n=i[2]||"wall";switch(a="/"+n+i[1]+"_"+i[3],n){case"topic":a+="?offset=last&scroll=1";break;case"wall":a+="?offset=last&f=replies"}e.href=a}o>t?t<100?(l=o>100?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_show_n_last_replies",100):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_show_all_n_replies",o),r=!1):l=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_hide_replies"):(l=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_hide_replies"),s=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e,"wrh_all",s),e.innerHTML=l,e.onclick=Wall.showReplies.pbind(_,r,!1),e.setAttribute("offs",t+"/"+o)}},processQueueEvent(_){if(isObject(_)&&_.entity_type)switch(_.entity_type){case"voting":this.votingUpdatePartly(_.data.id,_.data)}},updated:function(_,e,t){var o=_?window.wkcur:window.cur;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(o.wallQueues)&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(t.events)&&t.events.length){var l=o.wallQueues.filter((_=>_.key===e)).pop();if(l)if(t.failed)o.wallQueues=!1;else{l.ts=t.ts;var i=_?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollGetY)(),a=i,r=!(o.wallType||"").indexOf("full"),s=o.onepost,n=!!_,E=_;r&&(nav.objLoc.q||nav.objLoc.search||nav.objLoc.day)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(t.events,(function(){if(isObject(this))return Wall.processQueueEvent(this);var e=this.split("<!>"),t=e[0],l=e[1],i=e[2],d=0,c=0,b=_&&window.cur.wallLayer==i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post");if(b&&"del_reply"!=l||(b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isAncestor)(b,_?wkLayerWrap:pageNode)||(b=null)),t==o.options.qversion){switch((Wall.isArchiveWall()?"archive_post"===l:"reveal_post"===l)&&(l="res_post"),(Wall.isArchiveWall()?"reveal_post"===l:"archive_post"===l)&&(l="del_post"),l){case"new_post":if(b)break;if(r&&o.pgStart>0){o.pgOffset++;break}if(o.oid==vk.id&&vk.id==e[9]&&window.curNotifier&&curNotifier.idle_manager.is_idle&&Wall.clearInput(),"own"!==o.wallType&&"all"!==o.wallType&&!Wall.hasPosts("own"))break;var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_posts"),u=p.lastChild,P=!!r&&FullWall.addTetaTet,D=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e[e.length-1]),m=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&D?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&D?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,w=Wall.getNewPostHTML(e,m,P,o);if(!w)break;var M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(w),O=p.firstChild;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+i))break;for(u&&u!=M?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(u):u=!1,r?u||o.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(M,"all"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e[10])&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(M,"own"))),0==e[8]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(M,"closed_comments"),o.deepRepliesActive&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(M,"deep_active");O&&("INPUT"==O.tagName||1!=O.nodeType||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(O,"post_fixed"));)O=O.nextSibling;p!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(O)&&Wall.sendInsertBeforeError(),p.insertBefore(M,O),Wall.votingUpdateByPostRaw(i),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_49__.updateNarrativeSnippetsFromQueueByPost)(M),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_50__.updateArticleSnippetsFromQueueByPost)(M),d=M.offsetHeight+15,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(M,E)[1],(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(M),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_29__.updateAriaElements)(),Wall.updateMentionsIndex(),AudioUtils.updateQueueReceivedPost(M);break;case"edit_post":var C=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wpt"+i);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(b)||!C)break;var g=geByClass1("wall_post_more",C);g&&(g=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(g))),d=-C.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(C,E)[1];var T=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(e[3],{poll_hash:o.wallTpl.poll_hash})),R=o.videoInlinePlayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isAncestor)(window._videoLastInlined[0],C),A=R&&"playing"==o.videoInlinePlayer.getState();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(C,T),R){var L=geByClass1("page_post_sized_thumbs",C);1==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domChildren)(L).length&&(L.innerHTML="",L.appendChild(window._videoLastInlined[1]),L.appendChild(window._videoLastInlined[0]),A&&setTimeout((function(){o.videoInlinePlayer.play()}),0))}g&&(g=geByClass1("wall_post_more",C))&&g.onclick(),Wall.votingUpdateByPostRaw(i),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_49__.updateNarrativeSnippetsFromQueueByPost)(C),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_50__.updateArticleSnippetsFromQueueByPost)(C),d+=C.offsetHeight,(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(C),Wall.updatePostAuthorData(i);break;case"edit_reply":var B=e[3],W=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wpt"+B);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("post"+B)||!W)break;var h=geByClass1("wall_reply_more",W);h&&(h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(h)));var I=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.psr)(e[4]);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(W,I),d=-W.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(W,E)[1],h&&(h=geByClass1("wall_reply_more",W))&&h.onclick(),d+=W.offsetHeight,(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_49__.updateNarrativeSnippetsFromQueueByPost)(W),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_50__.updateArticleSnippetsFromQueueByPost)(W),(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(W);break;case"post_parsed_link":if(!b)break;var f=geByClass1("wall_postlink_preview_btn_disabled",b);if(!f)break;var v=e[3];if("1"===v)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(f,"wall_postlink_preview_btn_disabled"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(f,"button_disabled");else if("0"===v)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(f);else if(v){var U=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{href:v,className:"flat_button",innerHTML:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_preview_link")});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domReplaceEl)(f,U)}break;case"del_post":b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(b)&&!o.wallMyDeleted[i]&&!s&&(d-=b.offsetHeight+15,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(b,E)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(b),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(b,"unshown"),r||n||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all"))-1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own"))-1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_archive"))-1)));break;case"res_post":b&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(b)&&((o.wallRnd==e[4]||Wall.isArchiveWall())&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(b,"unshown"),r?o.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_all"))+1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_own"))+1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)("page_wall_count_archive"))+1)));break;case"new_reply":if(!b||o.wallMyReplied[i]||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e[3])||s&&o.pgOffset<o.pgCount||n&&(o.reverse?o.offset:o.offset+o.loaded<o.count))break;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+i),"deep_active")){var K=wall.addNewReply(e);d+=K[0],c=K[1];break}var y=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+i),k=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap"+i),S=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e[e.length-1]),x=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&S?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&S?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,F=Wall.getNewReplyHTML(e,x,!1,o);if(!F)break;var N,j=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(F),H=n?y.offsetHeight:b.offsetHeight,V=!1;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(y)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(k)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("reply_link"+i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("wall_fixed",k)){N=y.nextSibling;var q=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("new_reply",y,"div").length+1;if(n||s||o.wallMyOpened[i]){if(!s){N&&"replies_open"==N.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(N),V=!0;var G=geByClass1("wr_header",y,"a"),Y=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",y,"div").length+1,z=Y;G&&(z=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(G.getAttribute("offs").split("/")[1])+1),(z>5||Y<z)&&(G||y.insertBefore(G=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("a",{className:"wr_header"}),y.firstChild),Wall.updateRepliesHeader(i,G,Y,z))}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(j,"new_reply"),N&&"replies_open"==N.className||(N=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(i),role:"button",tabIndex:0}),y.parentNode.insertBefore(N,y.nextSibling)),N.innerHTML=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_x_new_replies_more",Math.min(100,q)),N.newCnt=q}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)("reply_link"+i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(k,y),V=!0;_&&o.reverse&&y.firstChild?y.insertBefore(j,y.firstChild):y.appendChild(j),V&&(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(j),n?(o.count++,o.loaded++,WkView.wallUpdateReplies(),d=y.offsetHeight-H,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(j,E)[1]):(s&&(FullWall.repliesSummary(e[13]),o.pgOffset++,o.pgCount++,FullWall.repliesSummary(o.pgCount),Pagination.pageReady(!1),FullWall.onePostOnScroll(!1,!1,!0)),d=b.offsetHeight-H,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(V?j:N)[1],Wall.repliesSideSetup(i)),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_49__.updateNarrativeSnippetsFromQueueByPost)(j),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_50__.updateArticleSnippetsFromQueueByPost)(j),Wall.updateMentionsIndex(),Likes.update("wall"+i,{comment_num:e[13]});break;case"del_reply":if(o.wallMyDeleted[i]||!b)break;var X=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",b)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",b);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(X,"deep_active")){var Q=wall.removeDeepReply(e);d+=Q[0],c=Q[1];break}if(d-=b.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(b,E)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(b),o.layerpost)hide(b),o.count--,o.loaded--;else{s&&(o.pgOffset--,o.pgCount--,FullWall.repliesSummary(o.pgCount));var $=b.parentNode.id.match(/replies(-?\d+_\d+)/);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(b),$&&Wall.repliesSideSetup($[1])}break;case"view_post":Wall.likeUpdate(!1,i,0,Wall.formatCount((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e[3])),void 0,void 0,1);break;case"like_post":case"like_reply":if(!b)break;var Z="like_reply"==l?"wall_reply"+i:i,J=b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(b,"_like_wrap"),__=b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(b,"_share_wrap"),e_=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_36__.likeDataReactionsFields)(e);wall.likeFullUpdate(J,Z,_extends({isQueueUpdate:!0,like_my:J&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(J,"my_like"),like_num:e[3],like_title:!1,share_my:__&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(__,"my_share"),share_num:e[4],share_title:!1},e_));break;case"upd_ci":var t_=e[2],o_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("current_info"),l_=o_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_current_info");if(!l_)break;switch(e[3]){case"audio":var i_=geByClass1("current_audio_cnt");i_&&i_.tt&&i_.tt.hide();var a_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e[5]||""),r_=a_?"":" hidden",s_="";o_||(s_+=" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAudioTip+"', black: 1, shift: [14, 5, 5]})\" onclick=\"Page.playCurrent(this, '"+e[4]+"')\""),t_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(o.options.ciAudioTpl,{text:t_,attrs:s_,count:a_,cnt_class:r_}),wall.updateOwnerStatus(t_,l_,e,o_);break;case"app":var n_=e[6]?"[12, 5, 5]":"[15, 5, 5]",E_=e[6]?" current_app_icon":"",d_=o_?' onclick="cur.ciApp = '+e[4]+'"':" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAppTip+"', black: 1, shift: "+n_+'})" href="'+e[5]+'?ref=14" onclick="return showApp(event, '+e[4]+', 1, 14, cur.oid)"';e[6]&&(d_+=" style=\"background-image: url('"+e[6]+"'); background-size: 16px 16px;\""),t_='<a class="current_app'+E_+'"'+d_+">"+t_+"</a>",wall.updateOwnerStatus(t_,l_,e,o_);break;default:stManager.add([jsc("web/emoji.js")],(function(){t_=t_?'<span class="current_text">'+Emoji.emojiToHTML(t_,!0)+"</span>":t_,wall.updateOwnerStatus(t_,l_,e,o_)}))}break;case"upd_ci_cnt":var c_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("current_info"),b_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(e[2]),p_=c_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_current_info"),u_=p_&&geByClass1("current_audio_cnt",p_);u_&&(u_.tt&&u_.tt.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(u_,"hidden",0==b_),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.animateCount)(u_,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.langNumeric)(b_,"%s",!0),{str:"auto"}));break;case"cover_updated":var P_=geByClass1("_page_cover");if(P_&&e[2]){var D_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.vkImage)(),m_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.isRetina)()?e[3]:e[2];D_.src=m_,D_.onload=function(){P_.style.backgroundImage="url('"+m_+"')",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(D_)}}}d&&(_?c<0:a+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)("page_header_cont")[1]>c)&&(a+=d)}})),a!=i&&i>100&&!o.onepost&&(_?wkLayerWrap.scrollTop=a:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)(a,0,!1,!0)),Wall.update())}}},updateOwnerStatus:function(_,e,t,o){o&&(_='<span class="'+(_?"my_current_info":"no_current_info")+'">'+(_||(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("change_current_info"))+"</span>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e.parentNode.nextSibling,_),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)("currinfo_editor")&&cur.oid>0&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)("currinfo_audio","app"!=t[3]),t[2]&&"app"!=t[3]&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("currinfo_audio"),Boolean(t[2])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)("currinfo_app","app"==t[3]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)("currinfo_app","on")));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,_)},updateMentionsIndex:function(_){if(clearTimeout(cur.wallUpdateMentionsIndexTO),_){var e={},t=[],o=new RegExp("^(https?://(vk.com|"+location.host.replace(/\./,"\\.")+"))?/?"),l=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("author",bodyNode,"a"),(function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(this),l=this.href.replace(o,"");if(void 0===e[l]){var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(this.getAttribute("data-from-id"));i&&i!=vk.id&&(e[l]=t.length,t.push([i,_,"@"+l,"/images/camera_c.gif"]))}})),l=l.concat(Array.from(document.querySelectorAll("a.post_image, a._post_image")),Array.from(document.querySelectorAll("a.reply_image, a._reply_image"))),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(l,(function(){var _=this.href.replace(o,""),l=e[_];if(void 0!==l){for(var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(this);i&&"IMG"!=i.tagName;)i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(i);i&&(t[l][3]=i.getAttribute("src"),delete e[_])}})),cur.wallMentions=t}else cur.wallUpdateMentionsIndexTO=setTimeout(wall.updateMentionsIndex.pbind(!0),300)},initUpdates:function(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_&&_.length&&window.Notifier){var t=e?window.wkcur:window.cur,o=()=>{t.wallQueues&&t.wallQueues.forEach((_=>{Notifier.addKey(_,((_,t)=>{Wall.updated(e,_,t)}))}))};if(!t.wallQueues){var l=setInterval(o,1e4);e?t._hide.push((()=>clearInterval(l))):t.destroy.push((()=>clearInterval(l)))}t.wallQueues=_,o()}},initWallOptions:function(_){extend(cur,{wallCheckComments:_.check_comments,wallType:_.wall_type,wallTpl:_.wall_tpl,wallMyDeleted:{},tsDiff:_.wall_tpl&&_.wall_tpl.abs_timestamp?900*Math.round((Date.now()/1e3-_.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMentions:[],wallMyRepliesCnt:0,wallUploadOpts:_.upload,wallUploadVideoOpts:_.upload_video,hasGroupAudioAccess:_.hasGroupAudioAccess}),_.wall_tpl&&_.wall_tpl.lang&&(cur.lang=extend(cur.lang||{},_.wall_tpl.lang)),window.Notifier&&Notifier.addRecvClbk("wall_reply_multiline","wall",(function(_){Wall.onReplySubmitChanged(_.value,1)}),!0)},onPostLoaded:function(_,e){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)(_),Wall.onAdBlockLoaded(_,e),e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"_post")&&(_=geByClass1("_post",_)),_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"_post")&&cur.onPostLoaded&&cur.onPostLoaded(_)},onAdBlockLoaded:function(_,e){var t,o="_ads_block_data_w";(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"_ads_promoted_post_data_w")?t=_:e&&(t=geByClass1(o,_)||geByClass1("_ads_promoted_post_data_w",_)),t&&Wall.triggerAdStat(t,"load")},init:function(_){var e;Wall.initWallOptions(_),extend(cur,{wallInited:!0,postField:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_field"),wallSearch:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wall_search"),wallPage:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("profile")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("group")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("public"),wallPageNarrow:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("narrow_column"),wallUploadOpts:_.upload||!1,wallOnClearInput:[],deletedCnts:{own:0,all:0,archive:0},posterFeatureTooltip:_.poster_feature_tooltip,posterFeatureTooltipHash:_.poster_feature_tooltip_hash,postCopyrightFeatureTooltip:_.post_copyright_feature_tooltip,postCopyrightFeatureTooltipHash:_.post_copyright_feature_tooltip_hash}),cur.destroy.push((function(_){(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.serviceWallUsers),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.serviceWallGroups),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.serviceNews),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.cleanElems)(_.postField)}));var t=removeEvent.pbind(document,"click",Wall.hideEditPostReply);cur._back?(cur._back.hide.push(t),cur._back.show.push(t),cur._back.show.push(addEvent.pbind(document,"click",Wall.hideEditPostReply))):cur.destroy.push(t),cur.wallTab=cur.wallType,Wall.update(),Wall.initUpdates(_.add_queues),_.wall_tpl&&(cur.timeUpdateInt=setInterval((function(){Wall.updateTimes(_.wallCont)}),1e4),cur.destroy.push((function(){clearInterval(cur.timeUpdateInt)})));var o=window;addEvent(o,"scroll",Wall.scrollCheck),addEvent(window,"resize",Wall.scrollCheck),cur.destroy.push((function(){removeEvent(o,"scroll",Wall.scrollCheck),removeEvent(window,"resize",Wall.scrollCheck)})),cur.wallAutoMore=_.automore;var l=!1;if((null===(e=cur.options)||void 0===e?void 0:e.no_draft)||(l=_.draft||cur.oid!=vk.id&&Wall.getOwnerDraft(cur.oid)),Wall.initPostEditable(l),cur.wallSearch&&placeholderInit(cur.wallSearch),removeEvent(document,"click",Wall.hideEditPostReply),addEvent(document,"click",Wall.hideEditPostReply),_.poster_options&&Wall.initPosterEditor(_.poster_options),_.media_types){var i=_.media_types.find((_=>"article"===(null==_?void 0:_[0]))),a=extend({onAddMediaChange:(_,e,t)=>{cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide(),Wall.hidePosterFeatureTooltip(),Wall.postChanged(10),["poll","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION].includes(_)||wall.focusOnEnd(),cur.oid!=vk.id&&Wall.saveOwnerDraftMedia(cur.oid,_,e,t),setTimeout(Wall.checkPosterAvailability)},onChangedSize:()=>{setTimeout((()=>{var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("VideoRestriction",_);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(e,((_,e)=>{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(e)[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(e)[0];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e,"VideoRestriction--onlyIcon",o<200),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e,"VideoRestriction--small",o>=200&&o<300&&o>t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e,"VideoRestriction--medium",o>=300&&o<400)}))}))},onMediaChange:()=>{Wall.postChanged()},onMediaUploadStarted:()=>{Wall.postChanged()},editable:1,from:"ads"===cur.module?"ads":"post",sortable:1,poster:cur.poster,maxShown:i&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_52__.partConfigEnabled)("inline_attaches_icons")?4:3,hideAfterCount:4},_.media_opts||{});if(cur.wallAddMedia=new MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_add_media"),"media_preview",_.media_types,a),cur.wallAddMedia.menu){var r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("official");r&&s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_submit_post_box",s),"from-oid")!=cur.postTo&&hide(r)}}if(Wall.initPostVisibilitySelector(cur.wallAddMedia),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_38__.isPostTopicSettingEnabled)(window.cur)){var n=cur.wallAddMedia&&cur.wallAddMedia.id||"",E=(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_38__.initPostTopicCreatingSelector)(String(n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_actions_btns"));E&&(window.cur.destroy.push(E.onDestroy),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(E.clearSelection))}if(cur.withUpload=window.WallUpload&&!browser.safari_mobile&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.inArray)(cur.wallType,["all","own","feed","full_all","ads_promoted_stealth"])&&Wall.withMentions&&cur.wallUploadOpts,cur.withUpload&&WallUpload.checkDragDrop()){var d=function(){removeEvent(document,"dragover dragenter drop dragleave",p)},c=!1,b=!1,p=function(_){if(!1!==c&&(clearTimeout(c),c=!1),cur.uploadInited)return d(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(_);switch(_.type){case"drop":b=!1,delete cur.wallUploadFromDrag,hide("post_upload_dropbox");break;case"dragleave":c=setTimeout((function(){b=!1,delete cur.wallUploadFromDrag,hide("post_upload_dropbox")}),100);break;case"dragover":case"dragenter":b||2==(b=!_.target||"IMG"!=_.target.tagName&&"A"!=_.target.tagName?2:1)&&setTimeout(WallUpload.initCallback,0),2==b&&(cur.wallUploadFromDrag=1)}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(_)};addEvent(document,"dragover dragenter drop dragleave",p),cur.destroy.push(d)}if(Wall.updateMentionsIndex(),_.top_wall_feature_tooltip?setTimeout((function(){Wall.showTopWallTooltip(_.top_wall_feature_tooltip_hash)}),800):_.order_feature_tooltip&&setTimeout((function(){Wall.showOrderTooltip(_.order_feature_tooltip_hash)}),800),(0,_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_42__.wallPostRenderInit)(),nav.objLoc.new_post){Wall.showEditPost();var u=nav.objLoc.post_privacy;"friends_only"===u?Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,"",!0):"best_friends_only"===u&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("best_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_35__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,"",!0),delete nav.objLoc.new_post,delete nav.objLoc.post_privacy,nav.setLoc(nav.objLoc)}},initPosterEditor:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)('<div class="page_block"></div>'),t=Wall.getMainPostBlock();"feed"===cur.module&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(e,"feed_post_field_wrap");var o=function(){return!1},l=function(){Wall.closeFancyTooltipsInPost(),Wall.openPosterEditor(),cur.poster.sendStatsInfo("open")},i={onPreOpen:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)(e,t)},onPostOpen:function(){var _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onPreHide:function(){Wall.saveCaretPositionForPoster(cur.poster.getTextInputEl()),Wall.closeFancyTooltipsInPost();var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_error"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_actions_btns"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(t,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)(_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(e))},onPostHide:function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_settings_btn"),o=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("check_sign");_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(_,cur.openPosterBtn),o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(o,cur.openPosterBtn),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(t);var l=cur.poster.getTextAsHtml();l&&l.match(Emoji.emojiRegex)&&(l=l.replace(Emoji.emojiRegex,Emoji.emojiReplace)),cur.postField.innerHTML=l,Wall.restoreCaretPositionForPoster(cur.postField),setTimeout((function(){Composer.updateArticleConvertSuggest((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(cur.postField,"composer"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(e)},onPreUploaderOpen:function(){var _=cur.poster.getTextInputEl();Wall.saveCaretPositionForPoster(_)},onPostUploaderClose:function(){var _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onOverTextLimit:function(){Wall.disablePoster(!0),cur.poster.closeEditor(),cur.poster.sendStatsInfo("auto_disable"),cur.poster.state.toggled=!0},onChangeData:Wall.postChanged,onSend:function(_){Wall.sendPost(!0,_)},onDestroy:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(e)},getPostOwnerId:function(){return+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"),"from-oid")},width:Wall.getMainPostBlock().clientWidth,containerClasses:"poster_wall-creating",placeholder:attr(cur.postField,"placeholder"),appendToElem:e};cur.openPosterBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_poster_btn"),cur.poster=new Poster(_.poster_config,i),addEvent(cur.openPosterBtn,"click",l),addEvent(cur.openPosterBtn,"mousedown",o),cur.destroy.push((function(){removeEvent(cur.openPosterBtn,"click",l),removeEvent(cur.openPosterBtn,"mousedown",o)}))},openPosterEditor:function(_){if(cur.viewAsBox)return cur.viewAsBox();if(cur.poster&&!cur.poster.state.disabled&&!cur.poster.state.opened){_=_||{},cur.posterFeatureTT&&cur.posterFeatureTT.hide();var e=Wall.getMainPostBlock(),t=_.bkgId,o=window.browser.windows7||window.browser.windowsVista||window.browser.windowsXp;Wall.saveCaretPositionForPoster(cur.postField);var l=_.text||cur.postField.innerHTML;if(l=(l=l.replace(/\n/g,"<br/>")).replace(/<img[^>]*>/g,(function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:_}).firstChild,t=Emoji.getCode(e);return t?o?" ":Emoji.codeToChr(t):_})),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(e))return cur.poster.setBkg(t,!0),void cur.poster.setText(l);hide(e);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_settings_btn"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_error"),r=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("check_sign"),s=cur.poster.getPostOptionsWrapperEl();if(i&&s.appendChild(i),r&&s.appendChild(r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(a)){var n=cur.poster.getErrorWrapperElement();n.innerHTML="",n.appendChild(a)}var E=cur.poster.getBtnsWrapper(),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_actions_btns");d&&(E.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(d,E.firstChild):E.appendChild(d),d.children.length||E.children.length>1?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(E):hide(E)),cur.poster.openEditor(),cur.poster.setBkg(t,!0),cur.poster.setText(l)}},checkPosterAvailability:function(){if(cur.poster){var _=cur.wallAddMedia?cur.wallAddMedia.getMedias():[],e=cur.poster.isTextFieldValid(cur.postField),t=Wall.checkAttachesForPoster(_),o=e&&t;!o!==cur.poster.state.disabled&&Wall.disablePoster(!o),o&&cur.poster.state.toggled&&(Wall.openPosterEditor(),cur.poster.sendStatsInfo("auto_enable"),cur.poster.state.toggled=!1)}},checkAttachesForPoster(_){if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(_))return!1;if(!_.length)return!0;var e=0;return _.some((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_39__.isArray)(_)){var t=_slicedToArray(_,1)[0];["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION].includes(t)||++e}})),0===e},disablePoster:function(_){cur.poster&&(void 0===_&&(_=!0),cur.poster.state.disabled=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(cur.openPosterBtn,"_disable",_))},isPosterEditorOpen:function(){return cur.poster&&cur.poster.isOpen()},saveCaretPositionForPoster:function(_){if(document.activeElement===_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("span");e.classList.add("poster__marker","poster__marker_start"),t.classList.add("poster__marker","poster__marker_end");var o=getSelection().getRangeAt(0);(o=o.cloneRange()).insertNode(e),o.collapse(!1),o.insertNode(t)}},restoreCaretPositionForPoster:function(_){var e=geByClass1("poster__marker_start",_),t=geByClass1("poster__marker_end",_);if(e&&t){var o=document.createRange();o.setStartBefore(e),o.setEndBefore(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t);var l=window.getSelection();l.removeAllRanges(),l.addRange(o)}else wall.focusOnEnd(_)},getMainPostBlock:function(){var _=cur.mainPostBlock;return _||(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box")),cur.mainPostBlock=_),_},changeAuthorInPoster:function(_){cur.poster&&_&&cur.poster.changeBkgAuthor({authorName:_.authorName,authorUrl:_.authorUrl})},sendInsertBeforeError:function(){ajax.post("al_page.php",{act:"insert_before_error",trace:(new Error).stack,owner_id:cur.oid,module:cur.module})},closeFancyTooltipsInPost:function(){var _=cur.wallAddMedia.lnkId;cur["postPostponeTT"+_]&&cur["postPostponeTT"+_].hide(),cur["post_action_btn"+_]&&cur["post_action_btn"+_].hide(),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_38__.topicUISelectorHide)(_)},switchOwner:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(geByClass1("_ui_toggler",_),"on"),uiSearch.showProgress("wall_search"),cur.options.params.owners_only=cur.options.params.owners_only?null:1,nav.change({owners_only:cur.options.params.owners_only,offset:null})},fakeReplyAsGroupOver:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("reply_fakebox_with_official",_)&&wall.replyAsGroupOver(_)},fakeReplyAsGroupCheck:function(_,e,t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("reply_fakebox_with_official",_))return window.tooltips&&window.tooltips.hide(_),Wall.showEditReply(e,null,!1,!1,!0,(function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_as_group"+e);_&&(_.focus(),_.click())})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(t)},setReplyAsGroup:function(_,e){if(!_)return!1;if(_.hasAttribute("data-reinit-ads-needs-confirmation")&&window.AdsEdit&&!e.reinitConfirmed&&AdsEdit.reinitCreatingPostFormNeeded())return AdsEdit.reinitCreatingPostFormConfirm(wall.setReplyAsGroup.pbind(_,extend({},e||{},{reinitConfirmed:!0}))),!1;var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("_submit_post_box",_),o=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("signed"),l=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("close_comments"),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mute_notifications"),a=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("official"),r=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mark_as_ads"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"tt"),n=e.from||(e.fromGroup?cur.oid:vk.id),E=n==vk.id?wall.replyAsProfileData():window.replyAsData&&window.replyAsData[n]||wall.replyAsGroupDomData(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"from-oid")==n||!E||E[0]!=n)return!1;var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("submit_post_box"),c=!t&&cur.poster&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("poster",_),b=t===d;c&&(t=d,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("signed"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mark_as_ads"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("close_comments"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("mute_notifications"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("official")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"from-oid",n),wall.replyAsAnimate(t,E[2],E[1]),cur.poster&&(b||c)&&Wall.changeAuthorInPoster({authorName:E[3],authorUrl:E[2]}),s&&s.rows&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(s.rows,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(this,"active",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(this,"from-oid")==n)})),o&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(o,n>0),r&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(r,n>0),l&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(l,n>0),i&&((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.isChecked)(r)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(i,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(i,1)):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.disable)(i,n>0)),a&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.checkbox)(a,n!==vk.id),_.setAttribute("aria-label",(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)(n<0?"wall_reply_as_group":"wall_reply_as_user")),_.hasAttribute("data-replace-owner-name")&&(_.innerHTML=E[3],"A"===_.tagName&&(_.href=E[2])),_.hasAttribute("data-replace-post-to")&&(cur.postTo=E[0]),_.hasAttribute("data-replace-oid")&&(cur.oid=E[0]),_.hasAttribute("data-reinit-ads-post-editor")&&window.AdsEdit&&(e.withoutRedraw?AdsEdit.reinitCreatingPostFormBoundWithoutRedraw():AdsEdit.reinitCreatingPostFormBound()),"official"==_.id&&Wall.postChanged(!0);var p=cur.wallAddMedia&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast");if(p){var u=cur.postTo==n;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(cur.wallAddMedia.getMedias()||[],(function(_,e){if("podcast"===e[0])return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e[2],"attach_disabled",!u),u=!1,!1})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)(p,u)}return _.id&&Wall.hideCheckTimer(_.id.replace("reply_as_group",""),"editing"),cur.wallAddMedia&&cur.wallAddMedia.donutUpdateVisibility(t),!1},replyAsAnimate:function(_,e,t){var o=_&&geByClass1("_post_field_author",_),l=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_post_field_image",o),i=_&&geByClass1("_post_field_official",_),a=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_post_field_image",i),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"author_secondary")?0:1;o&&l&&l[r]&&(o.href=e,l[r].src=t),a&&a[r]&&(a[r].src=t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(_,"author_secondary")},replyAsGroupOver:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"checkbox_official")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"reply_fakebox_wrap_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"disabled"))return!1;var e,t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_submit_post_box",_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("deep_active",_);if(e=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",_)?[7,8,8]:o?[2,8,8]:[9,8,8],(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(_,{text:function(){return((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"from-oid")||vk.id)<0?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_on_behalf_group"):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_on_behalf_me")},black:1,shift:e}),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"reply_fakebox_wrap_image")&&(wall.isWallReply(_)||wall.isAdsCreatingPost(_))){var l="/al_groups.php",i="get_editor_clubs";wall.isAdsCreatingPost(_)&&(l="/ads_edit.php",i="a_get_promoted_post_stealth_groups"),ajax.post(l,{act:i},{cache:1})}},replyAsGroupFocus:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"tt");e&&e.isShown()||wall.replyAsGroupOver(_)},replyAsGroup:function(_,e,t){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"checkbox_official")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"disabled"))return t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(t);if(!((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"can_reply_as_any_group")>0)&&wall.isWallReply(_))return wall.replyAsGroupTT(_,e,[]),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(t);if(!wall.isWallReply(_)&&!wall.isAdsCreatingPost(_)||cur.replyAsLoaded)wall.showReplyAsGroupTooltip(_,e);else{var o="/al_groups.php",l="get_editor_clubs";wall.isAdsCreatingPost(_)&&(o="/ads_edit.php",l="a_get_promoted_post_stealth_groups"),ajax.post(o,{act:l},{cache:1,onDone:function(t){cur.replyAsLoaded=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(_)&&wall.showReplyAsGroupTooltip(_,e)}})}return t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(t)},showReplyAsGroupTooltip(_,e){var t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("can_reply_only_verified",_),o=(cur.replyAsLoaded||[]).filter((_=>!t||_[0]>0||_[4]));wall.replyAsGroupTT(_,e,o)},replyAsGroupDomData:function(_){var e,t,o,l,i;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",_)){var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",_),"post-id");a&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+a),t=a.split("_")[0])}else e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_submit_post_box",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"oid");return e&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"owner-photo"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"owner-href"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"owner-name")),t&&o&&l&&i&&[t,o,l,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.unclean)(i))]||cur.wallTpl&&cur.wallTpl.ownerData||!1},isWallReply:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_submit_post_box",_);return e&&e.id.match(/reply_box(-?\d+)_(\d+)/)},isAdsCreatingPost:function(_){return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("ads_edit_ad_submit_post_header",_)},replyAsProfileData:function(){return window.cur&&cur.wallTpl&&cur.wallTpl.profileData||window.wkcur&&wkcur.wallTpl&&wkcur.wallTpl.profileData||window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},replyAsGroupList:function(_,e){var t=_.hasAttribute("data-disallow-profile")?[]:[wall.replyAsProfileData()],o=wall.replyAsGroupDomData(_);return o&&t.push(o),(wall.isWallReply(_)||wall.isAdsCreatingPost(_))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(window.replyAsList,(function(){this[0]!=e&&t.push(this)})),t},replyAsGroupTT:function(_,e,t){window.replyAsList=t||[],window.replyAsData={},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(window.replyAsList,(function(){window.replyAsData[this[0]]=this}));var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"tt"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_submit_post_box",_),i=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"from-oid");if(!wall.replyAsProfileData())return!1;if(!o){var a=wall.replyAsGroupList(_,e),r="";_.hasAttribute("data-enable-search")&&(r+='<div class="post_from_tt_row_search_wrap"><input class="clear_fix post_from_tt_row post_from_tt_row_search" value="" placeholder="'+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_search")+'" /><div class="post_from_tt_row_search_progress"></div></div>');var s=function(_,e,t,o,l){return'<a id="_post_from_tt_row_oid_'+e+'" class="clear_fix post_from_tt_row _post_from_tt_row_searchable'+_+'" data-from-oid="'+e+'" href="'+t+'"><img class="post_from_tt_image" src="'+o+'" aria-label="'+l+'">'+l+"</a>"};(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(a,(function(){var _=i==this[0]?" active":"";r+=s(_,this[0],this[2],this[1],this[3])}));var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("deep_active",_);o=new ElementTooltip(_,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+r+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"bottom",offset:function(){return wall.isAdsCreatingPost(_)?[_.offsetWidth/2+8.5,-2]:n?[1,-5]:[-10,-5]},onFirstTimeShow:function(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post_from_tt_row",e);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(t,(function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"post_from_tt_row_search")||addEvent(t,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(this,"from-oid")}))}));var l=geByClass1("post_from_tt_row_search",e);if(l){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_post_from_tt_row_searchable",e),a=_.getAttribute("data-search-url"),r={};addEvent(l,"keyup valueChanged",(function(){var t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(l)).toLowerCase();if(a&&t){_.searchRequestTimeout&&(clearTimeout(_.searchRequestTimeout),delete _.searchRequestTimeout);var n=geByClass1("post_from_tt_row_search_progress",e);geByClass1("pr",n)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.showProgress)(n),_.searchRequestTimeout=setTimeout((function(){r[t]?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.hideProgress)(n):ajax.plainpost(a,{str:t},(function(l){r[t]=!0,l=JSON.parse(l),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(l,(function(){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("_post_from_tt_row_oid_"+this[0])){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(s("",this[0],this[2],this[1],this[3]));geByClass1("ui_scroll_content",e).appendChild(t),addEvent(t,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"from-oid")})),window.replyAsData[this[0]]||(window.replyAsData[this[0]]=this)}})),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_post_from_tt_row_searchable",e),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.hideProgress)(n)}),(function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.hideProgress)(n)}))}),500)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.each)(i,(function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggle)(e,""===t||-1!==e.innerText.toLowerCase().indexOf(t))}))}))}this.rows=t,this.scroll=new uiScroll(geByClass1("_post_scroll_wrap",e)),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0)},onShow:function(_){setTimeout((function(){if(o.scroll){var e=geByClass1("active",_),t=e?e.offsetTop-(o.scroll.data.viewportHeight-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(e)[1])/2:0;o.scroll.scrollTop(t);var l=geByClass1("post_from_tt_row_search",_);l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.elfocus)(l)}}),0)},onHide:function(_){var e=geByClass1("post_from_tt_row_search",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,"")}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"tt",o)}e&&o.isShown()&&!_.hasAttribute("data-disallow-profile")&&wall.setReplyAsGroup(_,{from:i==vk.id?e:vk.id}),_.tt&&_.tt.hide&&_.tt.hide(),o.isShown()||o.show()},reportPost:function(_,e,t){stManager.add([jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(_,e,"report_"+t)}))},parsePostId:_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_58__.parseObjectPostId,likeIt:function(_,e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.stopEvent)(o),!vk.id)return!1;if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(o);var l,i=wall.parsePostId(e),a=i.type,r=i.id,s=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",_))||wall.domPost(r),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(s,"_like_wrap"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(n,"_count"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(n,"my_like");l=e==cur.wallLayer?"wkview":cur.wallType?"feed"==cur.wallType?"news"==cur.section?"feed_"+(cur.subsection?cur.subsection:cur.section):"recommended"==cur.section?"feed_recommended"+("recent"!=cur.subsection?"_"+cur.subsection:""):"friends"==cur.section||"groups"==cur.section||"videos"==cur.section||"photos"==cur.section?"feed_"+cur.section+(cur.subsection?"_"+cur.subsection:""):"feed_"+cur.section:"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module,ajax.post("like.php",{act:d?"a_do_unlike":"a_do_like",object:a+r,hash:t,wall:2,from:l},{onDone:Wall.likeFullUpdate.pbind(_,e),onFail:function(){return!0}});var c=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.stripHTML)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(E)).replace(/(\s|,)/g,"");return Wall.likeUpdate(_,e,!d,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(c)+(d?-1:1)),"wall"==a&&window.cur.onLike&&window.cur.onLike(_,a,e,d),cur.onWallLike&&cur.onWallLike(),"wall"==a&&Wall.triggerAdStat(r,"like_post"),!1},likesShow:function(_,e,t){if(!_.postDontShowLikes){t=t||{};var o=wall.parsePostId(e),l=o.type,i=o.id,a=l+i,r=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",_))||wall.domPost(i),s=t.views?"_views_wrap":t.share?"_share_wrap":"_like_wrap",n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(r,s),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"_feedback_info_item")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(n,"_icon"),d=r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(r,"_share_wrap");if(E&&!cur.viewAsBox){var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(n)[0],b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(E)[0],p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(E,!0)[0],u=b+p/2-c-41,P=t.views?{views:1}:t.share?{published:1}:{};if(t.listId&&(P.list=t.listId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(E,"_feedback_info_item")){var D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByTag1)("em",E);u=-40,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(E,"feedback_share")&&(u+=7),u+=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(D)[0]/2}var m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(E,"_feedback_info_item")?E:E.parentNode;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(m,{url:"/like.php",params:extend({act:"a_get_stats",object:a,has_share:d?1:""},P),slide:15,shift:[-u,t.views?2:"wall_reply"==l?-3:7],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,noZIndex:!0,tip:{over:function(){Wall.likesShow(_,e,t)}},onShowStart:function(){var e=m.tt.container;setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(e,{left:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.floatval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getStyle)(e,"left"))+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(E)[0]-b})}),10),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.statlogsValueEvent)("likes_show",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"shown"))},typeClass:"like_tt",className:t.cl||""})}}},likesShowList:function(_,e,t){t=t||{};var o=wall.parsePostId(e),l=o.type,i=o.id,a=l+i,r=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",_))||wall.domPost(i),s=t.share?"_share_wrap":"_like_wrap",n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(r,s);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domByClass)(n,"_icon")&&!cur.viewAsBox&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.showWiki)({w:(t.views?"views":t.share?"shares":"likes")+"/"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)(a)},!1,!1,{queue:1})},sharesShow:function(_,e,t){Wall.likesShow(_,e,extend(t,{share:1}))},sharesShowList:function(_,e,t){Wall.likesShowList(_,e,extend(t,{share:1}))},viewsShowList:function(_,e,t){Wall.likesShowList(_,e,extend(t,{views:1}))},viewsUpdate:function(_,e){var t=wall.parsePostId(e),o={act:"a_get_stats",object:t.type+t.id,views:1};ajax.post("/like.php",o,{cache:1,onDone:function(t,l){Wall.likeUpdate(!1,e,!1,t,void 0,void 0,1);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:l});_.setAttribute("title",i.innerText||i.textContent),setTimeout(ajax.invalidate.pbind("/like.php",o),3e3)}})},sharesOpen:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(_);if(!vk.id)return!1;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.stopEvent)(_);var o=wall.parsePostId(e),l=o.type,i=o.id,a=l+i;return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showBox)("/like.php",extend({act:"publish_box",object:a},t)),"wall"==l&&Wall.triggerAdStat(i,"share_post"),!1},customCur:function(){return window.wkcur&&wkcur.shown?wkcur:window.mvcur&&mvcur.mvShown?mvcur:window.pvcur&&cur.pvShown?pvcur:cur},processPostReplyActions:function(_){},updatePostAuthorData:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("_post_author_data_"+_).forEach((function(_){_.post_author_data_update=!0}))},closeComments:function(_,e,t,o,l){var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"closed"))?0:1;ajax.post("al_wall.php",{act:"close_comments",owner_id:e,post_id:t,close:i,hash:o},{onDone:function(){if(l)l(i);else{var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",_);Wall.onCloseComments(i,e)}}})},onCloseComments:function(_,e,t){if(e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"postponed")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"post")&&!vk.widget){var o=geByClass1("comment",e),l=geByClass1("reply_box_inner_wrap",e),i=cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"Post--with_closed_comments_donut");if(t||a||o&&l){i||a||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(e,"closed_comments",_);var r=geByClass1("action_closing_comments",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(r,"closed",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(r,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)(_?"wall_open_comments":"wall_closing_comments"))}else{var s=e.id.replace("post","").split("_");ajax.post("al_wall.php",{act:"comment_box",owner_id:s[0],post_id:s[1]},{onDone:function(t,o){if(!i){var l=geByClass1("comment",e),a=geByClass1("reply_box_inner_wrap",e);if(!l&&t){var r=geByClass1("like",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domNS)(r))}if(!a&&o){var s=geByClass1("replies_list",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(o),s)}}Wall.onCloseComments(_,e,!0)}})}}},showPostEditedTime:function(_){var e=(cur.lang||{}).wall_changed;if(e){var t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"time")),o=60*((new Date).getTimezoneOffset()+180);t&&(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(_,{text:e.replace("{time}",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.getDateText)(t,o)),black:1,shift:[0,4]})}},showPostAuthorData:function(_,e){var t=_.className.match(/_post_author_data_(-?\d+_\d+)/)[1]||"",o=e?e.target:window.event.srcElement;!t||o!=_&&o.onmouseover||(_.post_author_data_update&&(delete _.post_author_data_update,_.post_author_data_tt&&(_.post_author_data_tt.destroy(),_.post_author_data_tt=!1)),_.post_author_data_tt||ajax.post("al_page.php",{act:"post_author_data_tt",raw:t},{onDone:function(e){var o=geByClass1("post_link",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(_);if(e&&o){var l={content:e,arrowSize:"mini",cls:"post_author_data",defaultSide:"bottom",align:"left",id:"author_tt_"+t},i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("_im_mess_stack",_);i?l.appendTo=i:l.appendToParent=!0,vk.widget&&(l.offset=[0,-2],l.forceSide="bottom"),_.post_author_data_tt=new ElementTooltip(o,l),_.post_author_data_tt.show()}else _.post_author_data_tt=!0}}))},createPostTooltip:_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_40__.createPostTooltip,showTopWallTooltip:function(_){if(!cur.topWallFeatureTT){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_top");e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(e)||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_wall_top_more")),e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.isVisible)(e)&&(cur.topWallFeatureTT=new ElementTooltip(geByClass1("ui_tab",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("ui_tab",e),{content:'<div class="feature_tooltip__close" onclick="cur.topWallFeatureTT.hide();"></div>'+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_top_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domClosest)("page_block",e),onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"top_wall_web"})}}),cur.topWallFeatureTT.show())}},hidePostCopyrightFeatureTooltip:function(){cur.postCopyrightFeatureTooltip&&cur.postCopyrightFeatureTooltipHash&&(cur.postCopyrightFeatureTooltip=!1,cur.postCopyrightFeatureTT.hide(),setTimeout((()=>{cur.postCopyrightFeatureTT.destroy()}),ElementTooltip.FADE_SPEED),ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"}))},showPostCopyrightFeatureTooltip:function(){if(cur.postCopyrightFeatureTooltip&&!cur.postCopyrightFeatureTT){var _=setTimeout((()=>{var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_settings_btn");_&&cur.postCopyrightFeatureTooltip&&(cur.postCopyrightFeatureTT=new ElementTooltip(_,{content:`<div class="feature_tooltip__close" onclick="Wall.hidePostCopyrightFeatureTooltip();"></div>${(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_post_copyright_feature_text")}`,cls:"feature_intro_tt feature_info_tooltip",forceSide:"bottom",autoShow:!1,noOverflow:!1,noHideOnClick:!0,appendToParent:!0,offset:[-6.5,-8],onShow:()=>{ajax.post("al_index.php",{act:"show_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"})},onWindowClick:()=>{cur.postCopyrightFeatureTT&&(cur.postCopyrightFeatureTT.hide(),cur.postField.blur())}}),cur.postCopyrightFeatureTT.show())}),800);cur.destroy.push((()=>clearTimeout(_)))}},hidePosterFeatureTooltip:function(){cur.posterFeatureTooltip=!1,cur.posterFeatureTT&&cur.posterFeatureTooltipHash&&(cur.posterFeatureTT.destroy(),cur.posterFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.posterFeatureTooltipHash,type:"poster_new_year"}))},showPosterFeatureTooltip:function(){if(cur.posterFeatureTooltip){var _=setTimeout((function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domQuery1)(".poster__open-btn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("page_poster_btn"));if(_&&cur.posterFeatureTooltip){var e='<div class="poster_feature_tt__layout" onclick="cur.posterFeatureTT.hide(); cancelEvent(event);"><div class="poster_feature_tt__close"></div><div class="poster_feature_tt__info">'+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_new_posters_new_year")+"</div>";cur.posterFeatureTT=new ElementTooltip(_,{content:e,forceSide:"bottom",cls:"eltt_fancy poster_feature_tt",autoShow:!1,noOverflow:!1,align:"left",centerShift:-28,noHideOnClick:!0,appendToParent:!0,offset:[0,-8],onHide:Wall.hidePosterFeatureTooltip,onWindowClick:function(){cur.posterFeatureTT.hide(),cur.postField.blur()}}),cur.posterFeatureTT.show(),cur.poster&&cur.poster.sendStatsInfo("new_bkg_tooltip_show")}}),800);cur.destroy.push((function(){clearTimeout(_)}))}},toggleRecommFriend:_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_34__.FriendsRecommendGlobals.toggleRecommFriend,hideRecommFriend:_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_34__.FriendsRecommendGlobals.hideRecommFriend,onClickRecommFriend:_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_34__.FriendsRecommendGlobals.onClickRecommFriend,replyEditPhoto:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!1,(function(){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_more_attaches"+e);if(t){var o=geByClass1("ms_item_photo",t);tooltips.hide(_),o&&o.click()}})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(t)},replyMoreAttachShow:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!0,(function(){var _=geByClass1("ms_items_more_wrap",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_more_attaches"+e));_&&(_.focus(),_.click())})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(t)},replyFakeEmojiOver:function(_){wall.initEditReply(_,!1,!0,(function(){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_smile"+_);if(e){var t,o=geByClass1("emoji_smile",e);null===(t=o.onmouseenter)||void 0===t||t.call(o)}}))},hideDeepReplies:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"reply")&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",e),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"post-id"));var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"replies-offset")||0,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"replies-limit")||3,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(cur.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:t,count:o,text:"",class:" replies_next_main"}));l.innerHTML="",l.appendChild(i),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(l)[1]-100,0,null,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"collapse",!0),i.click(),cur.wallMyOpened[_]=0},addNewReply:function(_){var e,t=_[2],o=(_[10]||"").match(/wall.showReply\([^-)0-9]*(-?[_0-9]+)[^-)0-9]*(-?[_0-9]+)[^-)0-9]*\)/),l=o&&o[2]||"",i=l&&l!==t,a=cur.wallLayer&&cur.wallLayer===t,r=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+t):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+t),s=r.offsetHeight,n=0,E=0;e=i?wall._addDeepReply(_,l):wall._addRootReply(_);var d=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+t);return wall.incReplyCounter(d,1,_[13]),a?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(geByClass1("wl_replies_wrap",d)),cur.count++,cur.loaded++):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)("replies_wrap"+t),Wall.repliesSideSetup(t)),Wall.updateMentionsIndex(),e&&((0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_49__.updateNarrativeSnippetsFromQueueByPost)(e),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_50__.updateArticleSnippetsFromQueueByPost)(e),n=r.offsetHeight-s,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(e,a)[1]),[n,E]},_addDeepReply:function(_,e){var t,o=_[2],l=_[10]||"",i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(l),a=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"root-id")||e,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+a),s=r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",r),n=cur.wallLayer&&cur.wallLayer===o?wkcur:cur;if(s&&(a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"post-id"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+a)),!r)return null;var E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+a);if(!E){wall.addDeepRepliesBlock(a);var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+a);d&&hide(d),t=E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+a)}if(!E)return null;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("reply",E).length){var c=wall._addNewReplyShowMore(o,a,E,"replies_next_deep");t=t||c}else{var b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_short_deep"+a),p=wall.isDescRepliesOrder(o);if(b){var u=geByClass1("replies_short_text_count",b),P=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(u).replace(/[^0-9]/g,""))||0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(u,(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_replied_to_reply_count",P+1))}else{b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(n.wallTpl.reply_deep_short,{post_id:o,reply_id:a,reply_msg_id:a.split("_")[1],img_src:_[6]||"",name:_[5]||"",count:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("global_replied_to_reply_count",1)}));var D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(E);if(D)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(b,D),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(D,"replies_next_deep")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.toggleClass)(D,"replies_prev",p);else{E.appendChild(b);var m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(n.wallTpl.reply_deep_next,{post_id:o,reply_id:a,offset:0,count:1,text:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_next_n_replies",1),class:" replies_next_deep"+(p?" replies_prev":"")}));E.appendChild(m)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(s,"replies_deep_has_short"),t=b}return wall.updateCollapseDeepReplies(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.removeClass)(s,"replies_deep_empty_list"),t},_addRootReply:function(_){var e=_[2],t=cur.wallLayer&&cur.wallLayer===e,o=t?wkcur:cur,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domChildren)(l).length,a="full"===o.wallType,r=!i||i<3&&(t||a),s=wall.isDescRepliesOrder(e);if(r){var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.intval)(_[_.length-1]),E=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&n?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,d=Wall.getNewReplyHTML(_,E,!1,o);if(!d)throw new Error("Failed to add root reply");var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)(d);return(0,_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.nodeUpdated)(c),s&&l.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(c,l.firstChild):l.appendChild(c),c}return wall._addNewReplyShowMore(e,e,l,"replies_next_main",s)},_addNewReplyShowMore:function(_,e,t,o,l){var i,a,r=cur.wallLayer&&cur.wallLayer===_?wkcur:cur,s=r.options.replies_page_count||20,n=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domFC)(t):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domLC)(t);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(n,"replies_next"))return(i=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"count")||0)<s?(i++,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"count",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(n,l?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_prev_n_replies",i):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_next_n_replies",i))):l&&(a=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"offset")||0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(n,"offset",a+1)),n;if(l)a=0;else{var E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)(o,t),d=E[E.length-1],c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domChildren)(t);if(d){var b=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"count")||s,p=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(d,"offset")||0,u=c.indexOf(d);u=(u>=0?u:0)+1,a=p+b+c.slice(u).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"reply")})).length}else a=c.filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(_,"reply")})).length}var P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(r.wallTpl.reply_deep_next,{post_id:_,reply_id:e,offset:a,count:1,text:l?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_prev_n_replies",1):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_next_n_replies",1),class:" "+(l?" replies_prev":"")+(o?" "+o:"")}));return l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertBefore)(P,t.firstChild):t.appendChild(P),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.show)(P),P},removeDeepReply:function(_){var e=_[2],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+e),o=0,l=0;if(cur.wallMyDeleted[e]||!t)return[o,l];l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getXY)(t,cur.layerpost)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.revertLastInlineVideo)(t);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",t),a=i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(i,"post-id"):"",r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("replies_wrap_deep",t);if(r)o=-t.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.getSize)(r)[1]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(r,"replies_deep_empty_list"),wall.updateCollapseDeepReplies(e);else if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+e)){var s=cur.wallLayer&&cur.wallLayer===a?wkcur:cur,n=geByClass1("reply_date",t),E=geByClass1("reply_link_wrap",t),d="",c=attr(t,"onclick");c&&(d+=' onclick="'+c+'"');var b=e.split("_")[0],p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(b<0?s.wallTpl.reply_deleted_group:s.wallTpl.reply_deleted_user,{reply_id:e,date:n?n.innerHTML:"",answer:E?E.outerHTML:"",class:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"reply_replieable")?" reply_replieable":"",attr:d})),u=t.offsetHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domReplaceEl)(t,p),o=p.offsetHeight-u}else o=-t.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.re)(t);return cur.layerpost&&(cur.count--,cur.loaded--),i&&(wall.repliesSideSetup(a),wall.incReplyCounter(i,-1)),[o,l]},addDeepRepliesBlock:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post"+_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(e,"reply")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("wl_post",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("post",e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.hasClass)(t,"deep_active")){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(t,"post-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies_wrap_deep"+_),i=(cur.wallLayer?wkcur:cur).wallTpl;l||(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i.reply_deep,{post_id:o,reply_id:_,reply_msg_id:_.split("_")[1],text:"",offset:0,class:" replies_next_deep"})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domInsertAfter)(l,e));var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+_),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+_);if(!a&&!r){var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_fakebox"+o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("reply_box"+o),n=geByClass1("checkbox_official",s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.gpeByClass)("reply_fakebox_with_official",s),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i.reply_box,{post_id:_,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.clean)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"owner-name")||""),owner_photo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"owner-photo")||"",owner_href:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(s,"owner-href")||"",can_reply_as_group:n||"",class:n?" reply_fakebox_with_official":""}));l.appendChild(E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(l,"replies_deep_has_field")}}}},addReplyName:function(_,e){var t={};t[_]=e,wall.addReplyNames(t)},addReplyNames:function(_){var e=cur.wallLayer?wkcur:cur;e.options||(e.options={}),e.options.reply_names=extend({},e.options.reply_names,_)},getReplyNames:function(){return(cur.wallLayer?wkcur:cur).options.reply_names||{}},getReplyName:function(_){return cur.pvShown&&cur.pvReplyNames?cur.pvReplyNames[_]||[]:window.mvcur&&mvcur.mvShown&&!mvcur.minimized?mvcur.mvReplyNames[_]||[]:wall.getReplyNames()[_]||[]},showReorderRepliesTooltip:function(_,e){var t=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;if(!t["postRepliesReorderTT"+e]&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.data)(_,"ett")){var o,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domPN)(_);o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"hide-smart")||!1?t.wallTpl.replies_reorder_tooltip:t.wallTpl.replies_reorder_tooltip_with_smart;var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(o||"",{postId:e})),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("radiobtn",i),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"order")||"asc",s="post_replies_reorder"+e;radioBtns[s]={val:r,els:a},a.some((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"order")===r)return(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_40__.updatePostTooltipActionRadioBtn)(_,!0,s),!0}));var n=new ElementTooltip(_,{appendTo:l,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-10,0],content:i,align:"left"});t["postRepliesReorderTT"+e]=n,cur.destroy.push((function(){n&&n.destroy()})),n.show()}},reorderReplies:function(_,e,t){var o=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;t=t||"asc",(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_40__.updatePostTooltipActionRadioBtn)(_,t,"post_replies_reorder"+e);var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_replies_reorder"+e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"label")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(l,i),l.setAttribute("aria-label",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"order",t),o["postRepliesReorderTT"+e]&&o["postRepliesReorderTT"+e].hide(),wall.moreReplies(e,0,0,{deep:!0,clear:!0,order:t,onDone:function(_,t,o){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("replies"+e);if(o.count>o.offset+o.num){var i=cur.wallLayer&&cur.wallLayer===e?wkcur:cur,a=i.options.replies_page_count||20,r=Math.min(a,o.count-o.offset-o.num),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rs)(i.wallTpl.reply_deep_next,{post_id:e,reply_id:e,offset:o.offset+o.num,count:r,text:(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_next_n_replies",r),class:" replies_next_main"}));l.appendChild(s)}o.top_reply_ids&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(l,"top-ids",o.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[e]=1,wall.repliesSideSetup(e)}})},getRepliesOrder:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ge)("post_replies_reorder"+_);return(e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(e,"order"):"")||"asc"},isDescRepliesOrder:function(_,e){return"desc"===(e=e||wall.getRepliesOrder(_))},postEventChangeStatus:function(_,e,t,o){var l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"context");return stManager.add([jsc("web/groups.js")],(()=>{Groups.enter(_,e,t,l,((_,t,o)=>{var i=l.split("_"),a=!i[1],r=i[0]+"_"+(a?"decline":""),s=a?(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("events_snippet_will_participate_active"):(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("events_snippet_cant_participate_active");o=o||{},(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post_event_action_btn"+e).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.addClass)(_,"secondary"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(_,s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.domData)(_,"context",r)})),o.members&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("page_media_event"+e).forEach((_=>{var e=geByClass1("page_media_event_members",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.val)(e,o.members)}))}),{showProgress:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post_event_action_btn"+e).forEach((_=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockButton)(_)}))},hideProgress:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.geByClass)("post_event_action_btn"+e).forEach((_=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockButton)(_)}))}})})),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.cancelEvent)(o)},showEventFriends:function(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(_,{url:"/al_groups.php",params:{act:"a_event_friends_tt",owner_id:e},ajaxdt:100,showdt:400,hidedt:200,dir:"auto",noZIndex:!0,typeClass:"like_tt"})},showOrderTooltip:function(_){var e=geByClass1("post_replies_reorder");e&&(cur.orderFeatureTT=new ElementTooltip(e,{content:'<div class="feature_tooltip__close" onclick="cur.orderFeatureTT.hide();"></div>'+(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("wall_order_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip order_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[0,-4],onHide:()=>{ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"order_web"}),cur.orderFeatureTT.destroy(),delete cur.orderFeatureTT}}),cur.orderFeatureTT.show())},updateRepliesOnScroll:function(){cur.wallLayer?WkView.wallUpdateRepliesOnScroll():"full"===cur.wallType&&FullWall.onePostOnScroll()},updatePost:function(_,e,t,o,l,i,a){var r,s=_slicedToArray(e.split("_"),2),n=s[0],E=s[1];_&&n&&E&&ajax.post("al_wall.php",{act:"s_one",lang:"to_original"!==o?t:"",post_id:E,owner_id:n,render_context:l||"wall",ref:i||"",loc_context:a||"",only_post:!0},{onDone:_=>{Wall.sendTranslationClickStats(e,o,t);var l=Wall.domPost(e);if(l&&_){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ce)("div",{innerHTML:_});l.querySelector(".wall_text").innerHTML=i.querySelector(".wall_text").innerHTML}},onFail:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(_,{"pointer-events":null}),_.querySelector(".PostTranslationButton__text").innerText=r},showProgress:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.setStyle)(_,{"pointer-events":"none"}),r=_.querySelector(".PostTranslationButton__text").innerText,_.querySelector(".PostTranslationButton__text").innerText=(0,_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_47__.getLang)("pages_translation_translation_loading")}})},sendTranslationClickStats(_,e,t){(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_53__.saveStatlogEvents)({name:"translation_click",value:0,keys:[_,e,t]})},sendFakeNewsMark:function(_,e,t,o,l){var i="data-mark-exists",a={post_id:t,owner_id:o,mark:1===parseInt(_.getAttribute(i))?0:1,hash:l},r={onDone(e,t){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.showDoneBox)(e),_.innerHTML=t,_.setAttribute(i,a.mark)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_32__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.unlockActionsMenuItem)(_)};ajax.post(e,a,r)}};const __WEBPACK_DEFAULT_EXPORT__=Wall},47886:(_,e,t)=>{"use strict";t.d(e,{VISIBILITY_ACCESS_OPTIONS:()=>o});var o={PUBLIC:0,ONLY_FRIENDS:1,ONLY_BEST_FRIENDS:2}},550344:(_,e,t)=>{"use strict";t.d(e,{BestFriendsEventType:()=>o,sendBestFriendsAnalytic:()=>a});var o,l=t(986900),i=t(486353);function a(_,e){var t={event_type:_,nav_screen:e||window.cur.module};(0,i.partConfigEnabled)("best_friends_analytics_log")&&console.log(t),(0,l.statlogsValueEvent)("best_friends_product_analytic",t)}!function(_){_.addFriendsFromChat="add_friends_from_chat",_.clear="clear",_.moreChats="more_chats",_.selectFriendFromSearch="select_friend_from_search",_.selectChatFromSearch="select_chat_from_search",_.saveBestFriendsList="save_best_friends_list",_.updatePopupSave="update_popup_save",_.updatePopupCancel="update_popup_cancel",_.createPostFromPopupBest="create_post_from_popup_best",_.createPostFromPopupFriends="create_post_from_popup_friends",_.clickToLockFriends="click_to_lock_friends",_.clickToLockBestFriends="click_to_lock_best_friends",_.editBestFriendsFromPopup="edit_best_friends_from_popup",_.editBestFriends="edit_best_friends",_.selectBestFriends="select_best_friends",_.clickToBestFriendsEntrypoint="click_to_best_friends_entrypoint"}(o||(o={}))},452365:(_,e,t)=>{"use strict";t.d(e,{updateArticleSnippetsFromQueueByPost:()=>a});var o=t(611386),l=t(917999),i=t(486353);function a(_){if(window.vk.id&&(0,i.partConfigEnabled)("update_private_snippets_by_queue")){var e=Array.from(_.querySelectorAll(".article_snippet"));if(e.length){var t=[];e.forEach((function(_){if(window.vk.id&&_.dataset.needUpdate){var e=_.dataset.articleRawId;e&&t.push({article_raw_id:e,post_raw_id:_.dataset.postId,is_mini_snippet:(0,l.intval)(_.dataset.isMiniSnippet)})}})),t.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(t)},{onDone:function(_){e.forEach((function(e){e.dataset.articleRawId&&_[e.dataset.articleRawId]&&(e.outerHTML=_[e.dataset.articleRawId])}))},onFail:function(){return(0,o.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0}})}}}},924507:(_,e,t)=>{"use strict";t.d(e,{getPostTopicSelectorParams:()=>l.getPostTopicSelectorParams,isPostTopicEditingEnabled:()=>l.isPostTopicEditingEnabled,isPostTopicSettingEnabled:()=>l.isPostTopicSettingEnabled,topicUISelectorHide:()=>r.topicUISelectorHide,initPostTopicCreatingSelector:()=>n,initPostTopicEditingSelector:()=>E});var o=t(25180),l=t(24737),i=t(892814),a=t(415340),r=t(690969),s=function(_,e,t){var l=o.TopicUISelector.create(e,{linkId:_,selectTopicId:i.selectTopicId});if(l)return(0,i.initActionsParamsState)(_,l),l.selectTopicId(t[a.WallPostParams.topicId]),{clearSelection:function(){l.clearSelection()},onDestroy:function(){l.destroy()}}},n=function(_,e){var t;return s(_,e,((t={})[a.WallPostParams.topicId]=l.TOPIC_ID_NONE,t))},E=function(_,e,t){var o,i;return s(_,e,((o={})[a.WallPostParams.topicId]=null!==(i=t[a.WallPostParams.topicId])&&void 0!==i?i:l.TOPIC_ID_NONE,o))}},415340:(_,e,t)=>{"use strict";var o;t.d(e,{WallPostParams:()=>o}),function(_){_.topicId="topic_id"}(o||(o={}))},892814:(_,e,t)=>{"use strict";t.d(e,{getSelectorRegistry:()=>a,initActionsParamsState:()=>r,getActionParams:()=>s,selectTopicId:()=>E});var o=t(570655),l=t(415340),i=new Map,a=function(_){return i.get(_)},r=function(_,e){return function(_,e){return i.set(_,e)}(_,{actionParams:void 0,selector:e})},s=function(_){var e;return null===(e=i.get(_))||void 0===e?void 0:e.actionParams},n=function(_,e){!function(_,e){var t=i.get(_);void 0!==t&&i.set(_,e(t))}(_,(function(_){return(0,o.__assign)((0,o.__assign)({},_),{actionParams:e})}))},E=function(_,e){var t;n(_,((t={})[l.WallPostParams.topicId]=e,t))}},24737:(_,e,t)=>{"use strict";t.d(e,{TOPIC_ID_NONE:()=>i,getPostTopicSelectorParams:()=>a,isPostTopicSettingEnabled:()=>r,isPostTopicEditingEnabled:()=>s});var o=t(415340),l=t(892814),i=-1,a=function(_){var e,t,a=null===(t=(0,l.getActionParams)(_))||void 0===t?void 0:t[o.WallPostParams.topicId];return void 0!==a&&a!==i?((e={})[o.WallPostParams.topicId]=a,e):void 0},r=function(_){return!0===(null==_?void 0:_.wallPostTopicSettingEnabled)},s=function(_){return void 0!==_.topic_options}},25180:(_,e,t)=>{"use strict";t.d(e,{TopicUISelector:()=>d});var o=t(45150),l=t(414914),i=t(917685),a=t(690969),r=t(24737),s=t(917999),n=t(712459),E=t(97194),d=function(){function _(_,e,t,r){var s=this;this.btnEl=_,this.containerEl=e,this.options=t,this.selectorContentEl=r,this.onOptionClickWrapper=function(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];s.tooltip.hide();var t=_[0].currentTarget;if(t instanceof HTMLElement){var o=(0,n.getJsonDataValue)(t,"data-click-params");o&&s.selectTopicId(o.value)}},this.linkId=this.options.linkId,this.radioBtnId=(0,a.getTooltipId)(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:r.children},this.tooltip=new o.default(_,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:r,align:"left",onFirstTimeShow:function(){(0,l.show)(r)}}),(0,l.domQuery)('[data-onclick="togglePostTopic"]',e).forEach((function(_){(0,i.addEvent)(_,"click",s.onOptionClickWrapper)}))}return _.create=function(e,t){var o=(0,a.renderSelector)(e,t.linkId);if(o){var i=this.getSelectorContentEl(o),r=(0,l.domQuery1)(".post_action_btn_layout",o);if(i&&r)return new _(r,o,t,i)}},_.getSelectorContentEl=function(_){return(0,l.domQuery1)(".post_action_tt_content",_)},_.prototype.destroy=function(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]},_.prototype.tooltipHide=function(){this.tooltip.hide()},_.prototype.selectTopicId=function(_){this.options.selectTopicId(this.linkId,_),this.updateViewForSelectedTopic({isTopicSelected:_!==r.TOPIC_ID_NONE,topicId:_})},_.prototype.clearSelection=function(){this.selectTopicId(r.TOPIC_ID_NONE)},_.prototype.updateViewForSelectedTopic=function(e){var t=e.isTopicSelected,o=e.topicId,i=_.getSelectOptionEl(this.containerEl,o),r=i&&(0,n.getJsonDataValue)(i,"data-click-params"),d=(0,l.domQuery1)(".post_action_btn_text",this.containerEl);if(i&&r&&d){var c=r.label;(0,E.updatePostTooltipActionRadioBtn)(i,void 0,(0,a.getTooltipId)(this.options.linkId));var b=d.getAttribute("data-empty")||"",p=t?c:b;d.innerHTML=p,d.setAttribute("aria-label",(0,s.replaceEntities)(p)),(0,l.toggleClass)(this.containerEl,"on",t)}},_.getSelectOptionEl=function(_,e){return(0,l.domQuery1)('[data-value="'+e+'"]',_)},_}()},690969:(_,e,t)=>{"use strict";t.d(e,{getTooltipId:()=>a,renderSelector:()=>r,topicUISelectorHide:()=>s});var o=t(414914),l=t(442699),i=t(892814),a=function(_){return"post_discover_category_btn"+_},r=function(_,e){var t,i,a=(t={link_id:String(e)},(i=(0,l.getTemplate)("postCategorySelect",t))?(0,o.se)(i):null);if(_ instanceof HTMLElement&&a instanceof HTMLElement)return _.appendChild(a),a},s=function(_){var e,t;null===(t=null===(e=(0,i.getSelectorRegistry)(_))||void 0===e?void 0:e.selector)||void 0===t||t.tooltipHide()}},532453:(_,e,t)=>{"use strict";t.d(e,{parseReactWikiLinks:()=>i});var o=t(570655),l=t(667294);function i(_){var e=_.match(/\[(.*?)\]/g),t=e?e.map((function(_){return _.replace(/\[|(.*?)\]/g,"$1")})):[];if(!e||!t.length)return l.createElement(l.Fragment,null,_);var i=t.map((function(_,e){var t=(0,o.__read)(_.split("|"),2),i=t[0],a=t[1];return l.createElement("a",{href:i,key:e},a)})),a=[];return e.forEach((function(e,t){var o=_.indexOf(e);a.push(_.substr(0,o)),a.push(i[t]),_=_.slice(o+e.length)})),a.push(_),l.createElement(l.Fragment,null,a)}},408152:(_,e,t)=>{"use strict";t.d(e,{friendsRecommInit:()=>P,onViewFriendRecomm:()=>D,friendsRecommLogSave:()=>w,friendsRecommLogGet:()=>M,friendsRecommLogClear:()=>O,friendsRecommLogCheckVisited:()=>C,friendsRecommLogSend:()=>g,friendsRecommLogOnFail:()=>R,FriendsRecommendGlobals:()=>A});var o=t(414914),l=t(917685),i=t(791563),a=t(705456),r=t(651988),s=t(442699),n=t(304418),E=t(64385),d=t(116886),c=t(621260),b=t(488066),p=t(561393),u=function(){var _;return"feed"===window.cur.module&&window.Feed?null===(_=window.Feed)||void 0===_?void 0:_.getModuleRef():window.cur.module};function P(_,e){if(void 0===e&&(e={}),_){var t=(0,o.domData)(_,"from")||"user_rec",l=(0,o.domData)(_,"code"),i={scrollY:!1,onViewItem:function(_,o){var l;(null===(l=null==e?void 0:e.checkViewItem)||void 0===l?void 0:l.call(e,_))||D(_,o,t)}};(0,o.domData)(_,"next")&&(i.onLoadMore=function(){E.ajax.post("al_friends.php",{act:"a_recomm_friends_gallery",next:(0,o.domData)(_,"next"),track_code:l,friend_id:e.friendId||0,ref:u()},{onDone:function(e,t){var l,i=[];e&&(i=(0,o.domChildren)((0,o.ce)("div",{innerHTML:e}))),null===(l=(0,n.uiGetGallery)(_))||void 0===l||l.addMore(i,!t),(0,o.domData)(_,"next",t||null)}})}),new n.UIGallery(_,i)}}function D(_,e,t){if(!_.viewed&&(0,o.hasClass)(_,"ui_gallery_item")){var l=+(0,o.domData)(_,"uid"),i=u(),a=m(_);w(["show_user_rec",l,Date.now(),e,i,t,a]),_.viewed=!0}}function m(_){var e,t=(0,o.domData)(_,"code");return t||(e=(0,o.gpeByClass)("ui_gallery",_),t=(0,o.domData)(e,"code")),t||""}function w(_,e){void 0===e&&(e=!1);var t=M();t.push(_),r.default.set("friends_recomm",t),g(e)}function M(_,e,t){void 0===_&&(_=!1),void 0===t&&(t=!1);var o=r.default.get("friends_recomm"),l=Array.isArray(o)?o:[];return e&&(l=l.filter((function(_){return(t?_[1]!==e:_[1]===e)&&(0,s.inArray)(_[0],["show_user_rec","open_user"])}))),_&&(l=l.map((function(_){return _.join("|")}))),l}function O(_){if(_){var e=M(!1,_,!0);e.length?r.default.set("friends_recomm",e):r.default.remove("friends_recomm")}else r.default.remove("friends_recomm");!function(_){if(_){var e=r.default.get("friends_recomm_visited")||{};delete e[_],r.default.set("friends_recomm_visited",e)}else r.default.remove("friends_recomm_visited")}(_)}function C(_){return(r.default.get("friends_recomm_visited")||{})[_]}function g(_){var e,t;void 0===_&&(_=!1),!(null===(e=window.cur)||void 0===e?void 0:e.friendsRecommLogIdle)&&(null===(t=null===window||void 0===window?void 0:window.curNotifier)||void 0===t?void 0:t.idle_manager)&&(Array.isArray(window.cur.onIdle)||(window.cur.onIdle=[]),Array.isArray(window.cur.onUnidle)||(window.cur.onUnidle=[]),window.cur.friendsRecommLogIdle=function(){clearTimeout(window.cur.friendsRecommLog)},window.cur.onIdle.push(window.cur.friendsRecommLogIdle),window.cur.onUnidle.push(g)),clearTimeout(window.cur.friendsRecommLog),_?T():window.cur.friendsRecommLog=window.setTimeout(T,1e4)}function T(){if(!window.cur.friendsRecommProcess){var _=M(!0);_.length&&(window.cur.friendsRecommProcess=!0,O(),E.ajax.post("al_friends.php",{act:"a_recomm_logs",logs:_},{onDone:function(){delete window.cur.friendsRecommProcess},onFail:function(){return R(_),delete window.cur.friendsRecommProcess,!0}}))}}function R(_){var e=M();e=_.map((function(_){return _.split("|")})).concat(e),r.default.set("friends_recomm",e)}var A={toggleRecommFriend:function(_,e,t){var r=(0,o.gpeByClass)("friend_recomm_card",_),s=r&&+(0,o.domData)(r,"uid");if(s){var n={act:"add",mid:s,hash:t,from:"user_rec",ref:u(),track_code:m(r),ts:Date.now()},P=M(!0,s);return P.length&&(O(s),n.logs=P),E.ajax.post("al_friends.php",n,{onDone:function(e,t){if((0,o.val)(_,e),(0,o.addClass)(_,"secondary"),(0,a.disableButton)(_,!0),(0,o.addClass)(r,"friend_recomm_card_accepted"),(0,o.re)((0,o.geByClass1)("wall_card_text_special",r)),(0,b.isFriendAddResultRequestSent)(t)&&t.friend_request_add_sent_message_nudge){var i=e;(0,c.showDoneBoxFull)("",{},{tooltipHandler:(s=t.friend_request_entrypoint,function(_,e){var t=e.hide;(0,l.addEvent)(_.querySelector('[data-section-ref="friend_request_notification_send_message"]'),"click",(function(_){var e;if(_.currentTarget instanceof HTMLElement){var o=parseInt(null!==(e=_.currentTarget.getAttribute("data-message-user-id"))&&void 0!==e?e:"");if(!o||(0,l.checkEvent)(_))return!0;t(),(0,p.showWriteMessageBox)(_,o,{params:{box_custom_entrypoint:s}})}}))}),text:t.friend_request_add_sent_message_nudge,title:i})}var s},onFail:function(_){if(P&&R(P),_)return(0,i.showFastBox)((0,d.getLang)("global_error"),_),!0},showProgress:function(){return(0,a.lockButton)(_)},hideProgress:function(){return(0,a.unlockButton)(_)}}),(0,l.cancelEvent)(e),!1}},hideRecommFriend:function(_,e,t){var r=(0,o.gpeByClass)("friend_recomm_card",_),s=r&&+(0,o.domData)(r,"uid");if(s){var c=(0,o.gpeByClass)("ui_gallery",_),b=u(),p=(0,o.domData)(r,"code")||(0,o.domData)(c,"code")||"";return E.ajax.post("al_friends.php",{act:"hide_possible",mid:s,ref:b,track_code:p,hash:t},{onDone:function(){var e=(0,n.uiGetGallery)((0,o.gpeByClass)("ui_gallery",_));if(e){var t=(0,o.gpeByClass)("ui_gallery_item",_);e.removeItem(t)}},onFail:function(_){if(_)return(0,i.showFastBox)((0,d.getLang)("global_error"),_),!0},showProgress:function(){return(0,a.lockButton)(_)},hideProgress:function(){return(0,a.unlockButton)(_)}}),(0,l.cancelEvent)(e),!1}},onClickRecommFriend:function(_){if((0,o.hasClass)(_,"ui_gallery_item")||(_=(0,o.gpeByClass)("ui_gallery_item",_)),_){var e=+(0,o.domData)(_,"uid"),t=u(),l=m(_);!function(_,e,t){var o=r.default.get("friends_recomm_visited")||{};o[_]={ref:e,trackCode:t},r.default.set("friends_recomm_visited",o)}(e,t,l),w(["open_user",e,Date.now(),t,l])}}}},488066:(_,e,t)=>{"use strict";t.d(e,{isFriendAddResultRequestSent:()=>i});var o,l=t(917999);!function(_){_[_.DELETED_USER=-5]="DELETED_USER",_[_.BLACKLISTED=-4]="BLACKLISTED",_[_.FRIENDS_COUNT_EXCEEDED=-3]="FRIENDS_COUNT_EXCEEDED",_[_.FLOOD_CONTROL=-2]="FLOOD_CONTROL",_[_.SERVER_ERROR=-1]="SERVER_ERROR",_[_.NOT_FRIENDS=0]="NOT_FRIENDS",_[_.REQUEST_FROM_USER=1]="REQUEST_FROM_USER",_[_.REQUEST_TO_USER=2]="REQUEST_TO_USER",_[_.ARE_FRIENDS=3]="ARE_FRIENDS"}(o||(o={}));var i=function(_){if((0,l.isObject)(_)){var e=_;return(null==e?void 0:e.result_code)===o.REQUEST_FROM_USER}return!1}},647796:(_,e,t)=>{"use strict";t.d(e,{FriendsRecommendGlobals:()=>o.FriendsRecommendGlobals});var o=t(408152)},513349:(_,e,t)=>{"use strict";t.d(e,{getNavigableTabs:()=>l,showHiddenNavigableTabs:()=>i});var o=t(414914),l=function(_){var e=document.querySelector("#wall_tabs");return e?Array.from(e.querySelectorAll(".ui_tab")).filter((function(e){var t=e.parentNode;return null!==t&&t!==_&&!(0,o.hasClass)(t,"unshown")&&!(0,o.matchesSelector)(t,'[data-ui-tab="no_posts"]')})):[]},i=function(){var _=document.querySelector("#wall_tabs"),e=null==_?void 0:_.querySelector(".page_wall_no_posts");null==e||e.remove(),(0,o.removeClass)(document.querySelector("#wall_tabs"),"page_tabs_hidden")}},885682:(_,e,t)=>{"use strict";t.d(e,{getReactionsButtonPostTemplate:()=>d,getReactionsButtonReplyTemplate:()=>c,likeDataReactionsFields:()=>u});var o=t(486353),l=t(414914),i=t(431700),a=t(353417),r=t(754),s=t(457700),n=function(_,e){var t,i=null===(t=function(_){try{var e=JSON.parse(_);if(null!==e&&"object"!=typeof e)return;return e}catch(_){return}}(_))||void 0===t?void 0:t.set_id,s="string"==typeof i?i:void 0;if((0,o.partConfigEnabled)("reactions_enabled")&&e&&s){var n=(0,a.getReactionSet)(s);if(n)return{likeClassName:"like_btn--hidden PostBottomAction--hidden",template:(0,l.rs)(e,{reactions_button_title:(0,r.getDefaultReactionTitle)(n)||"",reactions_set_id:s})}}},E=function(_,e){return e.length>_},d=function(_,e){var t,o=null===(t=null==e?void 0:e.wallTpl)||void 0===t?void 0:t.post_likes_reactions,l=E(14,_)?_[14]:void 0;if("string"==typeof l)return n(l,o)},c=function(_,e){var t,l=null===(t=null==e?void 0:e.wallTpl)||void 0===t?void 0:t.reply_likes_reactions;if((0,o.partConfigEnabled)("reactions_enabled_post_replies")){var i=E(14,_)?_[14]:void 0;if("string"==typeof i)return n(i,l)}},b=function(_){var e=JSON.parse(_);if(null===e||"object"==typeof e||Array.isArray(e)){var t;if(Array.isArray(e))e=(0,s.reactionCountsBrandWrap)((t=e,Object.assign(Object.create(null),t)));return e}},p=function(_){if((0,o.partConfigEnabled)("reactions_enabled")){var e=E(5,_)?_[5]:void 0;if("string"==typeof e){var t=function(_){var e=_.indexOf(";"),t=_.substr(0,e),o=_.substr(e+1);if("1"===t)return b(o)}(e);if(t)return{counts:t}}}},u=function(_){var e,t=p(_);return(e={})[i.REACTIONS_COUNTS_RESPONSE_FIELD]=null==t?void 0:t.counts,e}},129601:(_,e,t)=>{"use strict";t.d(e,{ReportReasonCategorySelector:()=>a});var o=t(570655),l=t(667294),i=t(540249),a=function(_){function e(){return null!==_&&_.apply(this,arguments)||this}return(0,o.__extends)(e,_),e.prototype.renderCategory=function(_,e){var t=this;return l.createElement("div",{className:"ReportReasonCategorySelector__category",key:_.label,onClick:function(){return t.props.onCategorySelect(e)}},l.createElement("div",{className:"ReportReasonCategorySelector__categoryLabel"},_.label),l.createElement(i.default,{className:"ReportReasonCategorySelector__categoryArrow"}))},e.prototype.render=function(){var _=this;return l.createElement("div",{className:"ReportReasonCategorySelector"},this.props.categories.map((function(e,t){return _.renderCategory(e,t)})))},e}(l.Component)},623475:(_,e,t)=>{"use strict";t.d(e,{ReportReasonSelector:()=>r});var o=t(570655),l=t(667294),i=t(62738),a=t(659397),r=function(_){function e(){return null!==_&&_.apply(this,arguments)||this}return(0,o.__extends)(e,_),e.prototype.renderReason=function(_){var e=this;return l.createElement(i.default,{className:"ReportReasonSelector__reason",key:_.id,checked:this.props.selectedReasonId===_.id,onChange:function(){return e.props.onReasonSelect(_)}},l.createElement("div",{className:"ReportReasonSelector__reasonInformation"},l.createElement("div",{className:"ReportReasonSelector__reasonLabel"},_.label),_.description&&l.createElement("div",{className:"ReportReasonSelector__reasonDescription"},_.description)))},e.prototype.render=function(){var _=this;return l.createElement("div",{className:(0,a.classNames)("ReportReasonSelector",this.props.className)},this.props.reasons.map((function(e){return _.renderReason(e)})))},e}(l.Component)},228314:(_,e,t)=>{"use strict";t.d(e,{ReportForm:()=>T});var o,l=t(570655),i=t(667294),a=t(40897),r=t(41437),s=t(148434),n=t(519921),E=t(492867),d=t(733024),c=t(225154),b=t(262643),p=t(532453),u=t(496495),P=t(423558),D=t(881150),m=t(595775),w=t(244809),M=t(996030),O=t(659397),C=t(129601),g=t(623475);!function(_){_.InitialLoading="initialLoading",_.ReportCategorySelection="reportCategorySelection",_.ReportComposition="reportComposition",_.AfterSubmit="afterSubmit",_.Error="error"}(o||(o={}));var T=function(_){function e(e){var t=_.call(this,e)||this,l={header:"",more:"",reason_categories:[],snippet:void 0,after_submit_actions:void 0,profiles:void 0,groups:void 0};return t.state={stage:o.InitialLoading,data:l,submitButtonLoading:!1,loadingAfterSubmitActions:{blacklist:!1},commentError:"",submitError:"",reasonCategoryId:void 0,reasonId:void 0,comment:""},t}return(0,l.__extends)(e,_),e.destroy=function(){(0,a.destroyComponentInBox)()},e.prototype.componentDidMount=function(){this.loadInitialData()},e.prototype.loadInitialData=function(){var _=this;(0,b.api)("reports.getReportFormData",{source:this.props.reportSource,source_owner_id:this.props.reportSourceOwnerId,source_id:this.props.reportSourceId,fields:"blacklisted_by_me,is_hidden_from_feed"}).then((function(e){return _.setState({stage:o.ReportCategorySelection,data:e})})).catch((function(){return _.switchToErrorStage("Load initial data promise rejected")}))},e.prototype.submit=function(){var _=this;this.isSubmitEnabled()?(this.setState({submitButtonLoading:!0,submitError:""}),(0,b.api)("reports.add",{type:this.props.reportSource,owner_id:this.props.reportSourceOwnerId,item_id:this.props.reportSourceId,reason:this.state.reasonId,comment:this.state.comment||void 0}).then((function(){_.setState({stage:o.AfterSubmit}),_.props.onSubmit&&_.props.onSubmit()})).catch((function(e){var t=e&&e.error&&e.error.error_text?e.error.error_text:(0,r.getLang)("global_unknown_error");_.setState({submitError:t}),(0,n.debugLog)("submit error happened",e)})).finally((function(){_.setState({submitButtonLoading:!1})}))):(0,n.debugLog)("Unable to submit form because submit is not enabled yet")},e.prototype.isSubmitEnabled=function(){var _;if(this.state.submitButtonLoading)return!1;if(void 0===this.state.reasonCategoryId)return!1;if(void 0===this.state.reasonId)return!1;var e=this.state.data.reason_categories[this.state.reasonCategoryId];if(null===(_=null==e?void 0:e.comment_field)||void 0===_?void 0:_.is_required){if(""===this.state.comment)return!1;if(""!==this.state.commentError)return!1}return!0},e.prototype.switchToErrorStage=function(_){(0,n.debugLog)("report form error: "+_),this.setState({stage:o.Error})},e.prototype.moveToPreviousStage=function(){this.state.submitButtonLoading?(0,n.debugLog)("Unable to move to previous stage if form submits something right now"):this.state.stage===o.ReportComposition?this.setState({stage:o.ReportCategorySelection,reasonCategoryId:void 0,reasonId:void 0,comment:"",commentError:"",submitError:""}):this.switchToErrorStage('Unable to move to previous stage from the current stage (not "report composition")')},e.isVkDomainLink=function(_){return null!==new RegExp("^(?:(?:http|https)://)?.*vk.com/.*$","g").exec(_)},e.parsePostLink=function(_){var e=new RegExp("^(?:(?:http|https)://)?.*vk.com/.*wall(-?\\d+)_(\\d+).*$","g").exec(_);return null===e?null:{ownerId:Number(e[1]),id:Number(e[2])}},e.shortenActionName=function(_){switch(_){case"blacklist":return"bl"}},e.prototype.getAfterSubmitAction=function(_){var t,o,l=this;if(null===(o=null===(t=this.state.data)||void 0===t?void 0:t.snippet)||void 0===o?void 0:o.author_id){var i=this.state.data.snippet.author_id,a=e.shortenActionName(_),s=(0,r.getLang)("reports_report_form_after_submit_action_"+a+"_perform"),E=(0,r.getLang)("reports_report_form_after_submit_action_"+a+"_performed");switch(_){case"blacklist":return{performLabel:s,performedLabel:E,isPerformed:function(){var _;return 1===(null===(_=l.state.data)||void 0===_?void 0:_.profiles)[0].blacklisted_by_me},perform:function(){return(0,b.api)("account.ban",{user_id:i})},cancel:function(){return(0,b.api)("account.unban",{user_id:i})},toggleStateAfterUpdate:function(){var _=l.state.data;_.profiles&&(_.profiles[0].blacklisted_by_me=_.profiles[0].blacklisted_by_me?0:1,l.setState({data:_}))}};default:return void(0,n.debugLog)("undefined after submit action name")}}},e.prototype.isAfterSubmitActionLoading=function(_){return this.state.loadingAfterSubmitActions[_]},e.prototype.updateAfterSubmitActionLoading=function(_,e){var t=this.state.loadingAfterSubmitActions;t[_]=e,this.setState({loadingAfterSubmitActions:t})},e.prototype.updateLinkComment=function(_){var t="";""!==_&&(e.isVkDomainLink(_)?null===e.parsePostLink(_)&&(t=(0,r.getLang)("reports_report_form_not_post_link")):t=(0,r.getLang)("reports_report_form_not_internal_link")),this.setState({comment:_,commentError:t})},e.prototype.selectReasonCategory=function(_){var e=this.state.data.reason_categories[_].reasons;this.setState({stage:o.ReportComposition,reasonCategoryId:_,reasonId:1===e.length?e[0].id:void 0})},e.prototype.selectReason=function(_){_.redirect_url?window.nav.go(_.redirect_url):this.setState({reasonId:_.id})},e.prototype.renderBottomButtons=function(){var _=this;return i.createElement("div",{className:"ReportForm__bottomButtons box_controls"},i.createElement(D.default,{appearance:"tertiary",className:"ReportForm__cancelButton",onClick:function(){return e.destroy()}},(0,r.getLang)("global_cancel")),i.createElement(P.default,{appearance:"primary",className:"ReportForm__submitButton",loading:this.state.submitButtonLoading,disabled:!this.isSubmitEnabled(),onClick:function(){return _.submit()}},(0,r.getLang)("reports_form_send_report")))},e.prototype.renderMoveBackHeader=function(){var _=this,t=i.createElement("div",{className:"ReportForm__headerMoveBackButton",onClick:function(){return _.moveToPreviousStage()}},i.createElement(E.default,{className:"ReportForm__headerMoveBackIcon"}),i.createElement("div",{className:"ReportForm__headerMoveBackLabel"},(0,r.getLang)("reports_report_form_get_back")));return e.renderHeader(t)},e.prototype.renderSingleReasonReasonsCategory=function(){if(void 0===this.state.reasonCategoryId)return e.renderErrorBlock();var _=this.state.data.reason_categories[this.state.reasonCategoryId];return _.comment_field?_.reasons[0].id===u.ReportReasonIds.NotOriginalContent?this.renderNotOriginalContentSubReasonBody():i.createElement("div",{className:"ReportForm__singleReasonTextWithComment"},i.createElement("div",{className:"ReportForm__singleReasonText"},_.reasons[0].description),this.renderComment()):i.createElement("div",{className:"ReportForm__singleReasonText"},_.reasons[0].description)},e.prototype.renderNotOriginalContentSubReasonBody=function(){var _=this;if(void 0===this.state.reasonCategoryId)return e.renderErrorBlock();var t=this.state.data.reason_categories[this.state.reasonCategoryId],o=this.state.commentError?this.state.commentError:t.reasons[0].description;return i.createElement("div",{className:(0,O.classNames)("ReportForm__singleReasonTextWithComment",{"ReportForm__singleReasonTextWithComment--error":!!this.state.commentError})},i.createElement(m.default,{className:"ReportForm__linkInput",onChange:function(e){return _.updateLinkComment(e.target.value)},value:this.state.comment,placeholder:(0,r.getLang)("reports_report_form_input_a_link")}),i.createElement("div",{className:"ReportForm__commentNotice"},o))},e.prototype.renderMultipleReasonsReasonCategory=function(){var _=this;if(void 0===this.state.reasonCategoryId)return e.renderErrorBlock();var t=this.state.data.reason_categories[this.state.reasonCategoryId];return i.createElement("div",null,i.createElement(g.ReportReasonSelector,{reasons:t.reasons,selectedReasonId:this.state.reasonId,onReasonSelect:function(e){return _.selectReason(e)}}),t.comment_field&&this.renderComment())},e.prototype.renderComment=function(){var _,t,o=this;if(void 0===this.state.reasonCategoryId)return e.renderErrorBlock();var l=this.state.data.reason_categories[this.state.reasonCategoryId];return i.createElement("div",{className:"ReportForm__singleReasonTextWithComment"},i.createElement("div",{className:"ReportForm__commentLabel"},i.createElement("div",{className:"ReportForm__commentMainText"},(0,r.getLang)("reports_report_form_comment")),!(null===(_=l.comment_field)||void 0===_?void 0:_.is_required)&&i.createElement("div",{className:"ReportForm__commentNotRequired"},"(",(0,r.getLang)("reports_report_form_comment_is_not_necessary"),")")),i.createElement(w.default,{className:"ReportForm__commentInput",onChange:function(_){return o.setState({comment:_.target.value})},placeholder:null===(t=l.comment_field)||void 0===t?void 0:t.placeholder,value:this.state.comment}))},e.prototype.renderAfterSubmitActions=function(){var _=this;if(!this.state.data.after_submit_actions)return"";var e=this.state.data.after_submit_actions.map((function(e){return _.renderAfterSubmitAction(e)})).filter((function(_){return""!==_}));return e&&0!==e.length?i.createElement("div",{className:"ReportForm__afterSubmitActionsBlock"},i.createElement("div",{className:"ReportForm__afterSubmitActionsLabel"},(0,r.getLang)("reports_report_form_additional_actions")),i.createElement("div",{className:"ReportForm__afterSubmitActions"},e)):""},e.prototype.renderAfterSubmitAction=function(_){var e=this,t=this.getAfterSubmitAction(_);if(!t)return"";var o=t.isPerformed()?t.performedLabel:t.performLabel;return i.createElement("div",{className:(0,O.classNames)("ReportForm__afterSubmitAction",{"ReportForm__afterSubmitAction--performed":t.isPerformed()}),key:_,onClick:function(){t.isPerformed()||e.isAfterSubmitActionLoading(_)||(e.updateAfterSubmitActionLoading(_,!0),t.perform().then((function(){return t.toggleStateAfterUpdate()})).catch((function(){return(0,n.debugLog)("Error happened in onPerformAction")})).finally((function(){return e.updateAfterSubmitActionLoading(_,!1)})))}},i.createElement("div",{className:"ReportForm__afterSubmitActionLabel"},o),t.isPerformed()&&i.createElement(i.Fragment,null,i.createElement("div",{className:"ReportForm__afterSubmitActionBeforeCancelSeparator"},"·"),i.createElement("div",{className:"ReportForm__cancelAfterSubmitActionButton",onClick:function(){t.isPerformed()&&(e.isAfterSubmitActionLoading(_)||(e.updateAfterSubmitActionLoading(_,!0),t.cancel().then((function(){return t.toggleStateAfterUpdate()})).catch((function(){return(0,n.debugLog)("Error happened in onCancelAction")})).finally((function(){return e.updateAfterSubmitActionLoading(_,!1)}))))}},"Отмена")))},e.renderHeader=function(_){return void 0===_&&(_=(0,r.getLang)("reports_report_form_header")),i.createElement("div",{className:"ReportForm__header box_title_wrap box_grey"},i.createElement("div",{className:"box_x_button",role:"button",onClick:function(){return e.destroy()}}),i.createElement("div",{className:"box_title"},_))},e.renderContent=function(_){return i.createElement("div",{className:"ReportForm__content box_body clear_fix"},_)},e.renderErrorBlock=function(){return i.createElement(i.Fragment,null,"error")},e.prototype.renderAfterSubmitStage=function(){var _=i.createElement(i.Fragment,null,i.createElement(d.default,{className:"ReportForm__afterSubmitCloseButton",onClick:function(){return e.destroy()}}),i.createElement(c.default,{className:"ReportForm__successfulSubmitIcon"}),i.createElement("div",{className:"ReportForm__thankYou"},(0,r.getLang)("reports_report_form_thank_you")),i.createElement("div",{className:"ReportForm__submitResultDescription"},(0,r.getLang)("reports_report_form_submit_result")),this.renderAfterSubmitActions());return i.createElement(i.Fragment,null,e.renderContent(_))},e.prototype.renderReportCompositionStage=function(){if(void 0===this.state.reasonCategoryId)return e.renderErrorBlock();var _=this.state.data.reason_categories[this.state.reasonCategoryId],t=i.createElement(i.Fragment,null,this.state.submitError&&i.createElement("div",{className:"ReportForm__submitError"},this.state.submitError),this.state.data.snippet&&i.createElement(M.ReportFormSnippet,{snippet:this.state.data.snippet}),i.createElement("div",{className:"ReportForm__categoryHeader"},_.explanation),1===_.reasons.length?this.renderSingleReasonReasonsCategory():this.renderMultipleReasonsReasonCategory(),_.more&&i.createElement("div",{className:"ReportForm__more"},(0,p.parseReactWikiLinks)(_.more)));return i.createElement(i.Fragment,null,this.renderMoveBackHeader(),e.renderContent(t),this.renderBottomButtons())},e.prototype.renderReportCategorySelectionStage=function(){var _=this,t=i.createElement(i.Fragment,null,this.state.data.snippet&&i.createElement(M.ReportFormSnippet,{snippet:this.state.data.snippet}),i.createElement("div",{className:"ReportForm__categorySelectionHeader"},this.state.data.header),i.createElement(C.ReportReasonCategorySelector,{categories:this.state.data.reason_categories,onCategorySelect:function(e){return _.selectReasonCategory(e)}}),i.createElement("div",{className:"ReportForm__more"},(0,p.parseReactWikiLinks)(this.state.data.more)));return i.createElement(i.Fragment,null,e.renderHeader(),e.renderContent(t))},e.renderErrorStage=function(){return i.createElement(i.Fragment,null,e.renderHeader(),e.renderContent((0,r.getLang)("reports_report_form_error")))},e.renderInitialLoadingStage=function(){return i.createElement(i.Fragment,null,e.renderHeader(),e.renderContent(i.createElement(s.default,null)))},e.prototype.render=function(){var _;switch(this.state.stage){case o.InitialLoading:_=e.renderInitialLoadingStage();break;case o.ReportCategorySelection:_=this.renderReportCategorySelectionStage();break;case o.ReportComposition:_=this.renderReportCompositionStage();break;case o.AfterSubmit:_=this.renderAfterSubmitStage();break;case o.Error:default:_=e.renderErrorStage()}return i.createElement("div",{className:(0,O.classNames)("ReportForm",{initialLoading:"ReportForm--initialLoadingStage",reportCategorySelection:"ReportForm--reportCategorySelectionStage",reportComposition:"ReportForm--reportCompositionStage",afterSubmit:"ReportForm--afterSubmitStage",error:"ReportForm--errorStage"}[this.state.stage])},_)},e}(i.Component)},996030:(_,e,t)=>{"use strict";t.d(e,{ReportFormSnippet:()=>L});var o=t(570655),l=t(667294),i=t(599149),a=t(458819),r=t(824245),s=t(182285),n=t(445098),E=t(784977),d=t(342577),c=t(586430),b=t(741774),p=t(663185),u=t(430811),P=t(739124),D=t(671539),m=t(665599),w=t(337227),M=t(317152),O=t(411415),C=t(532453),g=t(442699),T=t(116886),R=t(41437),A=t(659397),L=function(_){function e(){return null!==_&&_.apply(this,arguments)||this}return(0,o.__extends)(e,_),e.prototype.renderAttachmentPreview=function(){var _=this.props.snippet.attachment_preview;return _?0==_.sizes.length?this.renderDefaultReportFormAttachmentPreview():l.createElement("div",{className:"ReportFormSnippet__attachmentPreviewWrap"},l.createElement("img",{className:"ReportFormSnippet__attachmentPreview",src:_.sizes[0].url,alt:""}),_.can_play&&l.createElement(i.default,{className:"ReportFormSnippet__attachmentPreviewPlayButton"})):""},e.prototype.renderDefaultReportFormAttachmentPreview=function(){var _,e=this.props.snippet.attachment_preview;if(!e)return"";switch(e.type){case"app":_=a.default;break;case"article":_=r.default;break;case"audio":_=s.default;break;case"market":_=n.default;break;case"photo":_=E.default;break;case"album":_=d.default;break;case"video":_=c.default;break;case"poll":case"board_poll":_=b.default;break;case"story":_=p.default;break;case"narrative":_=u.default;break;case"live_comment":case"market_comment":case"photo_comment":case"topic_comment":case"comment":case"video_comment":case"wall_comment":_=P.default;break;case"post":case"situational_post":case"wall":_=D.default;break;case"textlive":case"textpost":_=m.default;break;case"link":_=w.default;break;case"sticker":_=M.default;break;default:_=O.default}return l.createElement("div",{className:"ReportFormSnippet__attachmentPreview ReportFormSnippet__attachmentPreview--default"},l.createElement(_,{className:"ReportFormSnippet__defaultAttachmentPreviewIcon"}))},e.prototype.renderNotContentSnippet=function(_,e){return l.createElement(l.Fragment,null,l.createElement("div",{className:"ReportFormSnippet__left"},l.createElement("div",{className:"ReportFormSnippet__name"},this.props.snippet.name),e),l.createElement("img",{className:"ReportFormSnippet__image",src:_,alt:"snippet_image"}))},e.prototype.renderContentSnippet=function(_,e){var t=(0,T.langDate)(1e3*this.props.snippet.date,(0,R.getLang)("global_short_date_time","raw"),0,(0,R.getLang)("months_sm_of","raw"));return l.createElement(l.Fragment,null,l.createElement("div",{className:"ReportFormSnippet__metaInfo"},l.createElement("img",{className:"ReportFormSnippet__authorAvatar",src:_,alt:"snippet_image"}),l.createElement("div",{className:"ReportFormSnippet__authorName"},this.props.snippet.name),l.createElement("div",{className:"ReportFormSnippet__date"},t)),l.createElement("div",{className:"ReportFormSnippet__content"},e,this.renderAttachmentPreview()))},e.prototype.render=function(){var _,e=l.createElement("div",{className:"ReportFormSnippet__text"},(0,C.parseReactWikiLinks)(this.props.snippet.text)),t=(0,g.isRetina)()?this.props.snippet.photo.big:this.props.snippet.photo.medium;_="content"===this.props.snippet.type?this.renderContentSnippet(t,e):this.renderNotContentSnippet(t,e);return l.createElement("div",{className:(0,A.classNames)("ReportFormSnippet",{user:"ReportFormSnippet--user",community:"ReportFormSnippet--community",app:"ReportFormSnippet--app",game:"ReportFormSnippet--game",content:"ReportFormSnippet--content"}[this.props.snippet.type])},_)},e}(l.Component)},496495:(_,e,t)=>{"use strict";t.d(e,{ReportReasonIds:()=>d,showReportForm:()=>b,afterCommentReportSubmit:()=>p});var o=t(228314),l=t(40897),i=t(667294),a=t(519921),r=t(116886),s=t(848366),n=t(262643),E=t(873050);(0,s.makeAuthAndApiGlobal)();var d,c=window.vk;function b(_,e,t,a,r){var s=i.createElement(o.ReportForm,{reportSource:_,reportSourceOwnerId:e,reportSourceId:t,onSubmit:a}),n={onDestroy:r};(0,l.showComponentInBox)(s,n)}function p(_,e,t){var o=function(_,e,t){switch(_){case"photo":return"#post"+e+"photo_"+t;case"video":return"#post"+e+"video_"+t+"mv";case"market":return"#post"+e+"market_"+t}}(_,e,t);if("photo"===_){var l=document.querySelector(o+" .dld");null!==l&&(l.outerHTML="")}var i=document.querySelector(o+" .reply_wrap");null!==i?(i.style.display="none",i.outerHTML+='<div class="dld">'+(0,r.getLang)("global_report_sent")+"</div>"):(0,a.debugLog)("Unable to hide report button for "+_+" comment")}(0,n.setLoginConfig)({onCaptcha:E.handleCaptcha,domain:c.apiConfigDomains.loginDomain}),(0,n.setApiConfig)({onCaptcha:E.handleCaptcha,domain:c.apiConfigDomains.apiDomain}),function(_){_[_.NotOriginalContent=28]="NotOriginalContent"}(d||(d={}))},816662:(_,e,t)=>{"use strict";t.d(e,{scrollOutsideFixedReplyArea:()=>i});var o=t(414914),l=t(776442),i=function(_,e){if(_ instanceof HTMLElement&&e instanceof HTMLElement){var t="fixed"===(0,o.getStyle)(e,"position"),i=void 0!==window.cur.wallLayer;if(t){var a=_.getBoundingClientRect(),r=20-(e.getBoundingClientRect().top-a.bottom);r>0&&(0,l.scrollActiveAreaToYDelta)(r)}else{if(i)return;var s=e.closest(".replies_wrap");s&&function(_){var e=(0,o.clientHeight)();if(_.getBoundingClientRect().bottom>e){var t=(0,o.getXY)(_)[1]+(0,o.getH)(_)-e;(0,l.setActiveAreaScroll)(t)}}(s)}}}},588842:(_,e,t)=>{"use strict";t.d(e,{getFixedReplyField:()=>o});var o=function(){var _,e;return window.cur.wallLayer?null!==(_=document.getElementById("wl_reply_form"))&&void 0!==_?_:void 0:"full"===window.cur.wallType&&null!==(e=document.querySelector("#reply_box_wrap"+window.cur.oid+"_"+window.cur.pid+" .reply_box_inner_wrap"))&&void 0!==e?e:void 0}},828190:(_,e,t)=>{"use strict";t.d(e,{wallPostRenderInit:()=>l});var o=t(529821),l=function(){(0,o.postRenderReactionsInit)()}},776442:(_,e,t)=>{"use strict";t.d(e,{setActiveAreaScroll:()=>l,scrollActiveAreaToYDelta:()=>i});var o=t(927663),l=function(_){window.cur.wallLayer?window.wkLayerWrap&&(window.wkLayerWrap.scrollTop=_):(0,o.scrollToY)(_,0,!1,!0)},i=function(_){var e,t;l((window.cur.wallLayer?null!==(t=null===(e=window.wkLayerWrap)||void 0===e?void 0:e.scrollTop)&&void 0!==t?t:0:(0,o.scrollGetY)())+_)}},422047:(_,e,t)=>{"use strict";t.d(e,{parseObjectPostId:()=>o});var o=function(_){var e=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/);if(e)return{type:e[3]||"wall",id:e[1]+"_"+e[4]}}}}]);try{stManager.done("dist/46b19e29d7cd846b8b1c94b509ac4ce6.ecca38ed22cd8a167b06.js")}catch(_){}