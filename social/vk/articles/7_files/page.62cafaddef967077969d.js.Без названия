!function(_){function e(e){for(var o,l,s=e[0],r=e[1],n=e[2],c=0,p=[];c<s.length;c++)l=s[c],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&p.push(i[l][0]),i[l]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(_[o]=r[o]);for(d&&d(e);p.length;)p.shift()();return a.push.apply(a,n||[]),t()}function t(){for(var _,e=0;e<a.length;e++){for(var t=a[e],o=!0,s=1;s<t.length;s++){var r=t[s];0!==i[r]&&(o=!1)}o&&(a.splice(e--,1),_=l(l.s=t[0]))}return _}var o={},i={"web/page":0},a=[];function l(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return _[e].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.m=_,l.c=o,l.d=function(_,e,t){l.o(_,e)||Object.defineProperty(_,e,{enumerable:!0,get:t})},l.r=function(_){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})},l.t=function(_,e){if(1&e&&(_=l(_)),8&e)return _;if(4&e&&"object"==typeof _&&_&&_.__esModule)return _;var t=Object.create(null);if(l.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:_}),2&e&&"string"!=typeof _)for(var o in _)l.d(t,o,function(e){return _[e]}.bind(null,o));return t},l.n=function(_){var e=_&&_.__esModule?function(){return _.default}:function(){return _};return l.d(e,"a",e),e},l.o=function(_,e){return Object.prototype.hasOwnProperty.call(_,e)},l.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],r=s.push.bind(s);s.push=e,s=s.slice();for(var n=0;n<s.length;n++)e(s[n]);var d=r;a.push([209,"bundles/common","bundles/b0203713c9b55abc70d41e4f64d46e60","bundles/637aa6036536cb04f3a1f378656a0595"]),t()}({209:function(_,e,t){_.exports=t("FgzW")},"7GuL":function(_,e,t){"use strict";t.r(e),t.d(e,"ATTACH_DATA_DONUT_DURATION",(function(){return a})),t.d(e,"MEDIA_TYPE_DONUT_DURATION",(function(){return l})),t.d(e,"POST_PARAM_DONUT_DURATION",(function(){return i})),t.d(e,"donutVisibilityInit",(function(){return P})),t.d(e,"getDonutPostParams",(function(){return f})),t.d(e,"getPostParamsFromDurationMedia",(function(){return D})),t.d(e,"fieldValueIsDonutOnlyPost",(function(){return v})),t.d(e,"updatePostponedPostDonatorIcon",(function(){return C}));var o,i="donut_duration",a="donut_duration",l="donut_duration",s=t("BTjd"),r=t("zxIV"),n=t("t7n3"),d=t("oK+H"),c=function(_,e,t){t?Object(r.domInsertAfter)(_,t):e&&(e.firstChild?Object(r.domInsertBefore)(_,e.firstChild):_&&e.appendChild(_))},p=t("vkK6"),u=t("Egk5"),b=t("v+DW"),E=function(_,e){var t=function(_){if(!(_ instanceof Element)||"submit_post_box"!==_.id)return!0;var e=parseInt(Object(r.domData)(_,"from-oid"))||void 0;return!!e&&e<0}(_),o=function(_){var e,t=null===(e=null==_?void 0:_.markAsAdsGetCheckboxEl)||void 0===e?void 0:e.call(_);return!t||!!!Object(b.isChecked)(t)}(e);return t&&o},O=function(_){var e,t=null===(e=null==_?void 0:_[5])||void 0===e?void 0:e[a];return void 0!==t?t:void 0},m=t("HLtZ"),w=(o=function(_,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,e){_.__proto__=e}||function(_,e){for(var t in e)e.hasOwnProperty(t)&&(_[t]=e[t])})(_,e)},function(_,e){function t(){this.constructor=_}o(_,e),_.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),g=function(_){function e(){return null!==_&&_.apply(this,arguments)||this}return w(e,_),e}(Error),h=function(){function _(e,t){var o=this;this.containerEl=e,this.addMedia=t,this.updateView=function(){o.isInitialized&&(o.actionsUpdateVisibilityView()&&(o.tooltipVisibilityUpdateView(),o.tooltipDurationUpdateView()))},this.chooseDonutVisibility=function(e){var t,i,a=_.getEventParams(e);if(!a)return!1;null===(i=null===(t=o.tooltipDonutVisibility)||void 0===t?void 0:t.hide)||void 0===i||i.call(t),o.setDonutDuration(a.donut_duration)},this.chooseDonutDuration=function(e){var t,i,a=_.getEventParams(e);if(!a)return!1;null===(i=null===(t=o.tooltipDonutDuration)||void 0===t?void 0:t.hide)||void 0===i||i.call(t),o.setDonutDuration(a.donut_duration)};try{this.tooltipVisibilityInitView(),this.tooltipDurationInitView(),this.isInitialized=!0,this.updateView();var i=this.getEmitter();i&&i.on(this.addMedia.eventTypes.mediaUpdate,this.updateView)}catch(_){_ instanceof g||Object(m.logError)(_),this.isInitialized=!1}}return _.prototype.setPostDonutOnly=function(){this.setDonutDuration(-1)},_.prototype.donutUpdateVisibility=function(_){this.actionsUpdateVisibilityView(_)},_.prototype.getEmitter=function(){return this.addMedia.emitter},_.prototype.tooltipVisibilityInitView=function(){var e,t=this.getLnkId(),o=Object(n.getTemplate)("visibility_access_donut",{link_id:t});if(!o)throw new g;if(this.visibilityTooltipEl=Object(r.se)(o),!this.visibilityTooltipEl)throw new g;c(this.visibilityTooltipEl,this.containerEl),this.tooltipDonutVisibility=null===(e=Object(d.createPostTooltip)(_.TOOLTIP_VISIBILITY_NAME,t))||void 0===e?void 0:e.toooltip,Object(s.default)(this.containerEl,_.TOOLTIP_VISIBILITY_OPTION_SELECTOR,"click",this.chooseDonutVisibility)},_.prototype.tooltipDurationInitView=function(){var e,t=this.getLnkId(),o=Object(n.getTemplate)("donut_duration_select",{link_id:t});if(!o)throw new g;if(this.durationTooltipEl=Object(r.se)(o),!this.durationTooltipEl)throw new g;c(this.durationTooltipEl,this.containerEl,this.visibilityTooltipEl),this.tooltipDonutDuration=null===(e=Object(d.createPostTooltip)(_.TOOLTIP_DURATION_NAME,t))||void 0===e?void 0:e.toooltip,Object(s.default)(this.containerEl,_.TOOLTIP_DURATION_OPTION_SELECTOR,"click",this.chooseDonutDuration)},_.prototype.getLnkId=function(){return this.addMedia.lnkId},_.getEventParams=function(_){var e,t=_.target;return!Object(u.checkEvent)(_)&&t instanceof HTMLElement&&(null===(e=Object(p.getActionData)(t))||void 0===e?void 0:e.actionParams)},_.prototype.setDonutDuration=function(e){var t;_.isDurationValueEmpty(e)?this.addMedia.unchooseMediaForType(l):this.addMedia.addOrUpdateChosenMedia(l,"",((t={})[a]=e,t))},_.isDurationValueEmpty=function(_){return null===_},_.prototype.getTooltipVisibilityActiveElement=function(e){var t=null!==e?-1:null;return this.containerEl.querySelector(_.TOOLTIP_VISIBILITY_OPTION_SELECTOR+'[data-value="'+t+'"]')},_.prototype.getTooltipDurationActiveElement=function(e){return this.containerEl.querySelector(_.TOOLTIP_DURATION_OPTION_SELECTOR+'[data-value="'+e+'"]')},_.prototype.getActiveDurationOption=function(){var _=this.addMedia.findChosenMedia(l),e=_?O(_):void 0;return void 0!==e?e:null},_.prototype.tooltipVisibilityUpdateView=function(){var e=this.getActiveDurationOption(),t=String(this.getLnkId())||"",o=this.getTooltipVisibilityActiveElement(e),i=!_.isDurationValueEmpty(e),a=this.visibilityTooltipEl;Object(b.radiobtn)(o,e,"post_settings_btn"+_.TOOLTIP_VISIBILITY_NAME+t);var l=null==a?void 0:a.querySelector(".post_action_btn_text"),s=o&&Object(r.val)(o)||"";l&&s&&(l.innerHTML=s,l.setAttribute("aria-label",Object(n.replaceEntities)(s))),Object(r.toggleClass)(a,"on",i)},_.prototype.tooltipDurationUpdateView=function(){var e=this.getActiveDurationOption(),t=String(this.getLnkId())||"",o=this.getTooltipDurationActiveElement(e),i=!_.isDurationValueEmpty(e),a=i&&!!e&&e>0,l=this.durationTooltipEl;Object(b.radiobtn)(o,e,"post_settings_btn"+_.TOOLTIP_DURATION_NAME+t);var s=null==l?void 0:l.querySelector(".post_action_btn_text"),d=a?o&&Object(r.val)(o):Object(r.domData)(s,"empty"),c=o?d:"";s&&c&&(s.innerHTML=c,s.setAttribute("aria-label",Object(n.replaceEntities)(c))),Object(r.toggleClass)(l,"on",a),Object(r.toggleClass)(l,"visible",i);var p=this.addMedia.markAsAdsGetCheckboxEl();p&&Object(b.disable)(p,i)},_.prototype.actionsUpdateVisibilityView=function(_){var e=null!=_?_:this.getPostboxForNewPost(),t=E(e,this.addMedia);return this.visibilityTooltipEl&&this.durationTooltipEl?(Object(r.toggleClass)(this.containerEl,"post_actions_btns--donut-actions-hidden",!t),t):t},_.prototype.getPostboxForNewPost=function(){return"post_actions_btns"===this.containerEl.id?document.querySelector("#submit_post_box"):null},_.TOOLTIP_DURATION_NAME="post_donut_duration_btn",_.TOOLTIP_DURATION_OPTION_SELECTOR='[data-onclick="toggleDonutPostDuration"]',_.TOOLTIP_VISIBILITY_NAME="donut_visibility_btn",_.TOOLTIP_VISIBILITY_OPTION_SELECTOR='[data-onclick="toggleDonutPostVisibility"]',_}(),P=function(_){var e=_.actionsEl,t=_.addMedia;if(e instanceof Element){var o=new h(e,t);return{donutPostSettings:o.isInitialized?o:void 0}}},D=function(_){var e,t=O(_);return void 0!==t?((e={})[i]=t,e):void 0},M=function(_){var e=_.findChosenMedia(l);return O(e)},v=function(_,e){return void 0!==(e&&M(e))&&E(_,e)?1:0},f=function(_,e){var t;if(_&&e){var o=M(e)||-1;return(t={})[i]=o,t.mark_as_ads=0,t}},C=function(_,e){if(_ instanceof Element){var t=!!(null==e?void 0:e.is_marked_as_donut),o=_.querySelector('[data-section-ref="donut-post-donator-icon"]');if(t){var i,a,l,s=_.querySelector(".post_date"),d=Object(n.getTemplate)("postDonatorIcon");if(s&&d)i=s,a=Object(r.se)(d),(l=o)?Object(r.domReplaceEl)(l,a):i.appendChild(a)}else null==o||o.remove()}}},"9at3":function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a1Th"),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("Btvt"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("pIFo"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("zxIV"),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("EasH"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("v+DW"),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("ryw6"),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("t7n3"),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("cGUQ"),WallUpload={_videoUploadIndex:null,photoUploaded:function(_,e){var t=void 0!==_.ind?_.ind:_,o=(_.fileName?_.fileName:_).replace(/[&<>"']/g,""),i=_.fileName?t+"_"+_.fileName:_,a=ge("upload"+i+"_progress_wrap");a&&hide(geByClass1("progress_x",a)),ajax.post("al_photos.php",extend({act:"choose_uploaded"},e),{onDone:function(_,e){WallUpload.addMedia().chooseMedia("photo",_,extend(e,{upload_ind:t+"_"+o}))},onFail:WallUpload.uploadFailed.pbind(_)})},uploadFailed:function(_,e){var t=void 0!==_.ind?_.ind:_,o=Upload.options[t],i=(_.fileName?_.fileName:_).replace(/[&<>"']/g,"");if("fileApi"==Upload.types[t]&&!o.wiki_editor){var a,l=_.fileName?t+"_"+_.fileName:_;cur.imMedia?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)("upload"+l+"_progress_wrap"),a=cur.imMedia.lnkId,cur.addMedia[a].unchooseMedia()):cur.addMedia&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)("upload"+l+"_progress_wrap"),(a=(cur.attachMediaIndexes||{})[i])&&cur.addMedia[a].unchooseMedia()),1==o.filesTotalCount&&setTimeout(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_4__.showFastBox)({title:getLang("global_error")},getLang("wall_add_photo_error")).hide,2e3)}Object(_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_6__.topError)("Upload failed",{dt:-1,type:102,url:(ge("file_uploader_form"+t)||{}).action}),Upload.embed(t)},show:function(){cur.uploadInited&&("feed"==cur.wallType?removeClass(cur.uploadWrap,"post_upload_min_wrap"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(cur.uploadWrap))},hide:function(_){function e(){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}((function(){cur.uploadInited&&("feed"==cur.wallType?addClass(cur.uploadWrap,"post_upload_min_wrap"):hide(cur.uploadWrap),hide("post_upload_dropbox"))})),addMedia:function(){return cur.dropboxAddMedia||cur.wallAddMedia},attachEl:function(){return WallUpload.dropboxAttachEl||ge("submit_post_box")},attachToEl:function(_){_=ge(_);var e=ge("post_upload_dropbox");if(WallUpload.dropboxAttachEl=_,!_||!e)return!1;_.insertBefore(e,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(_))},checkDragDrop:function(){var _=browser,e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_7__.floatval)(browser.version);return!!(_.msie&&e>=9||_.mozilla&&e>=3.5||_.chrome||_.safari)&&((window.XMLHttpRequest||window.XDomainRequest)&&(window.FormData||window.FileReader&&(window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary||window.ArrayBuffer&&window.Uint8Array&&(window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder))))},initCallback:function(){cur.editingPost?WallUpload.init():Wall.showEditPost()},init:function(){cur.withUpload&&(cur.uploadAdded?WallUpload.show():(cur.uploadAdded=!0,window.Upload&&window.VideoInlineUpload?(WallUpload.initLoader(),Wall._videoUploadIndex=WallUpload.initVideoUploader()):stManager.add([jsc("web/upload.js"),"video_upload.js"],(function(){WallUpload.initLoader(),Wall._videoUploadIndex=WallUpload.initVideoUploader()}))))},initVideoUploader:function(){var _=cur.wallUploadVideoOpts;if(_){var e=ge("post_field_upload_video"),t=ge("post_upload_video_dropbox");_.options.from="post";var o=ge("send_post"),i={onUploadAllCompleteDone:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_5__.disableButton)(o,!1)},onUploadStartDone:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_5__.disableButton)(o,!0)}};return window.VideoInlineUpload.getUploadModule(e,t,_,WallUpload.addMedia(),i)}},initLoader:function initLoader(){removeEvent(bodyNode,"dragover dragenter");var data=cur.wallUploadOpts,field=ge("post_field");if(WallUpload.checkDragDrop()){cur.uploadWrap=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div",{className:"post_upload_wrap fl_r",innerHTML:'<div id="post_field_upload" class="post_upload"></div>'}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domInsertBefore)(cur.uploadWrap,field),cur.uploadVideoWrap=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div",{className:"post_upload_video_wrap fl_r",innerHTML:'<div id="post_field_upload_video" class="post_upload_video"></div>'}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domInsertBefore)(cur.uploadVideoWrap,field);var submitBox=WallUpload.attachEl();submitBox.insertBefore(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div",{id:"post_upload_dropbox",className:"post_upload_dropbox",innerHTML:'<div class="post_upload_dropbox_inner"><div class="post_upload_label drop_label">'+(data.opts.lang.wall_drop_media_here||"Drop files here")+'</div><div class="post_upload_label release_label">'+(data.opts.lang.wall_release_media_here||"Release button to attach files")+"</div></div>"}),submitBox.firstChild),cur.wallUploadInd=Upload.init("post_field_upload",data.url,data.params,{accept:"image/jpeg,image/png,image/gif",dragEl:bodyNode,dropbox:"post_upload_dropbox",file_input:null,file_name:"photo",file_size_limit:26214400,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF",file_match:data.opts.ext_re,lang:data.opts.lang,noFlash:1,multiple:1,multi_progress:1,max_files:10,chooseBox:1,clear:1,type:"photo",max_attempts:3,server:data.opts.server,error:data.opts.default_error,error_hash:data.opts.error_hash,label:data.opts.label,wiki_editor:0,onUploadStart:function(_,e){var t=void 0!==_.ind?_.ind:_,o=Upload.options[t];"form"==Upload.types[t]&&(geByClass1("file",ge("choose_photo_upload")).disabled=!0),"fileApi"==Upload.types[t]&&(cur.notStarted&&(cur.preventBoxHide||boxQueue.hideLast(),delete cur.notStarted),o.multi_progress&&this.onUploadProgress(_,0,0))},onUploadComplete:function onUploadComplete(info,res){var params;try{params=eval("("+res+")")}catch(_){params=Object(_shared_lib_convert__WEBPACK_IMPORTED_MODULE_8__.fromQueryString)(res)}params.photos?WallUpload.photoUploaded(info,params):Upload.onUploadError(info)},onUploadProgress:function(_,e,t){var o=void 0!==_.ind?_.ind:_;if("fileApi"==Upload.types[o]){var i=(cur.attachMediaIndexes||{})[o];if(void 0===i||i&&cur.addMedia[i].chosenMedia||cur.imMedia){var a={loaded:e,total:t};_.fileName&&(a.fileName=_.fileName.replace(/[&<>"']/g,"")),WallUpload.addMedia().showMediaProgress("photo",o,a)}}},onUploadError:WallUpload.uploadFailed,onCheckServerFailed:function(){delete cur.uploadInited,WallUpload.hide()},onUploadCompleteAll:function(_){"form"==Upload.types[_]&&Upload.embed(_)},onDragEnter:function(){cur.editingPost?(Wall.hidePosterFeatureTooltip(),WallUpload.init()):Wall.showEditPost()},onNoFilteredCallback:function(_){Wall._videoUploadIndex&&Upload.onFileApiSend(Wall._videoUploadIndex,_)}}),cur.uploadInited=!0,WallUpload.show(),cur.wallUploadFromDrag&&(1==cur.wallUploadFromDrag&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("post_upload_dropbox"),delete cur.wallUploadFromDrag)}}};__webpack_exports__.default=WallUpload},BTjd:function(_,e,t){"use strict";t.r(e);const o=new WeakMap;function i(_,e,t,i){var a,l;if(!_&&!o.has(e))return!1;const s=null!==(a=o.get(e))&&void 0!==a?a:new WeakMap;if(o.set(e,s),!_&&!o.has(e))return!1;const r=null!==(l=s.get(t))&&void 0!==l?l:new Set;s.set(t,r);const n=r.has(i);return _?r.add(i):r.delete(i),n&&_}e.default=function _(e,t,o,a,l){if("string"==typeof e&&(e=document.querySelectorAll(e)),"function"!=typeof e.addEventListener){const i=Array.prototype.map.call(e,e=>_(e,t,o,a,l));return{destroy(){i.forEach(_=>_.destroy())}}}const s=e,r=Boolean("object"==typeof l?l.capture:l),n=_=>{const e=_.target.closest(t);e&&(_.delegateTarget=e,_.currentTarget.contains(_.delegateTarget)&&a.call(s,_))},d=JSON.stringify({selector:t,type:o,capture:r}),c={destroy(){s.removeEventListener(o,n,l),i(!1,s,a,d)}};return i(!0,s,a,d)||s.addEventListener(o,n,l),c}},BxOC:function(_,e,t){"use strict";t.r(e),t.d(e,"post",(function(){return i})),t.d(e,"plainget",(function(){return a})),t.d(e,"plaingetCancelable",(function(){return l}));t("VRzm"),t("Btvt");var o=t("cGUQ");function i(_,e,t){return e&&(e.im_v=3),new Promise((o,i)=>{ajax.post(_,e,{timeout:t,onDone(){o.apply(null,[[...arguments]])},onFail(){return i.apply(null,arguments),!0}})})}function a(_,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=l(_,e,t),i=o.request;return i}function l(_,e){var t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function a(){t.abort()}t=window.XDomainRequest?new XDomainRequest:ajax._getreq();var l=new Promise((a,l)=>{var s,r=Date.now(),n=i.timeout||60,d=Object(o.toQueryString)(e);if(window.XDomainRequest)t.open("get",`${_}?${d}`),t.ontimeout=function(_){l([_,{}])},t.onerror=function(_){l([_,{}])},t.onload=function(){a([t.responseText,{}])},setTimeout((function(){t.send()}),0);else{t.onreadystatechange=function(){4==t.readyState&&(clearInterval(s),t.status>=200&&t.status<300?a([t.responseText,t]):l([t.responseText,t]))};try{t.open("GET",`${_}?${d}`,!0)}catch(_){return l([_,t])}t.send()}s=setInterval((function(){Date.now()-r>1e3*n&&(window.browser.safari&&t.abort(),l(["",{}]),clearInterval(s))}),1e3)});return{request:l,cancel:a}}},DfBR:function(_,e,t){"use strict";t.r(e),t.d(e,"getNavigableTabs",(function(){return i})),t.d(e,"showHiddenNavigableTabs",(function(){return a}));var o=t("zxIV"),i=function(_){var e=document.querySelector("#wall_tabs");return e?Array.from(e.querySelectorAll(".ui_tab")).filter((function(e){var t=e.parentNode;return null!==t&&t!==_&&!Object(o.hasClass)(t,"unshown")&&!Object(o.matchesSelector)(t,'[data-ui-tab="no_posts"]')})):[]},a=function(){var _=document.querySelector("#wall_tabs"),e=null==_?void 0:_.querySelector(".page_wall_no_posts");null==e||e.remove(),Object(o.removeClass)(document.querySelector("#wall_tabs"),"page_tabs_hidden")}},FgzW:function(_,e,t){"use strict";t.r(e);var o=t("oBWH"),i=t("qwyz"),a=t("9at3"),l=t("aG8I");window.Page=o.default,window.page=o.default,window.Wall=i.default,window.wall=i.default,window.WallUpload=a.default,window.Composer=l.default,window._postsSendTimer||(window._postsSendTimer=setTimeout(o.default.postsSend,1e4));try{stManager.done("page.js")}catch(_){}},YIAi:function(_,e,t){"use strict";t.r(e),t.d(e,"VISIBILITY_ACCESS_OPTIONS",(function(){return o}));var o={PUBLIC:0,ONLY_FRIENDS:1}},ZD4m:function(_,e,t){"use strict";function o(_){var e=_.getBoundingClientRect();return{left:e.left,top:e.top}}function i(){var _=document.documentElement;return{width:_.clientWidth,height:_.clientHeight}}function a(_){var e=_.getBoundingClientRect(),t=e.width,o=e.height;return t&&o?{width:t,height:o}:{width:_.offsetWidth,height:_.offsetHeight}}t.r(e),t.d(e,"getElementOffset",(function(){return o})),t.d(e,"getViewportSize",(function(){return i})),t.d(e,"getElementSize",(function(){return a})),t.d(e,"getJsonDataValue",(function(){return l}));var l=function(_,e){var t=_.getAttribute(e);if(t)try{return JSON.parse(t)}catch(_){return}}},aG8I:function(_,e,t){"use strict";t.r(e);t("KKXr"),t("Oyvg"),t("pIFo"),t("SRfc");var o=t("zxIV"),i=t("t7n3"),a=t("Egk5"),l=t("/PiP"),s=t("7jxN"),r=t("lXE5"),n={init:function(_,e){if(!(_=ge(_)))return null;var t=Object(o.data)(_,"composer");if(t)return t;t={input:_,inited:!1,options:e},Object(o.data)(_,"composer",t),t.wddWrap=Object(o.ce)("div",{className:"composer_wdd clear_fix "+(e.wddClass||""),id:_.id+"_composer_wdd",innerHTML:'<input type="hidden" id="'+_.id+'_composer_wdd_term"/>'},{width:e.width||Object(o.getSize)(_)[0]}),e.appendTo&&Object(i.isFunction)(e.appendTo)?e.appendTo(t.wddWrap):Object(o.domInsertBefore)(t.wddWrap,_.nextSibling),t.wddInput=t.wddWrap.firstChild,t.wdd=WideDropdown.initSelect(t.wddWrap,extend({text:t.wddInput,input:_,noResult:e.lang.noResult||"",introText:e.lang.introText||"",toup:e.toup,wddOpts:e.wddOpts,searchKeys:e.searchKeys,width:"auto",onItemSelect:n.onItemSelect.bind(n).pbind(t)},e.wddOpts||{url:"hints.php",params:{act:"a_json_friends",from:"composer"}})),_.dd=t.wddWrap.id,n.initEvents(t),e.media&&(t.addMedia=new MediaSelector(e.media.lnk,e.media.preview,e.media.types,e.media.options,e.media.gearEl,e.media.actionsEl)),Object(o.setStyle)(t.wddWrap,"width",""),t.inited=!0,n.updateAutoComplete(t),t.edit=e.edit,t.isReply=e.isReply,n.updateArticleConvertSuggest(t);var a=cur.onMediaChanged;return cur.onMediaChanged=function(){n.updateArticleConvertSuggest(t),a&&a()},t},initEvents:function(_){addEvent(_.input,"keyup keydown keypress",n.onKeyEvent.pbind(_)),addEvent(_.input,"click mousedown mouseup focus blur paste",n.onMouseEvent.pbind(_))},destroy:function(_){WideDropdown.deinit(_.wddWrap),Object(o.cleanElems)(_.input,_.wddWrap),Object(o.re)(_.wddWrap),_.inited=!1,_.addMedia&&_.addMedia.destroy(),Object(o.data)(_.input,"composer",null),Object(o.re)(_.articleConvertEl),_.articleConvertEl=!1},onKeyEvent:function(_,e){var t=!e.shiftKey&&inArray(e.keyCode,[KEY.UP,KEY.DOWN,KEY.RETURN]),l=_.wdd&&t;if("keypress"==e.type||"keydown"==e.type){if(e.keyCode==KEY.RETURN||10==e.keyCode){if(_.select&&_.select.isVisible())return Object(a.triggerEvent)(document,e.type,e),Object(a.cancelEvent)(e);if(e.ctrlKey&&Object(i.isFunction)(_.options.onSubmit))return!0}if(e.keyCode==KEY.TAB){var s=_.input,r=window.Emoji?Emoji.editableVal(s):"",d=n.getCursorPosition(s),c=(r.substr(0,d)+String.fromCodePoint(1)+r.substr(d)).match(/^[\s\S]*(@|\*)[\S]+\s*\([\s\S]*?\001[\s\S]*?\)\s*/);if(c){var p=c[0].length-1;return Object(o.elfocus)(_.input,p,p),Object(a.cancelEvent)(e)}}var u=0;for(var b in _.wdd.shown)u+=1;if(l&&Object(o.isVisible)(_.wdd.listWrap)&&u)return e.type==(browser.opera&&!browser.chrome?"keypress":"keydown")&&WideDropdown._textEvent(e),Object(a.cancelEvent)(e)}if("keyup"==e.type&&!l){if(65==e.keyCode&&e.ctrlKey)return;_.wdd&&inArray(e.keyCode,[KEY.SPACE,KEY.HOME,190,191,78,55,49])&&n.hideSelectList(_)}"keyup"!=e.type||l&&e.keyCode!=KEY.RETURN||n.updateAutoComplete(_,e),n.updateArticleConvertSuggest(_)},isArticleConvertSuggestAvailable:function(_){if(_.edit||_.isReply)return!1;var e=!!cur.wallAddMedia&&cur.wallAddMedia.types,t=!1;if(e)for(var o=0;o<e.length;o++)if("article"==e[o][0]){t=!0;break}if(!t||!Object(l.isArticleEditorAvailable)())return!1;var i=!0;return each(cur.wallAddMedia.getMedias()||[],(function(_,e){if(!inArray(e[0],["photo","video","postpone","mark_as_ads"]))return i=!1,!1})),!!i&&!!(cur.options.articleConvertThreshold>0&&_.curValue.length>=cur.options.articleConvertThreshold)},updateArticleConvertSuggest:function(_){if(n.isArticleConvertSuggestAvailable(_)){if(!_.articleConvertEl){var e=gpeByClass("post_field_wrap",_.input),t=geByClass1("post_actions_btns",e);_.articleConvertEl=Object(o.se)('<button class="article_post_convert round_button">'+getLang("profile_convert_to_article_short")+"</button>"),t?(e!==domPN(t)&&Wall.sendInsertBeforeError(),e.insertBefore(_.articleConvertEl,t)):e.appendChild(_.articleConvertEl),removeEvent(_.articleConvertEl),addEvent(_.articleConvertEl,"click",(function(){cur.postComposer=_;var e=[];each(cur.wallAddMedia.getMedias()||[],(function(_,t){inArray(t[0],["photo","video"])&&e.push(t[0]+"_"+t[1])})),Object(l.openArticleEditor)(cur.oid,0,{text:_.curValue,medias:e})}))}Object(o.show)(_.articleConvertEl)}else Object(o.re)(_.articleConvertEl),delete _.articleConvertEl},onMouseEvent:function(_,e){"blur"!=e.type?("focus"!=e.type&&"click"!=e.type||n.updateAutoComplete(_,e),"paste"==e.type&&setTimeout(n.updateAutoComplete.pbind(_,e),0)):n.hideSelectList(_)},updateAutoComplete:function(_,e){var t=_.input,o=(_.options&&_.options.getValue||window.Emoji&&Emoji.editableVal||val)(t),i=Math.max(o.lastIndexOf("@"),o.lastIndexOf("*")),a=!1;if(i>-1){var l=n.getCursorPosition(t),s=o.substr(0,l),r=s.match(/(^|[\s.,:\'\"«»;>\)\(]|\#[\w_\.\u0400-\u04FF]+)[@\*]([^,@\*\(\)\?\!\s\n\r \u00A0]*)$/);i=Math.max(s.lastIndexOf("@"),s.lastIndexOf("*")),r&&"."!==r[2].substr(-1)&&(a=r[2])}!1===a&&delete _.ignoredTerm,void 0!==_.ignoredTerm&&a==_.ignoredTerm&&(a=!1),_.curValue=o,_.curTerm=a,_.curPos=i,val(_.wddInput,a),n.toggleSelectList(_),!e||"keyup"!=e.type&&"paste"!=e.type||(_.options.onValueChange&&_.options.onValueChange(o,"keyup"!=e.type),_.addMedia&&_.addMedia.checkMessageURLs(o,"keyup"!=e.type),_.options.checkLen&&_.options.checkLen(o))},toggleSelectList:function(_){var e=_.curTerm;!1===e?n.hideSelectList(_):n.showSelectList(_,e)},hideSelectList:function(_){_.wddInput.focused=!1,WideDropdown._hideList(_.wdd);var e=_.options||{};e.onHide&&e.onHide()},showSelectList:function(_,e){function t(t){_.wddInput.focused=!0,WideDropdown.items(_.wdd.id,t||[]),WideDropdown._updateList(_.wdd,!1,e);var o=_.options||{};o.onShow&&o.onShow()}"function"==typeof cur.wallMentions&&(cur.wallMentions=cur.wallMentions()),cur.wallMentions&&"function"==typeof cur.wallMentions.then?cur.wallMentions.then((function(_){t(_)})):t(cur.wallMentions)},onItemSelect:function(_,e){if(!e)return!1;var t=e[2].replace("@",""),a=e[8]||e[1],l=_.curValue.substr(0,_.curPos),s=_.curValue.substr(_.curPos),r=!!l.match(/\#[\w_\.\u0400-\u04FF]+$/i);document.activeElement.classList.contains("_im_text")&&(/^(?:id|club)\d{1,}$/.test(t)||(r=!0));var d=_.options.poster,c=window.Emoji&&void 0!==_.input.emojiId||d;c||d?s=Object(i.clean)(s):a=Object(i.replaceEntities)(a),cur.selNum=(cur.selNum||0)+1;var p=new RegExp("^(@|\\*)"+Object(i.escapeRE)(_.curTerm)+"(?:\\s+\\((?:(.*?)\\))?\\s*)?","");return s=s.replace(p,(function(_,e,o){var i=e+t+" ";return r?i+=c||d?'<span id="tmp_sel_'+cur.selNum+'"></span>':"":(i+=(c||d?'<span id="tmp_sel_'+cur.selNum+'">':"")+"(",i+=a.replace(/[\(\)\]\[]/g,""),i+=")"+(c||d?"</span>":"")+" "),i})),r||!l||l.match(/[\.\(\)\?\!\s\n\r\'\"«» \u00A0]$/)||(s=" "+s),n.hideSelectList(_),c||d?(Emoji.val(_.input,Object(i.clean)(l)+s),Emoji.focus(_.input),Emoji.editableFocus(_.input,ge("tmp_sel_"+cur.selNum),!0),d&&d.checkText()):(val(_.input,l+s),Object(o.elfocus)(_.input)),Object(i.isFunction)(_.options.onItemSelect)&&_.options.onItemSelect(e),!1},getCursorPosition:function(_){if(void 0!==_.selectionStart)return _.selectionStart;if(void 0!==window.getSelection){var e=window.getSelection();if(!e||!e.rangeCount)return 0;var t=e.getRangeAt(0),i=t.cloneRange(),a=Object(o.ce)("div");return i.selectNodeContents(_),i.setEnd(t.startContainer,t.startOffset),a.appendChild(i.cloneContents()),(window.Emoji?Emoji.editableVal:val)(a).replace(/\n$/,"").length}return 0},getSendParams:function(_,e,t){var a=_.addMedia||{},l=a.chosenMedia||{},n=a&&a.getMedias?a.getMedias():[],d=a.shareData||{},c=_&&_.options.media&&_.options.media.options.limit||0,p=_.input,u=cur.posterWpe&&cur.posterWpeSendParams?cur.posterWpeSendParams.text:Object(i.trim)(window.Emoji?Emoji.editableVal(p):val(p)),b={message:u},E=0,O=hasClass(gpeByClass("post",p),"suggest");isArray(l)&&l.length&&n.push(clone(l)),Object(o.setStyle)(bodyNode,{cursor:"default"});var m=ge("wpe_cont"),w=geByClass1("wpe_error",m);function g(_){w||(w=Object(o.se)('<div class="wpe_error error"><div>'),m.insertBefore(w,Object(o.domFC)(m))),w.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,Object(o.isVisible)(w)||(Object(s.slideDown)(w,100),Object(r.scrollToY)(Object(o.getXY)(w)[1]-15),Object(s.animate)(ge("box_layer_wrap"),{scrollTop:0}))}if(w&&hide(w),n.length&&each(n,(function(_,o){if(isArray(o)&&o.length){var l=this[0],s=this[1];if(E>=c&&"postpone"!=l)return!1;switch(l){case"poll":var r=a.pollData(t);if(!r)return b.delayed=!0,!1;Object(i.intval)(s)&&(b.poll_id=Object(i.intval)(s)),s=r.question,delete r.question,b=extend(b,r);break;case"copyright":var p=a.copyrightData();if(p)return void(b=extend(b,p));break;case"share":if(d.failed||!d.title&&(!d.images||!d.images.length)&&!d.photo_url&&!d.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(b.delayed=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&d.button_text&&d.button_action){var m;n.length>1&&(m=getLang("global_share_too_many_attachments")),b.message.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(m=getLang("global_share_too_many_newlines")),b.message.length>(cur.options.share||{}).button_exclusive_max_message_len&&(m=getLang("global_share_too_long_message"));var w=Object(i.extractUrls)(" "+b.message+" "),h=Object(i.extractUrls)(" "+d.url+" ")[0];if(h&&w.length){"/"===h.query&&(h.query=""),"www."===h.domain.substr(0,4)&&(h.domain=h.domain.substr(4));for(var P=0;P<w.length;++P){var D=w[P];if("/"===D.query&&(D.query=""),"www."===D.domain.substr(0,4)&&(D.domain=D.domain.substr(4)),h.domain!=D.domain||h.query!=D.query){m=getLang("global_share_too_many_links");break}}}if(m)return g(m),b.delayed=!0,!1}if(!d.title)return g(getLang("global_share_title_required")),b.delayed=!0,!1;if(!d.url)return g(getLang("global_share_url_required")),b.delayed=!0,!1;if(d.url=new URL(d.url).href,d.video?(s=d.video_owner_id+"_"+d.video_id,b.snippet_video=1):s=d.prometheus?d.media:d.user_id&&d.photo_id&&!d.noPhoto?d.user_id+"_"+d.photo_id:"",d.share_upload_failed&&!s)return d.share_upload_failed=0,b.delayed=!0,!1;if(d.images&&d.images.length&&!isArray(d.images[cur.shareShowImg])&&!t&&!s&&!d.noPhoto&&!d.video)return a.uploadShare(e),b.delayed=!0,!1;if((cur.options.share||{}).require_image&&!s)return g(getLang("global_share_image_required")),b.delayed=!0,!1;d.initialPattern&&Object(i.trim)(u)==d.initialPattern&&(b.message=""),extend(b,{url:d.url,mode:d.mode,title:Object(i.replaceEntities)(d.title),description:Object(i.replaceEntities)(d.description),button_text:Object(i.replaceEntities)(d.button_text),button_action:d.button_action,extra:d.extra,extra_data:d.extraData,photo_url:d.video?"":Object(i.replaceEntities)(d.photo_url),placeholder_inserted:d.placeholder_inserted,open_graph_data:(d.openGraph||{}).data,open_graph_hash:(d.openGraph||{}).hash});break;case"page":d.initialPattern&&Object(i.trim)(u)==d.initialPattern&&(b.message="");break;case"postpone":return b.postpone=val("postpone_date"+a.lnkId),void(cur.postponedLastDate=b.postpone);case"donut_duration":return;case"mark_as_ads":return void(b.mark_as_ads=1);case"pretty_cards":if(!a.prettyCardGallery)return;if(a.prettyCardGallery.needSendData())return a.prettyCardGallery.saveCards(e,(function(_){g(_)})),b.delayed=!0,!1;s=a.prettyCardGallery.getSendData().attachVal}this[3]&&Object(i.trim)(u)==this[3]&&(b.message=""),O&&this[4]&&(s+="_"+this[4]),b["attach"+(E+1)+"_type"]=l,b["attach"+(E+1)]=s,E++}})),!a.multi&&(b.postpone||(a.postponeDate&&a.postponeIsTooltip||a.postponePreview)&&(b.postpone=val("postpone_date"+a.lnkId),cur.postponedLastDate=b.postpone),!b.copyright&&a.copyrightData)){var h=a.copyrightData();h&&(b=extend(b,h))}return a.multi||b.mark_as_ads||!a.markAsAds||(b.mark_as_ads=1),b},reset:function(_){var e=_.input,t=val(e),i=_.addMedia,a={value:t};return window.Emoji?Emoji.val(e,""):e.innerHTML="",i&&(a.urlsCancelled=clone(i.urlsCancelled),i.unchooseMedia(),i.urlsCancelled=[]),Object(o.re)(_.articleConvertEl),a},restore:function(_,e){var t=_.input,o=n.reset(_);return val(t,e.value||""),o}};e.default=n},hzb7:function(_,e,t){"use strict";t.r(e),t.d(e,"getPostTopicSelectorParams",(function(){return O})),t.d(e,"isPostTopicEditingEnabled",(function(){return w})),t.d(e,"isPostTopicSettingEnabled",(function(){return m})),t.d(e,"topicUISelectorHide",(function(){return E})),t.d(e,"initPostTopicCreatingSelector",(function(){return M})),t.d(e,"initPostTopicEditingSelector",(function(){return v}));var o,i=t("k487"),a=t("zxIV"),l=t("Egk5"),s=t("t7n3");!function(_){_.topicId="topic_id"}(o||(o={}));var r=function(){return(r=Object.assign||function(_){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(_[i]=e[i]);return _}).apply(this,arguments)},n=new Map,d=function(_,e){return function(_,e){return n.set(_,e)}(_,{actionParams:void 0,selector:e})},c=function(_,e){!function(_,e){var t=n.get(_);void 0!==t&&n.set(_,e(t))}(_,(function(_){return r(r({},_),{actionParams:e})}))},p=function(_,e){var t;c(_,((t={})[o.topicId]=e,t))},u=function(_){return"post_discover_category_btn"+_},b=function(_,e){var t,o,i=(t={link_id:String(e)},(o=Object(s.getTemplate)("postCategorySelect",t))?Object(a.se)(o):null);if(_ instanceof HTMLElement&&i instanceof HTMLElement)return _.appendChild(i),i},E=function(_){var e,t;null===(t=null===(e=function(_){return n.get(_)}(_))||void 0===e?void 0:e.selector)||void 0===t||t.tooltipHide()},O=function(_){var e,t,i=null===(t=function(_){var e;return null===(e=n.get(_))||void 0===e?void 0:e.actionParams}(_))||void 0===t?void 0:t[o.topicId];return void 0!==i&&-1!==i?((e={})[o.topicId]=i,e):void 0},m=function(_){return!0===(null==_?void 0:_.wallPostTopicSettingEnabled)},w=function(_){return void 0!==_.topic_options},g=t("jE6c"),h=t("ZD4m"),P=function(){function _(_,e,t,o){var s=this;this.btnEl=_,this.containerEl=e,this.options=t,this.selectorContentEl=o,this.onOptionClickWrapper=function(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];s.tooltip.hide();var t=_[0].currentTarget;if(t instanceof HTMLElement){var o=Object(h.getJsonDataValue)(t,"data-click-params");o&&s.selectTopicId(o.value)}},this.linkId=this.options.linkId,this.radioBtnId=u(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:o.children},this.tooltip=new i.default(_,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:o,align:"left",onFirstTimeShow:function(){Object(a.show)(o)}}),Object(a.domQuery)('[data-onclick="togglePostTopic"]',e).forEach((function(_){Object(l.addEvent)(_,"click",s.onOptionClickWrapper)}))}return _.create=function(e,t){var o=b(e,t.linkId);if(o){var i=this.getSelectorContentEl(o),l=Object(a.domQuery1)(".post_action_btn_layout",o);if(i&&l)return new _(l,o,t,i)}},_.getSelectorContentEl=function(_){return Object(a.domQuery1)(".post_action_tt_content",_)},_.prototype.destroy=function(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]},_.prototype.tooltipHide=function(){this.tooltip.hide()},_.prototype.selectTopicId=function(_){this.options.selectTopicId(this.linkId,_),this.updateViewForSelectedTopic({isTopicSelected:-1!==_,topicId:_})},_.prototype.clearSelection=function(){this.selectTopicId(-1)},_.prototype.updateViewForSelectedTopic=function(e){var t=e.isTopicSelected,o=e.topicId,i=_.getSelectOptionEl(this.containerEl,o),l=i&&Object(h.getJsonDataValue)(i,"data-click-params"),s=Object(a.domQuery1)(".post_action_btn_text",this.containerEl);if(i&&l&&s){var r=l.label;window.radiobtn(i,void 0,u(this.options.linkId));var n=s.getAttribute("data-empty")||"",d=t?r:n;s.innerHTML=d,s.setAttribute("aria-label",Object(g.replaceEntities)(d)),Object(a.toggleClass)(this.containerEl,"on",t)}},_.getSelectOptionEl=function(_,e){return Object(a.domQuery1)('[data-value="'+e+'"]',_)},_}(),D=function(_,e,t){var i=P.create(e,{linkId:_,selectTopicId:p});if(i)return d(_,i),i.selectTopicId(t[o.topicId]),{clearSelection:function(){i.clearSelection()},onDestroy:function(){i.destroy()}}},M=function(_,e){var t;return D(_,e,((t={})[o.topicId]=-1,t))},v=function(_,e,t){var i,a;return D(_,e,((i={})[o.topicId]=null!==(a=t[o.topicId])&&void 0!==a?a:-1,i))}},oBWH:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("KKXr"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("SRfc"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("pIFo"),_lib_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("zxIV"),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("cGUQ"),_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("/PiP"),_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("Egk5"),_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("FWc3"),_lib_message_box__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("EasH"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("v+DW"),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("Xrg9"),_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("t7n3"),_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("98sY"),_lib_box_utils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("kcIO"),_lib_stats__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("XzvV"),_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("BJj/"),_lib_scroll__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("lXE5"),_lib_video__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("Ia1d"),_lib_fx__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("7jxN"),_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("4+be"),Page={_adBlockSeenStorage:{},_postsClearTimeoutsCalls:0,initUploadForImagePaste:function initUploadForImagePaste(txtEl,addMedia,blob){stManager.add([jsc("web/upload.js")],(function(){addMedia.menu&&addMedia.menu.activate();var uploadEl=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div",{className:"post_upload_wrap fl_r",innerHTML:'<div id="page_field_upload" class="post_upload"></div>'});Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domInsertBefore)(uploadEl,txtEl);var uploadData=window.wkcur?wkcur.wallUploadOpts:cur.wallUploadOpts;if(void 0!==addMedia.clipboardImageUploadIndex)Upload.onFileApiSend(addMedia.clipboardImageUploadIndex,[blob]);else{var composer=txtEl&&Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.data)(txtEl,"composer"),composerOpts=composer&&composer.options&&composer.options.media&&composer.options.media.options||{},limit=composerOpts&&composerOpts.limit||2;addMedia.clipboardImageUploadIndex=Upload.init(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(uploadEl),uploadData.url,uploadData.params,{file_name:"photo",file_size_limit:26214400,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF",file_input:null,accept:"image/jpeg,image/png",file_match:uploadData.opts.ext_re,lang:uploadData.opts.lang,wiki_editor:0,onUploadStart:function(_,e){var t=void 0!==_.ind?_.ind:_,o=Upload.options[t];"form"==Upload.types[t]&&(geByClass1("file",ge("choose_photo_upload")).disabled=!0),"fileApi"==Upload.types[t]&&(cur.notStarted&&(cur.preventBoxHide||boxQueue.hideLast(),delete cur.notStarted),o.multi_progress&&this.onUploadProgress(_,0,0))},onUploadComplete:function onUploadComplete(info,res){var params,i=void 0!==info.ind?info.ind:info,fileName=(info.fileName?info.fileName:info).replace(/[&<>"']/g,"");try{params=eval("("+res+")")}catch(_){params=Object(_shared_lib_convert__WEBPACK_IMPORTED_MODULE_4__.fromQueryString)(res)}params.photos?ajax.post("al_photos.php",extend({act:"choose_uploaded"},params),{onDone:function(_,e){e.uploadNum=i,addMedia.chooseMedia("photo",_,extend(e,{upload_ind:i+"_"+fileName}))},onFail:function(){}}):Upload.onUploadError(info)},onUploadProgress:function(_,e,t){var o=void 0!==_.ind?_.ind:_;if("fileApi"==Upload.types[o]){var i=(cur.attachMediaIndexes||{})[o];if(void 0===i||i&&cur.addMedia[i].chosenMedia||cur.imMedia){var a={loaded:e,total:t};_.fileName&&(a.fileName=_.fileName.replace(/[&<>"']/g,"")),addMedia.showMediaProgress("photo",o,a)}}},onUploadError:WallUpload.uploadFailed,onCheckServerFailed:function(){delete cur.uploadInited,WallUpload.hide()},onUploadCompleteAll:function(_){"form"==Upload.types[_]&&Upload.embed(_)},onCheckComplete:function(_){Upload.types[_]="fileApi",Upload.onFileApiSend(_,[blob])},customShowProgress:function(){},noFlash:1,multiple:1,multi_progress:1,max_files:limit,chooseBox:1,clear:1,type:"photo",max_attempts:3,server:uploadData.opts.server,error:uploadData.opts.default_error,error_hash:uploadData.opts.error_hash})}}))},buildMediaLinkEl:function(_,e){return'<div class="page_media_link_url '+(e?"page_market_owner_link":"")+'">'+(e?"":'<div class="page_media_link_icon"></div>')+'<div class="page_media_link_text">'+_+"</div></div>"},showManyPhoto:function(_,e,t,o){var i=[];return each(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_).childNodes,(function(_,e){var t=(e&&e.getAttribute&&e.getAttribute("onclick")).match(/'(-?\d+_\d+)'\s*,\s*'([a-f0-9]{18})'/i);t&&i.push(t[1]+"/"+t[2])})),o.additional={draft_photos:i.join(";")},Object(_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.showPhoto)(e,t,extend(o,{queue:1}))},inviteToGroup:function(_,e,t,o,i){var a=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_),l=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_)),s=function(_){var o=_?1:0,l=_?Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("friends_cancel_event_invite"):Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("friends_send_event_invite");a.innerHTML='<a onclick="return page.inviteToGroup(this, '+e+", "+t+", "+o+", '"+i+"')\">"+l+"</a>"};return o?(ajax.post("/al_page.php",{act:"a_cancel_invite",mid:t,gid:e,hash:i}),s(0)):(ajax.post("/al_page.php",{act:"a_invite",mid:t,gid:e,hash:i},{onDone:function(_,e){if(!_){s(0),hide(a);var t=geByClass1("error",l),o=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.se)('<div class="page_members_box_error msg"><div class="msg_text">'+e+"</div></div>");t?l.replaceChild(o,t):l.insertBefore(o,l.firstChild)}}}),s(1)),!1},moneyTransferBox:function(_,e){var t={act:"money_transfer_box",to_id:cur.oid,from:e};"own_profile"!==e&&"own_profile_tt"!==e||(t.to_id=0,t.tab="link"),Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_payments.php",t,{onFail:function(_){return setTimeout(Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showFastBox)(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_error"),_).hide,2e3),!0}}),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(_)},showMoreActions:function(_){var e=geByClass1("page_actions_more",_.parentElement);e&&(hide(_),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(e))},onSubscriptionItemOnClick:function(_,e,t,o,i){var a=hasClass(_,"on");Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"act",a?0:1),t&&Page.toggleSubscription(_,t,e,0,"page",(function(){var e=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)(a?"groups_notifications_on":"groups_notifications_set_up");val(_,e),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.toggleClass)(_,"on")})),o&&Page.toggleLiveSubscription(_,o,a?0:1,e,(function(){}),!0),i&&Page.togglePodcastsSubscription(this,i,a?0:1,e,(function(){}),!0)},toggleSubscription:function(_,e,t,o,i,a,l){var s=parseInt(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"act"))?1:0,r={onDone:function(e){a?a(e,s?0:1,_):(val(_,e),_.setAttribute("data-act",s?0:1))}};l||(r.showProgress=Page.actionsDropdownLock.pbind(_),r.hideProgress=Page.actionsDropdownUnlock.pbind(_)),ajax.post("al_wall.php",{act:"a_toggle_posts_subscription",subscribe:s?1:0,oid:o||cur.oid,hash:e,source:i},r),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(t)},toggleLiveSubscription:function(_,e,t,o,i,a){null!=cur.toggleLiveSubscriptionAct&&(t=cur.toggleLiveSubscriptionAct),ajax.post("al_video.php?act=a_subscribe_live",{subscribe:t?1:0,owner_id:cur.oid,hash:e},{onDone:function(e){cur.toggleLiveSubscriptionAct=!t,i?i(e):val(_,e)},showProgress:Page.actionsDropdownLock.pbind(_),hideProgress:Page.actionsDropdownUnlock.pbind(_)}),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(o)},togglePodcastsSubscription:function(_,e,t,o,i,a){null!=cur.togglePodcastsSubscriptionAct&&(t=cur.togglePodcastsSubscriptionAct),ajax.post("al_wall.php",{act:"a_toggle_podcasts_subscription",subscribe:t?1:0,owner_id:cur.oid,hash:e},{onDone:function(e){cur.togglePodcastsSubscriptionAct=!t,i?i(e):val(_,e)},showProgress:!a&&Page.actionsDropdownLock.pbind(_),hideProgress:!a&&Page.actionsDropdownUnlock.pbind(_)}),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(o)},showMessagesFromCommunityTooltip:function(_,e,t,o){null==cur.toggleMessagesFromCommunityAct&&0==e&&(o?Object(_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__.showTooltip)(_,{text:t,dir:"auto",shift:[4,-3]}):Object(_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__.showTooltip)(_,{text:t,dir:"auto"}))},toggleMessagesFromCommunity:function(_,e,t,o){null!=cur.toggleMessagesFromCommunityAct&&(t=cur.toggleMessagesFromCommunityAct),ajax.post("al_groups.php",{act:"a_toggle_messages_from_community",allow:t?1:0,oid:cur.oid,hash:e},{onDone:function(e){val(_,e),cur.toggleMessagesFromCommunityAct=!t},showProgress:Page.actionsDropdownLock.pbind(_),hideProgress:Page.actionsDropdownUnlock.pbind(_)}),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(o)},showPageMembers:function(_,e,t){return cur.viewAsBox?(cur.viewAsBox(),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(_)):!Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showTabbedBox)("al_page.php",{act:"box",oid:e,tab:t},{cache:1},_)},showHiddenMembersBoxInfo:()=>Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showFastBox)(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("groups_hidden_members_message_box_title"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("groups_hidden_members_message_box_content")),showPageVideos:function(_,e){return cur.viewAsBox?(cur.viewAsBox(),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(_)):!Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_video.php?act=a_choose_video_box",{review:1,to_id:e},{cache:1,grey:1})},showPageAudios:function(_,e){return cur.viewAsBox?(cur.viewAsBox(),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(_)):!Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("/al_audio.php?act=audios_box",{oid:e},{cache:1,params:{width:638}},_)},ownerPhotoFast:function(){var _=ge("owner_photo_bubble_input");_||(_=ge("owner_photo_wrap").appendChild(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("input",{type:"file",id:"owner_photo_bubble_input",onchange:function(){Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.data)(this,"changed",!0),Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",{act:"owner_photo_box",oid:cur.oid}).inp=this}}))),_.click()},ownerPhoto:function(_,e){e||(e={}),Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",{act:"owner_photo_box",oid:_||cur.oid,gid:e.gid},{stat:["owner_photo.css",jsc("web/owner_photo.js")]})},ownerCrop:function(_,e){Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",{hash:e,act:"owner_photo_crop",oid:_||cur.oid},{stat:["owner_photo.css",jsc("web/owner_photo.js")]})},ownerPhotoEffects:function(_,e){var t="album"+e+"_0/rev";!cur.pvData||cur.pvShown&&cur.pvListId==t||delete cur.pvData[t],Object(_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.showPhoto)(_,t,{additional:{open_pe:1,pe_no_copy:1},loader:1,onHide:function(){cur.pvEditorSaved&&nav.reload()}})},uploadOwnerCover:function(_){return!Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",{act:"owner_photo_box",oid:_||cur.oid,cover:1},{stat:["owner_photo.css",jsc("web/owner_photo.js")]})},editOwnerCover:function(_){Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",{act:"owner_cover_crop",oid:_||cur.oid},{stat:["owner_photo.css",jsc("web/owner_photo.js")]})},deleteOwnerCover:function(_,e,t){t||(t=cur.shareSetOwnPhoto),Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("groups_delete_cover_title")},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("groups_delete_cover_confirm"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_delete"),(function(o){ajax.post("al_page.php",{act:"owner_cover_remove",oid:_,hash:e,from:cur.module},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.unlockButton.pbind(o),onDone:t})}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_cancel"))},editPhoto:function(_){cur.hideOther(),Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",extend(_||{},{act:"a_edit_photo"}),{params:{bodyStyle:"padding: 16px 7px"},stat:[jsc("web/tagger.js"),"tagger.css"]})},deletePhoto:function(_,e){cur.hideOther();var t=Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_warning")},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("sure_delete_photo"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_delete"),(function(){ajax.post("al_page.php",{act:"a_delete_photo",hash:e,oid:_},{showProgress:t.showProgress,hideProgress:t.hideProgress})}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_cancel"))},shareCurrent:function(){var _=geByClass1("current_audio",ge("page_current_info"));return _||nav.reload(),(_=_.getAttribute("data-audio"))||nav.reload(),((_=_.split("_")).length<3||"s"!=_[2].substr(0,1))&&nav.reload(),!Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("like.php",{act:"publish_box",object:"audio"+_[0]+"_"+_[1],list:_[2]+(_[3]&&"h"==_[3].charAt(0)?"_"+_[3]:"")},{stat:["page.js","page.css","wide_dd.js","wide_dd.css",jsc("web/sharebox.js")]})},playCurrent:function(_,e){var t=_.parentNode;return Page.playLive(e,{showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.showProgress)(t)},hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.hideProgress)(t)}})},playLive:function(_,e){Object(_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().playLive(_,e)},audioStatusUpdate:function(_){var e=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.isChecked)("currinfo_audio"),t=Object(_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),o=AudioUtils.asObject(t.getCurrentAudioLs());ajax.post("al_audio.php",{act:"toggle_status",hash:_,exp:e,id:o?o.fullId:"",oid:vk.id},{onDone:function(_,e){vk.id==cur.oid&&_&&(val("current_info",_),t.setStatusExportInfo(e,!0))},onFail:()=>!0})},audioListenersOver:function(_,e){Object(_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__.showTooltip)(_,{url:"al_audio.php",params:{act:"listeners_tt",oid:e},slide:15,shift:[24,10,10],ajaxdt:100,showdt:400,hidedt:200,asrtl:1,dir:"auto",typeClass:"audio_tt",appendParentCls:"scroll_fix_wrap"})},showAudioListeners:function(_,e){function t(){var _=ge("listeners_more_link"),e=ge("listeners_more_link_trigger");Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.isVisible)(e)&&boxLayerWrap.scrollHeight-500<boxLayerWrap.scrollTop+boxLayerWrap.offsetHeight&&(hide(e),_.click())}return e.cancelBubble=!0,cur.audioListenersOnDone={onHide:function(){removeEvent(window.boxLayerWrap,"scroll",t)},onDone:function(_,e){window.audioListenersOffset=0,e?addEvent(window.boxLayerWrap,"scroll",t):(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)("listeners_more_link"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)("listeners_more_link_trigger"))}},!Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("/al_audio.php",{act:"listeners_box",oid:_},extend(cur.audioListenersOnDone,{cache:1}))},moreAudioListeners:function(_){window.audioListenersOffset+=50;var e=geByClass1("fans_rows"),t=ge("listeners_more_link");ajax.post("/al_audio.php",{act:"listeners_box",oid:_,offset:window.audioListenersOffset},{onDone:function(_,o){for(var i=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div",{innerHTML:_}),a=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(i);a;a=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(i))e.appendChild(a);if(o){var l=ge("listeners_more_link_trigger");Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(l)}else Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)(t),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)("listeners_more_link_trigger")},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.lockButton.pbind(t),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.unlockButton.pbind(t)})},postsUnseen:function(_){window._postsExtras||(window._postsExtras={});var e=Date.now(),t=!1;for(var o in _)for(var i in _[o])if("module"!=i&&"index"!=i&&"q"!=i&&"block"!=i){var a=window._postsExtras[i];a&&-1==a.diff&&(a.diff=e-a.start,t=!0)}t&&Page.postsClearTimeouts()},postsSeen:function(_){if(vk.id&&_.length&&!vk.pd){window._postsSeenModules||(window._postsSeenModules={}),window._postsExtras||(window._postsExtras={});var e,t=Date.now(),o=Page._adBlockSeenStorage;for(var i in _){var a=Page.getPostModuleCode(_[i].module?_[i].module:""),l=_[i].index,s=_[i].q,r=_[i].block;for(var n in _[i].hash&&!window._postsViewHash&&(window._postsViewHash=_[i].hash),_[i])if("module"!=n&&"index"!=n&&"q"!=n&&"hash"!=n&&"block"!=n){window._postsSeenModules[n]=a;var d=_[i][n],c=ge("post"+n);if(n in o||(o[n]=!(!c||!attr(c,"data-ad-view"))),!o[n]){var p=window._postsSeen[n],u=window._postsSaved[n];if(-1==u||-1==p||1==d&&(u||p))continue}var b=0;if(c){b=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)(c)[1];var E=geByClass1("replies",c);E&&(b-=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)(E)[1])}window._postsSeen[n]=d,e=d,window._postsExtras[n]={start:t,diff:-1,index:l,q:s,block:r,postHeight:b,viewportHeight:window.clientHeight(),session_id:cur.feed_session_id?cur.feed_session_id:"na"},Wall.triggerAdStat(n,_[i].long?"impression_long":"impression")}}e&&Page.postsClearTimeouts()}},postsClearTimeouts:function(){clearTimeout(window._postsSaveTimer),clearTimeout(window._postsSendTimer),++Page._postsClearTimeoutsCalls<10?(window._postsSaveTimer=setTimeout(Page.postsSave,2500),window._postsSendTimer=setTimeout(Page.postsSend,5e3)):(Page._postsClearTimeoutsCalls=0,Page.postsSave(),Page.postsSend())},postsSave:function(){if(!_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.checkVersion()||Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.isEmpty)(window._postsSeen))return window._postsSeen;var _,e=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_sent")||{},t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_seen")||{},o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_seen_modules")||{},i=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_extras")||{},a=Math.floor((vk.ts+Math.floor((Date.now()-vk.started)/1e3))/3600),l=Page._adBlockSeenStorage;for(var s in window._postsExtras||(window._postsExtras={}),window._postsSeen){var r=window._postsSeen[s];window._postsExtras[s]&&(i[s]={diff:window._postsExtras[s].diff,index:window._postsExtras[s].index,q:window._postsExtras[s].q,session_id:window._postsExtras[s].session_id?window._postsExtras[s].session_id:"na",postHeight:window._postsExtras[s].postHeight,viewportHeight:window._postsExtras[s].viewportHeight,block:window._postsExtras[s].block},delete window._postsExtras[s]);var n=s.split("_");"ad"!==n[0]&&"adsite"!==n[0]&&"posthashtag"!==n[0]&&"block"!==n[0]&&(n[0]=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(n[0]),n[1]&&"p"==n[1].substr(0,1)||(n[1]=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(n[1])));var d=(e[n[0]]||{})[n[1]],c=n&&"block"===n[0]&&4===Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(n[1]);n[0]!=vk.id&&(c||l[s]||!d||-1==r&&d>0)&&(t[n[0]]||(t[n[0]]={},delete o[s]),(!t[n[0]][n[1]]||-1==r&&t[n[0]][n[1]]>0)&&(_=t[n[0]][n[1]]=a*r,o[s]=window._postsSeenModules[s])),window._postsSaved[s]=r}window._postsSeen={},window._postsSeenModules={},_&&(_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_seen",t),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_seen_modules",o),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_extras",i))},getPostModuleCode:function(_){switch(_){case"feed":return"f";case"public":case"groups":return"c";case"profile":return"p";case"wall":return"w";case"wall_top":return"tw";case"feed_search":return"s";case"feed_news_recent":case"feed_news":return"rf";case"feed_news_top":return"tf";case"feed_recommended":case"feed_recommended_recent":return"d";case"feed_recommended_top":return"e";case"feed_other":return"o";case"feed_friends":case"feed_friends_recent":return"rr";case"feed_friends_top":return"tr";case"feed_podcasts":case"feed_podcasts_top":case"feed_podcasts_recent":return"h";case"feed_groups":case"feed_groups_recent":return"rg";case"feed_groups_top":return"tg";case"feed_videos":case"feed_videos_recent":return"rv";case"feed_videos_top":return"tv";case"feed_photos":case"feed_photos_recent":return"rp";case"feed_photos_top":return"tp";case"feed_list_recent":return"rl";case"feed_list_top":return"tl";case"groups_ads_promoted_post":return"ag";case"public_ads_promoted_post":return"ap";default:return"u"}},postsSend:function(){var _={},e={},t={};if(_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.checkVersion())_=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_seen"),e=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_seen_modules")||{},t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_extras")||{};else{var o=Page.postsSave();for(var i in o){var a=o[i],l=i.split("_");"ad"!==l[0]&&"posthashtag"!==l[0]&&(l[0]=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(l[0]),"p"!=l[1].substr(0,1)&&(l[1]=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(l[1]))),_[l[0]]||(_[l[0]]={}),(!_[l[0]][l[1]]||-1==a&&_[l[0]][l[1]]>0)&&(_[l[0]][l[1]]=a)}}var s=[],r=[];for(var n in _){var d=[];for(var c in _[n]){var p=n+"_"+c,u=e[p]||"",b=t[p],E="s"==u&&b&&b.q?b.q:"";E=E.replace(/[,;:]/g,"");var O=b&&b.session_id?b.session_id:"na",m="";b&&"ad"!==n&&"posthashtag"!==n&&(m=(m=":"+[b.diff,b.index,O,E||"",b.block||""].join(":")).replace(/:+$/,"")),b&&b.postHeight&&r.push([p,b.postHeight,b.viewportHeight].join(":")),d.push(u+(_[n][c]>0?c:-c)+m)}d.length&&s.push(n+"_"+d.join(","))}if(s.length){if(!vk.id)return Page.postsClear();var w={act:"seen",data:s.join(";"),meta:r.join(";")};window._postsViewHash&&(w.hash=window._postsViewHash),ajax.post("al_page.php",w,{onDone:function(){if(!_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.checkVersion())return extend(window._postsSaved,window._postsSeen);var e=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_seen")||{},t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_sent")||{},o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_seen_modules");for(var i in _){var a=void 0;for(a in _[i])t[i]||(t[i]={}),-1!=t[i][a]&&(t[i][a]=_[i][a]),(e[i]||{})[a]&&(delete e[i][a],delete o[i+"_"+a]);e[i]&&Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.isEmpty)(e[i])&&(delete e[i],delete o[i+"_"+a])}_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_seen",e),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_sent",t),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_seen_modules",o),clearTimeout(window._postsCleanTimer),window._postsCleanTimer=setTimeout(Page.postsClean,1e4)}})}},postsClean:function(){if(window.curNotifier&&curNotifier.idle_manager&&!curNotifier.idle_manager.is_idle)return Object(_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.debugLog)("waiting ls clean.."),clearTimeout(window._postsCleanTimer),void(window._postsCleanTimer=setTimeout(Page.postsClean,1e4));Object(_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.debugLog)("cleaning ls..");var _=Math.floor((vk.ts+Math.floor((Date.now()-vk.started)/1e3))/3600),e=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.get("posts_sent")||{};for(var t in e){for(var o in e[t]){var i=e[t][o];_-(i>0?i:-i)>24&&delete e[t][o]}Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.isEmpty)(e[t])&&delete e[t]}_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_sent",e),Wall.cleanAdsEvents()},postsClear:function(){_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_seen",{}),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_extras",{}),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set("posts_sent",{}),window._postsSaved={},window._postsSeen={},window._postsSeenModules={},window._postsExtras={},_shared_lib_ls__WEBPACK_IMPORTED_MODULE_10__.default.set(Wall.LS_ADS_EVENTS,Wall._lsAdsEvents={})},showContacts:function(_,e,t){Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("/al_page.php",{act:"a_get_contacts",oid:_,edit:e}).setOptions({onHideAttempt:function(){return cur.reloadAfterClose&&(t?t():(nav.reload({noscroll:!0}),cur.reloadAfterClose=!1)),!0}})},showContactTT:function(_,e){Object(_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__.showTooltip)(_,{text:()=>e,slideX:15,className:"pedit_tt",hasover:1,shift:[-Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)(_)[0]-10,-15,-15],dir:"left",appendParentCls:"scroll_fix_wrap",onCreate:function(){_.tt&&setTimeout(_.tt.hide,3e3)}})},editContact:function editContact(oid,mid,hash,callback){var b=Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_page.php",{act:"a_edit_contact_box",mid,oid}).setButtons(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_save"),(function(btn){function onSearch(){var params={act:"a_add_contact",mid,oid};params.hash=hash,hash||(params.hash=ge("group_contact_hash").value),params.title=val("group_contact_position"),params.phone=val("group_contact_phone"),params.email=val("group_contact_email"),mid||!ge("group_contact_memlink")||(params.page=val("group_contact_memlink"),params.page||params.phone||params.email)?ajax.post("al_page.php",params,{onDone:function onDone(res,script){b.hide();var box=Object(_lib_box_utils__WEBPACK_IMPORTED_MODULE_13__.curBox)();if(box){if(box.content(res),ge("public_contacts_list")&&ge("public_contacts_list").sorter&&ge("public_contacts_list").sorter.destroy(),script)try{eval(script)}catch(_){Object(_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.logEvalError)(_,script)}Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.toggle)("group_add_contact",ge("public_contacts_list").childNodes.length<30)}else Page.showContacts(oid,1,callback)},onFail:function(_){if(ge("group_contact_error"))return ge("group_contact_error").innerHTML=_,Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("group_contact_error_wrap"),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.lockButton.pbind(btn),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.unlockButton.pbind(btn)}):b.hide()}cur.reloadAfterClose=!0,mid||cur.lastContact==val("group_contact_memlink")?onSearch():Page.searchContact(oid,val("group_contact_memlink"),onSearch)}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("global_cancel"));return!1},searchContact:function(_,e,t){if(!Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)(e))return cur.lastContact="",void(t&&t());e!=cur.lastContact&&ajax.post("al_page.php",{act:"a_search_contact",oid:_,page:e},{onDone:function(_,o,i,a){cur.lastContact=e,ge("group_contact_name").innerHTML=i,ge("group_contact_image").innerHTML=o,ge("group_contact_hash").value=a,_?t?t():hide("group_contact_error_wrap"):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.notaBene)("group_contact_memlink","",!0),hide("group_contact_error_wrap"))}})},deleteContact:function deleteContact(oid,mid,hash){return cur.reloadAfterClose=!0,ajax.post("al_page.php",{act:"a_delete_contact",oid,mid,hash},{onDone:function onDone(res,script){var box=Object(_lib_box_utils__WEBPACK_IMPORTED_MODULE_13__.curBox)();if(box.content(res),ge("public_contacts_list")&&ge("public_contacts_list").sorter&&ge("public_contacts_list").sorter.destroy(),script)try{eval(script)}catch(_){Object(_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.logEvalError)(_,script)}Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.toggle)("group_add_contact",ge("public_contacts_list").childNodes.length<30)}}),!1},reorderContacts:function(_,e,t,o,i){var a=t.id.replace("group_contact_cell",""),l=(o&&o.id||"").replace("group_contact_cell",""),s=(i&&i.id||"").replace("group_contact_cell","");cur.reloadAfterClose=!0,ajax.post("/al_page.php",{act:"a_reorder_contacts",oid:_,mid:a,before:l,after:s,hash:e})},initStatusEditable:function(_){if(_.emojiInited)return!1;_.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.init(_,{ttDiff:-48,rPointer:!0,controlsCont:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_),noStickers:!0,forceEnterSend:!0,ref:"status",onSend:Page.infoSave,checkEditable:function(){var e=Emoji.editableVal(_);e.length>140&&(Emoji.val(_,Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.clean)(e.substr(0,140))),Emoji.editableFocus(_,!1,!0))}})}))},infoEdit:function(_){if(cur.viewAsBox)return cur.viewAsBox();var e=ge("current_info").tt;e&&e.hide&&e.hide({fasthide:!0}),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("currinfo_editor","currinfo_fake"),hide("currinfo_wrap"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.isVisible)("currinfo_app")&&!cur.ciApp?(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("currinfo_audio"),hide("currinfo_app")):cur.ciApp&&(hide("currinfo_audio"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("currinfo_app"));var t=ge("current_info").firstChild,o=ge("currinfo_input"),i=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.geByTag1)("a",t);if(Page.initStatusEditable(o,cur.infoOld),cur.infoEditing="my_current_info"==t.className,cur.infoEditing){var a=i?i.innerHTML:t.innerHTML;a=a.replace(/<img[^>]+alt="([^"]+)"[^>]*>/g,"$1"),cur.infoOld=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)(Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.clean)(Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.stripHTML)(a)))}else cur.infoOld="";return window.Emoji?(Emoji.val(o,Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.winToUtf)(cur.infoOld)),Emoji.editableFocus(o,!1,!0,!0)):(val(o,Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.winToUtf)(cur.infoOld)),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.elfocus)(o)),addEvent(window,"keydown",Page.infoKeydown),addEvent(document,"mousedown",Page.infoMousedown),ge("currinfo_save").onclick=Page.infoSave,!1},infoCancel:function(){hide("currinfo_editor","currinfo_fake"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("currinfo_wrap"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.cleanElems)("currinfo_save","currinfo_cancel"),removeEvent(window,"keydown",Page.infoKeydown),removeEvent(document,"mousedown",Page.infoMousedown),cur.ciApp=!1},infoShowShare:function(){if(cur.viewAsBox)return cur.viewAsBox();var _=ge("current_info"),e=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("share_current_info");Object(_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__.showTooltip)(_,{content:'<div class="content"><div class="checkbox">'+e+"</div></div>",className:"share_tt",init:function(){addEvent(geByClass1("checkbox",_.tt.container),"click",(function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.checkbox)(this),ajax.post("al_page.php",{act:"share_currinfo",hash:cur.options.info_hash,oid:cur.oid,checked:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.isChecked)(this)},{onDone:Wall.receive})}))},toup:!1,showdt:0,slide:10,shift:[6,8,8],dir:"auto",hidedt:200,onClean:function(){Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.cleanElems)(geByClass1("checkbox",_.tt.container))}})},infoKeydown:function(_){_.keyCode==KEY.ESC&&Page.infoCancel()},infoMousedown:function(_){for(var e=_.target;e.parentNode;){if("currinfo_editor"==e.id)return;e=e.parentNode}Page.infoCancel()},infoSave:function(){if(cur.viewAsBox)return cur.viewAsBox();var _=ge("currinfo_input"),e=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)((window.Emoji?Emoji.editableVal:val)(_)).replace(/\n/g," ");if(e==cur.infoOld||e==Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.winToUtf)(cur.infoOld))return Page.infoCancel();e=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)(e).substr(0,140),ajax.post("al_page.php",{act:"current_info",oid:cur.oid,info:e,hash:cur.options.info_hash},{onDone:function(){var _=e?"my":"no",t=e?'<span class="current_text">'+Emoji.emojiToHTML(e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),!0)+"</span>":Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("change_current_info");ge("current_info").innerHTML=ge("currinfo_fake").innerHTML='<span class="'+_+'_current_info">'+t+"</span>",Page.infoCancel();var o=ge("current_info"),i=o.tt;i&&i.el&&(i.destroy(),removeEvent(o,"mouseover")),e&&(addEvent(o,"mouseover",Page.infoShowShare),Page.infoShowShare())},onFail:function(_){if(!_)return!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.lockButton.pbind("currinfo_save"),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.unlockButton.pbind("currinfo_save"),stat:[jsc("web/tooltips.js"),"tooltips.css",jsc("web/emoji.js")]})},showGifBox:function(_,e,t,o,i,a){a&&(a.ctrlKey||a.metaKey||a.shiftKey)||(Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(a),checkMp4((function(l){l&&(Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(a),Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("docs.php",{act:"show_box",doc_id:_,doc_owner_id:e,post_id:t,post_owner_id:o,hash:i},{stat:[window.jsc("web/docs.js"),"docs.css"],params:{white:!0,hideButtons:!0},onDone:function(_,e){if(!vk.widget){if(Object(_lib_box_utils__WEBPACK_IMPORTED_MODULE_13__.curBox)().setOptions({width:e.width+50}),cur.gifAdded&&cur.gifAdded[e.doc]){var t=geByClass1("docs_gif_box_add_"+e.doc);Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.replaceClass)(t,"button_action_light_add","button_action_light_done"),val(t,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("wall_doc_added_short"))}var o=geByClass1("page_doc_photo_href",Object(_lib_box_utils__WEBPACK_IMPORTED_MODULE_13__.curBox)().bodyNode);Page.showGif(o)}}}))})))},showGif:function(_,e,t,o){if(e&&(e.ctrlKey||e.metaKey))return!0;if(!Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.isUndefined)(o)){var i=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_),a=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(i),l=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(_);cur.gifAdded=cur.gifAdded||{},(cur.activeGif&&Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(cur.activeGif))==a||hasClass(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(cur.activeGif),"page_gif_large")&&!t)&&Page.hideGif(cur.activeGif,!1);var s,r=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"doc"),n=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"hash"),d=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"add-txt")||"",c=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"add-hash"),p=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"share-txt")||"",u=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"post"),b=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"reply"),E=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"preview"),O=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"width"),m=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"height"),w=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"thumb"),g=hasClass(i,"page_gif_large"),h=!e;E||(o=!1);var P=_.href+"&wnd=1&module="+cur.module;o?(s=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("video",{autoplay:!0,muted:!0,loop:"loop",poster:w,src:P+"&mp4=1",className:"pages_gif_img page_gif_big"},{width:O?O+"px":void 0,height:m?m+"px":void 0,background:g?"transparent url("+w+") no-repeat 0 0":"",backgroundSize:"cover"}),attr(s,"webkit-playsinline",""),browser.ipad&&attr(s,"controls","")):s=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("img",{src:P,className:"pages_gif_img"},{visibility:"hidden"});var D=n?'<div class="page_gif_share" onmouseover="showTooltip(this, {text: \''+p+"', black: 1, shift: [7, 6, 6], toup: 0, needLeft: 1})\" onclick=\"return Page.shareGif(this, '"+r+"', '"+n+'\', event)"><div class="page_gif_share_icon"></div></div>':"",M=c?'<div class="page_gif_add" onmouseover="return Page.overGifAdd(this, \''+d+"', '"+r+"', event);\" onclick=\"return Page.addGif(this, '"+r+"', '"+n+"', '"+c+'\', event);"><div class="page_gif_add_icon"></div></div>':"",v=D||M?'<div class="page_gif_actions">'+D+M+"</div>":"",f='<div class="page_gif_progress_icon" style="display:none;">'+Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.rs)(vk.pr_tpl,{id:"",cls:""})+"</div>",C=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("a",{href:_.href,className:"page_gif_preview"+(cur.gifAdded[r]?" page_gif_added":""),innerHTML:f+v,onclick:_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent},{backgroundImage:o?"":(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getStyle)(l,"backgroundImage")||"").replace(/"/g,"'"),backgroundSize:o?"":(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getStyle)(l,"backgroundSize")||"").replace(/"/g,"'"),width:O?O+"px":void 0,height:m?m+"px":void 0}),T=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(C);C.appendChild(s),cur.activeGif=C,i!==Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_)&&Wall.sendInsertBeforeError(),i.insertBefore(C,_),hide(_);var A,L=!1,B=function(){var _=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)(s);(_[0]||_[1])&&(clearInterval(A),delete s.onload,delete s.onloadeddata,L=!0,hide(T),C.style.background="",C.setAttribute("onclick","return Page.hideGif(this, event);"),addClass(s,"page_gif_big"),addClass(C,"page_gif_loaded"),O&&(s.style.width=O+"px"),m&&(s.style.height=m+"px"),s.style.visibility="",Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("gif_play",0,o?"mp4":"gif",h?1:0))};e?Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(T):setTimeout((function(){L||Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(T)}),300),o?s.onloadeddata=B:(A=setInterval(B,10),s.onload=B),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(i,"playing",1);var I=h?"autoplay":"manual",W=cur.module||"other",R=u?"post":b?"reply":"";if(Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("gif_show",I,W,R),u){var y=u.split("_"),j=y[0],U=y[1];Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("show_post_gif",1,j,U)}return Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(e)}checkMp4((function(o){Page.showGif(_,e,t,o)}))},hideGif:function(_,e){if(e&&(e.ctrlKey||e.metaKey))return!0;var t=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_),o=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domNS)(_);return t.removeAttribute("data-playing"),e&&removeClass(t,"page_gif_autoplay"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)(_),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(o),delete cur.activeGif,!1},overGifAdd:function(_,e,t,o){return cur.gifAdded=cur.gifAdded||{},cur.gifAdded[t]&&!(e=cur.gifAdded[t].tooltip)||Object(_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_7__.showTooltip)(_,{text:e,black:1,shift:[7,6,6],toup:0,needLeft:1}),!1},addGif:function(_,e,t,o,i){if(cur.viewAsBox)return Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.stopEvent)(i),cur.viewAsBox();cur.gifAdded=cur.gifAdded||{},isObject(_.tt)&&_.tt.hide();var a=hasClass(_,"button_action_light");return cur.gifAdded[e]?ajax.post("docs.php",{act:"a_delete",oid:vk.id,did:cur.gifAdded[e].did,hash:cur.gifAdded[e].hash},{onDone:function(){if(a)Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.replaceClass)(_,"button_action_light_done","button_action_light_add"),val(_,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("wall_doc_add_short"));else{var t=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.gpeByClass)("page_gif_large",_)||Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_);removeClass(t,"page_gif_added"),_.tt&&_.tt.el&&_.tt.destroy()}delete cur.gifAdded[e]}}):(addClass(_,"page_gif_adding"),ajax.post("docs.php",{act:"a_add",doc:e,hash:t,add_hash:o},{onDone:function(t,o,i,l){if(Object(_lib_box_utils__WEBPACK_IMPORTED_MODULE_13__.showDoneBox)(t),a)Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.replaceClass)(_,"button_action_light_add","button_action_light_done"),val(_,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_19__.getLang)("wall_doc_added_short"));else{var s=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.gpeByClass)("page_gif_large",_)||Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_);addClass(s,"page_gif_added"),_.tt&&_.tt.el&&_.tt.destroy()}cur.gifAdded[e]={tooltip:o,did:i[0],hash:l}}})),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(i)},shareGif:function(_,e,t,o){return cur.viewAsBox?(Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.stopEvent)(o),cur.viewAsBox()):(isObject(_.tt)&&_.tt.hide(),window.showBox("like.php",{act:"publish_box",object:"doc"+e,list:t},{stat:["wide_dd.js","wide_dd.css",jsc("web/sharebox.js")]}),Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(o))},initGifAutoplay:function(_){if(!(cur.gifAutoplayScrollHandler||browser.mobile||!1===_||cur.viewAsBox))if(Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.isUndefined)(_))checkMp4((function(_){Page.initGifAutoplay(_)}));else{var e=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)("page_header")[1],t=Object(_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_15__.debounce)((function(){var _=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.geByClass)("page_gif_autoplay");if(!(!_.length||window.wkcur&&wkcur.shown)){var t,o,i,a=(window.innerHeight||document.documentElement.clientHeight)-e,l=e+a/2,s=Math.min(a,800),r=l-s/2,n=l+s/2,d=_.length-1,c=-1;if(cur.activeGif){var p=cur.activeGif.getBoundingClientRect();if(p.top>r&&p.bottom<n){if(p.top<l&&p.bottom>l)return;var u=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.indexOf)(_,Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(cur.activeGif)),b=Math.min(Math.abs(a/2-p.top),Math.abs(a/2-p.bottom));t={el:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(cur.activeGif),distanceToMiddle:b},u>-1&&(d=u,c=Math.abs(a/2-p.top)<Math.abs(a/2-p.bottom)?-1:1)}else inArray(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(cur.activeGif),_)&&Page.hideGif(cur.activeGif)}for(;o=_[d];){var E=o.getBoundingClientRect(),O=E.width&&E.height&&E.top>r&&E.bottom<n;if(O&&0==d&&Object(_lib_scroll__WEBPACK_IMPORTED_MODULE_16__.scrollGetY)()<300){t={el:o,distanceToMiddle:i};break}if(O){if(i=Math.min(Math.abs(a/2-E.top),Math.abs(a/2-E.bottom)),t&&i>t.distanceToMiddle)break;t={el:o,distanceToMiddle:i}}d+=c}if(t&&Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(t.el)!==cur.activeGif){Page.showGif(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(t.el));for(var m,w=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.indexOf)(_,t.el)+1;m=_[w++];){var g=m.getBoundingClientRect();if(g.width&&g.height){Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("video",{src:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(m).href+"&wnd=1&mp4=1",preload:"auto"});break}}}}}),50);cur.gifAutoplayScrollHandler=t,addEvent(window,"scroll",t),addEvent(window,"resize",t),t(),cur.destroy.push((function(){removeEvent(window,"scroll",t),removeEvent(window,"resize",t),t=null,delete cur.gifAutoplayScrollHandler}))}},initVideoAutoplay:function(_){if(browser.mobile||!1===_||cur.videoAutoplayScrollHandler)"feed"==cur.module&&Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("feed_init_video_autoplay",cur.videoAutoplayScrollHandler?"already_init":"bad_browser");else if(Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.isUndefined)(_))checkMp4((function(_){Page.initVideoAutoplay(_)}));else{var e,t,o,i,a,l,s,r,n,d="im"==cur.module;if("feed"==cur.module)Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("feed_init_video_autoplay","good_browser");else if(d){var c=geByClass1("_im_chat_body_abs");e=geByClass1("im-page--chat-header"),t=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.data)(c,"ui-scroll"),o=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)(e)[1],i=geByClass1("im-chat-input"),a=0,l=!0,s=null}var p=window.MediaSource&&MediaSource.isTypeSupported&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),u=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getSize)("page_header")[1],b=Object(_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_15__.debounce)((function(_,c){if(!(layers.visible||window.mvcur&&mvcur.mvShown||nav.objLoc.z||document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement)){var b=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.geByClass)("page_video_autoplayable"),g=b.length;if(g&&(!c||!cur.videoInlinePlayer||cur.videoInlinePlayer.isAutoplay())){var h,P,D,M=document.body.scrollHeight-u,v=(window.innerHeight||document.documentElement.clientHeight)-u,f=u+v/2,C=Math.min(v,800);d?(D=cur.imClassicInterface?M-(v+Object(_lib_scroll__WEBPACK_IMPORTED_MODULE_16__.scrollGetY)()):t.api.data.scrollBottom,l=D>=a,a=D,(c||D&&(cur.imClassicInterface&&l||!cur.imClassicInterface&&l))&&(b=b.reverse()),h=f-C/2,P=D<100?v:h+C,cur.imClassicInterface?(r=e.getBoundingClientRect().top+o,n=i.getBoundingClientRect().top):(r=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getXY)(e)[1]+o,n=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.getXY)(i)[1]),h<r&&(h=r),P>n&&(P=n)):P=(h=(D=Object(_lib_scroll__WEBPACK_IMPORTED_MODULE_16__.scrollGetY)())<300?u:f-C/2)+C;var T=cur.videoInlinePlayer;if(T){var A=T.isAutoplay(),L=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domClosest)("post",T.el),"ad-view"),B=T.el.getBoundingClientRect(),I=B.top>h&&B.bottom<P;if(!L&&A||(I=B.bottom>h&&B.bottom<P||B.top>h&&B.top<P),I){if(A&&"paused"==T.getState()&&T.play(),"ended"!=T.getState())return}else A&&!T.isActiveLive()&&T.pause()}var W=g;for(c&&s&&(W=b.indexOf(s));W--;){var R=b[W],y=hasClass(R,"VideoRestriction");if(!(!p&&Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(R,"duration"))>300||y)){var j=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(R,"loading"),U=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(R,"playing"),K=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domClosest)("post",R),"ad-view"),k=(U?Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domNS)(R):R).getBoundingClientRect();if(k.width&&k.height){var x=k.top>h&&k.bottom<P;if(K&&!T&&(x=k.bottom>h&&k.bottom<P||k.top>h&&k.top<P),x){if(!U&&!j){var S=E(R),N=Date.now();s=R,Object(_lib_video__WEBPACK_IMPORTED_MODULE_17__.showInlineVideo)(S.video,S.list,{autoplay:1,no_progress:1,cache:1,addParams:S},!1,R),Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("page_show_inline_video",Date.now()-N),m(S),cur.videoAutoplayStat={video:S.video,launched:Date.now(),preloaded:O(S.video)}}break}if(!d&&k.top<=h)break}}}var F=W+1;if(d){if(!D)return;F=W-1}do{var H=b[F];if(H&&(p||Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(H,"duration"))<=300)){var V=E(H);O(V.video)||Object(_lib_video__WEBPACK_IMPORTED_MODULE_17__.loadInlineVideo)(V,w,!0);break}}while(++F<g&&!d)}}}),50);cur.videoAutoplayScrollHandler=b,addEvent(window,"scroll",b),addEvent(window,"resize",b),d&&!cur.imClassicInterface&&addEvent(window,"imScroll",b),b(),cur.destroy.push((function(){removeEvent(window,"scroll",b),removeEvent(window,"resize",b),removeEvent(window,"imScroll",b),b=null,delete cur.videoAutoplayScrollHandler}))}function E(_){return{video:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"video"),ad_data:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"ad-data"),ad_block_id:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"ad-block-id"),list:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"list"),post_id:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domClosest)("post",_),"post-id"),stretch_vertical:Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"stretch-vertical")),autoplay:1,from_autoplay:1,module:currentModule()}}function O(_){var e=!1;return each(window.ajaxCache,(function(t,o){if(0==t.indexOf("/al_video.php?act=show_inline")&&t.indexOf("&video="+_)>0)return e=!0,!1})),e}function m(_){ajax.post("al_video.php?act=autoplay_stat",{event:"load",video:_.video,post_id:_.post_id,module:cur.module||""},{})}function w(_,e){if(_){var t=e[3].player.params[0];VideoPlayer.preload(t)}}},actionsDropdown:function(_,e){_||!e?Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)(_):e()},actionsDropdownHide:function(_,e,t){if(1===e)return t&&t(),hide(_);clearTimeout(cur.actDdHide),cur.actDdHide=setTimeout((function(){Object(_lib_fx__WEBPACK_IMPORTED_MODULE_18__.fadeOut)(_,200,hide.pbind("page_actions_sublist")),t&&t()}),150)},actionsDropdownUnhide:function(){clearTimeout(cur.actDdHide)},actionsDropdownLocked:function(_){if(_=ge(_))return hasClass(_,"page_actions_item_lock")},lockTimeout:null,resetLockTimeout:null,actionsDropdownLock:function(_){(_=ge(_))&&hasClass(_,"page_actions_item")&&!hasClass(_,"page_actions_item_lock")&&(Page.lockTimeout&&clearTimeout(Page.lockTimeout),Page.resetLockTimeout=!1,Page.lockTimeout=setTimeout((function(){if(!Page.resetLockTimeout){Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.data)(_,"inner",_.innerHTML),addClass(_,"page_actions_item_lock");var e=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ce)("div",{className:"page_actions_item_lock_text"});val(e,_.innerHTML),_.appendChild(e),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_9__.showProgress)(_)}}),500))},actionsDropdownUnlock:function(_){Page.resetLockTimeout=!0,(_=ge(_))&&hasClass(_,"page_actions_item")&&hasClass(_,"page_actions_item_lock")&&(Page.lockTimeout&&clearTimeout(Page.lockTimeout),removeClass(_,"page_actions_item_lock"),_.innerHTML=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.data)(_,"inner"))},actionsPreloadFeedLists:function actionsPreloadFeedLists(el,sh){ajax.post("al_feed.php",{act:"a_get_lists_by_item",item_id:cur.oid},{onDone:function onDone(html,js){if(sh&&!ge("page_actions_wrap")){Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(el).appendChild(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.se)(html),el);try{eval(js)}catch(_){Object(_lib_debug_tools__WEBPACK_IMPORTED_MODULE_12__.logEvalError)(_,js)}}},cache:1})},feedListsDDShow:function(){var _=ge("page_actions_item_lists");if(addClass(_,"page_actions_item_unfolded"),ge("page_actions_sublist"))return clearTimeout(cur.feedListsDDHide),void Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.show)("page_actions_sublist");var e=[];for(var t in cur.options.feedLists){var o=cur.options.feedLists[t];o.length>20&&(o=Object(_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)(o.substr(0,18))+"..."),e.push('<a id="page_feed_item'+t+'" class="page_actions_item page_actions_subitem'+(cur.options.feedListsSet&&cur.options.feedListsSet[t]?" checked":"")+'" onclick="Page.feedListsCheck(this, '+t+');">'+o+"</a>")}e=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.se)('<div id="page_actions_sublist" onmouseover="Page.feedListsDDShow();">'+e.join("")+"</div>"),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPN)(_).appendChild(e)},feedListsDDHide:function(){clearTimeout(cur.feedListsDDHide),cur.feedListsDDHide=setTimeout((function(){hide("page_actions_sublist"),removeClass("page_actions_item_lists","page_actions_item_unfolded")}),150)},feedListsCheck:function(_,e){var t=hasClass(_,"checked");t?(cur.options.feedListsSet[e]=0,cur.options.feedListsChanges[e]=-1):(cur.options.feedListsSet[e]=1,cur.options.feedListsChanges[e]=1),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.toggleClass)(_,"checked",!t),cur.feedListsTO&&clearTimeout(cur.feedListsTO);var o=[];for(var i in cur.options.feedListsChanges)o.push(cur.options.feedListsChanges[i]*i);o.length&&(cur.feedListsTO=setTimeout((function(){ajax.post("al_feed.php",{act:"a_toggle_lists",item_id:cur.oid,lists_ids:o.join(","),hash:cur.options.feedListsHash},{onDone:function(){cur.options.feedListsChanges={}}})})))},addAudioPreview:function(_,e){return e[AudioUtils.AUDIO_ITEM_INDEX_CONTEXT]="attach_preview",AudioUtils.drawAudio(e,"inlined")},ownerButtonClick:function(_,e,t){if(!Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.checkEvent)(t)){switch(_.type){case"open_url":if(_.is_internal&&_.open_in_layer){var o=nav.fromStr(_.url),i=o[0].replace("/","");return delete o[0],Object(_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.showWiki)({w:i},null,null,{ads_params:o})}return nav.go(e,t)}return!1}},postAttachesShowMore:function(_,e){var t=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPS)(_);if(t&&hasClass(t,"post_cropped_attaches")){var o=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domPS)(t),i=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domFC)(t);["wall_audio_rows","post_media","post_thumbed_media"].some((function(_){return hasClass(o,_)&&hasClass(i,_)}))&&(Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domChildren)(i).forEach((function(_){o.appendChild(_)})),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)(i));var a=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.cf)(t.innerHTML);Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domInsertBefore)(a,t),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)(t),Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.re)(_);var l=Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.gpeByClass)("post",_),s=l?Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(l,"post-id"):"";if(s){var r="feed"===cur.module&&feed?feed.getModuleRef():cur.module;Object(_lib_stats__WEBPACK_IMPORTED_MODULE_14__.statlogsValueEvent)("post_activity","expand_attach",s,r)}}return e&&Object(_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(e)},showLoginBox:()=>(Object(_lib_message_box__WEBPACK_IMPORTED_MODULE_8__.showBox)("al_login.php",{act:"box"}),!1),playVkFestBanner(){window.onDomReady((function(){setTimeout((function(){checkMp4((function(){!function(){var _=ge("vk_fest_2020_banner_video");if(_){var e={video:Object(_lib_dom__WEBPACK_IMPORTED_MODULE_3__.domData)(_,"video"),module:currentModule()};Object(_lib_video__WEBPACK_IMPORTED_MODULE_17__.showInlineVideo)(e.video,"",{autoplay:1,no_progress:1,cache:1,addParams:e},!1,_)}}()}))}))}))}};__webpack_exports__.default=Page},"oK+H":function(_,e,t){"use strict";t.r(e),t.d(e,"createPostTooltip",(function(){return a}));var o=t("zxIV"),i=t("k487"),a=(_,e,t)=>{var a=e||"",l=_+a,s=Object(o.ge)(l),r=Object(o.geByClass1)("post_action_tt_content",s),n=Object(o.geByClass1)("post_action_btn_layout",s),d=r.children;if(window.radioBtns["post_settings_btn"+_+a]={val:!1,els:d},!Object(o.hasClass)(s,"disabled")){var c=[-12*(window.vk.rtl?-1:1),7],p=new i.default(n,{appendTo:s,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:c,content:r,align:"left",onFirstTimeShow:()=>{Object(o.show)(r)}});return cur[_+a]=p,cur.destroy.push((function(){p&&p.destroy()})),t&&(cur[_+a+"_onChange"]=t),{toooltip:p}}}},qwyz:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("HEwt"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("rGqo"),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("rE2o"),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("ioFf"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("OG14"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("a1Th"),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("Btvt"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("Oyvg"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("KKXr"),core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("91GP"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("pIFo"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("SRfc"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("zxIV"),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("/PiP"),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("Egk5"),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("FWc3"),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("EasH"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("v+DW"),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("Xrg9"),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("t7n3"),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("kcIO"),_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("XzvV"),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("lXE5"),_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("7jxN"),_web_lib_video__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("Ia1d"),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("4+be"),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("cGUQ"),_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("t/FQ"),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("QGEU"),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("98sY"),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("o7bv"),_web_lib_utils__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("aong"),_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("D1OX"),_web_donut__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("7GuL"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("YIAi"),_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("te1c"),_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("hzb7"),_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("jE6c"),_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("oK+H"),_internal_nospam_common__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("FThC"),_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("DfBR"),_web_lib_date__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__("1BRX");function _slicedToArray(_,e){return _arrayWithHoles(_)||_iterableToArrayLimit(_,e)||_unsupportedIterableToArray(_,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(_,e){if(_){if("string"==typeof _)return _arrayLikeToArray(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);return"Object"===t&&_.constructor&&(t=_.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(_,e):void 0}}function _arrayLikeToArray(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}function _iterableToArrayLimit(_,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(_)){var t=[],o=!0,i=!1,a=void 0;try{for(var l,s=_[Symbol.iterator]();!(o=(l=s.next()).done)&&(t.push(l.value),!e||t.length!==e);o=!0);}catch(_){i=!0,a=_}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return t}}function _arrayWithHoles(_){if(Array.isArray(_))return _}var Wall={LS_ADS_EVENTS:"ads.events",deleteAll:function(_,e,t){ajax.post("al_wall.php",{act:"delete_all",post:e,hash:t},{onDone:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_));t.oldt=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(t,e)},showProgress:function(){hide(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{className:"progress"})))},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_))}})},restoreAll:function(_,e,t){var o=Math.floor(1e5*Math.random());cur.wallRnd=o,ajax.post("al_wall.php",{act:"restore_all",post:e,hash:t,rnd:o},{onDone:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(t,t.oldt)},showProgress:function(){hide(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span",{className:"progress_inline"})))},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_))}})},deleteThread:function(_,e,t){ajax.post("al_wall.php",{act:"delete_thread",post:e,hash:t,from_deleted:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(ge("post"+e),"reply_deleted")},{onDone:function(t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("dld_inner",_);if(o)o.oldElements=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(o,t);else{var i=ge("post"+e),a=geByClass1("reply_wrap",i);hide(a),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{id:"post_del"+e,className:"dld",innerHTML:'<span class="dld_inner">'+t+"</span>"}),i.appendChild(o)}hide("replies_wrap_deep"+e)},showProgress:function(){hide(_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post_actions",_);if(e)addClass(e,"post_actions_progress");else{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_);t||(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{className:"progress"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_).appendChild(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(t))}},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post_actions",_);e?removeClass(e,"post_actions_progress"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_))}})},restoreThread:function(_,e,t){ajax.post("al_wall.php",{act:"restore_thread",post:e,hash:t},{onDone:function(){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("replies_wrap_deep"+e),t.oldElements)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(t,t.oldElements);else{var o=geByClass1("reply_wrap","post"+e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("post_del"+e)}},showProgress:function(){hide(_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_);e||(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{className:"progress"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_).appendChild(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(e))},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_))}})},block:function(_,e,t,o,i){ajax.post("al_wall.php",{act:"block",post:e,hash:t,bl:o,from:i},{onDone:function(e){o?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_).insertBefore(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span",{innerHTML:e}),_),hide(_)):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_))),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_)))},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.showProgress)(_,"post_inline_progress","post_inline_progress",!0)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("post_inline_progress")}})},blockEx:function(_,e){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showBox)("groupsedit.php",{act:"bl_edit",name:"id"+e,gid:_,auto:1},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})},withMentions:!(browser.mozilla&&browser.version.match(/^2\./)||browser.mobile),editPost:function(_,e,t,o,i){if(cur.editingPost&&ge("wpe_text")){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wall_posts",ge("wpe_text"));if(!a||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(a))return o&&o(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.notaBene)("wpe_text");Wall.cancelEdit()}cur.editingPost=[e],Wall.withMentions?stManager.add(["ui_controls.css","ui_controls.js","mentions.js",jsc("web/wall_edit.js")]):stManager.add([jsc("web/wall_edit.js")]),ajax.post("al_wall.php",extend({act:"edit",post:e,mention:Wall.withMentions?1:""},t),{onDone:function(){var _=Array.prototype.slice.call(arguments);if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(_[4])&&cur.options&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(cur.options.filter_media_types)){var t=[];each(_[4],(function(_,e){each(cur.options.filter_media_types,(function(_,o){if(e[0]===o[0])return t.push(o),!1}))})),_[4]=t}_.unshift(e),WallEdit.editPost.apply(window,_),i&&i()},onFail:function(){cur.editingPost=!1,o&&o()},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(_):addClass(geByClass1("post_actions","post"+e),"post_actions_progress")},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(_):removeClass(geByClass1("post_actions","post"+e),"post_actions_progress")},noSort:!0})},fixPost:function fixPost(link,post,hash,value){return ajax.post("al_wall.php",{act:"a_fix_post",post,hash,value},{onDone:function onDone(js){if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__.logEvalError)(_,js)}var postEl=cur.wallLayer==post?ge("wl_post"):ge("post"+post);each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post_fixed"),(function(){removeClass(this,"post_fixed")})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(postEl,"post_fixed",value),link&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(link,getLang(value?"wall_unfix_post":"wall_fix_post")),link.onclick=function(){return Wall.fixPost(link,post,hash,value?0:1)}),cur.onWKFix&&(cur.onWKFix(value),delete cur.onWKFix)},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(link,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind("wpe_fix"+post)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(link,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind("wpe_fix"+post)}}),!1},cancelEdit:function(_){if(cur.editingPost){if(!0===_&&cur.editingPost[0].match(/^-?\d+_/))return;window.WallEdit?WallEdit.cancelEditPost():cur.editingPost=!1}},searchWall:function(){},switchTabContent:function(_){switch(hide("page_wall_posts","page_postponed_posts","page_suggested_posts","page_search_posts","page_top_posts","page_archive_posts","page_donut_posts"),_){case"own":case"all":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_wall_posts");break;case"postponed":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_postponed_posts"),hide("wall_more_link");break;case"suggested":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_suggested_posts");break;case"search":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_search_posts");break;case"top":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_top_posts");break;case"archive":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_archive_posts");break;case"donut":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_donut_posts")}},switchWall:function(_,e,t){if(e&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(e))return!0;if(t||(t="own"==cur.wallType?"all":"own"),e&&"click"==e.type&&e.clientX&&e.offsetX&&cur.wallTab==t&&cur.wallType==t&&"top"!==t)return nav.go(_,e);if("postponed"==cur.wallTab&&wall.checkPostponedCount(),"archive"!==cur.wallTab&&"archive"!==t||((cur.wallLayer?wkcur:cur).wallMyDeleted={}),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(cur.wallArchiveFeatureTooltipHide)&&cur.wallArchiveFeatureTooltipHide(),!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(t,["top","archive","donut"])){var o=ge("page_wall_posts");removeClass(o,"own"),removeClass(o,"all"),addClass(o,t)}cur.wallType=t,cur.wallTab=t,uiTabs.switchTab(_),uiTabs.hideProgress(_),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(t,["top","archive","donut"])?(cur.baseWallModule=cur.module,cur.module="wall_"+t,cur.topWallFeatureTT&&cur.topWallFeatureTT.hide()):cur.baseWallModule&&(cur.module=cur.baseWallModule,delete cur.baseWallModule);var i="donut"===t&&Wall.cantAccessDonutPosts();return Wall.hasPosts()||i?(Wall.update(),Wall.showWall()):(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,cur.wallArchiveRestored=0,cur.wallArchiveArchived=0,cur.wallArchiveRolledback=0,cur.wallDonutNextFrom=0,"top"===t?delete cur.wallTopFinished:"archive"===t?delete cur.wallArchiveFinished:"donut"===t&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_)),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e)},resetWall:function(){if(cur.wallType&&cur.wallTab){var _=geByClass1("_wall_tab_"+cur.wallType);_&&(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,(cur.wallLayer?wkcur:cur).wallMyDeleted={},"top"===cur.wallType?delete cur.wallTopFinished:"archive"===cur.wallType?delete cur.wallArchiveFinished:"donut"===cur.wallType&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_,!0))}},hasPosts:function(_){_=_||cur.wallType;var e=Wall.getPostsWrap(_);return!!geByClass1("post",e)},getPostsWrap:function(_){switch(_){case"archive":return ge("page_archive_posts");case"top":return ge("page_top_posts");case"donut":return ge("page_donut_posts");default:return ge("page_wall_posts")}},showSuggested:function showSuggested(ev,rows,notAll){if(ev&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(ev))return!0;if(!cur.oid)return!1;var el=ge("page_wall_suggest");if(el=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(el,"unshown")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domQuery1)("#page_wall_suggest_more .ui_tab_group_item"):geByClass1("ui_tab",el),!el)return!1;if(uiTabs.switchTab(el),cur.wallTab="suggested",delete cur.suggestedDeletedCount,void 0!==rows)wall.suggestLoaded(rows,notAll);else{if(cur.suggestedLoading)return!1;var curOid=cur.suggestedLoading=cur.oid;uiTabs.showProgress(el),ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid},{onDone:function onDone(rows,notAll,js,count){if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__.logEvalError)(_,js)}cur.suggestedLoading=!1,uiTabs.hideProgress(el),Wall.updateTabCounter("page_wall_suggested_cnt",count),curOid===cur.oid&&"suggested"==cur.wallTab&&wall.suggestLoaded.apply(window,arguments)}})}return!1},deleteSuggested:function(_,e,t,o){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isButtonLocked)(o)){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(o);var i=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)({title:getLang("global_action_confirmation"),onHide:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(o)}},getLang("wall_delete_suggested_box"),getLang("wall_delete_suggested_btn"),(function(o){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isButtonLocked)(o)||(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(o),ajax.post("al_wall.php",{act:"delete_suggested",post_id:_,hash:t,group_id:e},{onDone:function(_){if("full_own"==cur.wallType||"full_all"==cur.wallType){var e=(Math.ceil(_/cur.pgPerPage)-1)*cur.pgPerPage;e<cur.pgOffset&&(e>0?nav.objLoc.offset=e:delete nav.objLoc.offset,nav.setLoc(nav.objLoc)),nav.reload()}else Wall.showSuggested();i.hide()},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(o)}))}),getLang("global_cancel"))}},suggestLoaded:function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_suggested_posts",_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)("wall_more_link",e),wall.switchTabContent("suggested")},suggestMore:function(){var _=ge("page_suggested_posts"),e=ge("wall_more_link");Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isButtonLocked)(e)||ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid,offset:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post",_).length-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("dld",_).length},{onDone:function(t,o){for(var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:t}),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(i);a;)ge(a.id)||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"post")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(a):_.appendChild(a),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(i);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)(e,o)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(e)})},suggestUpdate:function(_){var e=ge("page_suggests_count"),t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e));e&&(-1!==_&&1!==_||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,t+=_),Wall.updateTabCounter("page_wall_suggested_cnt",t))},suggestPublished:function(_,e,t){if(cur.onepost)return nav.go("/wall"+cur.oid);if(Wall.suggestUpdate(-1),Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.showDoneBox)(e),cur.wallMyDeleted[_]=1,cur.editingPost=!1,Wall.deinitComposer(ge("wpe_text")),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),cur.postWpeIsPoster=!!cur.posterWpeSendParams,cur.posterWpe&&cur.posterWpeSendParams&&WallEdit.posterDestroy(),t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_postponed_posts",t),wall.postponeUpdateCount()),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_suggests_count")))Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("post"+_);else{var o=ge("wall_rmenu");o?(geByClass1("ui_rmenu_item",o).click(),hide(geByClass1("_wall_menu_suggested",o))):ge("wall_tabs")&&(geByClass1("ui_tab",ge("wall_tabs")).click(),wall.updateTabVisibility("page_wall_suggest",!1))}},showDonutWall:function(_){if(!cur.oid)return!1;Wall.updateTabVisibility("page_wall_donut",!0);var e=Wall.getWallTabLink("donut");if(!e)return!1;uiTabs.switchTab(e),cur.wallTab="donut",cur.wallType="donut",void 0!==_&&Wall.donutWallSetRows(_)},donutWallSetRows(_){var e=Wall.getPostsWrap("donut");e&&(e.innerHTML=_,Wall.switchTabContent("donut"),Wall.update())},getWallTabLink:_=>{var e=ge("page_wall_"+_);return(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"unshown")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domQuery1)(`#page_wall_${_}_more .ui_tab_group_item`):geByClass1("ui_tab",e))||null},showPostponedFull:function(_){var e=ge("ui_rmenu_postponed"),t=ge("page_wall_posts");if(!e||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"ui_rmenu_item_sel")||!t){var o={0:nav.objLoc[0],postponed:1};return nav.go(o)}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(t,_),FullWall.updateSummary(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post",t).length)},showPostponed:function(_,e){if(_&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(_))return!0;if(!cur.oid)return!1;var t=ge("page_wall_postponed");if(!(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"unshown")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domQuery1)("#page_wall_postponed_more .ui_tab_group_item"):geByClass1("ui_tab",t)))return!1;if(uiTabs.switchTab(t),cur.wallTab="postponed",void 0!==e)Wall.postponedLoaded(e);else{if(cur.postponedLoading)return!1;var o=cur.postponedLoading=cur.oid;uiTabs.showProgress(t),ajax.post("al_wall.php",{act:"get_postponed",owner_id:cur.oid},{onDone:function(_){cur.postponedLoading=!1,uiTabs.hideProgress(t),o===cur.oid&&"postponed"==cur.wallTab&&Wall.postponedLoaded(_)}})}return!1},postponedLoaded:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_postponed_posts",_),wall.postponeUpdateCount(),wall.switchTabContent("postponed")},postponeUpdateCount:function(){var _=ge("page_postponed_posts"),e=_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post",_).length-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("dld",_).length||0;_&&Wall.updateTabCounter("page_wall_postponed_cnt",e)},checkPostponedCount:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post","page_postponed_posts"),e=0;each(_,(function(){var _=this.id.replace("post","");cur.wallMyDeleted[_]||e++})),e||wall.updateTabVisibility("page_wall_postponed",!1)},updateTabCounter:function(_,e){e=e?Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,"%s",!0):"",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)(_).forEach((function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_,e);var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"ui_tab_group_item")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"default-label",t.innerHTML)}))},updateTabVisibility:function(_,e){var t=ge("page_wall_more_tab");if(t)if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(t))if(e){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"unshown")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_+"_more","unshown")){var o=!1;cur.wallTabsMorePriority.forEach((function(e){o||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"unshown")||(addClass(e,"unshown"),removeClass(e+"_more","unshown"),removeClass(_,"unshown"),o=!0)})),o||removeClass(_+"_more","unshown")}}else{var i=ge(_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"unshown"))addClass(ge(_+"_more"),"unshown");else{addClass(i,"unshown");var a=cur.wallTabsLimit-1-Object(_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_40__.getNavigableTabs)(t).length;if(a>0){var l=a;cur.wallTabsMorePriority.forEach((function(_){if(!(l<=0)){var e=ge(_+"_more");e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"unshown")&&(removeClass(ge(_),"unshown"),addClass(e,"unshown"),l--)}}))}}var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("ui_tab_group_item",t);s.length-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("unshown",t).length<=1&&(s.forEach((function(_){_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"unshown")||(removeClass(ge(_.id.replace(/_more$/,"")),"unshown"),addClass(_,"unshown"))})),addClass(t,"unshown"))}else{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(ge(_),"unshown",!e);var r=Object(_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_40__.getNavigableTabs)(t).length;if(r>cur.wallTabsLimit){var n=r-(cur.wallTabsLimit-1);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("ui_tab_group_item",t).forEach((function(_){addClass(_,"unshown")})),cur.wallTabsMorePriority.forEach((function(_){if(!(n<=0)){var e=ge(_);e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"unshown")&&(addClass(e,"unshown"),removeClass(ge(_+"_more"),"unshown"),n--)}})),removeClass(t,"unshown"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.statlogsValueEvent)("wall_more_tab_shown",cur.oid)}}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(ge(_),"unshown",!e)},postponedPublished:function(_,e){if(cur.onepost)return nav.go("/wall"+cur.oid);"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.showDoneBox)(e),cur.wallMyDeleted[_]=1;var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post",ge("page_postponed_posts")),o=ge("post"+_);if(t.length<=1&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(o,t)){var i=ge("wall_rmenu");i?(geByClass1("ui_rmenu_item",i).click(),hide(geByClass1("_wall_menu_postponed",i))):ge("wall_tabs")&&(geByClass1("ui_tab",ge("wall_tabs")).click(),wall.updateTabVisibility("page_wall_postponed",!1))}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(o),wall.postponeUpdateCount()},onWallSearchSend:function(_,e){e?Wall.showSearch(e,0):Wall.hideSearch()},showSearch:function(_,e){if(cur.searchLoading&&cur.searchLoading==_||!cur.oid)return!1;var t=cur.oid;cur.wallQuery=cur.searchLoading=_,"search"!=cur.wallTab&&(cur.prevWallTab=cur.wallTab,cur.wallTab="search");var o=ge("wall_more_link"),i=+new Date;return ajax.post("al_wall.php",{act:"s",search:1,q:_,owner_id:cur.oid,offset:e,inline:1,owners_only:1},{onDone:function(a,l,s){if(t===cur.oid&&"search"==cur.wallTab){var r=ge("page_search_posts");e||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(r,""),r.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(a)),wall.switchTabContent("search"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)(o,l<s),o.onclick=Wall.showSearch.pbind(_,l);var n=cur.oid>0?_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.serviceWallUsers:_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.serviceWallGroups,d=+new Date-i;Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.saveSearchAttemptStats)(n,0,s,_,0,0,d)}},showProgress:function(){uiSearch.showProgress("wall_search"),e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(o)},hideProgress:function(){cur.searchLoading=!1,uiSearch.hideProgress("wall_search"),e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(o)}}),!1},hideSearch:function(){if(delete cur.wallQuery,cur.prevWallTab){var _=(cur.oid,_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.serviceWallUsers);Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.removeSearchPositionTracker)(_),cur.wallTab=cur.prevWallTab,cur.prevWallTab=!1,wall.switchTabContent(cur.wallTab),wall.update()}},publishPostponedPost:function(_,e,t){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("publish_postponed_title"),getLang("publish_postponed_confirm"),getLang("publish_postponed_btn"),(function(){Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)().hide(),ajax.post("al_wall.php",{act:"publish_postponed",post:_,from:t,hash:e},{onDone:Wall.postponedPublished.pbind(_),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind("wpe_publish"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind("wpe_publish"+_)})}),getLang("global_cancel"))},publishFreeDonutCopy:function(_,e,t,o){var i=_.currentTarget,a=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("wall_publish_donut_as_free_confirmation_title"),getLang("wall_publish_donut_as_free_confirmation_confirm"),getLang("wall_publish_donut_as_free_confirmation_btn"),()=>{var _=()=>{a.hide()},l=a.btns.ok[0];ajax.post("al_wall.php",{act:"publish_free_donut_copy",post_id:e,from:o,hash:t},{onDone:e=>{Wall.publishFreeDonutCopyDone({menuActionEl:i,message:e}),_()},onFail:()=>{_()},showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(l)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(l)}})},getLang("global_cancel"))},publishFreeDonutCopyDone(_){var e=_.message,t=_.menuActionEl;"full_own"!==cur.wallType&&"full_all"!==cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.showDoneBox)(e,{timeout:3e3}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t)},cmp:function(_,e){var t=_.length,o=e.length;return t<o?-1:t>o?1:_<e?-1:_>e?1:0},receive:function(_,e,t,o){o=!0===o;var i,a,l,s,r="top"===(t=t||cur.wallType),n="archive"===t,d="donut"===t,c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:_}),p=!!cur.options.revert,u=Wall.getPostsWrap(t),b=[],E=[],O=["page_top_posts","page_wall_posts","page_archive_posts","page_donut_posts"],m=0;if(o)E=O;else{var w=[[n,"page_archive_posts"],[r,"page_top_posts"],[d,"page_donut_posts"],[!0,"page_wall_posts"]].find(_=>_slicedToArray(_,1)[0]),g=_slicedToArray(w,2)[1];E=O.filter(_=>_!==g),l=p?u.firstChild:u.lastChild}function h(_){return!!(_&&_.tagName&&"div"===_.tagName.toLowerCase()&&_.id&&"post"===_.id.substr(0,4))&&_.id}E.forEach((function(_){if("page_donut_posts"!==_||!ge("wall_donut_info"))for(var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(ge(_));e;){var t=e;e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(e),t.tagName&&"input"===t.tagName.toLowerCase()||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t)}}));for(var P=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(p?c.firstChild:c.lastChild);P;P=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(p?c.firstChild:c.lastChild))if("input"!=P.tagName.toLowerCase()){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(P,"post_fixed")||!ge(P.id))if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(P,"_ads_promoted_post"))b.push({el:P,beforePost:h(p?c.firstChild:i),afterPost:h(p?i:c.lastChild)});else{for(;l&&l.tagName&&"div"==l.tagName.toLowerCase()&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(l,"post_fixed")&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(l,"_ads_promoted_post")||!r&&!n&&Wall.cmp(l.id,P.id)<0);)l=p?l.nextSibling:l.previousSibling;++m,l?Wall.cmp(l.id,P.id)?(s=l,(a=p?l.previousSibling:l.nextSibling)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"_ads_promoted_post")&&(s=a),p?(u!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(s)&&Wall.sendInsertBeforeError(),u.insertBefore(P,s)):(u!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(s.nextSibling)&&Wall.sendInsertBeforeError(),u.insertBefore(P,s.nextSibling))):(u.replaceChild(P,l),l=P,--m):p?u.appendChild(P):u.insertBefore(P,u.firstChild),i=P,Object(_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_30__.placeholderSetup)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByTag1)("textarea",P),{fast:1})}}else{var D=ge(P.id);D?u.replaceChild(P,D):u.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(P,u.firstChild):u.appendChild(P)}if(b.length)for(var M=0,v=b.length;M<v;++M){var f=b[M];if(f.beforePost||f.afterPost){for(var C="no_position",T=p?u.firstChild:u.lastChild;T;T=p?T.nextSibling:T.previousSibling){s=null;var A=h(T);if(A){if(f.beforePost===A?s=T:f.afterPost===A&&(s=T.nextSibling),s&&(s.previousSibling&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(s.previousSibling,"_ads_promoted_post")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(s,"_ads_promoted_post"))){s=null,C="ads_sibling";break}if(s){u!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(s)&&Wall.sendInsertBeforeError(),u.insertBefore(f.el,s),C=!1;break}}}C&&Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.statlogsValueEvent)("debug_watch",1,"js_page_ads_promoted_post_no_position",C)}}r&&!m?cur.wallTopFinished=cur.oid:n&&!m?cur.wallArchiveFinished=cur.oid:d&&!m&&(cur.wallDonutFinished=cur.oid),"full_own"!==t&&"full_all"!==t||(Pagination.recache(m),FullWall.updateSummary(cur.pgCount)),Wall.update(),wall.addReplyNames(e),Wall.updateMentionsIndex(),m&&Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_13__.getAudioPlayer)().updateCurrentPlaying()},showMore:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox();if(!cur.wallLayer){if("suggested"===cur.wallTab)return Wall.suggestMore();if(!(cur.wallTypeLoading&&cur.wallTypeLoading[cur.wallType]||"top"===cur.wallType&&cur.wallTopFinished===cur.oid||"archive"===cur.wallType&&cur.wallArchiveFinished===cur.oid||"donut"===cur.wallType&&cur.wallDonutFinished===cur.oid)){var o=cur.wallType,i="top"===o,a="archive"===o,l="donut"===o,s=ge("wall_more_link"),r=cur.wallLoading=cur.oid,n=i&&!!cur.wallTopOnlyCache,d="";0!==_&&(d=a?cur.wallArchiveNextFrom:i?cur.wallTopNextFrom:l?cur.wallDonutNextFrom:cur.wallNextFrom),cur.wallTypeLoading=cur.wallTypeLoading||{},cur.wallTypeLoading[o]=!0,t=!0===t&&!_,ajax.post("al_wall.php",{act:"get_wall",owner_id:cur.oid,offset:_,type:o,fixed:cur.options.fixed_post_id||"",wall_start_from:d,onlyCache:n},{onDone:function(s,n,d,c){return e&&uiTabs.hideProgress(e),r!==cur.oid||o!==cur.wallType?(delete cur.wallLoading,void delete cur.wallTypeLoading[o]):i&&isObject(s)&&s.wait?(cur.wallTopLoadingDelay=cur.wallTopLoadingDelay?cur.wallTopLoadingDelay+100:200,void(cur.wallTopLoadingDelay<500?setTimeout((function(){delete cur.wallLoading,delete cur.wallTypeLoading[o],Wall.showMore(_)}),cur.wallTopLoadingDelay):(delete cur.wallLoading,delete cur.wallTypeLoading[o],cur.wallTopOnlyCache=!1,Wall.showMore(_)))):(delete cur.wallTopLoadingDelay,cur.wallVideos&&each(d,(function(_,e){cur.wallVideos[_]&&(cur.wallVideos[_].list=cur.wallVideos[_].list.concat(e.list))})),a?cur.wallArchiveNextFrom=c:i?cur.wallTopNextFrom=c:l?cur.wallDonutNextFrom=c:cur.wallNextFrom=c,void setTimeout((function(){Wall.receive(s,n,o,t),_||o!==cur.wallType||Wall.showWall(),delete cur.wallLoading,delete cur.wallTypeLoading[o]}),0))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(s),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(s)})}}},showWall:function(){wall.switchTabContent(cur.wallType);var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("wall_module",ge("page_wall_posts")))[1];_<Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)()&&Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(_-15)},checkTextLen:function(_,e,t){var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Emoji.editableVal(_).replace(/\n\n\n+/g,"\n\n"));if(_.lastLen!==o.length||t){var i=_.lastLen=o.length,a=(cur.options||{}).max_post_len||(window.mvcur||{}).maxReplyLength,l=i-o.replace(/\n/g,"").length;e=ge(e),i>a-100||l>4?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(e),e.innerHTML=i>a?getLang("global_recommended_exceeded",i-a):l>4?getLang("global_recommended_lines",l-4):getLang("text_N_symbols_remain",a-i)):hide(e),window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()}else window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()},checkPostLen:function(_,e,t,o){var i=ge(_);if(t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(t).replace(/\n\n\n+/g,"\n\n"),i&&(i.lastLen!==t.length||o)){var a=i.lastLen=t.length,l=cur.options.max_post_len,s=a-t.replace(/\n/g,"").length,r=ge(e);a>l-100||s>4?(r.innerHTML=a>l?getLang("global_recommended_exceeded",a-l):s>4?getLang("global_recommended_lines",s-4):getLang("text_N_symbols_remain",l-a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(r)):hide(r)}},postChanged:function(_){var e=Wall.isPosterEditorOpen();if((e||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)("submit_post"))&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(ge("submit_post_box"),"shown")||Wall.showEditPost(),vk.id&&!vk.widget&&!cur.options.no_draft){clearTimeout(cur.postAutosave);var t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(cur.oid)==vk.id?Wall.saveDraft:Wall.saveOwnerDraftText.pbind(cur.oid);!0===_?t():cur.postAutosave=setTimeout(t,10===_?10:1e3)}e||setTimeout(Wall.checkPosterAvailability)},ownerDraftKey:function(_){return"wall_draft"+vk.id+"_"+_},ownerDraftData:function(){return cur.wallDraftData||(cur.wallDraftData={}),cur.wallDraftData},addOwnerDraftMedia:function(_,e){if(!cur.options.no_draft){var t=Wall.ownerDraftData(),o=e[0],i=e[1],a=e[2];t._attach_cache=t._attach_cache||{},a?t._attach_cache[o+i]=a:a=t._attach_cache[o+i],t.attaches=t.attaches||[];var l=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get(Wall.ownerDraftKey(_))||{};!1!==o?t.attaches.push([o,i,a,t.attaches.length]):!1===o&&void 0!==i&&(t.attaches=t.attaches.filter((function(_){return _[3]!==i}))),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set(Wall.ownerDraftKey(_),extend(l,{txt:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Wall.getDraftData().message||""),medias:t.attaches}))}},cleanOwnerDraftMedia:function(_){if(!cur.options.no_draft){var e=Wall.ownerDraftData(),t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get(Wall.ownerDraftKey(_))||{};e.attaches=[],_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set(Wall.ownerDraftKey(_),extend({txt:""},t,{medias:[]}))}},saveOwnerDraftText:function(_){if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),!cur.options.no_draft){var e=Wall.ownerDraftData(),t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get(Wall.ownerDraftKey(_))||{},o=Wall.getDraftData(),i=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(o.message||""),a=null;if(e.txt=i,each(t.medias||{},(function(_,e){switch(e[0]){case"postpone":o.postpone&&(t.medias[_][1]=o.postpone,t.medias[_][2].draft=1);break;case"poll":var i=(cur.wallAddMedia||{}).pollData(!0,!0);i&&extend(t.medias[_][2],i);break;case"copyright":var a=(cur.wallAddMedia||{}).copyrightData(!0);a&&extend(t.medias[_][2],a);break;case _web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION:o[_web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION]&&(t.medias[_][2]=Object.assign(t.medias[_][2]||{},{[_web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION]:o[_web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION]}))}})),i&&o.bkg_id&&(a={id:o.bkg_id},cur.poster&&cur.poster.isCustomBkgId(o.bkg_id)&&extend(a,cur.poster.getCustomBkg()),t.bkg_id&&delete t.bkg_id),extend(t,{txt:i,bkg:a}),cur.shareShowImg&&extend(t,{shareShowImg:cur.shareShowImg}),_<0){var l=cur.poster?ge("submit_post_box"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("_submit_post_box",ge("official"));extend(t,{from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(l,"from-oid")||vk.id,signed:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("signed")?1:0}),Object(_web_donut__WEBPACK_IMPORTED_MODULE_33__.fieldValueIsDonutOnlyPost)(l,cur.wallAddMedia)?t.donutOnly=1:delete t.donutOnly}_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set(Wall.ownerDraftKey(_),t)}},getOwnerDraft:function(_){if(cur.options.no_draft)return[];var e=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get(Wall.ownerDraftKey(_))||[],t={from:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e.from),signed:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e.signed),shareShowImg:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e.shareShowImg)};return Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e.donutOnly)&&(t.donutOnly=1),[e.txt,e.medias,!0,t,e.bkg]},saveOwnerDraftMedia:function(_,e,t,o){if(!cur.options.no_draft){Wall.cleanOwnerDraftMedia(_);var i=cur.wallAddMedia||{},a=[],l=(cur.wallAddMedia?i.getMedias():[]).slice().map((function(_){return _.slice(0,2)}));void 0!==t&&e?a=[[e,t,o]]:e||void 0===t||l.splice(t,1),l=l.concat(a),each(l,(function(){Wall.addOwnerDraftMedia(_,this)}))}},saveDraft:function(){if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),!cur.options.no_draft)if(cur.noDraftSave)cur.noDraftSave=!1;else if(!cur.postSent&&vk.id==Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(cur.oid)){var _=Wall.getDraftData();_.delayed||ajax.post("al_wall.php",Wall.fixPostParams(extend({act:"save_draft",hash:cur.options.post_hash},_)),{onFail:function(){return!0}})}},getDraftData:function(){if(cur.options.no_draft)return{};var _=cur.wallAddMedia||{},e=_.chosenMedia||{},t=cur.wallAddMedia?_.getMedias():[],o=_.shareData||{},i="",a=0,l=null;if(Wall.isPosterEditorOpen())l=(i=cur.poster.getText())?cur.poster.getBkgId():null;else{var s=ge("post_field");i=window.Emoji?Emoji.editableVal(s):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(s),i=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(i)}var r={message:i,bkg_id:l};return Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(e)&&e.length&&t.push(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(e)),t.length&&each(t,(function(e,t){if(t){var l=this[0],s=this[1];switch(l){case"poll":var n=_.pollData(!0,!0);if(!n)return r.delayed=!0,!1;s=n.question,delete n.question,r=extend(r,n);break;case"copyright":var d=_.copyrightData(!0);if(d)return void(r=extend(r,d));break;case"share":if(o.failed||!o.title&&(!o.images||!o.images.length)&&!o.photo_url&&!o.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(r.delayed=!0,!1):void 0;o.video?(s=o.video_owner_id+"_"+o.video_id,r.snippet_video=1):s=o.user_id&&o.photo_id&&!o.noPhoto?o.user_id+"_"+o.photo_id:"",o.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(i)==o.initialPattern&&(r.message=""),r=extend(r,{url:o.url,mode:o.mode,title:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(o.title),description:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(o.description),button_text:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(o.button_text),button_action:o.button_action,extra:o.extra,extra_data:o.extraData,photo_url:o.video?"":Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(o.photo_url),open_graph_data:(o.openGraph||{}).data,open_graph_hash:(o.openGraph||{}).hash});break;case"page":o.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(i)==o.initialPattern&&(r.message="");break;case"postpone":var c=+_.postponeDate;return void(r=extend(r,{postpone:c}));case"mark_as_ads":return void(r=extend(r,{mark_as_ads:1}));case _web_donut__WEBPACK_IMPORTED_MODULE_33__.ATTACH_DATA_DONUT_DURATION:return void(r=extend(r,Object(_web_donut__WEBPACK_IMPORTED_MODULE_33__.getPostParamsFromDurationMedia)(t)))}this[3]&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(i)==this[3]&&(r.message=""),r["attach"+(a+1)+"_type"]=l,r["attach"+(a+1)]=s,a++}})),r},setDraft:function(_){if(!cur.options.no_draft&&(_[0]||_[1]&&_[1].length||null!=_[4])){var e=ge("post_field");if(e){var t=_[4];t||Emoji.val(e,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(_[0]||"")).replace(/\n/g,"<br/>")),Wall.showEditPost((function(){setTimeout((function(){if(t&&cur.poster){Wall.hidePosterFeatureTooltip();var o={text:_[0]||""};if(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isString)(t)?o.bkgId=_[4]:isObject(t)&&(cur.poster.isCustomBkgId(t.id)&&cur.poster.addCustomBkg(t),o.bkgId=t.id),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(Wall.getMainPostBlock()))return cur.poster.setBkg(o.bkgId,!0),cur.poster.setText(o.text),void Emoji.val(e,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(_[0])).replace(/\n/g,"<br/>"));Wall.openPosterEditor(o)}if(_[1]&&cur.wallAddMedia)for(var i in _[1])cur.noDraftSave=!0,cur.wallAddMedia.chooseMedia.apply(cur.wallAddMedia,_[1][i]);Wall.checkPosterAvailability(),Wall.saveDraft()}),0)})),_[2]&&wall.focusOnEnd(),_[3]&&(wall.setReplyAsGroup(ge("official"),_[3]),_[3].shareShowImg&&(cur.shareShowImgRestored=_[3].shareShowImg),_[3].donutOnly&&cur.wallAddMedia&&cur.wallAddMedia.donutPostSettings&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly()),cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}}},initPostEditable:function(_){var e=cur.postField;if(!e||e.emojiInited)return!1;e.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.init(e,{ttDiff:-42,rPointer:!0,controlsCont:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(e),noStickers:!0,onSend:Wall.sendPost,noEnterSend:!0,ref:"post",checkEditable:Wall.postChanged,initUploadForImagePasteCallback:function(_,e,t){window.Upload&&Upload.onFileApiSend(cur.wallUploadInd,[t])}}),addClass(e,"submit_post_inited"),_?setTimeout(Wall.setDraft.pbind(_),0):cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)})),setTimeout((function(){cur.postFieldZoomText&&addEvent(e,"keydown paste",(function(){setTimeout((function(){cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}),0)}))}),0)},showEditPost:function(_){var e=ge("post_field");if(cur.viewAsBox)return setTimeout((function(){e.blur()}),0),cur.viewAsBox();0!==cur.editing&&(setTimeout(WallUpload.init,0),Wall.initComposer(e,{lang:{introText:getLang("profile_mention_start_typing"),noResult:getLang("profile_mention_not_found")},checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect},_),Wall.hideEditPostReply(),addClass("submit_post_box","shown"),cur.editing=0,Wall.showPosterFeatureTooltip(),Wall.showPostCopyrightFeatureTooltip(),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(cur.onShowEditPost)&&cur.onShowEditPost(),cur.wallAdsReplacedFeatureTooltip&&Wall.showAdsReplacedTooltip(),stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")]))},postBoxFocus:function(_,e){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.stopEvent)(_||window.event);var t=Wall.isPosterEditorOpen();(cur.postField&&window.Emoji||t)&&setTimeout((function(){e?t?(cur.poster.focusPoster(),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(cur.poster.getPosterElement())[1]-15)):(Emoji.focus(cur.postField),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(cur.postField)[1]-15)):t?cur.poster.focusPoster():Emoji.focus(cur.postField,!0,ge("submit_post_box"))}),0)},initComposer:function(_,e,t){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"composer"))t&&t();else if(cur.composerAdded){var o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}else stManager.add(["wide_dd.css","wide_dd.js"],(function(){cur.composerAdded=!0;var o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}))},deinitComposer:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"composer");e&&Composer.destroy(e),_.emojiId&&window.Emoji&&Emoji.destroy(_.emojiId)},hasComposerMedia:function(_){var e=_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"composer");return!(!e||!e.addMedia)&&e.addMedia.attachCount()>0},composerListShown:function(_){var e=_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"composer");if(!e)return!1;var t=e.wdd,o=0;for(var i in t.shown)o+=1;return!!(t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(t.listWrap)&&o)},onPostValChange:function(_){if(cur.wallAddMedia&&cur.wallAddMedia.checkMessageURLs.apply(window,arguments),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||Pagination.pageTopUpdated(),browser.msie&&!_){var e=ge("post_field");hide(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.elfocus)(e)}},onPostItemSelect:function(_){if(_&&!(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_[0])>=0)&&cur.wallAddMedia){var e="vk.com/event"+-_[0];cur.wallAddMedia.checkMessageURLs(e,!0)}},hideEditPost:function(_){cur.editing=!1;var e=ge("post_field"),t=cur.wallAddMedia||{},o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e));!browser.opera_mobile&&e&&(!_&&(o||t.chosenMedia||t.getMedias&&t.getMedias().length>0||t.activeState||t.attachCount&&t.attachCount()>0)||(removeClass("submit_post_box","shown"),e&&!o&&cur.postMention&&(cur.postMention.options.minHeight=cur.emptyPostheight||14),cur.onWallSendCancel&&cur.onWallSendCancel(),window.WallUpload&&WallUpload.hide(),cur.wallAddMedia&&cur.wallAddMedia._hideAddMedia(!0)))},clearInput:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("page_add_media");var _=ge("post_field");if(Wall.withMentions){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"mention");e&&(e.rtaEl.innerHTML="",hide(e.cont),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(_))}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_,""),_.blur(),_.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),Wall.resetPostVisibilityAccess(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)("export_status",!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)("close_comments",!1),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.forEach(_=>{_()});var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"composer");t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t.articleConvertEl),t.articleConvertEl=!1)},fixPostParams:function(_){var e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(_);return e.Message=_.message,delete e.message,e},focusOnEnd:function(_){if(_=ge(_)||ge("post_field"))if("TEXTAREA"!=_.tagName){var e=_.innerHTML?_.innerHTML.length:_.length?_.length:_.childNodes.length-1;if(_.focus(),document.selection){var t=document.selection.createRange();t.moveStart("character",e),t.select()}else window.getSelection().collapse(_,_.childNodes.length)}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.elfocus)(_)},isAnonPost:function(){var _=geByClass1("anon_toggle");return _&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(geByClass1("_ui_toggler",_),"on")?1:""},saveAnon:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(geByClass1("_ui_toggler",_),"on");var e=Wall.isAnonPost();Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)("friends_only",!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)("status_export",!e),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)("facebook_export",!e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(ge("submit_post_box"),"anon_field_on");var t=cur.anonPostBtn||getLang("wall_send");cur.anonPostBtn=ge("send_post").innerHTML,ge("send_post").innerHTML=e?getLang("wall_send"):t},showPostSettings:function(_,e){var t=cur.wallAdsReplacedFeatureTooltip&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"addpost_opt");if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"ett")||t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_);t&&Wall.hideAdsReplacedTT(),new ElementTooltip(_,{cls:"post_settings_tooltip",content:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(o),defaultSide:"top",offset:[0,-5],appendTo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_)}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(o)}e&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkKeyboardEvent)(e)&&"click"===e.type&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"ett").toggle()},saveExport:function(_,e,t){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("friends_only")||Wall.isAnonPost()||Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(_),cur.saveExportTO=cur.saveExportTO||{},clearTimeout(cur.saveExportTO[e]),cur.saveExportTO[e]=setTimeout((function(){ajax.post("/al_settings.php",{act:"a_save_export",service:e,disabled:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(_)?0:1,hash:t})}),300)},togglePostVisibilityAccess:function(_,e,t,o){var i=!!t;if(!Wall.isAnonPost()||i){t=t||"";var a="post_visibility_btn",l=cur[a+t];l&&l.hide(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.radiobtn)(_,e,"post_settings_btn"+a+t);var s=ge("post_visibility_btn"+t),r=i?ge("wpe_status_export"):ge("status_export"),n=i?ge("wpe_facebook_export"):ge("facebook_export"),d=geByClass1("post_action_btn_text",s),c=e!==_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_34__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS;if(c){var p=ge("no_friends_only"+t).innerHTML;d.innerHTML=p,d.setAttribute("aria-label",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(p)),removeClass(s,"on")}else{var u=ge("friends_only"+t),b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(u);d.innerHTML=b,d.setAttribute("aria-label",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(b)),addClass(s,"on"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(r,!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(n,!1)}r&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(r,!c),n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(n,!c),o||Wall.postChanged()}},resetPostVisibilityAccess(){Wall.canChangeVisibilityForNewPost()&&Wall.togglePostVisibilityAccess(ge("no_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_34__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,!1,!0)},canChangeVisibilityForNewPost:()=>!!ge("post_visibility_btn"),initPostVisibilitySelector(_){Wall.canChangeVisibilityForNewPost()&&Object(_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_38__.createPostTooltip)("post_visibility_btn",_.id)},cantAccessDonutPosts:()=>!1===window.cur.donutGroupUserHasWallAccess,togglePostMarkAsAds:function(_,e){e=e||"mute_notifications";var t=ge(e);if(t){var o=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(_);if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(t,o),o)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"prev-state",+Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(t)),addClass(t,"on");else{var i=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"prev-state");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(t,"on",i)}}},needCheckSign:function(){var _=ge("check_sign");return _&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(_)},saveCheckSign:function(_){var e=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"title",e?getLang("wall_check_sign_disabled"):getLang("wall_check_sign_enabled")),window.tooltips&&tooltips.hide(_,{onHide:_.onmouseover.bind(_)}),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(_,!e)},checkAsGroup:function(_){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(_),wall.setReplyAsGroup(_,{fromGroup:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(_)})},sendPost:function(_,e){var t=cur.wallAddMedia||{},o=t.chosenMedia||{},i=cur.wallAddMedia?t.getMedias():[],a=t.shareData||{},l=cur.poster&&!!e,s=l?e.text:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(ge("post_field"))),r=!1,n=Wall.isAnonPost(),d=l?null:ge("send_post"),c=cur.options.suggesting?"suggest":cur.wallType;"top"===c&&(c="all"),l&&(i=i.filter(_=>{if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(_)){var e=_slicedToArray(_,1)[0];return["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION].includes(e)}}));var p=l?ge("submit_post_box"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("_submit_post_box",ge("official")),u=Object(_web_donut__WEBPACK_IMPORTED_MODULE_33__.fieldValueIsDonutOnlyPost)(p,t),b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(p,"from-oid")==cur.postTo?1:"";p&&cur.postTo||b||cur.defaultPostSettings&&(b=cur.defaultPostSettings.official?1:"");var E={act:"post",message:s,to_id:cur.postTo,type:c,friends_only:!n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("friends_only"),check_sign:Wall.needCheckSign(),status_export:!n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("status_export"),close_comments:ge("close_comments")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("close_comments")?1:0:"",mute_notifications:ge("mute_notifications")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("mute_notifications")?1:0:"",mark_as_ads:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("mark_as_ads")?1:0,official:b,signed:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)("signed"),anonymous:n,hash:cur.options.post_hash,from:cur.from?cur.from:"",fixed:cur.options.fixed_post_id||"",situational_suggest_id:cur.options.situational_suggest_id||null},O=0;extend(E,Object(_web_donut__WEBPACK_IMPORTED_MODULE_33__.getDonutPostParams)(u,t)),cur.options.additional_save_params&&(E=extend(E,cur.options.additional_save_params));var m,w=cur.wallAddMedia&&cur.wallAddMedia.id||"";function g(_){var e=ge("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)("submit_post_error")||(Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.slideDown)("submit_post_error",100),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.animate)(ge("box_layer_wrap"),{scrollTop:0})),Wall.isPosterEditorOpen()){var t=cur.poster.getErrorWrapperElement();t.innerHTML="",t.appendChild(e)}}if(extend(E,Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_36__.getPostTopicSelectorParams)(String(w))),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(o)&&o.length&&i.push(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(o)),l&&(E.poster_bkg_id=e.bkgId,E.poster_bkg_access_hash=e.accessHash,e.fallbackObj&&(i.push(["photo",e.fallbackObj.owner_id+"_"+e.fallbackObj.id,!1]),E.poster_photo_hash=e.fallbackObj.post_hash),E.poster_bkg_id!==cur.posterCtaBkgId&&(E.poster_author_bkg_check=!0)),hide("submit_post_error"),i.length){var h=0;m=!1,each(i,(function(_,e){if(e){var o=this[0],l=this[1];switch(o){case"video":if(r||"suggest"==c)break;var p=Wall.getOwnerDraft(cur.oid)[1];if(!p)break;each(p,(function(_,e){e[1]===l&&e[2]&&e[2].upload_new&&h++}));break;case"poll":if(n)return;var u=t.pollData();if(!u)return m=!0,!1;l=u.question,delete u.question,E=extend(E,u);break;case"copyright":if(n)return;var b=t.copyrightData();if(b)return void(E=extend(E,b));break;case"share":if(a.failed||!a.title&&(!a.images||!a.images.length)&&!a.photo_url&&!a.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(m=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&a.button_text&&a.button_action){var w;i.length>1&&(w=getLang("global_share_too_many_attachments")),s.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(w=getLang("global_share_too_many_newlines")),s.length>(cur.options.share||{}).button_exclusive_max_message_len&&(w=getLang("global_share_too_long_message"));var P=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.extractUrls)(" "+s+" "),D=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.extractUrls)(" "+a.url+" ")[0];if(D&&P.length){"/"===D.query&&(D.query=""),"www."===D.domain.substr(0,4)&&(D.domain=D.domain.substr(4));for(var M=0;M<P.length;++M){var v=P[M];if("/"===v.query&&(v.query=""),"www."===v.domain.substr(0,4)&&(v.domain=v.domain.substr(4)),D.domain!=v.domain||D.query!=v.query){w=getLang("global_share_too_many_links");break}}}if(w)return g(w),m=!0,!1}if(!a.title)return g(getLang("global_share_title_required")),m=!0,!1;if(!a.url)return g(getLang("global_share_url_required")),m=!0,!1;if(a.url=new URL(a.url).href,a.video?(l=a.video_owner_id+"_"+a.video_id,E.snippet_video=1):l=a.user_id&&a.photo_id&&!a.noPhoto?a.user_id+"_"+a.photo_id:"",a.share_upload_failed&&!l)return void(a.share_upload_failed=0);if(a.images&&a.images.length&&!Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(a.images[cur.shareShowImg])&&!l&&!a.noPhoto&&!a.share_own_image&&!a.video)return Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(d),t.uploadShare((function(){Wall.sendPost(!0)})),m=!0,!1;if((cur.options.share||{}).require_image&&!l)return g(getLang("global_share_image_required")),m=!0,!1;a.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(s)==a.initialPattern&&(E.message=""),E=extend(E,{url:a.url,mode:a.mode,title:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(a.title),description:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(a.description),button_text:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(a.button_text),button_action:a.button_action,extra:a.extra,extra_data:a.extraData,photo_url:a.noPhoto||a.video?"":Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.replaceEntities)(a.photo_url),open_graph_data:(a.openGraph||{}).data,open_graph_hash:(a.openGraph||{}).hash});break;case"page":a.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(s)==a.initialPattern&&(E.message="");break;case"postpone":if(n)return;var f=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("postpone_date"+t.lnkId);return E=extend(E,{postpone:f}),cur.postponedLastDate=f,void(r=!0);case"mark_as_ads":return void(E=extend(E,{mark_as_ads:1}));case"pretty_cards":if(!t.prettyCardGallery)return;if(t.prettyCardGallery.needSendData())return t.prettyCardGallery.saveCards(Wall.sendPost,(function(_){g(_)})),m=!0,!1;var C=t.prettyCardGallery.getSendData();l=C.attachVal;break;case"podcast":if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(this[2],"attach_disabled"))return!1;break;case _web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION:return}this[3]&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(s)==this[3]&&(E.message=""),n&&"photo"!==o||(E["attach"+(O+1)+"_type"]=o,E["attach"+(O+1)]=l,O++)}}));var P=cur.postTo<0||cur.postTo===vk.id;if(cur.wallUploadVideoOpts&&cur.wallUploadVideoOpts.vars.is_wall_postponed_allowed&&P&&h&&!_&&!cur.postponeVideoPost)return Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)()&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)().hide(),void Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showBox)("al_video.php?act=postponed_post_box",{videos_count:h},{onDone:function(_,e){_.removeButtons(),_.addButton(e.video_post_later_text,(function(){cur.postponeVideoPost=!0,Wall.sendPost(!0),_.hide()})),_.addButton(e.video_post_now_text,(function(){Wall.sendPost(!0),_.hide()}),"no")}});if(m)return void(_&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(d))}if(!O&&!s)return _&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(d),void Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.elfocus)("post_field");if(!d||_||!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isButtonLocked)(d)){cur.postponeVideoPost&&(E=extend(E,{postpone_video:!0,postpone_video_hd:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(ge("postponed_post_hd"))})),cur.postAutosave&&clearTimeout(cur.postAutosave),hide("submit_post_error"),cur.postSent=!0;var D=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0;E.update_admin_tips=D,setTimeout((function(){ajax.post("al_wall.php",Wall.fixPostParams(E),{onDone:function(_,e,o,i){Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isString)(o)||(o=null),cur.poster&&l&&(cur.poster.unlockEditPoster(),cur.poster.closeEditor(),cur.poster.resetPoster(),cur.posterCtaBkgId&&(cur.posterCtaBkgId=null)),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),Wall.clearInput(),cur.postSent=!1,cur.postponeVideoPost=!1;var a=ge("mark_as_ads"),s=ge("mute_notifications");if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(a)&&s&&(removeClass(s,"on"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(s,0)),a&&(removeClass(a,"on"),t.donutUpdateVisibility()),cur.options.onSendPostDone)cur.options.onSendPostDone.apply(window,arguments);else{if(i&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.showDoneBox)(i),!isObject(_)||!_.redirect){if(Object(_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_40__.showHiddenNavigableTabs)(),r){if("feed"==c)Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.showDoneBox)(_,{out:3e3});else if("full_own"==c||"full_all"==c)return Wall.showPostponedFull(_);return wall.updateTabVisibility("page_wall_postponed",!0),void Wall.showPostponed(!1,_)}if(("full_own"==c||"full_all"==c)&&(cur.pgStart||nav.objLoc.postponed)){var n=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(nav.objLoc);return delete n.offset,delete n.postponed,vk.id!=cur.oid&&delete n.own,nav.go(n)}if(vk.id!=cur.oid&&"full_own"==c){var d=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(nav.objLoc);return delete d.own,nav.go(d)}return"feed"==c?cur.wallPostCb():"suggest"==c?(wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(!1,_,e),Wall.suggestUpdate()):void(u?Wall.showDonutWall(_):(ge("wall_tabs")&&geByClass1("ui_tab",ge("wall_tabs")).click(),Wall.receive(_,e),cur.onWallSendPost&&cur.onWallSendPost(),D&&null!==o&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(o)))}nav.go(_.redirect)}},onFail:function(_){if(cur.postSent=!1,cur.postponeVideoPost=!1,cur.poster&&l&&cur.poster.unlockEditPoster(),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),!cur.options.onSendPostFail){if(!_)return!0;var e=ge("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)("submit_post_error")||Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.slideDown)("submit_post_error",100),Wall.isPosterEditorOpen()){var t=cur.poster.getErrorWrapperElement();t.innerHTML="",t.appendChild(e)}return!0}cur.options.onSendPostFail.apply(window,arguments)},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(d)},hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(d)},noSort:!0})}),0)}},_repliesLoaded:function(_,e,t,o,i){var a=ge("replies"+_);if(a){var l=a.nextSibling;if(e){var s=a.offsetHeight;a.innerHTML=t,Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)()+(a.offsetHeight-s),0,void 0,!0),setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)}else a.innerHTML=t;if(l&&"replies_open"==l.className&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(l),ajax._framenext(),_==cur.wallLayer){var r=wkcur.reverse;extend(wkcur,{offset:!r&&i.offset||0,loaded:i.num||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",a,"div").length,count:i.count}),wall.addReplyNames(o),WkView.wallUpdateReplies(),r||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll())}else wall.addReplyNames(o),Wall.repliesSideSetup(_);Wall.updateMentionsIndex(),setTimeout((function(){Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_13__.getAudioPlayer)().updateCurrentPlaying()}),10),i&&Likes.updateComments("wall"+_,i.count)}},repliesSideSetup:function(_){if(cur.wallLayer!=_){var e=ge("replies"+_);if(e){var t=geByClass1("wr_header",e,"a"),o=ge("post"+_),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(o,"deep_active"),a=ge("replies_side"+_);if(cur.wallMyOpened[_]&&(t||i)){if(!a){var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)('<div class="replies_side_wrap"><div id="replies_side'+_+'" class="replies_side"></div></div>');e.parentNode.insertBefore(l,e),(a=l.firstChild).onmouseover=Wall.repliesSideOver.pbind(_),a.onmouseout=Wall.repliesSideOut.pbind(_),a.onclick=i?Wall.hideDeepReplies.pbind(_):Wall.repliesSideClick.pbind(_)}e.onmouseover=Wall.repliesSideOver.pbind(_),e.onmouseout=Wall.repliesSideOut.pbind(_),Wall.repliesSideOver(_)}else hide(a),e.onmouseover=null,e.onmouseout=null}}else WkView.wallUpdateReplies()},repliesSideClick:function(_){var e=ge("replies"+_),t=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(e)[1];return t>o&&Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(o-100,0),hide("replies_side"+_),Wall.showReplies(_,3,!1)},repliesSideOver:function(_){var e=ge("replies"+_),t=ge("replies_side"+_);if(e){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(t))[1],i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(t)[1],a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(e)[1],l=e.offsetHeight,s=window.lastWindowHeight||0,r=o+i-s+15,n=a+l-s;cur.wallRepliesSideOver=[_,t,r,n],Wall.repliesSideUpdate()}},repliesSideOut:function(_){cur.wallRepliesSideOver&&cur.wallRepliesSideOver[0]==_&&delete cur.wallRepliesSideOver},repliesSideUpdate:function(_){var e=cur.wallRepliesSideOver;if(e){var t,o=e[1],i=e[4]||{},a=e[5]||"",l="replies_side";void 0===_&&(_=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)()),_<e[2]?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(o),t={marginTop:0,opacity:1}):_<e[3]?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(o),l+=" replies_side_fixed",t={opacity:Math.max(0,Math.min(1,(e[3]-_)/200))}):(l+=" replies_side_hidden",t={marginTop:e[3]-e[2],opacity:0,display:null}),JSON.stringify(i)!==JSON.stringify(t)&&(each(i,(function(_,e){i[_]=null})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)(o,extend(i,t)),e[4]=t),a!=l&&(o&&(o.className=l),e[5]=l)}},highlightReply:function(_){(_=ge(_))&&(addClass(_,"reply_highlighted"),setTimeout((function(){removeClass(_,"reply_highlighted")}),1500))},scrollHighlightReply:function(_){if(_=ge(_))if(cur.wallLayer||_.id.match(/^post-?\d+(photo|video|market)?_\d+$/)&&(window.wkcur&&wkcur.shown||window.mvcur&&mvcur.mvShown||cur.pvShown)){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(_,!0)[1];e<0||e>lastWindowHeight-200?Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+e-50},300,Wall.highlightReply.pbind(_)):Wall.highlightReply(_)}else{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(_)[1];t<Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)()+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)("page_header")[1]?(Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(t,300),setTimeout(Wall.highlightReply.pbind(_),300)):Wall.highlightReply(_)}},showReply:function(_,e,t,o){if(cur.viewAsBox)return!1;if(o&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(o))return!0;if(window.mvcur&&mvcur.post==e)return Videoview.showComment(t),!1;var i=ge("post"+t);if(i)Wall.scrollHighlightReply(i);else if(cur.wallLayer==e)WkView.wallShowPreviousReplies(t);else if(e.match(/market/))Market.comments(e);else{if(_.tt&&_.tt.hide&&_.tt.hide(),"full"==cur.wallType){var a=t.split("_");return delete nav.objLoc.offset,nav.go(extend(nav.objLoc,{reply:a[1]}))}Wall.showReplies(e,!1,t)}return!1},showReplies:function(_,e,t,o){if(Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(o||window.event))return!0;if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer!=_||!wkcur.reverse){cur.wallMyOpened[_]=3!=e;var i={act:"get_replies",post:_,count:e},a={onDone:Wall._repliesLoaded.pbind(_,t),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind("wrh"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind("wrh"+_),local:1};if(t||e&&!(e>20)||(extend(i,{cont:"replies"+_}),extend(a,{frame:1}),cur.onFrameBlocksDone=function(){setTimeout(Wall.repliesSideSetup.pbind(_),browser.msie?100:10)}),ajax.post("al_wall.php",i,a),!browser.msie&&e>0&&e<10){for(var l=ge("replies"+_),s=l&&l.lastChild,r=[];r.length<e&&s;)"DIV"==s.tagName&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(s,"reply")&&r.push(s),s=s.previousSibling;if(r.length==e){var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",l,"div").length;for(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(l,'<a class="wr_header wrh_all"></a>'),Wall.updateRepliesHeader(_,l.firstChild,e,n),hide("replies_side"+_);r.length;)l.appendChild(r.pop());Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)("wrh"+_)}}return!1}},moreReplies:function(_,e,t,o){var i;if(o.deep){var a=_.split("_");i={act:"get_post_replies",offset:e,owner_id:a[0],item_id:a[1],count:t},o.order&&(i.order=o.order)}else i={act:"get_replies",offset:e,post:_,count:t};return extend(i,{rev:o.rev,from:o.from}),ajax.post("al_wall.php",i,{onDone:function(e,t,i){var a=ge("replies"+_);o.clear?a.innerHTML=e:o.rev||o.append?a.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(e)):a.innerHTML=e+a.innerHTML,wall.addReplyNames(t),o.onDone&&o.onDone(e,t,i),Wall.updateMentionsIndex()},onFail:()=>!1,showProgress:o.showProgress,hideProgress:o.hideProgress}),!1},openDeepShortReplies:function(_,e){var t=geByClass1("replies_next",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_));return t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(t),t.focus(),t.click(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_)),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e)},collapseDeepReplies:function(_,e){var t=ge("replies"+e);if(t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"replies_list_deep")){var o=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(_)[1],a=Math.round(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.clientHeight)()/2);cur.wallLayer?(i-=o)<a&&Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+i-a},300):o>i-a&&Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(i-a),Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(ge("post"+e));var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span",{className:"progress_inline replies_next_loader"});Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_),t.innerHTML="";var s=ge("reply_box_wrap"+e);s&&hide(s);var r=ge("replies_wrap_deep"+e);removeClass(r,"replies_deep_has_field"),addClass(r,"replies_deep_has_short"),wall.updateRepliesOnScroll(),ajax.post("al_wall.php",{act:"get_collapsed_replies",reply_id:e},{onDone:function(_){t.innerHTML=_},onFail:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",t),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(cur.wallTpl.reply_deep_next,{post_id:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"post-id"),reply_id:e,offset:0,text:getLang("wall_next_n_replies",cur.options&&cur.options.replies_page_count||20),class:" replies_next_deep"}));t.appendChild(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(o)},showProgress:function(){t.appendChild(l),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(l)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(l)}})}},overCollapseDeepReplies:function(_){var e=geByClass1("replies_deep_collapse_icon",_),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(e),o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getStyle)(e,"bottom")),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(_),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(_),l=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),s=cur.wallLayer?wkLayerWrap.scrollTop:l;cur.wallLayer&&(a[1]-=l);var r,n,d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.clientHeight)(),c=a[1]+i[1],p=null,u=0;cur.wallLayer?(p=ge("wl_reply_form"),u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(p)[1],r=s+c-d,n=s+a[1]+t[1]+o+o-d):("full"===cur.wallType&&(p=geByClass1("reply_box_inner_wrap",ge("reply_box_wrap"+cur.oid+"_"+cur.pid)),u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(p)[1]),r=c-d,n=a[1]+t[1]+o+o-d),cur.onScrollCollapseDeepReplies=wall.updCollapseDeepRepliesIcon.pbind(_,e,{iconSize:t,iconBottom:o,collapseSize:i,collapsePos:a,fixedField:p,fixedFieldSize:u,maxFixedScroll:r,topMaxScroll:n}),addEvent(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),addEvent(window,"resize",cur.onScrollCollapseDeepReplies),cur.onScrollCollapseDeepReplies()},outCollapseDeepReplies:function(_){cur.onScrollCollapseDeepReplies&&(removeEvent(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),removeEvent(window,"resize",cur.onScrollCollapseDeepReplies),delete cur.onScrollCollapseDeepReplies);var e=geByClass1("replies_deep_collapse_icon",_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updCollapseDeepRepliesIcon:function(_,e,t){var o=cur.wallLayer?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),i=t.maxFixedScroll;if((cur.wallLayer&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t.fixedField,"wl_reply_form_fixed")||"full"===cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t.fixedField,"fixed"))&&(i+=t.fixedFieldSize),o<i){var a=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)((t.collapseSize[0]-t.iconSize[0])/2),l=t.topMaxScroll+t.fixedFieldSize-o,s=t.fixedFieldSize+t.iconBottom;l>0&&(s-=l),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)(e,{position:"fixed",bottom:s,left:t.collapsePos[0]+a,right:"auto"})}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updateCollapseDeepReplies:function(_){if(cur.wallTpl.reply_deep_collapse){var e=ge("replies_wrap_deep"+_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",ge("post"+_));if(e){_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"post-id");var t=ge("replies"+_);if(!t)return t;var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",t).length>=2,i=geByClass1("replies_deep_collapse",e);if(o){if(i)return;i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(cur.wallTpl.reply_deep_collapse,{reply_id:_})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(i,t)}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(i)}}},showNextReplies:function(_,e,t){var o=e.split("_"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"offset"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"count"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"collapse"),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"replies_prev"),r=cur.wallLayer?ge("wl_post"):ge("post"+e),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)("post"+e,"reply"),d={act:"get_post_replies",owner_id:o[0],item_id:o[1],offset:i,count:a,collapse:l},c=s?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPS)(_);if(c&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(c,"reply")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(c,"replies_wrap_deep"))){var p=(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(c,"post-id")||"").split("_")[1];s?d.next_id=p:d.prev_id=p}if(n)cur.wallLayer||(r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",r));else{var u=ge("replies"+e),b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(u,"top-ids");b&&(d.top_replies=b)}var E=r.offsetHeight,O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"post-id");d.order=wall.getRepliesOrder(O);var m=n&&wall.isDescRepliesOrder(O,d.order);m&&(s=!s);var w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span",{className:"progress_inline replies_next_loader"});return ajax.post("al_wall.php",d,{onDone:function(t,o,a){var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domChildren)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:t})),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(),c=!1;n.forEach((function(_){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"wr_header")){var e=ge(_.id);e&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"reply")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"replies_wrap_deep"))||(d.appendChild(_),c=!0)}}));var p,u,b=s&&!m||!s&&m,w=!1;if(b){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(ge("replies_wrap_deep"+e),"replies_deep_has_short")){var g=window.innerHeight||document.documentElement.clientHeight,h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)("page_header")[1],P=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_),D=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(P)[1];p=cur.wallLayer?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),w=cur.wallLayer?D<g:D<p+g-h}u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(d),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(d,_)}else u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domLC)(d),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(d,_);var M=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(a.num),v=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(a.offset),f=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(a.count),C=Math.max(0,v+(s?-M:M)),T=f-C,A=0;if(c&&(s&&v>0||!s&&T>0)&&(A=s?i-C:Math.min(T,M),a.closest_inx>=0&&(A=Math.min(A,a.closest_inx))),document.activeElement===_?addEvent(_,"focusout",(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_)})):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_),A){var L=_.cloneNode(!0);removeClass(L,"replies_next_pre_deleted"),l||(b?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(L,u),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(L,getLang("wall_prev_n_replies",A))):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(L,u),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(L,getLang("wall_next_n_replies",A))),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(L,"count",A),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(L,"offset",C))}removeClass(ge("replies_wrap_deep"+e),"replies_deep_has_short");var B=r.offsetHeight-E;if(w&&B){var I=p+B;cur.wallLayer?wkLayerWrap.scrollTop=I:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(I,0,!1,!0)}wall.updateCollapseDeepReplies(e),wall.updateMentionsIndex(),wall.addReplyNames(o),wall.addDeepRepliesBlock(e),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[O]=1,wall.repliesSideSetup(O),wall.updateRepliesOnScroll()},onFail:function(){removeClass(_,"replies_next_pre_deleted")},showProgress:function(){addClass(_,"replies_next_pre_deleted"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(w,_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(w)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(w)}}),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(!1)},emojiOpts:{},emojiShowTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttShow(Wall.emojiOpts[_],e,t)},emojiHideTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttHide(Wall.emojiOpts[_],e,t)},initReplyEditable:function(_,e,t,o,i){if(_.emojiInited)return!1;var a=ge("reply_button"+t),l=ge("reply_media_preview"+t);_.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){var s=Emoji.init(_,{ttDiff:o?-40:-42,rPointer:!0,controlsCont:e,shouldFocus:!i,ref:"reply",onSend:function(){Wall.sendReply(t),_.blur()},ctrlSend:function(){return Wall.customCur().wallTpl.reply_multiline||Wall.composerListShown(_)},checkEditable:function(){cur.onReplyChanged&&cur.onReplyChanged(_,t),Wall.checkTextLen(_,"reply_warn"+t)},onChange:function(){a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(a,"reply_send_disabled",!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Emoji.editableVal(_))&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(l,"media_preview_has_medias")),Wall.hideCheckTimer(t,"editing")},onStickerSend:function(_,e){Wall.sendReply(t,!1,{stickerId:_,sticker_referrer:e})},initUploadForImagePasteCallback:Page.initUploadForImagePaste});if(vk.widget&&!window.emojiStickers&&Emoji.updateTabs(),Wall.emojiOpts[t]=s,cur.afterEmojiInit&&cur.afterEmojiInit[t]){var r=geByClass1("emoji_smile",Emoji.opts[s].controlsCont);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(r)&&(cur.afterEmojiInit[t](),delete cur.afterEmojiInit[t])}}))},initEditReply:function(_,e,t,o){var i,a=_,l=ge("reply_field"+_),s=ge("post"+_),r=ge("reply_fakebox"+_),n=ge("reply_box"+_),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(s,"reply"),c=cur.wallLayer?wkcur:cur,p=!1;if(d){if(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",s)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",s),p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"deep_active")){if(!cur.reply_to){var u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(s,"answering-id");if(u){var b=_.split("_")[1];cur.reply_to=[Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(u),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(b)],Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_,b)}}wall.addDeepRepliesBlock(_),r=ge("reply_fakebox"+_)}a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"post-id")}else cur.wallLayer?(p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(ge("wl_post"),"deep_active"),i=ge("wl_reply_form_inner")):(i=s,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"deep_active"));if(!i&&r?i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_wrap",r):!i&&n&&(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_wrap",n)),r){var E=ge("replies"+a),O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(E,"can_reply_as_group"),m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(E,"can_reply_as_any_group"),w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"owner-photo")||"",g=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"owner-href")||"",h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"owner-name")||"",P="";m?P=c.wallTpl.reply_form_any_group:O&&(P=c.wallTpl.reply_form_group),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(p&&c.wallTpl.reply_form_new?c.wallTpl.reply_form_new:c.wallTpl.reply_form,{add_buttons:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(P,{post_id:_,oid:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_),owner_photo:w||"/images/blank.gif"}),post_id:_,oid:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_),owner_photo:w,owner_href:g,owner_name:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.unclean)(h))})),r.parentNode.replaceChild(n,r),l=ge("reply_field"+_)}if(Wall.initReplyEditable(l,n,_,e,t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(l,"composer"))o&&o();else{var D,M,v,f,C=[],T=!1;window.mvcur&&mvcur.mvShown?D=mvcur.mvMediaTypes:cur.wallLayer==a?D=wkcur.options.rmedia_types:window.pvcur&&cur.pvShown?(D=pvcur.rmedia_types,M=0,v=0):D=c.options&&c.options.rmedia_types,(p||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i.parentElement,"VerticalVideoLayerInfo__commentsReply"))&&(T=!0,M=0,v=0),each(D||c.options&&c.options.media_types||[],(function(){Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(this[0],["photo","video","audio","doc","link","page"])&&C.push(this)}));var A=!1,L=a.match(/^(\d+_)?-?\d+_(photo|video|topic|market)?\d+(mv)?(_\d+)?$/);C.length>0&&L?(f={lnk:p?ge("reply_more_attaches"+_):ge("reply_add_media_"+_),preview:ge("reply_media_preview"+_),actionsEl:!1,gearEl:!1,types:C,options:{from:"topic"===L[2]?"board":"comment",limit:2,disabledTypes:["album","market","market_album","poll",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_35__.MEDIA_SELECTOR_GROUP],toggleLnk:!0,maxShown:void 0!==M?M:void 0,hideAfterCount:void 0!==v?v:void 0,vectorIcon:T,hideLabel:getLang("wall_reply_add_attach_label"),toId:"full"===cur.wallType?cur.oid:cur.postTo,onToggleBlock:function(e){var t=ge("reply_box"+_),o=geByClass1("reply_box_photo",t);o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)(o,e)},onMediaChanged:function(){Wall.hideCheckTimer(_,"editing"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)("reply_button"+_,"reply_send_disabled",!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Emoji.editableVal(l))&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)("reply_media_preview"+_,"media_preview_has_medias"))}}},a.match(/^-?\d+_topic/)&&(extend(f.options,{disabledTypes:["album","share","link","page"],limit:10,editable:1,sortable:1,teWidth:280,teHeight:200}),A=!0)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("reply_add_media_"+_),Wall.initComposer(l,{lang:{introText:getLang("profile_mention_start_typing"),noResult:getLang("profile_mention_not_found")},toup:A,wddClass:"reply_composer_dd",width:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(l.parentNode)[0],media:f,isReply:!0},o)}return void 0!==l.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),{postId:a,postEl:i,isReply:d,rf:l}},showEditReply:function(_,e,t,o,i,a){if(cur.viewAsBox)return setTimeout((function(){ge("reply_field"+_).blur()}),0),cur.viewAsBox();if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)("post"+_,"Post--with_closed_comments_donut"))return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)("replies_wrap"+_,{display:""}),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e);var l=wall.initEditReply(_,t,i,a);if(l.rf){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("reply_box_wrap",l.rf));var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",l.rf);s&&addClass(s,"replies_deep_has_field")}return cur.wallMyOpened&&(cur.wallMyOpened[_]=cur.wallMyOpened[_]||!1),cur.editing===_?(Emoji.editableFocus(l.rf,!1,!0),!1):(Wall.hideEditPostReply(),l.isReply?addClass(ge("replies_wrap_deep"+_),"deep_reply_box_open"):addClass(l.postEl,"reply_box_open"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)("replies_wrap"+_,{display:""}),cur.editing=_,window.Emoji&&setTimeout((function(){Emoji.editableFocus(l.rf,!1,!0),Wall.repliesSideOver(_)}),0),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.triggerEvent)(window,"scroll"),void 0!==l.rf.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),cur.wallTpl&&cur.wallTpl.reply_multiline_intro&&ajax.post("al_wall.php",{act:"a_ctrl_submit_intro",hash:cur.wallTpl.poll_hash},{onDone:function(e){e&&cur.editing===l.postId&&Wall.replySubmitTooltip(_,1)},onFail:function(){return!0}}),window.mvcur&&(mvcur.post==l.postId&&Videoview.onShowEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),mvcur.scrollBottom&&mvcur.scrollBottom()),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(cur.onReplyFormSizeUpdate)&&cur.onReplyFormSizeUpdate(l.rf),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(cur.onReplyFormFocus)&&cur.onReplyFormFocus(l.rf),!1)},hideEditReply:function(_,e){cur.editing=!1;var t,o=ge("reply_field"+_),i=ge("post"+_),a=ge("reply_box"+_),l=cur.reply_to&&Wall.getReplyName(cur.reply_to[0]),s=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(window.Emoji?Emoji.editableVal(o):""),r=Wall.hasComposerMedia(o),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"reply");if(!(t=cur.wallLayer?ge("wl_reply_form_inner"):n?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",i):i)&&a&&(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_wrap",a)),o&&(!r||e)){if(l&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(l)&&l[1]&&(s&&l[1].indexOf(s)||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(o,""),s="")),e&&(s||r)){var d=o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(o,"composer");d?Composer.reset(d):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(o,""),s="",hide(geByClass1("reply_warn",t))}if(!(browser.opera_mobile||browser.safari_mobile||s)){Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)()&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)().isVisible()||(n?removeClass(ge("replies_wrap_deep"+_),"deep_reply_box_open"):removeClass(t,"reply_box_open")),ge("reply_link"+_)&&hide("replies_wrap"+_),window.tooltips&&a&&tooltips.hideAll(a),o.blur(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.triggerEvent)(window,"scroll"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_,""),hide("reply_to_title"+_),cur.reply_to=!1;var c=Wall.emojiOpts[_];c>=0&&Emoji.opts[c]&&Emoji.opts[c].onChange&&Emoji.opts[c].onChange(),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate();var p=cur.replySubmitSettings;p&&p.tt&&p.tt.el&&p.tt.destroy(),window.mvcur&&mvcur.post==_&&(Videoview.onHideEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate())}}},replyNamesRE:function(){wall.addReplyNames({});var _=wall.getReplyNames();if(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isEmpty)(_))return!1;var e=[];return each(_,(function(_,t){t&&(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(t)&&(t=t[1]),"string"==typeof t&&e.push(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.escapeRE)(t)))})),new RegExp("^("+e.join("|")+")")},replyTo:function(_,e,t,o){var i=window.cur.wallLayer==_?wkcur:window.cur;Wall.showEditReply(_,o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_,e);var a=i.reply_to&&Wall.getReplyName(i.reply_to[0]);i.reply_to=[t,e];var l=Wall.getReplyName(t),s=ge("reply_as_group"+_),r=_.match(/^(-?\d+)_([a-z]+)?(\d+)([a-z]+)?$/),n=r[1],d=r[2]||"",c=r[4]||"",p=ge("post"+n+d+"_"+e),u=p&&geByClass1("reply_to",p,"a"),b=Wall.replyNamesRE(),E=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",p)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",p),O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(E,"deep_active"),m=O?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",p):null,w=m?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(m,"post-id"):_,g="";if(!O||m){var h=(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(l)?l[0]:l)||"";h='<a class="reply_to_mem" onclick="return wall.showReply(this, \''+w+"', '"+n+d+"_"+e+c+"', event);\">"+h+"</a>";var P='<span class="reply_to_cancel" onclick="return Wall.cancelReplyTo(\''+w+"', event);\"></span>",D='<div class="reply_to_label">'+langStr(getLang("global_reply_to"),"user",h)+"</div>";g=O?D+P:P+D}if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to_title"+w,g),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(l)&&l[1]&&window.Emoji){var M=ge("reply_field"+w),v=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Emoji.val(M)));!(v=v.replace(/&nbsp;/g," "))||a&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(a)&&!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.winToUtf)(a[1]).indexOf(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.winToUtf)(v))?Emoji.val(M,l[1]):b&&(v=v.replace(b,l[1]),Emoji.val(M,v));var f=Wall.emojiOpts[_];f>=0&&Emoji.opts[f]&&Emoji.opts[f].onChange&&Emoji.opts[f].onChange(),Emoji.focus(M,!0)}if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)("reply_to_title"+w,g),s){var C=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(s.parentNode)&&n<0&&u&&u.getAttribute("rid")===n;Wall.setReplyAsGroup(s,{from:C?n:vk.id})}return i.onReplyFormSizeUpdate&&i.onReplyFormSizeUpdate(),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.stopEvent)(o),!1},cancelReplyTo:function(_,e){var t=window.cur.wallLayer==_?wkcur:window.cur,o=ge("reply_field"+_),i=t.reply_to&&Wall.getReplyName(t.reply_to[0]),a=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(window.Emoji?Emoji.editableVal(o):"")),l=Wall.replyNamesRE(),s=ge("post"+_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",s)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",s),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(r,"deep_active");if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(i)&&i[1]&&window.Emoji){a&&i[1].indexOf(a)?l&&(a=a.replace(l,""),Emoji.val(o,a)):(a="",Emoji.val(o,a));var d=Wall.emojiOpts[_];d>=0&&Emoji.opts[d]&&Emoji.opts[d].onChange&&Emoji.opts[d].onChange(),Emoji.focus(o,!0)}if(hide("reply_to_title"+_),n){var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(s,"answering-id");if(c){var p=_.split("_")[1];t.reply_to=[Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(c),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(p)],Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_,p)}else t.reply_to=!1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_,"")}else window.mvcur&&mvcur.post==_?mvcur.mvReplyTo=!1:t.reply_to=!1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_,"");return t.onReplyFormSizeUpdate&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(t.onReplyFormSizeUpdate)&&t.onReplyFormSizeUpdate(o),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.stopEvent)(e),!1},replySubmitTooltip:function(_,e,t){var o=_&&window.cur.wallLayer==_?wkcur:window.cur,i=_&&(ge("reply_box"+_)||ge("reply_fakebox"+_)),a=i&&geByClass1("button_blue",i,"div"),l=o.replySubmitSettings;if(!(t&&a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(a)))if(t=t||a,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"flat_button")&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isButtonLocked)(t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"button_disabled"))!e&&l&&l.tt&&l.tt.hide&&l.tt.hide();else if(l||(l=o.replySubmitSettings=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{className:"reply_submit_hint_tt_point"})),e){if(t)if(l.parentNode==t&&l.tt&&l.tt.show)l.tt.show();else{l.tt&&l.tt.el&&l.tt.destroy(),t.insertBefore(l,t.firstChild);var s=Wall.customCur().wallTpl.reply_multiline?1:0,r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(Wall.customCur().wallTpl.reply_multiline_hint,{enabled:s?"on":"",disabled:s?"":"on"}),n=i&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",i)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",i)),d=n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(n,"deep_active");Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(l,{text:r,typeClass:"tt_default_right",slide:15,shift:d?[15,8]:[0,8],asrtl:1,hasover:1,toup:!1,showdt:700,hidedt:700,dir:"auto",noZIndex:!0,onCreate:function(){radioBtns.reply_submit={els:Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("radiobtn",ge("reply_submit_hint_opts"))),val:r?1:0}}})}}else l&&l.tt&&l.tt.hide&&l.tt.hide()},onReplySubmitChanged:function(_,e){if(cur.wallTpl?cur.wallTpl.reply_multiline=_:mvcur.wallTpl&&(mvcur.wallTpl.reply_multiline=_),Wall.customCur().wallTpl&&(Wall.customCur().wallTpl.reply_multiline=_),e){var t=cur.replySubmitSettings;t&&t.tt&&t.tt.el&&t.tt.destroy()}else ajax.post("al_wall.php",{act:"a_save_ctrl_submit",value:_,hash:Wall.customCur().wallTpl.poll_hash}),window.Notifier&&Notifier.lcSend("wall_reply_multiline",{value:_})},getReplyFromId:function(_){var e=ge("reply_as_group"+_);return!(!e||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(e.parentNode))&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("_submit_post_box",e),"from-oid")},showCheckTimer(_,e,t){var o=ge("reply_field"+_),i=ge("reply_box"+_),a=i&&geByClass1("WallCheckComment__timer",i);if(o&&a){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(o,{text:t.description,showdt:0,hidedt:0,shift:[0,-1],width:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(o)[0],forcetoup:!0,nohide:!0,noZIndex:browser.msie_edge,className:"WallCheckComment__tt"}),geByTag("span",a).forEach(_=>{_.style.animationDuration=t.delay+"s"}),i.classList.add("WallCheckComment--shown");var l=setTimeout(()=>{i.classList.remove("WallCheckComment--shown"),Wall.sendReply(_,void 0,e)},1e3*t.delay);a.timeout=l,a.onclick=()=>{Wall.hideCheckTimer(_,"button")},cur.destroy||(cur.destroy=[]),cur.destroy.push(()=>{l&&clearTimeout(l)}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.elfocus)(o)}},hideCheckTimer(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=ge("reply_field"+_),o=ge("reply_box"+_),i=o&&geByClass1("WallCheckComment__timer",o);if(t&&i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"check_timestamp");e&&a&&Wall.isCheckTimerShown(_)&&ajax.post("al_wall.php",{act:"check_comment_cancelled",post_raw:_,timestamp:a,reason:e}),i.timeout&&clearTimeout(i.timeout),t.tt&&t.tt.hide&&t.tt.hide(),o.classList.remove("WallCheckComment--shown"),"button"===e&&setTimeout(()=>Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.elfocus)(t),0)}},isCheckTimerShown(_){var e=ge("reply_box"+_);return e&&e.classList.contains("WallCheckComment--shown")},sendReply:function(_,e,t){t=extend({},t);var o,i=ge("replies_wrap_deep"+_),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("reply_to"+_);if(i?(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",i)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",i),"post-id"),a=a||_.split("_")[1]):o=_,window.mvcur&&mvcur.post==o)return Videoview.sendComment(o,e,t);var l,s,r,n=window.cur.wallLayer==o,d=n?ge("wl_post"):ge("post"+o),c=ge("replies"+_),p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(d,"deep_active"),u=n?wkcur:window.cur,b=ge("reply_field"+_),E=b&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(b,"composer"),O=u.reply_to&&Wall.getReplyName(u.reply_to[0]),m=b&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(b,"send");if(m&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(m))return m(_,e,t);if(t.stickerId)s={message:"",attach1_type:"sticker",attach1:t.stickerId,sticker_referrer:t.sticker_referrer};else if(t.suggest)s={message:t.suggest};else{if((s=E?Composer.getSendParams(E,Wall.sendReply.pbind(_)):{message:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Emoji.editableVal(b))}).delayed)return;if(!s.attach1_type&&(!s.message||Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(O)&&O[1]&&!O[1].indexOf(s.message)))return void Emoji.editableFocus(ge("reply_field"+_),!1,!0)}var w=window.wkcur&&ge("wk_content");if(b&&(w&&w.contains(b)?wkcur.wallCheckComments:u.wallCheckComments)){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_in_progress"))return;if(!(r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_timestamp")||void 0))return Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.stopEvent)(e),void ajax.post("al_wall.php",{act:"check_comment",post_raw:o,text:s.message},{onDone(e){e&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_timestamp",e.timestamp),e.description&&e.delay)?Wall.showCheckTimer(_,t,e):Wall.sendReply(_,void 0,t)},onFail:()=>(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_timestamp",Date.now()),Wall.sendReply(_,void 0,t),!0),showProgress(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_in_progress",!0)},hideProgress(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_in_progress",null)}});if(Wall.isCheckTimerShown(_))return void Wall.hideCheckTimer(_,"button");Wall.hideCheckTimer(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(b,"check_timestamp",null)}t.stickerId||t.suggest||(E?l=Composer.reset(E):window.Emoji&&Emoji.val(b,""),b.autosize&&b.autosize.update()),u.wallMyOpened=u.wallMyOpened||{},u.wallMyReplied[o]=1,u.wallMyOpened[o]=1;var g=ge("post_hash"+o)?ge("post_hash"+o).value:u.options.post_hash,h=null,P=p&&(i||!n&&"full"!==u.wallType),D=wall.getRepliesOrder(o),M=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(c,"top-ids"),v=!1;if(P&&c){var f=!i&&wall.isDescRepliesOrder(o,D)?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(c):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domLC)(c);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(f,"replies_next")&&(P=!1,v=!0)}extend(s,{act:"post",type:u.wallType,reply_to:o,reply_to_msg:a,reply_to_user:u.reply_to&&u.reply_to[0]||0,start_id:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("start_reply"+o),from:n?"wkview":"",hash:g,only_new:P?1:0,need_last:v?1:0,order:D,top_replies:M||null,timestamp:r}),u.reverse&&(s.rev=1);var C,T=wall.getReplyFromId(_);if(T&&(s.from_oid=T),C=u.wallType?"feed"==u.wallType?"news"==u.section?"feed_"+(u.subsection?u.subsection:u.section):"recommended"==u.section?"feed_recommended"+("recent"!=u.subsection?"_"+u.subsection:""):-1!==["friends","groups","videos","photos","list"].indexOf(u.section)?"feed_"+u.section+(u.subsection?"_"+u.subsection:""):"feed_"+u.section:"top"==u.wallType?"wall_top":"wall_"+(u.onepost?"one":(u.wallType||"").indexOf("full_")?"page":"full"):u.module,extend(s,{ref:C}),browser.mobile?Wall.hideEditReply(_):(Emoji.editableFocus(b,!1,!0),Wall.cancelReplyTo(_,e)),hide("reply_warn"+_),ajax.post("al_wall.php",Wall.fixPostParams(s),{onDone:function(e,t,i,a){if(p){if(P)return wall.onOnlyNewReplySent.apply(window,arguments);if(v)return wall.onLastChunkReplySent.apply(window,arguments);if(n)return wall.onNewReplySentLayer.apply(window,arguments)}if("full"===u.wallType)return p?FullWall.onNewReplySent.apply(window,arguments):FullWall.onReplySent.apply(window,arguments);u.wallMyReplied[o]=0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("reply_link"+o),hide("reply_warn"+o),Wall._repliesLoaded(_,!1,t,i,a),Wall.processPostReplyActions(e)},onFail:function(_){if(h&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(h),E?l=Composer.restore(E,l):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(b,s.message),b.autosize&&b.autosize.update(),_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("global_error"),_),!0},showProgress:function(){p?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disableButton)(ge("reply_button"+_),!0):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(ge("reply_button"+_))},hideProgress:function(){p?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disableButton)(ge("reply_button"+_),!1):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(ge("reply_button"+_))}}),window.cur.onPostReply&&window.cur.onPostReply(_),!s.from_oid&&s.message&&!P){var A=-++u.wallMyRepliesCnt,L=Emoji.emojiToHTML(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(s.message),!0),B=wall.getReplyNames(),I=s.reply_to_user<0?getLang("wall_replied_to_group"):B[s.reply_to_user]&&B[s.reply_to_user][0],W=I?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(u.wallTpl.reply_link_to,{to_user:I}):"";if(h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(u.wallTpl.reply_fast,{reply_id:"0_"+A,message:L.replace(/\n/g,"<br/>"),to_link:W,date:Wall.getNowRelTime(u)})),c&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(c)||ge("reply_link"+_))Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("reply_link"+_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("replies_wrap"+_);else if(!u.onepost){var R=c.nextSibling;if(R&&"replies_open"==R.className&&Wall.openNewComments(_),!n){var y=geByClass1("wr_header",c,"a"),j=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",c,"div").length+1,U=j;y&&(U=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(y.getAttribute("offs").split("/")[1])+1),(U>5||j<U)&&(y||c.insertBefore(y=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("a",{className:"wr_header"}),c.firstChild),Wall.updateRepliesHeader(_,y,j,U))}}u.reverse?c.insertBefore(h,c.firstChild):c.appendChild(h),n&&(WkView.wallUpdateReplies(),u.reverse||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()))}},onOnlyNewReplySent:function(_,e,t){var o=ge("post"+_),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(o,"reply"),a=i?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",o)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",o):o,l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(a,"post-id"),s=!i&&wall.isDescRepliesOrder(l);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"deep_active")){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",o);i&&r&&(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"post-id"));var n=cur.wallLayer===l,d=Wall._getRepliesInfoBeforeAddNewReply(_,n),c=Wall._checkVisibilityBeforeAddNewReply(_,d,s,n);i&&wall.addDeepRepliesBlock(_);var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(e);s&&d.repliesListEl.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(p,d.repliesListEl.firstChild):d.repliesListEl.appendChild(p),Wall._fixScrollAfterAddNewReply(_,d,c,s,n),i&&wall.updateCollapseDeepReplies(_),Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(p),wall.incReplyCounter(a),wall.addReplyNames(t)}},onLastChunkReplySent:function(_,e,t,o,i,a){var l=ge("post"+i),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(l,"reply"),r=s?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",l)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",l):l,n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"post-id"),d=!s&&wall.isDescRepliesOrder(n);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(r,"deep_active")){var c=cur.wallLayer===n,p=Wall._getRepliesInfoBeforeAddNewReply(i,c),u=Wall._checkVisibilityBeforeAddNewReply(i,p,d,c);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(p.repliesListEl,e),Wall._fixScrollAfterAddNewReply(i,p,u,d,c);var b=ge("post"+a);Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(b),s&&wall.updateCollapseDeepReplies(i),wall.incReplyCounter(r,1,_),wall.addReplyNames(o)}},_getRepliesInfoBeforeAddNewReply:function(_,e){var t=e?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),o=window.innerHeight||document.documentElement.clientHeight,i=t+(e?0:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)("page_header_cont")[1]),a=t+o,l=ge("replies"+_),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(l,e)[1],r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(l)[1];return{repliesListEl:l,scrollY:t,topY:i,bottomY:a,viewportHeight:o,repliesListY:s,repliesListH:r,repliesListEndY:s+r,layerFieldH:e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)("wl_reply_form")[1]:0}},_checkVisibilityBeforeAddNewReply:function(_,e,t,o){return t?o?e.repliesListY>0&&e.repliesListY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListY&&e.bottomY>e.repliesListY:o?e.repliesListEndY>0&&e.repliesListEndY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListEndY&&e.bottomY>e.repliesListEndY},_fixScrollAfterAddNewReply:function(_,e,t,o,i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(e.repliesListEl)[1];if(o)t||Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(e.repliesListY-100,300,!1,!0);else if(t){var l=e.scrollY+a-e.repliesListH;i?wkLayerWrap.scrollTop=l:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(l,0,!1,!0)}else{var s=e.repliesListY+a-300;i?Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.animate)(wkLayerWrap,{scrollTop:e.scrollY+s},300):Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(s,300,!1,!0)}},incReplyCounter:function(_,e,t){e=e||1;var o,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"post-id"),a=geByClass1("comment",_);a&&(t||(o=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(a,"count"),t=Math.max(0,o+e)),Likes.update("wall"+i,{comment_num:t}))},onNewReplySentLayer:function(_,e,t,o){var i=ge("wl_post"),a=geByClass1("wl_replies",i);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(a,e);var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domChildren)(a).filter((function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"reply")})).length;extend(wkcur,{offset:t,loaded:l,count:_}),wall.addReplyNames(o),WkView.wallUpdateReplies();var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"post-id");wall.isDescRepliesOrder(s)?wkLayerWrap.scrollTop=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(i)[1]-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)("wl_replies_wrap")[1]-30:wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()},postTooltip:function(_,e,t,o){if(!cur.viewAsBox){var i=(t||{}).reply,a=(t||{}).className||"",l=i&&!(i%2)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(_)[0]>420;o=o||{},i||(o.appendEl=bodyNode),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(_,extend({url:"al_wall.php",params:extend({act:"post_tt",post:e},t||{}),slide:15,shift:[l?417:27,6,6],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",className:"rich wall_tt"+a,typeClass:l?"tt_default_right":"tt_default"},o))}},adsMarkTooltip:function(_){cur.viewAsBox||Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(_,{black:1,shift:[15,7,0],text:_.getAttribute("data-tooltip")})},hideEditPostReply:function(_,e){if(!1!==cur.editing&&(cur.wallLayer&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)("wl_post","deep_active")&&(e=!0),e||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(boxLayerBG)&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(layerBG))){var t=_&&_.target?_.target:{},o=t.id;cur.editing?cur.editingHide?cur.editingHide(cur.editing,t):_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("_reply_wrap",t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"reply_link")||o=="reply_field"+cur.editing||"reply_to_link"==t.className)||Wall.hideEditReply(cur.editing):(cur.wallAddMedia||{}).chosenMedia||_&&"post_field"==o||Wall.hideEditPost()}},postShowDeletedMessage:function(_,e){var t=ge("post"+_);if(t){var o=geByClass1("_post_content",t)||geByClass1("feedback_row_t",t);Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_24__.revertLastInlineVideo)(o),hide(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(o),"post_publish")&&hide(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(o));var i="post_del"+_,a=ge(i),l='<span class="dld_inner">'+e+"</span>";return a?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(a,l),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(a)):t.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{id:i,className:"dld",innerHTML:l})),!0}return!1},postHideDeletedMessage:function(_){var e=ge("post"+_);if(e){var t=geByClass1("_post_content",e)||geByClass1("feedback_row_t",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(t),"post_publish")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(t));var o=ge("post_del"+_);return hide(o),!0}return!1},isArchiveWall:function(){return cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module},rollbackPostsArchiveState:function(_,e,t){if(Wall.isArchiveWall()&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.linkLocked)(_)){var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_rollback_state",from:ge("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){cur.wallArchiveRolledback=!0,Wall.postShowDeletedMessage(e,_)},showProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockLink)(_),hideProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockLink)(_)})}},restoreLastRollbackPostsArchiveState:function(_,e,t){if(Wall.isArchiveWall()&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.linkLocked)(_)){var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_restore_last_rollback",from:ge("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){delete cur.wallArchiveRolledback,Wall.postShowDeletedMessage(e,_)},showProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockLink)(_),hideProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockLink)(_)})}},postSetArchiveState:function postSetArchiveState(actionEl,postRaw,hash,state,isRollback){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.actionsMenuItemLocked)(actionEl)&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.linkLocked)(actionEl)){var postId=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(postRaw.split("_")[1]),isActionMenuItem=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(actionEl,"ui_actions_menu_item"),localCur=cur.wallLayer?wkcur:cur;localCur&&(localCur.wallMyDeleted||(localCur.wallMyDeleted={}),localCur.wallMyDeleted[postRaw]=!Wall.isArchiveWall()==!state?0:1);var extended=!isRollback&&(Wall.isArchiveWall()?cur.wallArchiveRestored>=3&&!cur.wallArchiveRolledback:!cur.wallArchiveArchived);ajax.post("al_wall_archive.php",{act:"a_set_state",from:ge("page_wall_more_tab")?"profile":cur.pid?"post":"wall",hash,state:state?1:void 0,extended:extended?1:void 0,postId},{onDone:function onDone(msg,js){if(Wall.isArchiveWall()&&(state=!state,isRollback||(cur.wallArchiveRestored||(cur.wallArchiveRestored=0),cur.wallArchiveRestored++)),state&&(cur.wallArchiveArchived=!0),isRollback?Wall.postHideDeletedMessage(postRaw):Wall.postShowDeletedMessage(postRaw,msg)){"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(state?-1:1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(postEl,"reply")&&(state?--cur.pgOffset:++cur.pgOffset,state?--cur.pgCount:++cur.pgCount,FullWall.repliesSummary(cur.pgCount));var postEl=ge("post"+postRaw);"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(postEl,"own")&&(state?++cur.deletedCnts.own:--cur.deletedCnts.own),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(postEl,"all")&&(state?++cur.deletedCnts.all:--cur.deletedCnts.all),Wall.isArchiveWall()&&(state?--cur.deletedCnts.archive:++cur.deletedCnts.archive),Wall.update())}if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__.logEvalError)(_,js)}},showProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem.pbind(actionEl):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockLink)(actionEl),hideProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem.pbind(actionEl):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockLink)(actionEl)})}},deletePost:function(_,e,t,o,i){(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=1;var a=ge("post"+e),l=geByClass1("post_actions",a),s={act:"delete",post:e,hash:t,root:o?1:0,confirm:i?1:0,from:"wall"};cur.suggestedDeletedCount&&cur.suggestedDeletedCount>=2&&(s.delete_all=1),Object(_internal_nospam_common__WEBPACK_IMPORTED_MODULE_39__.isClaimContent)()&&(s._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_wall.php",s,{onDone:function(i,l,s){if(s)var r=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(i,s,getLang("global_delete"),(function(){r.hide(),wall.deletePost(_,e,t,o,1)}),getLang("box_cancel"));else{Wall.postShowDeletedMessage(e,i),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount));var n=ge("post_publish_wrap"+e);n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(n,"suggest")&&(void 0===cur.suggestedDeletedCount&&(cur.suggestedDeletedCount=0),cur.suggestedDeletedCount++),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"suggest")?Wall.suggestUpdate(-1):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"postponed")?wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"own")&&++cur.deletedCnts.own,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"all")&&++cur.deletedCnts.all,Wall.isArchiveWall()&&++cur.deletedCnts.archive,Wall.update())}},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(_):addClass(l,"post_actions_progress")},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(_):removeClass(l,"post_actions_progress")}});var r=ge("delete_post"+e);r&&r.tt&&r.tt.el&&r.tt.destroy()},markAsSpam:function markAsSpam(el,post,hash,inline){ajax.post("al_wall.php",{act:"spam",post,hash,from:inline?"inline":""},{onDone:function onDone(msg,js){if(inline)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(el).replaceChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:msg}),el);else{var r=ge("post"+post),t=geByClass1("_post_content",r)||geByClass1("feedback_row_t",r);Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_24__.revertLastInlineVideo)(r);var pd=ge("post_del"+post);pd?(pd.innerHTML='<span class="dld_inner">'+msg+"</span>",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(pd)):r.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{id:"post_del"+post,className:"dld",innerHTML:'<span class="dld_inner">'+msg+"</span>"})),hide(t)}if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__.logEvalError)(_,js)}},showProgress:function(){el&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(el,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem)(el):inline&&(hide(el),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(el)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(el).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span",{className:"progress_inline"}))))},hideProgress:function(){el&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(el,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem)(el):inline&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(el),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(el)))},stat:[jsc("web/privacy.js"),"privacy.css"]});var btn=ge("delete_post"+post);btn&&btn.tt&&btn.tt.el&&btn.tt.destroy()},ignoreAdsItem:function(_,e,t){var o=ge("post"+_),i=o.getAttribute("data-ad"),a=geByClass1("ui_actions_menu_wrap",o);o&&(a&&uiActionsMenu.toggle(a,!1),Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_24__.revertLastInlineVideo)(o),ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:_,feed_raw:e,hash:t,ad_data:i,no_html:1},{onDone:function(){hide(o)}}))},ignoreAdsOwner:function(_,e,t,o){var i=ge("post"+_);i&&ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:_,owner_id:e,hash:t,list:0,no_html:1},{onDone:function(_){hide(i)},showProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(o),hideProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(o)})},markAsAds:function(_,e,t,o){ajax.post("al_wall.php",{act:"mark_as_ads",post:_,hash:e,full:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(o)},{onDone:function(e){ge("ui_actions_menu_item_mark_as_ads"+_).innerHTML=e}})},restorePost:function(_,e,t){return(cur.wallLayer?wkcur:cur).wallMyDeleted[_]=0,ajax.post("al_wall.php",{act:"restore",post:_,hash:e,root:t?1:0},{onDone:function(e){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("post_del_btn"+_),Wall.postHideDeletedMessage(_)){var t=ge("post"+_);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"suggest")?Wall.suggestUpdate(1):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"postponed")?wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"own")&&--cur.deletedCnts.own,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"all")&&--cur.deletedCnts.all,Wall.isArchiveWall()&&--cur.deletedCnts.archive,Wall.update())}}}),!1},blockPostApp:function(_,e,t,o){ajax.post("al_wall.php",{act:"block_post_app",aid:_,from:e,hash:t},{onDone:function(_){o.parentNode.parentNode.innerHTML=_},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(o)})},checkPostClick:function(_,e,t){if(e=e||window.event,!_||!e)return!0;var o=e.target||e.srcElement,i=8,a=!1,l=/wall_post_text|published_comment|post_media|page_event_share|page_public_share|page_group_share|feed_friends|feed_videos|feed_explain_list|explain|feed_photos|feedback_row/;do{if(!o||o==_||o.onclick||o.onmousedown||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(o.tagName,["A","IMG","TEXTAREA","EMBED","OBJECT"])||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(o.className,["play_new","video_box_wrap"])||(a=o.className.match&&o.className.match(l)))break}while(i--&&(o=o.parentNode));if(!a)return!1;if(cur.postClicked||(cur.postClicked={}),!t||!cur.postClicked[_]){if(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return!1;t&&(cur.postClicked[_]=!0,setTimeout((function(){cur.postClicked[_]=!1}),2e3))}return o||!0},postClick:function(_,e,t){t=t||{};var o,i=(_||"").match(/^(-?\d+)_(wall)?(\d+)$/),a=ge("post"+_);if(o=!!t.skipCheck||Wall.checkPostClick(a,e)){if(!0!==o){var l=geByClass1("wall_post_more",o,"a");if(l&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(l))return l.onclick(),void(i||removeClass(a,"wall_post_over"))}if(i&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(a,"suggest")&&!cur.onepost){var s=a&&a.getAttribute("data-ad"),r=a&&a.getAttribute("data-ad-block-uid"),n="/wall"+i[1]+"_"+i[3];if(browser.mobile&&e){var d={};s&&r&&(d.params={_post_ad_data:s,_post_ad_block_unique_id:r}),nav.go(n,null,d)}else Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.checkEvent)(e)?window.open(n,"_blank"):(s&&r&&(t.ads_params={post_ad_data:s,ad_block_unique_id:r}),Wall.hideEditPostReply(),Wall.postFull("wall"+i[1]+"_"+i[3],!1,t))}}},postClickStat:function(_){var e=(_=Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.normEvent)(_)).currentTarget,t=[];e.getAttribute("data-ad-view")&&(t.push(Wall.postsGetRaws(e)),Page.postsSeen(t));var o=_.target;Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(o.getAttribute("data-post-click-type"),["post_owner_img","post_owner_link"])||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(o,"author")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(o,"post_image")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(o,"post_img")?Wall.triggerAdStat(e,"click_post_owner"):("A"==_.target.nodeName&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wall_post_text",_.target,e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("page_media_thumbed_link",_.target,e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_.target,"lnk")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("lnk",_.target,e))&&Wall.triggerAdStat(e,"click_post_link")},adBlockClickStat:function(_,e){var t=(_=Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.normEvent)(_)).currentTarget;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"_ads_block_data_w")||(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_ads_block_data_w",t));var o=[];t.getAttribute("data-ad-view")&&(o.push(Wall.postsGetRaws(t)),Page.postsSeen(o)),Wall.triggerAdStat(t,e)},getAdsEvents:function(){var _=Wall._lsAdsEvents;return _||(_=Wall._lsAdsEvents=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get(Wall.LS_ADS_EVENTS)||{}),_},cleanAdsEvents:function(){var _=Wall.getAdsEvents(),e=(new Date).getTime()/1e3|0,t=!1;each(_,(function(o,i){e-i>=3600&&(delete _[o],t=!0)})),t&&_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set(Wall.LS_ADS_EVENTS,_)},triggerAdPostStat:function(_,e){Wall.triggerAdStat(_,e)},triggerAdStat:function triggerAdStat(elIdOrEl,event){for(var el="string"==typeof elIdOrEl?Wall.domPost(elIdOrEl):elIdOrEl,pixels=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-stat-"+event);pixels;){var adBlockUID=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-block-uid"),isUniqueEvent=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(event,["load","impression","impression_long","video_start","video_play_3s","video_play_10s","video_play_25","video_play_50","video_play_75","video_play_95","video_play_100"]);if(isUniqueEvent&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-disabled-stat-"+event,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-stat-"+event)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-stat-"+event,null)),adBlockUID&&isUniqueEvent)try{var eventKey=Object(_web_lib_utils__WEBPACK_IMPORTED_MODULE_31__.hashCode)(""+event+adBlockUID),lsData=Wall.getAdsEvents();if(lsData[eventKey])break;var now=(new Date).getTime()/1e3|0;lsData[eventKey]=now,_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set(Wall.LS_ADS_EVENTS,lsData)}catch(_){try{console.log(_.message)}catch(_){}}pixels=pixels.split("$$$"),each(pixels,(function(_,e){Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.vkImage)().src=e}));break}var statHtml=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-stat-html-"+event);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(el,"ad-stat-html-"+event,null),statHtml)for(var statElemWrap=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:statHtml}),elem;elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__.logEvalError)(_,elem.innerHTML)}},copyHistory:function(_,e,t,o){var i=(_=_||window.event).target||_.srcElement,a=8,l=!1,s=/published_a_quote/;do{if(!i||(l=i.className.match(s))||i.onclick||i.onmousedown||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(i.tagName,["A","IMG"]))break}while(a--&&(i=i.parentNode));if(l&&!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return ajax.post("al_wall.php",{act:"copy_history",post:t,offset:o,from:cur.module},{onDone:function(_){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(e)&&(hide(e),_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(e),"published_by_quote")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(e):e;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(t).insertBefore(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(t)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isAncestor)(t,"im_rows")?IM.updateScroll(!0):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isAncestor)(t,"wl_post")&&WkView.wallUpdateReplies()}}}),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(_)},postFull:function(_,e,t){if(_.match(/^wall-?\d+_\d+$/)&&!(t||{}).nolist&&(!cur.pgParams||!cur.pgParams.owners_only&&!cur.pgParams.q))switch(cur.wallType){case"all":case"full_all":_+="/all"}return Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_13__.showWiki)({w:_},!1,e,t)},checkReplyClick:function(_,e){if(e=e||window.event,!_||!e)return!1;var t=e.target||e.srcElement,o=8,i=!1;do{if(!t||t==_||t.onclick||t.onmousedown||"A"==t.tagName&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"_reply_lnk")||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(t.tagName,["IMG","TEXTAREA","EMBED","OBJECT"])&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"emoji")||"wpe_cont"==t.id||(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"_reply_content")))break}while(o--&&(t=t.parentNode));return!i||!!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())},replyClick:function(_,e,t,o){var i=_.split("_"),a=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(i[0]),l=i[1].replace(/-?\d+$/,""),s=ge("post"+a+l+"_"+e),r=ge("post"+_);if(!(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(r,"closed_comments")||!cur.stickerClicked&&Wall.checkReplyClick(s,t))){(t||{}).cancelBubble=!0;var n=geByClass1("wall_reply_more",s,"a");if(n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(n))return removeClass(s,"reply_moreable"),void n.onclick();if(o){r=cur.wallLayer?ge("wl_post"):r;var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(r,"deep_active"),c=cur.stickerClicked||!1,p=_;if(d){var u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",s);p=u?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(u,"post-id"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(s,"post-id")}var b=ge("reply_field"+p);cur.stickerClicked=!1,!c||b&&b.emojiInited||(cur.afterEmojiInit=cur.afterEmojiInit||{},cur.afterEmojiInit[p]=function(){Emoji.clickSticker(c,ge("reply_field"+p))}),Wall.replyTo(p,e,o,t),c&&b&&b.emojiInited&&Emoji.clickSticker(c,b)}}},stickerClick:function(_,e,t){if((t||{}).cancelBubble=!0,window.Emoji)if(e){var o=Emoji.isStickerPackEnabled(_,Wall.stickerClick.pbind(_,e));if(0!==o)if(o){var i=e.parentNode,a=8;do{if(!i||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"reply"))break}while(a--&&(i=i.parentNode));i&&i.onclick&&(cur.stickerClicked=_,i.onclick())}else Emoji.clickSticker(_,!1)}else Emoji.clickSticker(_,!1);else stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Wall.stickerClick(_,e)}))},domPost:function(_){return ge("post"+_)},formatCount:function(_,e){return e=e||{},Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.formatCount)(_,e)},likeFullUpdate:function(_,e,t){var o=e.match(/^(wall|photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(-?\d+_)(\d+)/);Likes.update(o?(o[1]||"wall")+o[2]+o[3]:e,t)},likeUpdate:function(_,e,t,o,i,a,l){l||(o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(o)),!1===_&&cur.wallLayer===e&&(_=ge("wl_post_body"));var s=e.match(/(-?\d+)(_?)(photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),r=s[1]+"_"+s[4],n=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",_))||wall.domPost(r),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(n,l?"_views_wrap":a?"_share_wrap":"_like_wrap"),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(d,"_count");if(c){if(!l&&!a){var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(n,"_views_wrap"),u=p&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(p,"_count");!u||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(p,"_auto_update")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(u)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(u)!=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(c)||wall.likeUpdate(_,e,0,this.formatCount(o),void 0,void 0,1)}var b=d.tt||{},E=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(b.opts||{}),O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(b.container,"_value"),m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(b.container,"_content"),w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(b.container,"_title");i&&w&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(w,i),b&&(b.likeInvalidated=!0),O&&(O.value=o),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.animateCount)(c,l?o:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(o,"%s",!0),{str:"auto",noWrapWidth:!!l}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(d,a?"my_share":"my_like",t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(d,l?"no_views":a?"no_shares":"no_likes",!o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(m,"me_hidden",!t&&!l),o?b.el&&(!1===i?b.destroy&&b.destroy():Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(b.container)||i||!1===i||tooltips.show(b.el,extend(E,{showdt:0}))):b.el&&b.hide();var g=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(o,"%s",!0);if(l){var h=geByClass1("feedback_views",n),P=0;P=o.match(/^\d+$/)?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(o):5,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(h,"<em>"+o+"</em> "+getLang("global_X_post_views",P,!0))}else if(a){var D="";o>0&&(D="<em>"+g+"</em> "+getLang("global_X_shared",o,!0)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(geByClass1("feedback_share",n),D)}else{var M="";o>0&&(M="<em>"+g+"</em> "+getLang("global_like")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(geByClass1("feedback_like",n),M)}Wall.updateFeedbackVisibility(n)}},updateFeedbackVisibility:function(_){var e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(geByClass1("feedback_views",_))),t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(geByClass1("feedback_share",_))),o=!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(geByClass1("feedback_like",_)))&&!t&&!e;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(geByClass1("post_feedback_info",_),"empty",o)},likeShareUpdate:function(_,e,t,o,i){return Wall.likeUpdate(_,e,t,o,i,!0)},like:function(_,e){if(vk.id&&!cur.viewAsBox){var t=wall.domPost(_),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(t,"_like_wrap"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(o,"_icon"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(o,"_count"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"fw_like_icon")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(i,"fw_my_like"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(o,"my_like"),s=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),r=(s[3]||"wall")+s[1]+"_"+s[4],n=cur.module;cur.wallType&&(n="feed"==cur.wallType?"feed_"+("news"==cur.section&&cur.subsection?cur.subsection:cur.section):"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full")),ajax.post("like.php",{act:"a_do_"+(l?"un":"")+"like",object:r,hash:e,wall:2,from:n},{onDone:Wall.likeFullUpdate.pbind(!1,_)});var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(a);Wall.likeUpdate(!1,_,!l,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(d)+(l?-1:1)),cur.onWallLike&&cur.onWallLike()}},bookmark:function(_,e){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e),addClass(_,"bookmarked")},likeShare:function(_,e){if(vk.id&&!cur.viewAsBox){var t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4],i=ge("like_share_"+o),a=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(i),l=cur.wallType?"feed"==cur.wallType?"feed_"+cur.section:"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module;"top"==cur.wallType&&(l="wall_top"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(i),ajax.post("like.php",{act:"a_do_"+(a?"un":"")+"publish",object:o,hash:e,wall:2,ref:l},{onDone:Wall.likeFullUpdate.pbind(!1,_)});var s=wall.domPost(_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(s,"_like_wrap"),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(r,"_icon"),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(s,"_count")),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(n,"fw_like_icon")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(n,"fw_my_like"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(r,"my_like");Wall.likeUpdate(!1,_,!0,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(d)+(c?0:1))}},likeShareCustom:function(_,e){var t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4];Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showBox)("like.php",extend({act:"publish_box",object:o},e))},likeShareCheckLen:function(_,e,t){_=ge(_),e=ge(e),t=t||255;var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen!==o.length){var i=_.lastLen=o.length,a=i-o.replace(/\n/g,"").length;i>t-50||a>4?(i>t?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,getLang("text_exceeds_symbol_limit",i-t)):a>4?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,getLang("global_recommended_lines",a-4)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,getLang("text_N_symbols_remain",t-i)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(e)):hide(e)}},showLikesPage:function(_,e,t){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:_,published:e,offset:t,wall:1},e)},clearLikesCache:function(_,e){var t="^/like.php#"+Object(_shared_lib_convert__WEBPACK_IMPORTED_MODULE_26__.toQueryString)({act:"a_get_members",object:_,published:e,offset:12345,wall:1,tab:e,only_content:1}).replace("12345","\\d+")+"$",o=new RegExp(t,"i");for(var i in ajaxCache)o.test(i)&&delete ajaxCache[i]},subscribeByButton:function(_,e,t,o,i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_subscribed"),l={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(_),onDone:function(){a=!a,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(_,"_subscribed",a)}},s={};e>0&&i&&(s.from=i),Wall.subscribeToAuthor(a,e,t,o,l,s)},subscribeByAction:function(_,e,t,o){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.actionsMenuItemLocked)(_)){var i=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"value"))?1:0,a={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem.pbind(_)},l={};e>0&&o?l.from=o:e<0&&(a=extend(a,{onDone:function(o,l,s){if(l){var r=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("global_warning"),l,getLang("group_leave_group"),(function(){r.hide(),Wall.subscribeToAuthor(i,e,t,a,"",{confirm:1})}),getLang("global_cancel"));return!0}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_,o),_.setAttribute("data-value",1-i),s&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_))}})),Wall.subscribeToAuthor(i,e,t,"",a,l)}},subscribeToAuthor:function(_,e,t,o,i,a){i=extend({onFail:function(_){setTimeout(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("global_error"),_).hide,3e3)}},i),a=a||{},e>0?ajax.post("al_friends.php",extend({act:_?"remove":"add",mid:e,hash:t,from:"feed"},a),i):ajax.post("al_groups.php",extend({act:_?"list_leave":"list_enter",gid:-e,hash:t},a),i),o&&ajax.post("al_feed.php?act=viral_subscribe_stat",{author_id:e,subscribe:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(!_),hash:o})},showPhoto:function(_,e,t,o,i){return!Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showBox)("al_photos.php",{act:"photo_box",to_id:_,photo:e,hash:t},{cache:1},!!o.href&&i)},_animDelX:function(_,e,t,o){},domFC:function(_){for(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(_);_&&_.id.match(/page_wall_count_/);)_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(_);return _},domPS:function(_){for(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPS)(_);_&&_.id.match(/page_wall_count_/);)_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPS)(_);return _},scrollCheck:function(_,e,t){var o,i,a=null==e?Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)():e,l=0,s=[],r=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight;if(window.scrollAnimation)return!1;if((Wall.repliesSideUpdate(a),cur.wallPage)&&(i="suggested"==cur.wallTab?ge("page_suggested_posts"):"top"==cur.wallTab?ge("page_top_posts"):"donut"===cur.wallTab?ge("page_donut_posts"):ge("page_wall_posts"),(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(cur.topRow)!=i||((cur.topRow||{}).id||"").match(/page_wall_count_/))&&(cur.topRow=Wall.domFC(i)),vk.id&&cur.topRow&&!cur.topRow.id.match(/page_wall_count_/)&&!((window.curNotifier||{}).idle_manager||{}).is_idle)){for(var n=[],d=Wall.domPS(cur.topRow);d;d=Wall.domPS(d))cur.topRow.offsetTop>a&&(cur.topRow=d),d.unseen||(d.unseen=!0,n.push(Wall.postsGetRaws(d)));Page.postsUnseen(n);for(var c=cur.topRow;c;c=o){LongView&&LongView.register(c,"Wall");var p=l||c.offsetTop;if(p>=a+r)break;(((o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(c))||{}).id||"").match(/page_wall_count_/)&&(o=null),(l=o?o.offsetTop:p+c.offsetHeight)<a&&o&&(cur.topRow=o);var u=c.bits||0;u>=3||(u|=(p>=a&&p<a+r?1:0)|(l>=a&&l<a+r?2:0))&&(c.bits=u,3==u&&s.push(Wall.postsGetRaws(c)))}LongView&&LongView.onScroll(a,r),Page.postsSeen(s)}if(cur.wallAutoMore&&!cur.wallLoading&&!cur.viewAsBox){var b=ge("wall_more_link");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(b)&&a+lastWindowHeight+1500>Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(b)[1]&&b.onclick()}},postsGetRaws:function(_){var e,t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.indexOf)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_).children,_),o={};if(!_)return o;o.module=cur.module,o.index=t;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_ads_promoted_post"),a=_.getAttribute("data-ad-view");a&&(o["ad_"+a]=1,i&&(o.module+="_ads_promoted_post"));var l=_.getAttribute("post_view_hash");if(l&&(o.hash=l),"block_"===_.id.substr(0,6)){o[_.id]=1,o.block=_.id.substr(6);var s=attr(_,"data-contain");s&&(s=s.split(",")).forEach((function(_){_=_.split(":"),o[_[0]]=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_[1])||1}))}else(e=_.id.match(/^post(-?\d+_\d+)$/))&&(o[e[1]]=1,(e=(_.getAttribute("data-copy")||"").match(/^(-?\d+_\d+)$/))&&(o[e[1]]=-1));return o},votingExtendParams:function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"fixed")&&(_.is_fixed=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"preview")&&(_.is_preview=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"board")&&(_.is_board=1),vk.widget&&(_.is_widget=1,_.width=cur.widgetWidth,_.url=cur.url),cur.voteHash&&(_.vote_hash=cur.voteHash);var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"id");t&&(_.voting_id=t);var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"ref");o&&(_.ref=o);var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"hash");i&&(_.hash=i);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"material");return!a||_.is_board||_.is_widget||(_.material=a),_},votingRevote:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"id");if(this.votingIsLocked(t))return;var o=this.votingExtendParams({act:"revote"},e);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,t),showProgress:this.votingLock.bind(this,t),hideProgress:this.votingUnlock.bind(this,t)})}},votingIsLocked:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_media_voting"+_),t=!1;return e.forEach(_=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"media_voting_locked")&&(t=!0)}),t},votingLock:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_media_voting"+_).forEach(_=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"disabled")&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"queue")||addClass(_,"media_voting_locked")})},votingUnlock:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_media_voting"+_).forEach(_=>{removeClass(_,"media_voting_locked")})},votingUpdate:function(_,e){ajax.post("al_voting.php",{act:"get_layout",voting_id:_},{onDone:t=>{Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(e)&&!1===e(t)||(this.votingUpdateFull(_,t),this.votingUnlock(_))},onFail:()=>this.votingUnlock(_),showProgress:()=>this.votingLock(_)})},votingUpdateFull:function(_,e){if(_&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isString)(e)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_media_voting"+_);t.length&&(t.forEach(_=>{if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"disabled")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"queue"))if(""===e)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_);else{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(e);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"media_voting_can_vote")){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(t);addClass(o,"media_voting_just_voted"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(_,t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.removeClassDelayed)(o,"media_voting_just_voted")}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(_,t)}}),window.IMBRIDGE&&setTimeout(IMBRIDGE.syncHistory.bind(IMBRIDGE),0),vk.widget&&window.WPoll&&window.WPoll.resizeWidget())}},votingUpdatePartly:function(_,e){if(_&&isObject(e)&&!this.votingIsLocked(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_media_voting"+_);if(t.length){var o=e.answers.reduce((_,e)=>Math.max(_,e.rate),0),i={};e.answers.forEach(_=>{_.isLeader=_.rate===o,i[_.id]=_}),t.some(t=>{if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"disabled")){if(t.classList.contains("media_voting_voted")&&!e.votes)return this.votingUpdate(_),!0;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("media_voting_option_wrap",t).forEach(_=>{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"id"),o=i[t];if(_.tt&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isFunction)(_.tt.destroy)&&_.tt.destroy(),o){var a=geByClass1("media_voting_option_bar",_),l=geByClass1("media_voting_option_percent",_),s=geByClass1("media_voting_option_count",_),r=geByClass1("media_voting_option_counter",_),n=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(o.votes,"%s",!0),d=new Array(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(n).textContent.split("").length+2).join("0");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domLC)(s),d),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domLC)(r),n),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(l,e.votes?o.rate:""),a.style.transform=`scaleX(${.01*o.rate})`,a.style.oTransform=`scaleX(${.01*o.rate})`,o.votes?s.classList.remove("media_voting_option_count_hidden"):(s.classList.add("media_voting_option_count_hidden"),_.classList.remove("media_voting_option_voted")),o.isLeader?_.classList.add("media_voting_option_leader"):_.classList.remove("media_voting_option_leader")}});var o=geByClass1("_media_voting_footer_voted_text",t);if(o){var a;a=e.votes?vk.widget?"voting_x_voted_short":"voting_x_voted":"voting_nobody_voted",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(o,getLang(a,e.votes,!0));var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("media_voting_footer_voted_friend",t);l.length>e.votes&&l.forEach(_=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(_)})}}}),window.IMBRIDGE&&window.IMBRIDGE.syncHistory(),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()}}},votingUpdateByPostRaw:function(_){if(vk.id){_=_.split("_");var e=positive(_[1]),t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_[0]),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_post_media_voting"+t+"_"+e);if(o&&o.length){var i=geByClass1("media_voting",o[0]);if(i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"id");this.votingUpdate(a)}}}},votingVote:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"id");if(!this.votingIsLocked(t)&&vk.id){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"queue"))return this.votingUpdate(t,_=>{if(_&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isString)(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(_));if(t&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"queue")&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"disabled"))return this.votingVote(t,e,!0),!1}});if(e.length){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_),"wk_voting_box"),i=this.votingExtendParams({act:"vote",option_ids:e.join(",")},_);ajax.post("al_voting.php",i,{onDone:(_,e)=>{o?nav.reload():(vk.widget&&window.WPoll&&window.WPoll.updateShareMessage(e),this.votingUpdateFull(t,_))},showProgress:this.votingLock.bind(this,t),hideProgress:()=>{o||this.votingUnlock(t)}})}}else vk.widget&&Widgets.oauth()},votingButtonVote:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"media_voting_multiple")){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("media_voting_option_selected",e),o=[];t.forEach((function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"id");e&&o.push(e)})),this.votingVote(e,o)}},votingOptionVote:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(t){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"media_voting_multiple")){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"id");if(this.votingIsLocked(o)||!vk.id)return void(vk.widget&&Widgets.oauth());Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(_,"media_voting_option_selected");var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("media_voting_option_selected",t).length;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(t,"media_voting_has_selected_options",i)}else{var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"id");this.votingVote(t,[a])}Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e)}},votingOptionTooltip:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"id"),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"owner-id"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"id"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"board");Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(_,{url:"al_voting.php",params:{act:"option_tt",option_id:t,owner_id:o,is_board:a,voting_id:i},slide:15,ajaxdt:100,showdt:400,hidedt:200,dir:"auto",shift:[0,10,10],typeClass:"voting_tt"})}},votingLayer:function(_,e){var t=!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"media_voting_option_wrap")&&_,o=t?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"id"):0,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"media_voting")?_:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"id"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"owner-id"),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"board"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"ref"),n={w:(s?"board_poll":"poll")+l+"_"+a};if(o&&(n.opt_id=o),vk.widget)window.open(location.origin+"/"+n.w,"poll");else{var d={queue:1,noloader:!!Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)()};"story"===r&&(d.customRef="story"),Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_13__.showWiki)(n,!1,void 0,d)}Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e)}},votingExport:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"board")){var t=this.votingExtendParams({act:"export_box"},e);Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showBox)("al_voting.php",t,{onDone:function(){Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_20__.curBox)().setOptions({width:500})}})}},votingOnMain:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(t){if(this.votingIsLocked(o))return;var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"id"),i=this.votingExtendParams({act:"onmain",state:e?1:0},t);ajax.post("al_voting.php",i,{onDone:this.votingUpdateFull.bind(this,o),showProgress:this.votingLock.bind(this,o),hideProgress:this.votingUnlock.bind(this,o)})}},votingClosed:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"id");if(this.votingIsLocked(o))return;var i=this.votingExtendParams({act:"closed",state:e?1:0},t);ajax.post("al_voting.php",i,{onDone:this.votingUpdateFull.bind(this,o),showProgress:this.votingLock.bind(this,o),hideProgress:this.votingUnlock.bind(this,o)})}},votingNarrowAction:function votingNarrowAction(votingId,hash,action){var act,state;switch(action){case 101:act="closed",state=0;break;case 102:act="closed",state=1;break;case 103:act="onmain",state=0;break;case 104:act="onmain",state=1}act&&!cur.votingNarrowActionProgress&&ajax.post("al_voting.php",{act,voting_id:votingId,is_fixed:1,state,narrow:1,hash},{onDone:function onDone(html,js){var votingModuleEl=ge("group_voting");if(votingModuleEl&&(votingModuleEl=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(votingModuleEl),html?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(votingModuleEl,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(html)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(votingModuleEl)),js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_29__.logEvalError)(_,js)}},showProgress:function(){cur.votingNarrowActionProgress=!0},hideProgress:function(){cur.votingNarrowActionProgress=!1}})},votingReport:function(_,e){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.actionsMenuItemLocked)(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("media_voting",_);if(t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"id");if(this.votingIsLocked(o))return;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"board");ajax.post("al_voting.php",{act:"a_report_form",voting_id:o,is_board:i,hash:e},{onDone:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cf)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"media_voting_board")&&addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(e),"media_voting_board"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(t,e),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockActionsMenuItem)(_),this.votingLock(o)}.bind(this),hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockActionsMenuItem)(_),this.votingUnlock(o)}.bind(this)})}}},foTT:function(_,e,t){t&&t.oid&&(e=t.oid==vk.id?getLang("wall_my_friends_only"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("wpfo"+t.pid)),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTitle)(_,e)},update:function(){if(cur.wallLayer)WkView.wallUpdateReplies();else{var _="top"===cur.wallType,e="archive"===cur.wallType,t="donut"===cur.wallType;if(("all"===cur.wallType||"own"===cur.wallType||_||e||t)&&("all"===cur.wallTab||"own"===cur.wallTab||"top"===cur.wallTab||"archive"===cur.wallTab||"donut"===cur.wallTab)){var o=e?"all":_||t?"own":cur.wallType,i=ge("wall_more_link"),a=Wall.getPostsWrap(cur.wallType),l=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(cur.deletedCnts[o]),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)(o,a).length-l,r=!1;if((_||e||t)&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(geByClass1("no_posts",a))||_&&cur.wallTopFinished===cur.oid||e&&cur.wallArchiveFinished===cur.oid||t&&(cur.wallDonutFinished===cur.oid||Wall.cantAccessDonutPosts())))r=!0;else{var n;if(n=e?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_archive")):_?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_top")):t?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_donut")):"own"===o?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own")):Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all")),"suggested"!==cur.wallTab){var d=n;cur.oid<0&&cur.options.fixed_post_id&&(d-=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_posts_count",d?Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(d,cur.options.wall_counts):cur.options.wall_no)}var c=s;!_&&!e&&cur.options.fixed_post_id&&cur.options.wall_oid<0&&(c+=1),r=c>=n-l}r?hide(i):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(i),i.onclick=Wall.showMore.pbind(s)),cur.wallTab==cur.wallType&&(shortCurrency(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler())}}},getAbsDate:function(_,e){e=e||window.cur;var t,o=new Date(_||Date.now()),i=o.getHours(),a=o.getMinutes(),l="";return e.wallTpl.time_system&&(l=e.wallTpl.time_system[i>11?1:0],i=i%12||12),t=i>9?i:"0"+i,a=a>9?a:"0"+a,e.wallTpl.date_format.replace("{am_pm}",l).replace("{hour}",i).replace("{num_hour}",t).replace("{minute}",a)},getNowRelTime:function(_){_=_||window.cur;var e=Date.now();return'<span class="rel_date rel_date_needs_update" time="'+Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e/1e3-(_.tsDiff||0))+'" abs_time="'+Wall.getAbsDate(e,_)+'">'+getLang("wall_just_now")+"</span>"},getNewPostHTML:function(_,e,t,o){o=o||window.cur;var i,a=[],l=_[2],s=l.split("_")[0],r="",n="",d=_[4].split("|"),c=Wall.getNowRelTime(o);1==_[8]?(r+=o.wallTpl.reply_link,n+=o.wallTpl.reply_button):s!=vk.id&&(r+=o.wallTpl.own_reply_link);var p=_[3].replace("mem_link","author").replace("memLink","author"),u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(p),b=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.unclean)(u.innerText||u.textContent||""));-1!=_[6].indexOf('id="wpfo')&&(p+='<span class="page_fronly inl_bl" onmouseover="Wall.foTT(this, false, {oid: \''+s+"', pid: '"+_[2]+"'})\"></span>"),o.wallTpl.custom_del&&(e>(_[9]==s?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)||s==vk.id||_[9]==vk.id||_[2].split("_")[0]!=_[4])&&a.push(o.wallTpl.custom_del),e>(_[9]==s?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)||s==vk.id||_[9]==vk.id?a.push(o.wallTpl.del):_[2].split("_")[0]!=_[4]&&a.push(o.wallTpl.spam);var E=e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&_[9]==s||s==vk.id||_[9]==vk.id;E&&"rss"!==_[13]&&a.push(o.wallTpl.edit),s!=vk.id&&_[9]!=vk.id||!_[6]||(_[6]=_[6].replace("vk2017_snippet_show_layer_button","vk2017_snippet_show_layer_button_hidden"));var O=s<0&&_[9]==s&&e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR;return i={oid:s,name:p,actions:a.length?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.wallTpl.post_actions,{actions:a.join("")}):"",replies:"",reply_link:r,reply_button:n,own_reply_link:o.wallTpl.own_reply_link,reply_box:1==_[8]?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.wallTpl.reply_box,{actions:"",class:O?" reply_fakebox_with_official":""}):"",photo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(d[0]),link:_[5],text:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(_[6]),date:c,post_id:_[2],poll_hash:o.wallTpl.poll_hash,date_postfix:"",user_image:"",post_url:"/wall"+l.replace("_wall_reply","_"),can_reply_as_group:O?1:"",owner_photo:O?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(d[1]||d[0]):"",owner_href:O?_[5]:"",owner_name:O?b:"",online_class:s>0?" online":"",likes:Likes.makeTemplate(o.wallTpl.post_likes,{object_raw:_[2]})},t&&extend(i,t(i,_)),E&&o.wallTpl.author_data&&(i.date=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.wallTpl.author_data,{date:i.date,post_id:l})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.wallTpl.post,i),i)},updateAnonNewPost:function(_,e){if("anon"==_[13]){var t=geByClass1("author",e),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span");o.innerHTML=t.innerHTML,o.className=t.className,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(t,o);var i=geByClass1("post_image",e),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span");a.innerHTML=i.innerHTML,a.className=i.className,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(i,a)}return e},getNewReplyHTML:function(_,e,t,o){o=o||window.cur;var i=[],a=ge("reply_field"+_[2])||ge("reply_fakebox"+_[2])||ge("fwr_text"),l="",s="",r="",n=_[10]||"";(e>constants.Groups.GROUPS_ADMIN_LEVEL_USER||!_[2].indexOf(vk.id+"_")||_[4]==vk.id?i.push(o.wallTpl.del_reply):_[2].split("_")[0]!=_[4]&&i.push(o.wallTpl.spam_reply),(e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&_[4]==Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_[2])||_[4]==vk.id)&&i.push(o.wallTpl.edit_reply),-1!=_[8].indexOf('class="wall_reply_more"')&&(l+="reply_moreable"),a)&&(l+=" reply_replieable",s=o.wallTpl.reply_link_wrap,wall.getReplyNames()[_[4]]||wall.addReplyName(_[4],[_[11],_[12]]));l&&(r=" onclick=\"Wall.replyClick('%post_id%', %reply_msg_id%, event, %reply_uid%)\""),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.wallTpl.reply_actions,{actions:i.join("")});var d={name:_[5].replace("mem_link","author"),photo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(_[6]),link:_[7],text:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(_[8]),classname:l,actions:i,attr:r,date:Wall.getNowRelTime(o),to_link:n,answer_link:s,post_id:_[2],reply_id:_[3],like_id:_[3].replace("_","_wall_reply"),reply_msg_id:_[3].split("_")[1],reply_uid:_[4]||"false",likes:Likes.makeTemplate(o.wallTpl.reply_likes,{object_raw:_[3]})};return t&&extend(d,t(d)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.wallTpl.reply,d)},updatePostImages:function(_){return _.replace(/<img[^>]+>/g,(function(_){return _.match(/class=/)?_.replace("src=","data-src=").replace('class="','class="__need_img '):_}))},loadPostImages:function(_){each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("__need_img",_,"img"),(function(){var _=this.getAttribute("data-src");_&&(this.src=_,this.removeAttribute("data-src")),removeClass(this,"__need_img")}))},openNewComments:function(_){var e=ge("replies"+_),t=e.nextSibling,o=geByClass1("wr_header",e,"a"),i=0,a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",e,"div").length,l=a,s=t.newCnt;Wall.loadPostImages(e),each(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clone)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("new_reply",e,"div")),(function(){if(removeClass(this,"new_reply"),Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(this),100==++i)return!1})),o&&(l=i+Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(o.getAttribute("offs").split("/")[1])),a+=-s+i,(l>3||a<l)&&(o||e.insertBefore(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("a",{className:"wr_header"}),e.firstChild),Wall.updateRepliesHeader(_,o,a,l)),cur.wallMyOpened[_]=1,t&&"replies_open"==t.className&&(s>100?(t.innerHTML=getLang("news_x_new_replies_more",Math.min(100,s-i)),t.newCnt-=i):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t)),Wall.repliesSideSetup(_)},langWordNumeric:function(_,e,t){return Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langWordNumeric)(_,e,t)},updateTimes:function(_){var e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Date.now()/1e3),t=[];e-=cur.tsDiff,each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("rel_date_needs_update",_||ge("page_wall_posts"),"span"),(function(_,o){if(o){var i=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(o.getAttribute("time")),a=e-i,l=Object(_web_lib_date__WEBPACK_IMPORTED_MODULE_41__.getFormattedDiffTimeText)(a);l||(l=o.getAttribute("abs_time"),t.push(o)),o.innerHTML=l}})),each(t,(function(){removeClass(this,"rel_date_needs_update")}))},updateRepliesHeader:function(_,e,t,o){if(!cur.onepost){var i,a,l=e.href,s=3,r=0;if(!l&&(a=_.match(/^(-?\d+)_(photo|video|note|topic|video|)(\d+)$/))){var n=a[2]||"wall";switch(l="/"+n+a[1]+"_"+a[3],n){case"topic":l+="?offset=last&scroll=1";break;case"wall":l+="?offset=last&f=replies"}e.href=l}o>t?t<100?(i=o>100?getLang("wall_show_n_last_replies",100):getLang("wall_show_all_n_replies",o),s=!1):i=getLang("wall_hide_replies"):(i=getLang("wall_hide_replies"),r=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(e,"wrh_all",r),e.innerHTML=i,e.onclick=Wall.showReplies.pbind(_,s,!1),e.setAttribute("offs",t+"/"+o)}},processQueueEvent(_){if(isObject(_)&&_.entity_type)switch(_.entity_type){case"voting":this.votingUpdatePartly(_.data.id,_.data)}},updated:function(_,e,t){var o=_?window.wkcur:window.cur;if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(o.wallQueues)&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(t.events)&&t.events.length){var i=o.wallQueues.filter(_=>_.key===e).pop();if(i)if(t.failed)o.wallQueues=!1;else{i.ts=t.ts;var a=_?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollGetY)(),l=a,s=!(o.wallType||"").indexOf("full"),r=o.onepost,n=!!_,d=_;s&&(nav.objLoc.q||nav.objLoc.search||nav.objLoc.day)||(each(t.events,(function(){if(isObject(this))return Wall.processQueueEvent(this);var e=this.split("<!>"),t=e[0],i=e[1],a=e[2],c=0,p=0,u=_&&window.cur.wallLayer==a&&ge("wl_post");if(u&&"del_reply"!=i||(u=ge("post"+a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isAncestor)(u,_?wkLayerWrap:pageNode)||(u=null)),t==o.options.qversion){switch((Wall.isArchiveWall()?"archive_post"===i:"reveal_post"===i)&&(i="res_post"),(Wall.isArchiveWall()?"reveal_post"===i:"archive_post"===i)&&(i="del_post"),i){case"new_post":if(u)break;if(s&&o.pgStart>0){o.pgOffset++;break}if(o.oid==vk.id&&vk.id==e[9]&&window.curNotifier&&curNotifier.idle_manager.is_idle&&Wall.clearInput(),"own"!==o.wallType&&"all"!==o.wallType&&!Wall.hasPosts("own"))break;var b=ge("page_wall_posts"),E=b.lastChild,O=!!s&&FullWall.addTetaTet,m=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e[e.length-1]),w=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&m?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&m?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,g=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Wall.getNewPostHTML(e,w,O,o)),h=b.firstChild;if(Wall.updateAnonNewPost(e,g),ge("post"+a))break;for(E&&E!=g?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(E):E=!1,s?E||o.pgOffset++:(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all"))+1),addClass(g,"all"),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e[10])&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own"))+1),addClass(g,"own"))),0==e[8]&&addClass(g,"closed_comments"),o.deepRepliesActive&&addClass(g,"deep_active");h&&("INPUT"==h.tagName||1!=h.nodeType||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(h,"post_fixed"));)h=h.nextSibling;b!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(h)&&Wall.sendInsertBeforeError(),b.insertBefore(g,h),Wall.votingUpdateByPostRaw(a),c=g.offsetHeight+15,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(g,d)[1],Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(g),Object(_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_28__.updateAriaElements)(),Wall.updateMentionsIndex(),AudioUtils.updateQueueReceivedPost(g);break;case"edit_post":var P=ge("wpt"+a);if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(u)||!P)break;var D=geByClass1("wall_post_more",P);D&&(D=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(D))),c=-P.offsetHeight,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(P,d)[1];var M=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(e[3],{poll_hash:o.wallTpl.poll_hash})),v=o.videoInlinePlayer&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isAncestor)(window._videoLastInlined[0],P),f=v&&"playing"==o.videoInlinePlayer.getState();if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(P,M),v){var C=geByClass1("page_post_sized_thumbs",P);1==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domChildren)(C).length&&(C.innerHTML="",C.appendChild(window._videoLastInlined[1]),C.appendChild(window._videoLastInlined[0]),f&&setTimeout((function(){o.videoInlinePlayer.play()}),0))}D&&(D=geByClass1("wall_post_more",P))&&D.onclick(),Wall.votingUpdateByPostRaw(a),c+=P.offsetHeight,Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(P),Wall.updatePostAuthorData(a);break;case"edit_reply":var T=e[3],A=ge("wpt"+T);if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)("post"+T)||!A)break;var L=geByClass1("wall_reply_more",A);L&&(L=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(L)));var B=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.psr)(e[4]);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(A,B),c=-A.offsetHeight,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(A,d)[1],L&&(L=geByClass1("wall_reply_more",A))&&L.onclick(),c+=A.offsetHeight,Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(A);break;case"post_parsed_link":if(!u)break;var I=geByClass1("wall_postlink_preview_btn_disabled",u);if(!I)break;var W=e[3];if("1"===W)removeClass(I,"wall_postlink_preview_btn_disabled"),removeClass(I,"button_disabled");else if("0"===W)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(I);else if(W){var R=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("a",{href:W,className:"flat_button",innerHTML:getLang("wall_preview_link")});Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(I,R)}break;case"del_post":u&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(u)&&!o.wallMyDeleted[a]&&!r&&(c-=u.offsetHeight+15,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(u,d)[1],Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_24__.revertLastInlineVideo)(u),addClass(u,"unshown"),s||n||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all"))-1),e[3]&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own"))-1),Wall.isArchiveWall()&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_archive",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_archive"))-1)));break;case"res_post":u&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(u)&&((o.wallRnd==e[4]||Wall.isArchiveWall())&&removeClass(u,"unshown"),s?o.pgOffset++:(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_all"))+1),e[3]&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_own"))+1),Wall.isArchiveWall()&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_archive",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)("page_wall_count_archive"))+1)));break;case"new_reply":if(!u||o.wallMyReplied[a]||ge("post"+e[3])||r&&o.pgOffset<o.pgCount||n&&(o.reverse?o.offset:o.offset+o.loaded<o.count))break;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(n?ge("wl_post"):ge("post"+a),"deep_active")){var y=wall.addNewReply(e);c+=y[0],p=y[1];break}var j,U=ge("replies"+a),K=ge("replies_wrap"+a),k=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e[e.length-1]),x=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&k?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&k?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,S=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Wall.getNewReplyHTML(e,x,!1,o)),N=n?U.offsetHeight:u.offsetHeight,F=!1;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(U)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(K)&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)("reply_link"+a)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("wall_fixed",K)){j=U.nextSibling;var H=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("new_reply",U,"div").length+1;if(n||r||o.wallMyOpened[a]){if(!r){j&&"replies_open"==j.className&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(j),F=!0;var V=geByClass1("wr_header",U,"a"),$=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",U,"div").length+1,q=$;V&&(q=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(V.getAttribute("offs").split("/")[1])+1),(q>5||$<q)&&(V||U.insertBefore(V=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("a",{className:"wr_header"}),U.firstChild),Wall.updateRepliesHeader(a,V,$,q))}}else addClass(S,"new_reply"),j&&"replies_open"==j.className||(j=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(a),role:"button",tabIndex:0}),U.parentNode.insertBefore(j,U.nextSibling)),j.innerHTML=getLang("wall_x_new_replies_more",Math.min(100,H)),j.newCnt=H}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)("reply_link"+a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(K,U),F=!0;_&&o.reverse&&U.firstChild?U.insertBefore(S,U.firstChild):U.appendChild(S),F&&Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(S),n?(o.count++,o.loaded++,WkView.wallUpdateReplies(),c=U.offsetHeight-N,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(S,d)[1]):(r&&(FullWall.repliesSummary(e[13]),o.pgOffset++,o.pgCount++,FullWall.repliesSummary(o.pgCount),Pagination.pageReady(!1),FullWall.onePostOnScroll(!1,!1,!0)),c=u.offsetHeight-N,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(F?S:j)[1],Wall.repliesSideSetup(a)),Wall.updateMentionsIndex(),Likes.update("wall"+a,{comment_num:e[13]});break;case"del_reply":if(o.wallMyDeleted[a]||!u)break;var G=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",u)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",u);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(G,"deep_active")){var z=wall.removeDeepReply(e);c+=z[0],p=z[1];break}if(c-=u.offsetHeight,p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(u,d)[1],Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_24__.revertLastInlineVideo)(u),o.layerpost)hide(u),o.count--,o.loaded--;else{r&&(o.pgOffset--,o.pgCount--,FullWall.repliesSummary(o.pgCount));var Y=u.parentNode.id.match(/replies(-?\d+_\d+)/);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(u),Y&&Wall.repliesSideSetup(Y[1])}break;case"view_post":Wall.likeUpdate(!1,a,0,Wall.formatCount(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e[3])),void 0,void 0,1);break;case"like_post":case"like_reply":if(!u)break;var X="like_reply"==i?"wall_reply"+a:a,Q=u&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(u,"_like_wrap"),Z=u&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(u,"_share_wrap");wall.likeFullUpdate(Q,X,{like_my:Q&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(Q,"my_like"),like_num:e[3],like_title:!1,share_my:Z&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(Z,"my_share"),share_num:e[4],share_title:!1});break;case"upd_ci":var J=e[2],__=ge("current_info"),e_=__||ge("page_current_info");if(!e_)break;switch(e[3]){case"audio":var t_=geByClass1("current_audio_cnt");t_&&t_.tt&&t_.tt.hide();var o_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e[5]||""),i_=o_?"":" hidden",a_="";__||(a_+=" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAudioTip+"', black: 1, shift: [14, 5, 5]})\" onclick=\"Page.playCurrent(this, '"+e[4]+"')\""),J=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o.options.ciAudioTpl,{text:J,attrs:a_,count:o_,cnt_class:i_}),wall.updateOwnerStatus(J,e_,e,__);break;case"app":var l_=e[6]?"[12, 5, 5]":"[15, 5, 5]",s_=e[6]?" current_app_icon":"",r_=__?' onclick="cur.ciApp = '+e[4]+'"':" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAppTip+"', black: 1, shift: "+l_+'})" href="'+e[5]+'?ref=14" onclick="return showApp(event, '+e[4]+', 1, 14, cur.oid)"';e[6]&&(r_+=" style=\"background-image: url('"+e[6]+"'); background-size: 16px 16px;\""),J='<a class="current_app'+s_+'"'+r_+">"+J+"</a>",wall.updateOwnerStatus(J,e_,e,__);break;default:stManager.add([jsc("web/emoji.js")],(function(){J=J?'<span class="current_text">'+Emoji.emojiToHTML(J,!0)+"</span>":J,wall.updateOwnerStatus(J,e_,e,__)}))}break;case"upd_ci_cnt":var n_=ge("current_info"),d_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(e[2]),c_=n_||ge("page_current_info"),p_=c_&&geByClass1("current_audio_cnt",c_);p_&&(p_.tt&&p_.tt.destroy(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(p_,"hidden",0==d_),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_23__.animateCount)(p_,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(d_,"%s",!0),{str:"auto"}));break;case"cover_updated":var u_=geByClass1("_page_cover");if(u_&&e[2]){var b_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.vkImage)(),E_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.isRetina)()?e[3]:e[2];b_.src=E_,b_.onload=function(){u_.style.backgroundImage="url('"+E_+"')",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(b_)}}}c&&(_?p<0:l+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)("page_header_cont")[1]>p)&&(l+=c)}})),l!=a&&a>100&&!o.onepost&&(_?wkLayerWrap.scrollTop=l:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(l,0,!1,!0)),Wall.update())}}},updateOwnerStatus:function(_,e,t,o){o&&(_='<span class="'+(_?"my_current_info":"no_current_info")+'">'+(_||getLang("change_current_info"))+"</span>",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e.parentNode.nextSibling,_),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)("currinfo_editor")&&cur.oid>0&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)("currinfo_audio","app"!=t[3]),t[2]&&"app"!=t[3]&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(ge("currinfo_audio"),Boolean(t[2])),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)("currinfo_app","app"==t[3]),addClass("currinfo_app","on")));Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,_)},updateMentionsIndex:function(_){if(clearTimeout(cur.wallUpdateMentionsIndexTO),_){var e={},t=[],o=new RegExp("^(https?://(vk.com|"+location.host.replace(/\./,"\\.")+"))?/?"),i=[];each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("author",bodyNode,"a"),(function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(this),i=this.href.replace(o,"");if(void 0===e[i]){var a=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(this.getAttribute("data-from-id"));a&&a!=vk.id&&(e[i]=t.length,t.push([a,_,"@"+i,"/images/camera_c.gif"]))}})),i=(i=i.concat(Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post_image",bodyNode,"a")))).concat(Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply_image",bodyNode,"a"))),each(i,(function(){var _=this.href.replace(o,""),i=e[_];if(void 0!==i){for(var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(this);a&&"IMG"!=a.tagName;)a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(a);a&&(t[i][3]=a.getAttribute("src"),delete e[_])}})),cur.wallMentions=t}else cur.wallUpdateMentionsIndexTO=setTimeout(wall.updateMentionsIndex.pbind(!0),300)},initUpdates:function(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_&&_.length&&window.Notifier){var t=e?window.wkcur:window.cur,o=()=>{t.wallQueues&&t.wallQueues.forEach(_=>{Notifier.addKey(_,(_,t)=>{Wall.updated(e,_,t)})})};if(!t.wallQueues){var i=setInterval(o,1e4);e?t._hide.push(()=>clearInterval(i)):t.destroy.push(()=>clearInterval(i))}t.wallQueues=_,o()}},initWallOptions:function(_){extend(cur,{wallCheckComments:_.check_comments,wallType:_.wall_type,wallTpl:_.wall_tpl,wallMyDeleted:{},tsDiff:_.wall_tpl&&_.wall_tpl.abs_timestamp?900*Math.round((Date.now()/1e3-_.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMentions:[],wallMyRepliesCnt:0,wallUploadOpts:_.upload,wallUploadVideoOpts:_.upload_video,hasGroupAudioAccess:_.hasGroupAudioAccess,wallAdsReplacedFeatureTooltip:_.ads_replaced_feature_tooltip,wallAdsReplacedFeatureTooltipHash:_.ads_replaced_feature_tooltip_hash}),_.wall_tpl&&_.wall_tpl.lang&&(cur.lang=extend(cur.lang||{},_.wall_tpl.lang)),window.Notifier&&Notifier.addRecvClbk("wall_reply_multiline","wall",(function(_){Wall.onReplySubmitChanged(_.value,1)}),!0)},onPostLoaded:function(_,e){_=ge(_),Wall.onAdBlockLoaded(_,e),e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_post")&&(_=geByClass1("_post",_)),_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_post")&&cur.onPostLoaded&&cur.onPostLoaded(_)},onAdBlockLoaded:function(_,e){var t;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_ads_block_data_w")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_ads_promoted_post_data_w")?t=_:e&&(t=geByClass1("_ads_block_data_w",_)||geByClass1("_ads_promoted_post_data_w",_)),t&&Wall.triggerAdStat(t,"load")},init:function(_){Wall.initWallOptions(_),extend(cur,{wallInited:!0,postField:ge("post_field"),wallSearch:ge("wall_search"),wallPage:ge("profile")||ge("group")||ge("public"),wallPageNarrow:ge("narrow_column"),wallUploadOpts:_.upload||!1,wallOnClearInput:[],deletedCnts:{own:0,all:0,archive:0},posterFeatureTooltip:_.poster_feature_tooltip,posterFeatureTooltipHash:_.poster_feature_tooltip_hash,postCopyrightFeatureTooltip:_.post_copyright_feature_tooltip,postCopyrightFeatureTooltipHash:_.post_copyright_feature_tooltip_hash}),cur.destroy.push((function(_){Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.serviceWallUsers),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.serviceWallGroups),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.serviceNews),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.cleanElems)(_.postField)}));var e=removeEvent.pbind(document,"click",Wall.hideEditPostReply);cur._back?(cur._back.hide.push(e),cur._back.show.push(e),cur._back.show.push(addEvent.pbind(document,"click",Wall.hideEditPostReply))):cur.destroy.push(e),cur.wallTab=cur.wallType,Wall.update(),Wall.initUpdates(_.add_queues),_.wall_tpl&&(cur.timeUpdateInt=setInterval((function(){Wall.updateTimes(_.wallCont)}),1e4),cur.destroy.push((function(){clearInterval(cur.timeUpdateInt)})));var t=window;addEvent(t,"scroll",Wall.scrollCheck),addEvent(window,"resize",Wall.scrollCheck),cur.destroy.push((function(){removeEvent(t,"scroll",Wall.scrollCheck),removeEvent(window,"resize",Wall.scrollCheck)})),cur.wallAutoMore=_.automore;var o=!1;if(cur.options.no_draft||(o=_.draft||cur.oid!=vk.id&&Wall.getOwnerDraft(cur.oid)),Wall.initPostEditable(o),cur.wallSearch&&placeholderInit(cur.wallSearch),removeEvent(document,"click",Wall.hideEditPostReply),addEvent(document,"click",Wall.hideEditPostReply),_.poster_options&&Wall.initPosterEditor(_.poster_options),_.media_types){var i=extend({onAddMediaChange:(_,e,t)=>{cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide(),Wall.hidePosterFeatureTooltip(),Wall.postChanged(10),["poll","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION].includes(_)||wall.focusOnEnd(),cur.oid!=vk.id&&Wall.saveOwnerDraftMedia(cur.oid,_,e,t),setTimeout(Wall.checkPosterAvailability)},onChangedSize:()=>{setTimeout(()=>{var _=ge("submit_post_box"),e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("VideoRestriction",_);each(e,(_,e)=>{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(e)[1],o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(e)[0];Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(e,"VideoRestriction--onlyIcon",o<200),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(e,"VideoRestriction--small",o>=200&&o<300&&o>t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(e,"VideoRestriction--medium",o>=300&&o<400)})})},onMediaChange:()=>{Wall.postChanged()},onMediaUploadStarted:()=>{Wall.postChanged()},editable:1,from:"post",sortable:1,poster:cur.poster},_.media_opts||{});if(cur.wallAddMedia=new MediaSelector(ge("page_add_media"),"media_preview",_.media_types,i),cur.wallAddMedia.menu){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast"),l=ge("official");a&&l&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("_submit_post_box",l),"from-oid")!=cur.postTo&&hide(a)}}if(Wall.initPostVisibilitySelector(cur.wallAddMedia),Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_36__.isPostTopicSettingEnabled)(window.cur)){var s=cur.wallAddMedia&&cur.wallAddMedia.id||"",r=Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_36__.initPostTopicCreatingSelector)(String(s),ge("post_actions_btns"));r&&(window.cur.destroy.push(r.onDestroy),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(r.clearSelection))}if(cur.withUpload=window.WallUpload&&!browser.safari_mobile&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(cur.wallType,["all","own","feed","full_all","ads_promoted_stealth"])&&Wall.withMentions&&cur.wallUploadOpts,cur.withUpload&&WallUpload.checkDragDrop()){var n=function(){removeEvent(document,"dragover dragenter drop dragleave",p)},d=!1,c=!1,p=function(_){if(!1!==d&&(clearTimeout(d),d=!1),cur.uploadInited)return n(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(_);switch(_.type){case"drop":c=!1,delete cur.wallUploadFromDrag,hide("post_upload_dropbox");break;case"dragleave":d=setTimeout((function(){c=!1,delete cur.wallUploadFromDrag,hide("post_upload_dropbox")}),100);break;case"dragover":case"dragenter":c||2==(c=!_.target||"IMG"!=_.target.tagName&&"A"!=_.target.tagName?2:1)&&setTimeout(WallUpload.initCallback,0),2==c&&(cur.wallUploadFromDrag=1)}return Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(_)};addEvent(document,"dragover dragenter drop dragleave",p),cur.destroy.push(n)}Wall.updateMentionsIndex(),_.top_wall_feature_tooltip?setTimeout((function(){Wall.showTopWallTooltip(_.top_wall_feature_tooltip_hash)}),800):_.order_feature_tooltip&&setTimeout((function(){Wall.showOrderTooltip(_.order_feature_tooltip_hash)}),800)},initPosterEditor:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)('<div class="page_block"></div>'),t=Wall.getMainPostBlock();"feed"===cur.module&&addClass(e,"feed_post_field_wrap");var o=function(){return!1},i=function(){Wall.closeFancyTooltipsInPost(),Wall.openPosterEditor(),cur.poster.sendStatsInfo("open")},a={onPreOpen:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(e,t)},onPostOpen:function(){var _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onPreHide:function(){Wall.saveCaretPositionForPoster(cur.poster.getTextInputEl()),Wall.closeFancyTooltipsInPost();var _=ge("submit_post_error"),e=ge("submit_post_box"),t=ge("post_actions_btns"),o=ge("submit_post");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(t,o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(_)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(e))},onPostHide:function(){var _=ge("post_settings_btn"),o=cur.options.suggesting&&ge("check_sign");_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(_,cur.openPosterBtn),o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(o,cur.openPosterBtn),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(t);var i=cur.poster.getTextAsHtml();i&&i.match(Emoji.emojiRegex)&&(i=i.replace(Emoji.emojiRegex,Emoji.emojiReplace)),cur.postField.innerHTML=i,Wall.restoreCaretPositionForPoster(cur.postField),setTimeout((function(){Composer.updateArticleConvertSuggest(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(cur.postField,"composer"))})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(e)},onPreUploaderOpen:function(){var _=cur.poster.getTextInputEl();Wall.saveCaretPositionForPoster(_)},onPostUploaderClose:function(){var _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onOverTextLimit:function(){Wall.disablePoster(!0),cur.poster.closeEditor(),cur.poster.sendStatsInfo("auto_disable"),cur.poster.state.toggled=!0},onChangeData:Wall.postChanged,onSend:function(_){Wall.sendPost(!0,_)},onDestroy:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(e)},getPostOwnerId:function(){return+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(ge("submit_post_box"),"from-oid")},width:Wall.getMainPostBlock().clientWidth,containerClasses:"poster_wall-creating",placeholder:attr(cur.postField,"placeholder"),appendToElem:e};cur.openPosterBtn=ge("page_poster_btn"),cur.poster=new Poster(_.poster_config,a),addEvent(cur.openPosterBtn,"click",i),addEvent(cur.openPosterBtn,"mousedown",o),cur.destroy.push((function(){removeEvent(cur.openPosterBtn,"click",i),removeEvent(cur.openPosterBtn,"mousedown",o)}))},openPosterEditor:function(_){if(cur.poster&&!cur.poster.state.disabled&&!cur.poster.state.opened){_=_||{},cur.posterFeatureTT&&cur.posterFeatureTT.hide();var e=Wall.getMainPostBlock(),t=_.bkgId,o=window.browser.windows7||window.browser.windowsVista||window.browser.windowsXp;Wall.saveCaretPositionForPoster(cur.postField);var i=_.text||cur.postField.innerHTML;if(i=(i=i.replace(/\n/g,"<br/>")).replace(/<img[^>]*>/g,(function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:_}).firstChild,t=Emoji.getCode(e);return t?o?" ":Emoji.codeToChr(t):_})),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(e))return cur.poster.setBkg(t,!0),void cur.poster.setText(i);hide(e);var a=ge("post_settings_btn"),l=ge("submit_post_error"),s=cur.options.suggesting&&ge("check_sign"),r=cur.poster.getPostOptionsWrapperEl();if(a&&r.appendChild(a),s&&r.appendChild(s),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(l)){var n=cur.poster.getErrorWrapperElement();n.innerHTML="",n.appendChild(l)}var d=cur.poster.getBtnsWrapper(),c=ge("post_actions_btns");c&&(d.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(c,d.firstChild):d.appendChild(c),c.children.length||d.children.length>1?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(d):hide(d)),cur.poster.openEditor(),cur.poster.setBkg(t,!0),cur.poster.setText(i)}},checkPosterAvailability:function(){if(cur.poster){var _=cur.wallAddMedia?cur.wallAddMedia.getMedias():[],e=cur.poster.isTextFieldValid(cur.postField),t=Wall.checkAttachesForPoster(_),o=e&&t;!o!==cur.poster.state.disabled&&Wall.disablePoster(!o),o&&cur.poster.state.toggled&&(Wall.openPosterEditor(),cur.poster.sendStatsInfo("auto_enable"),cur.poster.state.toggled=!1)}},checkAttachesForPoster(_){if(!Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(_))return!1;if(!_.length)return!0;var e=0;return _.some(_=>{if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(_)){var t=_slicedToArray(_,1)[0];["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_33__.MEDIA_TYPE_DONUT_DURATION].includes(t)||++e}}),0===e},disablePoster:function(_){cur.poster&&(void 0===_&&(_=!0),cur.poster.state.disabled=_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(cur.openPosterBtn,"_disable",_))},isPosterEditorOpen:function(){return cur.poster&&cur.poster.isOpen()},saveCaretPositionForPoster:function(_){if(document.activeElement===_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span"),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("span");e.classList.add("poster__marker","poster__marker_start"),t.classList.add("poster__marker","poster__marker_end");var o=getSelection().getRangeAt(0);(o=o.cloneRange()).insertNode(e),o.collapse(!1),o.insertNode(t)}},restoreCaretPositionForPoster:function(_){var e=geByClass1("poster__marker_start",_),t=geByClass1("poster__marker_end",_);if(e&&t){var o=document.createRange();o.setStartBefore(e),o.setEndBefore(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t);var i=window.getSelection();i.removeAllRanges(),i.addRange(o)}else wall.focusOnEnd(_)},getMainPostBlock:function(){var _=cur.mainPostBlock;return _||(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(ge("submit_post_box")),cur.mainPostBlock=_),_},changeAuthorInPoster:function(_){cur.poster&&_&&cur.poster.changeBkgAuthor({authorName:_.authorName,authorUrl:_.authorUrl})},sendInsertBeforeError:function(){ajax.post("al_page.php",{act:"insert_before_error",trace:(new Error).stack,owner_id:cur.oid,module:cur.module})},closeFancyTooltipsInPost:function(){var _=cur.wallAddMedia.lnkId;cur["postPostponeTT"+_]&&cur["postPostponeTT"+_].hide(),cur["post_action_btn"+_]&&cur["post_action_btn"+_].hide(),Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_36__.topicUISelectorHide)(_)},switchOwner:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(geByClass1("_ui_toggler",_),"on"),uiSearch.showProgress("wall_search"),cur.options.params.owners_only=cur.options.params.owners_only?null:1,nav.change({owners_only:cur.options.params.owners_only,offset:null})},fakeReplyAsGroupOver:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("reply_fakebox_with_official",_)&&wall.replyAsGroupOver(_)},fakeReplyAsGroupCheck:function(_,e,t){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("reply_fakebox_with_official",_))return window.tooltips&&window.tooltips.hide(_),Wall.showEditReply(e,null,!1,!1,!0,(function(){var _=ge("reply_as_group"+e);_&&(_.focus(),_.click())})),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(t)},setReplyAsGroup:function(_,e){if(!_)return!1;if(_.hasAttribute("data-reinit-ads-needs-confirmation")&&window.AdsEdit&&!e.reinitConfirmed&&AdsEdit.reinitCreatingPostFormNeeded())return AdsEdit.reinitCreatingPostFormConfirm(wall.setReplyAsGroup.pbind(_,extend({},e||{},{reinitConfirmed:!0}))),!1;var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("_submit_post_box",_),o=t&&ge("signed"),i=t&&ge("close_comments"),a=t&&ge("mute_notifications"),l=t&&ge("official"),s=t&&ge("mark_as_ads"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"tt"),n=e.from||(e.fromGroup?cur.oid:vk.id),d=n==vk.id?wall.replyAsProfileData():window.replyAsData&&window.replyAsData[n]||wall.replyAsGroupDomData(_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"from-oid")==n||!d||d[0]!=n)return!1;var c=ge("submit_post_box"),p=!t&&cur.poster&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("poster",_),u=t===c;p&&(t=c,o=ge("signed"),s=ge("mark_as_ads"),i=ge("close_comments"),a=ge("mute_notifications"),l=ge("official")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"from-oid",n),wall.replyAsAnimate(t,d[2],d[1]),cur.poster&&(u||p)&&Wall.changeAuthorInPoster({authorName:d[3],authorUrl:d[2]}),r&&r.rows&&each(r.rows,(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(this,"active",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(this,"from-oid")==n)})),o&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(o,n>0),s&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(s,n>0),i&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(i,n>0),a&&(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.isChecked)(s)?(addClass(a,"on"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(a,1)):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disable)(a,n>0)),l&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(l,n!==vk.id),_.setAttribute("aria-label",getLang(n<0?"wall_reply_as_group":"wall_reply_as_user")),_.hasAttribute("data-replace-owner-name")&&(_.innerHTML=d[3],"A"===_.tagName&&(_.href=d[2])),_.hasAttribute("data-replace-post-to")&&(cur.postTo=d[0]),_.hasAttribute("data-replace-oid")&&(cur.oid=d[0]),_.hasAttribute("data-reinit-ads-post-editor")&&window.AdsEdit&&(e.withoutRedraw?AdsEdit.reinitCreatingPostFormBoundWithoutRedraw():AdsEdit.reinitCreatingPostFormBound()),"official"==_.id&&Wall.postChanged(!0);var b=cur.wallAddMedia&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast");if(b){var E=cur.postTo==n;each(cur.wallAddMedia.getMedias()||[],(function(_,e){if("podcast"===e[0])return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(e[2],"attach_disabled",!E),E=!1,!1})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)(b,E)}return _.id&&Wall.hideCheckTimer(_.id.replace("reply_as_group",""),"editing"),cur.wallAddMedia&&cur.wallAddMedia.donutUpdateVisibility(t),!1},replyAsAnimate:function(_,e,t){var o=_&&geByClass1("_post_field_author",_),i=o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_post_field_image",o),a=_&&geByClass1("_post_field_official",_),l=a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_post_field_image",a),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"author_secondary")?0:1;o&&i&&i[s]&&(o.href=e,i[s].src=t),l&&l[s]&&(l[s].src=t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(_,"author_secondary")},replyAsGroupOver:function(_){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"checkbox_official")&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"reply_fakebox_wrap_image")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"disabled"))return!1;var e,t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_submit_post_box",_),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("deep_active",_);if(e=o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",_)?[7,8,8]:o?[2,8,8]:[9,8,8],Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(_,{text:function(){return(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"from-oid")||vk.id)<0?getLang("global_on_behalf_group"):getLang("global_on_behalf_me")},black:1,shift:e}),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"reply_fakebox_wrap_image")&&(wall.isWallReply(_)||wall.isAdsCreatingPost(_))){var i="/al_groups.php",a="get_editor_clubs";wall.isAdsCreatingPost(_)&&(i="/ads_edit.php",a="a_get_promoted_post_stealth_groups"),ajax.post(i,{act:a},{cache:1})}},replyAsGroupFocus:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"tt");e&&e.isShown()||wall.replyAsGroupOver(_)},replyAsGroup:function(_,e,t){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"checkbox_official")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"disabled"))return t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(t);if(!(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"can_reply_as_any_group")>0)&&wall.isWallReply(_))return wall.replyAsGroupTT(_,e,[]),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(t);if(!wall.isWallReply(_)&&!wall.isAdsCreatingPost(_)||cur.replyAsLoaded)wall.showReplyAsGroupTooltip(_,e);else{var o="/al_groups.php",i="get_editor_clubs";wall.isAdsCreatingPost(_)&&(o="/ads_edit.php",i="a_get_promoted_post_stealth_groups"),ajax.post(o,{act:i},{cache:1,onDone:function(t){cur.replyAsLoaded=t,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(_)&&wall.showReplyAsGroupTooltip(_,e)}})}return t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(t)},showReplyAsGroupTooltip(_,e){var t=!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("can_reply_only_verified",_),o=(cur.replyAsLoaded||[]).filter(_=>!t||_[0]>0||_[4]);wall.replyAsGroupTT(_,e,o)},replyAsGroupDomData:function(_){var e,t,o,i,a;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",_)){var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",_),"post-id");l&&(e=ge("reply_box"+l)||ge("reply_fakebox"+l),t=l.split("_")[0])}else e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_submit_post_box",_),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"oid");return e&&(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"owner-photo"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"owner-href"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"owner-name")),t&&o&&i&&a&&[t,o,i,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.unclean)(a))]||cur.wallTpl&&cur.wallTpl.ownerData||!1},isWallReply:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_submit_post_box",_);return e&&e.id.match(/reply_box(-?\d+)_(\d+)/)},isAdsCreatingPost:function(_){return!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ads_edit_ad_submit_post_header",_)},replyAsProfileData:function(){return window.cur&&cur.wallTpl&&cur.wallTpl.profileData||window.wkcur&&wkcur.wallTpl&&wkcur.wallTpl.profileData||window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},replyAsGroupList:function(_,e){var t=_.hasAttribute("data-disallow-profile")?[]:[wall.replyAsProfileData()],o=wall.replyAsGroupDomData(_);return o&&t.push(o),(wall.isWallReply(_)||wall.isAdsCreatingPost(_))&&each(window.replyAsList,(function(){this[0]!=e&&t.push(this)})),t},replyAsGroupTT:function(_,e,t){window.replyAsList=t||[],window.replyAsData={},each(window.replyAsList,(function(){window.replyAsData[this[0]]=this}));var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"tt"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_submit_post_box",_),a=i&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"from-oid");if(!wall.replyAsProfileData())return!1;if(!o){var l=wall.replyAsGroupList(_,e),s="";_.hasAttribute("data-enable-search")&&(s+='<div class="post_from_tt_row_search_wrap"><input class="clear_fix post_from_tt_row post_from_tt_row_search" value="" placeholder="'+getLang("global_search")+'" /><div class="post_from_tt_row_search_progress"></div></div>');var r=function(_,e,t,o,i){return'<a id="_post_from_tt_row_oid_'+e+'" class="clear_fix post_from_tt_row _post_from_tt_row_searchable'+_+'" data-from-oid="'+e+'" href="'+t+'"><img class="post_from_tt_image" src="'+o+'" aria-label="'+i+'">'+i+"</a>"};each(l,(function(){var _=a==this[0]?" active":"";s+=r(_,this[0],this[2],this[1],this[3])}));var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("deep_active",_);o=new ElementTooltip(_,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+s+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"bottom",offset:function(){return wall.isAdsCreatingPost(_)?[_.offsetWidth/2+8.5,-2]:n?[1,-5]:[-10,-5]},onFirstTimeShow:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post_from_tt_row",e);each(t,(function(e,t){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"post_from_tt_row_search")||addEvent(t,"click",wall.setReplyAsGroup.pbind(_,{from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(this,"from-oid")}))}));var i=geByClass1("post_from_tt_row_search",e);if(i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_post_from_tt_row_searchable",e),l=_.getAttribute("data-search-url"),s={};addEvent(i,"keyup valueChanged",(function(){var t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.trim)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(i)).toLowerCase();if(l&&t){_.searchRequestTimeout&&(clearTimeout(_.searchRequestTimeout),delete _.searchRequestTimeout);var n=geByClass1("post_from_tt_row_search_progress",e);geByClass1("pr",n)||Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.showProgress)(n),_.searchRequestTimeout=setTimeout((function(){s[t]?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.hideProgress)(n):ajax.plainpost(l,{str:t},(function(i){s[t]=!0,i=JSON.parse(i),each(i,(function(){if(!ge("_post_from_tt_row_oid_"+this[0])){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(r("",this[0],this[2],this[1],this[3]));geByClass1("ui_scroll_content",e).appendChild(t),addEvent(t,"click",wall.setReplyAsGroup.pbind(_,{from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"from-oid")})),window.replyAsData[this[0]]||(window.replyAsData[this[0]]=this)}})),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_post_from_tt_row_searchable",e),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.hideProgress)(n)}),(function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.hideProgress)(n)}))}),500)}each(a,(function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggle)(e,""===t||-1!==e.innerText.toLowerCase().indexOf(t))}))}))}this.rows=t,this.scroll=new uiScroll(geByClass1("_post_scroll_wrap",e)),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0)},onShow:function(_){setTimeout((function(){if(o.scroll){var e=geByClass1("active",_),t=e?e.offsetTop-(o.scroll.data.viewportHeight-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(e)[1])/2:0;o.scroll.scrollTop(t);var i=geByClass1("post_from_tt_row_search",_);i&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.elfocus)(i)}}),0)},onHide:function(_){var e=geByClass1("post_from_tt_row_search",_);e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,"")}}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"tt",o)}e&&o.isShown()&&!_.hasAttribute("data-disallow-profile")&&wall.setReplyAsGroup(_,{from:a==vk.id?e:vk.id}),_.tt&&_.tt.hide&&_.tt.hide(),o.isShown()||o.show()},reportPost:function(_,e,t){stManager.add([jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(_,e,"report_"+t)}))},parsePostId:function(_){var e=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/);return{type:e[3]||"wall",id:e[1]+"_"+e[4]}},likeIt:function(_,e,t,o){if(Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.stopEvent)(o),!vk.id)return!1;if(cur.viewAsBox)return cur.viewAsBox(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(o);var i,a=wall.parsePostId(e),l=a.type,s=a.id,r=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",_))||wall.domPost(s),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(r,"_like_wrap"),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(n,"_count"),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(n,"my_like");i=e==cur.wallLayer?"wkview":cur.wallType?"feed"==cur.wallType?"news"==cur.section?"feed_"+(cur.subsection?cur.subsection:cur.section):"recommended"==cur.section?"feed_recommended"+("recent"!=cur.subsection?"_"+cur.subsection:""):"friends"==cur.section||"groups"==cur.section||"videos"==cur.section||"photos"==cur.section?"feed_"+cur.section+(cur.subsection?"_"+cur.subsection:""):"feed_"+cur.section:"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module,ajax.post("like.php",{act:c?"a_do_unlike":"a_do_like",object:l+s,hash:t,wall:2,from:i},{onDone:Wall.likeFullUpdate.pbind(_,e),onFail:function(){return!0}});var p=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.stripHTML)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(d)).replace(/(\s|,)/g,"");return Wall.likeUpdate(_,e,!c,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(p)+(c?-1:1)),"wall"==l&&window.cur.onLike&&window.cur.onLike(_,l,e,c),cur.onWallLike&&cur.onWallLike(),"wall"==l&&Wall.triggerAdStat(s,"like_post"),!1},likesShow:function(_,e,t){if(!_.postDontShowLikes){t=t||{};var o=wall.parsePostId(e),i=o.type,a=o.id,l=i+a,s=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",_))||wall.domPost(a),r=t.views?"_views_wrap":t.share?"_share_wrap":"_like_wrap",n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(s,r),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"_feedback_info_item")?_:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(n,"_icon"),c=s&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(s,"_share_wrap");if(d&&!cur.viewAsBox){var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(n)[0],u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(d)[0],b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(d,!0)[0],E=u+b/2-p-41,O=t.views?{views:1}:t.share?{published:1}:{};if(t.listId&&(O.list=t.listId),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(d,"_feedback_info_item")){var m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByTag1)("em",d);E=-40,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(d,"feedback_share")&&(E+=7),E+=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(m)[0]/2}var w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(d,"_feedback_info_item")?d:d.parentNode;Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(w,{url:"/like.php",params:extend({act:"a_get_stats",object:l,has_share:c?1:""},O),slide:15,shift:[-E,t.views?2:"wall_reply"==i?-3:7],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,noZIndex:!0,tip:{over:function(){Wall.likesShow(_,e,t)}},onShowStart:function(){var e=w.tt.container;setTimeout((function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.setStyle)(e,{left:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.floatval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getStyle)(e,"left"))+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(d)[0]-u})}),10),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_21__.statlogsValueEvent)("likes_show",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"shown"))},typeClass:"like_tt",className:t.cl||""})}}},likesShowList:function(_,e,t){t=t||{};var o=wall.parsePostId(e),i=o.type,a=o.id,l=i+a,s=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",_))||wall.domPost(a),r=t.share?"_share_wrap":"_like_wrap",n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(s,r);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domByClass)(n,"_icon")&&!cur.viewAsBox&&Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_13__.showWiki)({w:(t.views?"views":t.share?"shares":"likes")+"/"+Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(l)},!1,!1,{queue:1})},sharesShow:function(_,e,t){Wall.likesShow(_,e,extend(t,{share:1}))},viewsShow:function(_,e,t){Wall.likesShow(_,e,extend(t,{views:1}))},sharesShowList:function(_,e,t){Wall.likesShowList(_,e,extend(t,{share:1}))},viewsShowList:function(_,e,t){Wall.likesShowList(_,e,extend(t,{views:1}))},viewsUpdate:function(_,e){var t=wall.parsePostId(e),o={act:"a_get_stats",object:t.type+t.id,views:1};ajax.post("/like.php",o,{cache:1,onDone:function(t,i){Wall.likeUpdate(!1,e,!1,t,void 0,void 0,1);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:i});_.setAttribute("title",a.innerText||a.textContent),setTimeout(ajax.invalidate.pbind("/like.php",o),3e3)}})},sharesOpen:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(_);if(!vk.id)return!1;Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.stopEvent)(_);var o=wall.parsePostId(e),i=o.type,a=o.id,l=i+a;return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showBox)("/like.php",extend({act:"publish_box",object:l},t)),"wall"==i&&Wall.triggerAdStat(a,"share_post"),!1},customCur:function(){return window.wkcur&&wkcur.shown?wkcur:window.mvcur&&mvcur.mvShown?mvcur:window.pvcur&&cur.pvShown?pvcur:cur},processPostReplyActions:function(_){},updatePostAuthorData:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("_post_author_data_"+_).forEach((function(_){_.post_author_data_update=!0}))},closeComments:function(_,e,t,o,i){var a=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"closed"))?0:1;ajax.post("al_wall.php",{act:"close_comments",owner_id:e,post_id:t,close:a,hash:o},{onDone:function(){if(i)i(a);else{var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",_);Wall.onCloseComments(a,e)}}})},onCloseComments:function(_,e,t){if(e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"postponed")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"post")&&!vk.widget){var o=geByClass1("comment",e),i=geByClass1("reply_box_inner_wrap",e),a=cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module,l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"Post--with_closed_comments_donut");if(t||l||o&&i){a||l||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(e,"closed_comments",_);var s=geByClass1("action_closing_comments",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(s,"closed",_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(s,getLang(_?"wall_open_comments":"wall_closing_comments"))}else{var r=e.id.replace("post","").split("_");ajax.post("al_wall.php",{act:"comment_box",owner_id:r[0],post_id:r[1]},{onDone:function(t,o){if(!a){var i=geByClass1("comment",e),l=geByClass1("reply_box_inner_wrap",e);if(!i&&t){var s=geByClass1("like",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domNS)(s))}if(!l&&o){var r=geByClass1("replies_list",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(o),r)}}Wall.onCloseComments(_,e,!0)}})}}},showPostEditedTime:function(_){var e=(cur.lang||{}).wall_changed;if(e){var t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"time")),o=60*((new Date).getTimezoneOffset()+180);t&&Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(_,{text:e.replace("{time}",Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getDateText)(t,o)),black:1,shift:[0,4]})}},showPostAuthorData:function(_,e){var t=_.className.match(/_post_author_data_(-?\d+_\d+)/)[1]||"",o=e?e.target:window.event.srcElement;!t||o!=_&&o.onmouseover||(_.post_author_data_update&&(delete _.post_author_data_update,_.post_author_data_tt&&(_.post_author_data_tt.destroy(),_.post_author_data_tt=!1)),_.post_author_data_tt||ajax.post("al_page.php",{act:"post_author_data_tt",raw:t},{onDone:function(e){var o=geByClass1("post_link",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(_);if(e&&o){var i={content:e,arrowSize:"mini",cls:"post_author_data",defaultSide:"bottom",align:"left",id:"author_tt_"+t},a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("_im_mess_stack",_);a?i.appendTo=a:i.appendToParent=!0,vk.widget&&(i.offset=[0,-2],i.forceSide="bottom"),_.post_author_data_tt=new ElementTooltip(o,i),_.post_author_data_tt.show()}else _.post_author_data_tt=!0}}))},hideAdsReplacedTT:function(){cur.adsReplacedFeatureTT.destroy(),cur.wallAdsReplacedFeatureTooltip=null,cur.adsReplacedFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.wallAdsReplacedFeatureTooltipHash,type:"ads_in_post_replaced"})},showAdsReplacedTooltip:function(){if(!cur.adsReplacedFeatureTT){var _=setTimeout((function(){var _=geByClass1("addpost_opt");_&&(cur.adsReplacedFeatureTT=new ElementTooltip(_,{content:'<div class="ads_replaced_feature_tt__close" onclick="cur.adsReplacedFeatureTT.hide();"></div>'+getLang("global_ads_in_post_replaced"),forceSide:"top",cls:"feature_intro_tt ads_replaced_feature_tt",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_),offset:[1,-10],onHide:Wall.hideAdsReplacedTT}),cur.adsReplacedFeatureTT.show())}),800);cur.destroy.push((function(){clearTimeout(_)})),cur.destroy.push((function(){cur.adsReplacedFeatureTT&&cur.adsReplacedFeatureTT.destroy()}))}},createPostTooltip:_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_38__.createPostTooltip,showTopWallTooltip:function(_){if(!cur.topWallFeatureTT){var e=ge("page_wall_top");e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(e)||(e=ge("page_wall_top_more")),e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.isVisible)(e)&&(cur.topWallFeatureTT=new ElementTooltip(geByClass1("ui_tab",e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ui_tab",e),{content:'<div class="feature_tooltip__close" onclick="cur.topWallFeatureTT.hide();"></div>'+getLang("wall_top_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domClosest)("page_block",e),onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"top_wall_web"})}}),cur.topWallFeatureTT.show())}},hidePostCopyrightFeatureTooltip:function(){cur.postCopyrightFeatureTooltip&&cur.postCopyrightFeatureTooltipHash&&(cur.postCopyrightFeatureTooltip=!1,cur.postCopyrightFeatureTT.hide(),setTimeout(()=>{cur.postCopyrightFeatureTT.destroy()},ElementTooltip.FADE_SPEED),ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"}))},showPostCopyrightFeatureTooltip:function(){if(cur.postCopyrightFeatureTooltip&&!cur.postCopyrightFeatureTT){var _=setTimeout(()=>{var _=ge("post_settings_btn");_&&cur.postCopyrightFeatureTooltip&&(cur.postCopyrightFeatureTT=new ElementTooltip(_,{content:'<div class="feature_tooltip__close" onclick="Wall.hidePostCopyrightFeatureTooltip();"></div>'+getLang("wall_post_copyright_feature_text"),cls:"feature_intro_tt feature_info_tooltip",forceSide:"bottom",autoShow:!1,noOverflow:!1,noHideOnClick:!0,appendToParent:!0,offset:[-6.5,-8],onShow:()=>{ajax.post("al_index.php",{act:"show_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"})},onWindowClick:()=>{cur.postCopyrightFeatureTT&&(cur.postCopyrightFeatureTT.hide(),cur.postField.blur())}}),cur.postCopyrightFeatureTT.show())},800);cur.destroy.push(()=>clearTimeout(_))}},hidePosterFeatureTooltip:function(){cur.posterFeatureTooltip=!1,cur.posterFeatureTT&&cur.posterFeatureTooltipHash&&(cur.posterFeatureTT.destroy(),cur.posterFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.posterFeatureTooltipHash,type:"poster_new_year"}))},showPosterFeatureTooltip:function(){if(cur.posterFeatureTooltip){var _=setTimeout((function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domQuery1)(".poster__open-btn",ge("page_poster_btn"));if(_&&cur.posterFeatureTooltip){var e='<div class="poster_feature_tt__layout" onclick="cur.posterFeatureTT.hide(); cancelEvent(event);"><div class="poster_feature_tt__close"></div><div class="poster_feature_tt__info">'+getLang("wall_new_posters_new_year")+"</div>";cur.posterFeatureTT=new ElementTooltip(_,{content:e,forceSide:"bottom",cls:"eltt_fancy poster_feature_tt",autoShow:!1,noOverflow:!1,align:"left",centerShift:-28,noHideOnClick:!0,appendToParent:!0,offset:[0,-8],onHide:Wall.hidePosterFeatureTooltip,onWindowClick:function(){cur.posterFeatureTT.hide(),cur.postField.blur()}}),cur.posterFeatureTT.show(),cur.poster&&cur.poster.sendStatsInfo("new_bkg_tooltip_show")}}),800);cur.destroy.push((function(){clearTimeout(_)}))}},friendsRecommInit:function(_,e){if(_){e=e||{};var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"from")||"user_rec",o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"code"),i={scrollY:!1,onViewItem:function(_,o){e.checkViewItem&&!e.checkViewItem(_)||Wall.onViewFriendRecomm(_,o,t)},onDestroy:function(){e.onDestroy&&e.onDestroy()}};Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"next")&&(i.onLoadMore=function(){ajax.post("al_friends.php",{act:"a_recomm_friends_gallery",next:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"next"),track_code:o,friend_id:e.friendId||0},{onDone:function(e,t){var o=[];e&&(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domChildren)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.ce)("div",{innerHTML:e}))),Object(_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_32__.uiGetGallery)(_).addMore(o,!t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"next",t||null)}})}),new _web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_32__.UIGallery(_,i)}},onViewFriendRecomm:function(_,e,t){if(!_.viewed&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"ui_gallery_item")){var o=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"uid"),i="feed"===cur.module&&feed?feed.getModuleRef():cur.module,a=Wall._friendsRecommGetTrackCode(_);Wall.friendsRecommLogSave(["show_user_rec",o,Date.now(),e,i,t,a]),_.viewed=!0}},toggleRecommFriend:function(_,e,t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("friend_recomm_card",_),i=o&&+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(o,"uid");if(i){var a={act:"add",mid:i,hash:t,from:"user_rec",ref:"feed"===cur.module&&feed?feed.getModuleRef():cur.module,track_code:Wall._friendsRecommGetTrackCode(o),ts:Date.now()},l=Wall.friendsRecommLogGet(!0,i);return l.length&&(Wall.friendsRecommLogClear(i),a.logs=l),ajax.post("al_friends.php",a,{onDone:function(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_,e),addClass(_,"secondary"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.disableButton)(_,!0),addClass(o,"friend_recomm_card_accepted"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(geByClass1("wall_card_text_special",o))},onFail:function(_){if(l&&Wall.friendsRecommLogOnFail(l),_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(_)}),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e),!1}},hideRecommFriend:function(_,e,t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("friend_recomm_card",_),i=o&&+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(o,"uid");if(i){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ui_gallery",_),l="feed"===cur.module&&feed?feed.getModuleRef():cur.module,s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(o,"code")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(a,"code")||"";return ajax.post("al_friends.php",{act:"hide_possible",mid:i,ref:l,track_code:s,hash:t},{onDone:function(){var e=Object(_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_32__.uiGetGallery)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ui_gallery",_));if(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ui_gallery_item",_);e.removeItem(t)}},onFail:function(_){if(_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_16__.showFastBox)(getLang("global_error"),_),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton.pbind(_)}),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(e),!1}},onClickRecommFriend:function(_){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"ui_gallery_item")||(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ui_gallery_item",_)),_){var e=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"uid"),t="feed"===cur.module&&feed?feed.getModuleRef():cur.module,o=Wall._friendsRecommGetTrackCode(_);Wall.friendsRecommLogAddVisited(e,t,o),Wall.friendsRecommLogSave(["open_user",e,Date.now(),t,o])}},_friendsRecommGetTrackCode:function(_){var e,t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"code");return t||(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("ui_gallery",_),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"code")),t||""},friendsRecommLogSave:function(_,e){var t=Wall.friendsRecommLogGet();t.push(_),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set("friends_recomm",t),Wall.friendsRecommLogSend(e)},friendsRecommLogGet:function(_,e,t){var o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get("friends_recomm")||[];return e&&(o=o.filter((function(_){return(t?_[1]!==e:_[1]===e)&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.inArray)(_[0],["show_user_rec","open_user"])}))),_&&(o=o.map((function(_){return _.join("|")}))),o},friendsRecommLogClear:function(_){if(_){var e=Wall.friendsRecommLogGet(!1,_,!0);e.length?_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set("friends_recomm",e):_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.remove("friends_recomm")}else _shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.remove("friends_recomm");Wall.friendsRecommLogCleanVisited(_)},friendsRecommLogAddVisited:function(_,e,t){var o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get("friends_recomm_visited")||{};o[_]={ref:e,trackCode:t},_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set("friends_recomm_visited",o)},friendsRecommLogCheckVisited:function(_){return(_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get("friends_recomm_visited")||{})[_]},friendsRecommLogCleanVisited:function(_){if(_){var e=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.get("friends_recomm_visited")||{};delete e[_],_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set("friends_recomm_visited",e)}else _shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.remove("friends_recomm_visited")},friendsRecommLogSend:function(_){!cur.friendsRecommLogIdle&&window.curNotifier&&curNotifier.idle_manager&&(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(cur.onIdle)||(cur.onIdle=[]),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_37__.isArray)(cur.onUnidle)||(cur.onUnidle=[]),cur.friendsRecommLogIdle=function(){clearTimeout(cur.friendsRecommLog)},cur.onIdle.push(cur.friendsRecommLogIdle),cur.onUnidle.push(Wall.friendsRecommLogSend)),clearTimeout(cur.friendsRecommLog),_?Wall._friendsRecommLogSend():cur.friendsRecommLog=setTimeout(Wall._friendsRecommLogSend,1e4)},_friendsRecommLogSend:function(){if(!cur.friendsRecommProcess){var _=Wall.friendsRecommLogGet(!0);_.length&&(cur.friendsRecommProcess=!0,Wall.friendsRecommLogClear(),ajax.post("al_friends.php",{act:"a_recomm_logs",logs:_},{onDone:function(){delete cur.friendsRecommProcess},onFail:function(){return Wall.friendsRecommLogOnFail(_),delete cur.friendsRecommProcess,!0}}))}},friendsRecommLogOnFail:function(_){var e=Wall.friendsRecommLogGet();e=_.map((function(_){return _.split("|")})).concat(e),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_18__.default.set("friends_recomm",e)},replyEditPhoto:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!1,(function(){var t=ge("reply_more_attaches"+e);if(t){var o=geByClass1("ms_item_photo",t);tooltips.hide(_),o&&o.click()}})),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(t)},replyMoreAttachShow:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!0,(function(){var _=geByClass1("ms_items_more_wrap",ge("reply_more_attaches"+e));_&&(_.focus(),_.click())})),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(t)},replyFakeEmojiOver:function(_){wall.initEditReply(_,!1,!0,(function(){var e=ge("reply_smile"+_);if(e){var t=geByClass1("emoji_smile",e);t&&t.onmouseover()}}))},hideDeepReplies:function(_){var e=ge("post"+_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"reply")&&(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",e),_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"post-id"));var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"replies-offset")||0,o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"replies-limit")||3,i=ge("replies"+_),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(cur.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:t,count:o,text:"",class:" replies_next_main"}));i.innerHTML="",i.appendChild(a),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_22__.scrollToY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(i)[1]-100,0,null,!0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(a,"collapse",!0),a.click(),cur.wallMyOpened[_]=0},addNewReply:function(_){var e,t=_[2],o=(_[10]||"").match(/wall.showReply\([^-)0-9]*(-?[_0-9]+)[^-)0-9]*(-?[_0-9]+)[^-)0-9]*\)/),i=o&&o[2]||"",a=i&&i!==t,l=cur.wallLayer&&cur.wallLayer===t,s=l?ge("replies"+t):ge("post"+t),r=s.offsetHeight,n=0,d=0;e=a?wall._addDeepReply(_,i):wall._addRootReply(_);var c=l?ge("wl_post"):ge("post"+t);return wall.incReplyCounter(c,1,_[13]),l?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(geByClass1("wl_replies_wrap",c)),cur.count++,cur.loaded++):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)("replies_wrap"+t),Wall.repliesSideSetup(t)),Wall.updateMentionsIndex(),e&&(n=s.offsetHeight-r,d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(e,l)[1]),[n,d]},_addDeepReply:function(_,e){var t,o=_[2],i=_[10]||"",a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(i),l=a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(a,"root-id")||e,s=ge("post"+l),r=s&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",s),n=cur.wallLayer&&cur.wallLayer===o?wkcur:cur;if(r&&(l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"post-id"),s=ge("post"+l)),!s)return null;var d=ge("replies"+l);if(!d){wall.addDeepRepliesBlock(l);var c=ge("reply_fakebox"+l)||ge("reply_box"+l);c&&hide(c),t=d=ge("replies"+l)}if(!d)return null;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("reply",d).length){var p=wall._addNewReplyShowMore(o,l,d,"replies_next_deep");t=t||p}else{var u=ge("replies_short_deep"+l),b=wall.isDescRepliesOrder(o);if(u){var E=geByClass1("replies_short_text_count",u),O=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(E).replace(/[^0-9]/g,""))||0;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(E,getLang("global_replied_to_reply_count",O+1))}else{u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(n.wallTpl.reply_deep_short,{post_id:o,reply_id:l,reply_msg_id:l.split("_")[1],img_src:_[6]||"",name:_[5]||"",count:getLang("global_replied_to_reply_count",1)}));var m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(d);if(m)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(u,m),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(m,"replies_next_deep")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.toggleClass)(m,"replies_prev",b);else{d.appendChild(u);var w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(n.wallTpl.reply_deep_next,{post_id:o,reply_id:l,offset:0,count:1,text:getLang("wall_next_n_replies",1),class:" replies_next_deep"+(b?" replies_prev":"")}));d.appendChild(w)}}addClass(r,"replies_deep_has_short"),t=u}return wall.updateCollapseDeepReplies(l),removeClass(r,"replies_deep_empty_list"),t},_addRootReply:function(_){var e=_[2],t=cur.wallLayer&&cur.wallLayer===e,o=t?wkcur:cur,i=ge("replies"+e),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domChildren)(i).length,l="full"===o.wallType,s=!a||a<3&&(t||l),r=wall.isDescRepliesOrder(e);if(s){var n=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.intval)(_[_.length-1]),d=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&n?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Wall.getNewReplyHTML(_,d,!1,o));return Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_27__.nodeUpdated)(c),r&&i.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(c,i.firstChild):i.appendChild(c),c}return wall._addNewReplyShowMore(e,e,i,"replies_next_main",r)},_addNewReplyShowMore:function(_,e,t,o,i){var a,l,s=cur.wallLayer&&cur.wallLayer===_?wkcur:cur,r=s.options.replies_page_count||20,n=i?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domFC)(t):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domLC)(t);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(n,"replies_next"))return(a=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(n,"count")||0)<r?(a++,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(n,"count",a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(n,i?getLang("wall_prev_n_replies",a):getLang("wall_next_n_replies",a))):i&&(l=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(n,"offset")||0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(n,"offset",l+1)),n;if(i)l=0;else{var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)(o,t),c=d[d.length-1],p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domChildren)(t);if(c){var u=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(c,"count")||r,b=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(c,"offset")||0,E=p.indexOf(c);E=(E>=0?E:0)+1,l=b+u+p.slice(E).filter((function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"reply")})).length}else l=p.filter((function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(_,"reply")})).length}var O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(s.wallTpl.reply_deep_next,{post_id:_,reply_id:e,offset:l,count:1,text:i?getLang("wall_prev_n_replies",1):getLang("wall_next_n_replies",1),class:" "+(i?" replies_prev":"")+(o?" "+o:"")}));return i?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertBefore)(O,t.firstChild):t.appendChild(O),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.show)(O),O},removeDeepReply:function(_){var e=_[2],t=ge("post"+e),o=0,i=0;if(cur.wallMyDeleted[e]||!t)return[o,i];i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getXY)(t,cur.layerpost)[1],Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_24__.revertLastInlineVideo)(t);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",t),l=a?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(a,"post-id"):"",s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("replies_wrap_deep",t);if(s)o=-t.offsetHeight,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.getSize)(s)[1]&&addClass(s,"replies_deep_empty_list"),wall.updateCollapseDeepReplies(e);else if(ge("replies_wrap_deep"+e)){var r=cur.wallLayer&&cur.wallLayer===l?wkcur:cur,n=geByClass1("reply_date",t),d=geByClass1("reply_link_wrap",t),c="",p=attr(t,"onclick");p&&(c+=' onclick="'+p+'"');var u=e.split("_")[0],b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(u<0?r.wallTpl.reply_deleted_group:r.wallTpl.reply_deleted_user,{reply_id:e,date:n?n.innerHTML:"",answer:d?d.outerHTML:"",class:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"reply_replieable")?" reply_replieable":"",attr:c})),E=t.offsetHeight;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domReplaceEl)(t,b),o=b.offsetHeight-E}else o=-t.offsetHeight,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.re)(t);return cur.layerpost&&(cur.count--,cur.loaded--),a&&(wall.repliesSideSetup(l),wall.incReplyCounter(a,-1)),[o,i]},addDeepRepliesBlock:function(_){var e=ge("post"+_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(e,"reply")){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("wl_post",e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("post",e);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.hasClass)(t,"deep_active")){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(t,"post-id"),i=ge("replies_wrap_deep"+_),a=(cur.wallLayer?wkcur:cur).wallTpl;i||(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(a.reply_deep,{post_id:o,reply_id:_,reply_msg_id:_.split("_")[1],text:"",offset:0,class:" replies_next_deep"})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domInsertAfter)(i,e));var l=ge("reply_fakebox"+_),s=ge("reply_box"+_);if(!l&&!s){var r=ge("reply_fakebox"+o)||ge("reply_box"+o),n=geByClass1("checkbox_official",r)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.gpeByClass)("reply_fakebox_with_official",r),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(a.reply_box,{post_id:_,owner_name:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_19__.clean)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"owner-name")||""),owner_photo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"owner-photo")||"",owner_href:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(r,"owner-href")||"",can_reply_as_group:n||"",class:n?" reply_fakebox_with_official":""}));i.appendChild(d),addClass(i,"replies_deep_has_field")}}}},addReplyName:function(_,e){var t={};t[_]=e,wall.addReplyNames(t)},addReplyNames:function(_){var e=cur.wallLayer?wkcur:cur;e.options||(e.options={}),e.options.reply_names=extend({},e.options.reply_names,_)},getReplyNames:function(){return(cur.wallLayer?wkcur:cur).options.reply_names||{}},getReplyName:function(_){return cur.pvShown&&cur.pvReplyNames?cur.pvReplyNames[_]||[]:window.mvcur&&mvcur.mvShown&&!mvcur.minimized?mvcur.mvReplyNames[_]||[]:wall.getReplyNames()[_]||[]},showReorderRepliesTooltip:function(_,e){var t=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;if(!t["postRepliesReorderTT"+e]&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.data)(_,"ett")){var o,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domPN)(_);o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"hide-smart")||!1?t.wallTpl.replies_reorder_tooltip:t.wallTpl.replies_reorder_tooltip_with_smart;var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(o||"",{postId:e})),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("radiobtn",a),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"order")||"asc";radioBtns["post_replies_reorder"+e]={val:s,els:l},l.some((function(_){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"order")===s)return Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.checkbox)(_,!0),!0}));var r=new ElementTooltip(_,{appendTo:i,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-10,0],content:a,align:"left"});t["postRepliesReorderTT"+e]=r,cur.destroy.push((function(){r&&r.destroy()})),r.show()}},reorderReplies:function(_,e,t){var o=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;t=t||"asc",Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.radiobtn)(_,t,"post_replies_reorder"+e);var i=ge("post_replies_reorder"+e),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"label")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(i,a),i.setAttribute("aria-label",a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"order",t),o["postRepliesReorderTT"+e]&&o["postRepliesReorderTT"+e].hide(),wall.moreReplies(e,0,0,{deep:!0,clear:!0,order:t,onDone:function(_,t,o){var i=ge("replies"+e);if(o.count>o.offset+o.num){var a=cur.wallLayer&&cur.wallLayer===e?wkcur:cur,l=a.options.replies_page_count||20,s=Math.min(l,o.count-o.offset-o.num),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.se)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.rs)(a.wallTpl.reply_deep_next,{post_id:e,reply_id:e,offset:o.offset+o.num,count:s,text:getLang("wall_next_n_replies",s),class:" replies_next_main"}));i.appendChild(r)}o.top_reply_ids&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(i,"top-ids",o.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[e]=1,wall.repliesSideSetup(e)}})},getRepliesOrder:function(_){var e=ge("post_replies_reorder"+_);return(e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(e,"order"):"")||"asc"},isDescRepliesOrder:function(_,e){return"desc"===(e=e||wall.getRepliesOrder(_))},postEventChangeStatus:function(_,e,t,o){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"context");return stManager.add([jsc("web/groups.js")],()=>{Groups.enter(_,e,t,i,(_,t,o)=>{var a=i.split("_"),l=!a[1],s=a[0]+"_"+(l?"decline":""),r=l?getLang("events_snippet_will_participate_active"):getLang("events_snippet_cant_participate_active");o=o||{},Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post_event_action_btn"+e).forEach(_=>{addClass(_,"secondary"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(_,r),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.domData)(_,"context",s)}),o.members&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("page_media_event"+e).forEach(_=>{var e=geByClass1("page_media_event_members",_);e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.val)(e,o.members)})},{showProgress:()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post_event_action_btn"+e).forEach(_=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.lockButton)(_)})},hideProgress:()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_12__.geByClass)("post_event_action_btn"+e).forEach(_=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_17__.unlockButton)(_)})}})}),o&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_14__.cancelEvent)(o)},showEventFriends:function(_,e){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_15__.showTooltip)(_,{url:"/al_groups.php",params:{act:"a_event_friends_tt",owner_id:e},ajaxdt:100,showdt:400,hidedt:200,dir:"auto",noZIndex:!0,typeClass:"like_tt"})},showOrderTooltip:function(_){var e=geByClass1("post_replies_reorder");e&&(cur.orderFeatureTT=new ElementTooltip(e,{content:'<div class="feature_tooltip__close" onclick="cur.orderFeatureTT.hide();"></div>'+getLang("wall_order_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip order_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[0,-4],onHide:()=>{ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"order_web"}),cur.orderFeatureTT.destroy(),delete cur.orderFeatureTT}}),cur.orderFeatureTT.show())},updateRepliesOnScroll:function(){cur.wallLayer?WkView.wallUpdateRepliesOnScroll():"full"===cur.wallType&&FullWall.onePostOnScroll()}};__webpack_exports__.default=Wall},te1c:function(_,e,t){"use strict";t.r(e),t.d(e,"MEDIA_SELECTOR_GROUP",(function(){return w})),t.d(e,"MediaSelector",(function(){return L}));t("HEwt"),t("rE2o"),t("ioFf"),t("rGqo"),t("VRzm"),t("Vd3H"),t("a1Th"),t("Btvt"),t("KKXr"),t("Oyvg"),t("SRfc"),t("91GP"),t("pIFo");var o=t("v+DW"),i=t("Egk5"),a=t("EasH"),l=t("FWc3"),s=t("BxOC"),r=t("wetz"),n=t("t7n3"),d=t("/PiP"),c=t("W9Tc"),p=t("7GuL"),u=t("nqXl"),b=t("jE6c"),E=t("uQjJ");function O(_,e){return function(_){if(Array.isArray(_))return _}(_)||function(_,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(_)))return;var t=[],o=!0,i=!1,a=void 0;try{for(var l,s=_[Symbol.iterator]();!(o=(l=s.next()).done)&&(t.push(l.value),!e||t.length!==e);o=!0);}catch(_){i=!0,a=_}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return t}(_,e)||function(_,e){if(!_)return;if("string"==typeof _)return m(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);"Object"===t&&_.constructor&&(t=_.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return m(_,e)}(_,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}var w="group",g=p.MEDIA_TYPE_DONUT_DURATION,h="anonymous",P="poll_fixed",D="poll_closed",M="poll_background_id",v="poll_photo_id",f="poll_until",C="poll_is_multiple",T="poll_disable_unvote",A=/^invite\/[a-zA-Z0-9]{7}$|/,L=function(_,e,t,m,L,B){var I,W=[],R=(m=m||{}).mediaHandlers||{},y=m.from;each(t||[],(function(e,t){var i=t[0],s=t[1],r=t[2];if(s){var n=!1,d=m.toId||cur.postTo,c={to_id:d,blockPersonal:m.blockPersonal};c.mail_add=m.mail?1:"",c.from=m.from;var p={};switch(i){case"graffiti":n=showBox.pbind("al_wall.php",{act:"canvas_draw_box",flash:browser.flash},{cache:1,dark:1});break;case"photos_list":n=showBox.pbind("al_photos.php",extend(c,{act:"choose_photo"}),{cache:1,stat:[jsc("web/photos.js"),"photos.css",jsc("web/upload.js")],dark:1});break;case"photo":n=R.photo?R.photo.pbind(m):showBox.pbind("al_photos.php",extend(c,{act:"choose_photo",max_files:m.limit||10,no_album_select:~(m.disabledTypes||[]).indexOf("album")?1:""}),{cache:1,stat:[jsc("web/photos.js"),"photos.css",jsc("web/upload.js")],dark:1});break;case"video":var u=extend(c,{act:"a_choose_video_box",max_files:m.limit||10});n=function(){var e=domClosest("_submit_post_box",_);hasClass(e,"anon_field_on")||showBox("al_video.php",u,{cache:1,dark:1})};break;case"audio":n=function(){var e=domClosest("_submit_post_box",_);hasClass(e,"anon_field_on")||stManager.add([jsc("web/audio.js"),jsc("web/indexer.js"),jsc("web/auto_list.js"),jsc("web/grid_sorter.js"),"audio.css"],(function(){var e=!1;each(I.chosenMedias||[],(function(){"audio_playlist"===this[0]&&(e=!0)})),cur.audioAttachOriginalOwnerId=!1,cur.audioAttachSwitchOwnerId=!1;var t=vk.id,o=parseInt((""+c.to_id||"").replace(/^board/,"-")),i=domClosest("_submit_post_box",_);domData(i,"from-oid")<0||"im"===cur.module&&cur.gid?(t=o,cur.audioAttachOriginalOwnerId=o,cur.audioAttachSwitchOwnerId=vk.id):cur.hasGroupAudioAccess&&(cur.audioAttachOriginalOwnerId=vk.id,cur.audioAttachSwitchOwnerId=o),AudioPage.showAttachBox(t,{canPlaylistAttach:!e&&!cur.editor,onAudioChoose:AudioUtils.onAudioChoose,onPlaylistChoose:AudioUtils.onPlaylistChoose})}))};break;case"poll":n=()=>I.chooseMedia("poll","",r);break;case"doc":n=R.doc?R.doc.pbind(m):showBox.pbind("docs.php",Object.assign(c,m.docParams,{act:"a_choose_doc_box"}),{stat:["docs.css"]});break;case"map":n=showBox.pbind("al_places.php",extend(c,{act:"a_choose_place_box"}),{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js","boxes.css"],width:640,bodyStyle:"padding: 0px;",dark:1});break;case"note":n=showWiki.pbind({note:"new"},!0,!1,{queue:1});break;case"postpone":n=_=>{if(B){if(hasClass(_.target,"_close"))return I.unchooseMedia(I.postponeInd),void cancelEvent(_);var e=()=>{cur["postPostponeTT"+I.lnkId].show(),triggerEvent(geByClass1("datepicker_control",cur["postPostponeTT"+I.lnkId]._ttel),"mousedown",!1,!0);var _=!I.postponeDate;I.postponeDate=val("postpone_date"+I.lnkId),_&&I.chooseMedia("postpone",I.postponeDate,r)};I.postponeDatepicker?"DP_PLACEHOLDER"!==I.postponeDatepicker&&e():(cur.postponedLastDate&&(r.date=intval(cur.postponedLastDate)+3600),I.postponeDatepicker="DP_PLACEHOLDER",I.setupPostpone(r,null,e))}else I.chooseMedia("postpone",s,r)};break;case g:p.onMediaTypeInit=_=>{_.addMedia.donutVisibilityAddSelect&&_.addMedia.donutVisibilityAddSelect(_)},n=()=>{};break;case"mark_as_ads":n=()=>I.chooseMedia("mark_as_ads",s,r);break;case"share":n=function(_){_=_||{},window.onShareChooseUrlBoxInit=function(){var _=geByClass1("share_url_input",curBox().bodyNode);addEvent(_,"keydown",(function(_){if(_.which==KEY.ENTER)return t(curBox().btns.ok[0],_),!1}))};var e=showBox("share.php",{act:"choose_url_box"},{dark:1}),t=function(t,i){var a=geByClass1("share_url_input",e.bodyNode),l=val(a);Object(o.lockButton)(t),disable(a,!0),hide("share_url_error"),I.chooseMedia("share",s,extend(r,{url:l,draft:!0,onSuccess:function(){disable(a,!1),Object(o.unlockButton)(t),e.hide(),_.videoId&&window.AdsEdit&&window.AdsEdit.showSnippetVideo&&window.AdsEdit.showSnippetVideo(_.videoId)},onError:function(_){var e="";_&&_!==getLang("global_unknown_error")&&-1===_.indexOf("ERR_PAGE_GET_FAILED")&&(e=_+" "),disable(a,!1),Object(o.unlockButton)(t),ge("share_url_error").innerHTML=e+getLang("global_share_link_failed"),show("share_url_error")}}))};e.removeButtons(),e.addButton(getLang("global_continue"),t)};break;case"pretty_cards":n=function(_){_&&_.replace_owner_id&&(r.editor.owner_id=_.replace_owner_id),I.chooseMedia("pretty_cards",s,r)};break;case"gift":n=function(){var _=(_=m.peer<2e9?m.peer:0)||cur.peer;m.giftBoxPrepare&&m.giftBoxPrepare(_),showBox("al_gifts.php",{act:"get_gift_box",mid:_,fr:_==vk.id?1:0,ref:"media_selector"},{stat:["gifts.css","wide_dd.js","wide_dd.css"],dark:1})};break;case"money":n=function(){var _=cur.peer;d>-2e9&&d<0&&(c.owner_id=d),showBox("al_payments.php",extend(c,{act:"money_transfer_box",to_id:_}),{onFail:function(_){return curBox()&&curBox().hide(),setTimeout(Object(a.showFastBox)(getLang("global_error"),_).hide,2e3),!0}})};break;case"market":d==vk.id?(n=showBox.pbind("al_market.php",extend(c,{act:"a_choose_user_product_box"}),{cache:1}),r.tt_words&&(cur.checkMessageHandler=function(_){if(!cur.marketIntroShown&&(_=" "+_+" ").match(new RegExp("\\s("+r.tt_words.join("|")+")\\s","i"))){var e=getSize(I.menu.moreWrap);Object(l.showTooltip)(I.menu.moreWrap,{text:r.tt_text,dir:"left",slideX:15,width:230,shift:[-e[0]-5,-e[1]/2],hasover:1}),cur.marketIntroShown=!0}})):n=showBox.pbind("al_market.php",extend(c,{act:"a_choose_product_box"}),{cache:1});break;case"article":n=()=>openArticleEditor(d);break;case"podcast":n=function(){stManager.add([jsc("web/podcast.js")],(function(){Podcast.select()}))}}n&&W.push([i,s,n,p])}})),e=ge(e||"media_preview"),L=!1!==L&&ge(L||"post_settings_btn"),B=!1!==B&&ge(B||"post_actions_btns");var j=m.limit||10,U=j>1,K=m.editable&&(!browser.msie||parseInt(browser.version)>8),k=m.sortable&&(!browser.msie||parseInt(browser.version)>8),x=!!B,S=function(_,e,t){if(!(_=ge(_)))return!1;t=t||{},window.__addMediaIndex||(window.__addMediaIndex=0);var o=++__addMediaIndex;_.innerHTML='<div class="media_selector clear_fix"></div>';var a,l=domByClass(_,"media_selector"),s=[],r={id:o,menuNode:l,types:e,lastTypes:e,activate:function(_){r.touched=!0===_,t.onActivate&&t.onActivate()},show:function(){if(a&&(clearTimeout(a),a=0),r.moreWrap&&!hasClass(r.moreWrap,"shown")){t.forceToUp||replaceClass(r.moreWrap,"to_up","to_down");var _=domByClass(r.moreWrap,"_more_items");(getClientRectOffsetY(_)>0||t.forceToUp)&&replaceClass(r.moreWrap,"to_down","to_up"),setTimeout(addClass.pbind(r.moreWrap,"shown"),0)}},hide:function(_){function e(e){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}((function(_){if(!a){var e=function(){a=0,r.moreWrap&&removeClass(r.moreWrap,"shown")};if(_){var t=domByClass(r.moreWrap,"_more_items");hide(t),e(),setTimeout(show.pbind(t),0)}else a=setTimeout(e,300)}})),setOptions:function(_){extend(t,_)},setItems:function(_){for(window.tooltips&&tooltips.destroyAll(l);l.firstChild;)re(l.firstChild);var e=void 0!==t.hideAfterCount?t.hideAfterCount:4,o=void 0!==t.maxShown?t.maxShown:3,a=!1,n=t.hideItem,c=(n||_.length>e)&&(!browser.mobile||t.ignoreMobile),p=t.hideLabel||getLang("global_media_selector_more");function u(_,e,o,i,a,l){var n=ce("a",{innerHTML:i?e:'<span class="blind_label">'+e+"</span>",className:"ms_item ms_item_"+_+" _type_"+_});if(!i&&r.moreWrap?domInsertBefore(n,r.moreWrap):(i||a).appendChild(n),n.setAttribute("tabindex",0),!i){n.setAttribute("data-title",e),n.setAttribute("aria-label",e),n.setAttribute("role","link");var d=function(){showTitle(this,!1,l||!1,{noZIndex:!0})};addEvent(n,"mouseover",d),s.push((function(){removeEvent(n,"mouseover",d)}))}if(o&&!cur.viewAsBox){var c=function(){return r.activate(),r.hide(!0),t.onItemClick&&!t.onItemClick(_)||o(),!1};addEvent(n,"click",c),s.push((function(){removeEvent(n,"click",c)}))}}r.moreWrap=!1,r.lastTypes=_,each(_,(function(_,e){var b=e[0],E=e[1],O=e[2];if("article"!=b){if("postpone"===b&&x&&!r.postponeBtn){var m=getLang("wall_publication_now");r.postponeBtn=se(`<div class="post_action_btn has_cross" id="post_postpone_btn${r.id}">\n                <div class="post_action_btn_layout">\n                  <span class="post_action_btn_text" role="button" aria-label="${replaceEntities(m)}">${m}</span>\n                  <span class="post_action_image_btn _close" role="button" title="${replaceEntities(getLang("wall_post_timer_reset"))}"></span>\n                  <div class="post_action_tt_content _postpone" id="post_postpone_tt_content${r.id}" onclick="cancelEvent(event)"></div>\n                </div>\n               </div>`),t.actionsEl.appendChild(r.postponeBtn);var w="post_postpone_btn"+r.id,h=ge(w),P=geByClass1("post_action_tt_content",h),D=geByClass1("post_action_btn_layout",h),M=[-4*(vk.rtl?-1:1),4],v=new ElementTooltip(D,{appendTo:domPN(h),forceSide:"bottom",autoShow:!1,customShow:!0,cls:"_postpone timer_in_tt",noOverflow:!1,centerShift:0,offset:M,content:P,noHideOnClick:!0,align:"left",onShow:()=>{I.activeState=!0},onHide:()=>{I.activeState=!1,setTimeout(()=>{I.postponeDatepicker&&I.postponeDatepicker.hide()},ElementTooltip.FADE_SPEED)},onFirstTimeShow:function(){show(P)}});return cur["postPostponeTT"+r.id]=v,cur.destroy.push((function(){v&&v.destroy()})),addEvent(r.postponeBtn,"click",O),void s.push((function(){removeEvent(r.postponeBtn,"click",O)}))}if(b!==g){if(c&&(n?b==n:_==o)){var f=l.appendChild(ce("div",{className:"ms_items_more_wrap"})),C=function(_){r.fromKeyboard=Object(i.checkKeyboardEvent)(_),"mouseover"==_.type&&(r.touched||r.fromKeyboard)||(r.fromKeyboard&&hasClass(r.moreWrap,"shown")?r.hide():r.show())},T=function(){r.fromKeyboard||r.hide()};addEvent(f,"mouseover click",C),addEvent(f,"mouseout",T),s.push((function(){removeEvent(f,"mouseover click",C),removeEvent(f,"mouseout",T)})),t.vectorIcon&&(p='<span class="blind_label">'+p+"</span>",addClass(f,"ms_items_more_wrap_vector"));var A=f.appendChild(ce("a",{className:"ms_item_more",innerHTML:'<span class="ms_item_more_label">'+p+"</span>"}));A.setAttribute("tabindex",0),A.setAttribute("role","button");var L=ce("div",{className:"ms_items_more_helper"});a=ce("div",{className:"ms_items_more _more_items"}),L.appendChild(a),f.appendChild(L),r.moreWrap=f}u(b,E,O,a,l)}}else Object(d.isArticleEditorAvailable)()&&u(b,E,O,!1,l,[6,8])}))},enqueueOnAddMediaInit(_){},onAddMediaInit(_){}};e&&r.setItems(e),browser.msie&&(removeEvent(_,"MSPointerDown"),addEvent(_,"MSPointerDown",r.activate.pbind(!0)));removeEvent(_,"mouseover"),addEvent(_,"mouseover click",r.activate),t.global||cur.destroy.push((function(){removeEvent(_,"mouseover click",r.activate)}));t.forceToUp&&addClass(geByClass1("ms_items_more_wrap",l),"to_up");return r.handlersToClean=s,r}(_,W,{onActivate:function(){cur.attachCount=I.attachCount,cur.chooseMedia=I.chooseMedia,cur.getFrom=I.getFrom,cur.hasChosenMedia=I.hasChosenMedia,cur.lastAddMedia=I,cur.onMediaUploadStarted=m.onMediaUploadStarted,cur.showMediaProgress=I.showMediaProgress,cur.unchooseMedia=I.unchooseMedia,cur.updateChosenMedia=I.updateChosenMedia},onItemClick:function(_){return!(U&&I.attachCount()>=j&&"postpone"!==_&&"mark_as_ads"!==_&&"copyright"!==_)||(vk.widget?showBox("blank.php",{code:1900,limit:j}):Object(a.showFastBox)(getLang("global_error"),getLang("attachments_limit",j)),!1)},hideAfterCount:m.hideAfterCount,topOffset:m.topOffset,forceUp:m.forceUp,global:m.global,maxShown:m.maxShown,forceToUp:m.forceToUp,vectorIcon:m.vectorIcon,ignoreMobile:m.ignoreMobile,actionsEl:B,hideLabel:m.hideLabel});if(S){var N=intval(S.id);if(U){e.innerHTML=`<div id="page_pics_preview${N}" class="page_pics_preview media_preview clear_fix"></div><div id="page_dpics_preview${N}" class="page_pics_preview post_thumbed_media page_media_sortable media_preview clear_fix"></div><div id="page_docs_preview${N}" class="page_docs_preview post_thumbed_media page_media_sortable media_preview clear_fix"></div><div id="page_pdocs_preview${N}" class="page_docs_preview media_preview clear_fix"></div><div id="page_ldocs_preview${N}" class="page_docs_preview media_preview clear_fix"></div><div id="page_adocs_preview${N}" class="page_docs_preview media_preview clear_fix"></div><div id="page_mpics_preview${N}" class="page_pics_preview media_preview clear_fix"></div><div id="page_ppdocs_preview${N}" class="page_docs_preview media_preview _page_ppdocs_preview clear_fix"></div><div id="page_progress_preview${N}" class="page_progress_preview media_preview clear_fix"></div>`;var F=domFC(e),H=domNS(F),V=domNS(H),$=domNS(V),q=domNS($),G=domNS(q),z=domNS(G),Y=domNS(z),X=domNS(Y);removeClass(e,"media_preview"),removeClass(q,"vk_mini_app_preview"),addClass(e,"multi_media_preview")}else addClass(e,"med_no_attach"),show(e);return x&&(Y=ge("post_postpone_tt_content"+N)),(I={_addMediaLink:_,lnkId:N,menu:S,types:W,phLists:{},handlers:{},postponeIsTooltip:x,chosenMedias:[],limit:j,emitter:new E.default,eventTypes:{mediaUpdate:"mediaUpdate"},_showAddMedia:function(){S.show()},_hideAddMedia:function(_){S.hide(_)},hasRestrictingAttach:function(){return geByClass1("medadd_c_story",V)},getFrom:()=>y,updateChosenMedia:function(_,e,t){I.chooseMedia(_,e,t,null,null,null,!0)},addOrUpdateChosenMedia(){for(var _=arguments.length,e=new Array(_),t=0;t<_;t++)e[t]=arguments[t];var o=e[0],i=e[1];return(I.hasChosenMedia(o,i)?I.updateChosenMedia.bind(I):I.chooseMedia.bind(I))(...e)},hasChosenMedia:function(_,e){var t=!1;return each(I.chosenMedias,(function(){if(this[0]===_&&this[1]===e)return t=!0,!1})),t},chooseMedia:function(t,o,i,a,l,s,r){if(!cur.articleEditorLayer||"article"===t||"poll"===t){if(vk.widget&&(o=clean(o)),"postpone"===t&&x){if(hasClass(I.menu.postponeBtn,"on"))return!1;addClass(I.menu.postponeBtn,"on")}if(m.poster&&m.poster.isOpen()&&"postpone"!==t&&t!==g&&"copyright"!==t&&m.poster.closeEditor(),I.onChange&&!1===I.onChange(t,o,i,a))return void 0!==i.upload_ind&&re("upload"+i.upload_ind+"_progress_wrap"),!1;if("note"===t&&(cur.pbNoteAdded=!1),inArray(t,m.disabledTypes||[]))return!1;if((I.attachCount()>=j&&void 0===i.upload_ind&&"postpone"!==t&&t!==g&&"mark_as_ads"!==t||I.hasRestrictingAttach())&&"copyright"!==t){if(U)return!1;I.unchooseMedia()}var d=!1,p={},b=null;if(U&&(each(I.chosenMedias,(function(_){if(b=_,this[0]==t&&this[1]==o)return d=!0,!1;p[this[0]]=p[this[0]]?p[this[0]]+1:1})),d&&!r||r&&!d))return!1;var E,h,P="",D="",M=!1,v=V,f="",C="",T=!1;switch(t){case"graffiti":if(p.pretty_cards)return!1;isObject(i)||(i={thumb:i||""}),P=`<div class="fl_l page_preview_graffiti"><img class="page_preview_graffiti" src="${(i=K_(i)).thumb}" /></div>`,v=M=z;break;case"photos_list":if(vk.widget||p.pretty_cards)return!1;hide(this._addMediaLink),vkImage().src=i[1],(A=i[3].replace(/^{|}$/g,""))&&(A+=","),A+='"queue":1',P=`<div${m.nocl?"":` onclick="return showPhoto('${i[4]}', '${i[2]}', '${A.replace(/"/g,"&quot;")});"`} class="fl_l page_preview_photo"><img class="page_preview_photo" src="${i[1]}" /></div>`,v=M=F;break;case"photo":if(p.pretty_cards)return!1;isObject(i)||(i={thumb_m:i[0]||"",thumb_s:i[1]||"",list:i[2]||"",view_opts:i[3]||"",upload_ind:i.upload_ind||void 0}),i=K_(i),vkImage().src=i.thumb_m;var A=i.view_opts.replace(/^{|}$/g,"");if(vk.widget&&(A=A.replace(/&quot;/g,'"')),A&&(A+=","),A+='"queue":1',I.phLists[o]=i.list,K){if(!i.editable)return!1;if(!m.nocl){var L="{"+A+"}";L=JSON.parse(L),i.editable.click=I.showPhoto.pbind(o,i.list,L)}}P=`<div ${m.nocl?"":` onclick="return cur.addMedia[${I.lnkId}].showPhoto('${o}', '${i.list}', {${A.replace(/"/g,"&quot;")}});"`} class="fl_l page_preview_photo${s?" page_preview_ph_graff":""}"><img class="page_preview_photo" src="${i.thumb_m}" /></div>`,M=1,v=F;break;case"video":if(isEmpty(i)||p.pretty_cards)return!1;if(isObject(i)||(i={thumb:i||""}),K){if(!i.editable)return!1;m.nocl||(i.editable.click=showVideo.pbind(o,i.list_id,{queue:1,autoplay:1}))}(i=K_(i)).preview&&!vk.widget?(P=i.preview,i.editable.preview=P):P=`\n              <div ${m.nocl?"":`onclick="return showVideo('${o}', '${i.list_id}', {queue:1,autoplay:1});"`} class="fl_l page_preview_video">\n                <img class="page_preview_video" src="${i.thumb}" />\n              </div>\n            `,M=1,v=F,h=i.list_id;break;case"article":if(vk.widget||p.article||p.page||p.pretty_cards||!i)return!1;P='<div class="medadd_h medadd_h_pretty_cards inl_bl">'+getLang("global_article")+"</div>",D=i.snippet_html,o=i.url,i.rev&&(o+="?rev="+i.rev),v=q;break;case"audio":if(p.pretty_cards)return!1;i=K_(i),P=Page.addAudioPreview(clean(o),i),f=` id="pam${N}_audio${clean(o)}"`;break;case"audio_playlist":if(p.audio_playlist)return!1;(i=K_(i)).id=intval(i.id),i.ownerId=intval(i.ownerId),vk.widget&&i.authorHref&&!i.authorHref.match(/^(https?:\/\/|\/)/)&&(i.authorHref="https://"+i.authorHref),vk.widget&&i.coverUrl&&!i.coverUrl.match(/^(https?:\/\/|\/)/)&&(i.coverUrl="https://"+i.coverUrl);var B=i.coverUrl?`background-image:url('${i.coverUrl}'); background-size: cover;`:"",W="";W=i.authorHref?`<a href="${i.authorHref}" onclick="return nav.go(this)">${i.authorName}</a>`:i.authorName;var R="'"+(i.accessHash||"")+"'";D='<div class="audio_pl_attach_preview _audio_pl _audio_pl_'+i.ownerId+"_"+i.id+' clear_fix"><div class="audio_pl_attach_preview__play" onclick="return getAudioPlayer().playPlaylist('+i.ownerId+", "+i.id+", "+R+')"></div><div class="audio_pl_attach_preview__cover" style="'+B+'">'+(i.gridCovers||"")+'</div><div class="audio_pl_attach_preview__title">'+i.title+'</div><div class="audio_pl_attach_preview__info_line">'+W+"</div></div>",P='<span class="medadd_h">'+getLang("global_audio_playlist")+"</span>",v=q;break;case"artist":if(p.artist)return!1;var y=i.coverUrl?`background-image:url('${i.coverUrl}');`:"",X="",Q="";i.blockId&&(X=`<div class="audio_artist_snippet__play" onclick="return getAudioPlayer().playBlock('${i.ownerId}', 'artist${i.blockId}', '', '', 'artist')">${getLang("audio_listen_snippet")}</div>`,Q="_audio_pl _audio_pl_${data.ownerId}_artist${data.blockId}"),D=`<div class="audio_artist_attach_preview _audio_artist ${Q} clear_fix">\n              <div class="audio_artist_snippet__cover" style="${y}"></div>\n              <div class="audio_artist_snippet__info">\n                ${X}\n                <div class="audio_artist_snippet__title">${i.title}</div>\n                <div class="audio_artist_snippet__subtitle">${getLang("global_artist")}</div>\n              </div>\n            </div>`,P='<span class="medadd_h">'+getLang("global_artist")+"</span>",v=q;break;case"doc":if(vk.widget||p.pretty_cards)return!1;if(i.editable){var Z="stopEvent(event);";(i=K_(i)).hasBox&&(i.editable.click=_=>{Page.showGifBox(i.id,i.ownerId,intval(i.postId),intval(i.postOwnerId),i.hash,_)},Z=`Page.showGifBox(${intval(i.id)}, ${intval(i.ownerId)}, ${intval(i.postId)}, ${intval(i.postOwnerId)}, '${i.hash}', event);`),C+=" page_preview_doc_as_photo_wrap";var J=O(i.editable.sizes.m||i.editable.sizes.s,1)[0];P=`<a href="${i.editable.href}" onclick="${m.nocl?"":Z}" class="page_preview_doc_as_photo" target="_blank" rel="noopener" style="background-image: url('${J}');"><img class="page_preview_doc_as_photo" src="${J}" />${i.editable.label}</a>`,M=1,v=F}else i.thumb&&i.thumb_s?(P="gif"==i.ext?'<a onclick="if (cur.cancelClick) return (cur.cancelClick = false);" target="_blank" rel="noopener" href="'+i.href+'" class="pam_dpic"><div class="page_preview_doc_photo"><img src="'+i.thumb+'" align="center" /></div><div class="page_preview_doc_photo_hint doc_gif">'+i.title+"</div>":'<a onclick="if (cur.cancelClick) return (cur.cancelClick = false);" target="_blank" rel="noopener" href="'+i.href+'" class="pam_dpic"><div class="page_preview_doc_photo"><img src="'+i.thumb+'" align="center" /></div><div class="page_preview_doc_photo_hint">'+i.title+"</div>",D='</a><div class="pam_bg"></div>',v=M=H,f=' id="pam'+N+"_doc"+o+'"'):(P="",D='<div class="page_doc_row"><a target="_blank" rel="noopener" href="'+i.href+'" class="page_doc_icon page_doc_icon'+intval(i.type)+'"></a><a target="_blank" href="'+i.href+'" class="page_doc_title">'+i.title+'</a><div class="page_doc_description_row"><div class="page_doc_size">'+i.size_str+"</div></div></div>",f=' id="pam'+N+"_doc"+o+'"');break;case"story":if(vk.widget||p.pretty_cards)return!1;P='<div class="medadd_c_story"><a target="_blank" rel="noopener" '+i.attr+'"><div class="medadd_c_story_thumb fl_l" style="background-image:url('+i.thumb+')"></div></a><div class="medadd_c_story_info fl_l"><a class="medadd_c_story_title" target="_blank" '+i.attr+'">'+i.title+'</a><div class="medadd_c_story_desc">'+i.date_string+"</div></div>",hide(_);break;case"narrative":if(p.narrative)return!1;P='<span class="medadd_h">'+getLang("global_type_narrative")+"</span>",D=i.snippet_html;break;case"mask":if(vk.widget||p.pretty_cards)return!1;P='<div class="medadd_c_mask"><div class="medadd_c_story_thumb fl_l" style="background-image:url(/images/landings/vkmasks/masksSnippet_2x.png)"></div></a><div class="medadd_c_story_info fl_l"><div class="medadd_c_story_title">'+i.share.title+'</div><div class="medadd_c_story_desc">'+i.share.desc+"</div></div>";break;case"share":if(p.share||p.page||p.pretty_cards||p.market||!i.lang)return!1;if(isArray(i)&&(i={domain:i[0],url:i[1],initialPattern:i[2],title:i[3],description:i[4],images:[i[5]],user_id:i[6],photo_id:i[7]}),T=i.is_vk_mini_app,i.draft){var __={onSuccess:i.onSuccess,onError:i.onError};return I.checkURL(i.url,void 0,{},__),!1}if(!i.title&&!(cur.options.share||{}).allow_preview_empty_links)return(i.onError||function(){})(),!1;if(T?(i.title=Object(n.unclean)((i.title||"").replace(/\n/g,"\\n")),i.description=Object(n.unclean)((i.description||"").replace(/\n/g,"\\n"))):(i.title=Object(n.unclean)((i.title||"").replace(/<br>/g,"\n")),i.description=Object(n.unclean)((i.description||"").replace(/<br>/g,"\n")),i.description_short=Object(n.unclean)((i.description_short||"").replace(/<br>/g,"\n")),i.description_narrow=Object(n.unclean)((i.description_narrow||"").replace(/<br>/g,"\n"))),cur.options=cur.options||{},cur.options.share&&cur.options.share.max_title_len&&(i.title=(i.title||"").substr(0,cur.options.share.max_title_len)),cur.options.share&&cur.options.share.max_desc_len&&(i.description=(i.description||"").substr(0,cur.options.share.max_desc_len),i.description_short=(i.description_short||"").substr(0,cur.options.share.max_desc_len),i.description_narrow=(i.description_narrow||"").substr(0,cur.options.share.max_desc_len)),i.media=i.media||o,i.lang&&(cur.lang=extend(cur.lang||{},i.lang)),i=K_(i),P='<a target="_blank" rel="noopener" href="/away.php?to='+encodeURIComponent(i.url)+'" class="medadd_h medadd_h_link inl_bl">'+clean(Object(n.unclean)(i.is_vk_mini_app?i.lang.global_vk_mini_app:i.lang.profile_choose_link))+"</a>",T&&addClass(q,"vk_mini_app_preview"),!i.prometheus&&i.map_data){var e_=k_(q),t_="";t_=i.map_data[3]?i.map_data[3].replace("size=0,0","size="+e_.width+","+e_.height):"/maps?lat="+floatval(i.map_data[0])+"&lng="+floatval(i.map_data[1])+"&z=11&"+(window.isRetina()?"w="+2*e_.width+"&h="+2*e_.height:"w="+e_.width+"&h="+e_.height);var o_="";Object(c.partConfigEnabled)("maps_no_referrer")&&(o_='referrerpolicy="no-referrer"'),P+=`<div class="medadd_c_share_map"><a onclick="return showBox('al_places.php', {act: 'geo_box', lat: ${floatval(i.map_data[0])}, long: ${floatval(i.map_data[1])}, provider: ${intval(i.map_data[3])}}, {dark: 1});"><div class="page_media_map_point"></div><img class="page_preview_map" ${o_} width="${e_.width}" height="${e_.height}" src="${t_}" /></a></div>`}if(I.shareData=extend(I.shareData||{},i,{imagesStyles:[""]}),v=q,(i.onSuccess||function(){})(),(cur.options.share||{}).button_exclusive&&i.shareButtons)hide(_),(i_=ge("signed"))&&disable(i_);hide(domByClass(S.menuNode,"_type_share")),hide(domByClass(S.menuNode,"_type_market"));break;case"pretty_cards":if(p.share||p.pretty_cards||vk.widget)return!1;var i_;P='<div class="medadd_h medadd_h_pretty_cards inl_bl">'+i.lang.global_wall_pretty_cards+"</div>",(i_=ge("signed"))&&disable(i_),hide(domByClass(S.menuNode,"_type_pretty_cards")),hide(_),v=q;break;case"poll":if(!i.lang||vk.vidget||p.poll||!$||p.pretty_cards)return!1;hide(domByClass(S.menuNode,"_type_poll")),v=$;break;case"map":if(vk.widget||p.pretty_cards)return!1;var a_=k_(z);o_="";Object(c.partConfigEnabled)("maps_no_referrer")&&(o_='referrerpolicy="no-referrer"'),P=`<span class="medadd_h medadd_h_link inl_bl">${clean(Object(n.unclean)(i[4]))}</span><div class="fl_l medadd_c_map"><a onclick="return showBox('al_places.php', {act: 'geo_box', lat: ${floatval(i[0])}, long: ${floatval(i[1])}, provider: ${intval(i[3])}}, {dark: 1});"><div class="page_media_map_point"></div><img class="page_preview_map" ${o_} width="${a_.width}" height="${a_.height}" src="/maps?lat=${floatval(i[0])}&lng=${floatval(i[1])}&z=11&w=${a_.width}&h=${a_.height}" /></a></div>`,v=M=z,hide(domByClass(S.menuNode,"_type_map"));break;case"page":if(p.share||p.page||!i.lang||vk.widget||p.pretty_cards)return!1;var l_=i.media.split("_");P='<a href="/page'+i.media+'" onclick="return showWiki({oid: '+l_[0]+", id: "+l_[1]+'}, false, event, {queue: 1})" class="medadd_h medadd_h_page inl_bl">'+i.lang.profile_choose_page+"</a>",v=q;break;case"album":if(vk.widget||p.pretty_cards)return!1;if(i.is_private_album){extend(i.editable,{title:i.title,size:0}),M=1,v=F;break}if(i.thumb.match(/^\/images\//)&&(i.thumb=""),K){if(!i.editable)return!1;extend(i.editable,{title:i.title,size:i.count,click:!m.nocl&&nav.change.pbind({z:"album"+o})})}var s_=i.thumb;vkImage().src=s_,P=`<a class="${"fl_l page_album_link"+(s_?"":" page_album_nocover")}" ${E=m.nocl?"":' href="/album'+o+'" onclick="return nav.change({z: \'album'+o+"'}, event)\""}>\n              ${s_?`<div class="page_album_thumb_wrap"><img class="page_album_thumb" src="${s_}"/></div>`:""}\n              <div class="page_album_title">\n                <div class="page_album_size">${i.count}</div>\n                <div class="page_album_title_text">${i.title}</div>\n              </div>\n            </a>`,M=1,v=F;break;case"note":if(!i.lang||vk.widget||p.pretty_cards)return!1;P="<a onclick=\"showWiki({w: 'note"+i.raw+'\', edit: 1}, true, event, {queue: 1})" class="medadd_h medadd_h_note inl_bl">'+i.lang.profile_choose_note+"</a>",D='<div class="medadd_c medadd_c_note"><a onclick="showWiki({w: \'note'+i.raw+'\', edit: 1}, true, event, {queue: 1})" id="share_note_title'+i.raw+'">'+i.title+"</a></div>",v=q;break;case"market":if(vk.widget||p.pretty_cards||p.share||p.market)return!1;P='<div class="medadd_c_market"><a target="_blank" rel="noopener" href="'+i.href+'"><img class="medadd_c_market_thumb fl_l" src="'+i.thumb+'" /></a><div class="medadd_c_market_info fl_l"><a class="medadd_c_market_title" target="_blank" href="'+i.href+'">'+i.title+'</a><div class="medadd_c_market_price">'+i.price+"</div></div>",hide(domByClass(S.menuNode,"_type_market"));break;case"market_album":if(vk.widget||p.pretty_cards)return!1;if(i.is_private_album){extend(i.editable,{title:i.title,msize:""}),M=1,v=F;break}if(K){if(!i.editable)return!1;extend(i.editable,{title:i.title,msize:langNumeric(i.count,i.lang.profile_X_market_items),click:!1})}l_=o.split("_");vkImage().src=i.thumb,E=m.nocl?"":' href="/market'+l_[0]+"?section=album_"+l_[1]+'"',P=`<a class="${"fl_l page_preview_album wall_album_cover_wrap wall_market_album_cover"+(i.thumb?"":" page_album_nocover")}" ${E}>\n              ${i.thumb?`<img class="wall_album_cover" src="${i.thumb}"/>`:""}\n              <div class="wall_album_caption">\n                <div class="wall_album_title_wrap clear_fix">\n                  <div class="wall_album_count fl_r">${i.count}</div>\n                  <div class="wall_album_title">${i.title}</div>\n                </div>\n              </div>\n            </a>`,M=1,v=F;break;case"copyright":if(vk.widget)return!1;I.copyrightCreate(i);break;case"postpone":if(vk.widget)return!1;var r_="";if(cur.editingPost&&!U)o=intval(o),i.date=o||intval(cur.editingPost[7]),ge("wpe_save").innerHTML=getLang("global_save"),r_=getLang("global_save");else if(cur.editingPost&&"wpe_media_preview"==e.id){o=intval(o),i.date=o||intval(cur.editingPost[7]);var n_=geByClass1("medadd_c_timersett",Y);if(n_){var d_=domPN(n_);n_=d_.innerHTML,re(d_)}else n_="";ge("wpe_save").innerHTML=getLang("global_save"),r_=getLang("global_save")}else{i.draft?i.date=intval(o):cur.postponedLastDate&&(i.date=intval(cur.postponedLastDate)+3600);var c_=ge("official");if(!(f_=gpeByClass("_submit_post_box",c_))&&m.poster&&domClosest("poster",c_)&&(f_=ge("submit_post_box")),c_&&f_){var p_=domData(f_,"from-oid"),u_=domData(f_,"oid");p_==vk.id&&u_&&wall.setReplyAsGroup(c_,{from:u_}),disable(c_);var b_=window.data(c_,"tt");if(b_&&b_.rdBtns){var E_=b_.rdBtns[1],O_=b_.rdBtnsGroup,m_=domData(E_,"as");radiobtn(E_,m_,O_)}}(E_=ge("send_post"))&&(E_.innerHTML=i.lang.profile_wall_postpone_btn,r_=i.lang.profile_wall_postpone_btn)}x?(I.updatePostponeBtnText(!1,i.date),I.postponeDate=i.date):P=`<div class="medadd_h medadd_h_timer inl_bl">${i.lang.profile_choose_timer}<span id="postpone_preview${N}"></span></div>`,!I.postponeDatepicker&&x&&I.setupPostpone(i,n_),m.poster&&m.poster.changeBtnText(r_);var w_=Math.round((new Date).getTime()/1e3);intval(i.date)<w_&&(i.date=w_+3600),hide(domByClass(S.menuNode,"_type_postpone")),v=Y;break;case g:if(vk.widget)return!1;break;case"mark_as_ads":if(vk.widget)return!1;P='<div class="medadd_h medadd_h_mark_as_ads inl_bl">'+i.lang.global_ads_wall_post_mark_as_ads_action+"</div>",hide(domByClass(S.menuNode,"_type_mark_as_ads")),v=Y;break;case"wall":if(vk.widget||p.pretty_cards)return!1;P='<div class="medadd_c_wall"><a target="_blank" rel="noopener" href="'+i.href+'"><img class="medadd_c_wall_thumb fl_l" src="'+i.thumb+'" /></a><div class="medadd_c_wall_info fl_l"><a class="medadd_c_wall_author" target="_blank" href="'+i.href+'">'+i.author+'</a><div class="medadd_c_wall_type">'+i.lang.title+"</div></div>",f=' id="pam'+N+"_wall"+o+'"',hide(_);break;case"wall_reply":if(vk.widget||p.pretty_cards)return!1;P='<div class="medadd_c_wall"><a target="_blank" rel="noopener" href="'+i.href+'"><img class="medadd_c_wall_thumb fl_l" src="'+i.thumb+'" /></a><div class="medadd_c_wall_info fl_l"><a class="medadd_c_wall_author" target="_blank" href="'+i.href+'">'+i.author+'</a><div class="medadd_c_wall_type">'+i.lang.title+"</div></div>",f=' id="pam'+N+"_wall_reply"+o+'"',hide(_);break;case"podcast":if(vk.widget||p.pretty_cards)return!1;var g_="_im_media_preview"===domPN(v).id,h_=!g_&&cur.editingPost&&"wpe_media_preview"===domPN(v).id;if(g_)P='<div class="medadd_c_podcast"><a target="_blank" rel="noopener" href="'+i.href+'"><img class="medadd_c_podcast_thumb fl_l" src="'+i.thumb+'" /></a><div class="medadd_c_podcast_info fl_l"><a class="medadd_c_podcast_title" target="_blank" href="'+i.href+'">'+i.title+'</a><div class="medadd_c_podcast_type">'+i.lang.title+"</div></div>";else{var P_=!1;each(I.chosenMedias||[],(function(_,e){isArray(e)&&"podcast"===e[0]&&(cur.addMedia[I.lnkId].unchooseMedia(_),P_=!0)})),P_&&I.onChange&&I.onChange(t,o,i,a),P='<div class="podcast_preview_title">'+getLang("audio_podcast_attach_media")+"</div>";var D_=i.audio[AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i.audio[AudioUtils.AUDIO_ITEM_INDEX_ID];cur.podcastEditData={audioId:D_,ref:"post",onCreate:function(_,e){I.chooseMedia("podcast",_[AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+_[AudioUtils.AUDIO_ITEM_INDEX_ID],{audio:_,coverUrl:e})}};var M_="<span class=\"podcast_snippet__edit\" onclick=\"cur.chooseMedia = cur.podcastEditData.chooseMedia; stManager.add([jsc('web/podcast.js')], function() { Podcast.edit('"+D_+"'); });\"></span>";P+='<div class="podcast_snippet_loading" id="podcast_loading'+o[0]+'"></div>',stManager.add([jsc("web/podcast.js")],(function(){domReplaceEl(ge("podcast_loading"+o[0]),Podcast.drawSnippet(i.audio,i.coverUrl,M_))}),!0)}if(v=G,(i.onSuccess||function(){})(),hide(domByClass(S.menuNode,"_type_podcast")),!g_&&!h_){var v_=ge("official"),f_=v_&&gpeByClass("_submit_post_box",v_);if(v_&&f_)(p_=domData(f_,"from-oid"))!==(u_=domData(f_,"oid"))&&(C=" attach_disabled")}break;case w:if(vk.widget||p.pretty_cards||p[w])return!1;var C_="",T_=Number(i.type);if(T_===u.GROUPS_CLASS_EVENT&&(C_=i.private?getTemplate("event_snippet_private_info"):""),!(P=getTemplate("event_snippet",extend({bottom:C_},i))))return(i.onError||function(){})(),!1;P='<div class="event_preview_title">'+(T_===u.GROUPS_CLASS_EVENT?getLang("events_media_type"):getLang("groups_media_type_community"))+"</div>"+P,v=q,(i.onSuccess||function(){})()}if(U){var A_=I.chosenMedias,L_=d?b:A_.length,B_="";if(K&&1===M)B_=!1;else if("photos_list"===t)B_=se('<div class="page_preview_'+t+"_wrap"+C+'" style="position: relative">'+P+'<div class="page_photos_count">'+o.split(",").length+"</div></div>");else if("postpone"==t&&x||"copyright"===t||t===g)B_=!1;else{var I_=null;"share"===t&&i.map_data&&(I_="map"),B_=se('<div class="page_preview_'+(I_||t)+"_wrap"+C+(T?" page_preview_vk_mini_app":"")+'"'+(m.nocl?' style="cursor: default"':"")+f+'><div nosorthandle="1" class="page_media_x_wrap inl_bl" data-title="'+getLang("dont_attach")+'" aria-label="'+getLang("dont_attach")+'" role="button" onmouseover="showTitle(this)" onclick="cur.addMedia['+I.lnkId+"].unchooseMedia("+L_+'); return cancelEvent(event);"><div class="page_media_x" nosorthandle="1"></div></div>'+P+D+"</div>")}if(addClass(B_,M?"fl_l":"clear_fix"),void 0!==i.upload_ind&&re("upload"+i.upload_ind+"_progress_wrap"),m.toggleLnk&&!d){var W_=I.attachCount()+1<j;toggle(_,W_),m.onToggleBlock&&m.onToggleBlock(W_)}K&&1===M?(addClass(v,"editable_thumbs_wrap"),v=domLC(v)&&hasClass(domLC(v),"editable_thumbs")?domLC(v):v.appendChild(ce("div",{id:"thumbs_edit"+N,className:"editable_thumbs"})),stManager.add(["thumbs_edit.css",jsc("web/thumbs_edit.js")],()=>{if(A_[L_]&&(A_[L_].type===t||A_[L_].media!==o)){if(m.toggleLnk&&!d){var a=I.attachCount()+1<j;toggle(_,a),m.onToggleBlock&&m.onToggleBlock(a)}i.editable.remove=I.unchooseMedia.pbind(L_),show(domPN(v));var l=ThumbsEdit.convert(t,o,i.editable);domData(v,"te-inited")?d?ThumbsEdit.updateMedia(v,t,o,i):ThumbsEdit.addMedia(v,l):ThumbsEdit.init(v,[l],{width:m.teWidth,height:m.teHeight,force:!0,onMove:m.onAddMediaChange,onUpdate:m.onChangedSize,deferred:!0}),toggleClass(e,"media_preview_has_medias",I.hasVisibleRows()&&(hasClass(e,"reply_media_preview")||isVisible(_)||!hasClass("signed","disabled"))),m.onChangedSize&&m.onChangedSize()}},!0)):(("postpone"!=t&&"copyright"!=t&&t!==g||!x)&&(show(v),d?v.replaceChild(B_,A_[b][2]):v.appendChild(B_)),k&&(v==V?stManager.add([jsc("web/sorter.js")],(function(){var _=getXY(V),e=getSize(V),t=function(){V.sorter?sorter.added(V):v.childNodes.length>1&&sorter.init(V,{onReorder:m.onAddMediaChange})};_[0]||_[1]||e[0]||e[1]?t():cur.sorterClbk=t,m.onChangedSize&&m.onChangedSize()}),!0):v==H&&stManager.add([jsc("web/qsorter.js")],(function(){H.qsorter?qsorter.added(H):v.childNodes.length>1&&qsorter.init(H,I.qsorterOpts()),m.onChangedSize&&m.onChangedSize()}),!0)),m.onChangedSize&&m.onChangedSize()),d?A_[b]=[t,o,B_,a,h,i]:A_.push([t,o,B_,a,h,i])}else{L_=0;if("postpone"===t?L_=1:"mark_as_ads"===t&&(L_=2),"postpone"==t&&x||"copyright"===t||t===g)B_=!1;else{var R_=(!1===M?"page_docs_preview":"page_pics_preview")+(L_?"":" post_thumbed_media");R_+=M?" fl_l":" clear_fix";var y_=null;"share"===t&&i.map_data&&(y_="map"),B_=se(`\n            <div class="${R_}">\n              <div class="${"page_preview_"+(y_||t)+"_wrap"} ${C}" ${(m.nocl?'style="cursor: default"':"")+f}>\n                ${P}\n                <div nosorthandle="1" class="page_media_x_wrap inl_bl" data-title="${getLang("dont_attach")}" aria-label="${getLang("dont_attach")}" role="button" onmouseover="showTitle(this)" onclick="cur.addMedia[${I.lnkId}].unchooseMedia(${L_}); return cancelEvent(event);">\n                  <div class="page_media_x" nosorthandle="1"></div>\n                </div>\n                ${D}\n              </div>\n            </div>`)}void 0!==i.upload_ind&&re("upload"+i.upload_ind+"_progress_wrap"),"postpone"!==t&&t!==g&&"mark_as_ads"!==t&&"copyright"!==t&&(I.chosenMedia=[t,o],I.chosenMedia[5]=i,I.chosenMediaData=i),I.singleAdded(B_,t)}"share"==t?!i.title||a||i.url?i.video?(cur.shareShowImg=0,I.bigLink=!0,I.showExternalPreview()):I.showExternalPreview():(cur.shareShowImg=0,I.showPreview(!0),I.shareData.images=!1):"page"==t?i.nopreview||(cur.shareShowImg=0,I.shareData=extend(I.shareData||{},i,{images:!1}),I.showPreview()):"poll"===t?I.pollCreate(i):"postpone"==t?x?I.postponeInd=L_:I.setupPostpone(i,n_):"mark_as_ads"==t?I.markAsAds=1:"pretty_cards"==t&&I.createPrettyCards(i),toggleClass(e,"media_preview_has_medias",I.hasVisibleRows()&&(isVisible(_)||!hasClass("signed","disabled"))),m.onChangedSize&&m.onChangedSize();var j_=window.event;return j_&&"click"==j_.type&&(j_.ctrlKey||j_.metaKey||j_.shiftKey)&&I.attachCount()+1<=j&&(l=!0),cur.fileApiUploadStarted&&void 0!==i.upload_ind||cur.preventBoxHideWithSharedBox||cur.preventBoxHide||!0===l||inArray(t,["poll","share","page","postpone","mark_as_ads","pretty_cards","copyright"])||boxQueue.hideLast(),cur.lastPostMsg=!1,m.onMediaAdd&&m.onMediaAdd(),getAudioPlayer().updateCurrentPlaying(),cur.onMediaChanged&&cur.onMediaChanged(I.chosenMedias),window.mvcur&&mvcur.onMediaChanged&&mvcur.onMediaChanged(),m.onMediaChanged&&m.onMediaChanged(),I.emitter&&I.emitter.emit(I.eventTypes.mediaUpdate),void 0!==i.upload_ind&&delete i.upload_ind,!1}function U_(_,e){return isString(_)?_=clean(Object(n.unclean)(Object(n.unclean)(_))):(isObject(_)||isArray(_))&&(_=K_(_,e)),_}function K_(_,e){if(!vk.widget)return _;if((e=positive(e))>5)return _;if(isArray(_))_.forEach((function(t,o){_[o]=U_(t,e+1)}));else if(isObject(_))for(var t in _)_.hasOwnProperty(t)&&(_[t]=U_(_[t],e+1));return _}function k_(_){var e=340,t=127;return"im"!==cur.module&&(e=Math.min(parseInt(_.parentElement.offsetWidth),510)||480,t=Math.min(e/2,200),(hasClass(_.parentElement,"reply_media_preview")||"wpe_media_preview"===_.parentElement.id)&&t>120&&(t=120)),{width:e,height:t}}},unchooseMedia:function(t,o){if(I.onChange&&!1===I.onChange(!1,t))return!1;if(U){if(cur.checkURLDomainRequest&&cur.checkURLDomainRequest.abort(),clearTimeout(cur.showLoaderTimeout),clearInterval(cur.shareImgInterval),clearTimeout(cur.shareImgInterval2),clearTimeout(cur.imgLoadTimeout),clearTimeout(cur.checkURLDomainTO),void 0===t){if(window.ThumbsEdit&&ThumbsEdit.removeAll("thumbs_edit"+N),each(I.chosenMedias,(function(_,e){!e||void 0===_||o&&!inArray(e[0],o)||I.unchooseMedia(_)})),I.urlsCancelled=[],m.onChangedSize){m.onChangedSize();var i=setInterval(m.onChangedSize,50);setTimeout(clearTimeout.bind(null,i),500)}return void(I.copyrightToggle&&I.copyrightToggle(!0))}var a=I.chosenMedias;if(a[t]){var l;switch("podcast"===a[t][0]&&(l=cur.editingPost&&!cur.editingPost[3].reply&&"wpe_media_preview"===gpeByClass("multi_media_preview",a[t][2]).id),a[t][2]?((w=geByClass1("page_media_x_wrap",a[t][2],"div"))&&w.tt&&w.tt.el&&w.tt.destroy(),domPN(a[t][2])==V&&V.sorter?(each(V.sorter.elems,(function(){setStyle(this,{top:"auto",left:"auto",cursor:"auto"})})),V.sorter.destroy(),re(a[t][2]),V.childNodes.length>1&&sorter.init(V,{onReorder:m.onAddMediaChange})):domPN(a[t][2])==H&&H.qsorter?(each(H.qsorter.elems,(function(){setStyle(domFC(this),{top:"auto",left:"auto"}),setStyle(this,{cursor:"auto"})})),H.qsorter.destroy(),re(a[t][2]),H.childNodes.length>1&&qsorter.init(H,I.qsorterOpts())):re(a[t][2])):"photo"!=a[t][0]&&"video"!=a[t][0]&&"album"!=a[t][0]||window.ThumbsEdit&&ThumbsEdit.removeById("thumbs_edit"+N,a[t][0]+a[t][1]),a[t][0]){case"page":case"share":I.shareData={},re(I.sharePreview),hide("medadd_c_linkimg_loader"),delete I.sharePreview,show(domByClass(S.menuNode,"_type_share")),show(_),(s=ge("signed"))&&disable(s,!isChecked("official")),show(domByClass(S.menuNode,"_type_market"));break;case"pretty_cards":var s;re(I.prettyCardGallery.el),delete I.prettyCardGallery,(s=ge("signed"))&&disable(s,!isChecked("official")),show(domByClass(S.menuNode,"_type_pretty_cards")),show(_);break;case"poll":re(I.pollPreview),delete I.pollPreview,show(domByClass(S.menuNode,"_type_poll"));break;case"map":show(domByClass(S.menuNode,"_type_map"));break;case"podcast":var r=!0;if(l)+cur.editingPost[0].split("_")[0]!==cur.oid&&(r=!1);else{var n=(d=ge("official"))&&gpeByClass("_submit_post_box",d);if(d&&n)domData(n,"from-oid")!==domData(n,"oid")&&(r=!1)}toggle(domByClass(S.menuNode,"_type_podcast"),r);break;case"market":show(_),show(domByClass(S.menuNode,"_type_market"));break;case"wall":case"wall_reply":case"story":case"narrative":show(_);break;case"postpone":var d,c=geByClass1("medadd_c_timersett",I.postponePreview);cur.editingPost&&c&&!x?re(domFC(I.postponePreview)):(Y.innerHTML="",I.postponeDatepicker=null,I.postponeDate=null),I.postponePreview=!1,(d=ge("official"))&&disable(d,!1);var p=m.poster,u="";if(cur.editingPost)if(cur.editingPost[6]&&intval(cur.editingPost[6].getAttribute("data-suggest"))){u=getLang("wall_publish_suggest");var b=ge("wpe_save");b&&(b.innerHTML=u)}else{u=getLang("wall_publish_now");var E=ge("wpe_save");E&&(E.innerHTML=u)}else u=getLang("wall_send"),ge("send_post").innerHTML=u;p&&p.changeBtnText(u),x?(removeClass(I.menu.postponeBtn,"on"),I.updatePostponeBtnText(!0)):show(domByClass(S.menuNode,"_type_postpone"));break;case"mark_as_ads":show(domByClass(S.menuNode,"_type_mark_as_ads")),I.markAsAds=!1;break;case"copyright":I.copyrightRemove()}a[t]=!1}if(m.toggleLnk){r=I.attachCount()<j;toggle(_,r),m.onToggleBlock&&m.onToggleBlock(r)}toggle(F,!!(K?geByClass1("thumb_wrap",F):domFC(F))),toggle(H,!!domFC(H)),toggle(V,!!domFC(V)),toggle($,!!domFC($)),toggle(q,!!domFC(q)),toggle(G,!!domFC(G)),toggle(z,!!domFC(z)),x||toggle(Y,!!domFC(Y)),toggle(X,!!domFC(X))}else{var O,w;if(null==t&&(t=0),(w=geByClass("page_media_x_wrap",e,"div")[t])&&w.tt&&w.tt.el&&w.tt.destroy(),1==t){if(x)Y.innerHTML="",I.postponeDatepicker=null,I.postponeDate=null,removeClass(I.menu.postponeBtn,"on"),I.updatePostponeBtnText(!0);else if(I.postponePreview){show(geByClass1("add_media_type_"+N+"_postpone",S.menuNode,"a"));var g=domPN(I.postponePreview);window.tooltips&&tooltips.destroyAll(g),re(g),I.postponePreview=!1;var h=S.lastTypes;each(S.types,(function(_,e){"postpone"===e[0]&&h.push(e)})),S.setItems(h)}}else if(2==t&&I.markAsAds){I.markAsAds=!1;var P=geByClass1("page_preview_mark_as_ads_wrap",e);window.tooltips&&P&&tooltips.destroyAll(P),re(P);h=S.lastTypes;each(S.types,(function(_,e){"mark_as_ads"===e[0]&&h.push(e)})),S.setItems(h)}else if(3===t)I.copyrightRemove();else{if(I.postponePreview||I.markAsAds){g=I.postponePreview&&domPN(I.postponePreview),P=I.markAsAds&&domPN(geByClass1("page_preview_mark_as_ads_wrap",e));for(var D=[],M=0;M<e.childNodes.length;M++){var v=e.childNodes[M];"DIV"==v.nodeName&&v!=g&&v!=P&&D.push(v)}each(D,(function(_,e){re(e)}));h=[];each(S.types,(function(_,e){"postpone"===e[0]&&I.postponePreview||"mark_as_ads"===e[0]&&I.markAsAds||h.push(e)})),S.setItems(h)}else val(e,""),addClass(e,"med_no_attach"),S.setItems(S.types);I.chosenMedia&&(I.chosenMedia=!1,I.chosenMediaData=!1),(O=I.shareData)&&(O.url&&I.urlsCancelled.push(O.url),O.initialPattern&&I.urlsCancelled.push(O.initialPattern),I.shareData={}),each([I.sharePreview,I.pollPreview],(function(){re(this)})),I.sharePreview=I.pollPreview=!1}m.toggleLnk&&show(_)}if(toggleClass(e,"media_preview_has_medias",I.hasVisibleRows()&&(hasClass(e,"reply_media_preview")||isVisible(_)||!hasClass("signed","disabled"))),I.copyrightToggle&&I.copyrightToggle(!0),cur.onMediaChanged&&cur.onMediaChanged(a),window.mvcur&&mvcur.onMediaChanged&&mvcur.onMediaChanged(),m.onMediaChanged&&m.onMediaChanged(),I.emitter&&I.emitter.emit(I.eventTypes.mediaUpdate),cur.lastPostMsg=!1,I.onChange&&I.onChange(!1),m.onChangedSize){m.onChangedSize();i=setInterval(m.onChangedSize,50);setTimeout(clearTimeout.bind(null,i),500)}},findChosenMedia:_=>I.chosenMedias.find(e=>e[0]===_),findChosenMediaAllIndices(_){return e=I.chosenMedias,t=e=>e[0]===_,e.reduce((function(_,e,o){return t(e)?_.concat(o):_}),[]);var e,t},chosenMediaToObject(_){var e=O(_,6);return{type:e[0],media:e[1],data:e[5]}},unchooseMediaForType(_){I.findChosenMediaAllIndices(_).forEach(_=>{I.unchooseMedia(_)})},singleAdded:function(t,o){if("copyright"!==o){if("postpone"===o){if(x)return;e.appendChild(t)}else if("mark_as_ads"===o)I.postponePreview?e.insertBefore(t,domLC(e)):e.appendChild(t);else{if(o===g)return;domFC(e)?e.insertBefore(t,domFC(e)):e.appendChild(t)}removeClass(e,"med_no_attach");var i=[];each(S.lastTypes,(function(_,e){("postpone"!==e[0]||!I.postponePreview&&"postpone"!==o)&&("mark_as_ads"!==e[0]||!I.markAsAds&&"mark_as_ads"!==o)&&(inArray(o,["postpone","mark_as_ads"])||inArray(e[0],["postpone","mark_as_ads"]))&&i.push(e)})),S.setItems(i),m.toggleLnk&&!i.length&&hide(_)}},getMedias:function(_){if(U){var e=window.ThumbsEdit?ThumbsEdit.getMedias("thumbs_edit"+N):[],t={},o=I.chosenMedias||[],i=[],a=function(_,e,o){if(o[0]+o[1]==_)return i.push(o),t[_]=!0,!1};return each(e,(function(_,e){each(o,a.pbind(e[0]+e[1]))})),each(H.childNodes,(function(_,e){var t=(e.id||"").match(/^pam\d+_([a-z]+)(-?\d+_\d+)/);t&&each(o,a.pbind(t[1]+t[2]))})),each(V.childNodes,(function(_,e){var t=(e.id||"").match(/^pam\d+_([a-z]+)(-?\d+_\d+)/);t&&each(o,a.pbind(t[1]+t[2]))})),each(o,(function(_,e){e&&isArray(e)&&e.length&&!t[e[0]+e[1]]&&i.push(e)})),i}return(o=I.chosenMedia)?[_?o:o[0]+o[1]]:[]},showPhoto:function(_){function e(e,t,o,i){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}((function(_,e,t,o){for(var i in!cur.pvData||cur.pvShown&&cur.pvListId==e||delete cur.pvData[e],ajaxCache)i.toString().match(/^\/al_photos\.php\#act=show&draft_photos/)&&delete ajaxCache[i];var a=I.getMedias(),l=[];return each(a,(function(_,e){e&&"photo"==e[0]&&l.push(e[1]+"/"+(I.phLists[e[1]]||""))})),t.additional={},t.additional.open_pe=intval(cur.openEditor),cur.openEditor||(t.additional.draft_photos=l.join(";")),delete cur.openEditor,showPhoto(_,e,extend(t,{queue:1}),o)})),showMediaProgress:function(e,t,o){if(I.onProgress&&!1===I.onProgress(e,t,o))return!1;var i=o.loaded/o.total,a=intval(100*i),l=(o.fileName||o.name||"").replace(/[&<>"']/g,""),s=l?t+"_"+l:t,r=l?l.length>33?l.substr(0,30)+"...":l:"",n=ge("upload"+s+"_progress");if(n){show(n);u=geByClass1("ui_progress_bar",n);setStyle(u,{width:a+"%"})}else{cur.attachMediaIndexes||(cur.attachMediaIndexes={}),cur.attachMediaIndexes[s]=N;var d=`\n          <div class="fl_l">\n            <div class="page_attach_progress_wrap" style="margin-top: 3px; margin-bottom: 4px;">\n              <div id="upload${s}_progress" class="page_attach_progress ui_progress">\n                <div class="ui_progress_back"></div>\n                <div class="ui_progress_bar"></div>\n              </div>\n            </div>\n          </div>\n          ${r?'<div class="attach_label fl_l">'+r+"</div>":""}\n          <div class="progress_x fl_l" onmouseover="animate(this, {opacity: 1}, 200);showTooltip(this, {text: '${getLang("dont_attach")}', shift: [16, 8, 8], black: 1})" onmouseout="animate(this, {opacity: 0.6}, 200);" onclick="Upload.terminateUpload(${t}, '${l||t}', this);"></div>\n          `;if(U){if(X.appendChild(ce("div",{id:"upload"+s+"_progress_wrap",innerHTML:d,className:"clear_fix upload_"+t+"_progress"},{marginTop:"6px"})),show(X),m.toggleLnk){var c=I.attachCount()<j;toggle(_,c),m.onToggleBlock&&m.onToggleBlock(c)}}else{var p=ce("div",{id:"upload"+s+"_progress_wrap",innerHTML:d,className:"clear_fix upload_"+t+"_progress"});I.chosenMedia="progress",I.singleAdded(p,"progress")}m.onChangedSize&&m.onChangedSize(),n=ge("upload"+s+"_progress");var u=geByClass1("ui_progress_bar",n);a?setStyle(u,{width:a+"%"}):(setStyle(u,{width:"1px"}),hide(n))}},hasVisibleRows:function(){var _=!1;return each(geByClass("media_preview",e),(function(){if(isVisible(this))return _=!0,!1})),_},attachCount:function(){if(I.attachedCount)return I.attachedCount();if(!e)return 0;if(!U)return e.childNodes.length-(I.postponePreview?1:0)-(I.markAsAds?1:0);var _=(K&&window.ThumbsEdit?(ThumbsEdit.cache()["thumbs_edit"+N]||{}).previews||[]:F.childNodes).length+H.childNodes.length+z.childNodes.length+V.childNodes.length/(V.sorter?2:1)+X.childNodes.length;return I.sharePreview&&++_,I.pollPreview&&++_,_},onMediaTypesInit(){var _={actionsEl:B,addMedia:I,onMediaChange:m.onMediaChange};I.types.forEach(e=>{var t=e[3],o=t&&t.onMediaTypeInit;o&&o(_)})},pollCreate:function(_){var e=_.poll_html;if(cur.addMedia[N].pollInputData=_,$)if(e){var t=`<div class="medadd_c" id="poll_dummy${N}">${e}</div>`;I.pollPreview=$.appendChild(domFC(cf(t)))}else stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")],()=>{var e=_.poll_question_length,t=_.question,o=_.lang,i=_[h],a=_.answers,l=_[P],s=_[D],r=_[M],d=_[v],c=_[f],p=_[C],u=_.poll_is_board,b=_.poll_is_edit,E=_.poll_is_not_posted,w=_.poll_backgrounds,g=_.poll_answers_limit||10,A=_.poll_no_animate_opening||_.question,L=_[T],B=`\n          <div class="medadd_h medadd_h_poll inl_bl">\n            ${o.question}\n            <span class="medadd_poll_question_warning"></span>\n          </div>\n          <input onkeydown="cur.addMedia[%lnkid%].pollKeydown(this, event)" oninput="cur.addMedia[%lnkid%].pollChangeQuestion(this)" maxlength="${e}" onkeyup="cur.addMedia[%lnkid%].pollKeyup(this, event)" class="text dark medadd_poll_question${u&&b?" disabled":""}"${u&&b?' readonly="readonly"':""} id="create_poll_question%lnkid%" value="%question%" />\n          <div class="medadd_h">${o.answers}</div>\n          <div class="medadd_poll_answers" id="create_poll_answers%lnkid%">\n            %answers%\n          </div>\n          ${u&&b?"":`<div class="medadd_poll_answer_add_wrap" id="create_poll_add%lnkid%">\n            <div class="medadd_poll_answer_add fakeinput dark" onclick="cur.addMedia[%lnkid%].pollAnswerAdd()">${o.answer_add}</div>\n          </div>`}\n          %backgrounds%\n          %settings%\n          <div class="checkbox medadd_datepicker_checkbox medadd_poll_cb%classuntil%" id="create_poll_until%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${o.until}</div>\n          <div class="medadd_datepicker">\n            <input type="text" class="medadd_datepicker_date dark" id="create_poll_untildate%lnkid%"/><div class="medadd_datepicker_at datepicker_at">${o.at}</div><input type="text" class="medadd_datepicker_time dark" id="create_poll_untiltime%lnkid%"/>\n          </div>\n          ${u?`\n          <div class="checkbox medadd_poll_cb%classonmain%" id="create_poll_onmain%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${o.add_to_main}</div>\n          `:""}\n          ${u&&b?`\n          <div class="checkbox medadd_poll_cb%classclosed%" id="create_poll_closed%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${o.close}</div>\n          `:""}\n        `,W=`\n          <div class="medadd_h">${o.settings}</div>\n          ${b&&!E||u?"":`<div class="checkbox medadd_poll_cb%classanon%" id="create_poll_anonymous%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${o.anonymous}</div>`}\n          ${b?"":`<div class="checkbox medadd_poll_cb%classmulty%" id="create_poll_multy%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${o.multy}</div>`}\n          ${b?"":`<div class="checkbox medadd_poll_cb%classdisableunvote%" id="create_poll_disable_unvote%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${o.disable_unvote}</div>`}\n        `,R=`\n          <div class="medadd_poll_answer_wrap">\n            <input onkeydown="cur.addMedia[%lnkid%].pollKeydown(this, event)" onkeyup="cur.addMedia[%lnkid%].pollKeyup(this, event)" class="text dark medadd_poll_answer${u&&b?" disabled":""}"${u&&b?' readonly="readonly"':""} %attrs%/>\n            <div class="page_media_x_wrap medadd_poll_answer_remove" data-title="${o.answer_remove}" aria-label="${o.answer_remove}" role="button" onmouseover="showTitle(this)" onclick="cur.addMedia[%lnkid%].pollAnswerRemove(this)">\n              <div class="page_media_x"></div>\n            </div>\n          </div>\n        `,y=`\n          <div class="medadd_h">${o.background}</div>\n          <div class="medadd_poll_backgrounds_wrap" id="create_poll_backgrounds_wrap%lnkid%">\n            <div class="medadd_poll_backgrounds_arrow_prev" onclick="cur.addMedia[%lnkid%].pollBackgroundsPaging('prev')"></div>\n            <div class="medadd_poll_backgrounds_arrow_next" onclick="cur.addMedia[%lnkid%].pollBackgroundsPaging('next')"></div>\n            <div class="medadd_poll_backgrounds" id="create_poll_backgrounds%lnkid%">\n              %backgrounds%\n            </div>\n          </div>\n        `;cur.addMedia[N].answersLimit=g,cur.addMedia[N].tplAnswer=R;var j="";u||(j+=cur.addMedia[N].pollBackgroundGetHtml(),w&&w.forEach(_=>{j+=cur.addMedia[N].pollBackgroundGetHtml(_)}),j+=rs('\n          <div class="medadd_poll_background medadd_poll_background_uploader" onclick="cur.addMedia[%lnkid%].pollBackgroundUpload(this);">\n            <div class="medadd_poll_background_preview"></div>\n          </div>\n        ',{lnkid:N}),j=rs(y,{lnkid:N,backgrounds:j}));var U="";if(!a||isArray(a)&&!a.length){var K=[];for(var k in _)if(_.hasOwnProperty(k)){var x="answers".length+1;if("answers["===k.substr(0,x)){var S=intval(k.slice(x,-1));K.push([S,_[k]])}}K.length?(a=[],K.sort((_,e)=>_[0]<0&&e[0]<0?_[0]<e[0]:_[0]>=0&&e[0]>=0?_[0]>e[0]:e[0]<0).forEach(_=>{a.push([_[0]<0?_[0]:0,_[1]])})):a=[[0,""],[0,""]]}a.forEach((_,e)=>{var t=O(_,2),o=t[0],i=t[1];U+=rs(R,{attrs:(o?` id="create_poll_ans${o}"`:"")+(i?` value="${clean(Object(n.unclean)(i))}"`:""),lnkid:N})}),I.pollPreview=$.appendChild(ce("div",{className:"medadd_c medadd_poll",innerHTML:rs(B,{lnkid:N,question:t?clean(Object(n.unclean)(t)):"",classuntil:c?" on":"",settings:rs(W,{lnkid:N,classanon:i?" on":"",classmulty:p?" on":"",classdisableunvote:L?" on":""}),backgrounds:j,answers:U,classonmain:l?" on":"",classclosed:s?" on":""})})),a.length==g&&hide("create_poll_add"+N);var F="create_poll_untildate"+N,H=new Datepicker(F,{time:"create_poll_untiltime"+N,width:157,noPast:!0,activePeriod:2592e6,minStep:1,date:c||Math.round(((new Date).getTime()+864e5)/1e3),onUpdate:()=>{var _=new Date,e=new Date(1e3*positive(val(F)));e.getTime()>=_.getTime()+2592e6&&(H.timePicker.hourDD.val(_.getHours()),e.getMinutes()>_.getMinutes()&&H.timePicker.minDD.val(_.getMinutes()),H.setDate(e.getFullYear(),e.getMonth()+1,e.getDate(),!0,_.getHours(),_.getMinutes())),cur.addMedia[N].pollChanged()}});if(cur.addMedia[N].pollBackgroundsPos=0,cur.addMedia[N].pollBackgroundSelect(d?-d:intval(r)),cur.addMedia[N].pollChangeQuestion(ge("create_poll_question"+N)),A)elfocus("create_poll_question"+N),m.onChangedSize&&m.onChangedSize(),cur.addMedia[N].pollUpdateArrows();else{I.pollPreview.style.position="absolute",I.pollPreview.style.visibility="hidden";var V=I.pollPreview.offsetHeight;I.pollPreview.style.height=0,I.pollPreview.style.position="",I.pollPreview.style.visibility="",animate(I.pollPreview,{height:V},m.mail?0:200,()=>{I.pollPreview.style.height="",elfocus("create_poll_question"+N),m.onChangedSize&&m.onChangedSize(),cur.addMedia[N].pollUpdateArrows()})}var q=ge("create_poll_backgrounds_wrap"+N);function G(){addEvent(q,browserFeatures.wheelEvent,cur.addMedia[N].pollMouseWheel)}function z(){removeEvent(q,browserFeatures.wheelEvent,cur.addMedia[N].pollMouseWheel)}addEvent(q,"mouseenter",G),addEvent(q,"mouseleave",z),cur.destroy.push((function(){removeEvent(q,browserFeatures.wheelEvent,cur.addMedia[N].pollMouseWheel),removeEvent(q,"mouseenter",G),removeEvent(q,"mouseleave",z)}))})},pollMouseWheel:function(_){cancelEvent(_);var e=Math.abs(_.deltaY)>Math.abs(_.deltaX)?_.deltaY:_.deltaX;cur.addMedia[N].pollBackgroundsPaging(e,!0)},pollBackgroundsPaging:function(_,e){var t=ge("create_poll_backgrounds_wrap"+N),o=ge("create_poll_backgrounds"+N),i=t.offsetWidth,a=cur.addMedia[N].pollBackgroundsPos;isNumeric(_)?a+=_:"next"===_?a+=i:a-=i,cur.addMedia[N].pollBackgroundsPos=Math.max(0,Math.min(a,o.scrollWidth-i)),e?removeClass(o,"animated"):addClass(o,"animated"),setStyle(o,"transform","translateX("+cur.addMedia[N].pollBackgroundsPos*(vk.rtl?1:-1)+"px)"),cur.addMedia[N].pollUpdateArrows()},pollUpdateArrows:function(){var _=ge("create_poll_backgrounds_wrap"+N),e=ge("create_poll_backgrounds"+N);if(_){var t=_.offsetWidth,o=e.scrollWidth-t;toggleClass(_,"medadd_poll_backgrounds_arrow_prev_disabled",0===cur.addMedia[N].pollBackgroundsPos),toggleClass(_,"medadd_poll_backgrounds_arrow_next_disabled",cur.addMedia[N].pollBackgroundsPos===o||o<=0)}},pollUntilGet:function(){var _=isChecked("create_poll_until"+N)?positive(val("create_poll_untildate"+N)):0;return Math.min(_,(new Date).getTime()+2592e6)},pollBackgroundChange:function(_,e){var t=gpeByClass("medadd_poll_backgrounds",_),o=geByClass1("medadd_poll_background_radio",_);geByClass("medadd_poll_background_radio",t).forEach(_=>{checkbox(_,_===o)}),cur.addMedia[N].pollChanged()},pollAnswerAdd:function(){var _=ge("create_poll_answers"+N),e=geByClass("medadd_poll_answer_wrap",_).length,t=cur.addMedia[N].answersLimit;if(e<t){var o=cf(rs(cur.addMedia[N].tplAnswer,{lnkid:N}));_.appendChild(o);var i=geByClass("medadd_poll_answer",_).pop();elfocus(i)}m.onChangedSize&&m.onChangedSize(),toggle("create_poll_add"+N,e<t-1)},pollAnswerRemove:function(_){_.tt&&_.tt.el&&_.tt.destroy(),re(domPN(_)),m.onChangedSize&&m.onChangedSize(),cur.addMedia[N].pollChanged(),show("create_poll_add"+N)},pollKeydown:function(_,e){if((e=e||window.event)&&(10==e.keyCode||e.keyCode==KEY.ENTER||e.keyCode==KEY.TAB)){var t=hasClass(_,"medadd_poll_question"),o=e.shiftKey;if(t&&o)return;var i=t?domFC(domNS(domNS(_))):(o?domPS:domNS)(domPN(_));return i?elfocus(geByTag1("input",i)):o?elfocus(geByClass1("medadd_poll_question",domPN(domPN(domPN(_))))):this.pollAnswerAdd(),cancelEvent(e)}},pollKeyup:function(_,e){(!(e=e||window.event)||10!=e.keyCode&&e.keyCode!=KEY.ENTER&&e.keyCode!=KEY.TAB)&&(cur.addMedia[N].pollChangedTimeout&&clearTimeout(cur.addMedia[N].pollChangedTimeout),cur.addMedia[N].pollChangedTimeout=setTimeout(()=>cur.addMedia[N].pollChanged(),100))},pollBackgroundGetHtml:function(_){var e="",t=O(_||[0],1)[0];if(t<0){var o=O(_,5),i=o[1],a=o[2],l=o[3],s=o[4];e=`\n          <div class="medadd_poll_background" onclick="cur.addMedia[${N}].pollBackgroundChange(this);">\n            <div class="medadd_poll_background_preview">\n              <div class="medadd_poll_background_preview_lines1"></div>\n              <div class="medadd_poll_background_preview_lines2"></div>\n              <div class="medadd_poll_background_photo" style="background: rgb(${a}, ${l}, ${s});">\n                <div class="medadd_poll_background_photo_holder">\n                  <div class="medadd_poll_background_photo_gradient" style="background: linear-gradient(0, rgba(${a}, ${l}, ${s}, 1) 0, rgba(${a}, ${l}, ${s}, 0) 50%)"></div>\n                  <img src="${i}" class="medadd_poll_background_photo_img"/>\n                </div>\n              </div>\n            </div>\n            <div class="medadd_poll_background_radio radiobtn" data-id="${t}" data-photo-r="${a}" data-photo-g="${l}" data-photo-b="${s}" data-photo-url="${i}"></div>\n          </div>\n        `}else{var r="",n="";if(t){var d=O(_,2)[1];if("gradient"===d){var c=O(_,4),p=c[2],u=c[3],b=[];u.forEach(_=>{var e=O(_,2),t=e[0],o=e[1];b.push(`#${o} ${Math.round(100*t)}%`)}),r=`background: linear-gradient(${p-90}deg, ${b.join(",")});"`}else if("tile"===d){var E=O(_,5),m=E[2],w=E[3];r=`background: url(${E[4]}) top center;background-size: ${m}px ${w}px;"`}}else n=" medadd_poll_background_default";e=`\n          <div class="medadd_poll_background${n}" onclick="cur.addMedia[${N}].pollBackgroundChange(this);">\n            <div class="medadd_poll_background_preview"${r?` style="${r}"`:""}>\n              <div class="medadd_poll_background_preview_lines1"></div>\n              <div class="medadd_poll_background_preview_lines2"></div>\n            </div>\n            <div class="medadd_poll_background_radio radiobtn" data-id="${t}"></div>\n          </div>\n        `}return e},pollBackgroundAdd:function(_){var e=ge("create_poll_backgrounds"+N),t=geByClass1("medadd_poll_background_uploader",e),o=cf(cur.addMedia[N].pollBackgroundGetHtml(_));o=domFC(o),e.insertBefore(o,t)},pollBackgroundSelect:function(_){var e=ge("create_poll_backgrounds"+N);if(e){var t=domQuery1(`.radiobtn[data-id="${_}"]`,e)||domQuery1('.radiobtn[data-id="0"]',e);if(t){var o=domPN(t);cur.addMedia[N].pollBackgroundsPos=(o.offsetLeft-e.offsetWidth/2+o.offsetWidth/2)*(vk.rtl?-1:1),cur.addMedia[N].pollBackgroundsPaging(0,!0),cur.addMedia[N].pollBackgroundChange(o)}}},pollBackgroundGet:function(){var _=domQuery1(`#create_poll_backgrounds${N} .radiobtn.on`);return intval(domData(_,"id"))},pollBackgroundUploaded:function(_,e,t){var o=-intval(_);cur.addMedia[N].pollBackgroundAdd([o,clean(e),intval(t.r),intval(t.g),intval(t.b)]),cur.addMedia[N].pollBackgroundSelect(o)},pollBackgroundUpload:function(){var _=cur.addMedia[N].pollInputData;showBox("al_page.php",{act:"owner_photo_box",oid:_&&_.poll_owner_id||(m.mail?cur.gid?-cur.gid:vk.id:cur.oid||vk.id),lnk_id:N,is_voting:1},{stat:["owner_photo.css",jsc("web/owner_photo.js")]})},pollChanged:function(){m.onMediaChange&&m.onMediaChange()},pollBackgroundsGet:function(){var _=cur.addMedia[N].pollInputData,e=[];_&&_.poll_backgrounds&&_.poll_backgrounds.forEach(_=>{O(_,1)[0]>0&&e.push(_)});var t=ge("create_poll_backgrounds"+N);return geByClass("radiobtn",t).forEach((function(_){var t=intval(domData(_,"id"));t&&t<0&&e.push([t,domData(_,"photo-url"),intval(domData(_,"photo-r")),intval(domData(_,"photo-g")),intval(domData(_,"photo-b"))])})),e},pollData:function(_,e){var t=cur.addMedia[N],i={};if(t&&ge("create_poll_question"+N)){for(var a=ge("create_poll_answers"+N),l=!1,s=0,r=domFC(a);r;r=domNS(r)){var n=trim(val(domFC(r)));if(n){var d=-intval((domFC(r).id.match(/^create_poll_ans(\d+)$/)||[0,-s++])[1]);i[`answers[${d}]`]=n,l=!0}}if(!l)return domFC(a)||t.pollAnswerAdd(),!0!==_&&Object(o.notaBene)(domFC(domFC(a))),!1;var c=trim(val("create_poll_question"+N));if(!c)return!0!==_&&Object(o.notaBene)("create_poll_question"+N),!1;i.question=c,i[f]=t.pollUntilGet();var p=t.pollBackgroundGet();if(p<0?(i[v]=-p,i[M]=0):p>=0&&(i[v]=0,i[M]=p),i[h]=isChecked("create_poll_anonymous"+N)?1:0,i[P]=isChecked("create_poll_onmain"+N)?1:0,i[D]=isChecked("create_poll_closed"+N)?1:0,i[C]=isChecked("create_poll_multy"+N)?1:0,i[T]=isChecked("create_poll_disable_unvote"+N)?1:0,t.pollInputData&&e){i.poll_backgrounds=t.pollBackgroundsGet();var u=["poll_is_board","poll_is_edit","poll_id","poll_answers_limit"];m.mail&&u.push("lang"),u.forEach(_=>{t.pollInputData[_]&&(i[_]=t.pollInputData[_])}),m.mail&&(i.poll_is_edited=0,i["answers[0]"]||i.question!=t.pollInputData.question?i.poll_is_edited=1:[h,P,D,C,f,v,M,T].forEach(_=>{intval(i[_])!==intval(t.pollInputData[_])&&(i.poll_is_edited=1)}),i.poll_is_edited||t.pollInputData.answers.forEach(_=>{var e=O(_,2),t=e[0],o=e[1];void 0!==i[`answers[${-t}]`]&&i[`answers[${-t}]`]==o||(i.poll_is_edited=1)}))}}else t&&ge("poll_dummy"+N)&&t.pollInputData&&t.pollInputData.poll_id&&(i.poll_id=t.pollInputData.poll_id);return i},pollChangeQuestion:function(_){var e=cur.addMedia[N].pollInputData,t=e.poll_question_length-_.value.length,o=geByClass1("medadd_poll_question_warning");o.innerHTML=t<=20?langNumeric(t,e.lang.question_length):""},markAsAdsInit(){var _=this.markAsAdsGetCheckboxEl();_&&attr(_,"onclick",`cur.addMedia[${this.lnkId}].markAsAdsChanged();`)},markAsAdsGetCheckboxEl:()=>!!L&&L.querySelector(".Post__markAsAdsButton"),markAsAdsData(_){var e=!!_&&{},t=this.markAsAds||isChecked(this.markAsAdsGetCheckboxEl());return!t&&this.chosenMedias&&(t=this.chosenMedias.some(_=>{if(isArray(_)&&"mark_as_ads"===O(_,1)[0])return!0})),(t||_)&&(e={mark_as_ads:t?1:0}),e},markAsAdsChanged(){var _=this.markAsAdsGetCheckboxEl();if(_&&!hasClass(_,"disabled")){checkbox(_),Wall&&Wall.togglePostMarkAsAds(_,_.dataset.muteId);var e=this.markAsAdsData(!0).mark_as_ads;I.copyrightToggle&&I.copyrightToggle(!e),I.donutUpdateVisibility(),m.onMediaChange&&m.onMediaChange()}},copyrightInit(){var _=this.copyrightGetBtnEl();_&&attr(_,"onclick",`cur.addMedia[${this.lnkId}].copyrightShowBox();`),this.markAsAdsData(!0).mark_as_ads&&this.copyrightToggle(!1)},copyrightToggle(_){var e=document.querySelector("#post_copyright_btn"+this.lnkId);toggle(e,_);var t=this.copyrightGetBtnEl();t&&(_?(this.copyrightData(!0).copyright?(val(t,getLang("wall_post_copyright_edit_button")),t.classList.add("Post__copyrightButton--added")):(val(t,getLang("wall_post_copyright_add_button")),t.classList.remove("Post__copyrightButton--added")),t.classList.remove("Post__copyrightButton--disabled")):(val(t,getLang("wall_post_copyright_add_button")),t.classList.remove("Post__copyrightButton--added"),t.classList.add("Post__copyrightButton--disabled")))},copyrightGetBtnEl:()=>!!L&&L.querySelector(".Post__copyrightButton"),copyrightCreate(_){if(this.copyrightInputData=_,B&&_&&_.copyright){var e="post_copyright_btn"+this.lnkId,t=document.querySelector("#"+e);if(!t){var o=getLang("wall_post_copyright_source_text");t=cf(`<div class="post_action_btn on" id="${e}" onclick="cur.addMedia[${this.lnkId}].copyrightShowBox();">\n              <div class="post_action_btn_layout">\n                <span class="post_action_btn_text" role="button" aria-label="${replaceEntities(o)}">${o}</span>\n              </div>\n             </div>`),B.appendChild(t)}}this.copyrightChanged()},copyrightRemove(){var _=document.querySelector("#post_copyright_btn"+this.lnkId);_&&_.parentNode.removeChild(_),this.copyrightInputData&&(this.copyrightInputData.copyright=""),this.copyrightChanged()},copyrightUnchoose(){this.chosenMedias&&this.chosenMedias.forEach((_,e)=>{isArray(_)&&"copyright"===_[0]&&this.unchooseMedia(e)}),this.multi||this.copyrightRemove()},copyrightBoxAccept(_){var e=_.btns.ok[0],t=document.querySelector(".PostCopyrightBox__input"),i=document.querySelector(".PostCopyrightBox__error");if(hide(i),!Object(o.isButtonLocked)(e)){var a=val(t);if(!a)return Object(o.notaBene)(t);ajax.post("al_wall.php",{act:"copyright_check_link",link:a},{onDone:()=>{this.copyrightInputData||(this.copyrightInputData={}),this.copyrightInputData.copyright=a,this.chooseMedia("copyright","",this.copyrightInputData),_.hide()},onFail:_=>(val(i,_),show(i),!0),showProgress:()=>Object(o.lockButton)(e),hideProgress:()=>Object(o.unlockButton)(e)})}},copyrightBoxDecline(_,e){e&&this.copyrightUnchoose(),_.hide()},copyrightShowBox(){showBox("al_wall.php",{act:"copyright_box"},{cache:!0,onDone:_=>{cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide();var e=this.copyrightData(!0);_.removeButtons(),e.copyright?(_.setOptions({width:400,title:getLang("wall_post_copyright_mb_title_text_edit")}),_.setButtons(getLang("wall_post_copyright_edit_button"),()=>this.copyrightBoxAccept(_),getLang("global_cancel"),()=>this.copyrightBoxDecline(_)),_.setControlsText(`<a onclick="cur.addMedia[${this.lnkId}].copyrightBoxDecline(curBox(), true);">${getLang("global_delete")}</a>`)):(_.setOptions({width:400,title:getLang("wall_post_copyright_mb_title_text")}),_.setButtons(getLang("wall_post_copyright_add_button"),()=>this.copyrightBoxAccept(_),getLang("global_cancel"),()=>this.copyrightBoxDecline(_)),_.setControlsText("")),_.show();var t=document.querySelector(".PostCopyrightBox__input");val(t,e.copyright?Object(n.unclean)(e.copyright):""),addEvent(t,"keypress",e=>Object(r.onEnter)(()=>{this.copyrightBoxAccept(_)},e)),t.focus()}})},copyrightChanged(){var _=this.markAsAdsData(!0).mark_as_ads;this.copyrightToggle(!_),m.onMediaChange&&m.onMediaChange()},copyrightData(_){var e=!!_&&{};return(this.copyrightInputData&&this.copyrightInputData.copyright||_)&&(e={copyright:this.copyrightInputData&&this.copyrightInputData.copyright||""}),e},urlsCancelled:[],shareData:{},checkMessageURLs:function(_,e,t){if(!(cur.noCheckMessageURLs||I.chosenMedia||I.urlAttachmentLoading&&I.urlAttachmentLoading[0]>vkNow()-1e4||I.attachCount()>=j)){if(cur.checkMessageHandler&&Object(b.isFunction)(cur.checkMessageHandler)&&cur.checkMessageHandler(_),cur.reply_to&&cur.reply_to[0]){var o=Wall.getReplyName(cur.reply_to[0]);if(o=o&&isArray(o)&&o[1]?o[1]:""){var i=extractUrls(o,e);for(var a in i)if(i.hasOwnProperty(a)){var l=i[a].url;l.match(/^https?:\/\//)||(l="http://"+l),inArray(l,I.urlsCancelled)||I.urlsCancelled.push(l)}}}var s=extractUrls(_,e).map((function(_){var e=_.url,t=_.query,o=_.domain,i=e,a={};e.match(/^https?:\/\//)||(e="http://"+e);var l=inArray(e,I.urlsCancelled)||inArray(i,I.urlsCancelled),s=!0,r=!1;l||o.match(/(^|\.|\/\/)(vkontakte\.ru|vk\.com)/i)&&(s=!!t.match(/(#photo|^\/(photo|video|album|page|audio|doc|mask|poll|podcast)|z=(album|photo|video|audio_playlist|podcast)|w=(page|product|poll))(-?\d+_)?\d+|app\d+(?:_-\d+)?|\.(jpg|png|gif)$|artist\/([^\/]+).*$|market-?\d+\?section=album_\d+|^\/stickers\/.+$|\?w\=story(\d+)_(\d+)$|stor(y|ies)(\d+)_(\d+)$|^(\/dev)?\/(blog|press)\/.+$|^\/jobs\?w=job\d+$|^\/landings\/.+$|^\/messenger$|^\/fellowship$|^\/talents$|^\/bestgames2016$|^\/play_safe_at_home$|^\/services$|^\/vk_apps_contest$|^\/home(\/.+)?$|^\/miniapps_2019$|^\/data_protection(\?section=(rules|requests|principles))?$|^\/safety(\?section=(social|parents|youth|tips|health))?$|^\/ads(\/([a-zA-Z0-9\_]+))?$|^http:\/\/instagram\.com\/p\/.+/),t.match(A)&&(s=!0),t.match(/narrative(-?\d+_\d+)/)&&(s=!0),t.match(/^(\/@[._a-zA-Z0-9-]+)([\?|\&]rev=[_a-z0-9]+|[\?|\&]anchor=[-a-zа-я0-9]+)*$/)&&(delete(a=nav.fromStr(e))[0],s=!0),!s&&t.match(/music\/album\/(-?\d+_\d+)(_[a-z0-9]+)?/)&&(s=!0,r=!1),!s&&t.match(/[a-zA-Z0-9_\.-]{2,32}/)&&(s=!0,r=!0));return _.url=e,_.canceled=l,_.valid=s,_.initialUrl=i,_.params=a,_.needsCheckDomain=r,_})).filter((function(_){return!_.canceled&&_.valid})).sort((function(_,e){return _.needsCheckDomain-e.needsCheckDomain}));if(s.length){var r=s[0];r.needsCheckDomain?I.checkURLDomain(r.query,r.initialUrl,t):I.checkURL(r.initialUrl,t,r.params)}}},checkURLDomain:function(_,e,t){cur.checkURLDomainTO&&clearTimeout(cur.checkURLDomainTO),cur.checkURLDomainTO=setTimeout(function(_,e,t){cur.checkURLDomainRequest=ajax.post("share.php",{act:"id_by_link",url:_,to_mail:m.mail},{onDone:function(_,o){(_||o)&&I.checkURL(e,t)},onFail:function(){return!0}})}.pbind(_,e,t),100)},clearCheckURL:function(){clearTimeout(cur.checkURLTO),re(I.urlAttachmentLoading[2]),U?toggle(X,X.childNodes>0):toggleClass(e,"med_no_attach",!e.childNodes),I.urlAttachmentLoading=!1,setStyle(bodyNode,{cursor:"default"})},onCheckURLDone:function(_,e,t){var o="";e=e||{},I.urlAttachmentLoading&&(o=I.urlAttachmentLoading[1],I.clearCheckURL()),_?I.chooseMedia(t[0],t[1],extend({},t[2],e),o,!0):((m.onCheckURLDone||function(){})(_,t),(e.onError||function(){})(t))},cancelCheckUrl:function(){re(I.checkURLForm)},_getShareTimeHash:function(){var _=cur.share_timehash||((cur.options||{}).share||{}).timehash||"",e=Math.floor(Date.now()/1e3),t=-1;return _&&(t=parseInt(_.split("_",1)[0])+36e3),t-e<60?Object(s.post)("share.php?act=renew_url_attachment_hash",{act:"renew_url_attachment_hash",hash:_}).then((function(_){var e=_[0];return cur.share_timehash=e,e})):Promise.resolve(_)},checkURL:function(_,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};_?this._getShareTimeHash().then((function(i){I.urlsCancelled.push(_),I.urlAttachmentLoading=[vkNow(),_],re(I.checkURLForm),I.checkURLForm=ce("div",{innerHTML:'<iframe name="share_parse_iframe'+N+'"></iframe>'}),utilsNode.appendChild(I.checkURLForm);var a=I.checkURLForm.appendChild(ce("form",{action:"share.php?act=url_attachment",method:"post",target:"share_parse_iframe"+N}));each(extend({hash:i,allowed_share_buttons:((cur.options||{}).share||{}).allowed_buttons||"",index:N,url:_,to_mail:m.mail?1:"",from:cur.module},t),(function(_,e){a.appendChild(ce("input",{type:"hidden",name:_,value:e}))})),setStyle(bodyNode,{cursor:"wait"}),window.onUploadDone=I.onCheckURLDone.pbind(!0,o),window.onUploadFail=I.onCheckURLDone.pbind(!1,o),e&&(cur.checkURLTO=setTimeout((function(){I.urlAttachmentLoading.length>0&&I.clearCheckURL()}),e)),a.submit()})):(o.onError||function(){})()},addPreview:function(_,e){var t=e?" medadd_c_link_hidden":"";return I.sharePreview=q.appendChild(ce("div",{className:"medadd_c medadd_c_link"+t,innerHTML:'<div class="medadd_c_linkcon"><div></div>'+(_?'<div class="medadd_c_linkprg">'+getProgressHtml("","medadd_c_linkprg_inner")+"</div>":"")+"</div>"}))},shareImgUrl:function(_){var e=I.shareData;if(isArray(e.preview_images)&&e.preview_images[_])return e.preview_images[_];if(e.images_proxy&&e.images_proxy[_])return e.images_proxy_url+e.images_proxy[_];if(e.images){var t=e.images[_];return isArray(t)&&(t=t[0]?t[0]:""),t}return""},initSnippetVideoFunctions:function(){cur.selectSnippetVideo=function(){var _={to_id:m.toId||cur.postTo,act:"a_choose_video_box",snippet_video:1};showBox("al_video.php",_,{cache:1,dark:1})},cur.chooseSnippetVideo=function(_,e){var t=I.shareData,o=_.split("_");t.video_owner_id=o[0],t.video_id=o[1],t.video_full_id=_,t.video=e;for(var i=!1,a=0,l=Object.keys(e.editable.sizes);a<l.length;a++){var s=l[a];(i&&e.editable.sizes[s][1]>e.editable.sizes[i][1]||!i)&&(i=s)}if(i){var r=e.editable.sizes[i];t.images[t.images.length-1]=[r[0],o[0],o[1],"video",e.editable.duration],cur.shareShowNext(0,1)}I.showVideoSnippetPreview()}},showPreview:function(_){var t,o,i=I.shareData,a=I.sharePreview||I.addPreview(),l=domFC(a);i.is_product?addClass(l,"medadd_c_link_product"):removeClass(l,"medadd_c_link_product"),toggleClass(l,"medadd_c_link_special",!!i.prometheus),"comment"!==m.from||i.is_vk_mini_app||(i.images=[]),!i.prometheus&&i.images&&(t=i.images[cur.shareShowImg],o=!(!I.bigLink&&!i.big_link||i.force_small_link));var s=!(!cur.options.share||!cur.options.share.allow_snippet_video),r=i.video&&s,d="",c={};if(i.failed)d=getLang("page_not_loaded");else if(i.prometheus)d="im"===cur.module?'<a target="_blank" href="'+i.url+'">'+i.title+"</a>":getTemplate("prometheus_snippet",{author_img:i.prometheus_author_image_url}),_=!0;else if(i.template){var p=i.template;p&&(d=getTemplate(p,i))}else{var u="",b=clean(I.shareImgUrl(cur.shareShowImg));if(s&&I.initSnippetVideoFunctions(),!b&&i.is_vk_mini_app&&i.images&&i.images[cur.shareShowImg]&&(b=i.images[cur.shareShowImg]),i.images&&i.images[cur.shareShowImg]&&b){var E=i.images[cur.shareShowImg];if(i.images.length>0){var O=!(!cur.options.share||!cur.options.share.allow_custom_photo),w=O&&!(cur.options.share&&cur.options.share.require_image),g="onmouseover=\"showTooltip(this, {text: '"+getLang("global_link_choose_own_photo")+"', black: 1, shift: [7, 11, 8], appendParentCls: 'post'})\"",h="onmouseover=\"showTooltip(this, {text: '"+getLang("global_link_choose_own_video")+"', black: 1, shift: [7, 11, 8], appendParentCls: 'post'})\"",P="onmouseover=\"showTooltip(this, {text: '"+getLang("global_link_remove_photo")+"', black: 1, shift: [7, 11, 8], appendParentCls: 'post'})\"",D=isArray(E)&&1==E.length,M=D&&!s,v=D&&s,f=i.media&&"_"!=i.media&&O?'<div class="medadd_c_linkimg_controls">  <div class="medadd_c_linkimg_controls_btn_group clear_fix fl_l">'+(i.images.length>1?'    <div class="medadd_c_linkimg_controls_btn_arrows_group">      <div class="medadd_c_linkimg_controls_btn" id="medadd_ctrl_left" onclick="cur.shareShowNext(true);"></div>      <div class="medadd_c_linkimg_controls_btn" id="medadd_ctrl_right" onclick="cur.shareShowNext();"></div>    </div>':"")+'    <div class="medadd_c_linkimg_controls_btn '+(i.images.length>1?"medadd_c_btn_side_padd":"")+'" id="medadd_ctrl_upload" '+g+" onclick=\"Page.ownerPhoto('"+i.media+"');\"></div>"+(s?'<div class="medadd_c_linkimg_controls_btn '+(i.images.length>1?"medadd_c_btn_side_padd":"")+'" id="medadd_ctrl_upload_video" '+h+' onclick="cur.selectSnippetVideo();"></div>':"")+"  </div>"+(w?'  <div class="medadd_c_linkimg_controls_btn_group clear_fix fl_r">    <div class="medadd_c_linkimg_controls_btn" id="medadd_ctrl_remove" '+P+' onclick="window.tooltips && window.tooltips.hide(this); cur.removeLinkImage(this)"></div>  </div>':"")+"</div>":"",C=(t?"":"display: none")+";background-image:url("+b+")";i.image_ratio>0&&(C+=";height: 0px; padding-top: "+100*i.image_ratio+"%;min-height: 0px;");var T="video"===E[3];u='<div class="medadd_c_linkimg_container '+(q&&q.offsetWidth>550?"medadd_c_linkimg_container_wide":"")+'" style="'+C+'">'+u+(T?'<div class="medadd_c_linkimg_container_video_overlay"></div>':"")+(T?'<div class="video_thumb_label"><span class="video_thumb_label_item"></span><span class="video_thumb_label_item">'+E[4]+"</span></div>":"")+(M?'<div class="medadd_c_linkimg_button"><button class="flat_button secondary_dark" onclick="Page.ownerPhoto(\''+i.media+"');\">"+getLang("global_link_choose_own_photo")+"</button></div>":"")+(v?'<div class="medadd_c_linkimg_button"><div class="medadd_c_linkimg_button_half_container"><button class="flat_button secondary_dark" onclick="Page.ownerPhoto(\''+i.media+"');\">"+getLang("global_link_choose_own_photo")+'</button></div><div class="medadd_c_linkimg_button_half_container"><button class="flat_button secondary_dark medadd_c_linkimg_video_button" onclick="cur.selectSnippetVideo();">'+getLang("global_link_choose_own_video")+"</button></div></div>":"")+f+'<div id="medadd_c_linkimg_loader" class="medadd_c_linkimg_loader">'+getProgressHtml("","inv medadd_c_linkimg_loader_inner")+"</div></div>"}}var A="";i.microdata&&i.microdata_preview_html&&(A=i.microdata_preview_html),c={title:{placeholder:'<span class="medadd_inline_placeholder">'+getLang("global_link_edit_title")+"</span>",editable:cur.options.share&&cur.options.share.allow_edit_title},description:{placeholder:'<span class="medadd_inline_placeholder">'+getLang("global_link_edit_desc")+"</span>",editable:cur.options.share&&cur.options.share.allow_edit_desc},url:{placeholder:'<span class="medadd_inline_placeholder">'+getLang("global_link_edit_url")+"</span>",editable:cur.options.share&&cur.options.share.allow_edit_url}};var L=i.shareButtons,B=L&&L.length&&L[0],W=i.button_text||B&&B[1],R=i.button_text_lang||B&&B[2],y=i.button_action||B&&B[0];if(L&&L.length&&R===W)for(var j=0;j<L.length;++j)if(L[j][0]===y&&L[j][2]===W){W=L[j][1];break}var U=!1;L&&L.length&&(U=L.length>1||R===W||B[0]!==y||B[1]!==W);var K=!!L&&L.length,k=cur.options.share&&cur.options.share.allow_remove_button&&!r;d=u+'<div class="medadd_c_linkwrap '+(u?"":"no_photo")+'"><div class="medadd_c_linkwrap_block">'+(i.title||c.title.editable?'<div class="medadd_c_linkhead '+(c.title.editable?"medadd_inline_editable":"")+'">'+(c.title.editable?'<div class="medadd_inline_editable_icon"></div>':"")+'<span class="medadd_inline_edit_target" data-max-length="'+(cur.options.share&&cur.options.share.max_title_len?cur.options.share.max_title_len:0)+'" data-field="title">'+(clean(i.title).replace(/\n/g,"<br>")||c.title.placeholder)+"</span></div>":"")+(A?'<div class="medadd_c_linkmicrodata">'+A+"</div>":"")+(i.domain||c.url.editable?`<div class="page_media_link_url medadd_c_linkaddr ${c.url.editable?"medadd_inline_editable":""}">${c.url.editable?'<div class="medadd_inline_editable_icon"></div>':""}<span class="medadd_inline_edit_target" data-max-length="2000" data-field="url" data-display-field="domain">${i.domain||"Url..."}</div>`:"")+"</div>"+(R&&K?'<div class="medadd_c_linkwrap_block medadd_c_linkwrap_block_button">'+(k?'<div class="hide_icon medadd_c_linkbtn_remove" onclick="cur.shareRemoveButton();" onmouseover="showTooltip(this, {text: \''+getLang("global_share_button_remove_tooltip")+"', black: 1, shift: [15, 10, 0]})\"></div>":"")+'<div class="wall_postlink_preview_btn medadd_c_linkbtn"><a onclick="cur.toggleShareButton(this);return false;" onmouseout="Page.actionsDropdownHide(domNS(this), 0, cur.setActiveShareButton.pbind(false))" onmouseover="Page.actionsDropdownUnhide()" class="flat_button"><span onmouseover="Page.actionsDropdownUnhide()" class="'+(U?"page_actions_dd_label":"")+' wall_postlink_preview_btn_label" data-field="button_text">'+R+"</span></a></div></div>":"")+'</div><div class="clear_fix"></div>'}if(o?addClass(l,"medadd_c_linkimg_big"):removeClass(l,"medadd_c_linkimg_big"),_)cur.preventShareAnim&&(cur.preventShareAnim.stop(),clearInterval(cur.animateUpdateInterval),m.onChangedSize&&m.onChangedSize()),val(l,d),l.style.height="auto",shortCurrency();else{show(q);var x=e.appendChild(ce("div",{innerHTML:'<div class="medadd_c_linkcon '+(o?"medadd_c_linkimg_big":"")+'">'+d+"</div>"},{position:"absolute",width:getSize(a)[0]-10,visibility:"hidden"})),S=getSize(x)[1];re(x),setStyle(l,{height:"0"}),setStyle(a,{overflow:"hidden"}),val(l,d),shortCurrency(),cur.animateUpdateInterval=setInterval((function(){m.onChangedSize&&m.onChangedSize()}),100),cur.preventShareAnim=animate(l,{height:S},200,(function(){setStyle(l,{height:"auto",display:""}),setStyle(a,{overflow:""}),clearInterval(cur.animateUpdateInterval),m.onChangedSize&&m.onChangedSize()})),re(geByClass1("medadd_c_linkprg",q))}function N(_){var e=new RegExp(/^([\w-]*:\/\/)|(tel:).*$/),t=new RegExp(/^(?:tel:)?(\+7|8)(\d{3})(\d{3})(\d{2})(\d{2})$/),o=new RegExp(/^(([a-zа-я0-9]|[a-zа-я0-9][a-zа-я0-9\-]*[a-zа-я0-9])\.)*([a-zа-я0-9]|[a-zа-я0-9][a-zа-я0-9\-]*[a-zа-я0-9])$/i),i=new RegExp(/^([\w-]*:\/\/)?([a-zа-я0-9\-]+(?:[\-\.]{1}[a-zа-я0-9\-]+)*\.[a-zа-я0-9\-]{2,22})(:[0-9]{1,5})?([\/\?\#].*)?$/i);if(!_||_.inlineEdit)return!1;var a=getSize(_),l=gpeByClass("medadd_inline_editable",_);_.inlineEdit=!0,addClass(l,"medadd_inline_editing"),removeClass(l,"medadd_inline_invalid");var s=ce("textarea",{className:"medadd_inline_edit"},{width:a[0],height:a[1]}),r=parseInt(_.getAttribute("data-max-length"));r&&s.setAttribute("maxlength",r);var d=_.getAttribute("data-field"),p=_.getAttribute("data-display-field");val(s,Object(n.unclean)(I.shareData[d])),val(_,""),_.appendChild(s);var u=ce("span",{className:"medadd_inline_edit_target"},{opacity:0,zIndex:-1,width:a[0],height:"auto",wordWrap:"break-all",position:"absolute"});l.appendChild(u);var b=a[1];if(elfocus(s),"url"===d){var E=I.shareData[d];t.test(E)&&val(s,Object(n.unclean)(E.replace("tel:",""))),s.onkeydown=function(_){32!==_.which&&32!==_.keyCode||_.preventDefault(),13!==_.which&&13!==_.keyCode||(_.preventDefault(),s.blur())},s.oninput=function(){var _=this;cur.editingPostUrlCleanTimeout&&clearTimeout(cur.editingPostUrlCleanTimeout),cur.editingPostUrlCleanTimeout=setTimeout((function(){_.value=_.value.replace(/[\n ]/g,"")}))}}s.onblur=function(){if(s.oninput=null,removeClass(l,"medadd_inline_editing"),re(u),clearTimeout(cur.editingPostUrlCleanTimeout),I.shareData[d]=val(s),"url"===d&&I.shareData[d])try{var a=I.shareData[d];if(t.test(a.replace(/[\h\s(\)-]/g,"")))a=a.replace(/[\h\s\(\)-]/g,""),I.shareData.domain=a.replace(t,"+7 ($2) $3-$4-$5"),I.shareData[d]=a.replace(t,"tel:+7$2$3$4$5");else{e.test(a)||(a="https://"+a);var r=new URL(a);if(!r.host||!o.test(r.host)||!i.test(a))throw new Error("Invalid url");if(t.test(Object(n.unclean)(I.shareData.domain).replace(/[\h\s\(\)-]/g,""))||o.test(I.shareData.domain)||I.shareData.domain===getLang("global_link_invalid_url")||I.shareData.domain===getLang("global_link_edit_url")){var b=a.match(i);I.shareData[d]=a.replace(i,"$1"+b[2].toLowerCase()+"$3$4"),I.shareData.domain=b[2].toLowerCase()}}}catch(_){addClass(l,"medadd_inline_invalid"),I.shareData.domain=getLang("global_link_invalid_url")}var E;"url"!==d||I.shareData[d]||(I.shareData.domain=getLang("global_link_edit_url")),E=p&&I.shareData[p]?I.shareData[p]:val(s),val(_,clean(E).replace(/\n/g,"<br>")||c[d].placeholder),_.inlineEdit=!1};var O=function(){var _=clean(val(s)+" M").replace(/\n/g,"<br>");val(u,_);var e=getSize(u);b!=e[1]&&(b=e[1],animate(s,{height:e[1]},200))};addEvent(s,"click keyup change",O),setTimeout(O,0)}if(c.title&&c.title.editable){var F=geByClass1("medadd_c_linkhead",l),H=geByClass1("medadd_inline_edit_target",F);F&&H&&(F.onclick=N.bind(this,H))}if(c.description&&c.description.editable){var V=geByClass1("medadd_inline_edit_target",geByClass1("medadd_c_linkdsc",l));V&&(V.onclick=N.bind(this,V))}if(c.url&&c.url.editable){var $=geByClass1("medadd_c_linkaddr",l),G=geByClass1("medadd_inline_edit_target",$);$&&G&&($.onclick=N.bind(this,G)),m.linkTooltip&&!cur.linkTooltip&&$&&(cur.linkTooltip=new ElementTooltip(m.linkTooltip.el($),m.linkTooltip.opts),m.linkTooltip.timeout?setTimeout(()=>cur.linkTooltip.show(),m.linkTooltip.timeout):cur.linkTooltip.show())}if(K&&(I.shareData.button_text=W,I.shareData.button_text_lang=R,I.shareData.button_action=y,U)){var z=domPN(geByClass1("wall_postlink_preview_btn_label",l)),Y=[],X=0,Q=0,Z=[];for(var j in L)if(L.hasOwnProperty(j)){var J=L[j];J[0]==y&&J[1]==W&&(X=Q),Y.push([Q++,J[1]]),Z.push('<a class="page_actions_item" tabindex="0" role="link" onclick="cur.updateShareButton(this);Page.actionsDropdownHide(domPN(domPN(this)), 1, cur.setActiveShareButton.pbind(false));return false;" data-button-text="'+J[1]+'" data-button-text-lang="'+J[2]+'" data-button-action="'+J[0]+'">'+J[2]+"</a>")}z.setAttribute("data-items",JSON.stringify(Y)),z.setAttribute("data-value",X);var __=['<div class="page_actions_wrap medadd_c_linkbtn_actions_wrap unshown" onmouseout="Page.actionsDropdownHide(this, 0, cur.setActiveShareButton.pbind(false))" onmouseover="Page.actionsDropdownUnhide()" onmouseup="setTimeout(function() { Page.actionsDropdownUnhide(); }, 5)">','<div class="page_actions_inner">',Z.join(""),"</div>","</div>"].join("");domPN(z).appendChild(se(__)),ls.get("share_button_text_tooltip_shown")||cur.buttonTextTooltip||setTimeout((function(){cur.closeButtonTextTooltip=function(){cur.buttonTextTooltip.hide(),ls.set("share_button_text_tooltip_shown",1)};var _=geByClass1("wall_postlink_preview_btn_label",l),e=domCA(_,".box_layout");cur.buttonTextTooltip=new ElementTooltip(_,{autoShow:!1,appendTo:e||geByTag1("body"),content:'<div class="feature_intro_tt_hide" onclick="cur.closeButtonTextTooltip();"></div>'+getLang("global_share_button_text_tooltip"),forceSide:"left",cls:"feature_intro_tt",offset:[-10,0,0],onHide:function(){cur.buttonTextTooltip.destroy()}}),cur.buttonTextTooltip.show(),addEvent(_,"mouseover",(function(){cur.buttonTextTooltip&&cur.buttonTextTooltip.hide()}))}),1e3)}},showVideoSnippetPreview:function(){if(!(!cur.options.share||!cur.options.share.allow_snippet_video)){var _=I.shareData,e=_.video,t=_.video_owner_id,o=_.video_id;e&&isObject(e)&&t&&o&&e.editable&&(I.initSnippetButtonFunctions(),I.showPreview())}},initSnippetButtonFunctions:function(){cur.shareRemoveButton=function(){var e=I.sharePreview;window.tooltips&&tooltips.destroyAll(e),re(geByClass1("medadd_c_linkwrap_block_button",e)),I.shareData.button_text="",I.shareData.button_text_lang="",I.shareData.button_action="",show(domByClass(_,"media_selector"))},cur.updateShareButton=function(_){var e=_.getAttribute("data-button-text"),t=_.getAttribute("data-button-text-lang"),o=_.getAttribute("data-button-action");I.shareData.button_text=e,I.shareData.button_text_lang=t,I.shareData.button_action=o;var i=I.sharePreview;return val(geByClass1("page_actions_header_inner",i),t),val(geByClass1("wall_postlink_preview_btn_label",i),t),!1},cur.setActiveShareButton=function(_){var e=I.sharePreview;(_?addClass:removeClass)(domPN(geByClass1("wall_postlink_preview_btn_label",e)),"active")},cur.toggleShareButton=function(_){hasClass(_,"active")?(Page.actionsDropdownHide(domNS(_),1),cur.setActiveShareButton(!1)):(Page.actionsDropdown(domNS(_)),cur.setActiveShareButton(!0))}},showExternalPreview:function(){var _=I.shareData;_.images||(_.images=[]);var e,t=[],o=[],i={};each(_.images,(function(e,a){i[a]||(i[a]=!0,t.push(a),_.images_proxy&&o.push(_.images_proxy[e]))})),_.uniqueImagesCount=t.length,_.images=t,_.images_proxy=o;var a=!(!cur.options.share||!cur.options.share.allow_snippet_video);if(e=q&&q.offsetWidth>550?isRetina()?"/images/post_snippet_image_placeholder_w_2x.png":"/images/post_snippet_image_placeholder_w.png":a?isRetina()?"/images/post_snippet_image_video_placeholder_2x.png":"/images/post_snippet_image_video_placeholder.png":isRetina()?"/images/post_snippet_image_placeholder_2x.png":"/images/post_snippet_image_placeholder.png",_.placeholder_inserted||(_.images.push([(cur.options.share||{}).allow_custom_photo?e:""]),_.placeholder_inserted=!0),!_.images||!_.images.length)return cur.shareShowImg=0,void I.showPreview();cur.shareShowImg=0,cur.shareShowImg--,I.addPreview(!0,!!_.map_data),_.imagesStyles={};var l=!1;cur.shareSetOwnPhoto=function(e){curBox()&&curBox().hide(),I.bigLink=!0,_.images[_.images.length-1]=[e.photo_url,e.user_id,e.photo_id],cur.shareShowNext(0,1)},cur.shareClearOwnPhoto=function(){_.images[_.images.length-1]=[],cur.shareShowNext(0,0,1)},cur.removeLinkImage=function(_){var e=gpeByClass("medadd_c_linkcon",_);addClass(e,"no_photo"),removeClass(e,"medadd_c_linkimg_big"),re(gpeByClass("medadd_c_linkimg_container",_)),setStyle(e,"height",""),I.shareData.noPhoto=!0},I.initSnippetButtonFunctions(),cur.shareShowNext=function(t,o,i){var a=vkImage();cur.prevShareShowDir=t,i||(o?cur.shareShowImg=_.images.length-1:t?cur.shareShowImg-=1:cur.shareShowImg+=1);var s=isArray(_.images[_.images.length-1])&&!!_.images[_.images.length-1][0];if(!s&&cur.shareShowImg>_.images.length-2)cur.shareShowImg=0;else if(cur.shareShowImg>_.images.length-1)cur.shareShowImg=0;else if(!s&&cur.shareShowImg<0)cur.shareShowImg=_.images.length-2;else if(cur.shareShowImg<0)cur.shareShowImg=_.images.length-1;else if(0==cur.shareShowImg)for(var r=1;r<_.images.length-1;r++){vkImage().src=I.shareImgUrl(r)}if(!_.images.length||isEmpty(_.images)||void 0===_.images[cur.shareShowImg])return I.showPreview(l),void(l=!0);var n=I.shareImgUrl(cur.shareShowImg);n&&(a.src=n),_.video=0,isArray(_.images[cur.shareShowImg])&&_.images[cur.shareShowImg][1]&&_.images[cur.shareShowImg][2]?"video"===_.images[cur.shareShowImg][3]?(_.video=1,_.video_owner_id=_.images[cur.shareShowImg][1],_.video_id=_.images[cur.shareShowImg][2]):(_.user_id=_.images[cur.shareShowImg][1],_.photo_id=_.images[cur.shareShowImg][2],_.share_own_image=!0):(_.user_id=void 0,_.photo_id=void 0,_.share_own_image=!1);var d=null;n&&(cur.imgLoadTimeout=d=setTimeout((function(){!0!==cur.shareImgInterval&&(isArray(_.images[cur.shareShowImg])||(_.images.splice(cur.shareShowImg,1),_.images_proxy&&_.images_proxy.length>cur.shareShowImg&&_.images_proxy.splice(cur.shareShowImg,1),cur.shareShowNext()))}),5e3));var c=setTimeout((function(){show("medadd_c_linkimg_loader"),c=null,m.onChangedSize&&m.onChangedSize()}),100);cur.showLoaderTimeout=c;var p=function(){if(a.width||a.height||!n){var t=a.width,o=a.height,i="",s="";if(d&&(clearTimeout(d),d=null),c&&(clearTimeout(c),c=null),hide("medadd_c_linkimg_loader"),clearInterval(cur.shareImgInterval),!isArray(_.images[cur.shareShowImg])&&(t<150||o<67)){if(_.images.splice(cur.shareShowImg,1),_.images_proxy&&_.images_proxy.length>cur.shareShowImg&&_.images_proxy.splice(cur.shareShowImg,1),_.images.length)return setTimeout(cur.shareShowNext.pbind(0,0,1),0)}else{var r=t>=532&&o>=235,p=(r||!!_.big_link)&&!_.force_small_link;if(cur.options.share&&cur.options.share.force_big_link&&!r){_.images.splice(cur.shareShowImg,1),_.images_proxy.splice(cur.shareShowImg,1);var u=(cur.options.share||{}).allow_custom_photo||(cur.options.share||{}).require_image;return 0==_.images.length&&u&&_.images.push([u?e:""]),cur.prevShareShowDir||cur.shareShowImg--,void cur.shareShowNext(cur.prevShareShowDir)}I.bigLink=p,p?i="width: 100%;":(t>150&&(o=150*o/t,t=150),i="width: "+t+"px; height: "+o+"px;")}_.images.length>1&&(s=""),_.imagesStyles[cur.shareShowImg]='style="'+i+'"'+s,I.showPreview(l),l=!0,m.onAddMediaChange&&m.onAddMediaChange("share",_.media,_)}};clearInterval(cur.shareImgInterval),cur.shareImgInterval=setInterval(p,300),cur.shareImgInterval2=setTimeout(p,0)},cur.shareShowNext()},uploadShare:function(_){var e=I.shareData,t=I.sharePreview,o=t.appendChild(ce("div",{innerHTML:'<iframe class="upload_frame" name="share_upload_iframe'+N+'"></iframe>'})),i=o.appendChild(ce("form",{action:"/share.php",method:"post",target:"share_upload_iframe"+N})),a=e.images[cur.shareShowImg];each({act:"a_photo",url:e.url,index:N,image:a,extra:e.extra||0,hash:vk.ip_h},(function(_,e){i.appendChild(ce("input",{type:"hidden",name:_,value:e}))})),window.onUploadDone=function(e,i){window.onUploadFail=window.onUploadDone=function(){},t.removeChild(o),I.shareData=extend(I.shareData,{user_id:i.user_id,photo_id:i.photo_id,photo_url:a}),setTimeout(_,0)},window.onUploadFail=function(e,i){window.onUploadFail=window.onUploadDone=function(){},t.removeChild(o),I.shareData.share_upload_failed=1,setTimeout(_,0)},cur.shareLastParseSubmitted=vkNow(),i.submit()},setupPostpone:function(_,t,o){var i;i=U||Y?Y:domPN(geByClass1("page_preview_postpone_wrap",e));var a=cur.editingPost&&"wpe_media_preview"==domPN(i).id,l=a||!U?"":"1px",s=!1,r=`<div class="clear_fix">\n        <div class="fl_l datepicker_item"><input type="hidden" id="postpone_date${N}" value="${_.date||""}" /></div>\n        <div class="fl_l datepicker_item medadd_c_timerat">${_.lang.profile_wall_postpone_at}</div>\n        <div class="fl_l datepicker_item"><input type="hidden" id="postpone_time${N}"/></div></div>`,n=void 0!==_.friends_only;cur.editingPost&&n?(r+='<div class="medadd_c_timersett">',I.visibilityAddSelect(_),s=!0):cur.editingPost&&t&&(r+=t,s=!0),x||(I.postponePreview=i.appendChild(ce("div",{className:"medadd_c medadd_c_timer clear_fix"+(s?" medadd_c_nofixed":"")+(x?" timer_in_tt":""),innerHTML:r}))),x&&(I.postponeSubmitWrapper=se(`<div><input type="hidden" id="postpone_date${N}" value="${_.date||""}"><input type="hidden" id="postpone_time${N}"></div>`),i.appendChild(I.postponeSubmitWrapper)),x||(I.postponePreview.style.height=l);var d="datepicker-inline-container_"+N,c=`<button class='flat_button reset_time_btn secondary' onclick='cur.addMedia[${N}].onResetPostponeBtnClick()'>${getLang("wall_post_timer_reset")}</button>`,p=`<td class="cal_clear" id="${d}" colspan="7">${c}</td>`;stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")],(function(){I.postponeDatepicker=new Datepicker("postpone_date"+N,{time:"postpone_time"+N,width:155,noPast:!0,minStep:1,sideTop:cur.oid<0,sideTopOffset:10,inlineTime:x,inlineTimeContainerId:d,inlineTimeContainerIdx:N,addRows:x?"<tr>"+p+"</tr>":null,addRowsM:x?'<tr><td class="cal_clear" colspan="7"></td></tr>':null,onUpdate:function(_,e){var t=[...arguments];m.onMediaChange&&m.onMediaChange.apply(m,t),I.postponeDate=val("postpone_date"+I.lnkId),x&&I.updatePostponeBtnText()},hideAnotherMonth:!1}),a||!U||x||animate(I.postponePreview,{height:33},200,(function(){I.postponePreview.style.height=""})),I.menu.postponeBtn&&I.updatePostponeBtnText(),Object(b.isFunction)(o)&&o()}))},getPostponeDateString:function(_){if(val("postpone_date"+I.lnkId)||_){_=(_=_||+val("postpone_date"+I.lnkId))+(60*(new Date).getTimezoneOffset()+intval(vk.tz))+intval(vk.dt);var e=getLang("datepicker_dateFormat");"dateFormat"===e&&(e="{day} {month} {year}");var t=new Date(1e3*_),o=t.getDate(),i=t.getMonth()+1,a=t.getFullYear();return e.replace("{day}",o).replace("{month}",winToUtf(getLang("Month"+i+"_of"))).replace("{year}",a)+` ${getLang("profile_wall_postpone_at")} `+`${t.getHours()}:${("0"+t.getMinutes()).slice(-2)}`}},onResetPostponeBtnClick(){cur["postPostponeTT"+I.lnkId].hide(),null!=I.postponeInd&&setTimeout(()=>{I.unchooseMedia(I.postponeInd)},ElementTooltip.FADE_SPEED),cancelEvent(event)},resetPostpone:function(_){if(_){_=_+(60*(new Date).getTimezoneOffset()+intval(vk.tz))+intval(vk.dt);var e=new Date(1e3*_);if(e){var t=e.getDate(),o=e.getMonth()+1,i=e.getFullYear(),a=e.getHours(),l=e.getMinutes();I.postponeDatepicker.timePicker.hourDD.val(a),I.postponeDatepicker.timePicker.minDD.val(l),I.postponeDatepicker.setDate(i,o,t,null,a,l)}}},updatePostponeBtnText:function(_,e){if(x){var t=geByClass1("post_action_btn_text",I.menu.postponeBtn),o="";if(_)o=getLang("wall_publication_now");else{var i=I.getPostponeDateString(e);if(!i)return;o=i}t.innerHTML=o,t.setAttribute("aria-label",replaceEntities(o))}},createPrettyCards:function(_){cur.lang=extend(cur.lang||{},_.lang||{});var e=se(_.editor.container_html);q.appendChild(e),I.prettyCardGallery=new PrettyCardGallery(e,_.editor,_.pretty_cards)},visibilityAddSelect:function(_){var e,t=!1;_.friends_only?(t=!0,e="name_friends_only"):e="name_no_friends_only";var o=se(getTemplate("visibility_access",{link_id:N}));toggleClass(o,"on",t);var i=geByClass1(e,o),a="post_visibility_btn",l=+domData(i,"value"),s=geByClass1("post_action_btn_text",o),r=val(i);if(val(s,r),attr(s,"aria-label",r),o){var n=geByClass1("post_action_btn",B);n?B.insertBefore(o,n):B.appendChild(o),Wall.createPostTooltip(a,N)}radiobtn(i,l,"post_settings_btn"+a+N)},donutVisibilityAddSelect(_){var e=Object(p.donutVisibilityInit)(_);e&&e.donutPostSettings&&(I.donutPostSettings=e.donutPostSettings)},donutUpdateVisibility(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;I.donutPostSettings&&I.donutPostSettings.donutUpdateVisibility(_)},destroy:function(){(V||{}).sorter&&V.sorter.destroy();for(var t=0;t<S.handlersToClean.length;t++)S.handlersToClean[t]();(H||{}).qsorter&&H.qsorter.destroy(),removeClass(e,"media_preview_has_medias"),e&&(e.innerHTML=""),show(_)},qsorterOpts:function(){return{xsize:Math.floor(H.offsetWidth/135),width:135,height:102,onReorder:m.onAddMediaChange,clsUp:"pam_dpic_up"}},resized:function(){window.ThumbsEdit&&ThumbsEdit.setWide("thumbs_edit"+cur.wallEditComposer.addMedia.lnkId),H.qsorter&&(H.qsorter.destroy(),window.qsorter.init(H,I.qsorterOpts()))}}).copyrightInit(),I.markAsAdsInit(),I.onMediaTypesInit(),cur.addMedia||(cur.addMedia={}),cur.addMedia[N]=I,m.onAddMediaChange&&(I.onChange=m.onAddMediaChange),I}}},vkK6:function(_,e,t){"use strict";t.r(e),t.d(e,"getActionData",(function(){return i}));var o=t("ZD4m"),i=function(_){var e=Object(o.getJsonDataValue)(_,"data-action-params");if("object"==typeof e||null===e)return{actionParams:e}}}});