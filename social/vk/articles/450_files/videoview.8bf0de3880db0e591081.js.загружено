(()=>{"use strict";var __webpack_modules__={951558:(e,i,o)=>{var t=o(667294),a=o(973935),r=o(40897),d=o(255906),n=o(485048),s=o(225046),_=o(616515),l=o(354108),v=o(642139),c=o(288183);window.Videoview=window.videoview=n.default,window.VideoPlaylist=s.default,window.VideoChat=_.default,window.VideoInitializer=l.default,window.VideoDonate=v.default,window.VideoLiveBlacklistBox=c.default,(0,r.registerReactApplication)("AnonymShortVideoStub",(e=>{a.render(t.createElement(d.ShortVideoStub,e),document.getElementById(`${r.rootId}AnonymShortVideoStub`))}));try{stManager.done("videoview.js")}catch(e){}},218549:(e,i,o)=>{o.d(i,{default:()=>r});var t,a=o(705456);const r={routeStream(e,i,o,a,r){var d=new MessageBox({title:"Привязать/отвязать Kive сервер"}),n="<b> Внимание, действие будет выполнено для: </b> <br> OwnerId = "+e+"<br>UserId = "+i+"<br><br>";switch(t&&(a="bind_kive_worker"===t?"unbind_kive_worker":"bind_kive_worker"),a){case"bind_kive_worker":d.content(n+'<input id="server_num" placeholder="Kive сервер"> </input>'),d.removeButtons(),d.addButton("Привязать",(t=>{var n=document.getElementById("server_num").value;this.bindKiveWorker(e,i,o,n,a,d,t,r)})),d.show();break;case"unbind_kive_worker":d.content(n),d.addButton("Отвязать",(t=>{this.unbindKiveWorker(e,i,o,a,d,t,r)})),d.show();break;default:d.hide()}},forceStartStream(e,i,o,t){var r=new MessageBox({title:"Перенести трансляцию"});r.content('<input id="source_video_id" placeholder="Исходный video_id"> </input>'),r.addButton("Перенести",(d=>{var n=document.getElementById("source_video_id").value;ajax.post("al_video.php",{act:"admin_action",action:"force_start_stream",owner_id:e,user_id:i,video_id:o,src_video_id:n,hash:t},{onDone:function(e){r.hide();var i=new MessageBox({title:"Статус операции"});i.content(e),i.show()},onFail:function(e){r.hide();var i=new MessageBox({title:"Статус операции"});i.content(e),i.show()},showProgress:a.lockButton.pbind(d),hideProgress:a.unlockButton.pbind(d)})})),r.show()},bindKiveWorker(e,i,o,r,d,n,s,_){ajax.post("al_video.php",{act:"admin_action",action:"bind_kive_worker",owner_id:e,user_id:i,server_num:r,hash:o},{onDone:function(e){n.hide();var i=new MessageBox({title:"Статус операции"});i.content(e),i.show(),t=d,val(_,"Отвязать Kive сервер")},onFail:function(e){n.hide();var i=new MessageBox({title:"Статус операции"});i.content(e),i.show()},showProgress:a.lockButton.pbind(s),hideProgress:a.unlockButton.pbind(s)})},unbindKiveWorker(e,i,o,r,d,n,s){ajax.post("al_video.php",{act:"admin_action",action:"unbind_kive_worker",owner_id:e,user_id:i,hash:o},{onDone:function(e){d.hide();var i=new MessageBox({title:"Статус операции"});i.content(e),i.show(),t=r,val(s,"Привязать Kive сервер")},onFail:function(e){d.hide();var i=new MessageBox({title:"Статус операции"});i.content(e),i.show()},showProgress:a.lockButton.pbind(n),hideProgress:a.unlockButton.pbind(n)})}}},848512:(e,i,o)=>{o.d(i,{default:()=>a});o(66108),o(296253);var t=o(705456);const a={action(e,i,o){if("moder_log"===i)this.showModerLogBox();else if("moder_audio_log"===i)this.showModerLogBox(!0);else if("region_mask"===i)this.showRegionMaskBox();else if("partner_ads_settings"===i)this.showPartnerAdsSettingsBox();else{var a=extend({owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,action:i,hash:o},JSON.parse(domData(e,"params")));ajax.post("al_video.php?act=moder_action",a,{showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){showProgress(e),(0,t.disableEl)(e)})),hideProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){(0,t.enableEl)(e),hideProgress(e)})),onDone:function(i,o,a){i&&val(e,i),o&&domData(e,"params",o),a&&(0,t.lockLink)(e)}})}},pin(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=domByClass("mv_moder_buttons","_ui_menu_wrap"),t=domByClass(o,"ui_actions_menu"),a=domByClass("mv_moder_buttons","mv_moder_buttons_pin"),r=e?ls.get("video_moder_actions_pinned"):i?domData(a,"pinned"):!domData(a,"pinned");val(a,r?"Unpin":"Pin"),i&&!e||(r?(domData(a,"pinned",1),ls.set("video_moder_actions_pinned",1)):(domData(a,"pinned",null),ls.remove("video_moder_actions_pinned")));var d=domByClass("mv_moder_buttons","mv_moder_buttons_to_down"),n=e?ls.get("video_moder_actions_downed"):i?!domData(a,"downed"):domData(a,"downed");val(d,n?"To up":"To down"),(i||e)&&(n?(domData(a,"downed",1),ls.set("video_moder_actions_downed",1)):(domData(a,"downed",null),ls.remove("video_moder_actions_downed")),uiActionsMenu.hide(o),(i||e&&!n)&&setTimeout((()=>{for(var i=1;i<t.children.length;i++)t.insertBefore(t.children[i],t.firstChild);e||uiActionsMenu.show(o,!1,{alwaysTop:!n})}),250)),setStyle(o,"margin-top","50px"),r?(o.onmouseenter=o.onmouseleave=null,uiActionsMenu.show(o,!1,{alwaysTop:!n})):(o.onmouseenter=function(){uiActionsMenu.show(this,!1,{alwaysTop:!n})},o.onmouseleave=function(){uiActionsMenu.hide(this)})},showModerLogBox(){showBox(`al_video.php?act=${arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"moder_audio_log_box":"moder_log_box"}`,{video_raw:mvcur.videoRaw},{params:{width:600}})},showRegionMaskBox(){var e,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t={},a=o?0:mvcur.videoRaw;function r(e){var i=e.currentTarget;checkbox(i)}function d(){each(t,((i,o)=>{checkbox(o,inArray(i,e))}))}function n(){each(t,((e,i)=>{checkbox(i,!1)}))}return showBox("al_video.php?act=region_mask_box",{video:a,owner_id:o},{onDone(s,_){e=_.countries_cis,i=_.save_hash;var l="";each(_.countries,((e,i)=>{l+=`<div class="checkbox ${i?"on":""}" style="display:inline-block;width:20%;" data-value="${e}">${e}</div>`})),l+='\n          <br><br>\n          <button class="flat_button button_small secondary _check_cis_only" style="margin-right:10px">Только СНГ</button>\n          <button class="flat_button button_small secondary _uncheck_all">Убрать ограничения</button>\n        ',s.content(l),geByClass("checkbox",s.bodyNode).forEach((e=>{var i=domData(e,"value");t[i]=e,e.onclick=r})),domByClass(s.bodyNode,"_check_cis_only").onclick=d,domByClass(s.bodyNode,"_uncheck_all").onclick=n,s.removeButtons(),s.addButton(getLang("global_save"),(()=>{var e,r;e=o&&!a,r=[],each(t,((e,i)=>{isChecked(i)&&r.push(e)})),e?ajax.post("al_video.php?act=owner_geo_restriction_save",{owner_id:o,countries:r.join(","),hash:i},{onDone:function(e,i){var o=curBox();o.content(e),i&&(geByClass1("owner_info_row_value",ge("video_geo_restriction")).innerHTML=i),o.removeButtons(),o.addButton(getLang("box_close"),o.hide,"yes"),setTimeout(o.hide,1500)}}):ajax.post("al_video.php?act=region_mask_save",{video:a,countries:r.join(","),hash:i},{onDone(){curBox().hide()}})}))}}),!1},showPartnerAdsSettingsBox(){showBox("al_video.php?act=partner_ads_settings_box",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid},{stat:[jsc("internal/VideoPartnerAdsSettings.js"),"internal/VideoPartnerAdsSettings.css"],onDone:()=>{curBox().setOptions({hideButtons:!0})}})}}},513750:(e,i,o)=>{o.d(i,{default:()=>t});o(751876),o(59357);const t={resize:function(e,i){},debugLog(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];i.unshift("video player:"),debugLog.apply(null,i)},fullscreen(e){Videoview.isFS=e,Videoview.updateExternalVideoFinishBlock(),cur.storyLayer?toggleClass(cur.storyLayer.layerEl,"_fullscreen",e):window.mvLayer&&toggleClass(mvLayer,"mv_layer--fullscreen",e)},incViewCounter(e,i,o,t,a,r,d){var n={oid:e,vid:i,hash:o,curr_res:t,max_res:a,player:r||"flash",type:d,module:Videoview.getVideoModule(e+"_"+i)};if(cur.videoSearchStats){var s=parseInt(cur.videoSearchPos);isNaN(s)||(n.search_pos=s,cur.videoSearchStats.positions[s]=extend({viewStarted:0},cur.videoSearchStats.positions[s]),cur.videoSearchStats.positions[s].viewStarted++),cur.videoSearchStats.totalViews++}ajax.post("al_video.php?act=inc_view_counter",n)},rotateVideo(e,i,o,t){ajax.post("al_video.php?act=rotate_video",{oid:e,vid:i,angle:o,hash:t})},onVideoNext(e,i,o){setTimeout((function(){var t=0;i||e?i&&o?t=5:i&&!o?t=6:e&&(t=7):t=4,Videoview.sendPlayerStats(t,0),VideoPlaylist.getBlock()?e&&!i?VideoPlaylist.showVideo(e):VideoPlaylist.nextVideo():showVideo(e,"",{autoplay:1,module:Videoview.getVideoModule(e)})}),0)},fetchSuggestions(e,i){if(e){var o=Videoview.getMvData(),t=o.videoRaw;ajax.post("al_video.php?act=fetch_player_suggestions",{oid:o.oid,vid:o.vid,videos:e,prepend_current:i?1:0},{onDone:function(e){var i=Videoview.getMvData();if(i&&i.videoRaw==t){i.playerSuggestions=e;var o=cur.videoInlinePlayer||window.mvcur&&mvcur.player||cur.player;o&&o.setSuggestions(e)}}})}},setSuggestions(e){Videoview.playerCallback.fetchSuggestions(e)},onSuggestionsShown(e,i,o){var t=o?16:e?14:12;if(Videoview.sendPlayerStats(t,0),e){var a=Videoview.getMvData(),r="";each(a.playerSuggestions,((e,o)=>{o.vid!=i&&(r+="&vid="+o.vid)})),vkImage().src="//go.imgsmail.ru/vk?pxn=vs&qid="+e+r}},onSuggestionClick(e,i,o,t,a){var r=a?15:i?13:11;Videoview.sendPlayerStats(r,0);var d=Videoview.getVideoModule(e);cur.is_showcase&&(d+=":similar"),showVideo(e,"",{autoplay:1,module:d,addParams:{suggestions_qid:i}}),i&&(vkImage().src="//go.imgsmail.ru/vk?pxn=vic&qid="+i+"&vid="+e+"&p="+o+"&t="+t)},onSuggestionQuarterWatched(e,i,o){vkImage().src="//go.imgsmail.ru/vk?pxn=vt25&qid="+e+"&vid="+i+"&t="+o},onSuggestionsReplayClicked:function(){Videoview.sendPlayerStats(17,0)},onOpenInPopup(e,i,o){Videoview.sendPlayerStats(8,0);var t=cur.videoInlinePlayer&&cur.videoInlinePlayer.canExpand()?cur.videoInlinePlayer:null,a=t&&t.vars&&t.vars.short_video,r=window._videoLastInlined?domData(domClosest("post",window._videoLastInlined[1]),"post-id"):null,d=window._videoLastInlined?domData(window._videoLastInlined[1],"playlist"):null;showVideo(e,i,{shortVideo:a,expandPlayer:t,playlistId:d,autoplay:1,addParams:{t:o,post_id:r},openInPopup:!0})},onVideoAdEvent(e,i,o,t,a,r,d,n,s){if(o){cur._vadStatQueue=cur._vadStatQueue||{},cur._vadStatQueue[e+"_"+i]=cur._vadStatQueue[e+"_"+i]||{type:"",events:[]};var _=cur._vadStatQueue[e+"_"+i];_.type=a,_.events.push(t),_.pl_type=d,_.app_version=n,_.media_provider=s,clearTimeout(cur._vadStatTimer),cur._vadStatTimer=setTimeout(Videoview.sendVideoAdStat.bind(Videoview,e,i,o),1e3)}},onVideoAdShown(e,i,o,t){ajax.post("al_video.php?act=ad_event",{oid:e,vid:i,type:o,event:t})},onVideoResolutionChanged(e,i,o,t){var a=Videoview.getMvData();a&&(a.resolution=t)},onInitialized(){Videoview.isLayerShown()&&(VideoPlaylist.toggle(!VideoPlaylist.isCollapsed()),mvcur.options&&mvcur.options.focusPlay&&("visible"==document.visibilityState?Videoview.togglePlay(!0):"hidden"==document.visibilityState&&addEvent(window,"focus",(function e(){Videoview.togglePlay(!0),removeEvent(window,"focus",e)}))));var e=window.mvcur&&mvcur.player&&mvcur.player.el||ge("video_player");e&&e.focus()},onVideoPlayProgress(e,i,o,t,a){var r=e+"_"+i;t<5e3&&cur.tnsStart!=r?cur.tnsStart=r:t>a/2&&cur.tnsEnd!=r&&(cur.tnsEnd=r),window.mvcur&&mvcur.adData&&(mvcur.adData.stat_link_start&&!mvcur.adData.view_complete_start&&t>=5e3&&(ajax.post(mvcur.adData.stat_link_start,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_start=!0),mvcur.adData.stat_link_half&&!mvcur.adData.view_complete_half&&t>=a/2&&(ajax.post(mvcur.adData.stat_link_half,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_half=!0),mvcur.adData.stat_link_full&&!mvcur.adData.view_complete_full&&t>=.9*a&&(ajax.post(mvcur.adData.stat_link_full,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_full=!0))},onPlayerTouchedByUser(){window._videoLastInlined&&removeClass(window._videoLastInlined[1],"page_video_autoplayable")},onVideoStreamPlaying(e,i){var o=Videoview.getPlayerObject();if(!(o&&o.isAutoplay&&o.isAutoplay())){window.Notifier&&setTimeout((function(){Notifier.lcSend("video_start")}),0);var t=window.ap;t&&t.isPlaying()&&(t.pause(),t.pausedByVideo=Date.now())}},onVideoPlayStarted(e,i,o,t,a,r,d,n){var s=Videoview.getMvData(),_=Videoview.getVideoModule(e+"_"+i),l=cur.videoInlinePlayer&&cur.videoInlinePlayer.isAutoplay(),v="";if(window.Video&&Video.isInCatalog()){var c=window._videoLastInlined?domData(window._videoLastInlined[1],"playlist"):mvcur.options.playlistId,m=c?c.replace("cat_",""):"";v=Videocat.isTop3Playlist(m)?"featured":m}if(window.mvcur&&(mvcur.viewStartedTimestamp=Date.now()),ajax.post("al_video.php?act=video_view_started",{oid:e,vid:i,hash:o,module:_,videocat:v,quality:s?s.resolution:0,autoplay:l?1:0,inline:-1,player_view_type:Videoview.getLayoutType(),ov_id:r,app_version:d,media_provider:n},{}),l&&cur.videoAutoplayStat&&cur.videoAutoplayStat.video==e+"_"+i&&!a&&ajax.post("al_video.php?act=autoplay_stat",{event:"start",start_time:vkNow()-cur.videoAutoplayStat.launched,preloaded:cur.videoAutoplayStat.preloaded?1:0,streaming_method:t,module:Videoview.getVideoModule()},{}),s)switch(s.l_type){case 1:vkImage().src="//vk.com/rtrg?r=JQ6ueUeOxlSLb8IoA8ToayylOLgRkThaoFV0XVgG5qvS1x1xWrkfqAg73sYWJxwq9PXWucKtMS02J3CsGLZdmOMNj9dv9UCjDN4a3ShJZXcJFMhgfVwSoPWoxp*Y/LAFUnKz5*XBvDCQXeaygAqI*gY9gz*jWTXaOXyT2lSfIPY-";break;case 2:vkImage().src="//vk.com/rtrg?r=lD4OYmfC8ehvdc/8TL9AsAjM956qNaHyj20XV5mCNiTgYKQ6X*IXgwE8VbgqOf7rdbLJq7uCRBrdnFPTcUU2NjMgy8x4y6NWrYVwQMteNWh62XnLoNVZqobnsMMGm1OyTW09rhEkmiX5jqk3CI3JIIYbIbd8K7EC0ytQ4Kp4Kro-"}-33118207==e||-78630688==e?vkImage().src="//rs.mail.ru/d23694799.gif":-68420747==e||-121650415==e?vkImage().src="//rs.mail.ru/d25688137.gif":-18479452==e&&(vkImage().src="//rs.mail.ru/d25688115.gif")},onVideoPlayFinished(){window.mvcur&&mvcur.mvShown&&(mvcur.finished=!0,mvcur.mousemoved=!0,Videoview.moveCheck(),Videoview.logViewedPercentage()),window.mvcur&&mvcur.mvShown&&mvcur.adData&&(mvcur.adData.stat_link_start&&!mvcur.adData.view_complete_start&&(ajax.post(mvcur.adData.stat_link_start,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_start=!0),mvcur.adData.stat_link_half&&!mvcur.adData.view_complete_half&&(ajax.post(mvcur.adData.stat_link_half,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_half=!0),mvcur.adData.stat_link_full&&!mvcur.adData.view_complete_full&&(ajax.post(mvcur.adData.stat_link_full,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_full=!0))},onVideoPlayError(){Videoview.isLayerShown()&&re("mv_live_gifts_block")},onVideoAdsLoadStarted(){},onVideoAdsPlayStarted(){},onVideoAdsPlayFinished(){},onViewSegmentsChanged(e,i,o,t){if(o&&!cur.segmentsSaveProcess){var a="vsegs"+vk.id+"_"+e+"_"+i,r=ls.get(a);r&&r.ts&&vkNow()-r.ts>864e5&&(r=null,ls.remove(a));var d=r&&r.segments?r.segments.split("|")[2]:"";if(!d||o!=d){cur.segmentsSaveProcess=!0;var n={module:Videoview.getVideoModule(e+"_"+i),vid:i,oid:e,s:o,prev_s:r?r.segments:"",prev_sig:r?r.segmentsSig:"",hash:t},s=parseInt(cur.videoSearchPos);if(isNaN(s)||(n.search_pos=s),ajax.post("al_video.php?act=a_view_segments",n,{onDone:function(e,i,o){if(!(e<0)){e&&ls.set(a,{segments:e,segmentsSig:i,ts:vkNow()}),cur.segmentsSaveProcess=!1,o=intval(o);var t=parseInt(cur.videoSearchPos);o>0&&!isNaN(t)&&cur.videoSearchStats&&(cur.videoSearchStats.positions[t]=extend({viewedParts:0},cur.videoSearchStats.positions[t]),cur.videoSearchStats.positions[t].viewedParts++)}}}),cur.videoSearchStats&&(cur.videoSearchStats.totalViewedTime||(cur.videoSearchStats.totalViewedTime=0),cur.videoSearchStats.totalViewedTime+=mvcur.mvData.vsegsSize,!isNaN(s))){cur.videoSearchStats.positions[s]=extend({viewedSeconds:0},cur.videoSearchStats.positions[s]);var _=cur.videoSearchStats.positions[s].viewedSeconds;_=Math.min(mvcur.mvData.duration,_+mvcur.mvData.vsegsSize),cur.videoSearchStats.positions[s].viewedSeconds=_}}}},onLike(e){Videoview.like(null,!0),Videoview.sendPlayerStats(1,e)},onAdd(e,i,o){Videoview.addSmall(e,i),Videoview.sendPlayerStats(3,o)},onRemove(){Videoview.removeVideo()},onShare(e){Videoview.share(),Videoview.sendPlayerStats(2,e)},onSubscribe(e,i){Videoview.subscribeToAuthor(e,"player"),Videoview.sendPlayerStats(e?9:10,i)},onDonate(){Videoview.showDonateBox()},onAddBookmark(){Videoview.bookmarkVideo()},onRemoveBookmark(){Videoview.bookmarkVideo(!0)},isInLayer:e=>Videoview.isLayerShown(e),onLiveViewersCountChange(e,i,o){Videoview.isLayerShown(e)&&Videoview.updateLiveViewersCount(i,o),window.Stories&&window.Stories.isLiveShown(e)&&window.Stories.updateLiveViewersCount(i)},onLiveStarted(e){Videoview.isLayerShown(e)&&Videoview.reload()},onLiveEnded(e,i){Videoview.isLayerShown(e)&&(hide("mv_publish"),hide("mv_live_gifts_block"),val("mv_views",getLang("video_live_finished"))),window.Stories&&window.Stories.isLiveShown(e)&&window.Stories.activeLiveEnded(i)},onAdStat(e,i){window.Wall&&Wall.triggerAdStat(e,i)},showSubtitlesIntro(e,i){Videoview.sendPlayerStats(18,0),cur.featurePlayerSubtitlesTT=new ElementTooltip(e,{appendTo:ge("mv_box"),autoShow:!1,cls:"feature_intro_tt feature_intro_blue_tt",content:`\n        <div class="feature_intro_subtitles">\n          <div class="feature_intro_subtitles_icon"></div>\n          <div>${i}</div>\n          <div class="feature_intro_tt_hide" onclick="cur.closeFeaturePlayerSubtitleTT();"></div>\n        </div>\n    `,defaultSide:"bottom",offset:[11,7],rightShift:55,width:"auto",onHide:function(){cur.closeFeaturePlayerSubtitleTT&&cur.closeFeaturePlayerSubtitleTT()}}),cur.featurePlayerSubtitlesTT.show(),cur.closeFeaturePlayerSubtitleTT=function(){cur.featurePlayerSubtitlesTT&&cur.featurePlayerSubtitlesTT.destroy()},cur.destroy.push((function(){cur.closeFeaturePlayerSubtitleTT()}))}}},616515:(e,i,o)=>{o.d(i,{default:()=>s});o(530522),o(66108),o(296253),o(991181),o(579665),o(95767);var t=o(414914),a=o(719016),r=o(506362);function d(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],t=!0,a=!1,r=void 0;try{for(var d,n=e[Symbol.iterator]();!(t=(d=n.next()).done)&&(o.push(d.value),!i||o.length!==i);t=!0);}catch(e){a=!0,r=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw r}}return o}(e,i)||function(e,i){if(!e)return;if("string"==typeof e)return n(e,i);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(o);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(e,i)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,i){(null==i||i>e.length)&&(i=e.length);for(var o=0,t=new Array(i);o<i;o++)t[o]=e[o];return t}const s={SCROLL_EDGE_BELOW_THRESHOLD:20,MAX_COMMENTS_NUM:150,MAX_LIKES_PER_BATCH:7,MAX_STICKERS_PER_BATCH:7,init(e,i){VideoChat.block&&VideoChat.destroy(),e&&(VideoChat.block=e,VideoChat.options=extend({},i),VideoChat.messagesWrap=domByClass(e,"mv_chat_messages_wrap"),VideoChat.stickersWrap=domByClass(e,"mv_chat_stickers_wrap"),VideoChat.scroll=new uiScroll(domFC(VideoChat.messagesWrap),{global:!0,hidden:i.scrollHidden,reversed:!0,preserveEdgeBelow:!0,preserveEdgeBelowThreshold:VideoChat.SCROLL_EDGE_BELOW_THRESHOLD,theme:"videoview",onupdate:VideoChat.onScrollUpdate}),this.scrollBottomBtnWrap=domByClass(e,"mv_chat_new_messages_btn_wrap"),VideoChat.replyForm=domByClass(e,"mv_chat_reply_form"),VideoChat.replyForm&&(VideoChat.replyInput=domByClass(e,"mv_chat_reply_input"),VideoChat.initReplyInput()),VideoChat.firstMsgIntro=domByClass(e,"mv_chat_first_message_intro"))},initReplyInput(){placeholderInit(VideoChat.replyInput,{editable:!0,global:!0}),stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){var e=Emoji.init(VideoChat.replyInput,{forceStickerPack:VideoChat.options.forceStickerPack,controlsCont:VideoChat.replyForm,noLineBreaks:1,noCtrlSend:1,ref:"video_chat",onSend:function(){VideoChat.sendMessage()},checkEditable:function(){VideoChat.checkFormHeight(),VideoChat.checkTextLen()},onStickerSend:function(e){VideoChat.sendSticker(e)}});(0,t.data)(VideoChat.replyForm,"optId",e)}))},checkFormHeight(){var e=VideoChat.replyForm,i=e.offsetHeight;if(e.lastHeight!==i){e.lastHeight=i;var o=!VideoChat.scroll.data.scrollBottom;setStyle(VideoChat.messagesWrap,{bottom:i+"px"}),o&&VideoChat.scroll.scrollBottom()}},checkTextLen(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VideoChat.replyInput,i=trim(Emoji.editableVal(e));if(e.lastLen!==i.length)if((e.lastLen=i.length)>mvcur.maxChatReplyLength){var o=cur.storyLayer?"stories_live_chat_msg_too_long":"video_live_chat_msg_too_long";(0,a.showTooltip)(e,{black:1,text:getLang(o),shift:!!cur.storyLayer&&[-30,10]})}else window.tooltips&&tooltips.destroy(e)},mentionOver:e=>window.mentionOver(e,{shift:[-20,7,7]}),stickerClick:(e,i,o)=>(stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.clickSticker(e,i,o)})),!1),onScrollUpdate(e){e.data.scrollBottom<VideoChat.SCROLL_EDGE_BELOW_THRESHOLD&&VideoChat.toggleScrollBottomBtn(!1)},receiveMessage(e,i,o,t,a,r,d,n,s){if(intval(s))VideoChat.appendSticker(s,o);else{var _=!1;window.replyAsList&&window.replyAsList.length&&each(window.replyAsList,(function(){if(this[0]==o)return _=!0,!1}));var l=Videoview.getMvData(),v=l.adminLevel,c=l.canDeleteComments,m="";(v>constants.Groups.GROUPS_ADMIN_LEVEL_USER||c||e==vk.id||o==vk.id||_)&&(m+=getTemplate("video_chat_message_action_del",{video_owner_id:e,msg_id:i}));var u=psr(getTemplate("video_chat_message",{author_href:r,author_photo:psr(a),author_name:t,message:n,video_owner_id:e,msg_id:i,actions:m,classes:o==e?"mv_chat_admin_message":""}));VideoChat.appendMessage(u,i)}},receiveDelete(e,i){var o="#mv_chat_msg"+mvcur.mvData.oid+"_"+i,t=VideoChat._messagesBatch&&VideoChat._messagesBatch.querySelector(o);t?re(t):(t=VideoChat.messagesWrap.querySelector(o))&&!hasClass(t,"_deleting")&&VideoChat.scroll.updateAbove((function(){re(t)}))},checkStickerFlood(e,i){var o=mvcur.queueBatchId;VideoChat._stickersLimits&&VideoChat._stickersLimits.batch==o||(VideoChat._stickersLimits={batch:o,like:0,sticker:0},VideoChat._stickersDelay=0);var t="like"==e?"like":"sticker",a="like"==t?VideoChat.MAX_LIKES_PER_BATCH:VideoChat.MAX_STICKERS_PER_BATCH;return!(++VideoChat._stickersLimits[t]>a&&i!=vk.id)},appendSticker(e,i){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!VideoChat.isHidden()&&!Videoview.isFS&&"hidden"!=document.visibilityState&&"animation"in bodyNode.style&&"onanimationend"in window){if(i==vk.id){var t=VideoChat.recentlySentSticker;if(t&&t.stickerId==e&&t.fromQueue!=o&&Date.now()-t.time<3e3)return;VideoChat.recentlySentSticker={stickerId:e,fromQueue:o,time:Date.now()}}else if(!VideoChat.checkStickerFlood(e,i))return;if("like"==e){var a=ce("div",{className:"mv_chat_like"});d(a),addEvent(a,"animationend",s),n(a)}else{var r=ce("img",{className:"mv_chat_sticker",src:Stickers.getStickerUrl(e,(isRetina()?128:64)+"b")});d(r),addEvent(r,"error animationend",s),addEvent(r,"load",n)}}function d(e){for(var o="",t=0,a=0,r=0,d=intval((VideoChat.getHeight()-80)/6),n=0;n<=100;n+=20){n>0&&(t+=irand(-4,4),a-=d,r+=irand(-4,4),d=intval(.9*d)),o+=`\n          ${n}% {\n            transform: translate(${t}px, ${a}px) rotate(${r}deg) scale(${n?1:.7});\n            opacity: ${0==n||100==n?0:1};\n          }\n        `}var s="mv_chat_sticker_animation_"+Date.now()+"_"+irand(0,1e9);o=`@keyframes ${s} {${o}}`,e.appendChild(ce("style",{innerHTML:o}));var _=irand(1500,2500)+"ms",l=(i==vk.id?0:VideoChat._stickersDelay+=100)+"ms";setStyle(e,{animation:[s,_,l,"linear"].join(" ")})}function n(e){var i=e.currentTarget||e;(VideoChat._stickersBatch||(VideoChat._stickersBatch=document.createDocumentFragment())).appendChild(i),VideoChat._appendStickerTimeout||(VideoChat._appendStickerTimeout=setTimeout((function(){VideoChat.appendStickersBatch(),VideoChat._appendStickerTimeout=null}),0))}function s(e){var i=e.currentTarget||e;removeEvent(i),re(i)}},appendStickersBatch(){var e=VideoChat._stickersBatch;e&&(VideoChat._stickersBatch=null,VideoChat.isHidden()||VideoChat.stickersWrap.appendChild(e))},removeStickers(){if(VideoChat.stickersWrap)for(var e;e=domFC(VideoChat.stickersWrap);)removeEvent(e),re(e)},appendMessage(e,i){var o=VideoChat._messagesBatch||(VideoChat._messagesBatch=document.createDocumentFragment()),t="#mv_chat_msg"+mvcur.mvData.oid+"_"+i;if(!VideoChat.messagesWrap.querySelector(t)&&!o.querySelector(t)){o.appendChild(se(e));for(var a=o.childNodes;o.childNodes.length>VideoChat.MAX_COMMENTS_NUM;)re(a[0]);VideoChat.isHidden()||VideoChat._appendMessageTimeout||(VideoChat._appendMessageTimeout=setTimeout((function(){VideoChat.appendMessagesBatch(),VideoChat._appendMessageTimeout=null}),0))}},appendMessagesBatch(){if(!VideoChat.isHidden()){var e=VideoChat._messagesBatch;if(e){VideoChat._messagesBatch=null;var i=geByClass("mv_chat_message_author_thumb_img",e,"img");each(i,(function(e,i){attr(i,"src")||attr(i,"src",domData(i,"src"))})),VideoChat.firstMsgIntro&&(re(VideoChat.firstMsgIntro),VideoChat.firstMsgIntro=null);var o=VideoChat.scroll.content;VideoChat.scroll.updateBelow((function(){o.appendChild(e)})),VideoChat.scroll.updateAbove((function(){for(var e=o.childNodes;e.length>VideoChat.MAX_COMMENTS_NUM;)re(e[0])})),VideoChat.scroll.data.scrollBottom>100&&VideoChat.toggleScrollBottomBtn(!0)}}},toggleScrollBottomBtn(e){toggleClass(this.scrollBottomBtnWrap,"hidden",!e)},scrollBottom(){VideoChat.scroll.scrollBottom(0)},replyAsAnimate(e,i,o){var t=e&&geByClass1("mv_chat_reply_author_photo",e),a=t&&geByClass("mv_chat_reply_author_photo_img",t),r=hasClass(e,"mv_chat_author_secondary")?0:1;a&&a[r]&&(a[r].src=o),toggleClass(e,"mv_chat_author_secondary")},replyAsGroup(e,i){window.replyAsList?VideoChat.replyAsGroupTT(e,i):(window.replyAsList=[],window.replyAsData={},domData(e,"can_reply_as_any_group")?ajax.post("/al_groups.php?act=get_editor_clubs",{},{cache:1,onDone:function(o){window.replyAsList=o,each(o,(function(e,i){var o=d(i,4),t=o[0];o[1],o[2],o[3];window.replyAsData[t]=this})),VideoChat.replyAsGroupTT(e,i)}}):VideoChat.replyAsGroupTT(e,i))},replyAsGroupList(e,i,o){var t=[o],a=domByClass(e,"mv_chat_reply_group_data");if(a){var r=[domData(a,"group_id"),domData(a,"group_photo"),domData(a,"group_href"),domData(a,"group_name")];t.push(r),window.replyAsData[r[0]]=r}return each(window.replyAsList,(function(e,o){var a=d(o,4),r=a[0];a[1],a[2],a[3];r!=i&&t.push(this)})),t},replyAsGroupOver(e){var i=gpeByClass("mv_chat_reply_form",e);(0,a.showTooltip)(e,{text:function(){return domData(i,"from-oid")<0?getLang("global_on_behalf_group"):getLang("global_on_behalf_me")},black:1,shift:[9,8,8]})},replyAsGroupTT(e,i){var o=VideoChat.replyAsProfileData(),a=gpeByClass("mv_chat_reply_form",e),r=a&&domData(a,"from-oid"),n=(0,t.data)(e,"tt");if(!o)return!1;if(!n){var s=VideoChat.replyAsGroupList(e,i,o),_="";each(s,(function(e,i){var o=d(i,4),t=o[0],a=o[1],n=o[2],s=o[3];_+=getTemplate("video_chat_message_author_select_row",{author_id:t,author_href:n,author_photo:a,author_name:s,classes:r==t?" active":""})})),n=new ElementTooltip(e,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+_+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"top",offset:function(){return[0,-5]},onFirstTimeShow:function(i){var o=geByClass("post_from_tt_row",i);each(o,(function(i,o){addEvent(o,"click",VideoChat.setReplyAsGroup.pbind(e,{from:domData(this,"from-oid")}))})),this.rows=o,this.scroll=new uiScroll(geByClass1("_post_scroll_wrap",i)),setTimeout((function(){n.scroll.update(),n.updatePosition()}),0)},onShow:function(e){setTimeout((function(){if(n.scroll){var i=geByClass1("active",e),o=i?i.offsetTop-(n.scroll.data.viewportHeight-getSize(i)[1])/2:0;n.scroll.scrollTop(o)}}),0)},onHide:function(e){}}),(0,t.data)(e,"tt",n)}i&&n.isShown()&&VideoChat.setReplyAsGroup(e,{from:r==vk.id?i:vk.id}),e.tt&&e.tt.hide&&e.tt.hide(),n.isShown()||n.show()},replyAsProfileData:()=>window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData,setReplyAsGroup(e,i){if(!e)return!1;var o=domClosest("mv_chat_reply_form",e),a=(0,t.data)(e,"tt"),r=i.from||(i.fromGroup?cur.oid:vk.id),d=r==vk.id?VideoChat.replyAsProfileData():window.replyAsData&&window.replyAsData[r];return!(domData(o,"from-oid")==r||!d||d[0]!=r)&&(domData(o,"from-oid",r),VideoChat.replyAsAnimate(o,d[2],d[1]),a&&a.rows&&each(a.rows,(function(){toggleClass(this,"active",domData(this,"from-oid")==r)})),e.setAttribute("aria-label",getLang(r<0?"wall_reply_as_group":"wall_reply_as_user")),!1)},sendMessage(){if(!VideoChat.messageSending){var e={message:trim(Emoji.val(VideoChat.replyInput))};if(e.message){if(vkNow()-VideoChat.lastMsgSent<1e3)return window.tooltips&&tooltips.destroy(VideoChat.replyInput),void(0,a.showTooltip)(VideoChat.replyInput,{text:getLang("video_live_chat_too_fast"),black:1});var i=Videoview.getMvData(),o=geByClass1("mv_chat_reply_form",this.block);o&&domData(o,"from-oid")&&(e.from_oid=domData(o,"from-oid")),ajax.post("al_video.php?act=post_comment",Wall.fixPostParams(extend(e,{video:i.videoRaw,hash:i.hash,videoviewer_chat:1})),{onDone:function(e,i){VideoChat.messageSending=!1,e&&i&&VideoChat.appendMessage(e,i),Emoji.val(VideoChat.replyInput,""),VideoChat.checkFormHeight(),VideoChat.scroll.data.scrollBottom&&VideoChat.scrollBottom(),VideoChat.lastMsgSent=vkNow(),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,r.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(VideoChat.messageSending=!1,VideoChat.replyInput)return window.tooltips&&tooltips.destroy(VideoChat.replyInput),(0,a.showTooltip)(VideoChat.replyInput,{text:e,showdt:200,forcetodown:0,slide:15,black:1}),elfocus(VideoChat.replyInput),!0}}),VideoChat.messageSending=!0}else elfocus(VideoChat.replyInput)}},sendSticker(e){var i=Videoview.getMvData();ajax.post("al_video.php?act=live_send_sticker",{sticker_id:e,owner_id:i.oid,video_id:i.vid,hash:i.hash},{onDone(){VideoChat.appendSticker(e,vk.id,!1)}})},deleteMessage(e,i){var o=ge("mv_chat_msg"+e);addClass(o,"_deleting"),ajax.post("al_video.php?act=delete_comment",{comment:e,hash:i,videoview_chat:1},{onDone(e){val(domByClass(o,"mv_chat_message_content"),e)}})},isHidden(){return!!this.hidden||Videoview.isMinimized()},setHidden(e){this.hidden=e},toggle(){var e=VideoChat.isHidden();this.setHidden(!e),VideoChat.toggleStateClasses(),e&&VideoChat.scroll&&(VideoChat.appendMessagesBatch(),VideoChat.updateScroll()),e||VideoChat.removeStickers()},toggleStateClasses(){var e=!!this.block,i=VideoChat.isHidden(),o=Videoview.isMinimized();toggleClass("mv_box","_has_chat",e&&!o),toggleClass("mv_box","_hide_chat",e&&!o&&i);var t="";e&&(VideoChat.appendMessagesBatch(),t=getLang(i?"video_aria_expand_chat":"video_aria_minimize_chat")),ge("mv_top_pl_toggle")&&attr("mv_top_pl_toggle","aria-label",t)},updateScroll(){VideoChat.scroll.update(),VideoChat.scroll.scrollBottom(),VideoChat.toggleScrollBottomBtn(!1)},onResize(){VideoChat.block&&(VideoChat._chatHeight=VideoChat.block.offsetHeight)},getHeight:()=>VideoChat.block?VideoChat._chatHeight||(VideoChat._chatHeight=VideoChat.block.offsetHeight):0,destroy(){if(VideoChat.block){if(VideoChat.scroll&&(VideoChat.scroll.destroy(),VideoChat.scroll=null),VideoChat.replyForm){var e=(0,t.data)(VideoChat.replyForm,"optId");void 0!==e&&Emoji.destroy(e),(0,t.removeData)(VideoChat.replyForm),(0,t.removeData)(VideoChat.replyInput),VideoChat.replyForm=VideoChat.replyInput=null}VideoChat.removeStickers(),(0,t.removeData)(VideoChat.block),re(VideoChat.block),VideoChat.block=null,VideoChat.messagesWrap=null,VideoChat.stickersWrap=null,VideoChat.options=null,clearTimeout(VideoChat._appendMessageTimeout),clearTimeout(VideoChat._appendStickerTimeout),VideoChat._appendMessageTimeout=null,VideoChat._appendStickerTimeout=null,VideoChat._messagesBatch=null,VideoChat.firstMsgIntro=null,VideoChat.messageSending=!1,VideoChat.toggleStateClasses()}}}},642139:(e,i,o)=>{o.d(i,{default:()=>n});o(283946),o(59357);var t=o(182408),a=o(705456),r=o(791563),d=o(719016);const n={DEFAULT_COMMENT_MAX_LENGTH:300,init(e){function i(){curBox().hide(),(0,r.showFastBox)(getLang("global_error"),getLang("global_error_occured"))}VideoDonate.params={prefilled:e.prefilled,videoId:e.video_raw,votesHash:e.votes_hash,referrer:e.referrer,payerId:e.payer_id},ajax.plainpost(e.api_url,"",(function(e){(e=JSON.parse(e))&&"success"==e.status?(VideoDonate.apiData=e.data,VideoDonate.initForm()):i()}),i,!0)},initForm(){var e=VideoDonate.apiData,i=floatval(e.user_data.donation_mins.RUB),o=Math.ceil(i/vk.vcost);if(VideoDonate.params.votesHash&&o<=vk.balance){var t=[["votes",getLang("video_donate_box_currency_votes")],["rubles",getLang("video_donate_box_currency_rubles")]];VideoDonate.currencyDropdown=new Dropdown(ge("video_donate_amount_currency"),t,{multiselect:!1,onChange:VideoDonate.onChooseCurrency,selectedItems:"votes",width:150,big:!0}),addClass("video_donate_amount_wrap","video_donate_can_choose_currency"),VideoDonate.onChooseCurrency("votes")}else VideoDonate.onChooseCurrency("rubles");var a=ge("video_donate_comment");a.onkeydown=a.onkeyup=a.onchange=VideoDonate.checkCommentLength,toggle("video_donate_widget_offline",!e.user_data.alert_widget_is_online),ge("video_donate_basic_submit").onclick=VideoDonate.submitBasicForm;var r=geByClass("radiobtn","video_donate_pay_methods");radioBtns.video_donate_pay_method={els:Array.prototype.slice.apply(r)};var d=ls.get("video_donate_pay_method")||"";each(r,(function(e,i){i.onclick=function(e){VideoDonate.onChoosePayMethod(e.currentTarget)},domData(i,"value")===d&&VideoDonate.onChoosePayMethod(i)})),radioval("video_donate_pay_method")||VideoDonate.onChoosePayMethod(r[0]);var n=VideoDonate.params.prefilled;n.email&&val("video_donate_email",n.email.value),ge("video_donate_billing_submit").onclick=VideoDonate.submitBillingForm,hide("video_donate_pr"),show("video_donate_step_basic")},onChooseCurrency(e){var i,o,t=VideoDonate.apiData,a=floatval(t.user_data.donation_mins.RUB),r=Math.ceil(a/vk.vcost),d=floatval(val("video_donate_amount"));d?(o="votes"==e?Math.max(r,Math.round(d/vk.vcost)):Math.max(a,intval(d*vk.vcost)),val("video_donate_amount",o)):val("video_donate_amount","votes"==e?r:a);"votes"==e?(i=getLang("video_donate_box_min_amount_votes_hint",r),i+=" "+getLang("video_donate_box_total_votes_hint",vk.balance)):i=getLang("video_donate_box_min_amount_hint",a,!0),val("video_donate_amount_hint",i);var n=!!intval(t.user_data.tts_is_enabled),s=floatval((t.user_data.tts_mins||{}).RUB);n&&(s?"votes"==e?val("video_donate_comment_tts_hint",getLang("video_donate_box_text_speech_min_votes_hint",Math.ceil(s/vk.vcost))):val("video_donate_comment_tts_hint",getLang("video_donate_box_text_speech_min_hint",s)):val("video_donate_comment_tts_hint",getLang("video_donate_box_text_speech_hint")));var _=getLang("votes"==e?"video_donate_box_pay_button":"video_donate_box_donate_button");val("video_donate_basic_submit",_)},checkCommentLength(e){var i=VideoDonate.apiData,o=e.currentTarget,t=val(o).length,a=i.user_data.max_comment_length||VideoDonate.COMMENT_MAX_LENGTH,r="";if(t>a)r=getLang("video_donate_box_comment_too_long");else if(t>a-100){r=getLang("text_N_symbols_remain",a-t)}val("video_donate_comment_length_hint",r)},showInputError(e,i){e=ge(e),(0,a.notaBene)(e),i&&((0,d.showTooltip)(e,{text:i,shift:[0,7,7],dir:"auto",nohide:!0,hasover:!0,showsp:300,onHide:function(){e.onkeydown=e.onblur=null,setTimeout(tooltips.destroy.bind(tooltips,e),300)}}),e.onkeydown=e.onblur=function(){e.tt&&tooltips.hide(e)})},submitBasicForm(e){var i=e.currentTarget,o=VideoDonate.apiData,r=val("video_donate_name"),d=VideoDonate.currencyDropdown?VideoDonate.currencyDropdown.val():"rubles",n=val("video_donate_comment"),s=floatval(val("video_donate_amount")),_=0;if("votes"==d&&(_=s,s*=vk.vcost),!s||s<o.user_data.donation_mins.RUB)return VideoDonate.showInputError("video_donate_amount"),!1;if(n.length>VideoDonate.COMMENT_MAX_LENGTH)return VideoDonate.showInputError("video_donate_comment"),!1;var l={step:"basic",referrer:VideoDonate.params.referrer,currency:"RUB",name:r,amount:s,comment:n};(0,a.lockButton)(i),ajax.plainpost(o.form_api_ssl_url,{data:(0,t.toQueryString)(l)},(function(e){(0,a.unlockButton)(i),(e=JSON.parse(e))&&"success"==e.status?"votes"==d?VideoDonate.donateVotes(r,_,n):VideoDonate.toNextForm():e&&e.errors&&each(e.errors,(function(e,i){var o=VideoDonate.getErrorText(i.code);return VideoDonate.showInputError("video_donate_"+i.field,o),!1}))}),(function(){(0,a.unlockButton)(i)}))},donateVotes(e,i,o){ajax.post("al_video.php?act=donate_votes",{video:VideoDonate.params.videoId,hash:VideoDonate.params.votesHash,name:e,amount:i,comment:o},{onDone:function(e,i,o){if(e){curBox().hide();var t=getTemplate("video_donate_success_msg",{text:i});(0,r.showFastBox)(getLang("video_donate_box_title"),t)}else VideoDonate.showInputError("video_donate_amount",i);vk.balance!=o&&updateMoney(o)},showProgress:a.lockButton.pbind("video_donate_basic_submit"),hideProgress:a.unlockButton.pbind("video_donate_basic_submit")}),statlogsValueEvent("video_donate","","checkout","votes")},toNextForm(){hide("video_donate_step_basic"),show("video_donate_step_billing"),curBox().setBackTitle(VideoDonate.toPrevForm)},toPrevForm(){hide("video_donate_step_billing"),show("video_donate_step_basic"),curBox().setBackTitle()},onChoosePayMethod(e){var i=VideoDonate.apiData,o=VideoDonate.params.prefilled,t=domData(e,"value");radiobtn(e,t,"video_donate_pay_method");var a=i.payin_currencies[t].additional_fields,r="";a&&each(a,((e,i)=>{var a="",d="",n="";"MOBILE_FAKE"==t&&"phone"==e?(a=getLang("video_donate_box_sms_payment_phone_placeholder"),d=getLang("video_donate_box_sms_payment_phone_hint"),n=o.phone?o.phone.value:""):"QIWI_MYCOM"==t&&"phone_number"==e&&(a=getLang("video_donate_box_qiwi_payment_phone_placeholder"),d=getLang("video_donate_box_qiwi_payment_phone_hint")),(a||d)&&(r+=getTemplate("video_donate_additional_field",{name:e,placeholder:a,hint:d,required:intval(i.required),prefilled:n,input_id:""}))})),val("video_donate_billing_additional_fields",r)},submitBillingForm(e){var i=VideoDonate.apiData,o=e.currentTarget,d=radioval("video_donate_pay_method"),n=VideoDonate.params.prefilled,s=val("video_donate_email");if(!/^.+@.+\..+$/.test(s))return VideoDonate.showInputError("video_donate_email"),!1;var _={step:"billing",referrer:VideoDonate.params.referrer,name:val("video_donate_name"),amount:floatval(val("video_donate_amount")),currency:"RUB",comment:val("video_donate_comment"),billing_system_type:d,redirect:1,vk_test_group:VideoDonate.params.votesHash?1:2,_vk_id_encrypted:VideoDonate.params.payerId};n.email&&s==n.email.value?_.email_encrypted=n.email.encrypted:_.email=s;var l=!0;if(each(geByClass("video_donate_input","video_donate_billing_additional_fields"),((e,o)=>{var t=domData(o,"name"),a=val(o),r=intval(domData(o,"required"));if("MOBILE_FAKE"==d&&"phone"==t&&n.phone&&replaceEntities(n.phone.value)==a)t+="_encrypted",a=n.phone.encrypted;else if(a||r){a=a.replace(/\s+/g,"");var s=i.payin_currencies[d].additional_fields[t].regex_validation;if(s&&!new RegExp(s).test(a))return VideoDonate.showInputError(o),l=!1,!1}_[t]=a})),l){if("MOBILE_FAKE"==d){ajax.plainpost(i.form_api_ssl_url,{data:(0,t.toQueryString)(_)},(e=>{if((0,a.unlockButton)(o),(e=JSON.parse(e))&&"success"==e.status){curBox().hide();var i=getTemplate("video_donate_success_msg",{text:getLang("video_donate_box_sms_payment_success")});(0,r.showFastBox)(getLang("video_donate_box_title"),i)}else e&&e.errors&&each(geByClass("video_donate_input","video_donate_billing_additional_fields"),(function(i,o){var t=domData(o,"name");if(e.errors[t]){var a=VideoDonate.getErrorText(e.errors[t].code);return VideoDonate.showInputError(o,a),!1}}))}),(()=>{(0,a.unlockButton)(o)})),(0,a.lockButton)(o)}else{var v=ce("iframe"),c=ce("form",{action:i.form_api_ssl_url,method:"post",target:"_blank",innerHTML:'<input type="hidden" name="data" value="'+(0,t.toQueryString)(_)+'"/>'});utilsNode.appendChild(v),v.contentDocument.body.appendChild(c),c.submit(),setTimeout((function(){re(v)}),0),curBox().hide()}statlogsValueEvent("video_donate","","checkout",d),ls.set("video_donate_pay_method",d)}},getErrorText(e){switch(e){case"special_characters_violation":return getLang("video_donate_special_chars_error");case"max_username_length_violation":return getLang("video_donate_username_length_error");case"mc_provider_violation":return getLang("video_donate_phone_provider_error");case"mc_provider_not_found":return getLang("video_donate_phone_provider_not_found_error")}},onDestroy(){delete VideoDonate.params,delete VideoDonate.apiData,VideoDonate.currencyDropdown&&(VideoDonate.currencyDropdown.destroy(),VideoDonate.currencyDropdown=null)}}},354108:(e,i,o)=>{o.d(i,{default:()=>a});o(59357);var t=o(917999);const a={initPlayer(e,i,o){hide(domByClass(e,"video_box_msg")),VideoInitializer[i].apply(VideoInitializer,[e].concat(o)),stManager.add("notifier.js",(function(){var e=Videoview.togglePlay.pbind(!1);Notifier.addRecvClbk("audio_start","video",e),Notifier.addRecvClbk("video_start","video",e),Notifier.addRecvClbk("videocall_start","video",e)}))},vk(e,i){var o=i.oid+"_"+i.vid;if(i.vsegs)ls.remove("vsegs"+vk.id+"_"+o);else{var t=ls.get("vsegs"+vk.id+"_"+o);t&&t.ts&&t.segments&&Date.now()-t.ts<864e5&&(i.vsegs=t.segments.replace(/[^0-9\,\|]/gi,""))}window.onLoaded((function(){i.sdk?VideoInitializer.unionPlayer(e,i):VideoInitializer.vkHtml5(e,i)}))},vkHtml5(e,i){var o=window.mvLayer&&window.mvLayer.contains(e),a=o&&mvcur.oldPlayer&&e.contains(mvcur.oldPlayer.el);a||val(e,"");var r=new CallHub((function(){if(!bodyNode.contains(e))return;var r;o&&mvcur.oldPlayer?(mvcur.player=mvcur.oldPlayer,(r=mvcur.player).initVideo(i)):(r=new VideoPlayer(i,e),o?(mvcur.oldPlayer=r,mvcur.player=mvcur.oldPlayer):i.is_embed?cur.player=r:-195297477===i.author_id?r.play():cur.videoInlinePlayer=r);(0,t.isFunction)(i.onPlayerLoaded)&&i.onPlayerLoaded(r);if(!a){var d=ce("div",{id:"video_player"});attr(d,"preventhide",1),d.appendChild(r.el),e.appendChild(d)}}));i.hls_candy_server&&!window.Candy&&(r.count++,window.loadScript("https://cdn.candy.systems/js/vk/candy2.min.js",{timeout:5e3,onLoad:function(){r.done()},onError:function(){delete i.hls_candy,r.done()}}));var d=["videoplayer.js","videoplayer.css"];i.hls&&d.push("hls.min.js"),stManager.add(d,(function(){r.done()}))},unionPlayer(e,i){var a=window.mvLayer&&window.mvLayer.contains(e);val(e,""),stManager.add(["videoplayer.css"]),Promise.all([o.e(8592),o.e(4212),o.e(2974)]).then(o.bind(o,677588)).then((o=>{var r=o.Player;if(bodyNode.contains(e)){var d=new r(i,e);a?(mvcur.sdkPlayer=d,mvcur.player=mvcur.sdkPlayer):i.is_embed?cur.player=d:cur.videoInlinePlayer=d;var n=ce("div",{id:"video_player"});attr(n,"preventhide",1),n.appendChild(d.el),e.appendChild(n),d.initVideo(i),(0,t.isFunction)(i.onPlayerLoaded)&&i.onPlayerLoaded(d)}}))},youtube(e,i){var o,t,a=i.oid,r=i.vid,d=i.report_error_hash;i.restriction||(window.onYouTubeIframeAPIReady=function(){var o=domByClass(e,"video_yt_player"),t=new window.YT.Player(o,{events:{onError:function(e){var i=[100,101,150];e.data&&-1!==i.indexOf(e.data)&&ajax.post("al_video.php?act=reparseDeletedYoutube",{vid:r,oid:a}),debugLog("YT player error",arguments),ajax.post("al_video.php?act=external_error",{oid:a,vid:r,hash:d})},onStateChange:function(e){switch(e.data){case window.YT.PlayerState.ENDED:stManager.add(["videoview.js","videoview.css"],(function(){var e=ge("video_yt");Videoview.onExternalVideoEnded(e)}));break;default:ge("mv_external_finish")&&Videoview.removeExternalVideoFinishBlock()}}}});stManager.add([jsc("web/video_youtube.js"),"video_youtube.css"],(function(){VideoYoutube.initStatOnly(t,i)}))},window.YT?window.onYouTubeIframeAPIReady():(document,o=ce("script",{async:!0,src:"https://www.youtube.com/iframe_api"}),(t=geByTag1("script")).parentNode.insertBefore(o,t)))},iframeOrFlash(e,i,o,t,a,r){t&&(browser.flash<Videoview.FLASH_MIN_VERSION||!i)?val(e,'<iframe class="extra_player" type="text/html" width="100%" height="100%" src="'+encodeURI(t)+'" frameborder="0" '+a+"></iframe>"):(o=extend({stats:"",from:"vk"},o),VideoInitializer.flash(e,i,o)),r&&setTimeout((function(){cur&&cur.incViews&&cur.incViews()}),100)},flash(e,i,o,t){if(browser.flash<Videoview.FLASH_MIN_VERSION)show(domByClass(e,"video_box_msg"));else{var a={url:i,id:"video_player",width:"100%",height:"100%",preventhide:1,version:11};t=extend({allowfullscreen:!0,allowscriptaccess:"never",bgcolor:"#000000",wmode:"opaque"},t),renderFlash(e,a,t,o)}}}},288183:(e,i,o)=>{o.d(i,{default:()=>a});o(991181),o(296253),o(283946),o(976142),o(59357);var t=o(705456);const a={init(e,i){e.setOptions({bodyStyle:"padding:0;",onDestroy:function(){uiSearch.destroy(d),r&&r.destroy(),e=o=r=n=d=null}});var o,a,r,d=ge("video_live_blacklist_search"),n=ge("video_live_blacklist_wrap"),s=domByClass(n,"olist"),_={};function l(e){var t=e;if((e=trim(e).replace(/\s+/g," ").toLowerCase())!==a){a=e;var r=e?o.search(e):i.list,d="";if(r.length)for(var n,l=new RegExp(e,"i"),v=0;v<r.length;v++)n=r[v],d+=getTemplate("video_live_blacklist_item",{id:n.id,href:n.href,photo:n.photo,name:e?n.name.replace(l,"<em>$&</em>"):n.name,class:_[n.id]?" olist_item_wrap_on":""});else d=getTemplate("video_live_blacklist_empty",{text:langStr(getLang("global_search_not_found"),"search","<b>"+clean(t)+"</b>")});val(s,d)}}i.list.length&&(e.removeButtons().addButton(getLang("global_save"),(function(o){ajax.post("al_video.php?act=save_live_blacklist",{exclude:Object.keys(_).join(","),hash:i.save_hash},{onDone:function(i){e.hide(),i&&showDoneBox(i)},showProgress:t.lockButton.pbind(o),hideProgress:t.unlockButton.pbind(o)})})).addButton(getLang("global_cancel"),null,"no"),r=new uiScroll(n),l(""),n.onclick=function(e){var i=domClosest("olist_item_wrap",e.target);if(!i)return;cancelEvent(e);var o=domData(i,"id");toggleClass(i,"olist_item_wrap_on")?_[o]=1:delete _[o]},d&&(o=new vkIndexer(i.list,(function(e){return e.name+" https://vk.com"+e.href})),uiSearch.init(d,{onChange:l}),uiSearch.focus(d)))}}},225046:(e,i,o)=>{o.d(i,{default:()=>n});o(530522),o(66108),o(296253),o(991181),o(579665),o(95767),o(751876);var t=o(414914),a=o(719016);function r(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],t=!0,a=!1,r=void 0;try{for(var d,n=e[Symbol.iterator]();!(t=(d=n.next()).done)&&(o.push(d.value),!i||o.length!==i);t=!0);}catch(e){a=!0,r=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw r}}return o}(e,i)||function(e,i){if(!e)return;if("string"==typeof e)return d(e,i);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(o);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return d(e,i)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,i){(null==i||i>e.length)&&(i=e.length);for(var o=0,t=new Array(i);o<i;o++)t[o]=e[o];return t}const n={VIDEOS_LIMIT:100,lists:{},blockTpl:'\n<div class="mv_playlist" id="video_mvpl" onmouseenter="VideoPlaylist.toggleHeaderButtons(this, true)" onmouseleave="VideoPlaylist.toggleHeaderButtons(this, false)">\n  <div class="mv_playlist_header clear_fix">\n    <div class="mv_playlist_header_buttons_wrap unshown">\n      <div id="mv_pl_autoplay" class="mv_playlist_header_btn %autoplayBtnClass%" onmouseover="VideoPlaylist.showAutoplayTooltip(this);" onclick="VideoPlaylist.toggleAutoplay(this)"><div class="mv_playlist_header_autoplay_icon"></div></div>\n      <div id="mv_pl_reverse" class="mv_playlist_header_btn _opaque" onmouseover="VideoPlaylist.showReverseTooltip(this);" onclick="VideoPlaylist.toggleReverse(this)"><div class="mv_playlist_header_reverse_icon"></div></div>\n    </div>\n    <div class="mv_playlist_header_title">%title%</div>\n  </div>\n  <div class="mv_playlist_list">\n    <div class="mv_playlist_list_cont">\n      %items%\n    </div>\n  </div>\n</div>\n  ',blockItemTpl:'\n<a class="VideoRecomsItem%itemClass%%restrictionClasses%" id="mv_playlist_video%vid%" onclick="return VideoPlaylist.showVideo(\'%vid%\', event);" data-vid="%vid%" href="/video%vid%">\n  <div class="VideoRecomsItem__thumb_wrap">\n    %restrictionBlock%\n    <div class="VideoRecomsItem__thumb%restrictionThumbClass%" style="background-image: url(\'%thumb%\');"></div>\n    <div class="VideoRecomsItem__duration">%duration%</div>\n  </div>\n  <div class="VideoRecomsItem__info">\n    <div class="VideoRecomsItem__title">%title%</div>\n    <div class="VideoRecomsItem__views">%views%</div>\n  </div>\n</a>\n  ',toggleHeaderButtons(e,i){toggleClass(domByClass(e,"mv_playlist_header_buttons_wrap"),"unshown",!i)},showReverseTooltip(e){(0,a.showTooltip)(e,{text:getLang("video_playlist_reverse_tt"),shift:[7,7,0],showdt:0,black:1})},showAutoplayTooltip(e){var i=VideoPlaylist.isAutoplayEnabled(),o=getLang("video_playlist_autoplay_"+(i?"disable":"enable")+"_tt");(0,a.showTooltip)(e,{text:o,shift:[7,7,0],showdt:0,black:1})},toggleAutoplay(e){var i=!VideoPlaylist.isAutoplayEnabled();toggleClass(e,"_active",i),i?ls.remove("video_playlist_autoplay_disabled"):ls.set("video_playlist_autoplay_disabled",1),tooltips.destroy(e),VideoPlaylist.showAutoplayTooltip(e)},isAutoplayEnabled:()=>!ls.get("video_playlist_autoplay_disabled"),toggleReverse(e){var i=VideoPlaylist.getCurList();i&&(i.reversed=!i.reversed,toggleClass(e,"_active",i.reversed),VideoPlaylist.updateBlockList(i.id))},buildBlock(e,i,o){var a=VideoPlaylist.getBlock(),r=!!a&&(0,t.data)(a,"playlist");if(r&&r.id==e&&!o)return a;VideoPlaylist.removeBlock();var d=VideoPlaylist.getList(e,i);if(!d||d.list.length<=1)return!1;var n=trim(VideoPlaylist.blockTpl),s=VideoPlaylist.buildBlockList(d),_=se(rs(n,{items:s,title:d.title||"",autoplayBtnClass:VideoPlaylist.isAutoplayEnabled()?"_active":""}));return(0,t.data)(_,"playlist",d),this._block=_,_},buildBlockList(e){for(var i=trim(VideoPlaylist.blockItemTpl),o=function(i){return e.reversed?i>=0:i<e.list.length},t=function(i){return e.reversed?--i:++i},a="",r=e.reversed?e.list.length-1:0;o(r);r=t(r)){var d=e.list[r],n=void 0;if(isArray(d)){var s=d[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+d[VideoConstants.VIDEO_ITEM_INDEX_ID];n={vid:s,thumb:d[VideoConstants.VIDEO_ITEM_INDEX_THUMB],title:d[VideoConstants.VIDEO_ITEM_INDEX_TITLE],duration:d[VideoConstants.VIDEO_ITEM_INDEX_DURATION],views:getLang("video_N_views_list",d[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]||1,!0),itemClass:s==e.current?" VideoRecomsItem--active":"",restrictionBlock:d[VideoConstants.VIDEO_ITEM_INDEX_RESTRICTION_BLOCK],restrictionClasses:d[VideoConstants.VIDEO_ITEM_INDEX_RESTRICTION_CLASSES]}}else n=extend({},d,{itemClass:d.vid==e.current?" VideoRecomsItem--active":""});n.hasOwnProperty("restrictionBlock")&&n.restrictionBlock?(n.itemClass+=" VideoRestriction--onlyIcon",n.restrictionThumbClass=" VideoRestriction__thumb"):(n.restrictionBlock="",n.restrictionClasses="",n.restrictionThumbClass=""),a+=rs(i,n)}return a},updateBlockList(e){var i=VideoPlaylist.getCurList();if(i&&i.id==e){var o=VideoPlaylist.getBlock(),a=geByClass1("mv_playlist_list_cont",o),r=VideoPlaylist.buildBlockList(i);val(a,r);var d=(0,t.data)(o,"sb");d&&d.update(),VideoPlaylist.setCurVideo(i.current),VideoPlaylist.updateControls()}},getBlock(){return this._block},removeBlock(){var e=(0,t.data)(this._block,"sb");e&&e.destroy(),re(this._block),(0,t.removeData)(this._block),this._block=null,VideoPlaylist.toggleStateClasses(),VideoPlaylist.updateControls()},setCurVideo(e,i){var o=VideoPlaylist.getBlock();if(o){var a=(0,t.data)(o,"playlist");if(a){e&&(a.current=e);var r=domByClass(o,"VideoRecomsItem--active");if(e&&(removeClass(r,"VideoRecomsItem--active"),r=ge("mv_playlist_video"+e),addClass(r,"VideoRecomsItem--active")),r){var d=geByClass1("mv_playlist_list",o),n=getXY(r)[1],s=getSize(r)[1],_=getXY(d)[1],l=getSize(d)[1],v=n-_;if(v<0||v+s>l){var c=d.scrollTop+n-_-l/2+s/2;d.scrollTop!=c&&(i?animate(d,{scrollTop:c,transition:window.Fx.Transitions.easeOutCubic},450,m):(d.scrollTop=c,m()))}VideoPlaylist._queueNextVideo(e)}}}function m(){var e=VideoPlaylist.getBlock();if(e){var i=(0,t.data)(e,"sb");i&&i.update()}}},getList(e,i){if(this.lists[e])return this.lists[e];if(/^wall_-?\d+$/.test(e))return cur.wallVideos&&cur.wallVideos[e]&&this.uniqList(cur.wallVideos[e]);if(/^post_-?\d+_\d+$/.test(e))return cur.pageVideosList&&cur.pageVideosList[e];if(/^cat_(\d|[\w_])+$/.test(e))return cur.catVideosList&&cur.catVideosList[e];if(/^-?\d+_-?\d+$/.test(e)){var o,t,a,d=r(e.split("_"),2),n=d[0],s=d[1];if(-2==s?(o="all",t=cur.playlistAddedTitle):-1==s?(o="uploaded",t=cur.playlistUploadedTitle):(o="album_"+s,t=cur.playlistTitle),each([cur.silentLoaded,cur.pageVideosList],((e,i)=>{if(i&&i[n]&&i[n][o])return a=i[n][o].list||i[n][o],!1})),a&&a.length){var _;if(i)for(_=a.length;--_;){var l=a[_];if(l[0]+"_"+l[1]==i)break}else _=0;if(a.length>VideoPlaylist.VIDEOS_LIMIT){var v=positive(_-VideoPlaylist.VIDEOS_LIMIT/2),c=v+VideoPlaylist.VIDEOS_LIMIT;c>a.length&&(v=positive(a.length-VideoPlaylist.VIDEOS_LIMIT),c=a.length),a=a.slice(v,c)}return{id:e,title:t,list:a}}}},getCurList(){var e=VideoPlaylist.getBlock();if(e)return(0,t.data)(e,"playlist")},getCurListId(){var e=VideoPlaylist.getCurList();if(e)return e.id},addList(e){this.lists[e.id]=e},extendList(e,i){if(!this.lists[e])return!1;for(var o=this.lists[e].list,t=[],a={},r=0,d=0;;)if(o[r]&&i[d]&&o[r].vid==i[d].vid)a[o[r].vid]||(t.push(o[r]),a[o[r].vid]=1),++r,++d;else if(o[r])a[o[r].vid]||(t.push(o[r]),a[o[r].vid]=1),++r;else{if(!i[d])break;a[i[d].vid]||(t.push(i[d]),a[i[d].vid]=1),++d}return this.lists[e].list=t,this.lists[e]},uniqList(e){for(var i,o={},t=0;i=e.list[t];++t)o[i.vid]?e.list.splice(t,1):o[i.vid]=!0;return e},isCollapsed(){var e=VideoPlaylist.getBlock();return!(!e||!(0,t.data)(e,"collapsed"))},toggle(e,i){if(void 0===e&&(e=VideoPlaylist.isCollapsed()),!mvcur.minimized||!e){var o=VideoPlaylist.getBlock();if(o&&VideoPlaylist.isCollapsed()!=!e)return(0,t.data)(o,"collapsed",!e),VideoPlaylist.toggleStateClasses(),Videoview.playerOnResize(),Videoview.updateReplyFormPos(),e&&(VideoPlaylist.updateScrollbar(),VideoPlaylist.setCurVideo()),!1}},toggleStateClasses(){var e=!!VideoPlaylist.getBlock(),i=Videoview.isMinimized(),o=VideoPlaylist.isCollapsed();toggleClass("mv_box","_has_playlist",e&&!i),toggleClass("mv_box","_hide_playlist",e&&!i&&o);var t="";e&&(t=getLang(o?"video_aria_expand_playlist":"video_aria_minimize_playlist")),attr("mv_top_pl_toggle","aria-label",t)},updateScrollbar(){var e=VideoPlaylist.getBlock();if(e){var i=(0,t.data)(e,"sb");if(i)i.update(!0,!0);else{var o=geByClass1("mv_playlist_list",e),a=new Scrollbar(o,{prefix:"mv_pl_",nokeys:!0,padding:0});(0,t.data)(e,"sb",a)}}},updateControls(){var e=VideoPlaylist.getCurList(),i=VideoPlaylist.getVideoIndex();e&&e.reversed&&(i=e.list.length-i-1),toggle("mv_pl_prev",!!e&&i>0),toggle("mv_pl_next",!!e&&i<e.list.length-1)},showVideo(e,i){if(i&&checkEvent(i))return!0;var o=VideoPlaylist.getCurList();if(o){if(VideoPlaylist.saveScrollPos(),mvcur.options.params&&"direct"==mvcur.options.params.module&&mvcur.mvPrevLoc&&Videoview.backLocation(),o.loaded&&o.loaded.vid==e){var t=o.loaded;Videoview.show(null,e,t.listId,extend(t.options,{playlistId:o.id})),Videoview.showVideo.apply(Videoview,t.hubData);var a=mvcur.preloadStatsHashes?mvcur.preloadStatsHashes[e]:"";a&&ajax.post("al_video.php?act=a_inc_preload_stats",{stat_preload_hash:a}),o.loaded=!1}else{var r=VideoPlaylist.getVideoIndex(e),d=(o.reversed?o.list.length-1-r:r)<o.list.length-1?1:0;showVideo(e,"",{autoplay:1,playlistId:o.id,addParams:{force_no_repeat:1,show_next:d},module:Videoview.getVideoModule()})}return!1}},saveScrollPos(){var e=VideoPlaylist.getBlock(),i=domByClass(e,"mv_playlist_list");(0,t.data)(e,"savedScrollTop",i.scrollTop)},restoreScrollPos(){var e=VideoPlaylist.getBlock(),i=domByClass(e,"mv_playlist_list"),o=(0,t.data)(e,"savedScrollTop");o&&(i.scrollTop=o)},_queueNextVideo(e){var i=VideoPlaylist.getCurList();if(i){e=e||i.current;var o=VideoPlaylist._getNextVideoIndex(e);if(-1!=o){var t=i.list[o],a=isArray(t)?t[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+t[VideoConstants.VIDEO_ITEM_INDEX_ID]:t.vid,r=isArray(t)?"":t.hash;if(i.queued!=a&&(!i.loaded||i.loaded.vid!=a)){i.loaded=!1,i.queued=a;var d=(i.reversed?i.list.length-o:o)<i.list.length-1?1:0;showVideo(a,r,{hidden:function(e,o,t,a){i.queued==a&&(i.loaded={vid:a,hubData:e,options:o,listId:t}),i.queued=!1},module:Videoview.getVideoModule(a),addParams:{autoplay:1,force_no_repeat:1,preload:1,show_next:d,playlist_id:i.id}})}}}},getNextVideos(){var e=[];if(!(VideoPlaylist.isAutoplayEnabled()||window.mvcur&&mvcur.player))return e;var i=VideoPlaylist.getCurList(),o=VideoPlaylist._getNextVideoIndex();if(!i||o<0)return e;for(;e.length<3&&o>=0&&o<i.list.length;){var t=i.list[o],a=void 0;a=isArray(t)?{vid:t[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+t[VideoConstants.VIDEO_ITEM_INDEX_ID],thumb:t[VideoConstants.VIDEO_ITEM_INDEX_THUMB],views:getLang("video_N_views_list",t[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],!0),title:t[VideoConstants.VIDEO_ITEM_INDEX_TITLE],duration:t[VideoConstants.VIDEO_ITEM_INDEX_DURATION]}:t,e.push(a),o+=i.reversed?-1:1}return e},prevVideo(){var e=VideoPlaylist.getCurList();if(e){var i=VideoPlaylist.getVideoIndex()+(e.reversed?1:-1);if(!(i<0)){var o=e.list[i],t=isArray(o)?o[0]+"_"+o[1]:o.vid;VideoPlaylist.showVideo(t)}}},nextVideo(){var e=VideoPlaylist.getCurList();if(e){var i=VideoPlaylist._getNextVideoIndex();if(!(i<0)){var o=e.list[i],t=isArray(o)?o[0]+"_"+o[1]:o.vid;VideoPlaylist.showVideo(t)}}},getVideoIndex(e){var i=VideoPlaylist.getCurList();if(!i)return-1;if(e||(e=i.current),!e)return-1;var o=-1;return each(i.list,((i,t)=>{if((isArray(t)?t[0]+"_"+t[1]:t.vid)==e)return o=i,!1})),o},_getNextVideoIndex(e){var i=VideoPlaylist.getCurList();if(!i)return-1;var o=VideoPlaylist.getVideoIndex(e);if(o<0)return 0;var t=o+(i.reversed?-1:1);return t>=0&&t<i.list.length?t:-1}}},485048:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(530522),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(991181),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(579665),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(95767),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(283946),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(66108),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(296253),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(751876),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(21466),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(59357),_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(414914),_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(705456),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(791563),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(719016),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(519921),_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(917999),_web_lib_fx__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(190148),_web_likes_helpers__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(283767),_video_donate__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(642139),_video_playlist__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(225046),_video_chat__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(616515),_video_initializer__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(354108),_player_callback__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(513750),_moder_actions__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(848512),_admin_actions__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(218549),_web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(45150),_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(506362),_web_gifts_gifts__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(255528),_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(496495);function _slicedToArray(e,i){return _arrayWithHoles(e)||_iterableToArrayLimit(e,i)||_unsupportedIterableToArray(e,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,i){if(e){if("string"==typeof e)return _arrayLikeToArray(e,i);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,i):void 0}}function _arrayLikeToArray(e,i){(null==i||i>e.length)&&(i=e.length);for(var o=0,t=new Array(i);o<i;o++)t[o]=e[o];return t}function _iterableToArrayLimit(e,i){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],t=!0,a=!1,r=void 0;try{for(var d,n=e[Symbol.iterator]();!(t=(d=n.next()).done)&&(o.push(d.value),!i||o.length!==i);t=!0);}catch(e){a=!0,r=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw r}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var CONTAINER_MIN_WIDTH=960,CONTAINER_SIDE_PADDING=72,CONTAINER_VERTICAL_SIDE_PADDING=15,INFO_HEADER_PADDING_DEFAULT=115,VIDEO_RATIO_DEFAULT=16/9;const __WEBPACK_DEFAULT_EXPORT__={FLASH_MIN_VERSION:24,isFS:!1,playerCallback:_player_callback__WEBPACK_IMPORTED_MODULE_21__.default,moderActions:_moder_actions__WEBPACK_IMPORTED_MODULE_22__.default,adminActions:_admin_actions__WEBPACK_IMPORTED_MODULE_23__.default,cleanUpStoredVSegs(){if(window.localStorage){var e=Date.now();for(var i in window.localStorage)if(0===i.indexOf("vsegs")){var o=localStorage.getItem(i);e-(o=JSON.parse(o)).ts>1728e5&&localStorage.removeItem(i)}}},getVideoModule(){var e=cur.currentModule?cur.currentModule():cur.module;return cur.storyLayer?"story":window.VideoUpload&&nav.objLoc.hasOwnProperty("section")&&"upload"===nav.objLoc.section?"upload":(window.Video&&Video.isInVideosList()&&(e=cur.oid<0?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos"),"feed"==e&&"feed_block"==_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getCurListId()&&(e="feed_block"),"feed"==e&&"videos"==cur.section&&(e="feed_videos"),"feed"==e&&"live"==cur.section&&(e="feed_live"),e||"")},getVideoContext(){if("video_search"===Videoview.getVideoModule())return nav.objLoc.q;if("audio"===cur.module){var e=cur.audioPage&&cur.audioPage.getCurrentSection();if(e)return e;if(0===nav.strLoc.indexOf("artist/"))return"artist_page"}return""},getContextPlaylistId:()=>window.mvcur&&mvcur.options&&mvcur.options.playlistId,getLayoutType(){var e,i=Videoview.getPlayerObject();if(null==i||null===(e=i.isFullscreen)||void 0===e?void 0:e.call(i))return"fullscreen";var o=Videoview.getMvData();if(o){if(o.inline)return"inline";if(o.embed)return"embed"}return Videoview.isLayerShown()?Videoview.isMinimized()?"minimized":window.mvcur&&mvcur.options&&mvcur.options.playlistId?"layer_with_playlist":"layer":cur.storyLayer&&cur.storyLayer.activeStory.isActiveLive()?"story_layer":""},sendPlayerStats(e,i){ajax.post("al_video.php?act=a_player_stat",{action:e,type:i})},otherVideosStats(e){e=extend({},e),ajax.post("al_index.php?act=a_other_videos_navigation",e)},removeVideo(){var e=Videoview.getMvData();e&&e.deleteFromAllAlbumsHash&&(ajax.post("al_video.php?act=a_delete_from_all_albums",{vid:e.vid,oid:e.oid,target_id:vk.id,hash:e.deleteFromAllAlbumsHash}),e.playlists&&each(e.playlists,((e,i)=>{i.added=!1})),window.mvcur&&Videoview.initAddButton(),e.added=!1,removeClass(geByClass1("mv_finish_add","mv_external_finish"),"selected"))},bookmarkVideo(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=Videoview.getMvData();if(i&&i.bookmarkHash){window.bookmark(i.oid,i.vid,i.bookmarkType,i.bookmarkHash,e,i.itemAccessHash);var o=document.querySelector("[data-videoview-bookmarked]");o&&(e=!e,o.innerHTML=e?getLang("global_remove_from_bookmarks"):getLang("global_add_to_bookmarks"),domData(o,"videoview-bookmarked",intval(e)))}},bookmarkVideoFromMenu(e){var i=!!intval(domData(e,"videoview-bookmarked"));Videoview.bookmarkVideo(i);var o=Videoview.getPlayerObject();o&&o.onBookmarked&&o.onBookmarked()},getNextVideosData:()=>_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getNextVideos().slice(0,3),getSuggestionsData(){var e=Videoview.getMvData();return e&&e.playerSuggestions||[]},getMvData:()=>cur.mvOpts||window.mvcur&&mvcur.mvData,getPlayerObject:()=>window.mvcur&&mvcur.player||cur.videoInlinePlayer||ge("video_yt")&&window.VideoYoutube||null,playerOnAdded(){var e=Videoview.getPlayerObject();e&&e.onAdded&&e.onAdded()},playerOnLiked(e){var i=Videoview.getPlayerObject();i&&i.onLiked&&i.onLiked(e)},playerOnResize(){mvcur.player&&mvcur.player.resize();var e=ge("video_player"),i=getSize(e);toggleClass(e,"VideoPlayer--minimizedSmall",i[0]<500||i[1]<200),ge("video_yt")&&window.VideoYoutube&&window.VideoYoutube.onResize()},playerNextTimerUpdate(){var e;mvcur.scrolledAway||mvcur.replyFormShown||"visible"!=document.visibilityState||curBox()?(e="nextTimerReset",mvcur.nextTimerStopped=!0):(e="nextTimerStart",mvcur.nextTimerStopped=!1),mvcur.playerPrevTimerFunc!=e&&(mvcur.playerPrevTimerFunc=e,clearTimeout(mvcur.playerTimerDebounce),mvcur.playerTimerDebounce=setTimeout((function(){var i=Videoview.getPlayerObject();i&&i[e]&&i[e](),mvcur.nextTimer&&mvcur.nextTimer[e]&&mvcur.nextTimer[e]()}),0))},togglePlay(e,i){if(ge("video_yt")&&window.VideoYoutube)VideoYoutube.togglePlay(e);else if(!(window.mvcur&&mvcur.mvData&&mvcur.mvData.restriction)){var o=window.mvcur&&mvcur.player||cur.videoInlinePlayer;if(window.mvcur&&mvcur.player||cur.videoInlinePlayer)o.isAutoplay()&&!i||o.togglePlay(e)}},sendVideoAdStat(e,i,o){if(cur._vadStatQueue&&cur._vadStatQueue[e+"_"+i]){var t=cur._vadStatQueue[e+"_"+i],a=void 0!==cur.vSearchPos&&null!==cur.vSearchPos;t.events.length&&(ajax.post("al_video.php?act=ads_stat",{ev:t.events.join(","),ad_type:t.type,hash:o,oid:e,vid:i,err:t.err,pl_type:t.pl_type,app_version:t.app_version,from_search:a,module:Videoview.getVideoModule()}),t.events=[])}},subscribeToAuthor(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mv_subscribe_block",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mv_state_subscribed",a=Videoview.getMvData();if(e||!a.isClosedGroup&&!a.isFriend)n();else{var r,d;a.isFriend?(r=getLang("video_unfollow_friend_title"),d=getLang("video_unfollow_friend_text")):(r=getLang("video_leave_closed_group_title"),d=a.adminLevel>constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR?getLang("video_leave_admined_group_text"):getLang("video_leave_closed_group_text"));(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(r,d,getLang("box_yes"),(function(){curBox().hide(),n()}),getLang("box_no")),Videoview.playerNextTimerUpdate()}function n(){toggleClass(o,t,e),ajax.post("al_video.php?act=a_subscribe",{author_id:a.authorId,video:a.videoRaw,hash:a.subscribeHash,unsubscribe:intval(!e),from:i||"videoview"},{}),a.subscribed=e;var r=Videoview.getPlayerObject();r&&r.onSubscribed&&r.onSubscribed(e);var d=ge("mv_finish_subscribe_btn");d&&(val(d,getLang(e?"video_view_subscribed_msg":"video_view_subscribe_to_author")),toggleClass("mv_finish_subscribe","mv_finish_subscribed",e))}},subscribeLive(e,i){var o=Videoview.getMvData(),t=!o.liveNotifySubscribed;ajax.post("al_video.php?act=a_subscribe_live",{owner_id:o.authorId,subscribe:intval(t),hash:i}),o.liveNotifySubscribed=!o.liveNotifySubscribed,toggleClass(e,"mv_subscribe_live_btn_subscribed",t),Videoview.onSubscribeLiveOver(e),window.tooltips&&e.tt&&tooltips.rePositionTT(e.tt)},onSubscribeLiveOver(e){var i=Videoview.getMvData();(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:function(){return getLang(i.liveNotifySubscribed?"video_live_notify_subscribed":"video_live_notify_unsubscribed")},black:1,shift:[0,10,0],needLeft:1})},showDonateBox(){var e=Videoview.getMvData();e&&showBox("al_video.php?act=donate_box",{video:e.videoRaw},{onDone(e,i){_video_donate__WEBPACK_IMPORTED_MODULE_17__.default.init(i)},params:{hideButtons:1,onDestroy:_video_donate__WEBPACK_IMPORTED_MODULE_17__.default.onDestroy},stat:["videoview.css",jsc("web/tooltips.js"),"tooltips.css"]})},slideLiveGifts(e,i,o){var t=ge("mv_live_gifts_list"),a=t.scrollWidth,r=domPN(t).clientWidth;e=e||1,i=Math.abs(i)||r-180;var d=intval(domData(t,"pos"));d+=e<0?-i:i,d=Math.max(0,Math.min(a-r,d)),domData(t,"pos",d),toggleClass(t,"animated",!o),setStyle(t,{"-webkit-transform":"translateX(-"+d+"px)","-ms-transform":"translateX(-"+d+"px)",transform:"translateX(-"+d+"px)"}),Videoview.onLiveGiftsScroll()},onLiveGiftsMouseWheel(e){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||(e.preventDefault(),Videoview.slideLiveGifts(e.deltaX,e.deltaX,!0))},onLiveGiftsScroll(){var e=ge("mv_live_gifts_list");if(e){var i=domPN(e),o=e.scrollWidth,t=domPN(e).clientWidth,a=intval(domData(e,"pos"));a>o-t&&(Videoview.slideLiveGifts(1,1,1),a=intval(domData(e,"pos")));var r=a>0,d=a+t<o,n=domByClass(i,"mv_live_gifts_arrow_left"),s=domByClass(i,"mv_live_gifts_arrow_right");toggleClass(n,"hidden",!r),toggleClass(s,"hidden",!d),mvcur.liveGiftTT&&mvcur.liveGiftTT.hide()}},getLiveBalanceStr(){var e;return e=mvcur.mvData.paymentsInMoney?getLang("global_money_amount_rub",vk.balance*vk.vcost,!0):getLang("global_n_votes",vk.balance,!0),langStr(getLang("video_live_you_have_X_money"),"money",e)},showLiveGiftTooltip(e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.data)(e,"ett")){Videoview.checkLiveGiftItemVisibility(e);var i=domData(e,"id"),o=domData(e,"price"),t=domData(e,"price-str"),a=domData(e,"free-left"),r=getTemplate("video_live_gift_popup",{gift_id:i,image:"/images/gift/"+i+"/256.png",price:o,price_str:t,balance_str:a||Videoview.getLiveBalanceStr()});addClass(e,"active");var d=mvcur.liveGiftTT=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_24__.default(e,{cls:"feature_intro_tt mv_live_gift_popup_tt",content:r,width:230,autoShow:!1,appendTo:domClosest("mv_live_gifts_block",e),offset:[0,14],onBeforeHide:function(){removeClass(e,"active")},onHide:function(){d.destroy()}});d.show()}},checkLiveGiftItemVisibility(e){var i=ge("mv_live_gifts_list"),o=domPN(i),t=e.getBoundingClientRect(),a=o.getBoundingClientRect();if(t.left<a.left+32){var r=t.left-a.left-32;Videoview.slideLiveGifts(-1,r,!0)}else if(t.right>a.right-32){var d=t.right-a.right+32;Videoview.slideLiveGifts(1,d,!0)}},sendLiveGift(e,i,o){Videoview.liveDonateCheckVotes(i)||ajax.post("al_video.php?act=live_send_gift",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,gift_id:e,hash:o},{onDone:function(i,o){if(updateMoney(i),o){var t=domByClass("mv_live_gifts_block",`mv_live_gifts_item_${e}`);each(o,(function(e,i){e=e.replace(/_/g,"-"),domData(t,e,i)}))}},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(getLang("global_error"),e),!0}}),mvcur.liveGiftTT.hide()},showLiveSuperMessageTooltip(e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.data)(e,"ett")){addClass(e,"active");var i=getTemplate("video_live_super_message_popup",{message:mvcur.liveSuperMessageDraft||""}),o=mvcur.liveGiftTT=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_24__.default(e,{cls:"feature_intro_tt mv_live_gift_popup_tt",content:i,width:230,autoShow:!1,appendTo:domClosest("mv_live_gifts_block",e),offset:[0,14],onBeforeHide:function(){removeClass(e,"active")},onHide:function(){o.destroy()}});o.show(),elfocus("mv_live_gift_popup_comment_input")}},checkLiveSuperMessageLength(e,i){var o=trim(val(e)),t=intval(domData(e,"maxlength"));mvcur.liveSuperMessageDraft=o;var a=o.length>t,r=domNS(e),d=domNS(r);toggle(r,!a),toggle(d,a),i&&r.click()},onLiveSuperMessageCtrlEnter(){var e=ge("mv_live_gift_popup_comment_input");Videoview.checkLiveSuperMessageLength(e,!0)},sendLiveSuperMessage(e,i){var o=ge("mv_live_gift_popup_comment_input"),t=trim(val(o));t?(Videoview.liveDonateCheckVotes(e)||ajax.post("al_video.php?act=live_send_super_message",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,message:t,hash:i},{onDone:function(e,i){updateMoney(e),delete mvcur.liveSuperMessageDraft},onFail:function(e){if(e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(getLang("global_error"),e),!0}}),mvcur.liveGiftTT.hide()):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(o)},liveDonateCheckVotes:e=>vk.balance<e&&_web_gifts_gifts__WEBPACK_IMPORTED_MODULE_26__.Gifts.showGetMoneyBox(),onStickersPurchased(e){var i=Videoview.getPlayerObject();i&&i.onStickersPurchased&&i.onStickersPurchased(e)},addPlaylist(onlyPrivate){showBox("al_video.php?act=add_playlist_box",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,only_private:onlyPrivate?1:0,hash:mvcur.mvData.addedVideoHash},{onDone:function onDone(box){box.removeButtons(),box.addButton(getLang("Save"),(function(btn){var title=trim(val("mv_video_playlist_edit_title")),privacy=Privacy.getValue("video_playlist");title&&ajax.post("al_video.php?act=a_save_playlist",{title,privacy,hash:val("video_playlist_edit_hash"),oid:mvcur.mvData.oid,vid:mvcur.mvData.vid},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton.pbind(btn),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton.pbind(btn),onDone:function onDone(playlistId,text,playlist,video){if(curBox().hide(),text&&showDoneBox(text),mvcur.mvData.playlists.push({id:playlistId,added:!0,title:clean(title),private:intval(privacy)}),Videoview.initAddButton(),window.Video&&playlist){var playlistEvalExpr=`(${playlist})`;try{playlist=eval(playlistEvalExpr)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,playlistEvalExpr)}if(Video.updateAlbum(playlistId,!1,playlist),video){var videoEvalExpr=`(${video})`;try{video=eval(videoEvalExpr)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,videoEvalExpr)}}}}})}))},stat:[jsc("web/privacy.js"),"privacy.css",jsc("web/video.js"),"video.css"]}),Videoview.playerNextTimerUpdate()},updateVideo(e,i,o,t,a){window.mvcur&&mvcur.mvData.oid==e&&mvcur.mvData.vid==i&&(mvcur.mvData.title=o,mvcur.mvData.desc=t,Videoview.setTitle(),Videoview.setDesc(),a&&(mvcur.mvShown?Videoview.reload():Videoview.recache()))},setAddButtonStateAdded(){window.mvcur&&mvcur.mvShown&&(mvcur.mvData.published=!0,triggerEvent("mv_add_button","setAdded"))},initAddButton(){mvcur.addButtonTT&&(mvcur.addButtonTT.destroy(),mvcur.addButtonTT=null);var e=ge("mv_add_button");if(e&&e instanceof HTMLElement){var i=Videoview.getMvData(),o=i.uploaded,t=i.noPublicAdd,a=!1;r(o||n(),!1,!0),mvcur.mvData.published&&(mvcur.addButtonTT=mvcur.addButtonTT||new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_24__.default(e,{cls:"mv_add_eltt",autoShow:!0,noHideOnClick:!0,onFirstTimeShow:function(e){var i="";each(mvcur.mvData.playlists,(function(e,o){if(!o.disabled||o.added||o.id!=mvcur.mvData.PLAYLIST_UPLOADED_ID){var t=o.private?`<span class="mv_tt_playlist_private_icon" onmouseover="showTooltip(this, { black: 1, text: '${getLang("video_album_is_private_tt")}', shift: [16, 8, 0] })"></span>`:"";i+=`\n              <div class="mv_tt_playlist">\n                <div class="checkbox ${o.added?"on":""} ${o.disabled?"disabled":""}" data-id="${o.id}" onclick="checkbox(this);">${o.title}</div>\n                ${t}\n              </div>\n            `}})),i=`\n            <div id="mv_pl_tt">\n              <div class="mv_tt_private_only ${t?"":"unshown"}">${getLang("video_only_private_video")}</div>\n              <div class="mv_tt_playlists ${t?" with_border":""}">\n                ${i}\n              </div>\n              <div class="mv_tt_add_playlist" role="link" tabindex="0" onclick="Videoview.addPlaylist(${t})">\n                <span class="mv_tt_plus_icon"></span>${getLang(t?"video_add_private_album":"video_add_album")}\n              </div>\n            </div>\n          `,val(e,i),each(geByClass("checkbox",e),(function(){addEvent(this,"click",s)}));var o=domByClass(e,"mv_tt_add_playlist");function a(e){var i=mvcur.addButtonTT.getContent();toggleClass(i,"mv_add_eltt_add_playlist_hover",e)}addEvent(o,"mouseenter",a.pbind(!0)),addEvent(o,"mouseleave",a.pbind(!1)),window.updateAriaCheckboxes()},onDestroy:function(e){e&&(each(geByClass("checkbox",e),(function(){removeEvent(this)})),removeEvent(domByClass(e,"mv_tt_add_playlist")))}}))}function r(t,r,n){t=o||t;var _=geByClass1("mv_added_icon",e),l=geByClass1("mv_plus_icon",e),v=(0,_web_likes_helpers__WEBPACK_IMPORTED_MODULE_28__.getElementLikeButtonLabel)(e);if(toggleClass(l,"mv_add_icon_curr",!t),toggleClass(l,"mv_add_icon_down",t),toggleClass(_,"mv_add_icon_curr",t),removeEvent(e,"click",d),removeEvent(e,"setAdded",d),t)v.innerHTML=getLang("video_added_to_my_playlist"),r&&s(!1,i.PLAYLIST_ADDED_ID);else{var c=!Videoview._isCurrentVideoPublished()&&mvcur.mvData.oid<0;v.innerHTML=c?getLang("video_add_to_group"):getLang("video_add_to_my_playlist"),addEvent(e,"click",d),addEvent(e,"setAdded",d)}n||a==t||Videoview.playerOnAdded(),a=t,i.added=t}function d(e){"click"==e.type&&mvcur.addButtonTT&&isAncestor(e.target,mvcur.addButtonTT.getContent())||(Videoview._isCurrentVideoPublished()?t&&"click"==e.type||r(!0,!0,"setAdded"==e.type):Videoview.showAddDialog(mvcur.videoRaw))}function n(){var e=!1;return each(mvcur.mvData.playlists,(function(i,o){if(o.added)return e=!0,!1})),e}function s(e,i){var o=!0;if(e){var t=e.currentTarget||e.target;if(hasClass(t,"disabled"))return;o=isChecked(t),i=+t.getAttribute("data-id")}else mvcur.addButtonTT.getContent()&&each(geByClass("checkbox",mvcur.addButtonTT.getContent()),(function(){if(domData(this,"id")==i)return checkbox(this),!1}));each(mvcur.mvData.playlists,(function(e,t){if(t.id==i)return t.added=o,!1})),ajax.post("al_video.php?act=a_add_to_playlist",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,hash:mvcur.mvData.playlistAddHash,playlist_id:i,add:+o,info:window.Video&&Video.isInCatalog()?_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getCurListId():"",module:Videoview.getVideoModule(),context:Videoview.getVideoContext()},{onFail:function(){+o&&(window.tooltips&&tooltips.destroyAll(),r(!1))}}),e&&(r(n()),cancelEvent(e))}},locNav(e,i,o){(o=nav.toStr(o)).match(/^video(-?\d+_\d+)$/)||Videoview.hide()},showPlayer(e){var i=ge("video_player");i&&(e||!i.getAttribute("preventhide")||browser.safari_mobile)&&(browser.msie&&setStyle(i,{position:"static",top:0}),browser.safari_mobile?show(i):i.style.visibility="visible")},hidePlayer(e){var i=ge("video_player");i&&(e||!i.getAttribute("preventhide")||browser.safari_mobile)&&(browser.msie&&setStyle(i,{position:"absolute",top:"-5000px"}),browser.safari_mobile?hide(i):i.style.visibility="hidden")},init(e){window.mvcur={},window.mvLayer?toggleClass(window.mvLayer,"mv_layer--vertical",!!e.shortVideo):(window.mvLayer=ce("div",{id:"mv_layer"}),toggleClass(window.mvLayer,"mv_layer--vertical",!!e.shortVideo),addEvent(window.mvLayer,"mousemove",(function(){mvcur.mousemoved=!0,mvcur.blackout&&Videoview.moveCheck()})),window.mvLayerWrap=ce("div",{id:"mv_layer_wrap",className:"fixed layer_wrap"}),mvLayerWrap.appendChild(window.mvLayer),bodyNode.appendChild(mvLayerWrap),setStyle(window.mvLayer,{width:lastWindowWidth-(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.sbWidth)()-2+"px"}),addEvent(mvLayerWrap,"scroll",Videoview.viewScroll))},moveCheck(){mvcur.mousemoved?mvcur.blackout&&(mvcur.blackout=!1,isVisible(window.layerBG)?animate(window.layerBG,{opacity:.8},200):setStyle(window.layerBG,{opacity:.8})):mvcur.blackout||mvcur.finished||!isVisible(window.layerBG)||(mvcur.blackout=!0,animate(window.layerBG,{opacity:.9},5e3)),mvcur.mousemoved=!1},show(e,i,o,t){var a=window.ap;if(a&&a.isPlaying()&&(a.pause(),a.pausedByVideo=Date.now()),t&&t.autoplay&&Videoview.playerCallback.onVideoStreamPlaying(),e&&domClosest("bookmarks_row_type_video",e.target)){var r=_slicedToArray(i.split("_"),2),d=r[0],n=r[1];statlogsValueEvent("bookmarks_product_analytics",{item_type:"video",item_owner_id:intval(d),item_id:intval(n),time:window.getServerTime()})}debugLog("show video "+i);var s=window.mvcur&&mvcur.mvShown,_=window.mvcur&&mvcur.player;if(s&&(_&&domPN(_.el)===ge("video_player")?_.deinitVideo(!0):(val("mv_player_box",""),hide("mv_player_box"),show("mv_progress_box"))),window.mvcur&&clearInterval(mvcur.nextTimerUpdateInterval),window.mvcur&&mvcur.minimized){if(!t.nomin)return mvcur.videoRaw=i,mvcur.options=t,mvcur.listId=o,mvcur.mvData=!1,t.playlistId?Videoview.initPlaylistBlock(i,t.playlistId,t.catLoadMore):_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.removeBlock(),!0;t.prevLoc&&(mvcur.mvPrevLoc=t.prevLoc),debugLog("unminimizing in show"),Videoview.unminimize(!0,!1,!0)}if(t.queue&&(debugLog("pushing in videoview.show"),window.layerQueue.push(),t.queue=!1),!t.noLocChange&&nav.objLoc.z&&/^(video|clip)/.test(nav.objLoc.z)&&(cur.mvHistoryBack=cur.mvHistoryBack||1,cur.mvHistoryBack++),window.forcePauseAudio=!0,s||window.layerQueue.hide(),window.forcePauseAudio=!1,this.init(t),mvcur.showTime=(new Date).getTime(),removeEvent(window,"resize",Videoview.onResize),removeEvent(window,"focus blur",Videoview.onPageFocusChange),removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),removeEvent(document,"keydown",Videoview.onKeyDown),addEvent(window,"resize",Videoview.onResize),addEvent(window,"focus blur",Videoview.onPageFocusChange),addEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),addEvent(document,"keydown",Videoview.onKeyDown),window.boxQueue.hideAll(),layers.wrapshow(mvLayerWrap,.8),layers.fullhide=Videoview.hide,mvcur.nextTimerUpdateInterval=setInterval(Videoview.playerNextTimerUpdate,1e3),setTimeout((function(){layers.wrapshow(mvLayerWrap,.8),layers.fullhide=Videoview.hide}),0),mvcur.noLocChange=0,t.ad_video&&(t.hideInfo=1,t.noLocChange=1,mvcur.noLocChange=1),mvcur.noHistory=t.noLocChange||t.noHistory,mvcur.blackInterval=setInterval(Videoview.moveCheck,18e4),mvcur.videoRaw=i,mvcur.options=t,mvcur.listId=o,mvcur.mvData=!1,mvcur.mvShown=!0,mvcur.player=_,t.prevLoc?mvcur.mvPrevLoc=t.prevLoc:setTimeout((function(){Videoview.setLocation(t.noLocChange)}),0),e&&e.pageX&&e.pageY&&extend(mvcur,{mvOldX:e.pageX,mvOldY:e.pageY,mvOldT:vkNow()}),s?(Videoview.disableLayerContent(),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.destroy()):Videoview.buildLayerContent(),toggle("mv_info",!t.hideInfo),hide("mv_warning"),t.expandPlayer){mvcur.player=t.expandPlayer,t.expandPlayer=1;var l=domClosest("video_box_wrap",mvcur.player.el);ge("mv_player_box").appendChild(l),hide("mv_progress_box"),show("mv_player_box"),mvcur.player.onExpanded()}return t.playlistId?Videoview.initPlaylistBlock(i,t.playlistId,t.catLoadMore,!s):_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.removeBlock(),Videoview.cleanUpStoredVSegs(),t.minimized&&setTimeout(Videoview.minimize.bind(Videoview),0),!1},buildLayerContent(){var e="mv_dark";addClass(window.mvLayerWrap,e),addClass(window.layerBG,e),val(window.mvLayer,`\n  <div class="mv_layer_bg" onclick="return Videoview.hide(true, true, event, true);"></div>\n  <div id="mv_container" class="scroll_fix_wrap">\n    <div id="mv_box">\n      <div id="mv_approve" style="display: none;"></div>\n      <div id="mv_publish" style="display: none;"></div>\n      <div class="mv_min_header">\n        <div class="mv_min_control" onmousedown="return Videoview.hide(false, true);" role="button" tabindex="0" aria-label="${getLang("global_close")}">\n          <div class="mv_min_control_close"></div>\n        </div>\n        <div class="mv_min_control" onclick="return Videoview.unminimize();">\n          <div class="mv_min_control_max"></div>\n        </div>\n        <div class="mv_min_title" id="mv_min_title"></div>\n      </div>\n      <div id="mv_main" class="mv_main">\n        <div class="mv_pl_prev_wrap">\n          <div class="mv_playlist_controls" id="mv_pl_prev" onclick="return VideoPlaylist.prevVideo()">\n            <div class="mv_playlist_controls_icon"></div>\n          </div>\n        </div>\n        <div class="mv_pl_next_wrap">\n          <div class="mv_playlist_controls" id="mv_pl_next" onclick="return VideoPlaylist.nextVideo()">\n            <div class="mv_playlist_controls_icon"></div>\n          </div>\n        </div>\n        <div id="mv_progress_box">${getProgressHtml()}</div>\n        <div id="mv_player_box"></div>\n        <div class="VideoLayerInfo__topControlsWrap">\n          <div id="VideoLayerInfo__topControls">\n            <div onclick="return Videoview.hide(true, true, event, true);" class="mv_top_button mv_top_close" role="button" tabindex="0" aria-label="${getLang("global_close")}">\n              <div class="mv_close_icon"></div>\n            </div>\n            <div onclick="return Videoview.minimize(event);" class="mv_top_button mv_top_minimize">\n              <div class="mv_minimize_icon"></div>\n            </div>\n            <div onclick="return Videoview.toggleSideBlock(event);" class="mv_top_button mv_top_toggle_sideblock" id="mv_top_pl_toggle" role="button" tabindex="0">\n              <div class="mv_toggle_sideblock_icon"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div id="mv_moder_buttons_wrap">\n        <div id="mv_moder_buttons"></div>\n      </div>\n      <div class="mv_info" id="mv_info"></div>\n      <div id="mv_warning" style="display: none;"></div>\n    </div>\n  </div>\n  <div class="VerticalVideoLayerInfo__topControlsWrap">\n    <div id="VerticalVideoLayerInfo__topControls">\n      <div onclick="return Videoview.hide(false, true, event, true);" class="mv_top_button mv_top_close" role="button" tabindex="0" aria-label="${getLang("global_close")}">\n        <div class="mv_close_icon"></div>\n      </div>\n      <div onclick="return Videoview.minimize(event);" class="mv_top_button mv_top_minimize">\n        <div class="mv_minimize_icon"></div>\n      </div>\n    </div>\n  </div>\n    `),Videoview.updateSize()},disableLayerContent(){addClass("mv_info","mv_info_disabled")},initPlaylistBlock(e,i,o,t){if(!(window.mvcur&&mvcur.options&&mvcur.options.shortVideo)){var a=!!_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getBlock(),r=_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.buildBlock(i,e,t);if(r&&/^wall_/.test(i)&&_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.lists[i]&&cur.wallVideos&&cur.wallVideos[i]&&(_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.extendList(i,cur.wallVideos[i].list),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.updateBlockList(i)),r){ge("mv_main").appendChild(r);var d=_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getCurList().list.length;(window.Video&&Video.isInVideosList()&&vk.id==cur.oid||d<5)&&(a||_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.toggle(!1)),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(o)&&o(_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.updateBlockList.pbind(i)),setTimeout((function(){_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.restoreScrollPos(),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.updateScrollbar(),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.setCurVideo(e,a)}),0)}_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.toggleStateClasses(),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.updateControls(),Videoview.updateLayoutSizes()}},hide(e,i,o,t){if(window.mvcur&&(i||mvcur.mvShown)){if(i||!mvcur.minimized){if(!mvcur.noHistory&&!e){mvcur.noHistory=1,mvcur.forceHistoryHide=i,window.__adsUpdate("very_lazy");var a=cur.mvHistoryBack?-cur.mvHistoryBack:-1;return cur.mvHistoryBack=0,setTimeout((function(){mvcur.mvShown||(Videoview.destroyPlayer(),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.removeBlock())}),10),history.go(a)}if(mvcur.forceHistoryHide&&(i=mvcur.forceHistoryHide,mvcur.forceHistoryHide=!1),mvcur.statusVideo){var r=ge("mv_like_icon");if(r){var d=r.parentNode.tt;d&&d.container&&re(d.container),r.parentNode.tt&&delete r.parentNode.tt}}var n=mvcur.minimized;if(n&&(Videoview.unminimize(!0,!0,!0),mvcur.minimized=!1,e=!0),Wall.cancelEdit(!0),mvcur.replyFormShown&&Wall.hideEditReply(mvcur.post),(mvcur.mvData.duration>60||mvcur.mvData.is_live)&&!i&&!mvcur.finished)if((new Date).getTime()-mvcur.showTime>3e4&&!browser.safari_mobile){var s=i=>{i.keyCode==KEY.ENTER&&(_.hide(),Videoview.hide(e,!0))},_=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:getLang("video_are_you_sure_close_title"),bodyStyle:"padding: 20px; line-height: 160%;",forceNoBtn:1,onShow:function(){addEvent(document,"keydown",s)},onHide:function(){removeEvent(document,"keydown",s)}},getLang("video_are_you_sure_close"),getLang("box_yes"),(function(){_.hide(),Videoview.hide(e,!0)}),getLang("box_no"));return!0}if(cur.vSearchPos&&delete cur.vSearchPos,cur.vSearchLastActionTime&&(cur.vSearchLastActionTime=(new Date).getTime()),mvcur.finished||Videoview.logViewedPercentage(),!window.forcePauseAudio){var l=window.ap;l&&!l.isPlaying()&&l.pausedByVideo&&(vkNow()-l.pausedByVideo<18e4&&l.play(),delete l.pausedByVideo),window.Notifier&&Notifier.lcSend("video_hide")}n?hide(mvLayerWrap):(layers.wraphide(mvLayerWrap),layers.fullhide=!1),window.tooltips&&tooltips.destroyAll(cur.mvBox);var v="mv_dark";return removeClass(mvLayerWrap,v),removeClass(window.layerBG,v),mvcur.mvShown=!1,removeEvent(window,"resize",Videoview.onResize),removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),removeEvent(document,"keydown",Videoview.onKeyDown),clearInterval(mvcur.nextTimerUpdateInterval),mvcur.addButtonTT&&(mvcur.addButtonTT.destroy(),mvcur.addButtonTT=null),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.destroy(),Videoview.removeExternalVideoFinishBlock(),Videoview.destroyPlayer(),val("mv_player_box",""),n&&isVisible(layerWrap)||(debugLog("pop from videoview.hide"),setTimeout(window.layerQueue.pop,0)),mvcur.blackInterval&&clearInterval(mvcur.blackInterval),t&&nav.objLoc.z?(window.layerQueue.skipVideo=!0,delete nav.objLoc.z,delete nav.objLoc.list,delete nav.objLoc.claim,nav.setLoc(nav.objLoc)):mvcur.noLocChange||!0===e||(2===e?nav.setLoc(window.hab.getLoc()):Videoview.backLocation(),window.__adsUpdate("very_lazy")),window.__adsUpdate(),mvcur.bodyScrollTop=window.scrollNode.scrollTop,setTimeout((function(){if(void 0!==mvcur.bodyScrollTop&&(window.scrollNode.scrollTop=mvcur.bodyScrollTop,delete mvcur.bodyScrollTop),window.cur&&cur.promoVideo&&cur.aid&&"apps"===cur.module){var e=ge("apps_promo_video_thumb"+cur.aid);e&&showInlineVideo(cur.promoVideo,"",{module:"app_promo"},null,e)}}),0),!1}mvcur.noLocChange||!0===e||(2===e?nav.setLoc(window.hab.getLoc()):window.layerQueue.count()||Videoview.backLocation())}},destroyPlayer(){mvcur.player&&(mvcur.player.destroy(),delete mvcur.player),ge("video_yt")&&window.VideoYoutube&&window.VideoYoutube.destroy()},cmp(e,i){var o=e.length,t=i.length;return o<t?-1:o>t?1:e<i?-1:e>i?1:0},onKeyDown:e=>!1!==e.returnValue&&(e.keyCode==KEY.ESC?(mvcur.mvEditing?Videoview.cancelInline():Videoview.hide(),cancelEvent(e)):void 0),onResize(){Videoview.updateExternalVideoFinishBlock(),Videoview.updateReplyFormPos(),Videoview.onLiveGiftsScroll(),Videoview.updateLayoutSizes(),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.onResize(),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.updateScrollbar(),mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight()},onPageFocusChange(){setTimeout(Videoview.playerNextTimerUpdate,10)},onFullscreenChange(){Videoview.updateExternalVideoFinishBlock(),mvcur.chatMode&&(_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.onResize(),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.updateScroll())},updateLayoutSizes(){if(!mvcur.minimized){var e=document.documentElement,i=ge("mv_container"),o=ge("mv_main"),t=ge("mv_player_box"),a=ge("mv_progress_box"),r=ge("video_mvpl")||geByClass1("mv_chat",i)||geByClass1("mv_live_preparation",i),d=ge("mv_main_info"),n=ge("mv_reply_form"),s=geByClass1("mv_info_narrow_column",i),_=geByClass("mv_playlist_controls",i),l=hasClass(ge("mv_layer"),"mv_layer--vertical"),v=r?r.offsetWidth:0,c=INFO_HEADER_PADDING_DEFAULT;if(d){var m=isVisible(t)?t:a,u=getXY(m)[1]+m.offsetHeight,p=getXY(d)[1]+d.offsetHeight-u;p>c&&(c=p)}var h,w=window.innerWidth||e.clientWidth||bodyNode.clientWidth,g=window.innerHeight||e.clientHeight||bodyNode.clientHeight,y=w,f="auto",b=null,V=g;if(l){var D=geByClass1("VerticalVideoLayerInfo__scrollWrap"),C=geByClass1("VerticalVideoLayerInfo__mainInfoWrap"),E=geByClass1("VerticalVideoLayerInfo__commentsReply"),k=geByClass1("mv_comments_restricted_msg");if(b=h=(V=g-2*CONTAINER_VERTICAL_SIDE_PADDING)/16*9,y=h+310,f=V,D){var S=V;C&&(S-=C.offsetHeight),E&&(S-=E.offsetHeight),k&&(S-=k.offsetHeight),setStyle(D,{height:S}),mvcur.uiScroll||(mvcur.uiScroll=new uiScroll(D,{global:!0,theme:"videoview"}))}var P=geByClass1("VerticalVideoLayerInfo__effectsTitle");if(P){var L=geByClass1("VerticalVideoLayerInfo__effectsList");geByClass("VerticalVideoLayerInfo__effectWrap").length>3&&new uiScroll(L,{stopScrollPropagation:!1,theme:"thin-dark"}),new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_24__.default(P,{content:geByClass1("VerticalVideoLayerInfo__effectsListWrapper"),forceSide:"bottom",appendTo:D})}}else{var x=g-(CONTAINER_SIDE_PADDING+(V=(h=(y-=2*CONTAINER_SIDE_PADDING)-v)/VIDEO_RATIO_DEFAULT)+c);x<0&&(y=(h=(V-=Math.abs(x))*VIDEO_RATIO_DEFAULT)+v);var T=d?d.offsetWidth+(s?s.offsetWidth:0):0;(y<CONTAINER_MIN_WIDTH||y<T)&&(V=(h=(y=T<CONTAINER_MIN_WIDTH?CONTAINER_MIN_WIDTH:T)-v)/VIDEO_RATIO_DEFAULT)}if(setStyle(i,{height:f,width:y}),setStyle(o,{width:b}),setStyle(t,{height:V}),setStyle(a,{height:V}),_.length){var B=V/2;each(_,(function(e,i){setStyle(i,{paddingBottom:B,paddingTop:B})}))}if(!l&&n){var M=y-(s?s.offsetWidth:0),I=(M-(d?d.offsetWidth:0))/-2;setStyle(n,{marginLeft:Math.ceil(I),width:M}),Videoview.updateReplyFormPos()}}},updateSize(){if(mvcur.minimized)return!1;window.onBodyResize(),Videoview.onResize()},getPrevLoc(){for(var e in mvcur.mvPrevLoc={},nav.objLoc)"z"==e&&0==!nav.objLoc[e].indexOf(`video${mvcur.videoRaw}`)||(mvcur.mvPrevLoc[e]=nav.objLoc[e])},setLocation(e){if(mvcur.options.fromPreload){if(cur.is_showcase){var i=mvcur.listId.match(/video\/(id|club|public)?([0-9\-]*)/),o=i[1],t=parseInt(i[2]);mvcur.mvPrevLoc={0:"video/"+o+t}}else{var a=mvcur.listId.match(/([a-z]*)([0-9\-]*)/),r=parseInt(a[2]);mvcur.mvPrevLoc={0:"videos"+r},"videos"!=a[1]&&(mvcur.mvPrevLoc.section=a[1])}var d=mvcur.listId.match(/claim=([0-9]+)/);d&&d[1]&&(mvcur.mvPrevLoc.claim=d[1])}else e?mvcur.mvPrevLoc="z":Videoview.getPrevLoc();if(!e){var n=(mvcur.options.shortVideo?"clip":"video")+mvcur.videoRaw;mvcur.listId&&(n+="/"+mvcur.listId),mvcur.options.playlistId&&(n+="/pl_"+mvcur.options.playlistId);var s=extend(nav.objLoc,{z:n});/^video-?\d+/.test(nav.objLoc[0])&&(s[0]="videos"+cur.oid),nav.strLoc!=nav.toStr(s)&&(nav.setLoc(s),(mvcur.options||{}).fromQueue&&(mvcur.noHistory=1)),mvcur.options&&(mvcur.options.fromQueue=!1)}},backLocation(){if("z"==mvcur.mvPrevLoc||!mvcur.mvPrevLoc&&nav.objLoc.z){var e=clone(nav.objLoc);delete e.z,delete e.claim,nav.setLoc(e)}else if(mvcur.mvPrevLoc){mvcur.mvPrevLoc[0]&&mvcur.mvPrevLoc[0].match(/^videos-?\d+/)&&mvcur.mvData&&mvcur.mvData.artistHref?nav.setLoc({0:mvcur.mvData.artistHref.replace(/^\//,"")}):nav.setLoc(mvcur.mvPrevLoc)}else("video"==nav.objLoc[0]||nav.objLoc[0].match(/^video-?\d+_\d+/))&&nav.setLoc({0:"video"});mvcur.options.prevTitle&&(window.setDocumentTitle(stripHTML(mvcur.options.prevTitle)),delete mvcur.options.prevTitle),mvcur.noHistory=1},highlightComment(e){if(e=ge(e)){addClass(e,"VideoLayerInfo__commentHighlighting");var i=()=>{addClass(e,"VideoLayerInfo__commentHighlighting"),setTimeout((function(){removeClass(e,"VideoLayerInfo__commentHighlighting")}),1e3)},o=getXY(e,!0)[1];if(o<0||o>lastWindowHeight-200){var t=mvLayerWrap.scrollTop+o-50;animate(mvLayerWrap,{scrollTop:t},300,i)}else i()}},showComment(e){var i=ge("post"+e);return i?Videoview.highlightComment(i):Videoview.moreComments(e),!1},commActionDone(commId,from,text,del,script){var node=ge("post"+commId.split("_").join("video_")+from);if(node){var comment=domByClass(node,"reply_wrap"),msg=domByClass(node,"dld");if(!text)return re(msg),show(comment),"mv"==from?(++mvcur.mvData.commcount,++mvcur.mvData.commshown):(++cur.commentsCount,++cur.commentsShown),void Videoview.updateCommentsHeader(from);if(hide(comment),node.appendChild(se(text)),del?("mv"==from?(--mvcur.mvData.commcount,--mvcur.mvData.commshown):(--cur.commentsCount,--cur.commentsShown),Videoview.updateCommentsHeader(from)):"mv"==from&&Videoview.recache(),script)try{eval(script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,script)}Videoview.updateReplyFormPos()}},commAction(e,i,o,t,a){if("spam"!==e){var r=ge("post"+i+"video_"+o+a),d=domByClass(r,"post_actions"),n=ge("reply_"+e+i+"video_"+o+a);attr(r,"data-action",e),n&&tooltips.hide(n),ajax.post("al_video.php",{act:e+"_comment",comment:i+"_"+o,hash:t,videoview:1,from:a},{onDone:Videoview.commActionDone.pbind(i+"_"+o,a),showProgress:addClass.pbind(d,"post_actions_progress"),hideProgress:removeClass.pbind(d,"post_actions_progress"),stat:[jsc("web/privacy.js"),"privacy.css"]})}else this.showReportVideoCommentForm(i,o)},moreComments(e){if(isVisible("mv_comments_header")&&!hasClass(domFC(ge("mv_comments_header")),"pr")&&!(e&&Videoview.cmp(domFC(ge("mv_comments")).id,"post"+e)<0)){var i=Videoview.getMvData();ajax.post("al_video.php?act=video_comments",{offset:i.commshown,video:i.videoRaw},{onDone:function(i,o){Videoview.receiveComms(i,o,!0,e),e&&ge("post"+e)&&Videoview.showComment(e),Videoview.adaptRecomsHeight()},showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){var e=ge("mv_comments_header");mvcur.mvCommInfo=val(e),val(e,""),showProgress(e)})),hideProgress:function(){val("mv_comments_header",mvcur.mvCommInfo)}})}},updateCommentsHeader(e){if("review"!=e){var i=Videoview.getMvData(),o="";i.commcount>i.commshown&&(o=getLang("video_show_previous_comments",i.commcount-i.commshown)),i.commcount&&val("mv_comments_summary",getLang("video_comments_summary",i.commcount)),setStyle("mv_comments_summary",{display:i.commcount?null:"none"}),toggleClass("mv_comments_header","mv_comments_expanded",!o),toggleClass("mv_comments_summary","mv_comments_expanded",!o),val("mv_comments_header",o),Videoview.recache()}},onShowEditReply(){mvcur.replyFormShown=!0,Videoview.updateReplyFormPos(),Videoview.playerNextTimerUpdate()},onHideEditReply(){mvcur.replyFormShown=!1,mvcur.mvReplyTo=!1,Videoview.updateReplyFormPos(),setTimeout(Videoview.updateReplyFormPos,0),Videoview.playerNextTimerUpdate()},commentClick(e,i,o,t){Wall.checkReplyClick(e,i)||(mvcur.mvReplyTo=[o,t],Wall.replyTo(mvcur.post,t,o))},receiveComms(e,i,o,t){for(var a,r,d=ce("div",{innerHTML:e}),n=ge("mv_comments"),s=Videoview.getMvData(),_=a=domLC(n),l=getXY(a,!0)[1];r=domLC(d);){for(;a&&Videoview.cmp(a.id,r.id)>0;)a=domPS(a);a&&!Videoview.cmp(a.id,r.id)?(n.replaceChild(r,a),a=r):(a&&domNS(a)?n.insertBefore(r,domNS(a)):!a&&domFC(n)?o?n.insertBefore(r,domFC(n)):(--s.commshown,d.removeChild(r)):n.appendChild(r),o||++s.commcount,++s.commshown)}t&&_&&(mvLayerWrap.scrollTop+=getXY(_,!0)[1]-l),extend(mvcur.mvReplyNames,i),window.updateWndVScroll&&window.updateWndVScroll(),Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos()},commSaved(e){},sendComment(e,i,o){var t,a=ge("reply_field"+e),r=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.data)(a,"composer"),d=(mvcur.mvReplyNames[(mvcur.mvReplyTo||{})[0]]||[])[1],n=ge("reply_button"+e),s=(o=o||{}).stickerId;if(s)t={message:"",attach1_type:"sticker",attach1:s,sticker_referrer:o.sticker_referrer};else{if((t=r?Composer.getSendParams(r,Videoview.sendComment):{message:trim(val(a))}).delayed)return;if(!t.attach1_type&&(!t.message||d&&!d.indexOf(t.message)))return void elfocus(a)}ajax.post("al_video.php?act=post_comment",Wall.fixPostParams(extend(t,{video:mvcur.mvData.videoRaw,hash:mvcur.mvData.hash,videoviewer:1,from_oid:domData(domClosest("_submit_post_box",ge("reply_as_group"+mvcur.post)),"from-oid"),reply_to:(mvcur.mvReplyTo||{})[1]})),{onDone:function(i,o){Videoview.receiveComms(i,o),val("mv_comments_summary",getLang("video_comments_summary",mvcur.mvData.commcount)),Composer.reset(r),hide("reply_warn"+e),Wall.cancelReplyTo(e),mvLayerWrap.scrollTop=9e9,mvcur.player&&mvcur.player.vars.short_video&&(Wall.hideEditReply(mvcur.post),mvcur.uiScroll&&mvcur.uiScroll.scrollBottom()),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_25__.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(a)return(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(a,{text:e,showdt:200,forcetodown:0,slide:15}),elfocus(a),!0},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton.pbind(n),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton.pbind(n)})},activate(e,i,o){2==i?animate(e,{color:"#fff"},void 0!==o?0:200):animate(e,{opacity:1},200)},deactivate(e,i){2==i?animate(e,{color:"#777"},"undefined"!=typeof fast?0:200):animate(e,{opacity:.5},200)},addVideo(videoRaw,hash,obj,gid,accessHash,from){var url,params;return window.mvcur&&mvcur.statusVideo?(params={status:videoRaw,hash,from:from||"videoviewer"},url="al_video_external.php?act=external_add"):(params={video:videoRaw,hash,from:from||"videoviewer",module:Videoview.getVideoModule(),context:Videoview.getVideoContext(),info:window.Video&&Video.isInCatalog()?_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getCurListId():""},gid&&(params.gid=gid),url="al_video.php?act=a_add"),accessHash&&(params.access_hash=accessHash),ajax.post(url,params,{onDone:function onDone(text,row,hash,shareHash){if(obj&&val(domPN(obj),text),!isArray(row))try{row=eval("("+row+")")}catch(e){}window.mvcur&&(mvcur.mvData&&mvcur.mvData.afterAdd?mvcur.mvData.afterAdd(row[0]+"_"+row[1],shareHash):row&&(mvcur.mvData.addedVideo=row[0]+"_"+row[1],mvcur.mvData.addedVideoHash=hash,mvcur.mvData.addedVideoShareHash=shareHash));var videoEl=ge("video_cont"+videoRaw);videoEl&&addClass(videoEl,"video_row_added"),"list"===from&&showDoneBox(text),Videoview.setAddButtonStateAdded()}}),!1},likeUpdate(e,i,o,t){i=intval(i);var a=Videoview.getMvData();a.likes=i,a.liked=e,window.Likes.update((window.mvcur&&mvcur.statusVideo?"wall":"video")+a.videoRaw,{like_num:i,like_my:e});var r=ge("mv_like_wrap"),d=domByClass(r,"_count");if(d){var n=r.tt||{},s=clone(n.opts||{}),_=domByClass(n.container,"_value"),l=domByClass(n.container,"_content"),v=domByClass(n.container,"_title");o&&v&&val(v,o),_&&(_.value=i),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_16__.animateCount)(d,i),toggleClass(r,"my_like",e),toggleClass(r,"no_likes",!i),toggleClass(l,"me_hidden",!e),i?t||!n.el||isVisible(n.container)||o||tooltips.show(n.el,extend(s,{showdt:0})):n.el&&n.hide()}},_isCurrentVideoPublished(){var e=Videoview.getMvData();return e&&e.published},addSmall(e,i,o,t){Videoview._isCurrentVideoPublished()?(window.mvcur&&mvcur.mvShown?Videoview.setAddButtonStateAdded():Videoview.addVideo(e,i,!1,o,t),hide("video_add_action_link"),addClass(ge("mv_like_line"),"video_added"),addClass(geByClass1("mv_finish_add","mv_external_finish"),"selected"),Videoview.getMvData().added=!0):Videoview.showAddDialog(e)},showAddDialog(e){if(cur._recentAddedVideos=cur._recentAddedVideos||{},!cur._recentAddedVideos[e]){var i=Videoview.getMvData();showBox("al_video.php?act=show_add_video_box",{oid:i.oid,vid:i.vid},{onDone:function(o,t){t&&(o.removeButtons(),o.addButton(getLang("Save"),(function(o){var a=trim(val("mv_video_add_title"));if(!a)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)("mv_video_add_title");ajax.post("al_video.php?act=a_add_publish_video",{title:a,video_privacy:Privacy.getValue("video_add"),videocomm_privacy:Privacy.getValue("videocomm_add"),hash:t,oid:i.oid,vid:i.vid},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton.pbind(o),onDone:function(){cur._recentAddedVideos[e]=!0,Videoview.hide(!0,!0),Videoview.recache(e),showVideo(e,mvcur.listId)}})})))}})}},share(e,i,o){if(vk.id){var t=Videoview.getMvData();return t&&!t.addedVideo&&(t.addedVideo=t.videoRaw),(t||e)&&showBox("like.php?act=publish_box",{object:"video"+(t.addedVideo||e),action_type:o},{onDone:function(){Videoview.isLayerShown()&&Videoview.playerNextTimerUpdate()}}),!1}},like(e,i){var o;if(vk.id){var t=Videoview.getMvData();if(t){var a="video";t.shortVideo?a="clip":window.mvcur&&mvcur.statusVideo&&(a="wall");var r=a+t.videoRaw,d="";if(window.Video&&Video.isInCatalog()){var n=_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.getCurListId();d=Videocat.isTop3Playlist(n)?"featured":n}var s=t.liked?"a_do_unlike":"a_do_like";ajax.post(`like.php?act=${s}`,{hash:t.likeHash,short_view:1,from:"videoview",object:r,info:d,ref:mvcur.options.module||Videoview.getVideoModule(),track_code:null===(o=mvcur.options.addParams)||void 0===o?void 0:o.track_code},{onDone:Videoview.likeUpdate.pbind(!t.liked)}),i||Videoview.playerOnLiked(!t.liked),toggleClass(geByClass1("mv_finish_like","mv_external_finish"),"selected",!t.liked),Videoview.likeUpdate(!t.liked,t.likes+(t.liked?-1:1),null,i),Videoview.recache()}}},showEditBox(e,i,o,t){showBox("al_video.php?act=edit_box",{vid:e,oid:i,is_publish:+t},{containerClass:"video_edit",stat:[jsc("web/privacy.js"),"privacy.css",jsc("web/video.js"),"video.css","video_upload.js","video_edit.css",jsc("web/upload.js")]})},restoreVideo(e,i,o,t,a){var r=ge("mv_warning");return val(r,""),showProgress(r,"","pr_medium"),ajax.post("al_video.php?act=restore_video",{vid:e,oid:i,hash:o,from:t||"videoviewer"},{onDone:function(o){if("list"==t&&cur.restoreRaw&&cur.restoreRaw[i+"_"+e]){var a=ge(`video_row${i}_${e}`);val(a,cur.restoreRaw[i+"_"+e]),removeClass(a,"video_row_loading"),removeClass(a,"video_row_deleted"),setStyle(geByClass1("video_row_icon_delete",a),{opacity:.8})}hide("mv_warning"),show("mv_info"),cur.claimedVideoText&&(val("video_player",cur.claimedVideoText),cur.claimedVideoText="")},onFail:function(e){return setTimeout((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e).hide,5e3),!0}}),cancelEvent(a)},publish(e,i,o,t){t&&hasClass(t,"loading")||Videoview.showEditBox(i,e,null,!0)},stopStreaming(e,i){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(getLang("video_are_you_sure_stop_streaming_title"),getLang("video_are_you_sure_stop_streaming"),getLang("box_yes"),(function(){curBox().hide(),ajax.post("al_video.php?act=live_stop_streaming",{owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,hash:i},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton.pbind(e),onDone(){setTimeout((()=>Videoview.reload()),1500)},onFail:e=>((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(getLang("global_error"),e||getLang("global_error_occured")),!0)})}),getLang("box_no"))},deleteVideo(e,i,o,t,a,r,d){r&&hasClass(r,"loading")||ajax.post("al_video.php?act=delete_video",{vid:e,oid:i,hash:o,from:a,sure:t?1:0},{onDone:function(t,n,s,_,l){if(Videoview.recache(i+"_"+e),"sure"===t){Videoview.hidePlayer();var v=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:n,bodyStyle:"padding: 20px; line-height: 160%;"},s);v.setOptions({onHide:function(){Videoview.showPlayer()}}),v.removeButtons(),v.addButton(l,v.hide,"no"),v.addButton(_,(function(){v.showProgress(),Videoview.deleteVideo(e,i,o,!0,a,r,v.hide)}),"yes")}else if("result"===t&&(d&&d(s),"videoviewer"===a&&ge("mv_info")&&(hide("mv_info"),val("mv_warning",s),show("mv_warning"),hide("mv_publish")),window.Video&&Video.isInVideosList()))return!0},showProgress:!!r&&addClass.pbind(r,"loading"),hideProgress:!!r&&removeClass.pbind(r,"loading")})},deleteVideoOnClaim(e,i,o,t,a,r){Videoview.deleteVideo(e,i,o,t,a,r,(function(e){"videoviewer"==a&&(hide("mv_info"),cur.claimedVideoText=val("video_player"),val("video_player",e))}))},recache(e){!e&&window.mvcur&&mvcur.mvData.videoRaw&&(e=mvcur.mvData.videoRaw);var i=window.ajaxCache;for(var o in i)o.match(/^\/al_video\.php\?act=show/)&&o.match(new RegExp("&video="+e+"([^0-9]|$)",""))&&delete i[o]},setAdult(e,i,o,t,a){ajax.post("al_video.php?act=set_adult_video",{vid:i,oid:e,hash:o,value:t},{onDone:function(e,i){val(a,i),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockLink)(a)}})},encodingProcess(e,i){showBox("al_video.php?act=encoding_process_box",{oid:e,vid:i},{params:{width:600}})},updateEncodingProcess(e,i){ajax.post("al_video.php?act=encoding_process_action",{oid:e,vid:i},{onDone:function(o){var t=ge("encoding_process_data");t&&o&&(Videoview.proceedEncodingData(JSON.parse(o),t),setTimeout((function(){Videoview.updateEncodingProcess(e,i)}),1e3))}})},proceedEncodingData(e,i){var o="";for(var t in e)if(e.hasOwnProperty(t)){var a=e[t];if("object"==typeof a){if(0===a.length)continue;for(var r in o+=`<tr><td><b>${t}</b></td></tr>`,a)a.hasOwnProperty(r)&&(o+=`<tr><td>${r}</td><td>${a[r]}</td></tr>`)}else o+=`<tr><td><b>${t}</b></td><td>${a}</td></tr>`}val(i,`<table width="100%">${o}</table>`)},replaceLegal(e,i,o){showBox("al_video.php?act=replace_legal_box",{oid:e,vid:i,hash:o},{params:{width:600}})},restoreOriginal(e,i,o,t){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)("Confirm","restore original video?",getLang("box_yes"),(function(){ajax.post("al_video.php?act=restore_original",{vid:i,oid:e,hash:o},{onDone:function(e,i){nav.reload()}})}),getLang("box_no"))},spamVideo(e,i,o,t,a,r,d){t&&addClass(t,"loading"),ajax.post("al_video.php?act=spam_video",{vid:i,oid:e,hash:o,sure:r?1:0,from:a},{onDone:function(r,n,s,_,l){if(t&&removeClass(t,"loading"),Videoview.recache(e+"_"+i),"sure"==r){Videoview.hidePlayer();var v=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:n,bodyStyle:"padding: 20px; line-height: 160%;"},s);v.setOptions({onHide:function(){Videoview.showPlayer()}}),v.removeButtons(),v.addButton(l,v.hide,"no"),v.addButton(_,(function(){v.showProgress(),Videoview.spamVideo(e,i,o,t,a,!0,v.hide)}),"yes")}else if("result"==r){if(d&&d(),window.Video)if("videoviewer"==a)Video.removeFromLists(e+"_"+i);else if("list"==a)return val("video_row"+e+"_"+i,'<div class="video_row">'+s+"</div>"),Video.removeFromLists(e+"_"+i,!0),!0}else val(domPN(t),r)}})},licensed(e,i){var o=ge("mv_licensed_info");val(o,""),show(o),showProgress(o),ajax.post("al_video.php?act=change_licensed",{video:mvcur.mvData.videoRaw,hash:i},{showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){showProgress(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableEl)(e)})),hideProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.enableEl)(e),hideProgress(e)})),onDone:function(i,t){val(e,i),o&&(val(o,t),toggle(o,!!t))}})},claimed(e,i,o,t){i=domData(t,"action")||i,ajax.post("al_claims.php?act=a_"+i,{type:"video",id:mvcur.mvData.vid,owner_id:mvcur.mvData.oid,claim:e,extra:o},{showProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){showProgress(t),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableEl)(t)})),hideProgress:function(e){function i(){return e.apply(this,arguments)}return i.toString=function(){return e.toString()},i}((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.enableEl)(t),hideProgress(t)})),onDone:function(e){val(t,e),domData(t,"action","claim"==i?"unclaim":"claim")}})},setStyle(e,i,o){for(var t in i=ge(i),mvcur.restoreStyles||(mvcur.restoreStyles={}),o)o.hasOwnProperty(t)&&(mvcur.restoreStyles[e]||(mvcur.restoreStyles[e]={}),mvcur.restoreStyles[e][t]=i.style[t],i.style[t]=o[t])},restoreStyle(e,i){i=ge(i),setStyle(i,mvcur.restoreStyles[e])},showVideo(videoRaw,title,html,js,desc,opt){if(mvcur.mvShown&&videoRaw==mvcur.videoRaw)if(vk.id||html||mvcur.options.expandPlayer){if(title&&!html&&!mvcur.options.expandPlayer)return val("mv_player_box",'<div class="mv_video_unavailable_message_wrap"><div class="mv_video_unavailable_message">'+title+"</div></div>"),show("mv_player_box"),hide("mv_progress_box"),void hide("mv_info");if(opt=opt||{},addLangKeys(opt.lang,!0),cur.share_timehash=cur.share_timehash||opt.share_timehash,mvcur.post=opt.post,mvcur.maxReplyLength=opt.maxReplyLength,mvcur.maxChatReplyLength=opt.maxChatReplyLength,mvcur.maxDescriptionLength=opt.maxDescriptionLength,mvcur.mvData=opt.mvData,mvcur.videoRaw=opt.mvData.videoRaw,mvcur.commentsTpl=opt.commentsTpl,mvcur.mvMediaTypes=opt.media,mvcur.mvMediaShare=opt.share,mvcur.mvReplyNames=opt.names||{},mvcur.rmedia_types=opt.rmedia_types,mvcur.chatMode=!!opt.chatMode,mvcur.wallTpl=opt.wallTpl,mvcur.finished=!1,mvcur.preparationBlock=!1,opt.queueParams&&(mvcur.queueKey=opt.queueParams.key,mvcur.qversion=opt.qversion),opt.pl_list){var lists=JSON.parse(opt.pl_list);each(lists,((e,i)=>{_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.addList(i)})),Videoview.initPlaylistBlock(mvcur.videoRaw,mvcur.options.playlistId)}_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.toggleStateClasses(),Wall.cancelEdit(!0);var needRemin=!0;if(!mvcur.options.expandPlayer){var videoBoxWrap=domByClass("mv_player_box","video_box_wrap"),playerUnavailable=opt.player_unavailable||opt.is_flv&&browser.flash<Videoview.FLASH_MIN_VERSION;!playerUnavailable&&opt.is_vk_player&&mvcur.player&&domClosest("video_box_wrap",mvcur.player.el)===videoBoxWrap?(attr(videoBoxWrap,"id","video_box_wrap"+videoRaw),needRemin=!1):(mvcur.player&&re(mvcur.player.el),val("mv_player_box",html)),hide("mv_progress_box")}if(val("mv_info",desc),opt.moder_buttons&&(val("mv_moder_buttons",opt.moder_buttons),_moder_actions__WEBPACK_IMPORTED_MODULE_22__.default.pin(!0)),opt.player){var container=domByClass("mv_player_box","video_box_wrap");_video_initializer__WEBPACK_IMPORTED_MODULE_20__.default.initPlayer(container,opt.player.type,opt.player.params)}if(js){var jsExpr=`(function(){${js}})()`;try{eval(jsExpr)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,jsExpr)}}if(opt.publishAction){var publishAction=ge("mv_publish");val(publishAction,opt.publishAction),show(publishAction)}else hide("mv_publish");if(opt.livePreparationBlock)_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.removeBlock(),mvcur.preparationBlock=se(opt.livePreparationBlock),ge("mv_main").appendChild(mvcur.preparationBlock);else if(mvcur.chatMode){_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.removeBlock();var chatBlock=se(opt.chatBlock);ge("mv_main").appendChild(chatBlock),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.init(chatBlock,{forceStickerPack:opt.chatForceStickerPack}),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.toggleStateClasses(),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.updateScroll()}toggleClass("mv_box","_has_preparation",!!mvcur.preparationBlock&&!mvcur.minimized),toggleClass("mv_layer","mv_layer--vertical",!!mvcur.mvData.shortVideo),mvcur.mvData.shortVideo?window.mvLayer.setAttribute("scheme","vkcom_dark"):window.mvLayer.removeAttribute("scheme"),mvcur.mvData.shortVideo&&(_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.removeBlock(),mvcur.onReplyFormSizeUpdate=mvcur.onMediaChanged=()=>{Videoview.updateLayoutSizes()},mvcur.scrollBottom=()=>{mvcur.uiScroll.scrollBottom(0,!0)});var replyField=ge("reply_field"+mvcur.post);if(replyField&&placeholderInit(replyField,{editable:1}),mvcur.minimized&&needRemin&&Videoview.minimizePlayer(),mvcur.statusVideo){var statusCont=ge("like_count"+mvcur.mvData.videoRaw);if(statusCont){var tt=statusCont.parentNode.tt;tt&&tt.container&&re(tt.container),statusCont.parentNode.tt&&delete statusCont.parentNode.tt}}if(show("mv_player_box"),opt.player_unavailable&&ge("video_player")&&ge("video_player").focus(),window.updateWndVScroll&&window.updateWndVScroll(),(mvcur.options||{}).scroll&&(mvLayerWrap.scrollTop=mvcur.options.scroll,mvcur.options.scroll=0),toggle("mv_info",!mvcur.options.hideInfo&&!mvcur.mvData.noControls&&!mvcur.minimized),removeClass("mv_info","mv_info_disabled"),hide("mv_warning"),!mvcur.mvData.noControls){var titleWidth=!!mvcur.minimized&&mvcur.minSize.wrap.w;Videoview.setTitle(titleWidth),Videoview.initAddButton(),toggle(ge("mv_edit_button"),mvcur.mvData.editHash&&!mvcur.mvData.hideEdit&&!mvcur.mvData.editFromDropdown)}mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight(),Videoview.updateSize(),opt.queueParams&&stManager.add("notifier.js",(function(){Videoview.queueCheckUpdates(opt.queueParams)})),mvcur.mvData.uploaded||Videoview.recache(),mvcur.mvData.is_live&&setTimeout(Videoview.checkOtherLives.pbind(videoRaw),6e4)}else setTimeout((function(){Videoview.hide(!1,!0),showDoneBox(title)}),500)},adaptRecomsHeight(){var e=geByClass1("mv_info_wrapper","mv_info"),i=geByClass1("mv_info_narrow_column","mv_info"),o=mvcur.mvData.isMusicVideo?2:0;if(e&&i){var t=geByClass("mv_recom_item",i);show(...t);var a=t.length;each(t.reverse(),((t,r)=>{if(getSize(i)[1]<=getSize(e)[1]||a===o)return!1;hide(r),a--}))}},queueCheckUpdates(e){window.mvcur&&mvcur.mvShown&&mvcur.queueKey===e.key&&(window.Notifier&&Notifier.addKey(e,Videoview.queueReceiveUpdates),setTimeout(Videoview.queueCheckUpdates.pbind(e),25e3))},queueReconnect(e){var i=Videoview.getMvData(),o=i.oid,t=i.vid,a=o+"_"+t;e?ajax.post("al_video.php?act=get_queue_params",{oid:o,vid:t,hash:i.hash},{onDone:function(e){e&&Videoview.isLayerShown(a)&&(mvcur.queueKey=e.key,Videoview.queueCheckUpdates(e))},onFail:function(){return!0}}):(mvcur.queueReconnectDelay=mvcur.queueReconnectDelay?2*mvcur.queueReconnectDelay:500,setTimeout((function(){Videoview.isLayerShown(a)&&Videoview.queueReconnect(!0)}),mvcur.queueReconnectDelay))},queueReceiveUpdates(e,i){if(window.mvcur&&mvcur.mvShown&&mvcur.queueKey===e&&i){if(i.failed)return debugLog("video queue failed",i),mvcur.queueKey=null,void Videoview.queueReconnect();delete mvcur.queueReconnectDelay,mvcur.queueBatchId=(mvcur.queueBatchId||0)+1,each(i.events,(function(){var e=this.split("<!>"),i=e[0],t=e[1];if(i==mvcur.qversion)switch(t){case"new_reply":mvcur.chatMode||(Videoview.appendNewComment.apply(Videoview,e.slice(2)),Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos());break;case"new_reply_chat":var a=+e[10],r=!!e[11];mvcur.chatMode&&_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.receiveMessage.apply(_video_chat__WEBPACK_IMPORTED_MODULE_19__.default,e.slice(2)),r&&!a&&mvcur.player&&mvcur.player.pushDonation("comment",{senderId:e[4],senderName:e[5],senderPhoto:e[6],senderHref:e[7],senderSex:e[8],commentText:e[9]});break;case"edit_reply":var d=e[2],n=e[3],s=e[4],_=ge("wpt"+o(d,n));_&&!attr(_,"data-action")&&(val(_,psr(s)),Videoview.updateReplyFormPos());break;case"del_reply":var l=e[2],v=e[3];if(mvcur.chatMode)_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.receiveDelete(l,v);else{var c=ge("post"+o(l,v));c?attr(c,"data-action")||(mvcur.mvData.commcount--,mvcur.mvData.commshown--,re(c)):mvcur.mvData.commcount--,Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos()}break;case"like_reply":var m=e[2],u=e[3],p=+e[4],h=+e[5],w=e[6],g=ge("wpe_bottom"+o(m,u));if(g){var y=domByClass(g,"_like_wrap"),f=domByClass(y,"_count");val(f,p>0?p:""),toggleClass(y,"no_likes",!p),h==vk.id&&toggleClass(y,"my_like",!w)}break;case"like":var b=e[4],V=e[5];mvcur.chatMode&&!V&&_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.appendSticker("like",b);break;case"sticker":var D=e[3],C=e[4];mvcur.chatMode&&_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.appendSticker(D,C);break;case"video_view":Videoview.updateLiveViewersCount(e[2]);break;case"gift":mvcur.player&&mvcur.player.pushDonation("gift",{senderId:e[2],senderName:e[3],senderPhoto:e[4],senderHref:e[5],senderSex:e[6],giftId:e[7]});break;case"end_live":var E=domByClass("mv_publish","mv_stop_streaming_button");E&&(val(E,getLang("video_live_finished")),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableButton)(E,!0));break;case"live_midroll":if(mvcur.player){var k=e[2];mvcur.player.pushLiveMidroll(k)}break;case"set_action_button":var S=parseJSON(e[2]);mvcur.player.setActionButton(S);break;default:debugLog("unhandled video event",e)}}))}function o(e,i){return e+"video_"+i+"mv"}},appendNewComment(e,i,o,t,a,r,d,n,s,_,l){if(!ge("post"+e+"video_"+i+"mv")){var v=Videoview.getMvData(),c=v.adminLevel,m=v.canDeleteComments,u="";c>constants.Groups.GROUPS_ADMIN_LEVEL_USER||m||e==vk.id||o==vk.id?u+=mvcur.commentsTpl.del_reply:e!=o&&(u+=mvcur.commentsTpl.spam_reply),(c>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&e==o||t==vk.id)&&(u+=mvcur.commentsTpl.edit_reply),u=rs(mvcur.commentsTpl.actions,{actions:u});var p=langDate(1e3*n,getLang("global_short_date_time","raw"),0,[]),h=psr(rs(mvcur.commentsTpl.reply,{actions:u,post_oid:e,reply_id:e+"video_"+i+"mv",reply_msg_id:i,from_id:o,name:t,photo:a,href:r,message:d,date:p,to_link:s,likes:window.Likes.makeTemplate(mvcur.commentsTpl.likes,{object_raw:`${e}_${i}`})}));mvcur.mvReplyNames[o]=[_,l],ge("mv_comments").insertAdjacentHTML("beforeend",h),mvcur.mvData.commcount++,mvcur.mvData.commshown++}},updateLiveViewersCount(e,i){if(e=intval(e)){var o=domByClass("mv_views","mv_live_spectators_count_text"),t=getLang("video_live_N_watching",e,!0);val(o,t)}if(i){var a=domByClass("mv_views","mv_live_spectators_friends"),r=i.map((function(e){return getTemplate("video_live_spectators_friend",e)})).reverse().join("");val(a,r)}},showLiveSpectatorsBox(){var e=Videoview.getMvData();showBox("al_video.php?act=live_spectators_box",{owner_id:e.oid,video_id:e.vid,hash:e.hash},{params:{grey:!0,hideButtons:!0,width:638,bodyStyle:"padding: 0; border: 0;",onShow:function(){addEvent(boxLayerWrap,"scroll",Videoview.onLiveSpectatorsScroll),setTimeout(Videoview.onLiveSpectatorsScroll,0)},onHide:function(){removeEvent(boxLayerWrap,"scroll",Videoview.onLiveSpectatorsScroll)}},onFail:function(e){return curBox().hide(),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(getLang("global_error_occured"),e),!0}})},onLiveSpectatorsScroll(){var e=lastWindowHeight,i=ge("video_spectators_more_link");isVisible(i)&&e>getXY(i,!0)[1]&&i.click()},loadMoreLiveSpectators(e){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.isButtonLocked)(e)){var i=mvcur.liveSpectatorsPerPage,o=mvcur.liveSpectatorsShown,t=mvcur.liveSpectatorsList.slice(o,o+i);if(t.length){var a=Videoview.getMvData();ajax.post("al_video.php?act=live_spectators_box",{owner_id:a.oid,video_id:a.vid,more:t.join(","),hash:a.hash},{onDone:function(t,a){var r=ge("video_spectators_rows");if(r.insertAdjacentHTML("beforeend",t),mvcur.liveSpectatorsShown=o+i,mvcur.liveSpectatorsShown>=mvcur.liveSpectatorsList.length&&hide(e),mvcur.liveSpectatorsShown>=mvcur.liveSpectatorsLimit){hide(e);var d=ge("video_spectators_bottom");r.appendChild(d),show(d)}},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton.pbind(e)})}}},checkOtherLives(e){mvcur.mvShown&&!mvcur.minimized&&mvcur.videoRaw==e&&(ajax.post("al_video.php?act=live_other_videos",{video:e},{onDone:function(i){Videoview.updateOtherLives(e,i)},onFail:function(){return!0}}),setTimeout(Videoview.checkOtherLives.pbind(e),6e4))},updateOtherLives(e,i){if(mvcur.mvShown&&mvcur.videoRaw==e){var o=domByClass(window.mvLayer,"mv_info_narrow_column");val(o,i),mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight()}},finishLivePreparation(e){var i=Videoview.getMvData();ajax.post("al_video.php?act=live_finish_preparation",{oid:i.oid,vid:i.vid,notify_followers:isChecked("mv_live_preparation_notify_followers"),hash:e},{onDone:()=>setTimeout((()=>Videoview.reload()),500)})},reload(){var e=mvcur.listId,i=Videoview.getMvData().videoRaw;Videoview.hide(!0,!0),Videoview.recache(i),showVideo(i,e,{autoplay:1})},onVideoShared(e,i,o){"publish"!=e||Videoview._isCurrentVideoPublished()||(Videoview.hide(!0,!0),setTimeout((function(){0==i.indexOf("video")&&(i=i.substr("video".length)),Videoview.recache(i),showVideo(i,o)}),100))},_onAddToCommunity(){showBox("al_video.php?act=add_to_club_pl_box",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid})},_onGetUmaInfo(){showBox("al_video.php",{act:"get_uma_restrictions",oid:mvcur.mvData.oid,vid:mvcur.mvData.vid},{params:{width:750}})},_onEdit(){var e=Videoview.getMvData(),i=e.oid,o=e.vid;Videoview.showEditBox(o,i)},_onDelete(){var e=Videoview.getMvData(),i=e.oid,o=e.vid,t=e.deleteHash;Videoview.deleteVideo(o,i,t,!1,"videoviewer")},_onExport(e){Videoview.sendVideo(!0,e)},_onF(){sfof(mvcur.mvData.oid,mvcur.mvData.vid,2)},_onB(){window.scblf("video",mvcur.mvData.oid,mvcur.mvData.vid)},_onGB(){window.scgbf("video",mvcur.mvData.oid,mvcur.mvData.vid)},_onViewStats(){showBox("al_stats.php",{act:"video_stat",oid:mvcur.mvData.stats.stat_oid,vid:mvcur.mvData.stats.stat_vid},{params:{width:795,bodyStyle:"padding: 0"}})},addToClubPlaylistCheckboxChanged(e){checkbox(e);var i=!1;each(geByClass("mv_add_to_club_albums_list_item"),((e,o)=>{if(isChecked(o))return i=!0,!1}));var o=ge("mv_add_to_club_albums_save");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableButton)(o,!1),i||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableButton)(o,!0)},addToClubPlaylistBoxInit(e,i,o){WideDropdown.deinit("add_to_pl_club_dd"),mvcur.addToClubPl=WideDropdown.init("add_to_pl_club_dd",{defaultItems:i,noResult:getLang("search_nothing_found"),introText:"choose",onChange:function(e,i){hide("mv_add_to_club_albums"),val("mv_add_to_club_albums_list",""),-1!=e?(show("mv_add_to_club_albums_progress"),ajax.post("al_video.php?act=a_get_club_playlists",{gid:i,oid:mvcur.mvData.oid,vid:mvcur.mvData.vid},{onDone:function(e){var o="",t=0;each(e,(function(i,a){var r=a.added||1===e.length;r&&t++,o+=`<div class="mv_add_to_club_albums_list_item checkbox ${r?"on":""}" data-id="${a.id}" onclick="Videoview.addToClubPlaylistCheckboxChanged(this)">${a.title}</div>`})),val("mv_add_to_club_albums_list",o),val("mv_add_to_club_gid",i),hide("mv_add_to_club_albums_progress"),e.length>1&&show("mv_add_to_club_albums");var a=ge("mv_add_to_club_albums_save");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableButton)(a,!1),t||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.disableButton)(a,!0)}})):val("mv_add_to_club_gid","")}}),setTimeout(elfocus.pbind("add_to_pl_club_dd_input"),0),e.removeButtons(),e.addButton(getLang("Save"),(function(e){var i=[];each(geByClass("mv_add_to_club_albums_list_item"),(function(e,o){isChecked(o)&&i.push(attr(o,"data-id"))})),ajax.post("al_video.php?act=a_add_to_playlist",{hash:o,gid:val("mv_add_to_club_gid"),oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,playlists:i.length?i:"0",module:Videoview.getVideoModule(),context:Videoview.getVideoContext()},{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton.pbind(e),onDone:function(e,i){curBox().hide(),i.added.length?showDoneBox(getLang("video_add_to_playlist_added")):showDoneBox(getLang("video_add_to_playlist_error"))}})}),null,!0).id="mv_add_to_club_albums_save"},setTitle(e){var i=mvcur.mvData.title||"",o=mvcur.mvData.subtitle||"";e=e||590,val("mv_min_title",Videoview._isCurrentVideoPublished()?stripHTML(i):""),setStyle("mv_min_title",{maxWidth:Math.max(0,e-70)});var t=ge("mv_title");t&&(val(t,i+o),setStyle(t,{display:"block"}),t.scrollHeight>t.offsetHeight&&attr(t,"title",replaceEntities(stripHTML(i))),setStyle(t,{display:""}))},timeTagClick(e,i){var o=Videoview.getPlayerObject();if(o){o.seekTo(e),o.play();var t=o.el.getBoundingClientRect();t.top<.5*-t.height&&(mvLayerWrap.scrollTop+=t.top)}return cancelEvent(i)},expandDescr(e){val("mv_descr_field",val("mv_desc_full_text")),Videoview.cleanExpandDescrEls()},cleanExpandDescrEls(){re(ge("mv_desc_full_text")),re(ge("mv_descr_expand_toggle"))},setDesc(){val("mv_descr_field",mvcur.mvData.desc||"")},getContSize:()=>(mvcur.contSize||(mvcur.contSize=getSize("mv_box")),mvcur.contSize),getContPlace(e){var i=0,o=Videoview.getContSize(),t=e.clientX-mvcur.minSize.wrap.l,a=e.clientY-mvcur.minSize.wrap.t;return a<6&&(i+=1),t>o[0]-20&&(i+=2),a>o[1]-10&&(i+=4),t<10&&(i+=8),1==i&&t>o[0]-55&&(i=0),!i&&a<25&&t<o[0]-55&&(i+=16),i},changeCursor(e){if(!Videoview.isFS){var i=Videoview.getContPlace(e),o="default";if(i&&mvcur.minimized){var t="";1&i&&(t+="n"),4&i&&(t+="s"),2&i&&(t+="e"),8&i&&(t+="w"),o=t+"-resize",16&i&&(o="move")}setStyle("mv_box",{cursor:o})}},getMinSize(){var e=ge("mv_player_box")||ge("mv_progress_box");extend(mvcur.minSize,{wrap:{t:intval(mvLayerWrap.style.top),l:intval(mvLayerWrap.style.left),w:intval(mvLayerWrap.style.width),h:intval(mvLayerWrap.style.height)},player:{w:intval(e.style.width),h:intval(e.style.height)}})},startDrag(e){if(!(Videoview.isFS||e.button&&1!==e.button)){var i=Videoview.getContPlace(e);if(i){var o=Date.now();Videoview.getMinSize(),extend(mvcur.minSize,{x:e.clientX,y:e.clientY}),mvcur.resizeDiff=0;var t=!i||16&i?Videoview.onMinMove:Videoview.onMinResize;mvcur.resizeMask=i;return addClass(mvLayerWrap,"mv_resizing"),addClass("mv_player_box","no_events"),addEvent(document,"mouseup",(function e(a){removeEvent(document,"mouseup",e),removeEvent(document,"mousemove",t),removeEvent(document,"drag",t);var r=Date.now();return Videoview.getMinSize(),mvcur.resizeDiff<8&&r-o<400&&(16&i||1==i)&&Videoview.unminimize(),removeClass(mvLayerWrap,"mv_resizing"),removeClass("mv_player_box","no_events"),addEvent("mv_box","mousemove",Videoview.changeCursor),ls.set("mv_minSize",mvcur.minSize),!1})),addEvent(document,"mousemove",t),addEvent(document,"drag",t),removeEvent("mv_box","mousemove",Videoview.changeCursor),cancelEvent(e)}}},onMinMove(e){var i=0,o=0;return e&&(o=e.clientY-mvcur.minSize.y,i=e.clientX-mvcur.minSize.x),mvcur.minSize.wrap.t+o>mvcur.minSize.ch-mvcur.minSize.wrap.h-15&&(o=mvcur.minSize.ch-mvcur.minSize.wrap.h-mvcur.minSize.wrap.t),mvcur.minSize.wrap.l+i>mvcur.minSize.cw-mvcur.minSize.wrap.w-15&&(i=mvcur.minSize.cw-mvcur.minSize.wrap.w-mvcur.minSize.wrap.l),mvcur.minSize.wrap.t+o<15&&(o=-mvcur.minSize.wrap.t),mvcur.minSize.wrap.l+i<15&&(i=-mvcur.minSize.wrap.l),setStyle(mvLayerWrap,{top:mvcur.minSize.wrap.t+o+"px",left:mvcur.minSize.wrap.l+i+"px"}),mvcur.resizeDiff=Math.max(Math.abs(i),Math.max(Math.abs(o),mvcur.resizeDiff)),!!e&&cancelEvent(e)},onMinResize(e){var i=mvcur.resizeMask,o=0,t=0,a=1&i||4&i?e.clientY-mvcur.minSize.y:0,r=2&i||8&i?e.clientX-mvcur.minSize.x:0;4&i&&mvcur.minSize.wrap.t+a>mvcur.minSize.ch-mvcur.minSize.wrap.h&&(a=mvcur.minSize.ch-mvcur.minSize.wrap.h-mvcur.minSize.wrap.t),1&i&&mvcur.minSize.wrap.t+a<0&&(a=-mvcur.minSize.wrap.t),2&i&&mvcur.minSize.wrap.l+r>mvcur.minSize.cw-mvcur.minSize.wrap.w-14&&(r=mvcur.minSize.cw-mvcur.minSize.wrap.w-mvcur.minSize.wrap.l-14),8&i&&mvcur.minSize.wrap.l+r<0&&(r=-mvcur.minSize.wrap.l),8&i&&(o=r,r=-r),1&i&&(t=a,a=-a),mvcur.minSize.wrap.w+r<307&&(r=307-mvcur.minSize.wrap.w,8&i&&(o=-r)),mvcur.minSize.wrap.h+a<200&&(a=200-mvcur.minSize.wrap.h,1&i&&(t=-a)),setStyle(mvLayerWrap,{left:positive(mvcur.minSize.wrap.l+o)+"px",top:positive(mvcur.minSize.wrap.t+t)+"px",width:mvcur.minSize.wrap.w+r+"px",height:mvcur.minSize.wrap.h+a+"px"});var d={width:mvcur.minSize.player.w+r+"px",height:mvcur.minSize.player.h+a+"px"};setStyle("mv_player_box",d),setStyle("mv_progress_box",d);var n=Math.abs(r)+Math.abs(a);return mvcur.resizeDiff=Math.max(n,mvcur.resizeDiff),mvcur.contSize=!1,Videoview.setTitle(mvcur.minSize.wrap.w+r),Videoview.playerOnResize(),Videoview.updateExternalVideoFinishBlock(),!1},minimize(e){if(e&&cancelEvent(e),mvcur.minimized)return!1;show("mv_min_header"),hide("mv_info"),hide("VerticalVideoLayerInfo__topControls"),hide("VideoLayerInfo__topControls"),isVisible("mv_approve")?(mvcur.needShowApprove=!0,hide("mv_approve")):mvcur.needShowApprove=!1,Wall.cancelEdit(!0),addClass(mvLayerWrap,"mv_minimized"),mvcur.minSize||(mvcur.minSize=ls.get("mv_minSize"));var i="mv_dark";removeClass(mvLayerWrap,i),removeClass(window.layerBG,i),layers.fullhide=!1,mvcur.minSize&&Videoview.enabledResize()&&mvcur.minSize.wrap.w||(mvcur.minSize={wrap:{w:307,h:200}}),mvcur.mvData.shortVideo&&(mvcur.minSize={wrap:{w:307,h:520}},setStyle(ge("mv_main"),{width:"auto"}));var o=mvcur.minSize.wrap;mvcur.minSize.player={w:o.w-12,h:o.h-34},Videoview.setStyle("mvContainer","mv_container",{height:"auto",marginTop:0,marginBottom:0,width:"auto"}),setStyle(window.mvLayer,{width:"auto"}),Videoview.minimizePlayer(),window.tooltips&&tooltips.destroyAll("mv_container"),removeEvent(window,"resize",Videoview.onResize),removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),removeEvent(document,"keydown",Videoview.onKeyDown),addEvent(window,"resize",Videoview.minResize),Videoview.enabledResize()?(addEvent("mv_box","mousedown",Videoview.startDrag),addEvent("mv_box","mousemove",Videoview.changeCursor),mvcur.minDestroy=function(){removeEvent("mv_box","mousedown",Videoview.startDrag),removeEvent("mv_box","mousemove",Videoview.changeCursor),setStyle("mv_box",{cursor:"default"})}):(addEvent(ge("mv_min_title"),"click",Videoview.unminimize),mvcur.minDestroy=function(){removeEvent("mv_min_title","click",Videoview.unminimize)}),Videoview.setTitle(o.w),Videoview.minResize(),Videoview.setStyle("mvLayerWrap",mvLayerWrap,{width:mvcur.minSize.wrap.w+"px",height:mvcur.minSize.wrap.h+"px"}),mvcur.minimized=!0,layers.wraphide(),setTimeout(Videoview.playerOnResize,10);var t=window.layerQueue.count();return mvcur.noLocChange||(Videoview.backLocation(),mvcur.noHistory=1),window.layerQueue.skipVideo=!0,t&&(debugLog("pop from minimize"),window.layerQueue.pop()),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.toggleStateClasses(),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.toggleStateClasses(),mvcur.preparationBlock&&removeClass("mv_box","_has_preparation"),Videoview.updateExternalVideoFinishBlock(),!1},isLayerShown:e=>!(!window.mvcur||!mvcur.mvShown||null!=e&&mvcur.videoRaw!=e),isMinimized:()=>!!(window.mvcur&&mvcur.mvShown&&mvcur.minimized),enabledResize:()=>!browser.mobile,minimizePlayer(){var e={width:mvcur.minSize.player.w+"px",height:mvcur.minSize.player.h+"px"};setStyle("mv_player_box",e),setStyle("mv_progress_box",e),Videoview.playerOnResize()},minResize(){mvcur.minSize.ch=window.innerHeight||htmlNode.clientHeight||bodyNode.clientHeight,mvcur.minSize.cw=window.innerWidth||htmlNode.clientWidth||bodyNode.clientWidth;var e=getXY(ge("page_layout"));void 0===mvcur.minSize.wrap.t&&(mvcur.minSize.wrap.t=mvcur.minSize.ch-mvcur.minSize.wrap.h),void 0===mvcur.minSize.wrap.l&&(mvcur.minSize.wrap.l=Math.max(String(e[0]-mvcur.minSize.player.w/2),30)),setStyle(mvLayerWrap,{left:mvcur.minSize.wrap.l+"px",top:mvcur.minSize.wrap.t+"px"}),Videoview.onMinMove(),mvcur.minimized&&Videoview.getMinSize()},unminimize(e,i,o){if(mvcur.minimized){var t=window.wkcur,a=window.WkView;t&&"story"==t.type&&window.Stories&&a.hide(!1,!0),o||window.layerQueue.push(),i||(window.layerQueue.hide(),setTimeout((function(){mvcur.noHistory=1,window.layerQueue.noHistory(),layers.wrapshow(mvLayerWrap,.7),layers.fullhide=Videoview.hide}),0)),Videoview.hidePlayer(!0),mvcur.minimized=!1,removeClass(mvLayerWrap,"mv_minimized"),Videoview.restoreStyle("mvLayerWrap",mvLayerWrap),toggle("mv_info",!mvcur.options.hideInfo&&!mvcur.mvData.noControls&&!mvcur.minimized),hide("mv_min_header"),show("VerticalVideoLayerInfo__topControls"),show("VideoLayerInfo__topControls");var r="mv_dark";return addClass(mvLayerWrap,r),addClass(window.layerBG,r),mvcur.needShowApprove&&(mvcur.needShowApprove=!1,show("mv_approve")),Videoview.restoreStyle("mvContainer","mv_container"),setStyle("mv_player_box",{width:"",height:""}),setStyle("mv_progress_box",{width:"",height:""}),mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight(),Videoview.updateSize(),addEvent(window,"resize",Videoview.onResize),addEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",Videoview.onFullscreenChange),addEvent(document,"keydown",Videoview.onKeyDown),removeEvent(window,"resize",Videoview.minResize),mvcur.minDestroy&&mvcur.minDestroy(),mvcur.noLocChange||!0===e||Videoview.setLocation(),window.onBodyResize(!0),setStyle(mvLayerWrap,{left:"0px",top:"0px"}),Videoview.showPlayer(!0),Videoview.setTitle(),_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.toggleStateClasses(),mvcur.chatMode&&(_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.toggleStateClasses(),_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.updateScroll()),mvcur.preparationBlock&&addClass("mv_box","_has_preparation"),Videoview.viewScroll(),Videoview.playerOnResize(),Videoview.updateLayoutSizes(),!1}},toggleSideBlock:e=>(mvcur.chatMode?_video_chat__WEBPACK_IMPORTED_MODULE_19__.default.toggle():_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.toggle(),Videoview.updateLayoutSizes(),cancelEvent(e)),sendVideo(e,i){Videoview.hidePlayer();var o={stat:["page.js","page.css","wide_dd.js","wide_dd.css",jsc("web/sharebox.js")],params:{}};i&&(o.params.width=686),showBox("like.php?act=publish_box",{object:"video"+mvcur.videoRaw,list:mvcur.listId,is_export:e},o).setOptions({onHideAttempt:function(){return Videoview.showPlayer(),!0}}),Videoview.playerNextTimerUpdate()},showDD(e,i){if(clearTimeout(cur.hideShareTimer),e.blur(),!hasClass(i,"mv_dd_hiding")){if(isVisible(i))return fadeIn(i,0);cur.ddShown&&Videoview.hideDD(0),cur.ddShown=i,setTimeout(addEvent.pbind(document,"click",Videoview.hideDD),1),show(i)}},hideDD(e){if(e>0)cur.hideShareTimer=setTimeout(Videoview.hideDD.pbind(0),e);else{var i=cur.ddShown;i&&(-1==e?hide(i):(addClass(i,"mv_dd_hiding"),fadeOut(i,200,(function(){removeClass(i,"mv_dd_hiding")}))),removeEvent(document,"click",Videoview.hideDD),cur.ddShown=!1)}},showReportVideoForm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mvcur.mvData.oid,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mvcur.mvData.vid,o=arguments.length>2?arguments[2]:void 0;o=o&&"function"==typeof o?o:()=>{},(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__.showReportForm)("video",e,i,o)},showReportVideoCommentForm(e,i){(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__.showReportForm)("video_comment",e,i,(()=>(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__.afterCommentReportSubmit)("video",e,i)))},reportComment(e,i,o){stManager.add([jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(e,i,"report_"+o)}))},setNotInterested(e,i,o){ajax.post("clips.php?act=not_interested",{owner_id:e,video_id:i,hash:o},{onDone:o=>{if(o){var t=ge(`post${e}_${i}`);t&&(addClass(t,"ShortVideoPost--hidden"),window.showDoneBox(getLang("video_clips_not_interested_success")),window.revertLastInlineVideo&&revertLastInlineVideo())}}})},descTT:e=>(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:getLang("video_edit_desc"),black:1,shift:[0,7,0],showdt:0,appendEl:domPN(e)}),viewScroll(){var e=getXY("mv_main",!0)[1],i=getSize("mv_player_box")[1],o=e-6;o=o<0?-o:0,toggleClass("VideoLayerInfo__topControls","VideoLayerInfo__topControls--fixed",o>0),toggleClass("mv_pl_prev","fixed",o>0),toggleClass("mv_pl_next","fixed",o>0),toggleClass("mv_top_pl_toggle","hidden",o>i),mvcur.scrolledAway=o>i/3,Videoview.playerNextTimerUpdate(),Videoview.updateReplyFormPos()},updateReplyFormPos(){if(!mvcur.mvData.shortVideo){var e=ge("mv_reply_form"),i=ge("mv_comments_wrap"),o=getSize(e),t=ge("mv_reply_form_wrap"),a=window.clientHeight(),r=getXY(mvLayerWrap)[1],d=getXY("mv_box")[1]-r,n=getXY(i)[1]-r,s=getSize(i)[1];a<d+getSize("mv_box")[1]&&s>0?(addClass(e,"mv_reply_form_fixed"),setStyle(e,{bottom:Math.min(a-n-o[1],0)+"px"}),setStyle(t,{width:o[0]+"px",height:o[1]+"px"})):(removeClass(e,"mv_reply_form_fixed"),setStyle(e,{bottom:null}),setStyle(t,{width:null,height:null}))}},editInline(e){if(!(e&&"A"==e.target.tagName||!window.mvcur||mvcur.mvEditing)&&ge("mv_description")){var i=mvcur.videoRaw,o=mvcur.mvShown,t=mvcur.mvData,a=function(e){if(mvcur.mvShown&&mvcur.videoRaw==i&&mvcur.mvShown==o&&!mvcur.mvEditing){Videoview.cleanExpandDescrEls(),mvcur.mvEditing=i;var t=ce("div",{id:"mv_edit_text_wrap",innerHTML:`\n          <textarea id="mv_edit_text" onkeydown="onCtrlEnter(event, Videoview.saveInline)" onkeyup="checkTextLength(mvcur.maxDescriptionLength, this, ge('mv_caption_warn'));" placeholder="${getLang("video_edit_desc_intro")}">${e}</textarea>\n          <div id="mv_caption_warn"></div>\n        `});ge("mv_description").appendChild(t);var a=ge("mv_edit_text");setStyle(a,{width:ge("mv_description").offsetWidth+"px"}),placeholderInit(a),autosizeSetup(a,{minHeight:26,addHeight:2}),addEvent(a,"keyup change",Videoview.onResize),setTimeout((function(){show(t),elfocus(a),addEvent(a,"blur",Videoview.saveInline),hide("mv_descr_field")}),1)}};!t.desc?a(""):ajax.post("al_video.php?act=edit_desc",{oid:t.oid,vid:t.vid},{onDone:a,progress:"mv_inline_edit_pr"})}},cancelInline(){mvcur.mvEditing=!1,removeEvent("mv_edit_text","blur"),show("mv_descr_field"),re("mv_edit_text_wrap")},saveInline(){if(mvcur.mvEditing){removeEvent("mv_edit_text","blur");var e=mvcur.mvEditing,i=Videoview.getMvData(),o=ge("mv_edit_text");ajax.post("al_video.php?act=save_desc",{oid:i.oid,vid:i.vid,hash:i.editHash,desc:val(o)},{onDone:function(t){if(i.desc=t,Videoview.isLayerShown(e)){mvcur.mvEditing=!1;var a=ge("mv_descr_field");val(a,t||`<span class="mv_desc_edit">${getLang("video_edit_desc")}</span>`),a.onmouseover=t?Videoview.descTT.pbind(a):null,show(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.removeData)(o),re("mv_edit_text_wrap"),Videoview.onResize()}},progress:"mv_inline_edit_pr"})}},onExternalVideoEnded(e){Videoview.logViewedPercentage(),e=e||domPN(ge("video_player"));var i=_slicedToArray(getSize(e),2),o=i[0],t=i[1],a=(Videoview.getNextVideosData()||[])[0],r=!!window.CanvasRenderingContext2D,d=Videoview.getMvData();if(e&&d&&d.authorPhoto&&d.authorHref&&!ge("mv_external_finish")){var n="";if(a&&o>=400&&t>=300)n=`\n        <div id="mv_finish_next" class="mv_finish_next" onclick="Videoview.onExternalVideoNext(true)">\n          <div class="mv_finish_next_caption">${getLang("video_player_next_title")}</div>\n          <div class="mv_finish_next_thumb" style="background-image: url(${a.thumb})"></div>\n          <div class="mv_finish_next_timer">\n            <canvas class="mv_finish_next_timer_canvas" width="100" height="100"></canvas>\n            <div class="mv_finish_next_timer_play mv_finish_icon"></div>\n          </div>\n          <div class="mv_finish_next_info">\n            <div class="mv_finish_next_title">${a.title}</div>\n            <div class="mv_finish_next_views">${a.views}</div>\n          </div>\n          <div class="mv_finish_next_cancel mv_finish_icon" onclick="Videoview.onExternalVideoNextCancel(event)"></div>\n        </div>\n      `;else if(!ge("video_yt"))return;var s=Videoview.getSuggestionsData(),_="onSuggestionClick";s&&s.length||(s=Videoview.getNextVideosData(),_="onVideoNext");var l="";s&&s.length&&o>=580&&t>=300&&(l=`<div id="mv_finish_suggestions" class="mv_finish_suggestions ${n?"hidden":""}">`,each(s,((e,i)=>{l+=`\n          <a class="mv_finish_suggestions_item" onclick="videoCallback(['${_}', '${i.vid}']); return false;" href="/video${i.vid}" title="${i.title}">\n            <div class="mv_finish_suggestions_item_thumb" style="background-image: url(${i.thumb})"></div>\n            <div class="mv_finish_suggestions_item_title">${i.title}</div>\n            <div class="mv_finish_suggestions_item_views">${i.views}</div>\n          </a>\n        `})),l+="</div>");var v=!1,c=!1;if(!n&&!l){if(d.noControls||d.nolikes)return;o>250&&t>200?v=!0:c=!0}var m=se(`\n      <div class="mv_external_finish" id="mv_external_finish" onclick="Videoview.onExternalVideoBgClick(this, event)">\n        <div class="mv_finish_header">\n          <div id="mv_finish_subscribe" class="fl_r mv_finish_subscribe ${d.subscribed?"mv_finish_subscribed":""}">\n            <button id="mv_finish_subscribe_btn" class="mv_finish_subscribe_btn fl_l" onclick="Videoview.onExternalVideoSubscribe()">${getLang(d.subscribed?"video_view_subscribed_msg":"video_view_subscribe_to_author")}</button>\n            <a href="${d.authorHref}" target="_blank" rel="noopener" class="fl_r"><img class="mv_finish_author_img" src="${d.authorPhoto}"></a>\n          </div>\n          <div id="mv_finish_title" class="mv_finish_title" style="${Videoview.isMinimized()?"display:none":""}">${d.title}</div>\n        </div>\n        <div id="mv_finish_actions" class="mv_finish_actions ${v?"mv_finish_actions_extended":""} ${d.can_add?"":"mv_finish_actions_cant_add"} ${c?"mv_finish_actions_no_content":""}">\n          <div class="mv_finish_like ${d.liked?"selected":""}" onclick="Videoview.onExternalVideoLike()">\n            <div class="mv_finish_like_icon mv_finish_icon"></div>\n            <div class="mv_finish_liked_icon mv_finish_icon"></div>\n            <div class="mv_finish_like_text">${getLang("video_i_like")}</div>\n          </div>\n          <div class="mv_finish_share" onclick="Videoview.onExternalVideoShare()">\n            <div class="mv_finish_share_icon mv_finish_icon"></div>\n            <div class="mv_finish_share_text">${getLang("video_share_with_friends")}</div>\n          </div>\n          <div class="mv_finish_add ${d.added?"selected":""}" onclick="Videoview.onExternalVideoAdd()">\n            <div class="mv_finish_add_icon mv_finish_icon"></div>\n            <div class="mv_finish_added_icon mv_finish_icon"></div>\n          </div>\n        </div>\n        ${n}\n        ${l}\n      </div>\n    `);d.canSubscribe||re(geByClass1("mv_finish_subscribe",m)),(d.noControls||d.nolikes)&&re(geByClass1("mv_finish_actions",m)),e.appendChild(m),r&&a&&n&&(window.focus(),mvcur.nextTimer={ctx:geByClass1("mv_finish_next_timer_canvas",m).getContext("2d"),nextTimerReset:function(){clearTimeout(mvcur.nextTimer.timeout),mvcur.nextTimer.ctx.clearRect(0,0,100,100),mvcur.nextTimer.started=null},nextTimerStart:function(){mvcur.nextTimer.started||(mvcur.nextTimer.started=(new Date).getTime(),Videoview.onExternalVideoTimer())}},mvcur.nextTimer.ctx.lineWidth=6,mvcur.nextTimer.ctx.lineCap="round",mvcur.nextTimer.ctx.strokeStyle="#fff",mvcur.nextTimerStopped||mvcur.nextTimer.nextTimerStart())}},onExternalVideoTimer(){if(window.mvcur&&mvcur.nextTimer&&mvcur.nextTimer.ctx&&mvcur.nextTimer.started){var e=Math.min(1,Math.max(0,((new Date).getTime()-mvcur.nextTimer.started)/1e4)),i=mvcur.nextTimer.ctx;i.clearRect(0,0,100,100),i.beginPath(),i.arc(50,50,47,-Math.PI/2,-Math.PI/2+2*Math.PI*e),i.stroke(),e<1?mvcur.nextTimer.timeout=setTimeout(Videoview.onExternalVideoTimer,20):Videoview.onExternalVideoNext()}},onExternalVideoNext(e){Videoview.removeExternalVideoFinishBlock(),mvcur.nextTimer=null,_video_playlist__WEBPACK_IMPORTED_MODULE_18__.default.nextVideo(),Videoview.sendPlayerStats(e?6:5,4)},onExternalVideoNextCancel(e){e&&e.stopPropagation(),clearTimeout(mvcur.nextTimer.timeout),mvcur.nextTimer=null,ge("video_yt")?(re("mv_finish_next"),removeClass("mv_finish_suggestions","hidden")):re("mv_external_finish")},onExternalVideoBgClick(e,i){i.target===e&&Videoview.removeExternalVideoFinishBlock()},onExternalVideoLike(){videoCallback(["onLike",4]),Videoview.playerOnLiked()},onExternalVideoShare(){if(Videoview.isFS){var e=Videoview.getPlayerObject();e&&e.toggleFullscreen&&e.toggleFullscreen()}videoCallback(["onShare",4])},onExternalVideoAdd(){var e=Videoview.getMvData();if(e){e.added?videoCallback(["onRemove"]):videoCallback(["onAdd",e.videoRaw,e.add_hash,4]);var i=Videoview.getPlayerObject();i.onAdded&&i.onAdded()}},onClipSubscribe(){var e=Videoview.getMvData();if(e){var i=!e.subscribed;Videoview.subscribeToAuthor(i,"videoview","VerticalVideoLayerInfo__subscribe","VerticalVideoLayerInfo__subscribe--subscribed")}},showSubscribeTooltip(){var e=Videoview.getMvData();if(e){var i=geByClass1("VerticalVideoLayerInfo__subscribe"),o=e.subscribed;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(i,{text:function(){return getLang(o?"video_view_subscribed_msg":"video_view_subscribe_to_author")},black:1,needLeft:1})}},onExternalVideoSubscribe(){var e=Videoview.getMvData();if(e){var i=!e.subscribed;Videoview.subscribeToAuthor(i,"external_player",!1),Videoview.sendPlayerStats(i?9:10,4)}},updateExternalVideoFinishBlock(){var e=ge("mv_external_finish");if(e){var i=_slicedToArray(getSize(e),2),o=i[0],t=i[1];(isVisible("mv_finish_next")&&(o<400||t<300)||isVisible("mv_finish_suggestions")&&(o<580||t<300)||hasClass("mv_finish_actions","mv_finish_actions_extended")&&(o<250||t<200))&&(mvcur.nextTimer&&Videoview.onExternalVideoNextCancel(),re("mv_finish_next"),re("mv_finish_suggestions"),removeClass("mv_finish_actions","mv_finish_actions_extended"),addClass("mv_finish_actions","mv_finish_actions_no_content")),toggle("mv_finish_title",!Videoview.isMinimized()),toggleClass("mv_finish_subscribe","mv_finish_subscribe_min",o<500)}},removeExternalVideoFinishBlock(){window.mvcur&&mvcur.nextTimer&&Videoview.onExternalVideoNextCancel(),re("mv_external_finish")},logViewedPercentage(){if(window.mvcur&&mvcur.mvData&&mvcur.mvData.videoRaw&&mvcur.mvData.duration){var e=mvcur.mvData,i=e.videoRaw,o=e.duration,t=Date.now(),a=mvcur.viewStartedTimestamp;if(!a)return!1;delete mvcur.viewStartedTimestamp;var r=Math.min(Math.round((t-a)/1e3),o);ajax.post("al_video.php?act=a_viewed_percentage",{video_raw:i,viewed_time:r,duration:o})}}}},255906:(e,i,o)=>{o.d(i,{ShortVideoStub:()=>n});var t=o(570655),a=o(667294),r=o(659397),d=o(613050),n=function(e){var i=e.additionalCssClass,o=e.title,n=e.text,s=e.linkAndroid,_=e.linkIOS,l=e.iphoneAriaLabel,v=e.androidAriaLabel,c=e.popupTitle,m=e.popupText,u=(0,t.__read)((0,a.useState)(!1),2),p=u[0],h=u[1],w=(0,t.__read)((0,a.useState)(!1),2),g=w[0],y=w[1],f=(0,r.classNames)("ShortVideoStub",i||"");return a.createElement(a.Fragment,null,a.createElement("div",{className:f},a.createElement("div",{className:"ShortVideoStub__title",dangerouslySetInnerHTML:{__html:o}}),a.createElement("div",{className:"ShortVideoStub__text",dangerouslySetInnerHTML:{__html:n}}),a.createElement("div",{className:"ShortVideoStub__links"},a.createElement("div",{className:"ShortVideoStub__row"},a.createElement("a",{className:"ShortVideoStub__link ShortVideoStub__link--iphone",target:"_blank",href:_,"aria-label":l}),a.createElement("div",{className:"ShortVideoStub__qrLink","aria-label":l,onClick:function(){h(!0)}})),a.createElement("div",{className:"ShortVideoStub__row"},a.createElement("a",{className:"ShortVideoStub__link ShortVideoStub__link--android",target:"_blank",href:s,"aria-label":v}),a.createElement("div",{className:"ShortVideoStub__qrLink ShortVideoStub__qrLink--android","aria-label":v,onClick:function(){y(!0)}})))),p&&a.createElement(d.ShortVideoStubPopup,{onClose:function(){h(!1)},text:m,title:c}),g&&a.createElement(d.ShortVideoStubPopup,{onClose:function(){y(!1)},qrType:d.QRCodeType.ANDROID,text:m,title:c}))}},613050:(e,i,o)=>{o.d(i,{QRCodeType:()=>t,ShortVideoStubPopup:()=>n});var t,a=o(667294),r=o(138671),d=o(659397);!function(e){e.IOS="ios",e.ANDROID="android"}(t||(t={}));var n=function(e){var i=e.title,o=e.text,n=e.qrSvg,s=e.qrType,_=void 0===s?t.IOS:s,l=e.onClose;(0,a.useEffect)((function(){return document.body.classList.add("layers_shown"),function(){document.body.classList.remove("layers_shown")}}),[]);var v=(0,d.classNames)("ShortVideoStubPopup__qrCode",n?"":_==t.ANDROID?"ShortVideoStubPopup__qrCode--android":"ShortVideoStubPopup__qrCode--ios");return a.createElement(r.default,{onClose:l,disableBodyScroll:!0},a.createElement("div",{className:"ShortVideoStubPopup"},a.createElement("div",{className:"ShortVideoStubPopup__close",onClick:l}),a.createElement("div",{className:v,dangerouslySetInnerHTML:{__html:n||""}}),a.createElement("div",{className:"ShortVideoStubPopup__title"},i),a.createElement("div",{className:"ShortVideoStubPopup__text",dangerouslySetInnerHTML:{__html:o}})))}},283767:(e,i,o)=>{o.d(i,{parseLikeObjectId:()=>a,likePostObjectId:()=>r,likeReplyObjectId:()=>d,getElementLikeButtonCount:()=>n,getElementLikeButtonIcon:()=>s,getElementLikeButtonLabel:()=>_});var t=o(570655);function a(e){var i=e.match(/^([a-z_]+)([0-9\-_]+)$/);if(!i)return null;var o=(0,t.__read)(i,3);return{objectType:o[1],objectId:o[2]}}var r=function(e){return"wall"+e},d=function(e){return"wall_reply"+e},n=function(e){var i;return null!==(i=null==e?void 0:e.querySelector(".like_button_count, ._like_button_count"))&&void 0!==i?i:void 0},s=function(e){var i;return null!==(i=null==e?void 0:e.querySelector(".like_button_icon, ._like_button_icon"))&&void 0!==i?i:void 0},_=function(e){var i;return null!==(i=e.querySelector(".like_button_label, ._like_button_label"))&&void 0!==i?i:void 0}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress;function __webpack_require__(e){var i=__webpack_module_cache__[e];if(void 0!==i)return i.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,i,o,t)=>{if(!i){var a=1/0;for(s=0;s<deferred.length;s++){for(var[i,o,t]=deferred[s],r=!0,d=0;d<i.length;d++)(!1&t||a>=t)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](i[d])))?i.splice(d--,1):(r=!1,t<a&&(a=t));if(r){deferred.splice(s--,1);var n=o();void 0!==n&&(e=n)}}return e}t=t||0;for(var s=deferred.length;s>0&&deferred[s-1][2]>t;s--)deferred[s]=deferred[s-1];deferred[s]=[i,o,t]},__webpack_require__.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(i,{a:i}),i},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"==typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"==typeof e.then)return e}var o=Object.create(null);__webpack_require__.r(o);var t={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var a=2&i&&e;"object"==typeof a&&!~leafPrototypes.indexOf(a);a=getProto(a))Object.getOwnPropertyNames(a).forEach((i=>t[i]=()=>e[i]));return t.default=()=>e,__webpack_require__.d(o,t),o},__webpack_require__.d=(e,i)=>{for(var o in i)__webpack_require__.o(i,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:i[o]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((i,o)=>(__webpack_require__.f[o](e,i),i)),[])),__webpack_require__.u=e=>4212===e?"a1ce2afe72d9e76a1e16588a7be78769.76e77eae0420a0048702.js":(2974===e?"videoplayer_v2":e)+"."+{647:"f67958e58ab70bd2d52b",1122:"bc2ebb0e2852cd9ad010",2974:"f010e7fea6677ff1e48b"}[e]+".js",__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),inProgress={},__webpack_require__.l=(e,i,o,t)=>{if(inProgress[e])inProgress[e].push(i);else{var a,r;if(void 0!==o)for(var d=document.getElementsByTagName("script"),n=0;n<d.length;n++){var s=d[n];if(s.getAttribute("src")==e||s.getAttribute("data-webpack")=="vk:"+o){a=s;break}}a||(r=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack","vk:"+o),a.src=e),inProgress[e]=[i];var _=(i,o)=>{a.onerror=a.onload=null,clearTimeout(l);var t=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),t&&t.forEach((e=>e(o))),i)return i(o)},l=setTimeout(_.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=_.bind(null,a.onerror),a.onload=_.bind(null,a.onload),r&&document.head.appendChild(a)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",(()=>{var e={7658:0};__webpack_require__.f.j=(i,o)=>{var t=__webpack_require__.o(e,i)?e[i]:void 0;if(0!==t)if(t)o.push(t[2]);else{var a=new Promise(((o,a)=>t=e[i]=[o,a]));o.push(t[2]=a);var r=__webpack_require__.p+__webpack_require__.u(i),d=new Error;__webpack_require__.l(r,(o=>{if(__webpack_require__.o(e,i)&&(0!==(t=e[i])&&(e[i]=void 0),t)){var a=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;d.message="Loading chunk "+i+" failed.\n("+a+": "+r+")",d.name="ChunkLoadError",d.type=a,d.request=r,t[1](d)}}),"chunk-"+i,i)}},__webpack_require__.O.j=i=>0===e[i];var i=(i,o)=>{var t,a,[r,d,n]=o,s=0;for(t in d)__webpack_require__.o(d,t)&&(__webpack_require__.m[t]=d[t]);if(n)var _=n(__webpack_require__);for(i&&i(o);s<r.length;s++)a=r[s],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[r[s]]=0;return __webpack_require__.O(_)},o=self.webpackChunkvk=self.webpackChunkvk||[];o.forEach(i.bind(null,0)),o.push=i.bind(null,o.push.bind(o))})();var __webpack_exports__=__webpack_require__.O(void 0,[8592,4509,1437],(()=>__webpack_require__(951558)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();