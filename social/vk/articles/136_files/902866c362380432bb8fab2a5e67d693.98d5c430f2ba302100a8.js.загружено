(self.webpackChunkvk=self.webpackChunkvk||[]).push([[3087],{695577:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var i=n(667294),s=n(887854),a=n.n(s),r=n(408091),o=n(634777),l=n(379333),c="0 0 12 12",h="star_circle_fill_yellow_12",d=!1;function u(){d||((0,o.addSpriteSymbol)(new(a())({id:h,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="star_circle_fill_yellow_12"><linearGradient id="star_circle_fill_yellow_12_a" gradientUnits="userSpaceOnUse" x1="-6" x2="6" y1="6" y2="18"><stop offset="0" stop-color="#ffb73d" /><stop offset="1" stop-color="#ffa000" /></linearGradient><g clip-rule="evenodd" fill-rule="evenodd"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm.11 2.59a.25.25 0 00-.334.114l-.952 1.928-2.127.31a.25.25 0 00-.138.426l1.539 1.5-.364 2.119a.25.25 0 00.363.263L6 8.25l1.903 1a.25.25 0 00.363-.263l-.364-2.119 1.54-1.5a.25.25 0 00-.14-.427l-2.126-.309-.952-1.928a.25.25 0 00-.113-.113z" fill="url(#star_circle_fill_yellow_12_a)" /><path d="M6.11 2.59a.25.25 0 00-.334.114l-.952 1.928-2.127.31a.25.25 0 00-.138.426l1.539 1.5-.364 2.119a.25.25 0 00.363.263L6 8.25l1.903 1a.25.25 0 00.363-.263l-.364-2.119 1.54-1.5a.25.25 0 00-.14-.427l-2.126-.309-.952-1.928a.25.25 0 00-.113-.113z" fill="#fff" /></g></symbol>'})),d=!0)}var _=function(e){return(0,o.useIsomorphicLayoutEffect)((function(){u()}),[]),i.createElement(l.SvgIcon,(0,r.assign)({},e,{viewBox:c,id:h,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};_.mountIcon=u;const m=_},76854:(e,t,n)=>{"use strict";n.d(t,{IconSettingsContext:()=>a,IconSettingsProvider:()=>r});var i=n(667294);function s(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n,i,s={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var a=(0,i.createContext)({}),r=function(e){var t=e.children,n=s(e,["children"]),r=(0,i.useMemo)((function(){return n}),[n.classPrefix,n.globalClasses]);return i.createElement(a.Provider,{value:r},t)}},379333:(e,t,n)=>{"use strict";n.d(t,{SvgIcon:()=>d});var i=n(667294),s=n(76854);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n,i,s={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var h={display:"block"};var d=function(e){var t=e.width,n=e.height,r=e.viewBox,l=e.id,d=e.className,u=e.style,_=e.fill,m=e.getRootRef,p=e.Component,g=c(e,["width","height","viewBox","id","className","style","fill","getRootRef","Component"]),f=Math.max(t,n),v=(0,i.useContext)(s.IconSettingsContext),C=function(e,t){for(var n=t.classPrefix,i=t.globalClasses,s="",a=0;a<e.length;a++)n&&(s+=" "+(n+e[a])),n&&!i||(s+=" "+e[a]);return s}(["Icon","Icon--".concat(f),"Icon--w-".concat(t),"Icon--h-".concat(n),"Icon--".concat(l)],v);return i.createElement(p,a({role:"presentation"},g,{ref:m,className:"".concat(C," ").concat(d),style:o(o({},u),{},{width:t,height:n})}),i.createElement("svg",{viewBox:r,width:t,height:n,style:h},i.createElement("use",{xlinkHref:"#".concat(l),style:{fill:"currentColor",color:_}})))};d.defaultProps={Component:"div",className:"",style:{}}},634777:(e,t,n)=>{"use strict";n.d(t,{addSpriteSymbol:()=>h,useIsomorphicLayoutEffect:()=>d});var i,s=n(362548),a=n.n(s),r=n(667294),o=!("undefined"==typeof window||!window.document||!window.document.createElement);if(o){var l="__SVG_SPRITE_NODE__";i=new(a())({attrs:{id:l}});var c=function(){var e=document.getElementById(l);e?i.attach(e):i.mount()};document.querySelector("body")?c():document.addEventListener("DOMContentLoaded",c)}else i=null;function h(e){i&&i.add(e)}var d=o?r.useLayoutEffect:r.useEffect},126764:(e,t,n)=>{"use strict";n.d(t,{ChatSettings:()=>I});n(530522),n(66108),n(991181),n(579665),n(95767),n(176774),n(940851),n(296253);var i=n(667294),s=n(663527),a=n(389430),r=n(81020),o=n(41437),l=n(907851),c=n(319368),h=n(881150),d=n(501339),u=n(111146),_=n(234371),m=n(596673),p=n(198946),g=n(383356),f=n(732779),v=n(74934),C=n(791563),S=n(929566),A=n(236205),b=n(351117);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(s)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var E=o.default.getLang;class I extends i.Component{constructor(e){super(e),this.showInvitationLink=()=>{var e=this.props.store,t=(0,l.unpackStore)(e),n=t.peer;return this.setState({invitationLoading:!0}),(0,a.getInviteLink)(n-2e9,t).then((e=>{var t=y(e,1)[0];this.setState({section:2,invitationLoading:!1,invitationLinks:t})}))},this.onUpdateNotificationSettings=(e,t)=>{var n=this.props,i=n.store,s=n.parentMutations,r=i.get().peer;return i.set(a.toggleMutePeer.bind(null,r,e,t)).then(s().updateState.bind(null,r))},this.onUpdateMentionNotificationSettings=e=>{var t=this.props,n=t.store,i=t.parentMutations,s=n.get().peer;return n.set(a.toggleMuteMentionsPeer.bind(null,s,e)).then(i().updateState.bind(null,s))},this.onUpdateFlags=e=>{var t=this.props.store.get(),n=t.peer,i=t.hasOwnProperty("onUpdateFlags")?t.onUpdateFlags.bind(null,n,e):e=>Promise.resolve(e);return(0,a.updateFlags)(n,e,t).then(i)},this.afterFlagsUpdated=()=>{this.go(0,(()=>this.setBlinkStatus({flagsUpdated:!0})))},this.afterMembersAdded=e=>{this.go(0,(()=>this.setBlinkStatus({membersAdded:!0,membersCount:e})))},this.afterNotificationSettingsUpdated=()=>{this.setBlinkStatus({notificationSettingsUpdated:!0})},this.afterDisableUntilUpdated=()=>{this.setBlinkStatus({disableUntilUpdated:!0})},this.setBlinkStatus=e=>{this.timers.push(setTimeout((()=>this.setState(e)),300))},this.onHideStatus=()=>{this.setState({membersAdded:!1,flagsUpdated:!1,notificationSettingsUpdated:!1,disableUntilUpdated:!1})},this.onLeave=()=>{var e=this.props,t=e.store,n=e.closePopup,i=t.get().peer,o=(0,s.isFvkcomgroup)(t,i),l=(0,C.showFastBox)({title:E(o?"mail_leave_channel":"mail_chat_leave_title"),dark:1},E(o?"mail_vkcomgroup_leave_confirm":"mail_chat_leave_confirm"),E(o?"mail_leave_channel":"mail_leave_chat"),(function(){t.set(a.unpinMessageOptimistic.bind(null,i)),t.set(a.leaveChat.bind(null,i)),l.hide(),n(),t.get().longpoll.push([(0,r.resetPeer)()])}),E("global_cancel"),(function(){l.hide()}))},this.onChatClose=()=>{var e=this.props,t=e.store,n=e.closePopup,i=t.get().peer,s=(0,S.getTab)(t,i).data.flags,a=s&v.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE?s&~v.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE:s|v.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE,o=(0,C.showFastBox)({title:E("global_warning"),dark:1},E("mail_chat_close_confirm"),E("mail_close_chat"),(()=>{this.onUpdateFlags(a).then((()=>{o.hide(),n(),t.get().longpoll.push([(0,r.resetPeer)()])}))}),E("global_cancel"),(function(){o.hide()}))},this.onChatRestore=()=>{var e=this.props,t=e.store,n=e.closePopup,i=t.get().peer,s=(0,S.getTab)(t,i).data.flags,a=s&v.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE?s&~v.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE:s|v.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE;this.onUpdateFlags(a).then(n)},this.onResetLink=()=>{var e=this.props.store,t=(0,l.unpackStore)(e),n=t.peer;return(0,a.resetInviteLink)(n,t).then((e=>{var t=y(e,1)[0];this.setState({invitationLinksReseted:!0,invitationLinks:t})}))},this.onShowAttachments=()=>{var e=(0,A.getPeer)(this.props.store);this.props.closePopup(),window.showWiki({w:"history"+(0,s.convertPeerToUrl)(e)+"_photo"},null,{})},this.onLinkHistoryOptionToggle=()=>{var e=(0,A.getPeer)(this.props.store);this.setState((e=>({isInvitationLinkWithHistory:!e.isInvitationLinkWithHistory})),(()=>{this.props.updateHistoryLinkState(e,this.state.isInvitationLinkWithHistory)}))},this.state={section:0,invitationLinks:null,invitationLinksReseted:!1,isInvitationLinkWithHistory:this.props.isLinkWithHistorySelected,membersAdded:!1,flagsUpdated:!1,notificationSettingsUpdated:!1,disableUntilUpdated:!1},this.timers=[]}go(e,t){this.setState({section:e},(()=>{this.props.updatePopup(),t&&t()}))}getPopupTitle(){switch(this.state.section){case 1:return E("mail_settings_add_members");case 2:case 3:return E("mail_chat_invite_link");case 6:return E("mail_settings_options");default:return E("mail_settings_title")}}componentWillReceiveProps(e){var t=e.store.get(),n=t.peer,i=t.tabs[n];i.photoLarge||i.photoGrid||this.resync||(this.resync=!0,e.store.set(a.getChatDetails.bind(null,n)).then((()=>{this.resync=!0})))}componentDidMount(){this.props.updatePopup()}componentWillUnmount(){this.timers.forEach(clearTimeout)}render(){var e=this.props,t=e.store,n=e.closePopup,a=t.get(),r=a.peer,o=a.tabs[r],l=(0,s.isFvkcomgroup)(t,r),C=(0,S.isCasperChat)(t,r),A=(0,S.isCommunityChat)(t,r),y=!l&&!A||!t.get().gid,N=(0,v.canCloseChat)(t,r,a.id),I=(0,b.isClosedChat)(o),L=a.isChatTypeEditAllowed,M=E(l?"mail_im_n_vkcomgroup_members":"mail_im_n_chat_members",(0,s.getAliveMembersCount)(o));return i.createElement("section",{className:"ChatSettings"},i.createElement(c.default,{title:this.getPopupTitle(),back:0!==this.state.section?E("global_back"):void 0,onCloseClick:n,onBackClick:()=>this.go(0)}),0===this.state.section&&i.createElement("div",{className:"ChatSettings__content"},i.createElement(d.default,{store:t,photo:o.photoLarge,grid:o.photoGrid,title:o.name,flags:o.data.flags,isDefaultPhotoOwner:o.isDefaultPhotoOwner,isCasper:C,isDonutChat:o.isDonutChat,meta:M,description:""}),i.createElement(m.default,{store:t,showMembersSettings:()=>this.go(1),showAttachments:this.onShowAttachments,showInvitationLink:this.showInvitationLink,isInvitationLinkWithHistory:this.state.isInvitationLinkWithHistory,invitationLinks:this.state.invitationLinks,showSettings:()=>this.go(6),notificationSettingsUpdated:this.state.notificationSettingsUpdated,disableUntilUpdated:this.state.disableUntilUpdated,flagsUpdated:this.state.flagsUpdated,onHideStatus:this.onHideStatus,onUpdateNotificationSettings:this.onUpdateNotificationSettings,onUpdateMentionNotificationSettings:this.onUpdateMentionNotificationSettings,afterNotificationSettingsUpdated:this.afterNotificationSettingsUpdated,afterDisableUntilUpdated:this.afterDisableUntilUpdated}),l?null:i.createElement("div",{className:"ChatSettings__pane"},i.createElement(p.default,{store:t,onLeave:this.onLeave,showMembersSettings:()=>this.go(1),membersAdded:this.state.membersAdded,onHideStatus:this.onHideStatus,membersCount:this.state.membersCount})),y&&i.createElement("div",{className:"ChatSettings__pane"},i.createElement(h.default,{appearance:["link","mobile"],className:"ChatSettings__criticalAction ChatSettings__leave",onClick:this.onLeave},E(l?"mail_leave_channel":"mail_settings_leave"))),N&&!I&&i.createElement("div",{className:"ChatSettings__pane"},i.createElement(h.default,{appearance:["link","mobile"],className:"ChatSettings__criticalAction ChatSettings__close",onClick:this.onChatClose},E("mail_settings_close"))),N&&I&&i.createElement("div",{className:"ChatSettings__pane"},i.createElement(h.default,{appearance:["link","mobile"],className:"ChatSettings__criticalAction ChatSettings__restore",onClick:this.onChatRestore},E("mail_settings_restore")))),1===this.state.section&&i.createElement(g.default,{store:t,afterSave:this.afterMembersAdded}),6===this.state.section&&i.createElement(f.ChatSettingsOptions,{isChatTypeEditAllowed:L,flags:o.data.flags,isCasperChatTab:C,isCommunityChat:A,allowedUpdateFlags:o.allowedUpdateFlags,back:()=>this.go(0),onSave:this.onUpdateFlags,afterSave:this.afterFlagsUpdated}),2===this.state.section&&i.createElement(u.default,{store:t,onReset:()=>this.go(3),onLinkHistoryOptionToggle:this.onLinkHistoryOptionToggle,reseted:this.state.invitationLinksReseted,isInvitationLinkWithHistory:this.state.isInvitationLinkWithHistory,invitationLinks:this.state.invitationLinks}),3===this.state.section&&i.createElement(_.default,{onConfirm:this.onResetLink,onCancel:()=>this.go(2)}))}}},501339:(e,t,n)=>{"use strict";n.d(t,{default:()=>_});n(176774),n(59357);var i=n(667294),s=n(121265),a=n(41437),r=n(838482),o=n(639790),l=n(969135),c=n(695577),h=n(74934),d=n(389430),u=n(713075);class _ extends i.PureComponent{constructor(e){super(e),this.onSaveTitle=e=>{var t=this.props.store,n=t.get(),i=e.value.trim().replace("\n","");i&&i!==unclean(this.props.title)&&(this.setState({titleChanged:!1}),t.set(d.updateChatTopic.bind(null,n.peer,i)))},this.onChangeTitle=e=>{if(this.state.title!==e.target.value){var t=e.target.value.replace("\n","");this.setState({title:t,titleChanged:unclean(this.props.title)!==t})}},this.onValidateTitle=e=>!!e.trim().replace("\n",""),this.onCancelTitle=()=>{this.setState({title:unclean(this.props.title),titleChanged:!1})},this.onSaveDescription=e=>{},this.onPhotoUpload=()=>{var e=this.props.store,t=e.get().peer;(0,h.canChangeTitle)(e)&&(cur.recieveCropResult=void 0,Page.ownerPhoto(t,{gid:e.get().gid}))},this.onPhotoRemove=()=>{var e=this.props.store,t=e.get().peer;(0,h.canChangeTitle)(e)&&e.set(d.removeChatPhoto.bind(null,t)).then((()=>e.set(d.getChatDetails.bind(null,t)))).catch((e=>(0,u.imWeirdCatch)("onPhotoRemove",e)))},this.state={title:unclean(e.title),titleChanged:!1}}getCasperInfo(){var e=(0,a.getLang)("mail_casper_chat_info");return i.createElement(i.Fragment,null,(0,a.getLang)("mail_casper_chat_label"),i.createElement(r.default,{text:e,position:"t",appearance:"light",maxWidth:280,marginTop:-6},i.createElement(l.default,{"aria-label":e,className:"ChatSettingsInfo__casperHint"})))}render(){var e=this.props,t=e.store,n=e.photo,l=e.title,d=e.description,u=e.grid,_=e.meta,m=e.isDonutChat,p=e.isDefaultPhotoOwner,g=void 0!==p&&p,f=e.isCasper,v=void 0!==f&&f,C=unclean(l),S=(0,h.canChangeTitle)(t),A=(0,s.classNames)("ChatSettingsInfo",{"ChatSettingsInfo--editable":S}),b=(0,s.classNames)("ChatSettingsInfo__title",{"ChatSettingsInfo__title-service":64&this.props.flags});return i.createElement("div",{className:A},i.createElement("header",{className:"ChatSettingsInfo__header"},i.createElement("div",{className:"ChatSettingsInfo__photo"},i.createElement("div",{className:"ChatSettingsInfo__attach nim-peer nim-peer_larger","data-tip":(0,a.getLang)("mail_settings_photo"),onClick:this.onPhotoUpload},n?i.createElement("img",{src:n,width:"80",height:"80",alt:C,className:"ChatSettingsInfo__photoSelf"}):i.createElement("div",{className:"nim-peer--photo-w"},i.createElement("div",{className:"ChatSettingsInfo__photoGrid nim-peer--photo",dangerouslySetInnerHTML:{__html:u}}))),n&&S&&!g&&i.createElement(r.default,{text:(0,a.getLang)("mail_settings_remove_photo"),position:"t",align:"left"},i.createElement("button",{onClick:this.onPhotoRemove,className:"ChatSettingsInfo__photoRemove"}))),i.createElement("h3",{className:b},S?i.createElement(o.default,{value:this.state.title,changed:this.state.titleChanged,useEnter:!0,onSave:this.onSaveTitle,onChange:this.onChangeTitle,onCancel:this.onCancelTitle,validate:this.onValidateTitle}):C),i.createElement("div",{className:"ChatSettingsInfo__meta"},i.createElement("span",{className:"ChatSettingsInfo__metaItem"},_),m&&i.createElement("span",{className:"ChatSettingsInfo__metaItem"},(0,a.getLang)("groups_donut_is_dons_chat")," ",i.createElement(c.default,null)),v&&i.createElement("span",{className:"ChatSettingsInfo__metaItem"},this.getCasperInfo()))),d&&i.createElement("div",{className:"ChatSettingsInfo__description"},S?i.createElement(o.default,{value:d,onSave:this.onSaveDescription}):d))}}},111146:(e,t,n)=>{"use strict";n.d(t,{default:()=>u});n(751876);var i=n(667294),s=n(41437),a=n(595775),r=n(881150),o=n(629142),l=n(856612),c=n(663527),h=n(277256),d=s.default.getLang;class u extends i.Component{constructor(e){super(e),this.onCopy=()=>{this.input&&(elfocus(this.input,0,this.input.value.length),document.execCommand("copy"),this.setState({copied:!0}))},this.onBlinkTextHide=()=>{this.setState({copied:!1})},this.getInputRef=e=>{e&&e.element&&(this.input=e.element)},this.state={copied:!1}}componentDidMount(){this.input&&elfocus(this.input,0,this.input.value.length)}render(){var e=this.props,t=e.onReset,n=e.invitationLinks,s=e.store,u=d("mail_invite_link_reset_explainer").split("{reset_link}"),_=!(0,c.isFvkcomgroup)(s,s.get().peer),m=n.linkWithHistory,p=n.linkWithoutHistory,g=this.props.isInvitationLinkWithHistory?m:p;return i.createElement("div",{className:"ChatSettingsInvitationLink"},this.props.reseted&&i.createElement("div",{className:"ChatSettingsInvitationLink__reseted"},d("mail_invite_link_reseted_explainer")),i.createElement("p",null,d("mail_invite_link_explainer")),i.createElement("div",{className:"ChatSettingsInvitationLink__switch"},i.createElement(h.default,{children:d("mail_im_chat_add_members_show_history"),checked:this.props.isInvitationLinkWithHistory,onChange:this.props.onLinkHistoryOptionToggle})),i.createElement("div",{className:"ChatSettingsInvitationLink__main"},i.createElement(a.default,{ref:this.getInputRef,readOnly:"readonly",className:"ChatSettingsInvitationLink__input",value:g}),i.createElement(r.default,{onClick:this.onCopy},d("mail_get_invite_link_copy")),i.createElement(o.default,{className:"ChatSettingsInvitationLink__copied",shown:this.state.copied,callback:this.onBlinkTextHide},d("mail_invite_link_copied"))),_&&i.createElement("p",null,u[0],i.createElement(l.default,{className:"ChatSettingsInvitationLink__reset",onClick:t},d("mail_invite_reset_link")),u[1]))}}},598940:(e,t,n)=>{"use strict";n.d(t,{default:()=>p});var i=n(667294),s=n(41437),a=n(309739),r=n(838482),o=n(74934),l=n(713075),c=n(389430),h=n(929566),d=n(122902),u=n(151223),_=n(907851),m=s.default.getLang;class p extends i.Component{constructor(){super(...arguments),this.toggleAdmin=()=>{var e=this.props,t=e.store,n=e.mid,i=e.adminMap,s=t.get().peer,a=!i[n];t.set(c.toggleAdminOptimisticly.bind(null,s,n,a)),t.set(c.toggleAdmin.bind(null,s,n,a))},this.kick=()=>{var e=this.props.store,t=e.get().peer,n=this.props.mid;e.set((e=>(0,u.kickUserOptimistically)(e,t,n))),e.set((e=>(0,d.kickUserAction)(e,t,n))).catch((e=>{(0,l.imWeirdCatch)("ChatSettingsMemberEdit.kick",e)}))},this.cancelMessageRequest=()=>{var e=this.props.store,t=e.get().peer,n=this.props.mid;e.set((e=>(0,d.cancelMessageRequestAction)(e,t,n))).catch((e=>{(0,l.imWeirdCatch)("ChatSettingsMemberEdit.cancel",e)}))},this.changeAccess=e=>{var t=this.props.store,n=t.get().peer,i=this.props.mid;t.set(c.changeCommunityAccess.bind(null,n,i,!e)).catch((e=>{(0,l.imWeirdCatch)("ChatSettingsMemberEdit.changeAccess",e)}))}}getMemberRole(e,t){var n=this.props.storeData,i=n.peer;return t===n.tabs[i].ownerId?m("mail_settings_owner"):e[t]?m("mail_settings_admin"):null}getActions(e){var t=this.props,n=t.store,i=t.mid,s=(0,_.unpackStore)(n),a=s.id,r=s.peer,l=a===i,c=[],d=(0,h.isCommunityChat)(n,r);if(l)return d&&(0,h.isCommunityInterface)(n)?[]:[{text:m("mail_leave_chat"),onClick:this.props.onLeave}];if((0,o.canAddAdmin)(n,i)&&c.push({text:e[i]?m("mail_chat_remove_admin"):m("mail_settings_appoint_admin"),onClick:this.toggleAdmin}),(0,o.canKickUser)(n,i)&&c.push({text:m("mail_settings_kick"),onClick:this.kick}),(0,h.isCommunityPeer)(i)&&!e[i]){var u=(0,o.canSeeAllMessages)(n,n.get().peer,i),p=u?"mail_settings_community_mentions_only":"mail_settings_community_full_access";c.push({text:m(p),onClick:this.changeAccess.bind(this,u)})}return c}render(){var e=this.props,t=e.adminMap,n=e.storeData,s=e.mid,l=e.isMR,c=n.id,h=!!t[c],d=this.getMemberRole(t,s),u=c===s,_=h&&this.getActions(t);return l?i.createElement(r.default,{text:m("mail_cancel_invitation"),position:"t",align:"right"},i.createElement("span",{onClick:this.cancelMessageRequest,className:"ChatSettingsMembersEdit__kick"})):i.createElement(i.Fragment,null,d&&i.createElement("span",{className:"ChatSettingsMembersEdit__role"},d),_&&_.length>0&&i.createElement(a.default,{position:"b",align:"right",trigger:"hover",marginTop:-8,marginLeft:1,data:this.getActions(t)},i.createElement("span",{className:"ChatSettingsMembersEdit__actions"})),!h&&!u&&(0,o.canKickUser)(n,s)&&i.createElement(r.default,{text:m("mail_settings_kick"),position:"t",align:"right"},i.createElement("span",{onClick:this.kick,className:"ChatSettingsMembersEdit__kick"})),!h&&u&&i.createElement(r.default,{text:m("mail_leave_chat"),position:"t",align:"right"},i.createElement("span",{onClick:this.props.onLeave,className:"ChatSettingsMembersEdit__kick"})))}}},383356:(e,t,n)=>{"use strict";n.d(t,{default:()=>v});n(991181),n(175115),n(940851),n(296253);var i=n(667294),s=n(41437),a=n(121265),r=n(929566),o=n(389430),l=n(248586),c=n(167578),h=n(423558),d=n(351605),u=n(731585),_=n(791563),m=n(227192),p=n(351117),g=s.default.getLang,f=()=>{};class v extends i.Component{constructor(e){super(e),this.onChange=e=>{var t=this.props.store.get(),n=e.target.value,i=(0,r.getTab)(t,t.peer);i.customChatMemberSearch?i.customChatMemberSearch(n).then((e=>(this.setSearchResults({},!1,n,e),n&&i.customChatMemberServerSearch?(this.isSearching=!0,i.customChatMemberServerSearch(n).catch((e=>{if("debounce"!==e)throw e}))):Promise.resolve([])))).then(this.appendSearchResults):(0,o.searchLocalHints)(n,t).then((e=>(this.setSearchResults({},!1,n,e),n?(this.isSearching=!0,this.serverSearch(n,e.map((e=>e.peerId)))):Promise.resolve([])))).then(this.appendSearchResults).catch((()=>{}))},this.serverSearch=(0,m.debouncedPromise)(((e,t)=>{var n=this.props.store;return(0,o.searchHints)(e,t,"friends",n.get())}),300),this.onRemoveToken=e=>new Promise((t=>{var n=this.state.selected.filter((t=>t!==e));this.selected=n.reduce(((e,t)=>(e[t]=!0,e)),{}),this.setState({selected:n},t)})),this.onSelect=e=>new Promise((t=>{var n=this.selected[e]?this.state.selected.filter((t=>t!==e)):[].concat(this.state.selected,e).filter(((e,t,n)=>n.indexOf(e)===t));this.selected=n.reduce(((e,t)=>(e[t]=!0,e)),{}),this.resetSearch({selected:n,value:""},t)})),this.onShowHistoryToggle=()=>{this.setState({isShowHistoryChecked:!this.state.isShowHistoryChecked})},this.onAddPeople=()=>{var e=this.props.store,t=e.get().peer,n=this.state.selected.map((e=>parseInt(e))),i=this.state.isShowHistoryChecked;this.setState({loading:!0}),e.set(o.addNewMember.bind(null,t,n,i)).then((()=>e.set(o.getChatDetails.bind(null,t)).then((()=>{this.selected={},this.resetSearch({selected:[],loading:!1},(()=>{this.props.afterSave(n.length)}))})))).catch((e=>{this.selected={},this.resetSearch({selected:[],loading:!1}),(0,_.showFastBox)(g("global_error"),e)}))},this.setSearchResults=(e,t,n,i)=>{var s=this.props.store.get(),a=(0,r.getTab)(s,s.peer),o=[];i.forEach((e=>{this.data[e.peerId]||(this.data[e.peerId]=e),-1===a.memberIds.indexOf(e.peerId)&&o.push(e.peerId)})),this.setState(Object.assign({},e,{found:o,value:n}),t||f)},this.appendSearchResults=e=>{var t=this.props.store.get(),n=(0,r.getTab)(t,t.peer),i=this.state.found;e.forEach((e=>{this.data[e.peerId]||(this.data[e.peerId]=e),-1===n.memberIds.indexOf(e.peerId)&&-1===i.indexOf(e.peerId)&&i.push(e.peerId)})),this.isSearching=!1,this.setState({found:i})},this.getBadge=()=>(0,p.getCurrentTab)(this.props.store).isDonutChat?i.createElement("div",{className:"BannerInfo ChatSettingsMembers__donutBadge"},g("mail_dons_only_search")):null,this.state={selected:[],value:"",loading:!1,found:[],isShowHistoryChecked:!0},this.data={},this.selected={}}resetSearch(e,t){var n=this.props.store.get(),i=(0,r.getTab)(n,n.peer);return(i.customChatMemberSearch?i.customChatMemberSearch(""):(0,o.searchLocalHints)("",this.props.store.get())).then((n=>this.setSearchResults(e,t,"",n)))}componentDidMount(){this.resetSearch()}render(){var e=Object.keys(this.state.selected).length,t="ChatSettingsMembers__entity";return i.createElement("div",{className:"ChatSettingsMembers"},i.createElement(c.default,{className:"ChatSettingsMembers__multiSelect",tokens:this.state.selected.map((e=>({text:unclean(this.data[e].name),id:e}))),removeTokenPlaceholder:g("mail_create_chat_remove_user"),onRemoveToken:this.onRemoveToken,placeholder:g("mail_search_creation"),value:this.state.value,onChange:this.onChange,onSelect:this.onSelect,useInfiniteScroll:!1,hasMore:!1,virtualized:!1,loadMore:()=>{},notFoundText:g("mail_not_found"),autoFocus:!0,isSearching:this.isSearching,badge:this.getBadge()},this.state.found.map((e=>i.createElement("div",{className:(0,a.classNames)(t,{[`${t}--selected`]:this.selected[e]}),key:e,"data-id":e},i.createElement(l.default,{size:"34",title:this.data[e].name,photo:this.data[e].photo}))))),i.createElement(d.default,{alignment:"right",className:"ChatSettingsMembers__submitArea"},i.createElement(u.default,{checked:this.state.isShowHistoryChecked,onChange:this.onShowHistoryToggle,className:"ChatSettingsMembers__showHistory"},g("mail_im_chat_add_members_show_history")),i.createElement(h.default,{disabled:0===e,onClick:this.onAddPeople,loading:this.state.loading,className:"ChatSettingsMembers__confirm"},g(e<2?"mail_append_chat":"mail_im_create_chat_with"))))}}},198946:(e,t,n)=>{"use strict";n.d(t,{default:()=>A});n(940851),n(976142),n(751876),n(820075),n(991181),n(296253),n(59357);var i=n(667294),s=n(41437),a=n(121265),r=n(663527),o=n(371372),l=n(74934),c=n(339814),h=n(670546),d=n(750598),u=n(248586),_=n(598940),m=n(629142),p=n(907851),g=n(906942),f=50,v={appendParentCls:"ChatSettingsWrapper"},C=s.default.getLang,S={all:"allShowMore",admins:"adminsShowMore",invitedByMRShowMore:"invitedByMRShowMore"};class A extends i.Component{constructor(e){super(e),this.onToggleSearch=()=>{this.state.showSearch?this.setState({showSearch:!1,searchQuery:""}):(this.setState({showSearch:!0}),requestAnimationFrame((()=>{this.searchInput.focus()})))},this.onSearchChange=e=>{e.target.value!==this.state.searchQuery&&this.setState({searchQuery:e.target.value})},this.onShowMore=()=>{var e=S[this.state.current];this.state[e]&&this.setState({[e]:!1})},this.onTabClick=(e,t)=>{e.preventDefault(),this.state.current!==t&&this.setState({current:t})},this.handleDocumentClick=e=>{!this.state.showSearch||this.state.searchQuery||e.target.closest(".ChatSettingsMembersWidget__search")||e.target.closest(".ChatSettingsMembersWidget__searchIcon")||this.setState({showSearch:!1})},this.onKeydown=e=>{this.state.showSearch&&27===e.keyCode&&(this.searchInput.blur(),this.setState({showSearch:!1,searchQuery:""}),e.preventDefault(),e.stopPropagation())},this.getInviter=e=>{if(this.invitersCache[e])return this.invitersCache[e];var t=this.props.store.get(),n=t.peer,i=t.tabs[n],s=i.inviters;if(!s[e])return"";var a=(0,r.getChatMembersByIds)(t,[s[e][0]])[0],o=getSmDate(s[e][2],t.timeshift,!0);if((0,l.isUserOwnerInChat)(i,e))return this.invitersCache[e]=C("mail_settings_owner"),C("mail_settings_owner");if(!a)return this.invitersCache[e]=o,o;var c=langSex(s[e][1],C("mail_chat_member_invited_by_X","raw")).replace(/{inviter}/,replaceEntities(a.name))+" "+o;return this.invitersCache[e]=c,c},this.isAddMemberWidgetShown=()=>{var e=this.props.store,t=(0,p.unpackStore)(e),n=t.id,i=t.peer,s=this.state,a=s.current,r=s.showSearch,o=s.searchQuery;return"all"===a&&!(r&&""!==o)&&(0,l.canInviteUser)(e,i,n)},this.getCommunityDescriptionText=e=>C(e?"mail_settings_community":"mail_settings_bot"),this.getMemberDescriptionText=(e,t,n)=>{var i=t.tabs[t.peer];if((0,r.isCommunityPeer)(e.id))return this.getCommunityDescriptionText(e.id===i.ownerId);if(n)return(0,r.getMessageRequestDateText)(e.date,t.timeshift);var s=i.membersLastSeen;return s&&s[e.id]?(0,r.getLastSeenText)(t,e.id,s[e.id],v):void 0},this.searchInputRef=e=>{this.searchInput=e};var t=e.store.get(),n=this.getMembers(t),i=this.getAdmins(t),s=this.getInvitedByMessageRequests(t);this.state={showSearch:!1,searchQuery:"",current:"all",all:n,allShowMore:n.length>f,admins:i,adminsShowMore:i.length>f,invitedByMR:s,invitedByMRShowMore:s.length>f},this.membersMap=n.reduce(((e,t)=>(e[t]=!0,e)),{}),this.searchIndexPromise=this.getSearchIndex(n).then((e=>{this.searchIndex=e})),this.invitersCache={}}componentWillReceiveProps(e){var t=e.store.get(),n=this.getMembers(t),i=this.getAdmins(t),s=this.getInvitedByMessageRequests(t),a={removes:[],additions:[]},r=n.reduce(((e,t)=>(e[t]=!0,e)),{});n.forEach((e=>{this.membersMap[e]||a.additions.push(e)})),Object.keys(this.membersMap).forEach((e=>{r[e]||a.removes.push(e)})),(a.removes.length||a.additions.length)&&(this.updateSearchIndex(t,a),this.membersMap=r);var o={all:n,allShowMore:this.state.allShowMore&&n.length>f,admins:i,adminsShowMore:this.state.adminsShowMore&&i.length>f,invitedByMR:s,invitedByMRShowMore:this.state.invitedByMRShowMore&&s.length>f};o.current=o[this.state.current].length>0?this.state.current:"all",this.setState(o)}getMembers(e){var t=e.peer,n=e.tabs[t],i=-1!==(n.memberIds||[]).indexOf(n.ownerId),s=(n.adminIds||[]).reduce(((e,t)=>(e[t]=!0,e)),{});return(i?[n.ownerId]:[]).concat((n.adminIds||[]).filter((e=>e!==n.ownerId)),(n.memberIds||[]).filter((e=>e!==n.ownerId&&!s[e])))}getAdmins(e){var t=e.peer,n=e.tabs[t];return(-1!==(n.memberIds||[]).indexOf(n.ownerId)?[n.ownerId]:[]).concat((n.adminIds||[]).filter((e=>e!==n.ownerId)))}getInvitedByMessageRequests(e){var t=e.peer;return e.tabs[t].invitedByMessageRequest.sort((function(e,t){return e.date-t.date}))}getCurrentList(){var e=this.props.store,t=this.state,n=t.current,i=t.showSearch,s=t.searchQuery,a=t.invitedByMR;if(i&&s&&this.searchIndex){var o=a.filter((e=>!!e.name.toLowerCase().trim().split(/\s+/).find((e=>0===e.indexOf(s.toLowerCase())))));return this.searchIndex.search(s).concat(o)}var l=this.state[n],c="invitedByMR"===n?l:(0,r.getChatMembersByIds)(e.get(),l);return this.state[`${n}ShowMore`]?c.slice(0,f):c}getSearchIndex(e){var t=window.vkIndexer,n=(0,r.getChatMembersByIds)(this.props.store.get(),e);return this.membersMap=n.reduce(((e,t)=>(e[t.id]=!0,e)),{}),new Promise(((e,i)=>{var s=new t(n,(e=>e.name),(()=>{e(s)}))}))}updateSearchIndex(e,t){var n=(0,r.getChatMembersByIds)(e,t.removes),i=(0,r.getChatMembersByIds)(e,t.additions);(this.searchIndex?Promise.resolve(this.searchIndex):this.searchIndexPromise).then((e=>{n.forEach((t=>{e.remove(t)})),i.forEach((t=>{e.add(t)}))}))}componentDidMount(){this.searchInput.addEventListener("keydown",this.onKeydown)}componentWillUnmount(){this.searchInput.removeEventListener("keydown",this.onKeydown)}render(){var e=this.props,t=e.store,n=e.membersCount,s=e.membersAdded,l=e.onHideStatus,p=this.state,f=p.current,v=p.showSearch,A=p.searchQuery,b=p.admins,y=p.invitedByMR,N=t.get(),E=N.peer,I=N.tabs[E],L=this.getCurrentList(),M=this.isAddMemberWidgetShown()?["add"].concat(L):L,w=this.state[S[f]],k={"ChatSettingsMembersWidget--search":!!v},O=I.adminIds.reduce(((e,t)=>(e[t]=!0,e)),{});return i.createElement("div",{className:(0,a.classNames)("ChatSettingsMembersWidget",k)},i.createElement("header",{className:"ChatSettingsMembersWidget__header"},i.createElement("input",{placeholder:C("mail_members_search"),className:"ChatSettingsMembersWidget__search",onChange:this.onSearchChange,onInput:this.onSearchChange,onPaste:this.onSearchChange,value:this.state.searchQuery,ref:this.searchInputRef}),i.createElement("button",{className:"ChatSettingsMembersWidget__searchIcon",onClick:this.onToggleSearch}),i.createElement(c.default,{className:"ChatSettingsMembersWidget__tabs",onTabClick:this.onTabClick},i.createElement("span",{key:"all"},C("mail_settings_everyone")+" ",i.createElement("span",{className:"Tabs__desc"},(0,r.getAliveMembersCount)(I))),b.length>0&&i.createElement("span",{key:"admins"},C("mail_settings_admins")+" ",i.createElement("span",{className:"Tabs__desc"},b.length)),y.length>0&&i.createElement("span",{key:"invitedByMR"},C("mail_invited_members")+" ",i.createElement("span",{className:"Tabs__desc"},y.length)))),i.createElement("div",{className:"ChatSettingsMembersWidget__list"},i.createElement(h.default,{border:!1},M.length>0&&M.map((e=>{if("add"===e)return i.createElement(d.default,{selectable:!1,border:!1,key:"add",onClick:this.props.showMembersSettings,aside:i.createElement(m.default,{className:"ChatSettingsMembersWidget__blink",shown:s,callback:l},langNumeric(n||0,C("mail_settings_members_added","raw")))},i.createElement("span",{className:"ChatSettingsMembersWidget__add"},i.createElement("span",null,C("mail_settings_add_members"))));var a=this.getInviter(e.id),c="invitedByMR"===f,h=e.image_status?e.name+`<span class="ChatSettingsMembersWidget__imageStatus">${e.image_status}</span>`:e.name,p=this.getMemberDescriptionText(e,N,c);return i.createElement(d.default,{selectable:!1,border:!1,aside:i.createElement(_.default,{adminMap:O,store:t,storeData:N,mid:e.id,onLeave:this.props.onLeave,isMR:c}),key:e.id},i.createElement(u.default,{ignoreDecodeHTML:!0,photo:(0,o.isContactPeer)(e.id)?i.createElement(g.ConversationNoPhoto,{id:E,text:(0,r.getUserInitials)(e.name),size:"xxxs",specificType:7}):e.photo,title:i.createElement("span",{dangerouslySetInnerHTML:{__html:h}}),description:i.createElement("span",{title:a,dangerouslySetInnerHTML:{__html:p}}),href:e.link,onLinkClick:t=>{t.preventDefault(),nav.go(e.link,t)}}))})),!M.length&&v&&A&&i.createElement("div",{className:"ChatSettingsMembersWidget__empty"},C("mail_settings_not_found")),!(v&&A)&&w&&i.createElement("div",{className:"ChatSettingsMembersWidget__more",onClick:this.onShowMore},C("mail_settings_show_all_members")))))}}},596673:(e,t,n)=>{"use strict";n.d(t,{default:()=>C});n(175115);var i=n(667294),s=n(121265),a=n(41437),r=n(856612),o=n(670546),l=n(750598),c=n(629142),h=n(248586),d=n(539503),u=n(927273),_=n(366035),m=n(74934),p=n(663527),g=n(929566),f=a.default.getLang,v=()=>[{label:f("mail_settings_time_one_hour"),value:u.HOUR},{label:f("mail_settings_time_eight_hours"),value:8*u.HOUR},{label:f("mail_settings_time_day"),value:u.DAY},{label:f("mail_settings_time_week"),value:u.WEEK},{label:f("mail_settings_time_forever"),value:-1}];class C extends i.Component{constructor(e){super(e),this.onCopyInviteLink=e=>{this.input&&(this.input.focus(),this.input.select(),document.execCommand("copy"),this.setState({copied:!0})),e.preventDefault(),e.stopPropagation()},this.onBlinkTextHide=()=>{this.setState({copied:!1})},this.getHiddenInput=e=>{this.input=e},this.onDisabledSettingsChange=e=>{var t=e.selected.value,n=t>0?Math.floor((Date.now()+t)/1e3):t,i=0!==n;this.setState({push_disabled_until:n,push_disabled:i,disabledPlaceholder:this.getDisabledPlaceholder(n)},(()=>{this.props.onUpdateNotificationSettings(i,Math.floor(t/1e3)).then((()=>{this.props.afterDisableUntilUpdated()}))}))},this.onMentionSettingsChange=e=>{var t=e.selected.value;this.setState({mentions_push_disabled:t},(()=>{this.props.onUpdateMentionNotificationSettings(t).then((()=>{this.props.afterNotificationSettingsUpdated()}))}))},this.onShowInviteLink=()=>{(0,m.canChangeInviteLink)(this.props.store)&&this.props.showInvitationLink()};var t=this.getPushSettingsFromProps(e),n=t.push_disabled_until,i=n>0?+new Date(n):n;this.state=Object.assign({pushDisabled:n,disabledPlaceholder:this.getDisabledPlaceholder(i),copied:!1},t)}getPushSettingsFromProps(e){var t=e.store.get();return t.tabs[t.peer].notifications}getPushDisabledFromProps(e){var t=e.store.get();return t.tabs[t.peer].notifications.push_disabled}getDisabledPlaceholder(e){if(!e||0===e)return f("mail_settings_configure");if(-1===e)return f("mail_settings_time_forever");var t=getShortDateWithTime(e,0,!1);return`${f("mail_settings_until")} ${t}`}getDisabledOptions(){return this.state.push_disabled_until?[].concat(v(),[{label:f("mail_settings_time_cancel"),value:0}]):v()}render(){var e=this.props,t=e.store,n=e.flagsUpdated,a=e.notificationSettingsUpdated,u=e.disableUntilUpdated,v=e.onHideStatus,C=e.invitationLinks,S=e.isInvitationLinkWithHistory,A=t.get(),b=A.tabs[A.peer],y=(0,p.isFvkcomgroup)(A,A.peer),N=(0,g.isCommunityChat)(A,A.peer),E=b.inviteLinks&&(0,m.canSeeInviteLink)(t)||(0,m.canChangeInviteLink)(t),I=C||b.inviteLinks,L=I&&(S?I.linkWithHistory:I.linkWithoutHistory),M=(0,m.canSeeSettingsItem)(t,A.peer,A.id),w=(0,s.classNames)("ChatSettingsMenu",{"ChatSettingsMenu--copied":this.state.copied}),k=A.isMassMentionsMessageAllowed,O=f(S?"mail_get_invite_link_copy_with_history":"mail_get_invite_link_copy_without_history");return i.createElement("div",{className:"ChatSettings__pane"},N&&i.createElement(o.default,{className:w},i.createElement(l.default,{onClick:e=>nav.go(b.owner.link,e),chevron:!0,className:"ChatSettingsMenu__owner"},i.createElement(h.default,{size:"28",title:b.owner.title,photo:b.owner.photo,href:b.owner.link,description:b.owner.description}))),i.createElement(o.default,{className:w},i.createElement(l.default,{onClick:this.props.showAttachments,chevron:!0},i.createElement(_.default,{type:"attach",backgroundColor:"blue"}),f("mail_im_show_media_history"))),i.createElement(o.default,{className:w},k&&i.createElement(i.Fragment,null,i.createElement(l.default,{selectable:!1,chevron:!1,aside:i.createElement(i.Fragment,null,i.createElement(c.default,{shown:a,callback:v},f("global_changes_saved_short")),i.createElement(d.default,{className:"ChatSettingsMenu__select",onChange:this.onMentionSettingsChange,options:[{label:f("mail_settings_mentions_all"),value:0},{label:f("mail_settings_mentions_except"),value:1},{label:f("mail_settings_mentions_disable"),value:2}],value:this.state.mentions_push_disabled}))},i.createElement(_.default,{type:"mention",backgroundColor:"blue"}),f("mail_settings_mentions")),i.createElement(l.default,{selectable:!1,aside:i.createElement(i.Fragment,null,i.createElement(c.default,{shown:u,callback:v},f("global_changes_saved_short")),i.createElement(d.default,{className:"ChatSettingsMenu__select",onChange:this.onDisabledSettingsChange,options:this.getDisabledOptions(),placeholder:this.state.disabledPlaceholder}))},i.createElement(_.default,{type:"notice",backgroundColor:"red"}),f("mail_settings_notices"))),(E||M)&&i.createElement(i.Fragment,null,E&&i.createElement(l.default,{onClick:this.onShowInviteLink,chevron:(0,m.canChangeInviteLink)(t)},i.createElement(_.default,{type:"link",backgroundColor:"green"}),f(y?"mail_vkcomgroup_invite_link":"mail_chat_invite_link"),L&&i.createElement("span",{className:"ChatSettingsMenu__invite"},i.createElement("span",{className:"ChatSettingsMenu__hidden"},i.createElement("input",{type:"text",readOnly:!0,value:L,ref:this.getHiddenInput})),i.createElement(c.default,{className:"ChatSettingsMenu__copied",shown:this.state.copied,callback:this.onBlinkTextHide},f("mail_invite_link_copied")),i.createElement(r.default,{className:"ChatSettingsMenu__copy",onClick:this.onCopyInviteLink},O))),M&&i.createElement(l.default,{onClick:this.props.showSettings,chevron:!0,aside:i.createElement(c.default,{shown:n,callback:v},f("global_changes_saved"))},i.createElement(_.default,{type:"gear",backgroundColor:"gray"}),f("mail_settings_options")))))}}},732779:(e,t,n)=>{"use strict";n.d(t,{ChatSettingsOptions:()=>p});n(176774);var i=n(667294),s=n(41437),a=n(670546),r=n(750598),o=n(539503),l=n(881150),c=n(423558),h=n(351605),d=n(366035),u=n(756800),_=n(74934),m=s.default.getLang;class p extends i.Component{constructor(e){super(e),this.onChange=e=>{var t=e.name,n=e.selected.value;this.setState((e=>({flags:n?e.flags&~t^n:e.flags&~t})))},this.onCancel=()=>{this.setState({flags:this.props.flags}),this.props.back()},this.onSave=()=>{this.state.loading||(this.setState({loading:!0}),this.props.onSave(this.state.flags).then((()=>{this.setState({loading:!1},this.props.afterSave)})).catch((e=>{this.setState({loading:!1,flags:this.props.flags})})))},this.setFlags=e=>{this.setState({flags:e})},this.isAllowed=e=>{var t=this.props.allowedUpdateFlags;return!t||t.includes(e)},this.state={flags:e.flags,loading:!1}}render(){var e=this.state.flags,t=this.props,n=t.isChatTypeEditAllowed,s=t.isCasperChatTab,p=t.isCommunityChat,g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[!p&&{value:e,label:m("mail_settings_only_owner")},{value:t,label:m(p?"mail_settings_only_admins":"mail_settings_owner_and_admins")},{value:n,label:m("mail_settings_all_members")}].filter(Boolean)};return i.createElement("div",{className:"ChatSettingsOptions"},this.props.isChatCreation&&i.createElement(u.default,{flags:e,onSelectPreset:this.setFlags}),i.createElement(a.default,null,(this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE)||this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE+_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE,options:g(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE,_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE),value:e&(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE|_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE)})},i.createElement(d.default,{type:"plus",backgroundColor:"green"}),m("mail_settings_can_invite")),(this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE)||this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE+_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE,options:g(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE,_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE),value:e&(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE|_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE)})},i.createElement(d.default,{type:"pencil",backgroundColor:"blue"}),m("mail_settings_can_edit_info")),(this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN)||this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN))&&!s&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN+_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN,options:g(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN,_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN),value:e&(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN|_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN)})},i.createElement(d.default,{type:"pin",backgroundColor:"blue"}),m("mail_settings_can_pin")),(this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION)||this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION+_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION,options:g(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION,_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION),value:e&(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION|_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION)})},i.createElement(d.default,{type:"mention",backgroundColor:"blue"}),m("mail_settings_can_use_mass_mention")),(this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK)||this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK+_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK,options:g(0,_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK,_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK),value:e&(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK|_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK)})},i.createElement(d.default,{type:"link",backgroundColor:"blue"}),m("mail_settings_can_see_invitation_link")),(this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL)||this.isAllowed(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL+_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL,options:g(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL,_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL),value:e&(_.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL|_.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL)})},i.createElement(d.default,{type:"call",backgroundColor:"green"}),m("mail_settings_can_start_group_call")),this.isAllowed(_.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS)&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS,options:[{value:0,label:m("mail_settings_only_owner")},{value:_.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS,label:m("mail_settings_owner_and_admins")}],value:e&_.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS})},i.createElement(d.default,{type:"user",backgroundColor:"green"}),m("mail_settings_admins_can_add_admins")),this.isAllowed(_.MAIL_CHAT_FLAG_SERVICE_CHAT)&&n&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__select",onChange:this.onChange,name:_.MAIL_CHAT_FLAG_SERVICE_CHAT,options:[{value:0,label:m("mail_settings_service_simple")},{value:_.MAIL_CHAT_FLAG_SERVICE_CHAT,label:m("mail_settings_service_service")}],value:e&_.MAIL_CHAT_FLAG_SERVICE_CHAT})},i.createElement(d.default,{type:"gear",backgroundColor:"gray"}),m("mail_settings_service"))),i.createElement(h.default,{alignment:"right",className:"ChatSettingsOptions__submitArena"},i.createElement(l.default,{appearance:"tertiary",onClick:this.onCancel},m("global_cancel")),i.createElement(c.default,{onClick:this.onSave,loading:this.state.loading},m("global_save"))))}}},756800:(e,t,n)=>{"use strict";n.d(t,{default:()=>l});n(176774);var i=n(667294),s=(n(45697),n(121265)),a=n(41437),r=149946368,o=0;class l extends i.Component{constructor(e){super(e),this.selectPreset=(e,t)=>{var n=3===this.state.selectedPresetId&&null!==this.state.customFlags;this.setState((e=>({selectedPresetId:t,customFlags:n?this.props.flags:e.customFlags}))),this.props.onSelectPreset(e)};var t=this.props.flags===r?2:this.props.flags===o?1:3;this.state={customFlags:3===t?this.props.flags:null,selectedPresetId:t}}componentWillReceiveProps(e){![o,r].includes(e.flags)&&this.setState({customFlags:e.flags,selectedPresetId:3})}render(){var e=this.state.customFlags?this.state.customFlags:this.props.flags,t=this.state.selectedPresetId,n="ChatSettingsPresetPanel__preset",l=[{id:1,title:(0,a.getLang)("mail_chat_creation_preset_regular"),icon:"regular",flags:o},{id:2,title:(0,a.getLang)("mail_chat_creation_preset_closed"),icon:"closed",flags:r},{id:3,title:(0,a.getLang)("mail_chat_creation_preset_custom"),icon:"custom",flags:e}];return i.createElement("div",{className:"ChatSettingsPresetPanel"},l.map(((e,a)=>i.createElement("div",{className:(0,s.classNames)(n,{[`${n}--selected`]:e.id===t}),onClick:this.selectPreset.bind(null,e.flags,e.id),key:a},i.createElement("div",{className:(0,s.classNames)("ChatSettingsPresetPanel__presetIcon",`ChatSettingsPresetPanel__presetIcon--${e.icon}`)}),i.createElement("div",{className:"ChatSettingsPresetPanel__presetTitle"},e.title)))))}}},234371:(e,t,n)=>{"use strict";n.d(t,{default:()=>c});var i=n(667294),s=n(41437),a=n(881150),r=n(423558),o=n(351605),l=s.default.getLang;class c extends i.Component{constructor(e){super(e),this.onConfirm=()=>{this.state.loading||(this.setState({loading:!0}),this.props.onConfirm().then((()=>{this.setState({loading:!1}),this.props.onCancel()})).catch((()=>this.setState({loading:!1}))))},this.state={}}render(){return i.createElement("div",{className:"ChatSettingsResetInvitationLink"},i.createElement("div",{className:"ChatSettingsResetInvitationLink__text",dangerouslySetInnerHTML:{__html:l("mail_chat_reset_link_warning")}}),i.createElement(o.default,{alignment:"right"},i.createElement(a.default,{appearance:"tertiary",onClick:this.props.onCancel},l("global_cancel")),i.createElement(r.default,{onClick:this.onConfirm,loading:this.state.loading},l("mail_chat_reset_link_confirm"))))}}},366035:(e,t,n)=>{"use strict";n.d(t,{default:()=>a});var i=n(667294),s=(n(45697),n(121265));function a(e){return i.createElement("div",{className:(0,s.classNames)("ChatSettingsRoundedIcon",`ChatSettingsRoundedIcon--${e.type}`,`ChatSettingsRoundedIcon--${e.backgroundColor}`)})}},212311:(e,t,n)=>{"use strict";n.d(t,{mount:()=>v});var i,s=n(533246),a=n(667294),r=n(973935),o=n(126764),l=n(389430),c=n(929566),h=n(907851),d=n(236205);function u(e,t){var n=ls.get("im_chats_no_invite_link_history")||[],i=e-2e9,s=t?n.filter((e=>e!==i)):n.concat(i);ls.set("im_chats_no_invite_link_history",s)}function _(e,t){var n=g(),i=function(e){var t=(0,d.getPeer)(e)-2e9;return!(ls.get("im_chats_no_invite_link_history")||[]).includes(t)}(e);n&&r.render(a.createElement(o.ChatSettings,{store:e,closePopup:m.bind(null,e),updatePopup:p,isLinkWithHistorySelected:i,updateHistoryLinkState:u,parentMutations:t}),n)}function m(e){i&&i.hide();var t=e.get();t.hasOwnProperty("onClose")&&t.onClose()}function p(){i&&i.updateBoxCoords()}function g(){return document.querySelector("#ChatSettings")}function f(e){var t=document.querySelector("#box_layer_wrap"),n=document.querySelector("#box_loader"),i=isVisible(t);return{unmount(){var t=g();t&&r.unmountComponentAtNode(t),(0,s.destroyModule)(e)},showLoader(){boxRefreshCoords(n),show(n),i||show(t)},hideLoader(){hide(n),i||hide(t)}}}function v(e,t,n){var a=(0,s.createMutations)(f).bindMutations,r=t.get(),o=(0,s.createModule)({handlers:(e,t)=>{}}),d=r.peer,u=a(o);var p=function(e,t){t.get().peer===d?function(e,t){var n=(0,c.getTab)(e,e.get().peer);n&&n.data&&(0,c.isChatActive)(n)?_(e,t):m(e)}(t,n):e.unmount()}.bind(null,u),g={hideButtons:!0,bodyStyle:"padding: 0; background: none;",width:560,onShow(){_(t,n),t.subscribe(p),requestAnimationFrame((()=>i.updateBoxCoords()))},onHideAttempt:()=>(t.unsubscribe(p),u.unmount(),!0)};return u.showLoader(),t.set(l.getChatDetails.bind(null,d)).then((e=>{u.hideLoader();var t=(0,h.unpackStore)(e).peer;t&&t===d?i=new MessageBox(g).content('<div id="ChatSettings" class="ChatSettingsWrapper"></div>').show():u.unmount()})),u}},408091:e=>{"use strict";function t(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),i=1;i<arguments.length;i++){var s=arguments[i];if(null!=s)for(var a=Object.keys(Object(s)),r=0,o=a.length;r<o;r++){var l=a[r],c=Object.getOwnPropertyDescriptor(s,l);void 0!==c&&c.enumerable&&(n[l]=s[l])}}return n}e.exports={assign:t,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:t})}}},362548:function(e,t,n){e.exports=function(){"use strict";function e(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var t=e((function(e,t){!function(t,n){e.exports=n()}(0,(function(){function e(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function t(e){return Array.isArray(e)?[]:{}}function n(n,i){return i&&!0===i.clone&&e(n)?a(t(n),n,i):n}function i(t,i,s){var r=t.slice();return i.forEach((function(i,o){void 0===r[o]?r[o]=n(i,s):e(i)?r[o]=a(t[o],i,s):-1===t.indexOf(i)&&r.push(n(i,s))})),r}function s(t,i,s){var r={};return e(t)&&Object.keys(t).forEach((function(e){r[e]=n(t[e],s)})),Object.keys(i).forEach((function(o){e(i[o])&&t[o]?r[o]=a(t[o],i[o],s):r[o]=n(i[o],s)})),r}function a(e,t,a){var r=Array.isArray(t),o=(a||{arrayMerge:i}).arrayMerge||i;return r?Array.isArray(e)?o(e,t,a):n(t,a):s(e,t,a)}return a.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((function(e,n){return a(e,n,t)}))},a}))}));function i(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).map((function(e){e(n)})),(e["*"]||[]).map((function(e){e(t,n)}))}}}var s=e((function(e,t){var n={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}};t.default=n,e.exports=t.default})),a=function(e){return Object.keys(e).map((function(t){return t+'="'+e[t].toString().replace(/"/g,"&quot;")+'"'})).join(" ")},r=s.svg,o=s.xlink,l={};l[r.name]=r.uri,l[o.name]=o.uri;var c,h=function(e,n){void 0===e&&(e="");var i=t(l,n||{});return"<svg "+a(i)+">"+e+"</svg>"},d=s.svg,u=s.xlink,_={attrs:(c={style:["position: absolute","width: 0","height: 0"].join("; "),"aria-hidden":"true"},c[d.name]=d.uri,c[u.name]=u.uri,c)},m=function(e){this.config=t(_,e||{}),this.symbols=[]};m.prototype.add=function(e){var t=this.symbols,n=this.find(e.id);return n?(t[t.indexOf(n)]=e,!1):(t.push(e),!0)},m.prototype.remove=function(e){var t=this.symbols,n=this.find(e);return!!n&&(t.splice(t.indexOf(n),1),n.destroy(),!0)},m.prototype.find=function(e){return this.symbols.filter((function(t){return t.id===e}))[0]||null},m.prototype.has=function(e){return null!==this.find(e)},m.prototype.stringify=function(){var e=this.config.attrs,t=this.symbols.map((function(e){return e.stringify()})).join("");return h(t,e)},m.prototype.toString=function(){return this.stringify()},m.prototype.destroy=function(){this.symbols.forEach((function(e){return e.destroy()}))};var p=function(e){var t=e.id,n=e.viewBox,i=e.content;this.id=t,this.viewBox=n,this.content=i};p.prototype.stringify=function(){return this.content},p.prototype.toString=function(){return this.stringify()},p.prototype.destroy=function(){var e=this;["id","viewBox","content"].forEach((function(t){return delete e[t]}))};var g=function(e){var t=!!document.importNode,n=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;return t?document.importNode(n,!0):n},f=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={isMounted:{}};return n.isMounted.get=function(){return!!this.node},t.createFromExistingNode=function(e){return new t({id:e.getAttribute("id"),viewBox:e.getAttribute("viewBox"),content:e.outerHTML})},t.prototype.destroy=function(){this.isMounted&&this.unmount(),e.prototype.destroy.call(this)},t.prototype.mount=function(e){if(this.isMounted)return this.node;var t="string"==typeof e?document.querySelector(e):e,n=this.render();return this.node=n,t.appendChild(n),n},t.prototype.render=function(){var e=this.stringify();return g(h(e)).childNodes[0]},t.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(t.prototype,n),t}(p),v={autoConfigure:!0,mountTo:"body",syncUrlsWithBaseTag:!1,listenLocationChangeEvent:!0,locationChangeEvent:"locationChange",locationChangeAngularEmitter:!1,usagesToUpdate:"use[*|href]",moveGradientsOutsideSymbol:!1},C=function(e){return Array.prototype.slice.call(e,0)},S={isChrome:function(){return/chrome/i.test(navigator.userAgent)},isFirefox:function(){return/firefox/i.test(navigator.userAgent)},isIE:function(){return/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)},isEdge:function(){return/edge/i.test(navigator.userAgent)}},A=function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent(e,!1,!1,t),window.dispatchEvent(n)},b=function(e){var t=[];return C(e.querySelectorAll("style")).forEach((function(e){e.textContent+="",t.push(e)})),t},y=function(e){return(e||window.location.href).split("#")[0]},N=function(e){angular.module("ng").run(["$rootScope",function(t){t.$on("$locationChangeSuccess",(function(t,n,i){A(e,{oldUrl:i,newUrl:n})}))}])},E="linearGradient, radialGradient, pattern, mask, clipPath",I=function(e,t){return void 0===t&&(t=E),C(e.querySelectorAll("symbol")).forEach((function(e){C(e.querySelectorAll(t)).forEach((function(t){e.parentNode.insertBefore(t,e)}))})),e};function L(e,t){return C(e).reduce((function(e,n){if(!n.attributes)return e;var i=C(n.attributes),s=t?i.filter(t):i;return e.concat(s)}),[])}var M=s.xlink.uri,w="xlink:href",k=/[{}|\\\^\[\]`"<>]/g;function O(e){return e.replace(k,(function(e){return"%"+e[0].charCodeAt(0).toString(16).toUpperCase()}))}function T(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(e,t,n){return C(e).forEach((function(e){var i=e.getAttribute(w);if(i&&0===i.indexOf(t)){var s=i.replace(t,n);e.setAttributeNS(M,w,s)}})),e}var H=["clipPath","colorProfile","src","cursor","fill","filter","marker","markerStart","markerMid","markerEnd","mask","stroke","style"],P=H.map((function(e){return"["+e+"]"})).join(","),F=function(e,t,n,i){var s=O(n),a=O(i);L(e.querySelectorAll(P),(function(e){var t=e.localName,n=e.value;return-1!==H.indexOf(t)&&-1!==n.indexOf("url("+s)})).forEach((function(e){return e.value=e.value.replace(new RegExp(T(s),"g"),a)})),x(t,s,a)},D={MOUNT:"mount",SYMBOL_MOUNT:"symbol_mount"};return function(e){function n(n){var s=this;void 0===n&&(n={}),e.call(this,t(v,n));var a=i();this._emitter=a,this.node=null;var r=this.config;if(r.autoConfigure&&this._autoConfigure(n),r.syncUrlsWithBaseTag){var o=document.getElementsByTagName("base")[0].getAttribute("href");a.on(D.MOUNT,(function(){return s.updateUrls("#",o)}))}var l=this._handleLocationChange.bind(this);this._handleLocationChange=l,r.listenLocationChangeEvent&&window.addEventListener(r.locationChangeEvent,l),r.locationChangeAngularEmitter&&N(r.locationChangeEvent),a.on(D.MOUNT,(function(e){r.moveGradientsOutsideSymbol&&I(e)})),a.on(D.SYMBOL_MOUNT,(function(e){r.moveGradientsOutsideSymbol&&I(e.parentNode),(S.isIE()||S.isEdge())&&b(e)}))}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var s={isMounted:{}};return s.isMounted.get=function(){return!!this.node},n.prototype._autoConfigure=function(e){var t=this.config;void 0===e.syncUrlsWithBaseTag&&(t.syncUrlsWithBaseTag=void 0!==document.getElementsByTagName("base")[0]),void 0===e.locationChangeAngularEmitter&&(t.locationChangeAngularEmitter=void 0!==window.angular),void 0===e.moveGradientsOutsideSymbol&&(t.moveGradientsOutsideSymbol=S.isFirefox())},n.prototype._handleLocationChange=function(e){var t=e.detail,n=t.oldUrl,i=t.newUrl;this.updateUrls(n,i)},n.prototype.add=function(t){var n=this,i=e.prototype.add.call(this,t);return this.isMounted&&i&&(t.mount(n.node),this._emitter.emit(D.SYMBOL_MOUNT,t.node)),i},n.prototype.attach=function(e){var t=this,n=this;if(n.isMounted)return n.node;var i="string"==typeof e?document.querySelector(e):e;return n.node=i,this.symbols.forEach((function(e){e.mount(n.node),t._emitter.emit(D.SYMBOL_MOUNT,e.node)})),C(i.querySelectorAll("symbol")).forEach((function(e){var t=f.createFromExistingNode(e);t.node=e,n.add(t)})),this._emitter.emit(D.MOUNT,i),i},n.prototype.destroy=function(){var e=this,t=e.config,n=e.symbols,i=e._emitter;n.forEach((function(e){return e.destroy()})),i.off("*"),window.removeEventListener(t.locationChangeEvent,this._handleLocationChange),this.isMounted&&this.unmount()},n.prototype.mount=function(e,t){void 0===e&&(e=this.config.mountTo),void 0===t&&(t=!1);var n=this;if(n.isMounted)return n.node;var i="string"==typeof e?document.querySelector(e):e,s=n.render();return this.node=s,t&&i.childNodes[0]?i.insertBefore(s,i.childNodes[0]):i.appendChild(s),this._emitter.emit(D.MOUNT,s),s},n.prototype.render=function(){return g(this.stringify())},n.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},n.prototype.updateUrls=function(e,t){if(!this.isMounted)return!1;var n=document.querySelectorAll(this.config.usagesToUpdate);return F(this.node,n,y(e)+"#",y(t)+"#"),!0},Object.defineProperties(n.prototype,s),n}(m)}()},887854:function(e,t,n){e.exports=function(){"use strict";var e=function(e){var t=e.id,n=e.viewBox,i=e.content;this.id=t,this.viewBox=n,this.content=i};e.prototype.stringify=function(){return this.content},e.prototype.toString=function(){return this.stringify()},e.prototype.destroy=function(){var e=this;["id","viewBox","content"].forEach((function(t){return delete e[t]}))};var t=function(e){var t=!!document.importNode,n=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement;return t?document.importNode(n,!0):n};function i(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var s=i((function(e,t){!function(t,n){e.exports=n()}(0,(function(){function e(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function t(e){return Array.isArray(e)?[]:{}}function n(n,i){return i&&!0===i.clone&&e(n)?a(t(n),n,i):n}function i(t,i,s){var r=t.slice();return i.forEach((function(i,o){void 0===r[o]?r[o]=n(i,s):e(i)?r[o]=a(t[o],i,s):-1===t.indexOf(i)&&r.push(n(i,s))})),r}function s(t,i,s){var r={};return e(t)&&Object.keys(t).forEach((function(e){r[e]=n(t[e],s)})),Object.keys(i).forEach((function(o){e(i[o])&&t[o]?r[o]=a(t[o],i[o],s):r[o]=n(i[o],s)})),r}function a(e,t,a){var r=Array.isArray(t),o=(a||{arrayMerge:i}).arrayMerge||i;return r?Array.isArray(e)?o(e,t,a):n(t,a):s(e,t,a)}return a.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((function(e,n){return a(e,n,t)}))},a}))})),a=i((function(e,t){var n={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}};t.default=n,e.exports=t.default})),r=function(e){return Object.keys(e).map((function(t){return t+'="'+e[t].toString().replace(/"/g,"&quot;")+'"'})).join(" ")},o=a.svg,l=a.xlink,c={};c[o.name]=o.uri,c[l.name]=l.uri;var h=function(e,t){void 0===e&&(e="");var n=s(c,t||{});return"<svg "+r(n)+">"+e+"</svg>"};return function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={isMounted:{}};return i.isMounted.get=function(){return!!this.node},n.createFromExistingNode=function(e){return new n({id:e.getAttribute("id"),viewBox:e.getAttribute("viewBox"),content:e.outerHTML})},n.prototype.destroy=function(){this.isMounted&&this.unmount(),e.prototype.destroy.call(this)},n.prototype.mount=function(e){if(this.isMounted)return this.node;var t="string"==typeof e?document.querySelector(e):e,n=this.render();return this.node=n,t.appendChild(n),n},n.prototype.render=function(){var e=this.stringify();return t(h(e)).childNodes[0]},n.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(n.prototype,i),n}(e)}()},151223:(e,t,n)=>{"use strict";n.d(t,{kickUserOptimistically:()=>s});var i=n(351117);function s(e,t,n){var s=(0,i.getTab)(e,t);return s&&(0,i.isChatConvo)(s)?(s.memberIds=s.memberIds.filter((function(e){return e!==n})),s.adminIds=s.adminIds.filter((function(e){return e!==n})),s.membersCount=s.memberIds.length,Promise.resolve(e)):Promise.reject("No chat info")}}}]);try{stManager.done("dist/902866c362380432bb8fab2a5e67d693.98d5c430f2ba302100a8.js")}catch(e){}