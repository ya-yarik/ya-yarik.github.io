(self.webpackChunkvk=self.webpackChunkvk||[]).push([[7669],{23664:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{WkView:()=>WkView});var core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(530522),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(66108),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(296253),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(991181),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(579665),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(95767),core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(175115),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(283946),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(59357),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(976142),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(751876),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(21466),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(182408),_web_lib_ajax_cache__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(267660),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(519921),_web_lib_dom__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(414914),_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(705456),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(791563),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(719016),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(653439),_shared_lib_common__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(917999),_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(190148),_web_reports_reports__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(496495);function _slicedToArray(e,o){return _arrayWithHoles(e)||_iterableToArrayLimit(e,o)||_unsupportedIterableToArray(e,o)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,o){if(e){if("string"==typeof e)return _arrayLikeToArray(e,o);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,o):void 0}}function _arrayLikeToArray(e,o){(null==o||o>e.length)&&(o=e.length);for(var r=0,t=new Array(o);r<o;r++)t[r]=e[r];return t}function _iterableToArrayLimit(e,o){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],t=!0,i=!1,a=void 0;try{for(var w,l=e[Symbol.iterator]();!(t=(w=l.next()).done)&&(r.push(w.value),!o||r.length!==o);t=!0);}catch(e){i=!0,a=e}finally{try{t||null==l.return||l.return()}finally{if(i)throw a}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _extends(){return(_extends=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var WkView={init:function(){window.wkLayer||(window.wkLayer=ce("div",{id:"wk_layer"}),window.wkLayerWrap=ce("div",{id:"wk_layer_wrap",className:"scroll_fix_wrap fixed layer_wrap js-mediator-container"}),wkLayerWrap.appendChild(window.wkLayer),bodyNode.appendChild(wkLayerWrap),window.LazyLoad&&LazyLoad.watch(wkLayerWrap),window.wkLayer.style.width=lastWindowWidth-(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.sbWidth)()-2+"px")},showLayer:function(){layerQueue.hide(),layers.wrapshow(wkLayerWrap,.8),layers.fullhide=WkView.hide,WkView.onScroll(),wkcur.showT=setTimeout((function(){layers.wrapshow(wkLayerWrap,.8),layers.fullhide=WkView.hide}),0),onBodyResize()},restoreLayer:function(e){WkView.showLayer(),wkcur.root?e.myLoc&&nav.setLoc(e.myLoc):WkView.setLocation(),e.prevLoc&&(wkcur.prevLoc=e.prevLoc),WkView.updateSize()},wikiClick:function(e,o,r){if(checkEvent(o))return!0;r=r||{};for(var t=o.target;t&&"A"!==t.tagName;)t=t.parentNode;if(t&&"A"===t.tagName){var i,a,w=t.href,l=w.match(/^\/(page[^?]*)(\?.*)?$/);if(l)i=l[1],a=l[4]?AjaxConvert.fromQueryString(l[4].substr(1)):{};else{if(!(l=w.match(/https?:\/\/([a-zA-Z0-9\-_\.]+\.)?(vk\.com|vkontakte\.ru)\/([^?]*)(\?.*)?$/i))||!l[3])return!0;i=l[3].split("/"),a=l[4]?AjaxConvert.fromQueryString(l[4].substr(1)):{}}var s={};switch(i[0]){case"pages":s.oid=a.oid||a.o,s.id=a.id,s.p=a.p;break;case"ru":case"en":s.p=i[1],s.global=i[0];break;default:i[0].match(/^page-?\d+_\d+$/)?(a=i[0].substr(4).split("_"),s.oid=a[0],s.id=a[1],s=extend(r,s)):i[0].match(/^note\d+_\d+$/)&&(a=i[0].substr(4).split("_"),s.w=i[0])}if(s.w||s.oid&&(s.id||s.p))return showWiki(s),cancelEvent(o)}},edit:function edit(){return!wkcur.canEdit||("wall"===wkcur.type?(wkcur.edit?Wall.cancelEdit():Wall.editPost(ge("wpe_edit"+wkcur.post),wkcur.post,{from:"wkview"}),!0):wkcur.edit?(params=wkcur.note?{w:"note"+wkcur.oid+"_"+wkcur.nid}:{oid:wkcur.oid,id:wkcur.pid,p:wkcur.p},window.wkcur=!1,showWiki(params,!1,!1,{noloader:!0}),!0):(wkcur.edit=!0,params={act:"edit",oid:wkcur.oid,load:1,section:"edit"},wkcur.note?(params.nid=wkcur.nid,params.note=1):params.id=wkcur.pid,wkcur.from&&(params.from=wkcur.from),void ajax.post("wkview.php",params,{stat:[jsc("web/pages.js"),jsc("web/wk_editor.js"),"wk_editor.css"],onDone:function onDone(content,js,info,options){wkcur.wkContent.innerHTML=content,hide(wkcur.wkRight),addClass(wkcur.wkBox,"wk_view_no_background");try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,js)}addEvent(wkLayerWrap,"scroll",WkView.onScroll),addEvent(window,"resize",WkView.onResize),WkView.onScroll(),WkView.updateSize()}})));var params},onScroll:function(e,o){switch(wkcur.lSTL&&WkView.stlOnScroll(o),o||WkView.updateSize(!0),wkcur.type){case"wall":return WkView.wallUpdateRepliesOnScroll(o);case"likes":return WkView.likesOnScroll(o);case"history":return WkView.historyOnScroll(o);case"market":if(window.Market)return Market.updateCommentsOnScroll(o);break;case"story":window.Stories&&Stories.onResize()}if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(WkView.customOnScroll)||!WkView.customOnScroll(o)){var r=ge("wke_buttons_panel"),t=ge("wke_buttons_cont");if(r){var i=getXY(t,!0)[1];wkcur.bottomSize||(wkcur.bottomSize=getSize(r));var a=wkcur.bottomSize[1],w=window.innerHeight||document.documentElement.clientHeight;if(o&&!wkcur.fixedBottom&&w-a<i+20)wkLayerWrap.scrollTop+=i+20-(w-a);else if(w-a<i){if(!wkcur.fixedBottom||o){wkcur.fixedBottom=!0;var l=getSize(t);addClass(wkcur.wkContent,"wke_bottom_fixed"),setStyle(r,{width:l[0],height:l[1]}),setStyle(t,{paddingTop:l[1]})}}else(wkcur.fixedBottom||o)&&(wkcur.fixedBottom=!1,removeClass(wkcur.wkContent,"wke_bottom_fixed"),setStyle(r,{width:null,height:null}),setStyle(t,{paddingTop:0}));var s=ge("wke_controls"),n=ge("wke_controls_cont");if(n)if(getXY(n,!0)[1]<0){if(!wkcur.fixedTop){wkcur.fixedTop=!0;var _=getSize(n);addClass(wkcur.wkContent,"wke_top_fixed"),setStyle(s,{width:_[0],height:_[1]}),setStyle(n,{paddingTop:_[1]})}}else wkcur.fixedTop&&(wkcur.fixedTop=!1,removeClass(wkcur.wkContent,"wke_top_fixed"),setStyle(s,{width:null,height:null}),setStyle(n,{paddingTop:0}))}}},saveInfo:function saveInfo(autosave){var params={page:wkcur.p,hash:wkcur.hash};return params.Body=wkcur.editor.val(),!1!==params.Body&&(params=wkcur.note?extend(params,{act:"save",oid:wkcur.oid,nid:wkcur.nid,wysiwyg:1,note:wkcur.note}):extend(params,{act:"save",oid:wkcur.oid,id:wkcur.pid}),wkcur.pageTitle&&(params.title=val(wkcur.pageTitle)),"page_new"===wkcur.type&&(params.page_new=1),wkcur.from&&(params.from=wkcur.from),(!autosave||!(wkcur.lockAutoSave||wkcur.note&&curBox()))&&(wkcur.lockAutoSave=!0,void ajax.post(wkcur.note?"wkview.php":"al_pages.php",params,{onDone:function onDone(text,data){var saveEl;if(wkcur.lockAutoSave=!1,wkcur.editor.changed=!1,autosave||(saveEl=ge("pages_save_info_wysiwyg"),saveEl&&(saveEl.innerHTML=text,show(saveEl))),"market"===wkcur.from&&data){null!==data.html&&(ge("group_edit_market_wiki").innerHTML=data.html);try{eval(data.js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,data.js)}}else if(data){if(data.nid&&(wkcur.nid=data.nid),data.raw&&(wkcur.wkRaw=data.raw),data.created&&cur.chooseMedia)return nav.setLoc(extend(nav.objLoc,{w:"note"+data.raw})),autosave||WkView.hide(!1,!0),cur.pbNoteAdded=data,cur.chooseMedia("note",data.raw,data),!0;var title=ge("share_note_title"+data.raw);if(title&&!autosave&&(title.innerHTML=data.title),wkcur.note&&wkcur.toStatus&&!autosave)return WkView.hide(!1,!0),wkcur.reloadOnSave&&(boxRefreshCoords(boxLoader),show(boxLoader),show(boxLayerWrap),nav.reload({onDone:function(){hide(boxLoader),hide(boxLayerWrap)}})),!0}if(autosave)return!0;setTimeout((function(){saveEl&&fadeOut(saveEl,200)}),1500)},showProgress:function(){!autosave&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockButton)(ge("wk_layer_save"))},hideProgress:function(){!autosave&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockButton)(ge("wk_layer_save"))},onFail:WkView.showError})))},initWkBox:function initWkBox(title,html,options,script){curBox()&&curBox().type&&curBox().type==options.type&&(curBox().setOptions({onHide:!1}),curBox().hide());var box=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(extend({title},options),html);if(options.wkRaw&&(box.wkRaw=options.wkRaw),options.type&&(box.type=options.type),options.commonClass&&addClass(box.bodyNode,options.commonClass),script)try{eval(script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,script)}box.setOptions(_extends({onHide(e){!e&&nav.objLoc.w&&nav.change({w:!1},void 0,{asBox:!0})},onShow(){box.wkRaw&&(nav.objLoc.w=box.wkRaw,nav.setLoc(nav.objLoc))}},options.boxOptions));var nl=extend(nav.objLoc,{w:options.wkRaw});return delete nl.z,nav.strLoc==nav.toStr(nl)||options.noChangeLocation||nav.setLoc(nl),box},evalScripts:function(e){if("SCRIPT"===e.tagName)e.parentNode.replaceChild(this.cloneNode(e),e);else for(var o=0,r=e.childNodes;o<r.length;)this.evalScripts(r[o++])},cloneNode:function(e){var o=ce(e.tagName.toLowerCase());o.text=e.innerHTML;for(var r=e.attributes.length-1;r>=0;r--)o.setAttribute(e.attributes[r].name,e.attributes[r].value);return o},show:function show(title,html,options,script,ev){if(options.asBox)return this.initWkBox(title,html,options,script),!0;window.wkcur?(wkcur.shown&&!isVisible(wkLayerWrap)&&WkView.hide(!0,!0),each(wkcur._hide||[],(function(e,o){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(o)&&o()}))):this.init();var hlen=window.wkcur&&wkcur.historyLen?wkcur.historyLen:0;window.wkcur&&(wkcur.doBack||options.fromlist)||(hlen+=1);var toQueue=options.queue;if(toQueue&&(layerQueue.push(),options.queue=!1),(window.wkcur||{}).shown&&wkcur.root&&nav.setLoc(wkcur.prevLoc),window.wkcur={historyLen:hlen,_hide:[],_show:[]},(browser.iphone||browser.ipad)&&(cur.wkStartScroll=scrollGetY()),options.edit&&(cur._editMode=function(){return!0},!window.WkEditor))return stManager.add([jsc("web/wk_editor.js"),"wk_editor.css"],WkView.show.pbind(title,html,options,script,ev)),!1;cur.cancelTooltip=!0,window.tooltips&&tooltips.hideAll(),options.skipBoxesHide||boxQueue.hideAll(),isVisible(wkLayerWrap)||(addEvent(window,"resize",WkView.onResize),addEvent(wkLayerWrap,"click",WkView.onClick),WkView.showLayer()),wkcur.noLocChange=0,wkcur.noHistory=options.noLocChange,wkcur.isArchived=options.isArchived,wkcur.hideTitle=options.hide_title?1:0,wkcur.hideCloseButton=options.hideCloseButton?1:0,wkcur.shown=!0,wkcur.edit&&(wkcur.edit=!1),extend(wkcur,options),wkcur.root?(cur.nav.push((function(e,o,r,t){if((r=nav.toStr(r))==wkcur.prevLoc)return WkView.hide(!0),!1})),!options.noLocChange&&options.myLoc&&nav.setLoc(options.myLoc)):(WkView.setLocation(options.noLocChange,toQueue),options.prevLoc&&(wkcur.prevLoc=options.prevLoc)),ev&&ev.pageX&&ev.pageY&&extend(wkcur,{oldX:ev.pageX,oldY:ev.pageY,oldT:Date.now()}),addClass(wkLayerWrap,"wk_dark"),addEvent(wkLayerWrap,"scroll",WkView.onScroll),addClass(layerBG,"wk_dark");var content=html,hideLeft=wkcur.historyLen>1?"":"display: none;",hideCloseBtn=wkcur.hideCloseButton?"display: none;":"";if("wall"==options.type?(addEvent(window,"resize",WkView.onResize),WkView.wallBeforeInitPost(options)):options.edit?addEvent(window,"resize",WkView.onResize):options&&(content='<div class="wk_text wk_wiki_content'+(options.className?" "+options.className:"")+'" onclick="return WkView.wikiClick(this, event);">'+content+"</div>"),wkcur.wkCont?wkcur.wkContent.innerHTML=content:(wkLayer.innerHTML=`<div class="wk_cont">\n  <div id="wk_box" onclick="wkcur.wkClicked = true;">\n    <div id="wk_loader"></div>\n    <a id="wk_close_link" href="javascript: return false;" class="fl_r wk_close_link" onclick="return WkView.hide(false, true, event);">\n      ${getLang("global_close")}\n    </a>\n    <div id="wk_summary" class="fl_l"><span class="summary" id="wk_layer_title">${title}</span></div>\n    <div id="wk_content" tabindex="0">${content}</div>\n    <div class="clear"></div>\n  </div>\n  <div id="wk_dots" class="wk_dots"></div>\n  </div>\n<div id="wk_left_wrap"><div id="wk_left" style="${hideLeft}" class="wk_left no_select"></div></div>\n<div class="wk_left_nav no_select" id="wk_left_nav" style="${hideLeft}" ' + 'onmousedown="wkcur.wkClicked = true; WkView.back();" onselectstart="return cancelEvent(event);"></div>\n<div class="wk_right_nav no_select" id="wk_right_nav" onmousedown="if (!wkcur.noClickHide) { wkcur.wkClicked = true; WkView.hide(); }"><div id="wk_right" class="wk_close no_select" style="${hideCloseBtn}"><div class="wk_close_inner"></div></div></div>\n<div id="wk_left_arrow_bg" class="wk_arrow_bg no_select" onclick="return WkView.navigate(this, event, -1);" onmouseover="WkView.preloadArrow(false)"><div class="wk_arrow_bg_inner"></div><div id="wk_left_arrow" class="wk_arrow no_select"></div></div>\n<div id="wk_right_arrow_bg" class="wk_arrow_bg no_select" onclick="return WkView.navigate(this, event, 1);" onmouseover="WkView.preloadArrow(true)"><div class="wk_arrow_bg_inner"></div><div id="wk_right_arrow" class="wk_arrow no_select"></div></div>`,options.nocross&&re(geByClass1("wk_close_inner",wkLayer)),extend(wkcur,{wkCont:wkLayer.firstChild,wkBox:ge("wk_box"),mvLoader:ge("wk_loader"),wkContent:ge("wk_content"),wkLeftNav:ge("wk_left_nav"),wkRightNav:ge("wk_right_nav"),wkLeft:ge("wk_left"),wkLeftWrap:ge("wk_left_wrap"),wkRight:ge("wk_right"),wkLeftArrow:ge("wk_left_arrow"),wkRightArrow:ge("wk_right_arrow"),wkLeftArrowBg:ge("wk_left_arrow_bg"),wkRightArrowBg:ge("wk_right_arrow_bg"),wkDots:ge("wk_dots")}),"away"===options.wkRaw.substr(0,4)&&(this.evalScripts(wkLayer),setTimeout((function(){window._mediator&&window._mediator.start({url:location.pathname+location.search})}),1500))),toggle("wk_summary",title),options.withDots&&options.wkRawList.length)for(var dotsCount=options.wkRawList.length,i=0;i<dotsCount;i++){var iRaw=options.wkRawList[i],dotEl=se('<span class="wk_dots__dot" onclick="WkView.openRaw(event, \''+iRaw+"')\"></span>");options.wkRaw==iRaw&&addClass(dotEl,"wk_dots__dot_active"),wkcur.wkDots.appendChild(dotEl)}if(wkcur.commonClass?addClass(wkcur.wkBox,wkcur.commonClass):wkcur.wkBox.className="",wkcur.noCloseIcon&&hide(wkcur.wkRight),wkcur.oid&&wkcur.pid&&(WkView.initSTL(),options.edit||(addEvent(wkLayerWrap,"scroll",WkView.onScroll),addEvent(window,"resize",WkView.onResize))),options.overflow?addClass(wkcur.wkBox,"wk_overflow_hidden"):removeClass(wkcur.wkBox,"wk_overflow_hidden"),script)try{eval(script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,script)}WkView.updateSize(),removeEvent(document,"keydown",WkView.onKeyDown),addEvent(document,"keydown",WkView.onKeyDown),options.onLoaded&&options.onLoaded(),shortCurrency(),WkView.updateArrows(),wkcur.wkContent.focus(),wkLayerWrap.scrollTop=0,"wall"===options.type?WkView.wallAfterInitPost():options.toScroll?(wkLayerWrap.scrollTop=options.toScroll,wkcur.toScroll=0):wkLayerWrap.scrollTop=0,options.fromlist&&WkView.preloadArrow(1==options.fromlist),getAudioPlayer().updateCurrentPlaying(),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_19__.updateAriaElements)();var postLargeGif=domByClass(wkLayer,"page_gif_large");if(postLargeGif&&Page.showGif(domFC(postLargeGif)),window.LazyLoad&&LazyLoad.scanDelayed(),ev&&domClosest("bookmarks_row_type_product",ev.target)&&options&&options.wkRaw){var productRaw=options.wkRaw.match(/^product(-?\d+)_(\d+)/);statlogsValueEvent("bookmarks_product_analytics",{item_type:"product",item_owner_id:intval(productRaw[1]),item_id:intval(productRaw[2]),time:window.getServerTime()})}return!1},hide:function(e,o,r){if(window.wkcur&&(o||wkcur.shown)){var t=!wkcur.wkRaw.match(/^recom_apps\d+$/)&&!wkcur.wkRaw.match(/^app\d+$/);if("story"===wkcur.type&&!o&&window.Stories&&!e)return Stories.hideLayer();if(clearTimeout(wkcur.autosaveTimeout),clearTimeout(wkcur.showT),!o&&wkcur.edit&&wkcur.editor&&wkcur.editor.changed){if(wkcur.note&&wkcur.toStatus&&!e)return void WkView.saveInfo();var i=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(wkcur.lang.pages_close_title,wkcur.lang.pages_close_text,getLang("box_yes"),(function(){i.hide(),WkView.hide(e,!0)}),getLang("box_no"))}else{if(o||!wkcur.warningBeforeHiding){each(wkcur._hide||[],(function(e,o){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(o)&&o()}));var a=!1;if(isVisible(wkLayerWrap)&&(setTimeout(layerQueue.pop,0),(a=layerQueue.count()&&"wiki"==layerQueue._layers[layerQueue._layers.length-1][0]&&!layerQueue._bl)||(layers.wraphide(wkLayerWrap),layers.fullhide=!1),wkcur.photoViewverHideCB&&layerQueue.count()&&"photo"===layerQueue._layers[layerQueue._layers.length-1][0]&&cur.pvOptions&&(cur.pvOptions.onHide=wkcur.photoViewverHideCB,wkcur.photoViewverHideCB=!1)),window.tooltips&&tooltips.destroy(this),removeEvent(document,"keydown",WkView.onKeyDown),removeClass(wkcur.wkContent,"wke_top_fixed"),wkcur.fixedTop=wkcur.fixedBottom=!1,a||(removeClass(wkLayerWrap,"wk_dark"),removeClass(layerBG,"wk_dark"),wkcur.shown=!1,removeEvent(wkLayerWrap,"click",WkView.onClick),removeEvent(wkLayerWrap,"scroll",WkView.onScroll),wkcur.wkContent.innerHTML=""),wkcur.wkClicked=!1,wkcur.hideTitle=!1,wkcur.changeCanvasSize=!1,wkcur.onHide&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_20__.isFunction)(wkcur.onHide)&&wkcur.onHide(),cur._editMode=!1,wkcur.root&&!0!==e?WkView.backLocation():wkcur.noLocChange||!0===e?t&&__adsUpdate():(2===e?nav.setLoc(hab.getLoc()):WkView.backLocation(),t&&__adsUpdate("lazy")),browser.iphone||browser.ipad){var w=scrollGetY();Math.abs(w-cur.wkStartScroll)>500&&scrollToY(cur.wkStartScroll,0)}return delete wkcur.historyLen,getAudioPlayer().updateCurrentPlaying(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),window._mediator&&window._mediator.isActive()&&window._mediator.stop(),!1}var l=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(wkcur.warningBeforeHiding.confirm_box_title,wkcur.warningBeforeHiding.confirm_box_content,wkcur.warningBeforeHiding.confirm_box_ack,(function(){l.hide(),WkView.hide(e,!0)}),wkcur.warningBeforeHiding.confirm_box_cancel)}}},cmp:function(e,o){var r=e.length,t=o.length;return r<t?-1:r>t?1:e<o?-1:e>o?1:0},onClick:function(e){if(wkcur.wkClicked||wkcur.noClickHide||e&&cur.__mdEvent&&e.target!=cur.__mdEvent.target)wkcur.wkClicked=!1;else{var o=Math.abs(e.pageX-intval(wkcur.oldX)),r=Math.abs(e.pageY-intval(wkcur.oldY));(o>3||r>3)&&Date.now()-intval(wkcur.oldT)>300&&WkView.hide()}},onKeyDown:function(e){if(!1===(e=e||window.event).returnValue)return!1;if(!cur.pvShown&&e.keyCode===KEY.ESC)return WkView.hide(),cancelEvent(e);if(!(cur.pvShown||wkcur.edit||window.cur.storyLayer||e.keyCode!==KEY.LEFT&&e.keyCode!==KEY.RIGHT)){var o=e&&e.target||e.srcElement;return!(!o||!("TEXTAREA"===o.tagName||"INPUT"===o.tagName||"DIV"===o.tagName&&o.contentEditable&&"inherit"!=o.contentEditable))||(WkView.navigate(null,e,e.keyCode===KEY.RIGHT?1:-1),cancelEvent(e))}if(WkView.canEdit){if(83===e.keyCode&&(e.ctrlKey||e.metaKey&&browser.mac))return WkView.saveInfo(),cancelEvent(e);if((10===e.keyCode||13===e.keyCode&&(e.ctrlKey||e.metaKey&&browser.mac))&&WkView.saveInfo(),cur.updTimeout)return;cur.updTimeout=setTimeout((function(){WkView.onResize(),cur.updTimeout=!1}),200)}},onResize:function(){var e=lastWindowWidth,o=lastWindowHeight,r=e-(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.sbWidth)()-2-120-34-50,t=o-31-28-72;r>1280?r=1280:r>807&&r<907?r=807:r<604&&(r=604),t<453&&(t=453),wkcur.mvWidth=r,wkcur.mvHeight=t,wkcur.mvVeryBig=r>1280?2:r>807&&1,WkView.onScroll(!1,!0),WkView.updateHeight(),WkView.updateArrows(),setTimeout(WkView.updateArrows,0)},updateArrows:function(){var e=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.sbWidth)()+2;wkcur.wkLeft&&(wkcur.wkLeft.style.left="20px");var o=getSize(wkcur.wkBox),r=o[0],t=o[1],i=getSize(wkcur.wkLeftArrowBg)[0],a=i-10,w=getSize(wkcur.wkLeftArrow)[0]||getSize(wkcur.wkRightArrow)[0];wkcur.wkLeftNav.style.width=Math.floor((lastWindowWidth-e-r)/2)+"px",wkcur.wkRightNav.style.left=Math.floor((lastWindowWidth-e+r)/2)+"px",wkcur.wkRightNav.style.width=Math.floor((lastWindowWidth-e-r)/2)+"px",wkcur.wkClose&&(wkcur.wkClose.style.left=lastWindowWidth-e-37+"px"),wkcur.wkRight.style.left=Math.floor((lastWindowWidth-e+r)/2)+"px";var l=WkView.getNextWkRaws(),s="intro"==wkcur.wkRaw;if(l[0]||l[1]||s){var n=browser.mobile?window.innerHeight:lastWindowHeight,_=(wkcur.wkCont.offsetHeight<n?wkcur.wkCont.offsetTop+10+t/2:n/2)-8;l[0]||s&&wkcur.introControlsCur?(show(wkcur.wkLeftArrow),show(wkcur.wkLeftArrowBg),setStyle(wkcur.wkLeftArrowBg,{left:(lastWindowWidth-e-r)/2-i}),setStyle(wkcur.wkLeftArrow,{left:(lastWindowWidth-e-r)/2-a+(a-w)/2,top:_})):hide(wkcur.wkLeftArrow,wkcur.wkLeftArrowBg),setStyle(wkcur.wkRight,{paddingBottom:(_-getXY(wkcur.wkRight,!0)[1]-24)/2}),l[1]||s&&wkcur.introControls&&wkcur.introControlsCur<wkcur.introControls.length-1?(show(wkcur.wkRightArrow),show(wkcur.wkRightArrowBg),setStyle(wkcur.wkRightArrowBg,{left:(lastWindowWidth-e-r)/2+r}),setStyle(wkcur.wkRightArrow,{left:(lastWindowWidth-e-r)/2+r+(a-w)/2,top:_})):hide(wkcur.wkRightArrow,wkcur.wkRightArrowBg)}else hide(wkcur.wkLeftArrow,wkcur.wkLeftArrowBg,wkcur.wkRightArrow,wkcur.wkRightArrowBg)},getNextWkRaws:function(){var e=!1,o=!1;if(isArray(wkcur.wkRawList)&&wkcur.historyLen<=1&&!wkcur.wkRawLoading){var r=wkcur.wkRawList.length,t=indexOf(wkcur.wkRawList,wkcur.wkRaw);t>0&&(e=wkcur.wkRawList[t-1]),t>=0&&t<r-1&&(o=wkcur.wkRawList[t+1]),wkcur.wkRawListLoop&&r>1&&(e=e||wkcur.wkRawList[r-1],o=o||wkcur.wkRawList[0])}return[e,o]},recacheRaw:function(e){return!!(cur.wkviewNavRecache&&e&&cur.wkviewNavRecache[e])&&(delete cur.wkviewNavRecache[e],!0)},openRaw:function(e,o){cancelEvent(e),showWiki(extend({from:wkcur.from},{w:o}),!1,!1,{fromlist:1,noloader:!0,preload:{cache:wkcur.navNoCache||WkView.recacheRaw(o)?0:1}})},navigate:function(e,o,r){if("intro"===wkcur.wkRaw)return WkView.introNext(r),cancelEvent(o),!1;var t=WkView.getNextWkRaws(),i={};wkcur.from&&(i.from=wkcur.from),r>0&&t[1]&&(wkcur.wkRawLoading=!0,addClass(wkcur.wkRightArrow,"wk_arrow_progress"),showProgress(wkcur.wkRightArrow),wkcur.onNavigate&&wkcur.onNavigate(t[1],r,e),showWiki(extend(i,{w:t[1]}),!1,!1,{fromlist:1,noloader:!0,preload:{cache:wkcur.navNoCache||WkView.recacheRaw(t[1])?0:1}}),cancelEvent(o)),r<0&&t[0]&&(wkcur.wkRawLoading=!0,addClass(wkcur.wkLeftArrow,"wk_arrow_progress"),hideProgress(wkcur.wkRightArrow),wkcur.onNavigate&&wkcur.onNavigate(t[0],r,e),showWiki(extend(i,{w:t[0]}),!1,!1,{fromlist:-1,noloader:!0,preload:{cache:wkcur.navNoCache||WkView.recacheRaw(t[0])?0:1}}),cancelEvent(o))},updateHeight:function(){window.updateWndVScroll&&updateWndVScroll();var e=browser.mobile?window.innerHeight:lastWindowHeight,o=Math.max(wkcur.wkCont.offsetHeight,e);wkcur.wkLeftNav.style.height=wkcur.wkRightNav.style.height=o+"px";var r=wkcur.wkBox.offsetHeight;setStyle(wkcur.wkLeftArrowBg.firstChild,{height:r}),setStyle(wkcur.wkRightArrowBg.firstChild,{height:r})},updateSize:function(e){if(wkcur.wkCont){var o=getSize(wkcur.wkCont),r=document.documentElement,t=window.innerHeight||r.clientHeight||bodyNode.clientHeight,i=Math.max(positive((t-o[1]-5)/2),14),a=i+10,w=wkLayer.offsetHeight-o[1]+i+90;wkcur.wkCont.style.top=i+"px",wkcur.wkRight.style.top=Math.max(a-wkLayerWrap.scrollTop,16)+"px",wkcur.wkLeftArrowBg.style.paddingTop=wkcur.wkRightArrowBg.style.paddingTop=a+"px",wkcur.wkLeftArrowBg.style.paddingBottom=wkcur.wkRightArrowBg.style.paddingBottom=w+"px",e||(onBodyResize(),WkView.onResize())}},setLocation:function(e,o){for(var r in wkcur.prevLoc={},nav.objLoc)("w"!=r||nav.objLoc[r]!=wkcur.wkRaw&&o)&&(wkcur.prevLoc[r]=nav.objLoc[r]);if(!e){var t=extend(nav.objLoc,{w:wkcur.wkRaw});delete t.order,delete t.z,nav.strLoc!=nav.toStr(t)&&nav.setLoc(t)}},backLocation:function(){var e=hab.getLoc();if(wkcur.prevLoc&&wkcur.prevLoc!=e)nav.setLoc(wkcur.prevLoc);else{var o=e.split("/");o.length>1&&nav.setLoc(o[0])}layerQueue.noHistory()},showError:function(e){window.wkcur&&(delete wkcur.wkRawLoading,addClass(wkcur.wkRightArrow,"wk_arrow_progress"),addClass(wkcur.wkLeftArrow,"wk_arrow_progress"));var o=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)({title:getLang("global_error")},e,getLang("global_close"));return setTimeout(o.hide,2e3),!0},onChange:function(){if(!wkcur.shown)return!1;clearTimeout(wkcur.autosaveTimeout),wkcur.autosaveTimeout=setTimeout((function(){wkcur.note&&wkcur.toStatus&&WkView.saveInfo(!0)}),4e3)},likeOver:function(e){var o=getSize(ge("wk_like_link")),r=o?o[0]:20;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_18__.showTooltip)(e,{url:"like.php",params:{act:"a_get_stats",object:wkcur.like_obj||wkcur.wkRaw,from:"wkview"},slide:15,shift:[0,8,9],ajaxdt:100,showdt:400,hidedt:200,typeClass:"like_tt",className:"wk_like_tt",dir:"auto",init:function(e){if(e.container){var o=geByClass1("bottom_pointer",e.container,"div"),t=geByClass1("top_pointer",e.container,"div");setStyle(o,{marginLeft:r+2}),setStyle(t,{marginLeft:r+2})}}})},like:function(){if(vk.id)if(cur.viewAsBox)cur.viewAsBox();else{var e=!wkcur.liked;ajax.post("like.php",{act:"a_do_"+(e?"":"un")+"like",object:wkcur.like_obj||wkcur.wkRaw,hash:wkcur.likehash,from:"wkview"},{onDone:function(o,r){return WkView.likeUpdate(e,o,r)}}),WkView.likeUpdate(e,wkcur.likes+(e?1:-1))}},likeShare:function(e){var o,r,t=wkcur.like_obj||wkcur.wkRaw,i=ge("like_share_"+t),a=isChecked(i);if(checkbox(i),ajax.post("like.php",{act:"a_do_"+(a?"un":"")+"publish",object:t,hash:e},{onDone:WkView.likeUpdate.pbind(!0)}),ge("wk_like_link"))o=val("wk_like_count"),r=hasClass(ge("wk_like_icon"),"my_like");else{var w=ge("like_real_count_"+t);o=w?w.value:val("like_count"+t),r=hasClass(ge("like_icon"+t),"my_like")}WkView.likeUpdate(!0,intval(o)+(r?0:1))},likeShareCustom:function(){vk.id&&showBox("like.php",{act:"publish_box",object:wkcur.like_obj||wkcur.wkRaw,list:"",from:"wkview"})},likeUpdate:function(e,o,r){o=intval(o);var t=ge("wk_like_wrap"),i=domByClass(t,"_count");if(i){var a=t.tt||{},w=clone(a.opts||{}),l=domByClass(a.container,"_value"),s=domByClass(a.container,"_content"),n=domByClass(a.container,"_title");r&&n&&val(n,r),a&&(a.likeInvalidated=!0),l&&(l.value=o),wkcur.likes=o,(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_21__.animateCount)(i,o),wkcur.liked=e,toggleClass(t,"my_like",e),toggleClass(t,"no_likes",!o),toggleClass(s,"me_hidden",!e),a.el&&(o?!1===r?a.destroy&&a.destroy():isVisible(a.container)||r||tooltips.show(a.el,extend(w,{showdt:0})):a.hide())}},showLikesPage:function(e,o,r){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:e,published:o,offset:r,wall:1},o)},extPageSubscribe:function(e,o,r,t,i,a){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.isButtonLocked)(e)){cur.wkSubscribed=cur.wkSubscribed||{};var w="_subscribed",l=hasClass(e,"post_header_subscribe_button_secondary"),s=hasClass(e,w),n={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockButton.pbind(e),onDone:function(){cur.wkSubscribed[o]=!s,toggleClass(e,w,cur.wkSubscribed[o]),l||toggleClass(e,"secondary",cur.wkSubscribed[o]),t&&s&&hide(e)}};if(i=i||"",o>0)ajax.post("al_friends.php",{act:s?"remove":"add",mid:o,hash:r,from:"wkview_extpage"},n);else{var _=ajax.post.pbind("al_groups.php",{act:s?"a_leave":"a_enter",gid:-o,hash:r,from:"wkview_extpage",t_src:i,ad_data:a||""},n);if(t&&s)var c=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(t.title,t.text,t.btn,(function(){c.hide(),_()}),getLang("global_cancel"));else _()}}},wallBeforeInitPost:function(e){if(window.tooltips&&tooltips.destroyAll(),revertLastInlineVideo(),wkcur.postInited)return!1;wkcur.pageReplaced=[];for(var o,r,t=wkcur.post;!(o=ge("post"+t))&&cur.onepost&&t===cur.oid+"_"+cur.pid&&(o=ge("fw_post")),o=o||ge("reply_fakebox"+t)||ge("reply_box"+t)||ge("replies"+t)||ge("feedback_row_wall"+t)||wkcur.hl_reply&&(ge("post"+wkcur.hl_reply)||ge("feedback_row_wall_reply"+wkcur.hl_reply));)r=ce("div",{className:"wk_wall_post_placeholder",id:"wk_wall_post_placeholder_"+o.id}),o.parentNode.replaceChild(r,o),wkcur.pageReplaced.push([o,r]);cur.wallLayer=t,cur.wallLayerLike=wkcur.post_like,e.options.wall_tpl&&(extend(window.lang,e.lang,e.options.wall_tpl.lang),extend(wkcur,{wallCheckComments:e.options.check_comments,wallType:e.options.wall_type,wallTpl:e.options.wall_tpl,wallMyDeleted:{},tsDiff:e.options.wall_tpl&&e.options.wall_tpl.abs_timestamp?900*Math.round((vkNow()/1e3-e.options.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMyRepliesCnt:0,wallUploadOpts:e.options.upload}),Wall.initUpdates(wkcur.options.add_queues,!0),wkcur.timeUpdateInt=setInterval((function(){Wall.updateTimes(wkcur.wkContent)}),1e4)),wkcur._hide.push(WkView.wallDeinitPost),wkcur.postInited=!0},wallAfterInitPost:function(){var e=wkcur.post,o=ge("reply_field"+e);cur.wkSubscribed&&void 0!==cur.wkSubscribed[intval(e)]&&toggleClass(geByClass1("_wk_subscribe_btn",wkcur.wkBox),"secondary",cur.wkSubscribed[intval(e)]),delete cur.editing,o&&placeholderInit(o,{editable:1}),WkView.wallUpdateReplies(),wkcur.hl_reply?setTimeout(Wall.scrollHighlightReply.pbind("post"+wkcur.hl_reply),0):setTimeout((function(){wkLayerWrap.scrollTop=wkcur.toScroll||0,wkcur.toScroll=0}),0)},wallDeinitPost:function(){if(!wkcur.postInited)return!1;cur.wallLayer=!1,cur.wallLayerLike=!1,wkcur.edit&&Wall.cancelEdit(),each(wkcur.pageReplaced,(function(){var e=this[0],o=this[1];e&&o&&o.parentNode.replaceChild(e,o)})),clearInterval(wkcur.timeUpdateInt),revertLastInlineVideo(),window.tooltips&&tooltips.destroyAll(),delete cur.editing,delete wkcur.postInited},wallOnEdit:function(e,o){wkcur.edit=!0,wkcur.editor={changed:!0}},wallOnEdited:function(e){wkcur.edit=!1},wallPostShowDeletedMessage:function(e,o){var r=ge("wl_post");if(r&&domData(r,"post-id")===e){cur.pgPaused=!0,hide("wl_replies_wrap","wl_post_actions_wrap","wl_reply_form_wrap");var t=domNS(r);return t&&hasClass(t,"no_rows")?val(t,o):(t=ce("div",{id:"post_del"+e,innerHTML:o,className:"no_rows"}),domPN(r).insertBefore(t,domNS(r)),hide(r)),cur.wkviewNavRecache||(cur.wkviewNavRecache={}),cur.wkviewNavRecache[wkcur.wkRaw]=1,wkLayerWrap.scrollTop=0,WkView.updateSize(),!0}return!1},wallPostHideDeletedMessage:function(e){var o=ge("wl_post");if(o&&domData(o,"post-id")===e){cur.pgPaused=!1,show("wl_replies_wrap","wl_post_actions_wrap","wl_reply_form_wrap");var r=domNS(o);return r&&hasClass(r,"no_rows")&&re(r),show(o),cur.wkviewNavRecache||(cur.wkviewNavRecache={}),cur.wkviewNavRecache[wkcur.wkRaw]=1,wkLayerWrap.scrollTop=0,WkView.updateSize(),!0}return!1},wallPostSetArchiveState:function(e,o,r,t,i){if(!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.actionsMenuItemLocked)(e)&&!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.linkLocked)(e)){var a=intval(o.split("_")[1]),w=hasClass(e,"ui_actions_menu_item");ajax.post("al_wall_archive.php",{act:"a_set_state",from:"wkview",hash:r,state:t?1:0,postId:a},{onDone:function(e){i?WkView.wallPostHideDeletedMessage(o):WkView.wallPostShowDeletedMessage(o,e)},showProgress:w?_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockActionsMenuItem.pbind(e):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockLink)(e),hideProgress:w?_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockActionsMenuItem.pbind(e):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockLink)(e)})}},wallPostDelete:function wallPostDelete(act,hash,force){var post=wkcur.post;if("spam"!==act)cur.wallMyDeleted&&(cur.wallMyDeleted[post]=1),ajax.post("al_wall.php",{act,post,hash,confirm:force?1:0,from:"wkview"},{onDone:function onDone(msg,additional,needConfirm){if(needConfirm)var box=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.showFastBox)(msg,needConfirm,getLang("global_delete"),(function(){box.hide(),WkView.wallPostDelete(act,hash,1)}),getLang("box_cancel"));else{var p=ge("wl_post");if(p){cur.pgPaused=!0,hide("wl_replies_wrap","wl_post_actions_wrap","wl_reply_form_wrap");var del=domNS(p);if(del&&hasClass(del,"no_rows")?val(del,msg):(domPN(p).insertBefore(ce("div",{id:"post_del"+post,innerHTML:msg,className:"no_rows"}),domNS(p)),hide(p)),wkLayerWrap.scrollTop=0,"spam"===act)try{eval(additional)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.logEvalError)(e,additional)}WkView.updateSize()}}},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockButton.pbind("wpe_delete"+post),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockButton.pbind("wpe_delete"+post)});else{var _post$split=post.split("_"),_post$split2=_slicedToArray(_post$split,2),photoOwnerId=_post$split2[0],photoId=_post$split2[1],onSubmit=()=>{var e=document.querySelector(".wl_post .wkview_mark_as_spam");null!==e?(e.onclick=null,e.innerHTML=getLang("global_report_sent")):debugLog("Unable to find report button")};(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_22__.showReportForm)("wall",photoOwnerId,photoId,onSubmit)}},wallPostRestore:function(e){var o=wkcur.post;return cur.wallMyDeleted&&(cur.wallMyDeleted[o]=0),ajax.post("al_wall.php",{act:"restore",post:o,hash:e,from:"wkview"},{onDone:function(){var e=ge("wl_post");if(e&&!isVisible(e)){cur.pgPaused=!1,show("wl_replies_wrap","wl_post_actions_wrap","wl_reply_form_wrap");var o=domNS(e);show(e),o&&hasClass(o,"no_rows")&&re(o),WkView.updateSize()}}}),!1},wallUpdateRepliesOnScroll:function(e){if(wkcur.postInited){var o=window.innerHeight||document.documentElement.clientHeight,r=ge("wl_replies_more");if(!r){var t=ge("replies"+cur.wallLayer),i=domLC(t);i&&hasClass(i,"replies_next")&&isVisible(i)&&(r=i)}if(r&&isVisible(r))o+500>getXY(r,!0)[1]&&r.onclick();var a=ge("wl_reply_form");if(a&&!hasClass(a,"wl_post_reply_form_forbidden")){var w=ge("wl_reply_form_wrap"),l=getXY(w,!0)[1],s=getSize(a),n=s[1];if(e&&!1===wkcur.fixedBottom&&o-n<l+20)wkLayerWrap.scrollTop+=l+20-(o-n);else if(isVisible(w)&&o-n<l){wkcur.fixedBottom&&!e||(wkcur.fixedBottom=!0,addClass(a,"wl_reply_form_fixed"));var _=wkcur.fixedBottom?Math.min(0,Math.max(-wkLayerWrap.scrollLeft,bodyNode.clientWidth-getSize(ge("page_layout"))[0])):null,c=Math.min(0,o-getXY("wl_replies_wrap",!0)[1]-n);setStyle("wl_reply_form_wrap",{width:s[0],height:s[1],bottom:c,marginLeft:_}),setStyle(a,{bottom:c})}else(wkcur.fixedBottom||e)&&(wkcur.fixedBottom=!1,removeClass(a,"wl_reply_form_fixed"),setStyle("wl_reply_form_wrap",{width:null,height:null,marginLeft:null}))}}},wallShowMoreReplies:function(){if(wkcur.loadingReplies)return!1;var e=wkcur.offset+wkcur.loaded,o=wkcur.limit,r=ge("replies"+wkcur.post);return wkcur.count<=e||!r||(wkcur.loadingReplies=!0,Wall.moreReplies(wkcur.post,(wkcur.reverse?-1:1)*e,o,{from:"wkview",append:!0,rev:wkcur.reverse?1:0,onDone:function(e,o,r){extend(wkcur,{count:r.count,loaded:wkcur.loaded+r.num}),WkView.wallUpdateReplies(),wkcur.loadingReplies=!1},onFail:function(){wkcur.loadingReplies=!1},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockButton.pbind("wl_replies_more"),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockButton.pbind("wl_replies_more")})),!1},wallShowPreviousReplies:function(e){if(wkcur.loadingReplies||wkcur.reverse)return!1;var o=Math.max(0,wkcur.offset-100),r=Math.min(100,wkcur.offset-o),t=ge("replies"+wkcur.post);if(r<=0||!t)return!1;wkcur.loadingReplies=!0;var i=t.offsetHeight;Wall.moreReplies(wkcur.post,o,r,{from:"wkview",onDone:function(o,r,a){extend(wkcur,{count:a.count,offset:a.offset,loaded:wkcur.loaded+a.num}),e&&(wkLayerWrap.scrollTop+=t.offsetHeight-i,setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)),WkView.wallUpdateReplies(),wkcur.loadingReplies=!1},onFail:function(){wkcur.loadingReplies=!1},showProgress:addClass.pbind("wl_replies_header_wrap","wl_replies_header_loading"),hideProgress:removeClass.pbind("wl_replies_header_wrap","wl_replies_header_loading")}),StickersAnimation&&StickersAnimation.reloadStickers()},wallUpdateReplies:function(){toggle("wl_replies_more",wkcur.offset+wkcur.loaded<wkcur.count);var e=ge("wl_replies_header"),o=langNumeric(wkcur.count,wkcur.lang.wall_N_replies),r=!1;!wkcur.reverse&&wkcur.offset>0&&(o=wkcur.offset>100?langNumeric(100,wkcur.lang.wall_show_n_of_m_last).replace("{count}",wkcur.count):langNumeric(wkcur.count,wkcur.lang.wall_show_all_n_replies),r=!0),val("wl_replies_header_label",o),toggleClass(e,"wl_replies_header_clickable",r);var t=ge("wl_replies_wrap"),i=ge("wl_reply_form");if(t&&(wkcur.count&&!isVisible(t.firstChild)&&show(t.firstChild),toggleClass(t,"wl_replies_empty",!wkcur.count)),i){var a=ge("wl_reply_form_wrap");i.parentNode!=a&&a.appendChild(i)}WkView.wallUpdateRepliesOnScroll(),WkView.updateSize()},wallCancelEditReply:function(){var e=wkcur.post,o=ge("reply_field"+e),r=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_15__.data)(o,"composer");r?Composer.reset(r):val(o,""),Wall.hideEditReply(e),WkView.wallUpdateReplies()},wallInverseReplies:function(e){if(wkcur.loadingReplies)return!1;wkcur.loadingReplies=!0,wkcur.reverse=!wkcur.reverse,wkcur.offset=0,Wall.moreReplies(wkcur.post,wkcur.offset,wkcur.limit,{from:"wkview",clear:!0,rev:wkcur.reverse?1:0,onDone:function(o,r,t){domFC(e).className=wkcur.reverse?"sort_rev_icon":"sort_not_rev_icon",extend(wkcur,{count:t.count,loaded:t.num}),WkView.wallUpdateReplies(),wkcur.loadingReplies=!1},onFail:function(){wkcur.reverse=!wkcur.reverse,wkcur.loadingReplies=!1},showProgress:addClass.pbind("wl_replies_header_wrap","wl_replies_header_loading"),hideProgress:removeClass.pbind("wl_replies_header_wrap","wl_replies_header_loading")})},likesInit:function(){(extend(wkcur,{historyLen:wkcur.historyLen||0}),WkView.initSTL(),WkView.likesTabInit(),likesTabsInvalidate(wkcur.like_obj),addEvent(wkLayerWrap,"scroll",WkView.onScroll),addEvent(window,"resize",WkView.onResize),onBodyResize(),cur.wallTpl=cur.wallTpl||{},cur.wallInited)?hasClass(ge("wl_post"),"deep_active")&&wkcur.wall_opts.wall_tpl.reply_form_new?(wkcur._oldReplyFormNew=cur.wallTpl.reply_form_new,cur.wallTpl.reply_form_new=wkcur.wall_opts.wall_tpl.reply_form_new):(wkcur._oldReplyForm=cur.wallTpl.reply_form,cur.wallTpl.reply_form=wkcur.wall_opts.wall_tpl.reply_form):Wall.initWallOptions(wkcur.wall_opts);void 0===cur.options?cur.options={reply_names:{}}:void 0===cur.options.reply_names&&(cur.options.reply_names={}),extend(cur.options.reply_names,wkcur.reply_names),wkcur._hide.push((function(){removeEvent(wkLayerWrap,"scroll",WkView.onScroll),removeEvent(window,"resize",WkView.onResize),wkcur._oldReplyForm&&(cur.wallTpl.reply_form=wkcur._oldReplyForm,wkcur._oldReplyForm=!1),wkcur._oldReplyFormNew&&(cur.wallTpl.reply_form_new=wkcur._oldReplyFormNew,wkcur._oldReplyFormNew=!1)}))},likesTabInit:function(){wkcur.preload&&ajax.preload("wkview.php",{act:"show",w:wkcur.wkRaw,offset:wkcur.offset},wkcur.preload)},likesToTop:function(){var e=ge("tb_tabs_wrap"),o=getXY(e,!0)[1];wkcur.lSTL&&wkcur.lSTL.el==ge("wk_box")&&(wkcur.lSTLWas=0),o<0&&(wkLayerWrap.scrollTop+=o+1),WkView.likesOnScroll(),wkcur.lSTL&&WkView.stlOnScroll()},likesTab:function(e){var o=ge("likes_tab_"+e),r=o&&domFC(o),t=gpeByClass("ui_tabs",r);if(!r||geByClass1("ui_tab_sel",t)==r)return!1;uiTabs.switchTab(r);var i=gpeByClass("wk_wiki_content",t);ajax.post("wkview.php",{act:"show",w:e+"/"+wkcur.like_obj,part:1},{cache:1,showProgress:addClass.pbind(i,"box_loading"),hideProgress:removeClass.pbind(i,"box_loading"),onDone:function(e,o){val("wk_likes_content",e),extend(wkcur,o),WkView.likesTabInit(),WkView.setLocation(),WkView.updateHeight(),WkView.likesToTop()}})},likesPreload:function(){ajax.post("wkview.php",{act:"show",w:wkcur.wkRaw,offset:wkcur.offset},{cache:1})},likesMore:function(){var e=ge("wk_likes_more_link");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.isButtonLocked)(e)||ajax.post("wkview.php",{act:"show",w:wkcur.wkRaw,offset:wkcur.offset},{onDone:function(o,r,t,i,a){var w=ge("wk_likes_rows");if(w){if(a)for(var l=geByClass("wk_likes_hidden",w),s=0,n=l.length;s<n;++s)w.appendChild(l[s]),removeClass(l[s],"wk_likes_hidden");w.appendChild(cf(o)),wkcur.offset=r,t?WkView.likesPreload():hide(e),WkView.updateHeight(),i&&extend(cur.options.reply_names,i)}},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockButton.pbind(e),cache:1})},likesOnScroll:function(e){var o=lastWindowHeight,r=ge("wk_likes_more_link"),t=ge("tb_tabs"),i=ge("tb_tabs_wrap");getXY(i,!0)[1]<0?wkcur.tbFixed||(setStyle(i,"height",domFC(t).offsetHeight),setStyle(domFC(t),"width",intval(getStyle(domFC(t),"width"))),addClass(t,"ui_tabs_fixed"),wkcur.tbFixed=!0):wkcur.tbFixed&&(removeClass(t,"ui_tabs_fixed"),wkcur.tbFixed=!1),isVisible(r)&&o>getXY(r,!0)[1]&&r.click()},likesBlacklistTip:function(e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_18__.showTooltip)(e,{text:getLang("like_block_liker"),shift:[8,5,5],black:1})},likesBlacklist:function(e,o,r){return e.tt&&e.tt.destroy&&e.tt.destroy(),showBox("like.php",{act:"spam",mid:o,object:wkcur.like_obj}),cancelEvent(r)},likesRecache:function(e){for(var o in wkcur.offset+=e,ajaxCache)o.match(new RegExp("^\\/wkview.php\\#act=show",""))&&delete ajaxCache[o]},likesRemove:function(e){re("fans_fan_row"+e),WkView.likesRecache(-1),WkView.onScroll(),domFC(ge("wk_likes_rows"))||nav.reload()},historyInit:function(){addEvent(wkLayerWrap,"scroll",WkView.onScroll),addEvent(window,"resize",WkView.onResize),onBodyResize(),wkcur._hide.push((function(){removeEvent(wkLayerWrap,"scroll",WkView.onScroll),removeEvent(window,"resize",WkView.onResize)}))},historyOnScroll:function(){if(wkcur.loadingHistory)return!1;var e=window.innerHeight||document.documentElement.clientHeight,o=ge("wk_history_more_link");o&&isVisible(o)&&(e+500>getXY(o,!0)[1]&&o.onclick())},historyShowMore:function(){if(wkcur.loadingHistory)return!1;var e=wkcur.offset;return wkcur.loadingHistory=!0,ajax.post("wkview.php",{act:"show",w:wkcur.wkRaw,offset:e,part:1},{onDone:function(e,o){if(ge("wk_history_rows")){extend(wkcur,e),ge("wk_history_rows").appendChild(cf(o)),setTimeout(WkView.historyOnScroll,500);var r=wkcur.offset<wkcur.count&&o;toggle("wk_history_more_link",r),toggle("wk_history_empty",!r&&!domFC(ge("wk_history_rows"))),toggleClass("wk_history_more","wk_history_more_loading",r&&!domFC(ge("wk_history_rows"))),wkcur.loadingHistory=!1}},onFail:function(){wkcur.loadingHistory=!1},showProgress:function(){hide("wk_history_more_link"),show("wk_history_more_progress")},hideProgress:function(){show("wk_history_more_link"),hide("wk_history_more_progress")}}),!1},preloadArrow:function(e){var o=wkcur[e?"wkRightArrow":"wkLeftArrow"];if(!o.cached){o.cached=!0;var r=WkView.getNextWkRaws()[e?1:0];if(r){var t={w:r};if(r&&"/query"===r.substr(-6)){var i=clone(nav.objLoc);delete i[0],delete i.w,t.query=JSON.stringify(i)}wkcur.from&&(t.from=wkcur.from),ajax.post("wkview.php",extend({act:"show",loc:nav.objLoc[0],is_preload:!0},t),{cache:1})}}},back:function(){if(wkcur.historyLen>1)return wkcur.doBack=1,wkcur.historyLen-=1,history.go(-1),!0;WkView.hide()},initSTL:function(){re(cur.lSTL),extend(wkcur,{lSTL:wkLayerWrap.appendChild(ce("div",{id:"layer_stl",innerHTML:'<div id="layer_stl_bg" class="fixed"></div><div id="layer_stl_cl"></div><nobr id="layer_stl_text" class="fixed">'+getLang("global_to_top")+"</nobr>",el:ge("wk_box"),onclick:cancelEvent,onmousedown:WkView.stlDown,sc:WkView.stlOnScroll})),lSTLText:ge("layer_stl_text",wkLayerWrap),lSTLShown:0,lSTLWas:0,lSTLWasSet:0}),cur.lSTL=wkcur.lSTL,wkcur._hide.push((function(){re(wkcur.lSTL,cur.lSTL)}))},stlDown:function(e){if(e=e||window.event,!checkEvent(e)){if(!__afterFocus)if(wkcur.lSTLWasSet&&wkcur.lSTLWas){var o=wkcur.lSTLWas;wkcur.lSTLWas=0,wkLayerWrap.scrollTop=o}else wkcur.lSTLWas=wkLayerWrap.scrollTop,wkLayerWrap.scrollTop=0;return cancelEvent(e)}},stlOnScroll:function(e){var o=wkLayerWrap.scrollTop,r=200,t=wkcur.lSTLWas||o>r,i=0;if(wkcur.lSTL.style.marginTop=o+"px",vk.staticheader){var a=getSize("page_header_wrap")[1];wkcur.lSTLText.style.marginTop=Math.max(-Math.min(scrollGetY(),bodyNode.clientHeight-(window.lastWindowHeight||0)),-a)+"px"}if(t?(1!==wkcur.lSTLShown&&(show(wkcur.lSTL),wkcur.lSTLShown=1),wkcur.lSTLWas&&o>500&&(wkcur.lSTLWas=0),o>r?(i=(o-r)/r,wkcur.lSTLWasSet&&(wkcur.lSTLWasSet=0,val(domLC(wkcur.lSTL),getLang("global_to_top")),removeClass(domLC(wkcur.lSTL),"down"))):(i=(r-o)/r,wkcur.lSTLWas&&(wkcur.lSTLWasSet||(wkcur.lSTLWasSet=1,val(domLC(wkcur.lSTL),""),addClass(domLC(wkcur.lSTL),"down"))))):0!==wkcur.lSTLShown&&(hide(wkcur.lSTL),wkcur.lSTLShown=0),wkcur.wkLeft&&wkcur.wkLeftNav){var w=wkcur.historyLen>1&&!t;toggle(wkcur.wkLeft,w),toggle(wkcur.wkLeftNav,w),setStyle(wkcur.wkLeftWrap,{opacity:1-Math.min(Math.max(o/r,0),1)}),w||setStyle(wkcur.wkLeft,{opacity:.4})}setStyle(wkcur.lSTL,{opacity:Math.min(Math.max(i,0),1)})},subscribe:function(e,o){var r=e.tt&&(e.tt.shown||e.tt.showing);r?tooltips.hide(e,{fasthide:1}):e.tt&&e.ttimer&&(clearTimeout(e.ttimer),r=!0),ajax.post("/al_wall.php",{act:"toggle_subscribe",post:wkcur.post,hash:o},{onDone:function(o){WkView.setSubscribed(e,o.subscribed,r)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_16__.unlockButton.pbind(e)})},setSubscribed:function(e,o,r){e.innerHTML=wkcur.lang[o?"wall_unsubscribe_post":"wall_subscribe_post"],toggleClass(e,"wl_post_subscribed",o),r&&WkView.showSubscribeTooltip(e),cur.onWKSubscribe&&(cur.onWKSubscribe(o),delete cur.onWKSubscribe)},showSubscribeTooltip:function(e){var o=hasClass(e,"wl_post_subscribed");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_18__.showTooltip)(e,{dir:"left",asrtl:1,text:function(){return wkcur.lang[o?"wall_unsubscribe_post_tt":"wall_subscribe_post_tt"]},shift:[260,-15],slideX:-10,showdt:200,className:"subscr_post_tt"})},shareApp:function(e,o){if(vk.id){var r={act:"publish_box",object:wkcur.like_obj,url_hash:o,list:"",from:"wkview"};showBox("like.php",r,{onDone:function(){var r=e;o&&(r+="#"+o);var t=cur.sbField&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_15__.data)(cur.sbField,"composer");t&&t.addMedia&&t.addMedia.checkURL(r)}})}},closeComments:function(e,o,r,t){Wall.closeComments(e,o,r,t,(function(e){WkView.onCloseComments(e,o,r),wkcur.pageReplaced&&wkcur.pageReplaced.length&&wkcur.pageReplaced.forEach((function(t){var i=t[0];i.id==="post"+o+"_"+r&&Wall.onCloseComments(e,i)}))}))},onCloseComments:function(e,o,r,t){var i=ge("wl_post"),a=hasClass(i,"Post--with_closed_comments_donut"),w=e?geByClass1("wl_post_reply_form_forbidden"):ge("wl_reply_form");if(t||w||a){var l=e?ge("wl_reply_form"):geByClass1("wl_post_reply_form_forbidden");a||(wkcur.isArchived?(toggleClass(i,"closed_comments",!0),hide(w),hide(l)):(toggleClass(i,"closed_comments",e),show(w),hide(l)));var s=geByClass1("action_closing_comments",i);domData(s,"closed",e),val(s,getLang(e?"wall_open_comments":"wall_closing_comments"))}else ajax.post("wkview.php",{act:"comment_box",owner_id:o,post_id:r},{onDone:function(t){t&&(ge("wl_reply_form_wrap").appendChild(se(t)),!e&&!wkcur.isArchived&&WkView.wallAfterInitPost(),WkView.onCloseComments(e,o,r,!0))}})},_eof:1};function likesTabsInvalidate(e){var o;if(e){var r=_web_lib_ajax_cache__WEBPACK_IMPORTED_MODULE_13__.AjaxCacheClient.makeCacheKey("/wkview.php");null===(o=_web_lib_ajax_cache__WEBPACK_IMPORTED_MODULE_13__.AjaxCacheClient.invalidateFor)||void 0===o||o.call(_web_lib_ajax_cache__WEBPACK_IMPORTED_MODULE_13__.AjaxCacheClient,(o=>{var t;return!(!o.startsWith(r)||!o.includes(e))&&!!(null===(t=(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_12__.fromQueryString)(o.substring(o.indexOf("#")+1)).w)||void 0===t?void 0:t.match(/(likes|shares|friendlikes|reactions_\d)/))}))}}}}]);try{stManager.done("dist/c11737817dc53ef4526f1c7e34a5b883.f3136a09be87b2edd6bb.js")}catch(e){}