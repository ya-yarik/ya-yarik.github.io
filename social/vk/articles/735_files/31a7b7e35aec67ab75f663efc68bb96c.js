(self.webpackChunkvk=self.webpackChunkvk||[]).push([[8102],{432338:(e,t,a)=>{"use strict";a.r(t),a.d(t,{NOSPAM_TEXT_FIELD:()=>l,noSpamPatterns:()=>o.noSpamPatterns,abortPatternMild:()=>o.abortPatternMild,noSpamSuspicious:()=>n.noSpamSuspicious,noSpamTemplates:()=>r.noSpamTemplates,dealSingleSpamer:()=>i.dealSingleSpamer,reportsTime:()=>i.reportsTime,onFiltersChange:()=>i.onFiltersChange,rollbackDocMailSpamer:()=>s.rollbackDocMailSpamer,rollbackDocWallSpamer:()=>s.rollbackDocWallSpamer,rollbackJpgMailSpamer:()=>s.rollbackJpgMailSpamer,rollbackJpgWallSpamer:()=>s.rollbackJpgWallSpamer,rollbackPngMailSpamer:()=>s.rollbackPngMailSpamer,rollbackPngWallSpamer:()=>s.rollbackPngWallSpamer,rollbackDocSpamer:()=>s.rollbackDocSpamer,rollbackPhotoSpamer:()=>s.rollbackPhotoSpamer,rollbackPhotoSpamerFromWall:()=>s.rollbackPhotoSpamerFromWall,rollbackPhotoSpamerFromMail:()=>s.rollbackPhotoSpamerFromMail,rollbackVideoSpamer:()=>s.rollbackVideoSpamer,rollbackVideoSpamerFromWall:()=>s.rollbackVideoSpamerFromWall,rollbackVideoSpamerFromMail:()=>s.rollbackVideoSpamerFromMail,entityDecode:()=>c,selectText:()=>p,removeSelectedText:()=>d,getSelectedText:()=>u,selectValue:()=>_,blockDomain:()=>m,removeFidSearch:()=>h,banFidZero:()=>g,banFidForever:()=>f,isClaimContent:()=>v,getFieldName:()=>b});var o=a(690864),n=a(752988),r=a(320902),i=a(936714),s=a(450020),l="_console_item_field_text";function c(e){return se("<textarea>"+e+"</textarea>").value}function p(e){var t=document,a=t.getElementById(e);if(t.body.createTextRange)(o=t.body.createTextRange()).moveToElementText(a),o.select();else if(window.getSelection){var o,n=window.getSelection();(o=t.createRange()).selectNodeContents(a),n.removeAllRanges(),n.addRange(o)}}function d(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function u(){var e="";return window.getSelection?e=window.getSelection():document.getSelection?e=document.getSelection():document.selection&&(e=document.selection.createRange().text),e}function _(e){var t=ge(e);return t.options[t.selectedIndex].value}function m(e,t,a,o){ajax.post("noSpam.php",{act:"a_block_domain",domain:e,type:t,hash:a,warn_users:isChecked("warn_users")||0,comment:ge("linksban_comment").value,link_ex:o},{onDone:function(a){ge("block_domain_1_"+e).innerHTML="",ge("block_domain_2_"+e).innerHTML="",ge("block_domain_3_"+e).innerHTML="",ge("block_domain_"+t+"_"+e).innerHTML=a}})}function h(e,t){ajax.post("noSpam.php",{act:"a_remove_fid_search",fid:e,hash:t},{onDone:function(t){ge("remove_fid_search_"+e).innerHTML=t}})}function g(e,t){ajax.post("noSpam.php",{act:"a_ban_fid_zero",fid:e,hash:t},{onDone:function(t){ge("ban_fid_zero_"+e).innerHTML=t}})}function f(e,t){ajax.post("noSpam.php",{act:"a_ban_fid_forever",fid:e,hash:t},{onDone:function(t){ge("ban_fid_forever_"+e).innerHTML=t}})}function v(){return window.nav&&window.nav.objLoc&&window.nav.objLoc.claim}function b(e){var t=domClosest(l,e);return!!t&&t.getAttribute("data-field")}},93716:(e,t,a)=>{"use strict";a.d(t,{CONSOLE_CUSTOM_NUM_FIELD:()=>E,getParams:()=>I,setIp:()=>R,setUaHash:()=>A,setConditions:()=>W,setThreshold:()=>U,composeSearchLinkFromParams:()=>V,getNumericField:()=>J,getConditionsHint:()=>q,switchParams:()=>Q,conditionsClear:()=>X,clearAllExceptConditions:()=>Z,optionClear:()=>ee,addPatternPart:()=>ae,mount:()=>ie});a(59357),a(820075),a(991181),a(296253),a(530522),a(21466);var o,n,r,i=a(533246),s=a(936714),l=a(516883),c=a(442699),p=a(535566),d=a(432338),u=a(486353),_=a(667294),m=a(973935),h=a(40897),g=a(198713),f=1576215,v=138305184,b=163176673,k="console_locked",y="_apply_pattern",w="_search_reports",S="debug_pattern",C="_queries_toggle",T="console_show_message",D="nospam_console_custom_num_condition",x="highlighted",E="custom";function B(){return hasClass(l.consoleWrap,k)}function L(){B()||addClass(l.consoleWrap,k),removeClass(l.consoleWrap,T)}function M(){var e=geByClass1(y,l.patternWrap),t=geByClass1(w,l.patternWrap);B()&&removeClass(l.consoleWrap,k),unlockButton(e),unlockButton(t)}function N(e,t){var a=geByClass1("_console_error",l.consoleWrap),o=geByClass("console_item");a.innerHTML="",e||(e="");var n=ce("div");e&&(n.innerHTML=e),n.className=t?"error":"info_msg",e.match(/\/pattern[0-9]+/)&&o&&o.forEach((function(e){e.className="console_item red_item"})),addClass(l.consoleWrap,T),a.appendChild(n),M()}function P(e){o&&clearTimeout(o),o=setTimeout((()=>{domData(l.consoleWrap,"failed",0)}),3e3),domData(l.consoleWrap,"failed",1),console.error(e),N(e,!0)}function H(){var e=ge("queries",l.consoleWrap);return geByClass1(C,l.consoleWrap).innerHTML=isVisible(e)?"Показать запросы":"Скрыть запросы",toggle(e)}function I(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a={},o=function(e){var t="conditions_input"===e.id?domPS(e):domNS(e);return hasClass(t,"option_cleared")},n=function(t){return e&&o(t)};a[`type${t}`]=cur[`uiSpamtype${t}`].val();var r=ge(`pattern_input${t}`);a[`pattern${t}`]=n(r)?F(r):r.value,a[`threshold${t}`]=ge(`threshold_input${t}`).value;var i=ge(`uid_input${t}`);a[`uid${t}`]=n(i)?F(i):i.value;var s=ge(`ip_input${t}`);a[`ip${t}`]=n(s)?F(s):s.value;var l=ge(`uahash_input${t}`);a[`uahash${t}`]=n(l)?F(l):l.value;var c=ge(`time_start_input${t}`);a[`time_start${t}`]=n(c)?F(c):c.value;var p=ge(`time_finish_input${t}`);return a[`time_finish${t}`]=n(p)?F(p):p.value,a[`conditions${t}`]=window[`ConditionsEditor${t}`].getPlainText(),a},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=[];Array.from(geByClass("option_cleared",e)).forEach((function(e){var t=geByTag1("input",domPN(e))||geByTag1("textarea",domPN(e));a.push(t.id)}));var o=[];return a.forEach((e=>{switch(e){case`pattern_input${t}`:o|=cur.hideFieldsBitMasks.substring;break;case`ip_input${t}`:o|=cur.hideFieldsBitMasks.ip;break;case`uahash_input${t}`:o|=cur.hideFieldsBitMasks.uaHash;break;case`uid_input${t}`:o|=cur.hideFieldsBitMasks.uid;break;case`time_finish_input${t}`:o|=cur.hideFieldsBitMasks.timeFinish;break;case`time_start_input${t}`:o|=cur.hideFieldsBitMasks.timeStart;break;case`conditions_input${t}`:o|=cur.hideFieldsBitMasks.conditions}})),o};t.simplify=cur.uiSimplify.val(),t.duration=cur.uiDuration.val(),t.bantype=cur.uiBan.val(),t.search_period=cur.uiSearchPeriod.val();var n=cur.uiSearchPeriod.selectedItems();return n&&n.length>0&&(t.period_in_seconds=3===n[0].length&&1===n[0][2]?1:0),t.comment=ge("comment_input").value,t.all_actions=isChecked("all_actions")||!1,t.notbannedonly=isChecked("not_banned_only")||!1,t.linksonly=isChecked("links_only")||!1,t.wrap_actions=null===ge("wrap_actions")?1:isChecked("wrap_actions"),t.encode_entities=null===ge("encode_entities")?1:isChecked("encode_entities"),t.hidden_fields=o(geByClass1("pattern_part_root")),extend(t,a(e,"")),te()&&(t.hidden_fields2=o(geByClass1("pattern_part_child"),"2"),extend(t,a(e,"2"))),t}function F(e){return domData(e,"restore")}function j(e,t){return domData(e,"restore",t)}function O(){var e=ge("pattern_input"),t=geByClass1(w,l.patternWrap),a=I();if(!e.value)return scrollToTop(0),void notaBene(e);isButtonLocked(t)||(L(),lockButton(t),n&&(tooltips.destroy(n.el),n=!1),a.act="a_console_find_actions",ajax.post("noSpam.php",a,{onDone:(e,t)=>function(e,t){M(),geByClass1("_console",l.consoleWrap).innerHTML=e;var a=geByClass1("_console_numfield_ip1024",l.consoleWrap);if(a&&new InlineDropdown(a,{items:[[256,"/24 - 256"],[1024,"/22 - 1024"],[4096,"/20 - 4096"],[16384,"/18 - 16k"],[65536,"/16 - 65k"],[262144,"/14 - 262k"],[1048576,"/12 - 1kk"]],selected:256,withArrow:!0,keepTitle:!0,autoShow:!0,autoHide:300,onSelect:e=>J("ip"+e)}),(0,u.partConfigEnabled)("nospam_console_react_links_table")){var o=JSON.parse(t.console_links);o&&0!==o.domains&&m.render(_.createElement(g.ConsoleLinks,{linksData:o,banHash:t.links_block_mass_hash}),document.getElementById(h.rootId+"ConsoleLinks"))}}(e,t),onFail:e=>P(e)}))}function $(e,t){"string"==typeof t&&(t=clean(t)),val(e,t),ee(!1,ge(e),"reset")}function R(e){$("ip_input",e)}function A(e){$("uahash_input",e)}function W(e){window.ConditionsEditor.update("append",e)}function U(e){$("threshold_input",e)}function V(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(e=I(!0));var t=Object.keys(e);t.sort();for(var a=[],o=0;o<t.length;o++){var n=t[o],r=e[n];a.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}return"/noSpam?"+a.join("&")}function G(){var e=V(),t=geByClass1("_get_pattern_link");t&&t.tt&&t.tt.destroy(),addClass(t,"progress"),ajax.post("noSpam.php",{act:"get_search_link",link:e},{onDone:function(e){removeClass(t,"progress"),showTooltip(t,{text:e,slide:15,center:1,black:1,nohide:1,hidedt:400,shift:[0,2,0],onShowEnd:()=>{(0,window.selectText)("shorten_link"),setTimeout(t.tthide,3e3)}})},onFail:function(e){removeClass(t,"progress"),topError(e,{dt:5})}})}function z(){var e=geByClass1(S,l.patternWrap);if(!isButtonLocked(e)){var t=extend(I(),{act:"debug_pattern"});L(),ajax.post("noSpam.php",t,{onDone:e=>N(e),onFail:e=>P(e)})}}function J(e,t){var a=isChecked("values_hist"),o=I();o.need_hist=a,o.act="numeric_field",o.field=e,o.custom_condition=t||"",cur.numFieldSel=e,ajax.post("noSpam.php",o,{onDone:function(o,n){var r=clean(t||e);showFastBox({width:a?330:710,title:r,dark:1,containerClass:"nospam_hist_wrap",hideButtons:a},o).evalBox(n)},progress:"console_query_fields_progress"})}function K(e){r=e,geByClass1("_nospam_console_custom_num_condition_patterns").innerHTML=e}function q(e){var t=2===e?cur.uiSpamtype2.val():cur.uiSpamtype.val();return showBox("noSpam.php",{act:"conditions_hint",spamtype:t},{dark:1,containerClass:"nospam_hint_wrap"})}function Y(){var e=I(),t=geByClass1(y,l.patternWrap);e.act="apply_pattern",isButtonLocked(t)||null===document.querySelector(".console_failed_queries")&&(L(),lockButton(t),ajax.post("noSpam.php",e,{onDone:e=>N(e),onFail:e=>P(e)}))}function Q(){var e=["pattern_input","threshold_input","ip_input","uahash_input","time_finish_input","time_start_input","conditions_input"];e.pop();var t=window.ConditionsEditor.getEditorState(),a=window.ConditionsEditor2.getEditorState();window.ConditionsEditor.setEditorState(a),window.ConditionsEditor2.setEditorState(t),e.forEach((e=>{var t=ge(e).value;ge(e).value=ge(e+"2").value,ge(e+"2").value=t}));var o=cur.uiSpamtype.val();cur.uiSpamtype.selectItem(cur.uiSpamtype2.val()),cur.uiSpamtype2.selectItem(o),toggleClass(el,"switched")}function X(){window.ConditionsEditor.handleClearRestore()}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["pattern_input","ip_input","uahash_input","uid_input","time_finish_input","time_start_input"];t.forEach((t=>{ee(document.getElementById(t+e).nextElementSibling,t+e,"soft_clear")}))}function ee(e,t,a){var o=ge(t),n=hasClass(e,"option_cleared");function r(a){var o=val(a);switch(j(a,o),t){case"pattern_input":case"pattern_input2":val(a,"/"),cur.uiSimplify.selectItem(32);break;case"threshold_input":case"threshold_input2":val(a,a.value&&"2"===a.value?"1":"2");break;default:val(a,"")}o&&addClass(e,"option_cleared")}switch(a){case"clear":n?function(){switch(t){case"threshold_input":case"threshold_input2":r(o);break;default:n&&(o.value=F(o))}removeClass(e,"option_cleared"),removeClass(e,x)}():r(o);break;case"reset":!function(){var e=geByClass1("option_clear",o.parentNode);j(o,""),removeClass(e,"option_cleared"),removeClass(e,x)}();break;case"reset_all":geByClass("option_clear").forEach((function(e){j(ge(e.getAttribute("data-option")),""),removeClass(e,"option_cleared"),removeClass(e,x)}));break;case"soft_clear":n||r(o)}}function te(){var e=geByClass1("_pattern_part_child");if(!isVisible(e))return!1;for(var t=geByClass("cloneable_input",e),a=0;a<t.length;a++)if(val(t[a]))return!0;return!1}function ae(){var e=geByClass1("pattern_wrap"),t="pattern_composite";hasClass(e,t)?removeClass(e,t):addClass(e,t)}function oe(){}function ne(e){var t=ge(document.activeElement);if(e.altKey)switch(-1!==[49,50,51,52,53,67,70,81,82,83,87].indexOf(e.keyCode)&&t&&t.blur(),e.keyCode){case 83:(0,l.activeTab)()===l.tabPattern?O():(0,l.activeTab)()===l.tabReports&&(0,s.prepareReport)((0,s.activeReportsType)(),(0,s.activeSubReportsType)());break;case 70:if(-1!==[f,v,b].indexOf(vk.id))return Y();break;case 81:re("pattern_input");break;case 82:re("conditions_regex");break;case 87:re("conditions_simple");break;case 67:X(),cur.conditions.deselectTemplate();break;case 49:cur.uiSearchPeriod.selectItem(1);break;case 50:cur.uiSearchPeriod.selectItem(24);break;case 51:cur.uiSearchPeriod.selectItem(72);break;case 52:cur.uiSearchPeriod.selectItem(240);break;case 53:cur.uiSearchPeriod.selectItem(2160)}}function re(e){if(e){var t=getSelectionText();switch(e){case"pattern_input":$("pattern_input",t),cur.uiSimplify.selectItem("0");break;case"conditions_simple":case"conditions_regex":var a=document.getSelection().baseNode,o=(0,d.getFieldName)(a);if(!o)return;W("conditions_simple"===e?`'${t}' << ${o}`:`@check_regex('${t=t.replace(/[.|+*(){}\[\]^$?]/g,"\\\\$&")}', ${o})`)}(0,d.removeSelectedText)()}}function ie(){var e=window.pageNode,t=window.browser.msie6?e:window,a=geByClass1("_pattern_buttons",l.patternWrap),o=(0,i.createModule)({handlers:(e,o)=>{o(a,"click",w,O),o(a,"click",y,Y),o(a,"click","_get_pattern_link",G),o(a,"click",S,z),o(l.consoleWrap,"click",C,H),o(l.consoleWrap,"click","_console_linkfield_action",(e=>function(e){var t=domData(e.target,"field"),a=showFastBox.pbind({width:710,title:t,dark:1}),o=I();o.act="link_field",o.field=t,ajax.post("noSpam.php",o,{onDone:a,progress:"console_query_fields_progress"})}(e))),o(l.consoleWrap,"click","_console_numfield_action",(e=>{var t=e.target,a=domData(t,"field");a!==E?J(a):function(e){var t="nospam_console_custom_num_condition",a=()=>{var e=ge(D),t=val(e);if(t){var a={act:"a_numeric_field_add_condition",custom_condition:t};ajax.post("noSpam.php",a,{onDone:K.pbind()}),J(E,t)}else notaBene(e)},o={className:"nospam_console_custom_num_condition_wrap",text:getTemplate("nospam_console_custom_num_condition"),forcetodown:1,nohide:1,forceNoHide:1,shift:[10,8],showdt:0,onShowEnd:()=>{elfocus(ge(D))},onShowStart:()=>{val(D,ls.get(t)||"")},init:o=>{n=o;var r=ge(D);addEvent(r,"keypress",(e=>onEnter(a,e))),addEvent(r,"keyup",(()=>ls.set(t,val(r))));var i=geByClass1("_nospam_console_custom_num_condition_close",domPN(r));addEvent(i,"click",(()=>e.tthide()))}};n?(n.show(),a()):showTooltip(e,o),r&&K(r)}(t)})),o(t,"click","_nospam_console_custom_num_condition_pattern",(e=>{var t=e.target,a=(0,c.unclean)(domData(t,"pattern"));val(D,a)})),o(t,"click","_nospam_console_custom_num_condition_clear",(e=>{var t=e.target,a={act:"a_numeric_field_delete_condition",custom_condition:(0,c.unclean)(domData(t,"pattern"))};ajax.post("noSpam.php",a,{onDone:K.pbind()})})),o(l.consoleWrap,"click","console_set_range",(e=>{var t=e.target,a=domData(t,"time");a<0?$("time_finish_input",-a):a>0&&function(e){$("time_start_input",e)}(a)})),o(l.consoleWrap,"click","console_uid",(e=>{e.altKey&&e.ctrlKey&&($("uid_input",e.target.dataset.uid),cancelEvent(e))})),e(t,"scroll",oe),e(document,"keydown",ne),o(l.patternWrap,"click","_option_clear",(e=>{var t=e.target;ee(t,domData(t,"option"),"clear")})),o(l.patternWrap,"click","_conditions_clear",(e=>{domNS(e.target).id.replace("conditions_input","");X()})),o(document,"click","_console_conditions",(e=>{var t=e.target;W(domData(t,"conditions"))})),o(l.consoleWrap,p.EVENT_MOUSEDOWN,"console_story",(e=>{return t=e.target,a=domData(t,"owner_id"),o=domData(t,"story_id"),n=domData(t,"moderator_hash"),cur.noStoriesBack=!0,void window.showStory(`${a}/${a}_${o}/moderator_hash:${n}`);var t,a,o,n})),o(l.consoleWrap,p.EVENT_MOUSEDOWN,"_console_item_field_length",(e=>{var t=(0,d.getFieldName)(e.target);if(t){var a=e.target.dataset.length,o="=";switch(e.target.dataset.mode){case"less":o="<",a=Math.floor(1.3*a);break;case"greater":o=">",a=Math.round(.7*a)}W(`@length(${t}) ${o} ${a}`)}})),o(l.consoleWrap,"click","console_item_exclude_uid",(e=>{addClass(e.target.closest(".console_item"),"console_item_excluded"),W(`uid != ${e.target.dataset.uid}`)})),o(l.consoleWrap,"click","console_item_pattern_from_sample",(e=>{var t={pattern:"/",simplify:"simplify",uid:e.target.dataset.uid,ip:e.target.dataset.ip,ua_hash:e.target.dataset.ua,type:cur.uiSpamtype.val(),bantype:cur.uiBan.val(),duration:cur.uiDuration.val(),search_period:cur.uiSearchPeriod.val()};(0,p.openInNewTab)(V(t))}))}});cur.destroy.push((()=>{(0,i.destroyModule)(o)}))}},811584:(e,t,a)=>{"use strict";var o;function n(){o=(new Date).getTime()}function r(){var e=(new Date).getTime(),t=(e-o)/1e3,a=Array.prototype.slice.call(arguments);a.push(t),debugLog.apply(null,a)}a.d(t,{startDebugTimer:()=>n,debugLogTimer:()=>r})},690864:(e,t,a)=>{"use strict";a.d(t,{abortPatternMild:()=>l,noSpamPatterns:()=>c});var o,n,r,i=a(516883),s={};function l(e){ajax.post("noSpam.php",{act:"a_abort_pattern_mild",pid:e},{onDone:function(){ge("abort_pattern_mild"+e).innerHTML="<span style = 'color: green'>остановлен</span>"},onFail:function(){ge("abort_pattern_mild"+e).innerHTML="<span style = 'color: red'>ошибка</span>"}})}var c={patternTooltip:function(e,t){var a={content:s[t]?s[t].tooltip:"",className:"pattern_tt_wrap",nohideover:0,showsp:150,slide:15,hasover:0,shift:[5,0,0]};return showTooltip(e,a)},updateProcess:function(e){var t=vkNow();"patterns"===(0,i.activeTab)()&&-1!=window._wf&&((t-n>5e3||e)&&(ajax.post("noSpam.php",{act:"a_in_process"},{onDone:function(e){var t=ge("in_process");if(t)return e>0?animateCount(t,e):t.innerHTML=e},onFail:function(e){ge("in_process").innerHTML=e||"Неизвестная ошибка (banProcess)"}}),n=t),(t-o>1e4||e)&&(ajax.post("noSpam.php",{act:"a_last_patterns"},{onDone:function(e){var t=geByClass1("in_process_wrap");if(t){show(t);var a=e.table;delete e.table,s=e,ge("patterns").innerHTML=a}},onFail:function(e){var t=geByClass1("in_process_wrap");if(t)return t.innerHTML=e||"Неизвестная ошибка (pProcess)"}}),o=t))},clearTimer:function(){clearInterval(r)},initUpdate:function(){this.updateProcess(!0),r||(r=setInterval(this.updateProcess,1e3),cur.destroy.push(this.clearTimer))}}},936714:(e,t,a)=>{"use strict";a.d(t,{activeReportsType:()=>y,activeSubReportsType:()=>w,prepareReport:()=>S,dealSingleSpamer:()=>L,reportsTime:()=>N,onFiltersChange:()=>F,mount:()=>j,noSpamReports:()=>O});a(530522),a(66108),a(579665),a(95767),a(820075),a(751876),a(991181),a(296253);var o=a(829327),n=a(93716),r=a(516883),i=a(811584),s=a(535566),l=a(533246),c=a(450020);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],o=!0,n=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(e){n=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var u="report_subfilter_active",_="active_filter",m="active_type",h=["botscore","hacked_score","secondary_score"],g={},f={},v=new Date,b=setTimeout(null),k=0;function y(){var e=geByClass1(_,r.reportTabs);return domData(e,"type")}function w(){var e=geByClass1("_reports_subtabs",r.reportTabs),t=geByClass1(_,e);return domData(t,"subtype")}function S(e,t){(0,i.startDebugTimer)();var a=geByClass1("_report_btn_update",r.reportList);if(!isButtonLocked(a)){var o=geByClass1("_reports_"+e+"_wrap",r.reportList);if(o){var n={act:"a_get_reports",encode_entities:1,type:e,sub_type:t,shift:cur.options.shift};"mail"===e&&"mail_group"===t&&(n=extend(n,function(){if("mail"===e||"mail_group"===t){var a=geByClass1("filters");return{hide_groups_with_disabled_messages:isChecked(geByClass1("hide_groups_with_disabled_messages_filter",a)),shift:isObject(cur.hoursShiftSlider)?23*cur.hoursShiftSlider._currValue:0,min_reporters_amount:val(geByClass1("min_reports_amount_filter",a)),sorting:radioval("group_messages_reports_sorting")}}console.log("Unsupported filters used")}())),ajax.post("noSpam.php",n,{onDone:function(t){if((0,i.debugLogTimer)("actions fetch"),g={},0!==t.length){for(var a=0;a<t.length;a++){var n=t[a];n.ui_type=e;var r=C(n.ui_type,a);H(n.ua_hash,n.agent_name),delete n.agent_name,delete n.remix_seed,n.index=a,g[r]=n}o.innerHTML="",T(e,0),t=""}else o.innerHTML=getTemplate("nospam_reports_type_search_empty")},onFail:function(e){(0,i.debugLogTimer)("actions fetched fail"),topError(e),o.innerHTML=getTemplate("nospam_reports_type_search_error")},showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a)}),scrollToTop()}else topError("Can't find wrap for type: "+e)}}function C(e,t){return"report_"+e+"_"+t}function T(e,t,a){(0,i.startDebugTimer)(),a||(a=20);for(var o=geByClass1("_reports_"+e+"_wrap",r.reportList),n=domPN(o),s=geByClass1("_reports_type_show_more",n),l=0,c=0,d=0;l<a;){c=d,d++;var u=C(e,c),_=g[u];if(!(c<t)){if("object"!=typeof _){debugLog("empty reports after "+c,"need to shift "+t);break}if(_.uid&&!0!==_.showed){var m=ce("div",{id:"report_"+e+"_"+c});addClass(m,"clear_fix"),addClass(m,"report");var h=_.uid_base_info;if(_.mem_banned||h){if((0,r.getCustomOption)("reports_hide_processed")&&h)continue;addClass(m,h?"processed":"banned_others")}_.ui_type=e;[E(_),p(x(_),1)[0],B(_,c)].forEach((function(e){m.appendChild(e)})),o.appendChild(m),l++}}}if(0!==l){s?isVisible(s)||show(s):(s=ce("div",{className:"reports_type_show_more _reports_type_show_more"}),n.appendChild(s));var f=parseInt(t)+20;s.innerHTML=getTemplate("nospam_reports_show_more",{need_shift:f}),(0,i.debugLogTimer)("actions to html")}else hide(s)}function D(){var e=getSelectionText();e?cur.uiSimplify.selectItem("0"):(e="/",cur.uiSimplify.selectItem("32")),val("pattern_input",e)}function x(e){var t,a="",o=e.type_name,n=parseInt(e.type),i=ce("div");addClass(i,"report_body report_body_regular"),e.api_id>0&&(a+=e.api_id>0?`<div class="report_api">Приложение ${e.app_name} (${e.api_id}):</div>`:""),e.message&&(a+=getTemplate("nospam_reports_field",{class:"report_message",value:e.message})),e.kludges&&(a+=getTemplate("nospam_reports_field",{class:"reports_kludges",value:e.kludges})),e.attaches&&(a+=getTemplate("nospam_reports_attaches",{attaches:e.attaches}));var s="";switch(n){case 500:case 510:case 545:t="<a href='/wall"+e.owner_id+"_"+e.msg_id+"' target='_blank'> "+o+"</a>";break;case 501:case 550:t="<a href='/wall"+e.owner_id+"_"+e.parent_id+"?reply="+e.msg_id+"' target='_blank'> "+o+"</a>",e.group_id&&e.group_link&&(a+=getTemplate("nospam_reports_group_id",{group_id:e.group_id,group_link:e.group_link}));break;case 100:e.score&&e.score.hasOwnProperty("phone_cheat")&&(s+=getTemplate("nospam_reports_score_block",{label:"phone_cheat",score:e.score.phone_cheat})),e.update_time&&(a+=getTemplate("nospam_reports_tag",{tag_label:e.update_time})),e.uid%2==1&&(i.classList.remove("report_body_regular"),i.classList.add("report_body_odd"));break;case 200:a+=getTemplate("nospam_reports_labeled_value",{label:"receivers_num",value:e.receivers_num}),a+=getTemplate("nospam_reports_labeled_value",{label:"chat_msg_id",value:e.chat_msg_id}),a+=getTemplate("nospam_reports_labeled_value",{label:"chat_title",value:e.chat_title});break;case 300:if(e.group_id&&e.group_link&&(a+=getTemplate("nospam_reports_group_id",{group_id:e.group_id,group_link:e.group_link})),e.admin_id&&e.admin_link){var l=e.admin_id;a+=getTemplate("nospam_reports_admin_id",{admin_id:l,admin_link:e.admin_link})}break;case 160:a+=e.title;break;case 161:a+=e.new_title;break;case 200:e.attaches;-152029297==e.uid&&e.original_user_link&&(a+=getTemplate("nospam_reports_molodec_label",{original_user_link:e.original_user_link}));case 2602:case 2647:t="<a href='/video"+e.owner_id+"_"+e.video_id+"' target='_blank'> "+o+"</a>";break;case 2600:case 2610:case 2611:case 2645:case 2650:t="<a href='/video"+e.owner_id+"_"+e.video_id+"' target='_blank'> "+o+"</a>",a+='<table class="report_video"><tr>',a+='<td style="width: 130px;"><a class="report_video_thumb" href="'+e.video.href+'" onclick="'+e.video.onclick+'" style="background-image: url(\''+e.video.thumb+'\')"><div class="report_video_duration"><span class="report_video_icon"></span><span class="report_video_duration_text">'+e.video.duration_text+"</span></div></a></td>",a+="<td>",a+=e.video.DELETED?"Видеозапись удалена":'<div class="report_video_title"><a href="'+e.video.href+'" onclick="'+e.video.onclick+'">'+e.video.title_short+"</a></div>",a+=!e.video.DELETED&&e.description?'<div class="report_video_description">'+e.video.description_short+"</div>":"",a+="</td>",a+="</tr></table>",a+='<div class="report_video_duration_second"><b>Duration:</b> <a class="_console_conditions" data-conditions="duration = '+e.duration+'">'+e.duration+"</a></div>",e.external&&(a+='<div class="report_video_external"><b>External:</b> '+e.external+"</div>");break;case 3504:case 3545:t="<a href='/photo"+e.owner_id+"_"+e.photo_id+"' target='_blank'> "+o+"</a>";break;case 13120:case 13121:t="<a href='/market"+e.owner_id+"?w=product"+e.owner_id+"_"+e.item_id+"' target='_blank'> "+o+"</a>";break;case 3500:case 3547:t="<a href='/photo"+e.owner_id+"_"+e.photo_id+"' target='_blank'> "+o+"</a>",a+='<table class="report_photo"><tr>',a+='<td><div class="report_photo_thumb">'+e.photo+"</div></td>",a+=e.description?'<td><div class="report_photo_description">'+e.description+"</div></td>":"",a+="</tr></table>",a+=e.album_id<0?'<div class="report_album_id"><b>album_id:</b> '+e.album_id+"</div>":"";break;case 3550:t="<a href='/photo"+e.owner_id+"_"+e.photo_id+"' target='_blank'> "+o+"</a>",a+=e.photo,a+=e.album_id<0?'<div class="report_album_id"><b>album_id:</b> '+e.album_id+"</div>":"";break;case 9258:a+=e.about;break;case 1800:a+=e.status;break;case 1531:case 1530:case 1534:a+=getTemplate("nospam_reports_field",{class:"report_message",value:e.text});break;case 5e3:t="<a href='/topic-"+e.group_id+"_"+e.topic_id+"' target='_blank'> "+o+"</a>",a+=e.title;break;case 5001:case 5046:t="<a href='/topic-"+e.group_id+"_"+e.topic_id+"?post="+Math.abs(e.comment_id)+"' target='_blank'> "+o+"</a>";break;case 2131:var c=e.group_id;t="Группа: "+getTemplate("nospam_reports_id_link",{type:"club",id:c,label:c,color:"black"}),a+="<b>Название:</b>"+e.group_name+"<br>",a+="<b>Описание:</b>"+e.group_description+"<br>";break;case 7530:t="<a href='/app"+e.app_id+"' target='_blank'> "+o+"</a>",a+=e.app_name+"<br>";break;case 3670:var p=e.like_ref,d=e.like_type,u=e.owner_id+"_"+e.item_id,_="";switch(Number(d)){case 11:t="<a href='wall<a href='wall"+u+"' target='_blank'> "+o+"</a>",_+="(запись на стене), <a href='wall"+u+"' target='_blank'>vk.com/wall"+u+"</a>";break;case 12:t="<a href='wall"+u+"' target='_blank'> "+o+"</a>",_+="(комментарий на стене), <a href='wall"+u+"' target='_blank'>vk.com/wall"+u+"</a>";break;case 10:t="<a href='photo"+u+"' target='_blank'> "+o+"</a>",_+="(фотография), <a href='photo"+u+"' target='_blank'>vk.com/photo"+u+"</a>";break;case 24:case 8:t="<a href='photo"+u+"' target='_blank'> "+o+"</a>",_+="(видеозапись), <a href='video"+u+"' target='_blank'>vk.com/video"+u+"</a>";break;case 6:t="<a href='audio.php?id="+e.owner_id+"&audio_id="+e.item_id+"' target='_blank'> "+o+"</a>",_+="(аудиозапись), <a href='audio.php?id="+e.owner_id+"&audio_id="+e.item_id+"' target='_blank'>vk.com/audio.php?id="+e.owner_id+"&audio_id="+e.item_id+"</a>";break;case 22:t=o,_+="(комментарий к видео)";break;case 21:t=o,_+="(комментарий к фотографии)";break;case 20:t=o,_+="(комментарий на стене)";break;default:t=o,_+=" (незвестный тип) "+u}a+=getTemplate("nospam_reports_report_like",{like_ref:p,like_ref_id:e.ref,like_type:_,like_type_id:d});break;default:console.log("No type specified")}if(e.post_tags){var m=e.post_tags;Object.keys(m).forEach((function(e){m[e]&&(a=getTemplate("nospam_reports_tag",{tag_label:m[e]})+a)}))}if(e.score){var g=function(e){if(0===e.length)return!1;var t=[];for(var a in e)h.includes(a)&&t.push([a,e[a]]);if(0===t.length)return!1;return t.sort(((e,t)=>t[1]-e[1])),t[0]}(e.score);g&&(s+=getTemplate("nospam_reports_score_block",{label:g[0],score:g[1]})),a+=getTemplate("nospam_reports_scores",{score_blocks:s})}return a+=function(e){var t,a,o=e.uid_base_info,n=e.mem_banned,i="",s="";if(o){var l=e.pattern_additional_info;t=Number(o[0].pattern_id),a=Number(o[0].state);var c=(p=l.admin_name,d=Number(o[1].admin_id),u=p.split(" ").reduce(((e,t)=>e+t[0]),""),getTemplate("nospam_reports_id_link",{type:"id",id:d,label:u,color:"black"}));i=`${0===a?"Обрабатывается: ":"Обработан: "} шаблон <a href='/pattern${t}' target='_blank'>${t}</a> (${l.pattern_type_name}; ${l.pattern_params}) от ${c}`}var p,d,u;n&&(s=`${M(new Date(1e3*n.time))}: ${n.comment}`);if(!(0,r.getCustomOption)("reports_hide_ban_info")&&(o||n))return`<div class="BannerInfo"><div class="report_processed_info">${i}</div><div>${s}</div></div>`;return""}(e),i.innerHTML=a,[i,t]}function E(e){var t,a=e.mem_banned,o=isObject(a),n=(C(e.ui_type,e.index),!1),r=ce("div");addClass(r,"report_info"),o&&(addClass(r,"report_banned"),n=Number(a.ban_time)<0);var i,s=e.uid,l=Number(e.type),c=o?"red":"blue",d=n?"forever":"";return t=s>0?getTemplate("nospam_reports_id_link",{type:"id",id:s,label:s,color:c}):getTemplate("nospam_reports_id_link",{type:"club",id:-s,label:s,color:c}),i=p(x(e),2)[1],r.innerHTML=getTemplate("nospam_reports_report_info",{action_mention_link:t,ban_time_class:d,type:l,index:e.index,ip:e.ip,report_time:M(new Date(1e3*e.report_time)),action_time:M(new Date(1e3*e.time)),ua_hash:e.ua_hash,from_uid:e.from_uid,report_count:e.report_count>1?langNumeric(e.report_count,["","%s жалоба","%s жалобы","%s жалоб"]):"",report_type_link:i}),r}function B(e,t){var a="",o="report_"+e.ui_type+"_"+e.index,n=ce("div");addClass(n,"report_steps");var r=cur.isSearchOnlyMode;if(("photo"===e.ui_type||"video"===e.ui_type)&&!r){var i=e[e.ui_type+"_id"];a+="<a id = 'spamer_by_"+o+'\' class="flat_button button_small secondary" onclick = "'+`dealSingleSpamer('${e.ui_type}', ${e.index}, ${e.uid}, '${e.deal_single_spamer_hash}', ${e.type}, ${e.time}, ${e.owner_id}, ${i})`+'">Забанить и откатить</a>'}return a+=getTemplate("nospam_reports_compose_button",{type:e.real_ui_type?e.real_ui_type:e.ui_type,ip:e.ip,ua_hash:e.ua_hash}),!r&&e.first_attached_photo_kid&&(a+=getTemplate("nospam_reports_apply_pattern_fast",{name:"Автошаблон kid (ДП)",kid:e.first_attached_photo_kid})),a+="<span id='selected_text_span"+t+"' style='display:none;'></span>",n.innerHTML=a,n}function L(e,t,a,o,n,r,i,s){var l="report_"+e+"_"+t,p=c.reportsRollbackSpamerDone,d=c.reportsRollbackSpamerFail;"photo"===e?(0,c.rollbackPhotoSpamer)(a,o,n,r,i,s,(()=>p(l)),(()=>d(l))):"video"===e&&(0,c.rollbackVideoSpamer)(a,o,n,r,i,s,(()=>p(l)),(()=>d(l)))}function M(e){var t=e.getDate(),a=e.getMonth()+1;return(t<10?"0":"")+t+"."+(a<10?"0":"")+a+" в "+e.toLocaleTimeString()}var N={_sel:[],day:v.getDate(),month:v.getMonth(),months:[[0,"Января"],[1,"Февраля"],[2,"Марта"],[3,"Апреля"],[4,"Мая"],[5,"Июня"],[6,"Июля"],[7,"Августа"],[8,"Сентября"],[9,"Октября"],[10,"Ноября"],[11,"Декабря"]],year:v.getFullYear(),generateHMS:function(e){var t,a=[];switch(e){case"hour":t=23;break;case"minute":case"second":t=59}for(var o=0;o<=t;++o)a.push([o,o<10?"0"+o:o+""]);return a},generateDays:function(e,t){for(var a=[],n=(0,o.getLastDay)(e,t),r=1;r<=n;++r)a.push([r,r+""]);return a},updateDays:function(){var e=this._sel[0],t=this._sel[1].val(),a=this._sel[2].val();e.val()>(0,o.getLastDay)(a,t)&&e.clear(),e.setData(this.generateDays(a,t))},setControls:function(){var e=N,t=[["reports_day",55],["reports_month",95],["reports_year",60],["reports_hour",50],["reports_minute",50],["reports_second",50]],a=ce("div",{id:"reports_time_wrap",className:"reports_time_wrap"}),o=geByClass1("box_body");e.clear(),o.appendChild(a),t.forEach((function(a,n){var r=[],i=[],s=ce("div",{className:a[0]+" fl_l"}),l=ce("input",{type:"hidden",name:a[0],id:a[0]}),c=a[0].split("_")[1];switch(domLC(o).appendChild(s),s.appendChild(l),c){case"year":i=(r=[[e.year,e.year+""]])[0];break;case"month":r=e.months,i=e.month;break;case"day":i=(r=e.generateDays(e.year,e.month))[e.day-1];break;case"hour":r=e.generateHMS(c),i=v.getHours();break;case"minute":r=e.generateHMS(c),i=v.getMinutes();break;case"second":r=e.generateHMS(c),i=v.getSeconds();break;default:i=r=e[c]}var p={width:t[n][1],multiselect:!1,autocomplete:!1,selectedItems:i};"month"!==c&&"year"!==c||extend(p,{onChange:function(e){N.updateDays()}}),N._sel.push(new Dropdown(l,r,p))}))},setTime:function(){boxQueue.hideLast();var e=N,t=e._sel,a={day:t[0].val(),month:t[1].val(),year:t[2].val(),hour:t[3].val(),minute:t[4].val(),second:t[5].val()},o=new Date(a.year,a.month,a.day,a.hour,a.minute,a.second),n=e.tt;val(n,o.getTime()/1e3)},set:function(e,t){var a=this.setControls,o=this.setTime,n=domData(t,"part");v=new Date;var i=n?"time_"+e+"_input2":"time_"+e+"_input";this.tt=ge(i,r.patternWrap),showFastBox({width:435,title:"Время действия ("+("start"==e?"позже":"раньше")+", чем)",dark:1,containerClass:"nospam_report_time_box",onShow:a},'<div class="reports_time_label">Укажите дату:</div>',"Применить",o)},clear:function(){return this._sel=[]}};function P(e){(0,s.isSpecialKeyPressed)(e)?function(e){var t=(0,n.getParams)();if(t.type=domData(e,"type"),null===t.type)return!1;"post"!==t.type&&"comment"!==t.type||(t.type="wall");t.ip=domData(e,"ip"),t.uahash=domData(e,"ua-hash"),t.pattern=t.pattern||getSelectionText(),t.threshold=1;var a=(0,n.composeSearchLinkFromParams)(t);(0,s.openInNewTab)(a)}(e.target):function(e){var t=domData(e,"type"),a=domData(e,"ip"),o=domData(e,"ua-hash");if(null===t)return;"post"!=t&&"comment"!=t||(t="wall");(0,n.setIp)(a),(0,n.setUaHash)(o),(0,n.setThreshold)(1),cur.uiSpamtype.selectItem(t),(0,r.switchTab)(r.tabPattern),(0,n.optionClear)(!1,"reset_all")}(e.target)}function H(e,t){var a=f[e];f[e]?a&&a!==t&&debugLog("collision for "+e,t,a):f[e]=t}function I(){if((0,r.getCurrentTab)()===r.tabReports){var e=y(),t=geByClass1("_reports_"+e+"_wrap",r.reportList),a=geByClass1("_report_show_more",domPN(t)),o=domPN(a),n=window.innerHeight||document.documentElement||bodyNode.clientHeight;k=scrollGetY(),isVisible(o)&&(0,r.activeTab)()===r.tabReports&&n+k>a.offsetTop&&a.click()}}function F(){clearTimeout(b),b=setTimeout(S.pbind(y(),w()),1e3)}function j(){var e=(0,l.createModule)({handlers:(e,t)=>{t(r.reportList,"mouseover","report_steps",D),t(r.reportList,"click","report_steps",(e=>P(e))),t(r.reportList,"click","fast_pattern",(e=>{return t=e.target,o=t.getAttribute("data-kid"),a={act:"apply_pattern",type:"photo",pattern:"/",simplify:32,search_period:72,duration:8,bantype:0,conditions:`type = 3500 && album_id IN (-7, -8) && kid = '${o}'`,comment:"#child_porn Боты или взломанные с ДП-фото для увода в Телеграм (автошаблон из жалобы на комментарий)",pattern_added_short_output:!0},void ajax.post("noSpam.php",a,{onDone:e=>{t.outerHTML=`<span>${e}</span>`},onFail:()=>{topError("Ошибка при установке шаблона"),t.outerHTML="<span>Ошибка</span>"},showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t)});var t,a,o})),t(r.reportList,"mouseover","report_info_ban_tooltip",(e=>function(e){var t=e.target,a=domData(t,"action-index"),o=g[a].ban_tt;o&&showTooltip(t,{text:o,dir:"down",hasover:1,shift:[22,5,0]})}(e))),t(r.reportList,"mouseover","report_info_ua_hash",(e=>function(e){var t=e.target,a=domData(t,"ua-hash"),o=f[a];showTooltip(t,{text:o||"[NULL]",dir:"down",hasover:1,shift:[22,5,0]})}(e))),e(document,"scroll",I),t(r.reportList,"click","_report_show_more",(e=>{var t=domData(e.target,"need-shift");T(y(),t)})),t(r.reportTabs,"click","report_filter",(e=>function(e){var t=e.target,a=domData(t,"type"),o=domData(t,"subtype"),n=geByClass("report_filter",r.reportTabs),i=geByClass("report_subfilter",r.reportTabs),s=geByClass1(m,r.reportList);if(!a)return!1;n.forEach((e=>{hasClass(e,_)&&removeClass(e,_),domData(e,"type")!==a||domData(e,"subtype")||addClass(e,_)}));var l=!1,c=!1;i.forEach((e=>{removeClass(e,u),removeClass(e,_),domData(e,"type")===a&&(addClass(e,u),l=!0),domData(e,"subtype")===o&&(addClass(e,_),c=!0)}));var p=geByClass1("hr",r.reportTabs);if(l?show(p):hide(p),l&&!c){var d=geByClass1(u,r.reportTabs);addClass(d,_)}domData(s,"type")!==a&&(removeClass(s,m),addClass(ge("reports_"+a),m)),S(a,o)}(e))),t(r.reportList,"click","_report_btn_update",(e=>{S(y(),w())})),t(r.reportTabs,"mouseover","settings_dots_wrap",(e=>{var t=geByClass1("settings_dots_wrap");showTooltip(t,{black:!0,text:getTemplate("reports_group_message_tab_tooltip"),className:"group_messages_settings_tt",slideY:15,shift:[98,100,20],dir:"top",showdt:300,hidedt:100,hasover:!0,onCreate:function(){var e;e=ge("search_shift_filter"),cur.hoursShiftSlider=new Slider(e,{width:200,height:100,debounce:10,size:2,value:parseFloat(nav.objLoc.shift/23)||0,onChange:e=>{(0,s.updateUrl)({shift:parseInt(23*e)}),F()},formatHint:e=>langNumeric(parseInt(23*e),["","%s час назад","%s часа назад","%s часов назад"])}),(0,s.initRadioButtons)("group_messages_reports_sorting","sorting_radio_filter_wrap",1)}})}))}});cur.destroy.push((()=>{(0,l.destroyModule)(e)}))}var O={initUpdate:function(){scrollToY(k)}}},450020:(e,t,a)=>{"use strict";a.d(t,{rollbackDocMailSpamer:()=>n,rollbackDocWallSpamer:()=>r,rollbackJpgMailSpamer:()=>i,rollbackJpgWallSpamer:()=>s,rollbackPngMailSpamer:()=>l,rollbackPngWallSpamer:()=>c,rollbackDocSpamer:()=>p,rollbackPhotoSpamer:()=>d,rollbackPhotoSpamerFromWall:()=>u,rollbackPhotoSpamerFromMail:()=>_,rollbackVideoSpamer:()=>m,rollbackVideoSpamerFromWall:()=>h,rollbackVideoSpamerFromMail:()=>g,reportsRollbackSpamerDone:()=>b,reportsRollbackSpamerFail:()=>k});var o="green_item";function n(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_docmail_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_docmail_spamer",uid:e,hash:t,act_type:a,spam_date:o,to_id:n,to_msg_id:r},{onDone:i,onFail:s})}function r(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_docwall_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_docwall_spamer",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,msg_id:r},{onDone:i,onFail:s})}function i(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_jpgmail_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_jpgmail_spamer",uid:e,hash:t,act_type:a,spam_date:o,to_id:n,to_msg_id_id:r},{onDone:i,onFail:s})}function s(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_jpgwall_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_jpgwall_spamer",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,msg_id:r},{onDone:i,onFail:s})}function l(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_pngmail_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_pngmail_spamer",uid:e,hash:t,act_type:a,spam_date:o,to_id:n,to_msg_id:r},{onDone:i,onFail:s})}function c(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_pngwall_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_pngwall_spamer",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,msg_id:r},{onDone:i,onFail:s})}function p(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_doc_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_doc_spamer",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,doc_id:r},{onDone:i,onFail:s})}function d(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_photo_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_photo_spamer",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,photo_id:r},{onDone:i,onFail:s})}function u(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_photo_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_photo_spamer_from_wall",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,msg_id:r},{onDone:i,onFail:s})}function _(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_photo_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_photo_spamer_from_mail",uid:e,hash:t,act_type:a,spam_date:o,to_id:n,to_msg_id:r},{onDone:i,onFail:s})}function m(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_video_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_video_spamer",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,video_id:r},{onDone:i,onFail:s})}function h(e,t,a,o,n,r){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t=>f(t,e,"rollback_video_spamer"),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_video_spamer_from_wall",uid:e,hash:t,act_type:a,spam_date:o,owner_id:n,msg_id:r},{onDone:i,onFail:s})}function g(e,t,a,o,n,r){var i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:v;ajax.post("noSpam.php",{act:"rollback_video_spamer_from_mail",uid:e,hash:t,act_type:a,spam_date:o,to_id:n,to_msg_id:r},{onDone:oneDone,onFail:i})}function f(e,t,a){ge(a+t).innerHTML=e,function(e){var t=ge("console_item_"+e);hasClass(t,o)&&removeClass(t,o),addClass(t,"red_item")}(t)}function v(){return null}function b(e){ge("spamer_by_"+e).outerHTML="<span style = 'color: green'> Добавлен </span>",document.getElementById(e).classList.add("processed")}function k(e){ge("spamer_by_"+e).outerHTML="<span style = 'color: red'> Неудача </span>"}},752988:(e,t,a)=>{"use strict";a.d(t,{noSpamSuspicious:()=>o});var o={selected:"ua_hash",updateOnSelect:function(){return o.getByType(o.selected)},getSpamType:function(){return isObject(this.spamtype)?this.spamtype._selected[0]:"wall"},getPeriod:function(){return isObject(this.period)?this.period._selected[0]:1},getByType:function(e){var t=ge("suspicious_table"),a=geByClass1("summary_tab_sel","suspicious_tabs"),o=isVisible("suspicious_tabs")?0:1,n=this;this.selected=e;var r=ge("suspicious_spamtype"),i=ge("suspicious_period"),s=geByClass("_suspicious_msg"),l=geByClass1("_suspicious_"+e+"_msg");each(s,(function(e,t){hide(t)})),show(l),"hashtags"==e?hide(r):show(r),"users"==e&&hide(r,i),o&&(t=ge("suspicious")),removeClass(a,"summary_tab_sel");var c={act:"a_get_suspicious",type:e,spamtype:this.getSpamType(),period:this.getPeriod(),need_tabs:o};addClass("suspicious_"+e,"summary_tab_sel"),ajax.post("noSpam.php",c,{onDone:function(e){if(!e)return topError(getLang("nospam_suspicious_data_error"));t.innerHTML=e,n.initInlineDropdown()},progress:"suspicious_progress"})},initInlineDropdown:function(){var e={withArrow:!0,keepTitle:!0,autoShow:!0,autoHide:300,onSelect:o.updateOnSelect},t=extend({items:cur.options.spamtypes,selected:"wall"},e),a=extend({items:[[1,"Один час"],[2,"Два часа"],[5,"5 часов"],[10,"10 часов"],[24,"Сутки"]],selected:1},e);this.spamtype||(this.spamtype=new InlineDropdown("suspicious_spamtype",t)),this.spamtype._els.valueEl.innerHTML=this.spamtype._selected[1],this.period||(this.period=new InlineDropdown("suspicious_period",a)),this.period._els.valueEl.innerHTML=this.period._selected[1]}}},320902:(e,t,a)=>{"use strict";a.d(t,{noSpamTemplates:()=>n});a(59357),a(820075);var o=a(93716),n=function(e){this.selected=0,extend(this,e),this.templates=JSON.parse(e.templates)};n.prototype={addTemplate:function(){showBox("noSpam.php",{act:this.acts.add},{params:{width:430,dark:1,progress:"add_template"}})},saveTemplate:function(e){var t=cur[e],a=t.selected||0;if(ge("add_template_title")&&ge("add_template_text")){var o=trim(ge("add_template_title").value),n=trim(ge("add_template_text").value);if(!o)return notaBene("add_template_title");if(!n)return notaBene("add_template_text");var r={act:t.acts.save,title:o,text:n,hash:t.hash,template_id:a};ajax.post("noSpam.php",r,{onDone:function(e,a){var o=ge(t.links);o.innerHTML=e,hasClass(o,"template_links")||addClass(o,"template_links"),t.templates=JSON.parse(a),curBox().hide()},progress:a?"edit_template":"add_template"})}},editTemplate:function(){var e={act:this.acts.edit,template_id:this.selected,hash:this.hash};showBox("noSpam.php",e,{params:{width:430,dark:1,progress:"edit_template"}})},deleteTemplate:function(){var e=this;if(!this.selected)return!1;showFastBox({title:"Удаление шаблона",width:430,dark:1,progress:"delete_condition"},getLang("nospam_delete_template"),getLang("global_delete"),(function(){var t=e.selected,a={act:e.acts.remove,template_id:t,hash:e.hash};ajax.post("noSpam.php",a,{onDone:function(t,a){var o=ge(e.links);o.innerHTML=t,e.deselectTemplate(),e.templates=JSON.parse(a),isObject(e.templates)||removeClass(o,"template_links"),curBox().hide()},progress:"delete_condition"})}),getLang("global_cancel"))},selectTemplate:function(e){if(e){var t=this.templates[e];this.selected=e;var a=entityDecode(t.text);(0,o.setConditions)(a),this.label.innerHTML=t.title+": ",addClass(this.wrap,"template_selected")}},selectCommentTemplate:function(e){if(e){var t=this.templates[e];this.selected=e;var a=entityDecode(t.text);this.editComment(a),this.label.innerHTML=t.answer_name+": ",addClass(this.wrap,"template_selected")}},editComment:function(e){if(val(this.input,e),this.input.autosize)return this.input.autosize.update();autosizeSetup("comment_input",{minHeight:32})},getFromLocal:function(e){var t=localStorage.comments_templates_storage;ge("get_local_comments");try{t=JSON.parse(t)}catch(e){}return t?t&&e?(each(t,(function(e,t){var a=function(e,t){var a=ge("comment_template_links");hasClass(a,"template_links")||addClass(a,"template_links"),cur.comment.links.innerHTML=e,cur.comment.templates=JSON.parse(t)};setTimeout((function(){var e=t[1];ajax.post("noSpam.php",{act:"save_comment_template",title:e.name,text:e.comment,hash:opts.comment_hash,template_id:0},{onDone:a})}),1e3*e)})),curBox().hide()):void showBox("noSpam.php",{act:"apply_comments_export"},{params:{width:430,dark:1,progress:"export_progress"}}):showFastBox({title:"Перенос шаблонов",dark:1},"К сожалению, не удалось найти ни одного комментария.")},deselectTemplate:function(){var e=this.selected,t=this.templates[e];if(t){var a=entityDecode(this.templates[e].text);t&&this.input.value==a&&val(this.input,""),this.label.innerHTML=this.label_html,removeClass(this.wrap,"template_selected"),delete this.selected}},editSort:function(){var e={act:this.acts.sort,hash:this.hash};showBox("noSpam.php",e,{params:{width:430,dark:1,progress:"sort_template"}})},saveSort:function(e,t,a,o,n){var r=cur[e],i={hash:t,act:r.acts.sort_save,tid:a.id.replace("template",""),tpos:a.dataset.pos,after_id:o&&o.dataset?o.dataset.pos:"",before_id:n&&n.dataset?n.dataset.pos:""};ajax.post("noSpam.php",i,{onDone:function(e,t){box=curBox(),box.content(e[2]),box.evalBox(t),box.setOptions({onHide:function(){debugLog(e),r.links.innerHTML=e[0],r.templates=JSON.parse(e[1])}})},progress:"sort_template"})}}},516883:(e,t,a)=>{"use strict";a.d(t,{consoleWrap:()=>o,patternWrap:()=>n,reportList:()=>r,reportTabs:()=>i,tabReports:()=>_,tabPattern:()=>m,switchTab:()=>g,getCurrentTab:()=>f,activeTab:()=>v,getCustomOption:()=>k,init:()=>S});var o,n,r,i,s,l=a(93716),c=a(936714),p=a(690864),d=a(535566),u=a(533246),_="reports",m="pattern",h="_nospam_option_action";function g(e,t){var a=geByClass1("_nospam_tab_switch_"+e);uiTabs.switchTab(domFC(a)),t&&(a=domChildren(a));var o=geByClass("nospam_tab"),n=domData(a,"tab-id");return o.forEach((function(e){domData(e,"id")!=n?hide(e):show(e)})),(0,d.updateUrl)({tab:e}),"patterns"===e?p.noSpamPatterns.initUpdate():e===_?c.noSpamReports.initUpdate():e===m&&scrollToTop(),!1}function f(){return(0,d.getUrlParam)("tab")}function v(){var e=domPN(geByClass1("ui_tab_sel"));return domData(e,"tab-id")}function b(e){geByClass(h,s).forEach((t=>{var a=domData(t,"option"),o=+e[a],n=window.cur.lang["nospam_options_"+a];n&&(t.innerHTML=n[o]),domData(t,"option-state",o)})),cur.options.custom_options=e}function k(e){var t=window.cur;return!!t.options.custom_options&&t.options.custom_options[e]}function y(e,t,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n={width:185,height:500,multiselect:!1};return e.includes("spamtype")&&extend(n,{onChange:e=>{window["ConditionsEditor"+o].setSection(e)}}),new Dropdown(document.getElementById(e),t,extend(n,{selectedItems:a}))}function w(e){extend(cur,{uiSpamtype:y("spamtype",e.spamtypes,cur.options.spamtype),uiSpamtype2:y("spamtype2",e.spamtypes,cur.options.spamtype2,2),uiSimplify:y("simplify_select",e.simplifies,cur.options.simplify),uiBan:y("ban_select",e.bans,cur.options.ban),uiDuration:y("duration_select",e.durations,cur.options.duration),uiSearchPeriod:y("search_period_select",e.searchperiods,cur.options.searchperiod)}),placeholderSetup("comment_input"),val("comment_input")&&autosizeSetup("comment_input",{minHeight:30}),geByClass("conditions_input").forEach((function(e){placeholderSetup("comment_input"),val(e)&&autosizeSetup("comment_input",{minHeight:30})}));var t=ge("page_body");n=geByClass1("pattern_wrap",t),o=geByClass1("console_wrap",t),i=geByClass1("reports_tabs",t),r=geByClass1("_reports_list",t),s=geByClass1("_nospam_options",t);var a=geByClass1("nospam_patterns_wrap",t),d=(0,u.createModule)({handlers:(e,t)=>{t(a,"click","_abort_pattern_mild",(e=>(0,p.abortPatternMild)(domData(e.target,"id")))),t(s,"click",h,(e=>function(e){var t={act:"a_set_custom_option",name:domData(e,"option"),state:1^domData(e,"option-state")};ajax.post("noSpam.php",t,{onDone:b,showProgress:lockActionsMenuItem.pbind(e),hideProgress:unlockActionsMenuItem.pbind(e)})}(e.target)))}});cur.destroy.push((()=>{(0,u.destroyModule)(d)})),(0,l.mount)(),(0,c.mount)()}function S(e){var t=(0,u.createMutations)(w);t.callMutations;(0,t.bindMutations)(e)}},535566:(e,t,a)=>{"use strict";a.d(t,{PHP_DAY:()=>o,MILLISECONDS_MULTIPLIER:()=>n,TARGET_BLANK:()=>r,EVENT_MOUSEDOWN:()=>i,EVENT_KEYDOWN:()=>s,EVENT_SCROLL:()=>l,getCurrentUrl:()=>c,updateUrl:()=>p,getUrlParam:()=>d,getAct:()=>u,openInNewTab:()=>_,getTime:()=>m,getCurrentDayBoundaries:()=>h,getDayBoundaries:()=>g,timestampToSeconds:()=>f,showLoading:()=>v,hideLoading:()=>b,hideCurrentBox:()=>k,initRadioButtons:()=>y,isSpecialKeyPressed:()=>w,isIntegerString:()=>S});var o=86400,n=1e3,r="_blank",i="mousedown",s="keydown",l="scroll";function c(){return nav.strLoc}function p(e){var t={0:nav.objLoc[0],act:nav.objLoc.act};nav.setLoc(extend(t,e))}function d(e){return nav.objLoc[e]}function u(){return d("act")}function _(e){window.open(e,"_blank").focus()}function m(){return f(Date.now())}function h(){return g((new Date).getTime())}function g(e){var t=new Date(e),a=new Date(e);return t.setHours(0,0,0,0),a.setHours(23,59,59,999),[t.getTime(),a.getTime()]}function f(e){return Math.floor(e/n)}function v(){var e=new MessageBox;e.setOptions({title:!1,hideButtons:!0}).show(),hide(boxLayerBG),hide(e.bodyNode),show(boxLoader),boxRefreshCoords(boxLoader)}function b(){curBox&&curBox()&&curBox().hide()}function k(){curBox().hide()}function y(e,t,a){window.radioBtns[e]={val:a,els:Array.prototype.slice.apply(geByClass("radiobtn",geByClass1(t)))}}function w(e){return e.ctrlKey||e.metaKey&&browser.mac}function S(e){return/^-?(0|[1-9]\d*)$/.test(e)}},276018:(e,t,a)=>{"use strict";a.d(t,{addDelegateEvent:()=>s,removeDelegateEvent:()=>l});a(530522),a(66108),a(579665),a(95767),a(991181),a(296253),a(751876);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],o=!0,n=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(e){n=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var r=new window.Map;function i(e){var t=r.get(e.currentTarget);if(t){var a=t[e.type];if(a)for(var n,i=0;i<a.length;i++){var s=o(a[i],2),l=s[0],c=s[1],p=void 0;if(hasClass(e.target,l)?p=c(e,e.target):(n=gpeByClass(l,e.target,e.currentTarget))&&(p=c(e,n)),!1===p)break}}}function s(e,t,a,o){var n=r.get(e);n||(r.set(e,{}),n=r.get(e));for(var s=t.split(" "),l=0;l<s.length;l++){var c=s[l];n[c]||(n[c]=[],addEvent(e,c,i)),n[c].push([a,o])}}function l(e,t,a,o){var n=r.get(e);n&&(t.split(" ").forEach((t=>{n[t]&&(n[t]=n[t].filter((e=>e[0]!==a||e[1]!==o)),0===n[t].length&&removeEvent(e,t,i))})),0===Object.keys(n).map((e=>n[e].length)).reduce(((e,t)=>e+t))&&r.delete(e))}},841303:(e,t,a)=>{"use strict";a.d(t,{SelectTable:()=>m});var o,n=a(570655),r=a(667294),i=a(985903),s=a(623279),l=a(800729),c=a(95221),p=a(624352),d=a(878762),u=a(303234),_=a(731585);!function(e){e.TOGGLE="toggle",e.SELECT="select",e.DESELECT="deselect"}(o||(o={}));var m=function(e){function t(t){var a=e.call(this,t)||this;return a.handleCheckBoxHeaderClick=a.handleCheckBoxHeaderClick.bind(a),a}return(0,n.__extends)(t,e),t.prototype.selectionChange=function(e,t){var a=this,n=t.map((function(t,n){switch(e){case o.TOGGLE:return t?!a.props.selection[n]:a.props.selection[n];case o.SELECT:return!0;case o.DESELECT:return!1}}));this.props.onSelection(n)},t.prototype.selectSingleRow=function(e){var t=this.props.selection.map((function(t,a){return a===e}));this.selectionChange(o.TOGGLE,t)},t.prototype.handleCheckBoxHeaderClick=function(e){var t=this.props.selection.map((function(){return!0}));e.altKey?this.selectionChange(o.TOGGLE,t):this.props.selection.reduce((function(e,t){return e&&t}))?this.selectionChange(o.DESELECT,t):this.selectionChange(o.SELECT,t)},t.prototype.handleRowClick=function(e,t){e.target.className.includes("CheckBox__")&&e.preventDefault(),this.selectSingleRow(t.index)},t.prototype.handleMouseEnter=function(e,t){var a;window.cur.mousedown&&(null===(a=document.getSelection())||void 0===a||a.removeAllRanges(),this.selectSingleRow(t.index))},t.prototype.getRowClassName=function(e){var t=this.props,a=t.selection[e],o=t.muted[e],n=t.data[e].isFirstInGroup,r=[];return a&&r.push("SelectTable__row--selected"),o&&r.push("SelectTable__row--muted"),n&&r.push("SelectTable__row--firstInGroup"),r.join(" ")},t.prototype.render=function(){var e=this,t=this.props,a=t.data.map((function(e,a){var o=t.selection[a];return e.checkbox=r.createElement(_.default,{checked:o,className:"SelectTable__checkBox"}),e})),o=(0,n.__spreadArray)([{Header:function(){return r.createElement(_.default,{className:"SelectTable__checkBox",checked:!1,onClick:e.handleCheckBoxHeaderClick})},accessor:"checkbox",width:40}],(0,n.__read)(t.columns));return r.createElement(i.default,{className:"SelectTable",data:a,columns:o,TableComponent:s.SelectTableContainerComponent,TheadComponent:l.SelectTableHeadComponent,TrComponent:c.SelectTableRowComponent,TdComponent:p.SelectTableCellComponent,ThComponent:d.SelectTableHeaderCellComponent,TrGroupComponent:u.SelectTableRowGroupComponent,resizable:!1,sortable:!1,pageSize:a.length,showPageSizeOptions:!1,showPagination:!1,getTdProps:function(t,a){return{onMouseDown:function(t){return e.handleRowClick(t,a)}}},getTrProps:function(t,a){return{className:e.getRowClassName(a.index),onMouseEnter:function(t){return e.handleMouseEnter(t,a)}}}})},t}(r.Component)},624352:(e,t,a)=>{"use strict";a.d(t,{SelectTableCellComponent:()=>n});var o=a(667294),n=function(e){return o.createElement("div",{className:"SelectTable__cell",role:"gridcell",style:e.style,onMouseDown:e.onMouseDown},e.children)}},623279:(e,t,a)=>{"use strict";a.d(t,{SelectTableContainerComponent:()=>n});var o=a(667294),n=function(e){return o.createElement("div",{className:"SelectTable__container"},e.children)}},800729:(e,t,a)=>{"use strict";a.d(t,{SelectTableHeadComponent:()=>n});var o=a(667294),n=function(e){return o.createElement("div",{className:"SelectTable__header",role:"row"},e.children)}},878762:(e,t,a)=>{"use strict";a.d(t,{SelectTableHeaderCellComponent:()=>n});var o=a(667294),n=function(e){return o.createElement("div",{className:"SelectTable__headerCell "+e.className,role:"columnheader",style:e.style},e.children)}},95221:(e,t,a)=>{"use strict";a.d(t,{SelectTableRowComponent:()=>n});var o=a(667294),n=function(e){return o.createElement("div",{className:"SelectTable__row "+e.className,role:"row",onMouseEnter:e.onMouseEnter},e.children)}},303234:(e,t,a)=>{"use strict";a.d(t,{SelectTableRowGroupComponent:()=>n});var o=a(667294),n=function(e){return o.createElement("div",{className:"SelectTable__rowGroup",role:"rowgroup"},e.children)}},198713:(e,t,a)=>{"use strict";a.d(t,{ConsoleLinks:()=>l});var o=a(570655),n=a(667294),r=a(834105),i=a(595775),s=a(339814),l=function(e){function t(t){var a=e.call(this,t)||this;return a.state={comment:""},a.handleCommentInput=a.handleCommentInput.bind(a),a}return(0,o.__extends)(t,e),t.prototype.handleCommentInput=function(e){var t=e.target;this.setState({comment:t.value})},t.prototype.render=function(){var e=this.props;return n.createElement(n.Fragment,null,n.createElement(i.default,{placeholder:"Комментарий к блокировке ссылок и доменов",onChange:this.handleCommentInput}),n.createElement(s.default,{active:"domains"},n.createElement("span",{key:"domains"},"Домены")),n.createElement(r.LinksTable,{rowsData:e.linksData.domains,banHash:e.banHash,comment:this.state.comment}))},t}(n.Component)},834105:(e,t,a)=>{"use strict";a.d(t,{LinksTable:()=>c});var o=a(570655),n=a(667294),r=a(841303),i=a(362213),s=a(64385),l=a(93716),c=function(e){function t(t){var a=e.call(this,t)||this;return a.state={selection:t.rowsData.map((function(){return!1})),banStatus:t.rowsData.map((function(e){return e.is_banned})),rowsData:t.rowsData.map((function(e,t){var a=e.link.slice(e.link.indexOf(e.name)+e.name.length);return(0,o.__assign)((0,o.__assign)({},e),{path:a,index:t})})),banInProgress:{status:!1,reason:null}},a.getSelectedRows=a.getSelectedRows.bind(a),a.handleRowSelection=a.handleRowSelection.bind(a),a.blockSelected=a.blockSelected.bind(a),a.selectByFilter=a.selectByFilter.bind(a),a.addSelectedToCondition=a.addSelectedToCondition.bind(a),a}return(0,o.__extends)(t,e),t.prototype.blockSelected=function(e){var t=this,a=this.props,o=this.getSelectedRows().filter((function(e){return!e.is_banned})).map((function(e){return{domain:e.name,link_example:e.link,index:e.index}}));if(o){this.setState({banInProgress:{status:!0,reason:e}});var n={links:JSON.stringify(o),reason:e,comment:a.comment,hash:a.banHash,act:"block_domains_mass"};s.ajax.post("noSpam.php",n,{onDone:function(e){t.updateBanStatus(e)}})}},t.prototype.getSelectedRows=function(){var e=this;return this.state.rowsData.filter((function(t,a){return e.state.selection[a]}))},t.prototype.updateBanStatus=function(e){var t=(0,o.__spreadArray)([],(0,o.__read)(this.state.banStatus));e.forEach((function(e){e.success&&(t[e.index]=!0)})),this.setState({banStatus:t,banInProgress:{status:!1,reason:null}})},t.prototype.selectByFilter=function(e){var t=this.state.rowsData.map((function(t){return e(t)}));this.handleRowSelection(t)},t.prototype.handleRowSelection=function(e){this.setState({selection:e})},t.prototype.addSelectedToCondition=function(e){var t=this.getSelectedRows();if(0!==t.length){var a=[];switch(e){case i.ConditionAddOption.DOMAIN_NAME:a=t.map((function(e){return e.name}));break;case i.ConditionAddOption.TOP_LEVEL_DOMAIN:t.forEach((function(e){var t=e.name.slice(e.name.lastIndexOf("."));a.includes(t)||a.push(t)}))}var o="@check_regex('"+a.join("|")+"', message)";(0,l.setConditions)(o)}},t.prototype.render=function(){for(var e=this.state,t=[],a="",o=0;o<e.rowsData.length;o++){var s=e.rowsData[o],l=e.banStatus[o]?{color:"var(--text_primary)"}:{};t.push({domain:n.createElement("a",{href:"/away.php?to=http://"+s.name,target:"_blank",style:l},s.name),path:s.path,field_name:s.field_name,sampleIndex:s.sample_index,count:s.count,isFirstInGroup:0!==o&&a!==s.top_domain}),a=s.top_domain}var c=e.selection.filter(Boolean).length,p=e.banStatus.filter(Boolean).length;return n.createElement(n.Fragment,null,n.createElement(i.LinksTableControls,{selectedCount:c,totalCount:t.length,bannedCount:p,blockSelected:this.blockSelected,banInProgress:e.banInProgress,selectByFilter:this.selectByFilter,addToCondition:this.addSelectedToCondition}),n.createElement(r.SelectTable,{data:t,columns:[{Header:"Домен",accessor:"domain"},{Header:"Путь",accessor:"path"},{Header:"К-во",accessor:"count",maxWidth:50},{Header:"Поле",accessor:"field_name",maxWidth:100}],selection:e.selection,onSelection:this.handleRowSelection,muted:e.banStatus}))},t}(n.Component)},362213:(e,t,a)=>{"use strict";a.d(t,{ConditionAddOption:()=>n,LinksTableControls:()=>p});var o,n,r=a(570655),i=a(667294),s=a(791219),l=a(326542),c=a(423558);!function(e){e[e.PHISHING=1]="PHISHING",e[e.FRAUD=3]="FRAUD"}(o||(o={})),function(e){e.DOMAIN_NAME="domain",e.TOP_LEVEL_DOMAIN="top"}(n||(n={}));var p=function(e){function t(t){var a=e.call(this,t)||this;return a.handleBlockClick=a.handleBlockClick.bind(a),a.handleAddToCondition=a.handleAddToCondition.bind(a),a}return(0,r.__extends)(t,e),t.prototype.handleBlockClick=function(e){this.props.blockSelected(e)},t.prototype.handleFilterClick=function(e){this.props.selectByFilter(e)},t.prototype.handleAddToCondition=function(e){this.props.addToCondition(e)},t.prototype.render=function(){var e=this,t=this.props;return i.createElement("div",{className:"LinksTableControls__container"},i.createElement(d,null,i.createElement(u,null,"Всего доменов:"),i.createElement("b",null,t.totalCount),i.createElement("div",{className:"divider"}),i.createElement(u,null,"Заблокировано:"),i.createElement("b",null,t.bannedCount)),i.createElement(d,null,i.createElement(u,null,"Выделено"),i.createElement(s.default,{className:"LinksTableControls__selectedCount",isMuted:0===t.selectedCount},t.selectedCount),i.createElement("div",{className:"divider"}),i.createElement(u,null,"Блокировать выделенные c причиной:"),i.createElement(c.default,{size:"s",appearance:"secondary",onClick:function(){return e.handleBlockClick(o.FRAUD)},loading:t.banInProgress.reason===o.FRAUD,disabled:t.banInProgress.status},"Мошенники"),i.createElement(c.default,{size:"s",appearance:"negative",onClick:function(){return e.handleBlockClick(o.PHISHING)},loading:t.banInProgress.reason===o.PHISHING,disabled:t.banInProgress.status},"Фишинг")),i.createElement(d,null,i.createElement(u,null,"Выделить:"),i.createElement(_,{onClick:function(){return e.handleFilterClick((function(e){return!e.is_banned}))}},"незабаненные"),i.createElement("div",{className:"divider"}),i.createElement(_,{onClick:function(){return e.handleFilterClick((function(e){return!e.path||"/"===e.path}))}},"без пути")),i.createElement(d,null,i.createElement(u,null,"Добавить в условие:"),i.createElement(_,{onClick:function(){return e.handleAddToCondition(n.DOMAIN_NAME)}},"домены целиком"),i.createElement("div",{className:"divider"}),i.createElement(_,{onClick:function(){return e.handleAddToCondition(n.TOP_LEVEL_DOMAIN)}},"верхний уровень")))},t}(i.Component);function d(e){return i.createElement("div",{className:"LinksTableControls__row"},e.children)}function u(e){return i.createElement("span",{className:"LinksTableControls__label"},e.children)}function _(e){return i.createElement(l.default,{onClick:e.onClick,className:"LinksTableControls__linkButton"},e.children)}},533246:(e,t,a)=>{"use strict";a.d(t,{createMutations:()=>i,createModule:()=>c,destroyModule:()=>p});var o=a(570655),n=a(276018),r=a(917685);function i(e){return{callMutations:function(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e.apply(void 0,(0,o.__spreadArray)([],(0,o.__read)(t)))}}}function s(e,t,a,o){(0,r.addEvent)(t,a,o),e._registeredHandlers.push({handlerType:"bind",elem:t,types:a,handler:o})}function l(e,t,a,o,r){(0,n.addDelegateEvent)(t,a,o,r),e._registeredHandlers.push({handlerType:"delegate",elem:t,types:a,selector:o,handler:r})}function c(e){var t={_registeredHandlers:[]};return e.handlers((function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return s.apply(void 0,(0,o.__spreadArray)([t],(0,o.__read)(e)))}),(function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return l.apply(void 0,(0,o.__spreadArray)([t],(0,o.__read)(e)))})),t}function p(e){e._registeredHandlers.forEach((function(e){var t=e.handlerType,a=e.elem,o=e.types,i=e.handler;"delegate"===t?(0,n.removeDelegateEvent)(a,o,e.selector,i):(0,r.removeEvent)(a,o,i)})),e._registeredHandlers=[]}}}]);try{stManager.done("dist/31a7b7e35aec67ab75f663efc68bb96c.65348dbc85e0ac287fc2.js")}catch(e){}