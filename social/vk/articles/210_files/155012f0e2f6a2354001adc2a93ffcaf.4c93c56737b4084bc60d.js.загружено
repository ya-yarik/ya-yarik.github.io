(self.webpackChunkvk=self.webpackChunkvk||[]).push([[613],{428817:t=>{t.exports={reactions_preview_item:'<div class="ReactionsPreviewItem ReactionsPreviewItem--stackOverlay %class%" style="background-image: url(\'%image_url%\');" aria-label="%title%"></div>'}},625206:(t,e,n)=>{"use strict";n.d(e,{once:()=>i});var i=function(t){var e=!1;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(!e)return e=!0,t.apply(this,n)}}},522414:(t,e,n)=>{"use strict";function i(t,e){for(var n in e)if(e.hasOwnProperty(n)){var i="{"+n+"}";t=t.replace(i,e[n])}return t}function r(t,e,n,i){return void 0===i&&(i="tag"),n=(n=n.replace("{"+i+"}",t)).replace("{/"+i+"}",e)}n.d(e,{langReplace:()=>i,langTag:()=>r})},224298:(t,e,n)=>{"use strict";n.d(e,{preservePositionBetween:()=>o});var i=n(712459),r=n(625206);function o(t,e){var n=(void 0===e?{}:e).scrollByImpl,o=void 0===n?window.scrollBy:n,a=t;return{start:(0,r.once)((function(t){t&&(a=t);var e=(0,i.getElementOffset)(a);return(0,r.once)((function(t){if(t&&(a=t),a.isConnected){var n=(0,i.getElementOffset)(a);o(0,n.top-e.top)}}))}))}}},692128:(t,e,n)=>{"use strict";n.d(e,{HIDE_TOOLTIP_TIMEOUT:()=>i,SHOW_TOOLTIP_TIMEOUT:()=>r,REACTION_ID_DEFAULT:()=>o,REACTION_ID_MAX:()=>a,REACTION_ID_MIN:()=>s,REACTION_ID_UNSET:()=>c,REACTION_SET_ITEMS_MIN_COUNT:()=>u});var i=600,r=140,o=0,a=7,s=0,c=void 0,u=2},880001:(t,e,n)=>{"use strict";n.d(e,{loadAnimation:()=>r,onAnimationReady:()=>o,getAnimation:()=>a});var i=n(570655),r=function(t){return function(e){var n,r,o=e.animationData,a=e.animationURL,s=e.container,c=e.loadAnimationParams,u=void 0===c?{}:c,l=o?{animationData:o}:{path:a},d={renderer:"svg",autoplay:null!==(n=null==u?void 0:u.autoplay)&&void 0!==n&&n,loop:null===(r=null==u?void 0:u.loop)||void 0===r||r,rendererSettings:{progressiveLoad:!0}},v=(0,i.__assign)((0,i.__assign)((0,i.__assign)({},l),d),{container:s});return t.loadAnimation(v)}},o=function(t,e){t.isLoaded?e():t.addEventListener("DOMLoaded",(function(){e()}))};var a=function(t){var e=t.animationItemGet,n=t.animationItemSet,i=t.loadAnimation;return function(t,r,o){var a=t,s=e({animationId:a}),c=i({animationData:s,animationURL:t,container:r,loadAnimationParams:null==o?void 0:o.loadAnimationParams});return s||function(t,e){t.addEventListener("data_ready",(function(){e(t.animationData)}))}(c,(function(t){n({animationId:a,loadedAnimationData:t})})),c}}},509723:(t,e,n)=>{"use strict";n.d(e,{isDebugEnabled:()=>o});var i=n(651988),r=void 0,o=function(){return void 0!==r?r:r=!!i.default.get("reactions.debug_enabled")}},956146:(t,e,n)=>{"use strict";n.d(e,{reactionLogError:()=>r});var i=n(611386);function r(t){var e=t.error,n=t.reportError;void 0!==n&&n&&(0,i.logError)(e,{environment:"reactions"}),console.error(e)}},754:(t,e,n)=>{"use strict";n.d(e,{getDefaultReaction:()=>s,getDefaultReactionTitle:()=>c,prepareReactionMenuSet:()=>l,isReactionIdUnset:()=>d,isValidReactionId:()=>v,parseReactionId:()=>f,parseReactionIdOrUnset:()=>g,validateReactionSetPayloaditems:()=>m,parseReactionMenuConfig:()=>p,calcCounters:()=>w,calcCountersSum:()=>b,calcCountersWeightedSum:()=>_,hasReactionsForCounts:()=>R});var i=n(570655),r=n(692128),o=n(457700),a=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},s=function(t){return t.itemsById[r.REACTION_ID_DEFAULT]},c=function(t){var e;return null===(e=s(t))||void 0===e?void 0:e.title},u=function(t,e){return 0===t.length?"":(n=t,i=function(t){return Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)},r=!1,void 0===r&&(r=!0),n.reduce((function(t,e){var n=i(e),o=i(t);return o===n?r?t:e:o<n?t:e}))).url;var n,i,r},l=function(t,e,n){var i=n.imageMenuSize,r=n.imagePreviewSize,o=e.map((function(t){var e=t.asset,n=t.color_sets,o=t.id,a=t.score,s=t.title;return{animationURL:e.animation_url||void 0,backgroundColor:null==n?void 0:n.background,id:o,imageMenuURL:u(e.images,i),imagePreviewURL:u(e.images,r),score:a,title:s,titleColor:null==n?void 0:n.foreground}})),a={};return o.forEach((function(t){a[t.id]=t})),{id:t,items:o,itemsById:a}},d=function(t){return t===r.REACTION_ID_UNSET},v=function(t){return a(t)&&t>=r.REACTION_ID_MIN&&t<=r.REACTION_ID_MAX},f=function(t){var e=parseInt(t,10);return v(e)?{isValid:!0,value:e}:{isValid:!1}},g=function(t){var e=f(t);return e.isValid?e.value:r.REACTION_ID_UNSET},m=function(t,e){if(t.length<r.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error("Invalid reactions items count in set '"+e+"': "+t.length)}},p=function(t){if(null!==(e=t)&&"object"==typeof e){var e,n={},i=t.animationShowStaticAfterEnd,r=t.reportJsErrors,o=t.menuShowDelay;return"number"!=typeof o&&void 0!==o||(n.menuShowDelay=o),"boolean"==typeof i&&(n.animationShowStaticAfterEnd=i),"boolean"==typeof r&&(n.reportJsErrors=r),n}},w=function(t,e){var n=(0,o.reactionCountsBrandWrap)({});return Object.entries((0,o.reactionCountsBrandUnwrap)(t)).forEach((function(t){var r,o,a,s=(0,i.__read)(t,2),c=s[0],u=s[1],l=c,d=null!==(a=null===(o=null===(r=null==e?void 0:e.itemsById)||void 0===r?void 0:r[l])||void 0===o?void 0:o.score)&&void 0!==a?a:1;n[l]=d*(u||0)})),n},b=function(t){return Object.values((0,o.reactionCountsBrandUnwrap)(t)).reduce((function(t,e){return t+(e||0)}),0)},_=function(t){return b((0,o.reactionCountsBrandWrap)(t))},R=function(t){return b(t)>0}},457700:(t,e,n)=>{"use strict";n.d(e,{reactionCountsBrandUnwrap:()=>i,reactionCountsBrandWrap:()=>r});var i=function(t){return t},r=function(t){return t}},59727:(t,e,n)=>{"use strict";n.d(e,{stripPercentVars:()=>i});var i=function(t){return t.replace(/%[-\w]+%/g,"")}},522494:(t,e,n)=>{"use strict";n.d(e,{ButtonStyleVariant:()=>i});var i={Post:"post",Reply:"reply"}},532054:(t,e,n)=>{"use strict";n.d(e,{renderPreviewItems:()=>d});var i=n(570655),r=n(754),o=n(121265),a=n(414914),s=n(428817),c=n.n(s),u=n(522494),l=n(353417),d=function(t,e,n,s,d){var v=function(t,e,n){var o,a;void 0===n&&(n=!1);var s=[];try{for(var c=(0,i.__values)(Object.keys(t)),u=c.next();!u.done;u=c.next()){var l=u.value,d=(0,r.parseReactionId)(l);d.isValid&&t[d.value]>0&&s.push(d.value)}}catch(t){o={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return s=s.sort((function(e,n){return(t[n]||0)-(t[e]||0)})).slice(0,e),n&&s.reverse(),s}(e,3),f=t.querySelector(".ReactionsPreview__items"),g=(0,l.getReactionSet)(n),m=0===(0,r.calcCountersSum)(e),p=c().reactions_preview_item;f&&g&&"string"==typeof p?(f.innerHTML=v.map((function(t){var e=g.itemsById[t];if(!e)return"";var n=(0,o.classNames)({"ReactionsPreviewItem--lite ReactionsPreviewItem--stackOverlayLite":d===u.ButtonStyleVariant.Reply,"ReactionsPreviewItem--post ReactionsPreviewItem--stackOverlayPost":d===u.ButtonStyleVariant.Post});return(0,a.rs)(p,{image_url:e.imagePreviewURL,title:e.title,class:n})})).join(""),t.classList.toggle("ReactionsPreview--empty",m),t.classList.toggle("ReactionsPreview--active",void 0!==s)):console.warn("Unable to render reaction previews",{itemsContainer:f,previewItemTemplate:p,reactionSet:g})}},723361:(t,e,n)=>{"use strict";n.d(e,{animationItemHasData:()=>s,getAnimation:()=>c});var i=n(401346),r=n(880001),o=(0,n(257451).makeSharedState)("reactions-animations-storage",(function(){return{animationItemsData:new Map}})),a=function(){return o().animationItemsData},s=function(t){return a().has(t)},c=(0,r.getAnimation)({animationItemGet:function(t){var e=t.animationId;return a().get(e)},animationItemSet:function(t){var e=t.animationId,n=t.loadedAnimationData;a().set(e,n)},loadAnimation:(0,r.loadAnimation)(i.default)})},138201:(t,e,n)=>{"use strict";n.d(e,{isDebugEnabled:()=>i.isDebugEnabled,ENABLED_IN_POST_REPLY:()=>r});var i=n(509723),r=!1},223625:(t,e,n)=>{"use strict";n.d(e,{isCounterEnabledForBtn:()=>o,getCounterForTitle:()=>a,isCounterEnabled:()=>s,isCounterAvailable:()=>c});var i=n(754),r=n(116886),o=function(t){return!!t.getAttribute("data-reaction-button-text-is-counter")};function a(t,e,n,a){if(!o(t))return{kind:"disabled"};if(!n)return{kind:"error"};var s=0!==(a?(0,i.calcCountersSum)(a):0);if(!(0,i.hasReactionsForCounts)(n))return{kind:"enabled",allowZeroAnimation:s,buttonText:""};var c=(0,i.calcCounters)(n,e),u=(0,i.calcCountersWeightedSum)(c);return{kind:"enabled",allowZeroAnimation:s,buttonText:(0,r.langNumeric)(u,"%s",!0)}}function s(t){return!!t&&"disabled"!==t.kind}function c(t){return"enabled"===t.kind}},236538:(t,e,n)=>{"use strict";n.d(e,{addDataUpdateListener:()=>a,emitDataUpdate:()=>s,addReactionChooseListener:()=>c,emitReactionChoose:()=>u});var i=n(970793),r=(0,n(257451).makeSharedState)("reactions-menu-events",(function(){return{emitter:new i.default}})),o=function(){return r().emitter},a=function(t,e){var n,i=o(),r=((n={})[t+":data_update"]=e,n);return i.addListeners(r),function(){i.removeListeners(r)}},s=function(t,e){o().emit(t+":data_update",e)},c=function(t,e){var n,i=o(),r=((n={})[t+":reaction_choose"]=e,n);return i.addListeners(r),function(){i.removeListeners(r)}},u=function(t){o().emit(t+":reaction_choose")}},162481:(t,e,n)=>{"use strict";n.d(e,{isWithoutPreviewForLikeBtn:()=>E,reactionsElemPayload:()=>y,setDataCurrentId:()=>A,updateReactionButtonForCurrentReaction:()=>k,updateReactionButtonCounts:()=>B,getLastOwnReactionChangeTime:()=>T,shouldReactionsPreviewBeVisible:()=>O,updateReactionsPreview:()=>U,updateReactionsButtonForCounts:()=>N});var i=n(570655),r=n(522414),o=n(223625),a=n(917999),s=n(920453),c=n(754),u=n(414914),l=n(190148),d=n(116886),v=n(723361),f=n(353417),g=n(423777),m=n(10246),p=n(532054),w=n(880001),b=n(509723),_="data-reaction-user-reaction-id",R="data-reaction-last-own-change-time",I="PostButtonReactions__icon--animationActive";var S=function(t){var e=t.getAttribute("data-reaction-counts");if(null===e)return{};var n=e?(0,s.parseJSON)(e):void 0;return"object"==typeof n&&null!==n?n:void 0},E=function(t){return!!t.getAttribute("data-reaction-without-preview")},y=function(t){var e=t.getAttribute("data-reaction-target-object"),n=t.getAttribute("data-reaction-hash"),i=t.getAttribute("data-reaction-set-id");if(null!==i){var r=t.getAttribute(_),o=r?(0,c.parseReactionIdOrUnset)(r):void 0,a=t.getAttribute("data-reaction-style-variant"),s=a&&(0,m.isValidButtonStyleVariant)(a)?a:void 0,u=E(t);return{counts:S(t),csrfHash:n,objectRaw:e,reactionSetId:i,styleVariant:s,userReactionId:o,withoutPreview:u}}},A=function(t,e){t.setAttribute(_,(0,c.isReactionIdUnset)(e)?"":String(e))},C=function(t){var e,n=null===(e=t.__reactionIconAnimation)||void 0===e?void 0:e.animationItem;n&&(!n._cbs||n.destroy(),delete t.__reactionIconAnimation)},L=function(t,e,n,i){var r;if(!(t!==(null===(r=n.__reactionIconAnimation)||void 0===r?void 0:r.animationURL))&&t||(C(n),e.innerHTML="",n.classList.remove(I)),i&&t){var o=(0,v.getAnimation)(t,e,{loadAnimationParams:{autoplay:!0,loop:!1}});(0,w.onAnimationReady)(o,(function(){n.classList.add(I)}));o.addEventListener("complete",(function(){var t;!0===(null==(t=(0,f.getReactionConfig)())?void 0:t.animationShowStaticAfterEnd)&&(n.classList.remove(I),C(n))})),n.__reactionIconAnimation={animationItem:o,animationURL:t}}},h=function(t,e){var n=t.querySelector('[data-section-ref="reactions-button-icon"]');if(n){var i=e.currentOption,r=e.isUserAction;if(i.isReactionSet){var o=i.current,a=null==o?void 0:o.imageMenuURL;n.style.backgroundImage="url('"+a+"')",n.setAttribute("aria-label",null==o?void 0:o.title)}else{var s=i.default;n.style.backgroundImage="",(null==s?void 0:s.title)&&n.setAttribute("aria-label",null==s?void 0:s.title)}n.classList.toggle("PostButtonReactions__icon--custom",i.isReactionSet);var c=i.isReactionSet?i.current.animationURL:void 0,l=function(t){var e=t.querySelector(".PostButtonReactions__iconAnimation");return e||(e=(0,u.se)('<div class="PostButtonReactions__iconAnimation" data-section-ref="reactions-button-icon-animation"></div>'),t.appendChild(e),e)}(n);L(c,l,n,r)}},P=function(t,e,n,i){t.classList.toggle("PostBottomAction--empty",i),t.classList.toggle("PostButtonReactions--icon-active",e),t.classList.toggle("PostButtonReactions--active",e)},k=function(t,e,n,a,s){var u=!(0,c.isReactionIdUnset)(e),l=!s||!(0,c.hasReactionsForCounts)(s),v=function(t,e){var n=(0,c.getDefaultReaction)(t),i=void 0;if((0,c.isReactionIdUnset)(e)){if(n)return{isReactionSet:!1,default:n}}else{if(i=t.itemsById[e])return{isReactionSet:!0,current:i};console.error(new Error("Missing reaction meta for "+e+" in set '"+t.id+"'"))}return{_error:!0}}(n,e);"_error"in v||(h(t,{currentOption:v,isUserAction:a}),function(t,e){var n=e.currentOption,r=n.isReactionSet?n.current.titleColor:void 0,o=n.isReactionSet?n.current.backgroundColor:void 0,a=r?{"--reaction-button-title-color-light":r.light,"--reaction-button-title-color-dark":r.dark}:{"--reaction-button-title-color-light":null,"--reaction-button-title-color-dark":null},s=o?{"--reaction-button-background-color-light":o.light,"--reaction-button-background-color-dark":o.dark}:{"--reaction-button-background-color-light":null,"--reaction-button-background-color-dark":null},c=(0,i.__assign)((0,i.__assign)({},a),s);Object.entries(c).forEach((function(e){var n=(0,i.__read)(e,2),r=n[0],o=n[1];t.style.setProperty(r,o)}))}(t,{currentOption:v}),function(t,e){var n=e.currentOption,i="";i=n.isReactionSet?(0,r.langReplace)((0,d.getLang)("reactions_button_unset_reaction_title")||"",{reaction_name:n.current.title||""}):(0,r.langReplace)((0,d.getLang)("reactions_button_set_reaction_with_name")||"",{reaction_name:n.default.title||""})||(0,d.getLang)("reactions_button_title")||"",t.setAttribute("aria-label",i||"")}(t,{currentOption:v}),(0,o.isCounterEnabledForBtn)(t)||function(t,e){var n=t.querySelector('[data-section-ref="reactions-button-title"]');if(n){var i=e.currentOption,r=i.isReactionSet?i.current.title:i.default.title;r?n.innerText=r:(0,b.isDebugEnabled)()&&console.log("reactions: setReactionNameTitle: missing title",i)}}(t,{currentOption:v})),P(t,u,0,l),a&&function(t,e){t.setAttribute(R,String(e))}(t,Date.now())},B=function(t,e,n,i){var r,a=null===(r=y(t))||void 0===r?void 0:r.counts,s=(0,o.getCounterForTitle)(t,e,i,a);(0,o.isCounterEnabled)(s)&&(function(t,e){var n=t.querySelector('[data-section-ref="reactions-button-title"]');if(n){var i=e.counterForTitle;if((0,o.isCounterAvailable)(i)){var r=i.buttonText;(0,l.animateCount)(n,r,{allowZero:i.allowZeroAnimation,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}else(0,b.isDebugEnabled)()&&console.log("reactions: setReactionTitle: missing title",i)}}(t,{counterForTitle:s}),i&&function(t,e){var n,i=null===(n=(0,g.getClosestLikeBtnContainerElem)(t))||void 0===n?void 0:n.querySelector('[data-section-ref="reactions-button-screen-reader-counter"]');if(i){var r=(0,d.langNumeric)(e,(0,d.getLang)("reactions_n_reacted","raw")||"%s",!0);i.innerText=r}}(t,(0,c.calcCountersSum)(i)))},T=function(t){var e=t.getAttribute(R);if(e&&(0,a.isNumeric)(e))try{return new Date(Number.parseInt(e)).getTime()||void 0}catch(t){return void console.error(t)}};var O=function(t){return(0,c.hasReactionsForCounts)(t)},D=function(t,e){var n=e.counts,i=e.countsPrevious,r=e.objectRaw,o=e.reactionId,a=e.reactionSetId,s=e.styleVariant,u=(0,f.getReactionSet)(a),v=(0,c.calcCounters)(n,u),m=(0,c.calcCountersWeightedSum)(v),w=(0,c.calcCountersSum)(n),b=i?(0,c.calcCountersSum)(i):0,_=(0,g.getPreviewElem)(r);_&&((0,p.renderPreviewItems)(_,n,a,o,s),function(t,e,n,i){var r,o,a=(0,d.langNumeric)(n,(0,d.getLang)("reactions_n_reacted","raw")||"%s",!0);t.setAttribute("aria-label",a);var s=function(t){var e;return null!==(e=t.querySelector('[data-section-ref="like-button-count"]'))&&void 0!==e?e:void 0}(t);if(s){t.tt&&"object"==typeof t.tt&&(t.tt.shown||t.tt.showing||null===(o=null===(r=t.tt)||void 0===r?void 0:r.destroy)||void 0===o||o.call(r));var c=(0,d.langNumeric)(e,"%s",!0);(0,l.animateCount)(s,c,{allowZero:0!==i,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}}(_,m,w,b))},U=function(t,e){var n=(0,g.getLikeBtnElem)(t),i=e.counts;n&&i?function(t,e){var n=y(t);n&&n.objectRaw&&D(0,{counts:e,countsPrevious:n.counts,objectRaw:n.objectRaw,reactionId:n.userReactionId,reactionSetId:n.reactionSetId,styleVariant:n.styleVariant})}(n,i):console.warn("Unable to update object reactions",{objectRaw:t,options:e})},N=function(t,e){var n=e.counts,i=(0,g.getLikeBtnElem)(t);i&&function(t,e){t.setAttribute("data-reaction-counts",JSON.stringify(e))}(i,n)}},509698:(t,e,n)=>{"use strict";n.d(e,{reactionLogError:()=>o});var i=n(956146),r=n(353417),o=function(t){var e,n=t.error,o=(0,r.getReactionConfig)(),a=null!==(e=null==o?void 0:o.reportJsErrors)&&void 0!==e&&e;(0,i.reactionLogError)({error:n,reportError:a})}},423777:(t,e,n)=>{"use strict";n.d(e,{getLikeBtnElem:()=>i,getClosestLikeBtnContainerElem:()=>r,getLikeWrap:()=>o,getMenuMount:()=>a,getPreviewElem:()=>s});var i=function(t){var e;return null!==(e=document.querySelector('[data-section-ref="reactions-button"][data-reaction-target-object="'+t+'"]'))&&void 0!==e?e:void 0},r=function(t){var e;return null!==(e=t.closest('[data-section-ref="reactions-button-container"]'))&&void 0!==e?e:void 0},o=function(t){var e,n=i(t);if(n)return null!==(e=n.closest(".like_wrap"))&&void 0!==e?e:void 0},a=function(t){var e,n;return null!==(n=null===(e=t.closest('[data-section-ref="reactions-button-container"]'))||void 0===e?void 0:e.querySelector('[data-section-ref="reactions-menu-mount"]'))&&void 0!==n?n:null},s=function(t){return document.querySelector('[data-section-ref="reactions-preview-items"][data-reaction-target-object="'+t+'"]')}},353417:(t,e,n)=>{"use strict";n.d(e,{storageAddSets:()=>v,getReactionSet:()=>f,storageSetConfig:()=>g,getReactionConfig:()=>m});var i=n(570655),r=n(358862),o=n(754),a=n(257451),s=n(509698),c=n(431700),u=n(138201),l=(0,a.makeSharedState)("reactions-storage",(function(){return new Map})),d=(0,a.makeSharedState)("reactions-config",(function(){return{config:void 0}})),v=function(t){(0,u.isDebugEnabled)()&&console.log(t),Object.entries(t).forEach((function(t){var e=(0,i.__read)(t,2),n=e[0],a=e[1],u=(0,o.validateReactionSetPayloaditems)(a,n);if(u)(0,s.reactionLogError)({error:u.error});else{var d=a.map((function(t){return(0,i.__assign)((0,i.__assign)({},t),{title:(0,r.decodeHTMLEntities)(t.title)})}));l().set(n,(0,o.prepareReactionMenuSet)(n,d,{imageMenuSize:c.SIZE_MENU,imagePreviewSize:c.SIZE_PREVIEW}))}}))},f=function(t){var e=l().get(t);if(e)return e;var n=new Error("Reaction set not found: "+t);(0,s.reactionLogError)({error:n})},g=function(t){(0,u.isDebugEnabled)()&&console.log(t);var e=(0,o.parseReactionMenuConfig)(t);e?d().config=e:console.warn("Reactions: invalid menu config passed",t)},m=function(){var t;return null===(t=d())||void 0===t?void 0:t.config}},10246:(t,e,n)=>{"use strict";n.d(e,{isValidEnvironment:()=>o,preloadImage:()=>a,usePrevious:()=>s,isValidButtonStyleVariant:()=>u});var i=n(522494),r=n(667294),o=function(){var t,e,n;return"function"==typeof(null===(t=window.cur)||void 0===t?void 0:t.viewAsBox)?(window.cur.viewAsBox(),!1):!(window.vk.widget&&!window.vk.id)||(null===(n=null===(e=window.Widgets)||void 0===e?void 0:e.oauth)||void 0===n||n.call(e),!1)},a=function(t){return new Promise((function(e,n){var i=new Image;i.src=t,i.onload=function(){return e()},i.onerror=function(){return n()}}))},s=function(t){var e=r.useRef(t);return r.useEffect((function(){e.current=t})),e.current},c=Object.values(i.ButtonStyleVariant),u=function(t){return c.includes(t)}},529821:(t,e,n)=>{"use strict";n.d(e,{postRenderReactionsInit:()=>E});var i=n(570655),r=n(414914),o=n(59727),a=n(283767),s=n(138201),c=n(162481),u=n(878012),l=n(423777),d=n(993093),v=n(157420),f=n(95402),g=n(224298),m=n(68482),p=n(353417),w=n(236538),b=function(t,e,n){var i;void 0===n&&(n=null===(i=window.cur)||void 0===i?void 0:i.wallTpl);var a=null==n?void 0:n[t];if(a)return(0,o.stripPercentVars)((0,r.rs)(a,e));console.warn("renderTemplate: missing template '"+t+"'",n)},_=function(t){for(var e=t.isUserAction,n=void 0!==e&&e,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];n?console.error.apply(console,(0,i.__spreadArray)([],(0,i.__read)(r))):(0,s.isDebugEnabled)()&&console.warn.apply(console,(0,i.__spreadArray)([],(0,i.__read)(r)))},R=function(t,e,n){var i,o,a=n.isActionStatusBarVisible,s=n.isReactionsPreviewVisible,c=n.positionTrackingEnd,u=function(t,e){var n,i,o=(0,l.getLikeWrap)(t);if(o){var a=(0,v.getPostElem)(e,o),s=null==a?void 0:a.querySelector('[data-section-ref="post-action-status-bar"]');if(s)return{actionStatusBar:s};var c=(0,m.isWkLayerWallPostOpen)()?null===(n=window.wkcur)||void 0===n?void 0:n.wallTpl:null===(i=window.cur)||void 0===i?void 0:i.wallTpl,u=(0,r.se)(b("post_action_status_bar",{class:"PostActionStatusBar--hidden"},c));if(u)return(0,r.domInsertBefore)(u,o),{actionStatusBar:u}}}(t,e.postFullId);if(u){var d=u.actionStatusBar;if(d.classList.toggle("PostActionStatusBar--hidden",!a),a&&!(0,l.getPreviewElem)(t)){var f=(0,m.isWkLayerWallPostOpen)()?null===(i=window.wkcur)||void 0===i?void 0:i.wallTpl:null===(o=window.cur)||void 0===o?void 0:o.wallTpl;d.prepend((0,r.se)(b("post_reactions_preview",{class:s?"":"ReactionsPreview--empty",object_raw:t},f)))}if(c){var g=(0,l.getLikeBtnElem)(t);null==c||c(g)}}else _({},"Unable to init ActionStatusBar in post",e)},I=function(t){var e=t.counts;if(e){var n=(0,a.likePostObjectId)(t.postFullId),i=(0,v.getPostElem)(t.postFullId,(0,l.getLikeWrap)(n));i||_(t,"Missing post element for reactions preview update",{payload:t,likeWrap:(0,l.getLikeWrap)(n)});var r=(0,l.getLikeBtnElem)(n);if(r)if(!!t.isQueueUpdate&&function(t){var e=(0,c.getLastOwnReactionChangeTime)(t);if(!e)return!1;var n=e+1e4;return Date.now()<n}(r))(0,s.isDebugEnabled)()&&console.log("Ignoring reactions update from queue",t);else{var o=t.previewVisibility;if(function(t,e){return!!(0,u.isPreviewEnabled)(t)||!(0,u.isPreviewDisabled)(t)&&!!(0,u.isPreviewUseCurrent)(t)&&!(0,c.isWithoutPreviewForLikeBtn)(e)}(void 0===o?u.previewVisibilityUseCurrent:o,r)){var f=void 0;t.isPrimaryLikeButtonClick&&!t.isFromWkLayer&&(f=(0,g.preservePositionBetween)(r).start());var m=(0,c.shouldReactionsPreviewBeVisible)(e),b=m;null==i||i.classList.toggle("post--withActionStatusBar",b),R(n,t,{isActionStatusBarVisible:b,isReactionsPreviewVisible:m,positionTrackingEnd:f}),m&&(0,c.updateReactionsPreview)(n,{counts:e})}var I=(0,c.reactionsElemPayload)(r);if(I){var S=I.reactionSetId,E=(0,p.getReactionSet)(S);if((0,d.isReactionsFullUpdatePayload)(t)){var y=t.reactionIdState.reactionId;E&&(0,c.updateReactionButtonForCurrentReaction)(r,y,E,t.isUserAction,e)}E&&(0,c.updateReactionButtonCounts)(r,E,t.isUserAction,e)}if((0,d.isReactionsFullUpdatePayload)(t)){y=t.reactionIdState.reactionId;(0,c.setDataCurrentId)(r,y),t.isUserAction&&(null==I?void 0:I.objectRaw)&&(0,w.emitDataUpdate)(I.objectRaw,{currentReactionId:y})}(0,c.updateReactionsButtonForCounts)(n,{counts:e})}else _(t,"Unable to find reactions button",{likeObjectId:n})}else _(t,"Counts is invalid or missing")},S=function(t){if(!s.ENABLED_IN_POST_REPLY)return!1;var e=t.counts;if(e){var n=(0,a.likeReplyObjectId)(t.replyFullId);(0,c.updateReactionsPreview)(n,{counts:e}),(0,c.updateReactionsButtonForCounts)(n,{counts:e})}},E=function(){var t=[(0,f.registerUniqueListener)("wall-post-action-status-bar",f.WallDataEvents.post_reactions_counts_update,I),(0,f.registerUniqueListener)("wall-reply-reactions-counts",f.WallDataEvents.reply_reactions_counts_update,S)];return{onDestroy:function(){t.forEach((function(t){t()})),t=[]}}}},95402:(t,e,n)=>{"use strict";n.d(e,{WallDataEvents:()=>i.WallDataEvents,registerUniqueListener:()=>i.registerUniqueListener});var i=n(406108)},157420:(t,e,n)=>{"use strict";n.d(e,{getPostElem:()=>i});var i=function(t,e){var n,i;return null!==(i=null!==(n=function(t){var e;if("string"==typeof t)return null!==(e=document.querySelector("#post"+t))&&void 0!==e?e:void 0}(t))&&void 0!==n?n:null==e?void 0:e.closest("._post, .wl_post"))&&void 0!==i?i:void 0}},68482:(t,e,n)=>{"use strict";n.d(e,{isWkLayerWallPostOpen:()=>i});var i=function(){return!!window.cur.wallLayer}}}]);try{stManager.done("dist/155012f0e2f6a2354001adc2a93ffcaf.4c93c56737b4084bc60d.js")}catch(t){}