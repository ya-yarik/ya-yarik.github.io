(()=>{var e,t,a,n={595318:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},750008:e=>{function t(a){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(a)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},337057:(e,t,a)=>{"use strict";a.d(t,{VkIndexer:()=>n});var n=function(){function e(e,t,a){this.delimiter=new RegExp("[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\#\\+\\?\\\\]+","g"),this.trimmer=new RegExp("^[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\+\\?\\\\]+|[\\s\\-,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\\\]+$","g"),this.toTranslit={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1078:"zh",1079:"z",1080:"i",1081:"y",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"ts",1095:"ch",1096:"sh",1097:"sh",1099:"y",1101:"e",1102:"yu",1103:"ya",1105:"e",1098:"",1100:""},this.toLocalCase={f:"a",",":"b","<":"b",d:"v",u:"g",l:"d",t:"e",";":"zh",":":"zh",p:"z",b:"i",q:"y",r:"k",k:"l",v:"m",y:"n",j:"o",g:"p",h:"r",c:"s",n:"t",e:"u",a:"f","[":"h","{":"kh",w:"ts",x:"ch",i:"sh",o:"sh",s:"y","'":"e",'"':"e",".":"yu",">":"yu",z:"ya","`":"e","~":"e",m:"","]":"","}":""},this.toLocalTranslit={1072:"f",1074:"d",1075:"u",1076:"l",1077:"t",1079:"p",1080:"b",1081:"q",1082:"r",1083:"k",1084:"v",1085:"y",1086:"j",1087:"g",1088:"h",1089:"c",1090:"n",1091:"e",1092:"a",1094:"w",1095:"x",1096:"i",1097:"o",1099:"s",1103:"z",1098:"m"},this.list=e||[],this.iterCur=0,this.iterEnd=e?e.length:0,this.index={},this.callback=a||function(){},this.prepareFunc=t||function(e){return e},setTimeout(this.indexIteration.bind(this),10)}return e.prototype.indexIteration=function(){for(var e=Math.min(this.iterEnd,this.iterCur+200),t=this.iterCur;t<e;t++){var a=this.list[t];try{a._order=t}catch(e){}this.add(a)}this.iterCur=t,t>=this.iterEnd?this.callback(this):setTimeout(this.indexIteration.bind(this),10)},e.prototype.strToPrefixes=function(e){for(var t,a={},n=(t=e,t.replace(/&#(\d\d+);/g,(function(e,t){return(t=!0===(a=t)?1:parseInt(a)||0)>=32?String.fromCharCode(t):e;var a})).replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")).toLowerCase().split(this.delimiter),r=n.length;r--;){var i=n[r],o="";if(i){for(var l=0;l<6;l++){var s=i.charCodeAt(l);if(s){var c=this.toTranslit[s],u=i.substr(l,1);o+=null!=c?c:u}}a[o]=1}}return a},e.prototype.strToSearchPrefixes=function(e){for(var t=[],a=e.toLowerCase().split(this.delimiter),n=a.length;n--;){var r={},i=a[n],o="",l="",s="",c=i.length>1;if(i){for(var u=0;u<6;u++){var d=i.charCodeAt(u);if(d){var p=this.toTranslit[d],A=i.substr(u,1);if(o+=null!=p?p:A,c){var _=this.toLocalCase[A],m=this.toLocalTranslit[d];l+=null!=_?_:A,s+=null!=m?m:A}}}r[o]=1,c&&(r[l]=2,r[s]=3),t.push(r)}}return t},e.prototype.toIndexTree=function(e,t){for(var a=this.index,n=0;n<6;n++){var r=e.substr(n,1)||-1;a=a[r]?a[r]:a[r]=5==n?[]:{}}a.push(t)},e.prototype.remove=function(e){var t=this.prepareFunc(e),a=this.strToPrefixes(t);for(var n in a)if(a.hasOwnProperty(n)){for(var r=this.index,i=0;i<6;i++){var o=n.substr(i,1)||-1;if(!r[o])break;r=r[o]}if(r.length)for(var i in r)if(this.equals(r[i],e)){r.splice(i,1);break}}},e.prototype.equals=function(e,t){for(var a in e)if(e.hasOwnProperty(a))switch(typeof e[a]){case"object":if(!this.equals(e[a],t[a]))return!1;break;case"function":if(void 0===e[a]||e[a].toString()!=t[a].toString())return!1;break;default:if(e[a]!=t[a])return!1}for(var a in t)if(void 0===t[a])return!1;return!0},e.prototype.intersect=function(e,t){var a=[];if(r(e[0])||r(t[0]))return e.filter((function(e){return-1!==t.indexOf(e)}));for(;e.length>0&&t.length>0;)if(e[0]._order<t[0]._order)e.shift();else if(e[0]._order>t[0]._order)t.shift();else{if(this.equals(e[0],t[0])){var n=e.shift();n&&a.push(n)}t.shift()}return a},e.prototype.add=function(e){var t=this.prepareFunc(e),a=this.strToPrefixes(t);for(var n in a)a.hasOwnProperty(n)&&this.toIndexTree(n,e)},e.prototype.search=function(e){var t=this.index,a=this.strToSearchPrefixes(e),n=[],r=!1;for(var i in a)if(a.hasOwnProperty(i)){if(r&&!n)break;var o=this.localSearch(a[i],0,t);o.sort((function(e,t){return e._order-t._order})),n=r?this.intersect(n,o):o,r=!0}for(var l=n[0],s=n.length+1,c=[],u=1;u<s;u++){var d=n[u];d!=l&&(c.push(l),l=d)}return c},e.prototype.localSearch=function(e,t,a){if(!a)return[];var n={};for(var r in e)e.hasOwnProperty(r)&&(n[o=r.substr(t,1)||-1]||(n[o]={}),n[o][r]=1);if(6==t++)return a;var i=[];for(var o in n)if("-1"===o)for(var l in a)a.hasOwnProperty(l)&&i.push.apply(i,this.localSearch(n[o],t,a[l]));else{var s=this.localSearch(n[o],t,a[o]);i.push.apply(i,s)}return i},e}();function r(e){return!isNaN(e)}},774351:(e,t,a)=>{"use strict";function n(e,t){return new Promise((function(a){setTimeout(a.bind(null,t),1e3*e)}))}a.d(t,{pause:()=>n})},788822:(e,t,a)=>{"use strict";a.d(t,{decodeHTMLEntities:()=>i,escape:()=>r});var n=[["&amp;","&"],["&lt;","<"],["&gt;",">"],["&quot;",'"']];function r(e){return n.reduce((function(e,t){var a=t[0],n=t[1];return e.replace(new RegExp(n,"ig"),a)}),e)}function i(e){return n.reduce((function(e,t){var a=t[0],n=t[1];return e.replace(new RegExp(a,"ig"),n)}),e).replace(/&#(\d+);/g,(function(e,t){return String.fromCodePoint(t)}))}},389953:(e,t,a)=>{"use strict";function n(e){return e>0&&e<2e9}function r(e){return e>2e9}a.d(t,{isChatPeer:()=>r,isUserPeer:()=>n})},700881:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 12 12",u="cancel_outline_12",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="cancel_outline_12"><path clip-rule="evenodd" d="M9.03 2.97a.75.75 0 010 1.06L7.06 6l1.97 1.97a.75.75 0 01-1.06 1.06L6 7.06 4.03 9.03a.75.75 0 01-1.06-1.06L4.94 6 2.97 4.03a.75.75 0 011.06-1.06L6 4.94l1.97-1.97a.75.75 0 011.06 0z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};A.mountIcon=p;const _=A},297627:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 16 16",u="connection_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="connection_16"><g fill="currentColor"><path d="M12 3a1 1 0 00-1 1v8a1 1 0 102 0V4a1 1 0 00-1-1zM7 6a1 1 0 012 0v6a1 1 0 11-2 0zM3 8a1 1 0 012 0v4a1 1 0 11-2 0z" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},722254:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 16 16",u="microphone_slash_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="microphone_slash_16"><path d="M5.498 7.06v.44a2.501 2.501 0 002.909 2.467l1.2 1.198a4.005 4.005 0 01-5.521-2.822.75.75 0 00-1.47.314A5.508 5.508 0 007.25 12.95v1.301a.75.75 0 001.502 0v-1.3a5.473 5.473 0 001.972-.669l1.25 1.25a.751.751 0 001.062-1.061L3.88 3.32a.75.75 0 10-1.06 1.06l2.678 2.68zm6.356 1.529c-.089.314-.03.66.2.89.37.37.993.284 1.16-.211a5.44 5.44 0 00.17-.61.75.75 0 10-1.469-.315 3.943 3.943 0 01-.061.246zM6.303 2.662c-.332.307-.254.818.066 1.138l3.428 3.424a.4.4 0 00.683-.279l.022-2.445a2.501 2.501 0 00-4.199-1.838z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},607350:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 16 16",u="pin_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin_16"><path d="M10.235 2.106l3.657 3.663c.225.226.064.633-.263.633h-.523a.895.895 0 00-.633.263L10.758 8.38a.896.896 0 00-.262.633v2.996c0 .554-.7.858-1.1.456l-2.301-2.3-3.57 3.57a.893.893 0 11-1.264-1.263L5.83 8.898l-2.29-2.29c-.391-.392-.109-1.102.456-1.102H6.99a.895.895 0 00.633-.262L9.338 3.53a.896.896 0 00.263-.634V2.37c0-.32.403-.495.634-.263z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},86339:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 16 16",u="pin_dot_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin_dot_16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.25 4a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5zm7.642 1.77l-3.657-3.664c-.231-.232-.634-.057-.634.263v.526a.896.896 0 01-.263.634L7.623 5.244a.895.895 0 01-.633.262H3.995c-.565 0-.847.71-.455 1.102l2.29 2.29-3.569 3.574a.894.894 0 001.263 1.264l3.57-3.572 2.301 2.301c.402.402 1.101.098 1.101-.456V9.013a.9.9 0 01.262-.633l1.715-1.715a.895.895 0 01.633-.263h.523c.327 0 .488-.407.263-.633z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};A.mountIcon=p;const _=A},25347:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 24 24",u="door_arrow_left_outline_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="door_arrow_left_outline_24"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.754 20.366c-.763.407-1.512.534-3.082.534H13a.9.9 0 110-1.8h2.672c1.487 0 1.87-.128 2.233-.322.336-.18.594-.437.773-.773.194-.362.322-.746.322-2.233V8.228c0-1.487-.128-1.87-.322-2.233a1.847 1.847 0 00-.773-.774c-.362-.193-.746-.321-2.233-.321H13a.9.9 0 110-1.8h2.672c1.57 0 2.32.127 3.082.534.65.348 1.164.863 1.512 1.512.407.762.534 1.512.534 3.082v7.544c0 1.57-.127 2.32-.534 3.082a3.646 3.646 0 01-1.512 1.512zm-9.39-5.002l2.463-2.464H3.9a.9.9 0 110-1.8h7.927L9.364 8.636a.9.9 0 111.272-1.272l4 4a.9.9 0 010 1.272l-4 4a.9.9 0 11-1.272-1.272z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};A.mountIcon=p;const _=A},573669:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 24 24",u="live_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="live_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M12 22.5C6.201 22.5 1.5 17.799 1.5 12S6.201 1.5 12 1.5 22.5 6.201 22.5 12 17.799 22.5 12 22.5zm0-2a8.5 8.5 0 100-17 8.5 8.5 0 000 17zm0-2a6.5 6.5 0 110-13 6.5 6.5 0 010 13zm0-2a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2a2.5 2.5 0 110-5 2.5 2.5 0 010 5z" fill="currentColor" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};A.mountIcon=p;const _=A},835849:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 28 28",u="download_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="download_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M21 22a1 1 0 110 2H7a1 1 0 010-2h14zM14 2a1 1 0 011 1v13.585l5.293-5.292a1 1 0 011.414 1.414l-7 7a1 1 0 01-1.414 0l-7-7a1 1 0 011.414-1.414L13 16.585V3a1 1 0 011-1z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},196287:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 28 28",u="laptop_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="laptop_outline_28"><path clip-rule="evenodd" d="M8 5h-.151c-.781 0-1.4-.001-1.93.171A3.5 3.5 0 003.67 7.418C3.5 7.95 3.5 8.568 3.5 9.348V19H2.162a1.162 1.162 0 00-.367 2.265l1.466.489c.276.092.415.138.556.17.125.029.253.05.38.062.145.014.29.014.582.014H23.22c.291 0 .437 0 .581-.014.128-.012.256-.033.381-.062.141-.032.28-.078.556-.17l1.466-.49A1.162 1.162 0 0025.838 19H24.5V9.349c0-.781.001-1.4-.171-1.93a3.5 3.5 0 00-2.247-2.248C21.55 5 20.932 5 20.152 5H20zM6.536 7.073C6.724 7.013 6.992 7 8 7h12c1.008 0 1.276.012 1.464.073a1.5 1.5 0 01.963.963c.06.188.073.456.073 1.464V19h-17V9.5c0-1.008.012-1.276.073-1.464a1.5 1.5 0 01.963-.963z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},590439:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 28 28",u="user_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="user_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M17.5 8.5C17.5 6.566 15.934 5 14 5a3.499 3.499 0 00-3.5 3.5c0 1.934 1.566 3.5 3.5 3.5s3.5-1.566 3.5-3.5zm2 0c0 3.039-2.461 5.5-5.5 5.5a5.499 5.499 0 01-5.5-5.5C8.5 5.461 10.961 3 14 3s5.5 2.461 5.5 5.5zM7 20.643c0 .943-.08.857.456.857h13.588c.536 0 .456.086.456-.857 0-2.288-3.304-3.643-7.25-3.643S7 18.355 7 20.643zm-2 0C5 16.763 9.299 15 14.25 15s9.25 1.763 9.25 5.643c0 2.016-.781 2.857-2.456 2.857H7.456C5.78 23.5 5 22.66 5 20.643z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},443774:(e,t,a)=>{"use strict";a.d(t,{default:()=>_});var n=a(667294),r=a(887854),i=a.n(r),o=a(408091),l=a(634777),s=a(379333),c="0 0 29 28",u="videocam_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 28" id="videocam_outline_28"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.857 5h4.286c1.084 0 1.958 0 2.666.058.729.06 1.369.185 1.961.487a5 5 0 012.185 2.185c.231.454.36.936.433 1.464l.437-.284.903-.585c.239-.155.52-.338.773-.471.255-.134.794-.395 1.482-.348a2.7 2.7 0 011.975 1.07c.415.552.49 1.148.516 1.434.026.285.026.62.026.904v6.172c0 .284 0 .619-.026.904-.026.286-.1.882-.516 1.434a2.7 2.7 0 01-1.975 1.07c-.688.047-1.227-.214-1.482-.348a10.407 10.407 0 01-.773-.47l-.905-.588-.435-.282c-.074.528-.202 1.01-.433 1.464a5 5 0 01-2.185 2.185c-.592.302-1.232.428-1.961.487C16.1 23 15.227 23 14.143 23H9.857c-1.084 0-1.958 0-2.666-.058-.728-.06-1.369-.185-1.96-.487a5 5 0 01-2.186-2.185c-.302-.592-.428-1.232-.487-1.961C2.5 17.6 2.5 16.727 2.5 15.643v-3.286c0-1.084 0-1.958.058-2.666.06-.728.185-1.369.487-1.961A5 5 0 015.23 5.545c.592-.302 1.233-.428 1.961-.487C7.9 5 8.773 5 9.857 5zM21.5 15.643v-4.138l2.27-1.472c.563-.365.844-.548 1.077-.532a.7.7 0 01.513.277c.14.187.14.522.14 1.192v6.06c0 .67 0 1.005-.14 1.192a.7.7 0 01-.513.277c-.233.016-.514-.167-1.077-.532l-2.27-1.472v-.852zM7.354 7.05c-.605.05-.953.142-1.216.276a3 3 0 00-1.311 1.311c-.134.263-.226.611-.276 1.216-.05.617-.051 1.41-.051 2.546v3.2c0 1.137 0 1.929.051 2.546.05.605.142.953.276 1.216a3 3 0 001.311 1.311c.263.134.611.226 1.216.276.617.05 1.41.051 2.546.051h4.2c1.137 0 1.929 0 2.546-.051.605-.05.953-.142 1.216-.276a3 3 0 001.311-1.311c.134-.263.226-.611.276-1.216.05-.617.051-1.41.051-2.546v-3.2c0-1.137 0-1.929-.051-2.546-.05-.605-.142-.953-.276-1.216a3 3 0 00-1.311-1.311c-.263-.134-.611-.226-1.216-.276-.617-.049-1.41-.05-2.546-.05H9.9c-1.137 0-1.929 0-2.546.051z" fill="currentColor" /></symbol>'})),d=!0)}var A=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),n.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?29:+e.width,height:isNaN(e.height)?28:+e.height}))};A.mountIcon=p;const _=A},911099:(e,t,a)=>{"use strict";var n=a(595318);t.classNames=function(){for(var e=[],t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return a.forEach((function(t){if(t)switch((0,r.default)(t)){case"string":e.push(t);break;case"object":Object.keys(t).forEach((function(a){t[a]&&e.push(a)}));break;default:e.push("".concat(t))}})),e.join(" ")};var r=n(a(750008))},441143:e=>{"use strict";e.exports=function(e,t,a,n,r,i,o,l){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[a,n,r,i,o,l],u=0;(s=new Error(t.replace(/%s/g,(function(){return c[u++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},366206:(e,t,a)=>{"use strict";var n=a(294757),r=a(933294),i=a(124961),o=a(76238),l=a(41437),s=a(116886),c=a(663527),u=a(621260);if(!window.Calls){var d=new o.ActionStatCollector(new o.ProductionStatCollector),p={getLang:l.getLang,langSex:function(e,t,a){return(0,s.langSex)(e,a)},langNumeric:function(e,t,a,n){return(0,s.langNumeric)(e,a,n)},langShortDateTime:function(e){return(0,s.langDate)(e,(0,l.getLang)("global_short_date_time",!0),0,(0,l.getLang)("months_of"),!0)}},A={onScreenSharingEnabled:null,onScreenSharingDisabled:null,onErrorStartCall:null,onHandCountChanged:null,onSuccessFeedback:function(){(0,u.showDoneBox)((0,l.getLang)("calls_feedback_success"))},onError:null};window.Calls=(0,n.init)({apiWrapper:r.apiWrapper,apiWrapperWithAuth:r.apiWrapperWithAuth,actionStatCollector:d,saveStatlogEvents:i.saveStatlogEvents,langUtils:p,navigateToConvo:function(e){window.nav.go((0,c.getConvoLocation)(e),null,{params:{entrypoint:"calls"}})},callSounds:{end:"/mp3/call_end.mp3",incoming:"/mp3/call_incoming.mp3",outgoing:"/mp3/call_outgoing.mp3",connected:"/mp3/call_connected.mp3",connecting:"/mp3/call_connecting.mp3"},navigateToProfile:function(e,t){!e.target.href&&window.Calls&&(window.Calls.collapseCall(),t&&window.nav.go(t))},eventHandlers:A})}try{window.stManager.done(window.jsc("web/calls.js"))}catch(e){}},820717:(e,t,a)=>{"use strict";a.d(t,{loadFriendsAction:()=>u,loadChatMembersAction:()=>d,loadAllowedToCallGroupMembersAction:()=>p,loadCallPeersWithWaitingImagesAction:()=>A,loadCallPeersWithoutWaitingImagesAction:()=>_,loadActiveCallDataAction:()=>m,loadCallParticipantsAccumulate:()=>v,loadCallUrlLink:()=>f,setActiveCallData:()=>E,startUpcomingStream:()=>C,startCallStream:()=>h,setAnonymousJoin:()=>S,setWaitingHall:()=>T,serverSearchGroupMembers:()=>I});var n=a(570655),r=a(121255),i=a(298811),o=a(329538),l=a(613335),s=a(834735),c=a(464380);function u(e,t,a){if(e.authorizedGroupId)return Promise.resolve();if((0,i.unpackState)(t).friends.length>0)return Promise.resolve();if(e.getFriends){var n=e.getFriends();if(null!==n)return a({type:r.SET_FRIENDS,data:n}),Promise.resolve()}return(0,o.loadFriends)().then((function(e){return e.items.map(l.normalizeUser)})).then((function(e){a({type:r.SET_FRIENDS,data:e})}))}function d(e,t,a,n){return(0,o.loadChatMembers)(a).then((function(a){var o=a.profiles;o&&t({type:r.SET_CHAT_INFO,data:o.map(l.normalizeUser).sort((function(t,a){var n=(0,i.unpackState)(e).me;return t.peerId===n?-1:a.peerId===n?1:0})),conversation:n})}))}function p(e,t,a){return e.authorizedGroupId?t.groupMembers.length>0?Promise.resolve():(0,o.getGroupMembers)(-e.authorizedGroupId,0,r.COUNT_OF_GROUP_MEMBERS_TO_LOAD).then((function(e){var t=e.items,a=e.count,n=[],r=[];return t.forEach((function(e){e.deactivated||(n.push((0,l.normalizeUser)(e)),e.can_call_from_group||r.push(e.id))})),[n,r,a]})).then((function(e){var t=(0,n.__read)(e,3),i=t[0],o=t[1],l=t[2];return a({type:r.SET_GROUP_MEMBERS,groupMembersCount:l,groupMembers:i,unableToCallGroupMembersIds:o}),Promise.resolve()})):Promise.resolve()}function A(e,t,a){return(0,o.retryLoadCallPeers)(a).then((function(e){var a=(0,n.__read)((0,i.convertServerData)(e),3),r=a[0],o=a[1],l=a[2];return E(t,l),(0,s.preloadImagesFromResponse)([r,o])})).then((function(e){var i=(0,n.__read)(e,2),o=i[0],l=i[1];t({type:r.LOAD_PEERS,conversation:o,members:l,peerId:a})}))}function _(e,t,a,l){return(0,o.retryLoadCallPeers)(l).then((function(e){var o=(0,n.__read)((0,i.convertServerData)(e),3),l=o[0],u=o[1],d=o[2];E(t,d),(0,s.preloadImagesFromResponse)([l,u]).catch((function(e){a.eventHandlers.onError&&e&&a.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)})),t({type:r.LOAD_PEERS,conversation:l,members:u})}))}function m(e,t,a){return a?(0,o.loadCallPeers)(a).then((function(e){var a=e.items,r=(0,n.__read)(a,1)[0];E(t,r)})):Promise.resolve()}var g={acc:[],timer:0,tasks:0,timeout:300};function v(e,t,a,u,d,p){var A;(A=g.acc).push.apply(A,(0,n.__spreadArray)([],(0,n.__read)(d))),g.timer&&clearTimeout(g.timer),g.timer=window.setTimeout((function(){var d=g.acc;g.acc=[],function(e,t,a,u,d,p){var A=(0,i.unpackState)(e).me,_=(0,i.unpackState)(e).anonymSecret,m=A<0?A:void 0;return(0,o.getCallParticipants)(u,d,m,A<0,_).then((function(e){var i=e.profiles,o=void 0===i?[]:i,c=e.anonyms,A=void 0===c?[]:c,_=e.secret,m=e.groups,g=void 0===m?[]:m;_&&t({type:r.UPDATE_ANON_SECRET,secret:_});var v=(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(o)),(0,n.__read)(A)),(0,n.__read)(g)),f=d.filter((function(e){return!v.find((function(t){return t&&t.id===e}))}));f.length>0&&a.eventHandlers.onError&&a.eventHandlers.onError(new Error("callId: "+u+", timestamp: "+Date.now()+", cant find in participants: "+f.join(", ")));var E=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(A)),(0,n.__read)(o)).map(l.normalizeUser);(null==g?void 0:g.length)>0&&(E=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(E)),(0,n.__read)(g.map(l.normalizeGroup))));var C=(0,s.preloadImagesFromResponse)([{},E]);return p.awaitImages?C.then((function(){return[null,E]})):[null,E]})).then((function(e){var a=(0,n.__read)(e,2)[1];t({type:r.LOAD_PEERS,members:a})})).catch((function(e){a.eventHandlers.onError&&e&&a.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}(e,t,a,u,d,p).catch((function(e){a.eventHandlers.onError&&e&&a.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}),g.timeout)}function f(e,t,a,n){return void 0===n&&(n=0),(0,o.getCallUrlLink)(t,a,n).then((function(t){var a=t.join_link;return e({type:r.CALL_STATE,callData:{callUrlLink:a}}),a}))}function E(e,t){if(t&&t.call_in_progress){var a=t.unread_count,n=t.last_message_id,i=t.call_in_progress.has_link,o=t.call_in_progress.can_finish_call;e({type:r.CALL_STATE,callData:{canFinishCall:o,hasUrlLink:i}}),(a||n)&&e({type:r.SET_UNREAD_COUNT,chatUnreadCount:a,chatUpToMsgId:n})}}function C(e){return(0,c.startStream)(!1,null,e).catch((function(e){(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function h(e){return(0,o.videoStartStreaming)(e).then((function(e){return(0,c.startStream)(!1,null,e.stream.ov_id)})).catch((function(e){(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function S(e){var t;return(0,c.changeConversationOptions)(((t={})[c.ConversationOption.REQUIRE_AUTH_TO_JOIN]=e,t))}function T(e){var t;return(0,c.changeConversationOptions)(((t={})[c.ConversationOption.WAITING_HALL]=e,t))}function I(e,t,a,i){return void 0===t&&(t=""),(0,o.searchGroupMembers)(e,t).then((function(e){var t=e.items,o=[],s=[];return t&&t.forEach((function(e){e.deactivated||e.id in a.groupMembersCache||(o.push((0,l.normalizeUser)(e)),e.can_call_from_group||s.push(e.id))})),o.length>0&&i({type:r.SET_GROUP_MEMBERS,groupMembersCount:a.groupMembersCount,groupMembers:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(a.groupMembers)),(0,n.__read)(o)),unableToCallGroupMembersIds:(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(a.unableToCallGroupMembersIds)),(0,n.__read)(s))}),o}))}},444083:(e,t,a)=>{"use strict";a.d(t,{onForceCallFinish:()=>i});var n=a(121255),r=a(329538);function i(e,t,a,i){var o=t.callData.callId||"";a({type:n.SHOW_LOADER,isLoaderVisible:!0}),(0,r.forceCallFinish)(o).catch((function(e){console.error(e),a({type:n.ERROR,text:i("calls_error_force_call_finish"),handleType:n.ErrorHandleType.FATAL})})).finally((function(){a({type:n.SHOW_LOADER,isLoaderVisible:!1})}))}},719481:(e,t,a)=>{"use strict";a.d(t,{promoteUserAndRemoveFromWaitingHall:()=>c,removeUserFromWaitingHall:()=>u,clearWaitingList:()=>d,loadWaitingHall:()=>p,loadAdditionalWaitingHall:()=>A,resetWaitingHallNew:()=>_});var n=a(570655),r=a(121255),i=a(613335),o=a(464380),l=a(329538),s=a(834735);function c(e,t,a){var n=(0,i.getExternalIdByUserId)(e);return(0,o.promoteParticipant)(n).then((function(){u(e,t,a)}))}function u(e,t,a){t&&(t.totalCount-=1,t.members.delete(e),a({type:r.SET_WAITING_HALL,data:t}))}function d(e){e({type:r.SET_WAITING_HALL,data:null})}function p(e,t,a,c){return new Promise((function(a){0!==t.length?e>t.length?(0,o.getWaitingHall)(null,e).then((function(e){a(e.participants)})):a(t):a([])})).then((function(t){var r={totalCount:e,members:new Map,hasNew:!1},o=[];if(a.waitingHall){var c=a.waitingHall,u=c.members,d=c.hasNew;r.hasNew=d,t.forEach((function(e){var t=+e.id;if(u.has(t)){var a=u.get(t);a&&r.members.set(t,a)}else o.push(t)}))}else o=t.map((function(e){return+e.id}));if(o.length>0){r.hasNew=!0;var p=a.me,A=a.callData,_=a.anonymSecret,m=A.callId||"",g=p<0,v=g?p:0;return(0,l.getCallParticipantsApiCall)(m,o,g,_,v).then((function(e){var t=e.profiles,a=void 0===t?[]:t,o=e.anonyms,l=void 0===o?[]:o,c=e.groups,u=void 0===c?[]:c,d=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(l)),(0,n.__read)(a)).map(i.normalizeUser);return(null==u?void 0:u.length)>0&&(d=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(d)),(0,n.__read)(u.map(i.normalizeGroup)))),(0,s.preloadImagesFromResponse)([{},d]),d.forEach((function(e){e&&e.peerId&&r.members.set(e.peerId,e)})),r})).catch((function(){return r}))}return r})).then((function(e){e.members&&c({type:r.SET_WAITING_HALL,data:e})}))}function A(e,t,a){var n;if(void 0===a&&(a=!1),a)n=void 0;else{if(!e.waitingHall)return Promise.resolve();if(!((n=e.waitingHall.totalCount)>e.waitingHall.members.size))return Promise.resolve()}return new Promise((function(a){(0,o.getWaitingHall)(null,n).then((function(n){p(n.totalCount,n.participants,e,t).then((function(){a()}))}))}))}function _(e,t){e&&(e.hasNew=!1,t({type:r.SET_WAITING_HALL,data:e}))}},734273:(e,t,a)=>{"use strict";a.d(t,{AdminPinUnmuteRequestModal:()=>i});var n=a(667294),r=a(7692),i=function(e){var t=e.onClose,a=e.actionButtons,i=e.title,o=e.description;return n.createElement(r.default,{className:"AdminPinUnmuteRequestModal",appearance:"blue",title:i,actionButtons:a,onClose:t},n.createElement("div",{className:"AdminPinUnmuteRequestModal__content"},o))}},908651:(e,t,a)=>{"use strict";a.d(t,{AssignAdminModal:()=>i});var n=a(667294),r=a(7692),i=function(e){var t=e.title,a=e.description,i=e.onClose,o=e.actionButtons;return n.createElement(r.default,{className:"AssignAdminModal",appearance:"blue",title:t,actionButtons:o,onClose:i},n.createElement("div",{className:"AssignAdminModal__content"},a))}},853055:(e,t,a)=>{"use strict";a.d(t,{BlurredBackground:()=>i});var n=a(667294),r=a(659397),i=function(e){var t=e.id,a=e.className,i=e.children,o=(0,n.useMemo)((function(){return"radial-gradient(circle, rgb("+(48+Math.abs(t)%3*4)+","+(48+Math.abs(t)%4*5)+","+(52+Math.abs(t)%5*6)+") 40%, #0a0a0a 100%)"}),[]),l=(0,r.classNames)("BlurredBackground",a);return n.createElement("div",{className:l,style:{background:o}},i)}},492512:(e,t,a)=>{"use strict";a.d(t,{Call:()=>P});var n=a(570655),r=a(667294),i=a(309605),o=a(995141),l=a(423197),s=a(826988),c=a(815155),u=a(884609),d=a(747212),p=a(818114),A=a(659397),_=a(156482),m=a(748972),g=a(167903),v=a(172397),f=a(701683),E=a(722959),C=a(641221),h=a(112877),S=a(662208),T=a(498110),I=a(968125),N=a(573669),y=a(343379);function P(e){var t,a,P=e.info,b=e.chatUnreadCount,L=void 0===b?0:b,M=e.callMenuActions,w=e.isAudioAllowed,O=void 0!==w&&w,k=e.isVideoAllowed,D=void 0!==k&&k,R=e.isVideoEnabled,B=void 0!==R&&R,G=e.isAudioEnabled,H=void 0!==G&&G,x=e.isScreenSharingEnabled,U=void 0!==x&&x,V=e.isOratorMode,F=void 0===V||V,W=e.isFullScreen,z=void 0!==W&&W,Q=e.onToggleVideo,j=e.onToggleAudio,Y=e.onLeaveCall,K=e.onCollapseCall,J=e.onToggleOratorMode,q=e.onChat,Z=e.onHandClick,X=e.onToggleScreenShare,$=e.onFullScreenToggle,ee=e.onDeferredStreamStart,te=e.isParticipantControlActive,ae=void 0!==te&&te,ne=e.isLayoutSwitchShown,re=void 0!==ne&&ne,ie=e.isScreenShareControlShown,oe=void 0!==ie&&ie,le=e.isHandRaised,se=void 0!==le&&le,ce=e.isHandControlShown,ue=void 0!==ce&&ce,de=e.isChatControlShown,pe=void 0!==de&&de,Ae=e.isStreamingControlShown,_e=void 0!==Ae&&Ae,me=e.isChainControlShown,ge=void 0===me||me,ve=e.onParticipantsClick,fe=e.onTooltipChange,Ee=e.onHidePanel,Ce=e.notification,he=e.tooltips,Se=e.amISpeaking,Te=void 0!==Se&&Se,Ie=e.onChainClick,Ne=e.waitingHallNotification,ye=e.withoutPadding,Pe=void 0!==ye&&ye,be=e.participantCount,Le=void 0===be?0:be,Me=e.children,we=r.useContext(T.ConfigContext),Oe=we.withAnimation,ke=we.isModalView,De=r.useContext(S.LangContext).getLang,Re=(0,A.classNames)("Call",{"Call--fullscreen":z||!ke}),Be=(0,A.classNames)("Call__content",{"Call__content--withoutPadding":Pe}),Ge=300,He=null===(a=null===(t=window.location)||void 0===t?void 0:t.host)||void 0===a?void 0:a.includes("vk.com"),xe=r.useRef(null),Ue=r.useRef(null),Ve=r.useRef(null),Fe=r.useRef(null),We=(0,n.__read)(r.useState(!1),2),ze=We[0],Qe=We[1],je=(0,n.__read)(function(e,t,a,i,o,l){var s=(0,n.__read)(r.useState(!0),2),c=s[0],u=s[1],d=r.useRef(null),p=r.useRef(!1),_=r.useRef(!1),m=r.useRef(!1);m.current!==l&&(m.current=l);var g=r.useRef(!1),v=function(){p.current||g.current?g.current=!1:(d.current&&window.clearTimeout(d.current),u(!0),_.current||m.current||(d.current=window.setTimeout((function(){u(!1),d.current=null,o&&o()}),5e3)))};return r.useEffect((function(){v();var n=(0,A.throttle)((function(){v()}),1e3),r=function(){_.current=!0},o=function(){_.current=!1};return t.current.addEventListener("mouseenter",r),t.current.addEventListener("mouseleave",o),a.current.addEventListener("mouseenter",r),a.current.addEventListener("mouseleave",o),i.current.addEventListener("mouseenter",r),i.current.addEventListener("mouseleave",o),e.current.addEventListener("mousemove",n),function(){p.current=!0,d.current&&window.clearTimeout(d.current),t.current&&(t.current.removeEventListener("mouseenter",r),t.current.removeEventListener("mouseleave",o)),a.current&&(a.current.removeEventListener("mouseenter",r),a.current.removeEventListener("mouseleave",o)),i.current&&(i.current.removeEventListener("mouseenter",r),i.current.removeEventListener("mouseleave",o)),e.current&&e.current.removeEventListener("mousemove",n)}}),[_,m.current]),[c,function(e){e?u(!0):(u(!1),g.current=!0)}]}(xe,Ue,Ve,Fe,Ee,ze),2),Ye=je[0],Ke=je[1],Je=(0,A.classNames)({"Call__controlPanel--withAnimation":Oe,"Call__controlPanel--hideBottomWithAnimation":Oe,"Call__controlPanel--hideBottom":!Ye}),qe=(0,A.classNames)({"Call__controlPanel--withAnimation":Oe,"Call__controlPanel--hideBottomWithAnimation":Oe,"Call__controlPanel--hideBottom":!Ye},"Call__curtain"),Ze=(0,A.classNames)("Call__buttons",{"Call__controlPanel--withAnimation":Oe,"Call__controlPanel--hideBottomWithAnimation":Oe,"Call__controlPanel--hideBottom":!Ye});return r.createElement("section",{className:Re,onMouseEnter:function(){return Ke(!0)},onMouseLeave:function(){ze||(Ke(!1),he.streaming&&fe("streaming",!1))},ref:xe},P,Ce,r.createElement("div",{className:Be,"data-calls-id":"content"},Me),r.createElement("div",{className:qe}),r.createElement(l.CallIconButtonGroup,{alignX:"l",alignY:"b",className:Je,ref:Ve},r.createElement(r.Fragment,null,pe&&r.createElement(C.TooltipNew,{content:De("calls_chat"),open:he.chat,delay:Ge,onOpen:function(){return fe("chat",!0)},onClose:function(){return fe("chat",!1)}},r.createElement(u.ChatIconButton,{unreadCount:L,onClick:q})),ue&&r.createElement(C.TooltipNew,{content:De(se?"calls_tooltip_lower_hand":"calls_tooltip_raise_hand"),open:he.hand,delay:Ge,onOpen:function(){return fe("hand",!0)},onClose:function(){return fe("hand",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(m.RaiseHandIcon,null),type:"hand",isActive:se,onClick:Z})),oe&&r.createElement(C.TooltipNew,{content:De(U?"calls_stop_screen_share":"calls_start_screen_share"),open:he.screenShare,delay:Ge,onOpen:function(){return fe("screenShare",!0)},onClose:function(){return fe("screenShare",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(_.ShareScreenIcon,null),isActive:U,onClick:X})),_e&&r.createElement(C.TooltipNew,{content:De("calls_call_menu_translation"),open:he.streaming,delay:Ge,onOpen:function(){return fe("streaming",!0)},onClose:function(){return fe("streaming",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(N.default,null),isActive:_e,onClick:ee})))),r.createElement(l.CallIconButtonGroup,{alignX:"r",alignY:"b",style:z&&He?{right:"78px"}:void 0,className:Je,ref:Fe},r.createElement(r.Fragment,null,re&&r.createElement(C.TooltipNew,{content:De(F?"calls_show_grid":"calls_show_orator"),open:he.layout,delay:Ge,onOpen:function(){return fe("layout",!0)},onClose:function(){return fe("layout",!1)}},r.createElement(o.CallIconButton,{type:F?"changeToGrid":"changeToOrator",onClick:J})),M&&r.createElement(E.CallsDropdown,{items:M,open:ze,setOpen:Qe},r.createElement(o.CallIconButton,{type:"settings"})),K&&r.createElement(C.TooltipNew,{content:De("calls_collapse"),open:he.collapse,delay:Ge,onOpen:function(){return fe("collapse",!0)},onClose:function(){return fe("collapse",!1)}},r.createElement(o.CallIconButton,{type:"collapse",onClick:K})),$&&r.createElement(C.TooltipNew,{content:De(z?"calls_tooltip_fullscreen_off":"calls_tooltip_fullscreen_on"),open:he.fullscreen,delay:Ge,onOpen:function(){return fe("fullscreen",!0)},onClose:function(){return fe("fullscreen",!1)}},r.createElement(o.CallIconButton,{onClick:$,icon:z?r.createElement(g.FullScreenOffIcon,null):r.createElement(v.FullScreenIcon,null)})))),r.createElement("footer",{className:"Call__footer",ref:Ue},Ne&&r.createElement("div",{className:"Call__notificationWaitingHall"},Ne),r.createElement("div",{className:Ze},ge&&Ie&&r.createElement(i.CallButton,{type:i.CallButtonTypes.ON,icon:r.createElement(I.ChainIcon,null),onClick:Ie,className:"Call__footerButton"}),ve&&r.createElement(y.ParticipantIconButton,{isParticipantControlActive:ae,onClick:ve,participantCount:Le}),r.createElement(i.CallButton,{type:D?B?i.CallButtonTypes.ON:i.CallButtonTypes.OFF:i.CallButtonTypes.DISABLED,icon:B?r.createElement(s.VideoIcon,null):r.createElement(f.DisabledVideoIcon,null),onClick:Q,className:"Call__footerButton"}),j&&r.createElement(i.CallButton,{type:O?H?i.CallButtonTypes.ON:i.CallButtonTypes.OFF:i.CallButtonTypes.DISABLED,icon:H?Te?r.createElement(h.MicIconWithSpeakingIndicator,null):r.createElement(p.MicIcon,null):r.createElement(d.MutedMicIcon,null),onClick:j,className:"Call__footerButton"}),r.createElement(i.CallButton,{type:i.CallButtonTypes.NEGATIVE,icon:r.createElement(c.EndCallIcon,null),onClick:Y,className:"Call__footerButton"}))))}},309605:(e,t,a)=>{"use strict";a.d(t,{CallButtonTypes:()=>n,CallButton:()=>l});var n,r=a(570655),i=a(667294),o=a(659397);!function(e){e.POSITIVE="positive",e.NEGATIVE="negative",e.REGULAR="regular",e.ON="on",e.OFF="off",e.CLEAR="clear",e.DISABLED="disabled"}(n||(n={}));var l=function(e){var t=e.icon,a=e.text,l=e.type,s=e.className,c=(0,r.__rest)(e,["icon","text","type","className"]),u=(0,o.classNames)("CallButton","CallButton--"+l,s,{"CallButton--withText":!!a},"CallButton--withAnimation"),d=(0,o.classNames)("CallButton__icon","CallButton__icon--withAnimation"),p=(0,r.__assign)((0,r.__assign)({},c),{onMouseDown:function(e){e.preventDefault(),c.onMouseDown&&c.onMouseDown(e)}});return i.createElement("button",(0,r.__assign)({className:u},p,{disabled:l===n.DISABLED}),i.createElement("figure",{className:d},t),a)}},790281:(e,t,a)=>{"use strict";a.d(t,{CallByNameModal:()=>m});var n=a(667294),r=a(138671),i=a(838480),o=a(774415),l=a(662208),s=a(736434),c=a(295886),u=a(670546),d=a(248586),p=a(279060),A=a(750598),_=a(884143),m=function(e){var t=e.items,a=e.actionButtons,m=e.onListItemClick,g=e.selectedId,v=e.onClose,f=e.onSearchChange,E=n.useContext(l.LangContext).getLang;return n.createElement(r.default,{className:"CallByNameModal",onClose:v},n.createElement(i.ModalHeader,{title:E("calls_call_by_name_title"),onClose:v}),n.createElement("div",{className:"CallByNameModal__content"},n.createElement(s.BlockSearchInput,{className:"CallByNameModalList__input",placeholder:E("calls_call_by_name_search_placeholder"),onChange:f,onInput:f,onPaste:f}),n.createElement(c.ListHeader,{extra:t.length||""},E("calls_call_by_name_list_header")),0!==t.length&&n.createElement(u.default,{border:!1,className:"CallByNameModalList__list"},t.map((function(e){return function(e,t){var a=null;return a=t===e.id?n.createElement("span",{className:"CallByNameModalList__selected"},E("calls_call_by_name_selected")):n.createElement("span",{className:"CallByNameModalList__select"},E("calls_call_by_name_select")),n.createElement(A.default,{key:e.id,onClick:function(){return m(e.id)},className:"CallByNameModalList__listItem",aside:a},n.createElement(d.default,{photo:n.createElement(p.CallPhoto,{id:e.id,photo:e.photo,alt:e.name||"",size:"xxxs"}),title:e.name,href:e.link,target:"_blank"}))}(e,g)}))),0===t.length&&n.createElement(_.default,null,E("calls_call_by_name_not_found"))),n.createElement(o.ModalFooter,{actionButtons:a}))}},440896:(e,t,a)=>{"use strict";a.d(t,{CallError:()=>o});var n=a(667294),r=a(7692),i=a(952907),o=function(e){var t=e.title,a=e.onClose,o=e.actionButtons,l=e.text;return n.createElement(r.default,{appearance:"blue",title:t,onClose:a,actionButtons:o,className:"CallError"},n.createElement(i.ErrorPopupText,null,l))}},225652:(e,t,a)=>{"use strict";a.d(t,{CallExitModal:()=>o});var n=a(667294),r=a(7692),i=a(662208),o=function(e){var t=e.onClose,a=e.actionButtons,o=n.useContext(i.LangContext).getLang;return n.createElement(r.default,{onClose:t,title:o("calls_exit_menu"),appearance:"blue",actionButtons:a,className:"CallExitModal"},n.createElement("div",{className:"CallExitModal__text"},o("calls_sure_leave_call")))}},362542:(e,t,a)=>{"use strict";a.d(t,{CallGridNew:()=>i});var n=a(667294),r=a(659397),i=function(e){var t=e.limit,a=e.onScroll,i=e.scrollPosition,o=e.children,l=n.Children.toArray(o),s=Math.min(l.length,t),c=(0,r.classNames)("CallGridNew","CallGridNew--c"+s),u=(0,n.useRef)(null);return(0,n.useEffect)((function(){var e=function(){null!==u.current&&a(u.current.scrollTop)};return null!==u.current&&u.current.addEventListener("scroll",e),function(){u.current&&u.current.removeEventListener("scroll",e)}}),[]),(0,n.useEffect)((function(){var e;null===(e=u.current)||void 0===e||e.scrollTo(0,i)}),[u.current]),n.createElement("section",{className:c,ref:u},n.createElement("div",{className:"CallGridNew__in"},l.map((function(e,t){return n.createElement("article",{className:"CallGridNew__item",key:e.key||t,"data-calls-id":"grid-item"},e)}))))}},503592:(e,t,a)=>{"use strict";a.d(t,{CallHeader:()=>s});var n=a(667294),r=a(659397),i=a(796726),o=a(297627),l=a(838482),s=(0,n.memo)((function(e){var t=e.translation,a=e.speakers,s=e.hands,c=e.time,u=e.network,d=e.networkTooltipText,p=(0,r.classNames)("CallHeader__hands",{"CallHeader__hands--visible":s>0});return n.createElement("div",{className:"CallHeader"},n.createElement("div",{className:"CallHeader__main"},n.createElement("div",{className:"CallHeader__timeAndNetwork"},u<.6&&n.createElement(l.default,{text:d,align:"left",className:"Call__oldTooltip"},n.createElement("div",{className:"CallHeader__network"},n.createElement(o.default,{fill:u<=.3?"#ff5c5c":"#FECE00"}))),c),t&&n.createElement("div",{className:"CallHeader__translation"},t)),n.createElement("div",{className:"CallHeader__aside"},n.createElement("div",{className:"CallHeader__participants"},a),n.createElement("div",{className:p},n.createElement(i.RaisedHandIconXs,null)," ",s)))}))},995141:(e,t,a)=>{"use strict";a.d(t,{CallIconButton:()=>o});var n=a(570655),r=a(667294),i=a(659397),o=(0,r.forwardRef)((function(e,t){var a,o=e.type,l=e.isActive,s=e.icon,c=e.className,u=(0,n.__rest)(e,["type","isActive","icon","className"]),d=(0,i.classNames)("CallIconButton",c,"CallIconButton--withAnimation",((a={"CallIconButton--active":l})["CallIconButton--"+o]=!!o,a)),p=(0,n.__assign)((0,n.__assign)({},u),{onMouseDown:function(e){e.preventDefault(),u.onMouseDown&&u.onMouseDown(e)}});return r.createElement("button",(0,n.__assign)({},p,{className:d,ref:t}),s)}))},423197:(e,t,a)=>{"use strict";a.d(t,{CallIconButtonGroup:()=>o});var n=a(570655),r=a(667294),i=a(659397),o=(0,r.forwardRef)((function(e,t){var a=e.children,o=e.className,l=e.alignX,s=e.alignY,c=e.size,u=void 0===c?"m":c,d=(0,n.__rest)(e,["children","className","alignX","alignY","size"]),p=(0,i.classNames)("CallIconButtonGroup","CallIconButtonGroup--"+l,"CallIconButtonGroup--"+s,"CallIconButtonGroup--size-"+u,o);return r.createElement("div",(0,n.__assign)({className:p,ref:t},d),a)}))},177774:(e,t,a)=>{"use strict";a.d(t,{CallLink:()=>c});var n=a(667294),r=a(595775),i=a(629142),o=a(385177),l=a(880767),s=a(662208),c=function(e){var t=e.link,a=void 0===t?"":t,c=e.isLinkLoading,u=e.isCopied,d=e.hideCopiedText,p=n.useContext(s.LangContext).getLang;return n.createElement("div",{className:"CallLink"},n.createElement("p",{className:"CallLink__info"},p("calls_management_link_info_desc")),c?n.createElement(o.default,{className:"CallLink__input"},n.createElement(l.default,null)):n.createElement("div",{className:"CallLink__input"},n.createElement(r.default,{readOnly:"readonly",value:a}),n.createElement("div",null,n.createElement("div",{className:"CallLink__hint"},p("calls_management_add_warning"),n.createElement(i.default,{className:"CallLink__copied",shown:u,callback:d},p("calls_link_copied"))))))}},562192:(e,t,a)=>{"use strict";a.d(t,{CallLinkSettings:()=>A});var n=a(570655),r=a(667294),i=a(662208),o=a(277256),l=a(750598),s=a(670546),c=a(594504),u=a(560301),d=a(448625),p=a(25347),A=function(e){var t=e.requireAuthToJoin,a=void 0!==t&&t,A=e.onRequireAuthToJoinChanged,_=e.isWaitingHallBlockShown,m=void 0!==_&&_,g=e.isWaitingHallEnabled,v=void 0!==g&&g,f=e.onWaitingHallEnabledChanged,E=(0,r.useContext)(i.LangContext).getLang,C=(0,n.__read)((0,r.useState)(!a),2),h=C[0],S=C[1],T=(0,n.__read)((0,r.useState)(v),2),I=T[0],N=T[1],y=!1,P=(0,r.useCallback)((function(){if(!y){y=!0;var e=!h;S(e),A&&A(!e)}}),[a]),b=!1,L=(0,r.useCallback)((function(){if(!b){b=!0;var e=!I;N(e),f&&f(e)}}),[v]);return r.createElement(s.default,null,m&&r.createElement(u.ListItemWithHint,{onClick:L,canBeHovered:!1,icon:r.createElement(d.ListIcon,{icon:r.createElement(p.default,{width:20,height:20}),color:d.ListIconColors.BLUE}),hint:E("calls_menu_waiting_hall_description"),selectable:!0,aside:r.createElement(o.default,{onChange:L,checked:I})},E("calls_menu_waiting_hall_title")),r.createElement(l.default,{border:!0,canBeHovered:!1,onClick:P,selectable:!0,icon:r.createElement(c.AnonymousIcon,null),aside:r.createElement(o.default,{onChange:P,checked:h})},E("calls_management_link_allow_anonymous")))}},445586:(e,t,a)=>{"use strict";a.d(t,{CallManagementMenu:()=>d});var n=a(667294),r=a(670546),i=a(750598),o=a(448625),l=a(489685),s=a(607691),c=a(662208),u=a(498110),d=function(e){var t=e.isLinkBlockShown,a=e.linkBlockTitle,d=e.onLinkBlockClick,p=e.callUrlLink,A=(0,n.useContext)(u.ConfigContext).allowWaitingHall,_=n.useContext(c.LangContext).getLang;return n.createElement(r.default,null,t&&n.createElement(i.default,{onClick:d,chevron:!0,icon:n.createElement(o.ListIcon,{icon:n.createElement(l.LinkIcon,null),color:o.ListIconColors.GREEN}),aside:A?n.createElement("span",{className:"CallManagementMenu__asideHint"},_("calls_menu_link_setup")):""},a,p&&n.createElement(s.ListCopyControl,{value:p,copyText:_("calls_menu_link_copy"),doneText:_("calls_menu_link_copied")})))}},186983:(e,t,a)=>{"use strict";a.d(t,{CallManagementModal:()=>s});var n=a(667294),r=a(138671),i=a(838480),o=a(774415),l=a(662208),s=function(e){var t=e.title,a=e.onCloseModal,s=e.hint,c=e.actionButtons,u=e.isWithBackButton,d=e.onBackClick,p=e.children,A=n.useContext(l.LangContext).getLang;return n.createElement(r.default,{className:"CallManagementModal",disableBodyScroll:!1,onClose:a},n.createElement(i.ModalHeader,{title:t,onClose:a,backText:u?A("calls_back"):void 0,onBack:d}),n.createElement("div",{className:"CallManagementModal__content"},n.Children.toArray(p).map((function(e,t){return n.createElement("div",{className:"CallManagementModal__section",key:t},e)}))),(c||s)&&n.createElement(o.ModalFooter,{actionButtons:c||[],hint:s}))}},269481:(e,t,a)=>{"use strict";a.d(t,{CallModal:()=>u});var n=a(667294),r=a(50533),i=a(138671),o=a(431469),l=a(121255),s=a(659397),c=a(498110),u=function(e){var t=e.onClose,a=e.onBackdropClick,u=e.isIncoming,d=void 0!==u&&u,p=e.isCautionBoxShown,A=void 0!==p&&p,_=e.children,m=(0,r.useDispatch)(),g=(0,n.useContext)(c.ConfigContext).withAnimation,v=(0,s.classNames)("CallModal",{"CallModal--withAnimation":g});(0,o.usePseudoLayer)();var f=(0,n.useCallback)((function(){return A?void m({type:l.SHOW_CAUTION_BOX,isOpen:!0,isIncoming:d||!1}):t()}),[A]);return n.createElement(i.default,{className:v,disableBodyScroll:!0,onClose:f,onBackdropClick:a},_)}},925082:(e,t,a)=>{"use strict";a.d(t,{CallNotification:()=>i});var n=a(667294),r=a(659397),i=function(e){var t=e.children,a=e.className,i=(0,r.classNames)("CallNotification",a);return n.createElement("div",{className:i},t)}},548237:(e,t,a)=>{"use strict";a.d(t,{CallOrator:()=>i});var n=a(667294),r=a(659397),i=function(e){var t=e.children,a=e.orator,i=e.oratorTitle,o=e.onToggleParticipantsAside,l=e.isShownParticipantsAside,s=e.onScroll,c=e.scrollPosition,u=n.Children.toArray(t),d=(0,r.classNames)({CallOrator__toggleIcon:!0,"CallOrator__toggleIcon--withAnimation":!0}),p=(0,r.classNames)({CallOrator:!0,"CallOrator--withoutOthers":!l}),A=(0,r.classNames)({CallOrator__others:!0,"CallOrator__others--hide":!l}),_=(0,r.classNames)({CallOrator__toggleArrow:!0,"CallOrator__toggleArrow--toLeft":l,"CallOrator__toggleArrow--toRight":!l}),m=(0,n.useRef)(null);return(0,n.useEffect)((function(){var e=function(){null!==m.current&&s(m.current.scrollTop)};return null!==m.current&&m.current.addEventListener("scroll",e),function(){m.current&&m.current.removeEventListener("scroll",e)}}),[]),(0,n.useEffect)((function(){var e;null===(e=m.current)||void 0===e||e.scrollTo(0,c)}),[m.current]),n.createElement("article",{className:p,ref:m},n.createElement("main",{className:"CallOrator__orator"},a),n.createElement("button",{className:"CallOrator__toggleOthers",onClick:o},n.createElement("div",{className:d},n.createElement("div",{className:_}))),n.createElement("aside",{className:A},n.createElement("ul",{className:"CallOrator__list"},u.map((function(e){return n.createElement("li",{className:"CallOrator__participant",key:"key"in e?e.key:void 0,"data-calls-id":"participant"},e)})))),i)}},813245:(e,t,a)=>{"use strict";a.d(t,{CallParticipantList:()=>s});var n=a(667294),r=a(736434),i=a(295886),o=a(670546),l=a(662208),s=function(e){var t=e.searchQuery,a=e.onSearchChange,s=e.length,c=e.children,u=e.waitingHallList,d=n.useContext(l.LangContext).getLang;return n.createElement("div",{className:"CallParticipantList"},n.createElement(r.BlockSearchInput,{value:t,placeholder:d("calls_search_participants_placeholder"),onChange:a,onInput:a,onPaste:a,className:"CallParticipantList__input"}),!!u&&u,n.createElement(i.ListHeader,{extra:s||""},d("calls_participant_list_header")),n.createElement(o.default,{border:!1,className:"CallParticipantList__list"},c))}},279060:(e,t,a)=>{"use strict";a.d(t,{CallPhoto:()=>u});var n=a(667294),r=a(906942),i=a(659397),o=a(121255),l=a(690128),s=a(498110),c=a(697483),u=function(e){var t,a=e.id,u=e.waves,d=void 0!==u&&u,p=e.size,A=void 0===p?"m":p,_=e.photo,m=void 0===_?"":_,g=e.alt,v=e.letter,f=e.showCreatorBadge,E=e.showAdminBadge,C=(0,n.useContext)(s.ConfigContext),h=C.withAnimation,S=C.anonymPhoto,T=(0,c.isParticipantAnonym)(a),I=(0,i.classNames)("CallPhoto__photo","CallPhoto--"+A,{"CallPhoto--waves":h&&!!d}),N=null!=v?v:String.fromCodePoint(null!==(t=g.codePointAt(0))&&void 0!==t?t:32);return!m||m.includes(o.DEFAULT_AVATAR)||T&&!S?n.createElement("div",{className:"CallPhoto"},n.createElement(r.ConversationNoPhoto,{id:Math.abs(a),text:N,size:A,className:I}),f?n.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"creator"}):E?n.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"admin"}):null):n.createElement("div",{className:"CallPhoto"},n.createElement("img",{src:m,className:I,alt:g}),f?n.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"creator"}):E?n.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"admin"}):null)}},471304:(e,t,a)=>{"use strict";a.d(t,{CallSettings:()=>A});var n=a(570655),r=a(667294),i=a(539503),o=a(385177),l=a(662208),s=a(969135),c=a(838482),u=a(121255),d=a(498110),p=a(731585);function A(e){var t=e.cameras,a=e.mics,u=e.noiseCancellationOptions,A=e.videoResolutionOptions,g=e.currentCamId,v=e.currentMicId,f=e.currentNoiseCancellation,E=e.currentVideoResolution,C=e.isCamAvailable,h=void 0!==C&&C,S=e.isMicAvailable,T=void 0!==S&&S,I=e.onCameraChange,N=e.onMicChange,y=e.onNoiseCancellationChange,P=e.onVideoResolutionChange,b=e.pushToTalkEnabled,L=e.onPushToTalkChange,M=r.useContext(l.LangContext).getLang,w=r.useContext(d.ConfigContext).allowPushToTalk,O=(0,r.useRef)(null),k=(0,r.useRef)(null),D=(0,r.useRef)(null),R=(0,r.useRef)(null),B={controls:!1,crossOrigin:"anonymous",playsInline:!0};return m({kind:"video",resolution:E,mediaElRef:O,streamRef:D,deviceId:g,isActive:h}),m({kind:"audio",mediaElRef:k,streamRef:R,deviceId:v,isActive:T}),r.createElement("div",{className:"CallSettings"},r.createElement("div",{className:"CallSettings__camera"},h?r.createElement("video",(0,n.__assign)({ref:O},B,{className:"CallSettings__cameraStream CallSettings__cameraContent"})):r.createElement("div",{className:"CallSettings__cameraStub CallSettings__cameraContent"},M("calls_no_camera"))),T&&r.createElement("audio",(0,n.__assign)({ref:k},B)),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},M("calls_settings_camera")),h?r.createElement(i.default,{options:t.map(_),value:g,onChange:function(e){var t=e.selected;return I(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},M("calls_settings_no_camera"))),h&&r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},M("calls_settings_video_resolution")),r.createElement(i.default,{options:A,value:E,onChange:function(e){var t=e.selected;return P(t.value)},appearance:"secondary",className:"CallSettings__field"})),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},M("calls_settings_mic")),T?r.createElement(i.default,{options:a.map(_),value:v,onChange:function(e){var t=e.selected;return N(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},M("calls_settings_no_mic"))),w&&r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"}),r.createElement(p.default,{className:"CallSettings__field",onChange:L,checked:b},M("calls_settings_push_to_talk_mode_description")),r.createElement(c.default,{className:"CallSettings__tooltip",text:M("calls_settings_push_to_talk_mode_hint"),position:"t",appearance:"light",maxWidth:320},r.createElement(s.default,{className:"CallSettings__hint","aria-label":M("calls_settings_push_to_talk_mode_hint")}))),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},r.createElement("span",{dangerouslySetInnerHTML:{__html:M("calls_settings_noise")}})),T?r.createElement(i.default,{options:u,value:f,onChange:function(e){var t=e.selected;return y(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},M("calls_settings_no_mic")),r.createElement(c.default,{className:"CallSettings__tooltip",text:M("calls_settings_noise_description"),position:"t",appearance:"light",maxWidth:320},r.createElement(s.default,{className:"CallSettings__hint","aria-label":M("calls_settings_noise_description")}))))}function _(e){return{value:e.deviceId,label:e.label}}function m(e){var t=e.kind,a=e.resolution,i=e.mediaElRef,o=e.streamRef,l=e.deviceId,s=e.isActive,c={video:!1,audio:!1},d={deviceId:l};"video"===t&&a&&(d.width={min:428,max:u.VideoWidth[a]||u.VideoWidth.SD,ideal:u.VideoWidth[a]||u.VideoWidth.SD},d.height={min:240,max:u.VideoHeight[a]||u.VideoHeight.SD,ideal:u.VideoHeight[a]||u.VideoHeight.SD}),(0,r.useEffect)((function(){var e;s&&navigator.mediaDevices.getUserMedia((0,n.__assign)((0,n.__assign)({},c),(e={},e[t]=d,e))).then((function(e){var t=o.current;t&&t.getTracks().forEach((function(e){return e.stop()}));var a=i.current;a&&(o.current=e,a.srcObject=e,a.volume=0,a.play())})).catch((function(e){console.error("Error occurred: "+e)}))}),[l,s,a]),(0,r.useEffect)((function(){return function(){var e=o.current;e&&e.getTracks().forEach((function(e){return e.stop()}));var t=i.current;t&&(t.srcObject=null)}}),[])}},555700:(e,t,a)=>{"use strict";a.d(t,{CallSettingsModal:()=>l});var n=a(667294),r=a(7692),i=a(881150),o=a(662208);function l(e){var t=e.onClose,a=e.onSubmit,l=e.children,s=n.useContext(o.LangContext).getLang;return n.createElement(r.default,{onClose:t,title:s("calls_settings"),appearance:"blue",actionButtons:n.createElement(n.Fragment,null,n.createElement(i.default,{onClick:t,appearance:"tertiary"},s("calls_cancel")),n.createElement(i.default,{onClick:a},s("calls_save"))),className:"CallSettingsModal"},l)}},52777:(e,t,a)=>{"use strict";a.d(t,{CallTimer:()=>r});var n=a(667294),r=function(e){var t=e.duration;return n.createElement("div",{className:"CallTimer","aria-label":t,"data-duration":t})}},180474:(e,t,a)=>{"use strict";a.d(t,{CallVideoWidget:()=>p});var n=a(570655),r=a(667294),i=a(423197),o=a(838482),l=a(995141),s=a(952152),c=a(75794),u=a(662208),d=a(464380),p=function(e){var t=e.localVideoStream,a=e.isLocalAudioEnabled,p=e.isLocalAudioAllowed,A=e.isLocalScreenSharing,_=e.participantId,m=e.isMe,g=void 0!==m&&m,v=e.isWithVideo,f=e.isWithAudio,E=e.isScreenSharing,C=e.stream,h=e.photo,S=e.name,T=e.status,I=void 0===T?d.ParticipantStatus.CONNECTED:T,N=e.networkStatus,y=e.onRestoreCall,P=e.onToggleAudio,b=e.children,L=r.useContext(u.LangContext).getLang,M=(0,n.__read)((0,r.useState)(!1),2),w=M[0],O=M[1];(0,r.useEffect)((function(){t||O(!1)}),[t,w]);var k=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),y()}),[y]),D=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),P&&P()}),[P]);return r.createElement("div",{className:"CallVideoWidget",onClick:y},t&&r.createElement(s.Video,{className:"CallVideoWidget__local",stream:t,isMirrored:!A,isContained:!1,isStartWithVisible:!0}),r.createElement(c.Participant,{id:_,hasVideo:v,hasAudio:f,isSharingScreen:E,isMe:g,stream:C,photo:h,name:S,status:I,allowContain:!1,networkStatus:N,photoSize:"s"}),b,r.createElement(i.CallIconButtonGroup,{alignX:"l",alignY:"b",size:"s",className:"CallVideoWidget__buttons"},r.createElement(o.default,{position:"t",align:"left",marginTop:6,text:L(a?"calls_mute":"calls_unmute")},r.createElement(l.CallIconButton,{type:a?"mute":"unmute",onClick:D,disabled:!p}))),r.createElement(i.CallIconButtonGroup,{alignX:"r",alignY:"b",size:"s",className:"CallVideoWidget__buttons"},r.createElement(o.default,{position:"t",align:"right",text:L("calls_restore"),marginTop:6},r.createElement(l.CallIconButton,{type:"restore",onClick:k}))))}},400412:(e,t,a)=>{"use strict";a.d(t,{CallWidget:()=>o});var n=a(667294),r=a(853055),i=a(279060),o=function(e){var t=e.id,a=e.photo,o=e.title,l=e.status,s=e.isIncoming,c=e.onClick,u=e.children;return n.createElement("div",{className:"CallWidget",onClick:c},n.createElement(r.BlurredBackground,{id:t,className:"CallWidget__background"}),n.createElement(i.CallPhoto,{id:t,photo:a,size:"xs",waves:s,alt:o||""}),n.createElement("h1",{className:"CallWidget__name"},o),n.createElement("div",{className:"CallWidget__status"},l),u)}},647686:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var n=a(667294),r=a(659397);function i(e){var t=e.isInverted,a=(0,r.classNames)("CallingStatus",{"CallingStatus--inverted":!!t}),i=(0,r.classNames)("CallingStatus__part","CallingStatus__part--withAnimation");return n.createElement("div",{className:a},n.createElement("span",{className:i}),n.createElement("span",{className:i}),n.createElement("span",{className:i}))}},722959:(e,t,a)=>{"use strict";a.d(t,{CallsDropdown:()=>l});var n=a(570655),r=a(667294),i=a(617841),o=a(659397),l=function(e){var t=e.children,a=e.items,l=e.open,s=void 0!==l&&l,c=e.setOpen,u=(0,r.useRef)(null),d=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),c(!s)}),[s]),p=function(e){u.current&&u.current.contains(e.target)||c(!1)};return(0,r.useEffect)((function(){return s?document.documentElement.addEventListener("click",p,!0):document.documentElement.removeEventListener("click",p,!0),function(){return document.documentElement.removeEventListener("click",p,!0)}}),[s]),s?r.createElement(i.Popper,{content:r.createElement("ul",{className:"CallsDropdown",ref:u},a.map((function(e,t){return r.createElement("li",{className:"CallsDropdown__item",key:e.key||t},function(e,t,a){void 0===a&&(a=!1);var n=(0,o.classNames)("CallsDropdown__button",{"CallsDropdown__button--disabled":a});return"href"in e&&"onClick"in e&&void 0!==e.onClick?r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank",onClick:a?void 0:function(a){a.stopPropagation(),e.onClick(a),t(!1)},className:n},e.text):"href"in e?r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank",onClick:a?void 0:function(e){e.stopPropagation(),t(!1)},className:n},e.text):"onClick"in e?r.createElement("button",{onClick:a?void 0:function(a){a.stopPropagation(),e.onClick(a),t(!1)},className:n},e.text):null}(e,c,e.disabled))}))),mode:"point"},r.cloneElement(t,(0,n.__assign)((0,n.__assign)({},t.props),{onClick:d,"data-active":s}))):r.cloneElement(t,(0,n.__assign)((0,n.__assign)({},t.props),{onClick:d}))}},587551:(e,t,a)=>{"use strict";a.d(t,{CallsMultiSelect:()=>o});var n=a(667294),r=a(167578),i=a(662208),o=function(e){var t=e.tokens,a=e.onRemoveToken,o=e.value,l=e.onChange,s=e.onSelect,c=e.renderSuggest,u=e.data,d=n.useContext(i.LangContext).getLang;return n.createElement(r.default,{className:"CallsMultiSelect",tokens:t,removeTokenPlaceholder:d("calls_remove_token"),onRemoveToken:a,placeholder:d("calls_search_participants_placeholder"),value:o,onChange:l,onSelect:s,useInfiniteScroll:!1,hasMore:!1,virtualized:!1,loadMore:function(){},notFoundText:d("calls_participants_not_found"),autoFocus:!0,isSearching:!1,renderSuggest:c,data:u})}},152205:(e,t,a)=>{"use strict";a.d(t,{CallsSearchResult:()=>d});var n=a(667294),r=a(295886),i=a(750598),o=a(677247),l=a(121255),s=a(956462),c=a(881150),u=a(780573),d=function(e){var t=e.data,a=e.onClick,d=e.selected,p=e.disabled;if("type"in t)switch(t.type){case l.SearchResultType.HEADER:return n.createElement(r.ListHeader,{className:"CallsSearchResult CallsSearchResult--header",extra:t.count},t.text);case l.SearchResultType.CALL_ALL_IN_CHAT:return n.createElement("div",{className:"CallsSearchResult CallsSearchResult--select"},n.createElement(c.default,{appearance:"secondary",wide:!0,onClick:a},n.createElement("span",{className:"CallsSearchResult__icon"},n.createElement(u.PhoneIconS,null)),t.text));case l.SearchResultType.MEMBERS_MORE:case l.SearchResultType.FRIENDS_MORE:case l.SearchResultType.GROUP_MEMBERS_MORE:return n.createElement(s.ListMore,{onClick:a},t.text)}return n.createElement(i.default,{"data-id":t.peerId,onClick:a,selectable:!p},n.createElement(o.ParticipantSuggest,{member:t,selected:d,disabled:p}))}},884609:(e,t,a)=>{"use strict";a.d(t,{ChatIconButton:()=>l});var n=a(570655),r=a(667294),i=a(659397),o=a(498110),l=(0,r.forwardRef)((function(e,t){var a=e.unreadCount,l=void 0===a?0:a,s=(0,n.__rest)(e,["unreadCount"]),c=(0,r.useContext)(o.ConfigContext).withAnimation,u="",d="";switch(!0){case!l:u="none";break;case l<=9:u="single",d=l.toString();break;case l<=99:u="double",d=l.toString();break;case l>99:u="max",d="99+"}var p=(0,i.classNames)("ChatIconButton","ChatIconButton--"+u,{"ChatIconButton--withAnimation":c});return r.createElement("button",(0,n.__assign)({className:p},s,{ref:t}),d&&r.createElement("div",{className:"ChatIconButton__count "},d))}))},275109:(e,t,a)=>{"use strict";a.d(t,{CollapsedCall:()=>o});var n=a(667294),r=a(498110),i=a(659397),o=function(e){var t=e.children,a=(0,n.useContext)(r.ConfigContext).withAnimation,o=(0,i.classNames)("CollapsedCall",{"CollapsedCall--withAnimation":a});return n.createElement("div",{className:o},t)}},952907:(e,t,a)=>{"use strict";a.d(t,{ErrorPopupText:()=>r});var n=a(667294),r=function(e){var t=e.children;return n.createElement("div",{className:"ErrorPopupText"},t)}},25947:(e,t,a)=>{"use strict";a.d(t,{FeedbackScreen:()=>o});var n=a(667294),r=a(662208),i=a(881150),o=function(e){var t=e.title,a=e.children,o=e.sendButtonClick,l=e.skipButtonClick,s=e.sendButtonDisabled,c=void 0===s||s,u=n.useContext(r.LangContext).getLang;return n.createElement("div",{className:"FeedbackScreen"},n.createElement("div",{className:"FeedbackScreen__close",onClick:l}),n.createElement("div",{className:"FeedbackScreen__title"},t),a,n.createElement("div",{className:"FeedbackScreen__actions"},n.createElement(i.default,{appearance:"overlay_secondary",onClick:l},u("calls_feedback_skip")),n.createElement(i.default,{appearance:"overlay_primary",onClick:o,disabled:c},u("calls_feedback_send"))))}},789241:(e,t,a)=>{"use strict";a.d(t,{IncomingCall:()=>u});var n=a(667294),r=a(853055),i=a(279060),o=a(782117),l=a(995141),s=a(838482),c=a(662208);function u(e){var t=e.id,a=e.photo,u=e.title,d=e.description,p=e.onCollapseCall,A=e.children,_=n.useContext(c.LangContext).getLang;return n.createElement("section",{className:"IncomingCall"},n.createElement(r.BlurredBackground,{id:t}),n.createElement(s.default,{position:"b",text:_("calls_collapse"),marginTop:-6},n.createElement(l.CallIconButton,{type:"collapse",className:"IncomingCall__collapse",onClick:p})),n.createElement(o.IncomingCallHeader,{title:u,description:d}),n.createElement(i.CallPhoto,{id:t,waves:!0,photo:a,alt:u||""}),n.createElement("footer",{className:"IncomingCall__footer"},A))}},782117:(e,t,a)=>{"use strict";a.d(t,{IncomingCallHeader:()=>i});var n=a(667294),r=a(659397);function i(e){var t=e.title,a=e.description,i=e.className;return n.createElement("header",{className:(0,r.classNames)("IncomingCallHeader",i)},n.createElement("h1",{className:"IncomingCallHeader__title"},t),n.createElement("div",{className:"IncomingCallHeader__description"},a))}},991989:(e,t,a)=>{"use strict";a.d(t,{JoinHeader:()=>r});var n=a(667294),r=function(e){var t=e.children;return n.createElement("h2",{className:"JoinHeader"},t)}},991390:(e,t,a)=>{"use strict";a.d(t,{JoinScreen:()=>m});var n=a(667294),r=a(991989),i=a(685537),o=a(881150),l=a(168634),s=a(780573),c=a(595775),u=a(659397),d=a(196287),p=a(590439),A=a(670546),_=a(750598),m=function(e){var t=e.isAnonym,a=e.title,m=e.label,g=e.items,v=e.onChangeName,f=e.name,E=e.namePlaceholder,C=e.joinWithVideoText,h=e.joinWithAudioText,S=e.onJoinWithVideo,T=e.onJoinWithAudio,I=e.disabled,N=e.inputDisabled,y=e.callByNameShow,P=e.onCallByNameClick,b=e.onCallViaNativeAppClick,L=e.callViaNativeAppShow,M=e.callByNameTitle,w=e.callViaNativeAppTitle;return n.createElement("div",{className:(0,u.classNames)("JoinScreen",{"JoinScreen--anonym":t})},n.createElement(r.JoinHeader,null,a),n.createElement("div",{className:"JoinScreen__members"},n.createElement(i.AvatarsStack,{items:g}),n.createElement("div",{className:"JoinScreen__membersLabel"},m)),n.createElement("footer",{className:"JoinScreen__footer"},t&&n.createElement(c.default,{onChange:v,className:"JoinScreen__input",value:f,placeholder:E,disabled:N,maxLength:25,onKeyDown:function(e){"Enter"===e.key&&S()}}),n.createElement(o.default,{appearance:"primary",onClick:S,disabled:I,type:"submit"},n.createElement(l.VideoIconS,{className:"JoinScreen__icon"}),n.createElement("span",null,C)),n.createElement(o.default,{appearance:"primary",title:h,"aria-label":h,onClick:T,disabled:I},n.createElement(s.PhoneIconS,{className:"JoinScreen__icon"}))),(y||L)&&n.createElement(A.default,{border:!1,className:"JoinScreen__options"},L&&n.createElement(_.default,{border:!1,selectable:!0,chevron:!0,onClick:b,icon:n.createElement(d.default,{className:"JoinScreen__optionIcon"})},w),y&&n.createElement(_.default,{border:!1,selectable:!0,chevron:!0,onClick:P,icon:n.createElement(p.default,{className:"JoinScreen__optionIcon"})},M)))}},963985:(e,t,a)=>{"use strict";a.d(t,{KickParticipantModal:()=>c});var n=a(570655),r=a(667294),i=a(7692),o=a(662208),l=a(731585),s=a(498110),c=function(e){var t=e.onClose,a=e.actionButtons,c=e.onAllowReconnectChange,u=e.description,d=e.allowBan,p=e.banText,A=(0,r.useContext)(o.LangContext).getLang,_=(0,r.useContext)(s.ConfigContext).allowBanParticipant,m=(0,n.__read)((0,r.useState)(!0),2),g=m[0],v=m[1],f=(0,r.useCallback)((function(e,t){c&&c(t),v(t)}),[]);return r.createElement(i.default,{className:"KickParticipantModal",appearance:"blue",title:A("calls_kick_participant_title"),actionButtons:a,onClose:t,hasScroll:!1},r.createElement("div",{className:"KickParticipantModal__content"},u,_&&d&&r.createElement("div",null,r.createElement(l.default,{className:"KickParticipantModal__checkbox",onChange:f,checked:g},p))))}},560301:(e,t,a)=>{"use strict";a.d(t,{ListItemWithHint:()=>l});var n=a(570655),r=a(667294),i=a(750598),o=a(911099),l=function(e){var t=e.hint,a=e.className,l=e.children,s=(0,n.__rest)(e,["hint","className","children"]),c=!!t,u={"ListItem--withHint":c};return r.createElement(i.default,(0,n.__assign)({},s,{className:(0,o.classNames)(u,a)}),l,c&&r.createElement("div",{className:"ListItem--hint"},t))}},112877:(e,t,a)=>{"use strict";a.d(t,{MicIconWithSpeakingIndicator:()=>i});var n=a(667294),r=a(911099),i=function(){var e=(0,r.classNames)({MicIconWithSpeakingIndicator__scale:!0});return n.createElement("svg",{height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",className:"MicIconWithSpeakingIndicator"},n.createElement("mask",{id:"MicIconWithSpeakingIndicatorMask"},n.createElement("path",{d:"M8 0a4 4 0 00-4 4v5a4 4 0 008 0V4a4 4 0 00-4-4z"})),n.createElement("path",{d:"M1.1 10c-.55 0-.98.49-.84 1.02a8 8 0 006.84 5.93v2.15a.9.9 0 101.8 0v-2.15a8 8 0 006.84-5.93c.14-.53-.29-1.02-.84-1.02-.45 0-.83.33-.95.76a6.2 6.2 0 01-11.9 0c-.12-.43-.5-.76-.95-.76z"}),n.createElement("g",{mask:"url(#MicIconWithSpeakingIndicatorMask)"},n.createElement("g",{className:e},n.createElement("path",{d:"M8 0a4 4 0 00-4 4v7h8V4a4 4 0 00-4-4z"}),n.createElement("path",{d:"M8 7a4 4 0 00-4 4v5a4 4 0 008 0v-5a4 4 0 00-4-4z",className:"MicIconWithSpeakingIndicator__filled"}))))}},467667:(e,t,a)=>{"use strict";a.d(t,{MuteParticipantModal:()=>o});var n=a(667294),r=a(7692),i=a(731585),o=function(e){var t=e.onClose,a=e.onUnmuteToggle,o=e.allowUnmute,l=e.unmuteToggleDisabled,s=e.actionButtons,c=e.title,u=e.description,d=e.toggleSign;return n.createElement(r.default,{className:"MuteParticipantModal",appearance:"blue",title:c,actionButtons:s,onClose:t},n.createElement("div",{className:"MuteParticipantModal__content"},u,n.createElement(i.default,{className:"MuteParticipantModal__checkbox",onChange:a,checked:o,disabled:l},d)))}},170181:(e,t,a)=>{"use strict";a.d(t,{NotificationWithButton:()=>i});var n=a(667294),r=a(659397),i=function(e){var t=e.children,a=e.className,i=(0,r.classNames)("NotificationWithButton",a);return n.createElement("div",{className:i},t)}},242422:(e,t,a)=>{"use strict";a.d(t,{OneToOne:()=>o});var n=a(667294),r=a(659397),i=a(75794),o=function(e){var t=e.id,a=e.name,o=e.letter,l=e.hasAudio,s=e.hasVideo,c=e.isSharingScreen,u=e.stream,d=e.wasConnected,p=e.networkStatus,A=e.opponentId,_=e.opponentHasAudio,m=e.opponentHasVideo,g=e.opponentIsSharingScreen,v=e.opponentStream,f=e.opponentPhoto,E=e.opponentName,C=e.opponentWasConnected,h=e.opponentNetworkStatus,S=(0,r.classNames)("OneToOne",{"OneToOne--hasVideo":s,"OneToOne--opponentHasVideo":m});return n.createElement("div",{className:S},n.createElement("aside",{className:"OneToOne__local"},n.createElement(i.Participant,{id:t,hasVideo:s,hasAudio:l,isSharingScreen:c,stream:u,isMe:!0,name:a,letter:o,photoSize:"m",wasConnected:d,allowContain:!0,networkStatus:p})),n.createElement("main",{className:"OneToOne__remote"},n.createElement(i.Participant,{id:A,hasVideo:m,hasAudio:_,isSharingScreen:g,stream:v,photo:f,name:E,photoSize:"l",allowContain:!0,wasConnected:C,networkStatus:h})))}},766610:(e,t,a)=>{"use strict";a.d(t,{OratorTitle:()=>u});var n=a(667294),r=a(641221),i=a(662208),o=a(297627),l=a(722254),s=a(86339),c=a(607350),u=(0,n.memo)((function(e){var t,a,u,d,p,A=e.orator,_=e.me,m=e.isPinned,g=e.isPinnedByAdmin,v=e.isPinnedByShareScreen,f=e.isUnpinAllowed,E=e.onTooltipChange,C=e.onUnpin,h=e.tooltips,S=(0,n.useContext)(i.LangContext).getLang,T=g||v||m,I=(0,n.useCallback)((function(){E("oratorPin",!1),C()}),[C]),N=(0,n.useCallback)((function(){return E("oratorPin",!0)}),[]),y=(0,n.useCallback)((function(){return E("oratorPin",!1)}),[]),P=(A.wasConnected||A.peerId===_)&&!(null===(t=A.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),b=null===(a=A.mediaSettings)||void 0===a?void 0:a.isScreenSharingEnabled,L=A.shortName||A.name,M=A.shortNameGen||A.shortName||A.name,w=((null===(u=A.mediaSettings)||void 0===u?void 0:u.isAudioEnabled)||(null===(d=A.mediaSettings)||void 0===d?void 0:d.isScreenSharingEnabled)||(null===(p=A.mediaSettings)||void 0===p?void 0:p.isVideoEnabled))&&A.networkStatus<.6,O=n.createElement(n.Fragment,null,w&&n.createElement(o.default,{fill:A.networkStatus<=.3?"#ff5c5c":"#FECE00"}),b&&n.createElement("span",{className:"OratorTitle__additionInfo"},S("calls_orator_screen_sharing")),b?M:L,P&&n.createElement(l.default,null),g&&n.createElement(s.default,null),!g&&(v||m)&&n.createElement(c.default,null));return T?n.createElement(r.TooltipNew,{position:"b",align:"center",content:S(g&&f?"calls_hint_admin_pin_for_admin":g?"calls_hint_admin_pin_for_user":"calls_hint_user_pin"),open:h.oratorPin,delay:300,onOpen:N,onClose:y},n.createElement("button",{className:"OratorTitle OratorTitle--button",onClick:I,disabled:!f},O)):n.createElement("div",{className:"OratorTitle"},O)}))},75794:(e,t,a)=>{"use strict";a.d(t,{Participant:()=>C});var n=a(570655),r=a(667294),i=a(853055),o=a(952152),l=a(659397),s=a(426110),c=a(595285),u=a(830810),d=a(722959),p=a(662208),A=a(711034),_=a(498110),m=a(697483),g=a(122317),v=a(647686),f=a(464380),E=a(297627),C=(0,r.memo)((function(e){var t=e.id,a=e.isVisible,C=void 0===a||a,h=e.isOrator,S=void 0!==h&&h,T=e.isInfoShown,I=e.isPinned,N=e.isPinnedByAdmin,y=e.isHandRaised,P=e.photo,b=e.hasVideo,L=e.hasAudio,M=e.isSharingScreen,w=e.isSpeaking,O=void 0!==w&&w,k=e.stream,D=void 0===k?null:k,R=e.isMe,B=void 0!==R&&R,G=e.photoSize,H=e.name,x=e.letter,U=e.status,V=void 0===U?f.ParticipantStatus.CONNECTED:U,F=e.wasConnected,W=void 0===F||F,z=e.networkStatus,Q=void 0===z?1:z,j=e.onClickParticipant,Y=e.onDblClickParticipant,K=e.onStopScreenShare,J=e.allowContain,q=e.actions,Z=r.useContext(p.LangContext).getLang,X=(0,r.useContext)(_.ConfigContext),$=X.withAnimation,ee=X.anonymPhoto,te=r.useRef(null),ae=(0,m.isParticipantAnonym)(t),ne=!!j||!!Y,re=S&&M&&B,ie=(0,l.classNames)("Participant",{"Participant--isInteractive":ne,"Participant--isPinned":I,"Participant--isSpeaking":O,"Participant--isOrator":S,"Participant--withAnimation":$}),oe=(0,l.classNames)("Participant__more",{"Participant__more--withAnimation":$}),le=(0,n.__read)(r.useState(!1),2),se=le[0],ce=le[1],ue=(0,r.useCallback)((function(e){j&&j(e,Number(t))}),[j]),de=(0,r.useCallback)((function(e){Y&&Y(e,t)}),[Y]);return r.createElement("article",{ref:te,className:ie,onClick:ue,onDoubleClick:de,"participant-id":t},!C&&r.createElement(r.Fragment,null,r.createElement(i.BlurredBackground,{id:t,className:"Participant__main"},r.createElement(s.ParticipantCard,{id:t,photo:!ee&&ae?"":P,photoSize:G,alt:H||"",letter:x,className:T?"Participant__offsetCard":""})),T&&r.createElement("footer",{className:"Participant__footer"},r.createElement("span",{className:"Participant__name"},H),(W||B)&&!L&&r.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"}))),C&&r.createElement(r.Fragment,null,q&&q.length>0&&r.createElement(d.CallsDropdown,{items:q,open:se,setOpen:ce},r.createElement("button",{className:oe,"aria-label":Z("calls_actions")},r.createElement(u.MoreIcon,null))),!(b&&S)&&r.createElement(i.BlurredBackground,{id:t,className:"Participant__main"},r.createElement(s.ParticipantCard,{id:t,photo:!ee&&ae?"":P,photoSize:G,alt:H||"",className:T?"Participant__offsetCard":""})),y&&r.createElement("div",{className:"Participant__handIndicator"},r.createElement(c.RaisedHandContourIcon,{className:"Participant__handIcon"})),re&&r.createElement("div",{className:"Participant__screenSharer"},r.createElement(g.ShareScreenBigIcon,null),r.createElement("div",{className:"Participant__screenSharerText"},Z("calls_you_are_screen_sharer")),r.createElement("button",{className:"Participant__screenSharerButton",onClick:K},Z("calls_screen_share_stop"))),D&&b&&!re&&r.createElement(o.Video,{className:"Participant__main",stream:D,isMirrored:B&&!M,isContained:J||M,isStartWithVisible:B}),V!==f.ParticipantStatus.CONNECTED&&!B&&r.createElement("div",{className:"Participant__status"},r.createElement(v.default,{isInverted:!0})),!S&&T&&r.createElement("footer",{className:"Participant__footer"},(L||D||M)&&Q<.6&&r.createElement(E.default,{fill:Q<=.3?"#ff5c5c":"#FECE00"}),r.createElement("span",{className:"Participant__name"},H),(W||B)&&!L&&r.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"}))),!N&&I&&r.createElement("header",{className:"Participant__header"},r.createElement("div",{className:"Participant__pin"})),N&&r.createElement("header",{className:"Participant__header"},r.createElement(A.PinDotIcon,{className:"Participant__icon"})))}))},426110:(e,t,a)=>{"use strict";a.d(t,{ParticipantCard:()=>l});var n=a(667294),r=a(279060),i=a(884143),o=a(659397),l=function(e){var t=e.id,a=e.photo,l=e.photoSize,s=void 0===l?"m":l,c=e.alt,u=e.letter,d=e.className;return n.createElement(i.default,{className:(0,o.classNames)("ParticipantCard",d)},n.createElement("span",{className:"ParticipantCard__in"},n.createElement(r.CallPhoto,{id:t,photo:a,size:s,alt:c||"",letter:u})))}},343379:(e,t,a)=>{"use strict";a.d(t,{ParticipantIconButton:()=>o});var n=a(667294),r=a(309605),i=a(494549),o=function(e){var t=e.participantCount,a=e.onClick,o=e.isParticipantControlActive,l=n.createElement(i.ParticipantsIcon,null);if(t&&t>0){var s="";(s=t>99?"99+":null==t?void 0:t.toString())&&(l=n.createElement("div",null,n.createElement("div",{className:"ParticipantIconButton__count"},s),l))}return n.createElement(r.CallButton,{type:o?r.CallButtonTypes.OFF:r.CallButtonTypes.ON,icon:l,onClick:a,className:"Call__footerButton"})}},51247:(e,t,a)=>{"use strict";a.d(t,{ParticipantIndicators:()=>d});var n=a(667294),r=a(659397),i=a(838482),o=a(647686),l=a(942775),s=a(135063),c=a(449587),u=a(662208),d=function(e){var t=e.showSpeaking,a=e.showAudioDisabled,d=e.showRaisedHand,p=e.showConnecting,A=e.showRaisedHandTooltip,_=e.onRaisedHandClick,m=(0,n.useContext)(u.LangContext).getLang,g=n.createElement("span",{className:(0,r.classNames)("ParticipantIndicators__item",{"ParticipantIndicators__item--interactive":void 0!==_}),onClick:null!=_?_:void 0},n.createElement(s.RaisedHandIconS,{className:"ParticipantIndicators__hand"}));return n.createElement("span",{className:"ParticipantIndicators"},t&&n.createElement("span",{className:"ParticipantIndicators__item"},n.createElement(c.VolumeMeterAnimation,null)),a&&n.createElement("span",{className:"ParticipantIndicators__item"},n.createElement(l.MutedMicIconS,{className:"ParticipantIndicators__muted"})),d?A?n.createElement(i.default,{className:"ParticipantIndicators__tooltip",text:m("calls_participant_menu_enable_media_request"),position:"t",align:"center",appearance:"light"},g):g:null,p&&n.createElement("span",{className:"ParticipantIndicators__item"},n.createElement(o.default,null)))}},95939:(e,t,a)=>{"use strict";a.d(t,{ParticipantMenu:()=>o});var n=a(667294),r=a(919535),i=a(309739),o=function(e){var t=e.position,a=e.align,o=e.trigger,l=e.marginTop,s=e.marginLeft,c=e.actions;return c.length>0?n.createElement(i.default,{position:t,align:a,trigger:o,marginTop:l,marginLeft:s,className:"ParticipantMenu__dropdown",data:c},n.createElement(r.ListActionsControl,null)):null}},677247:(e,t,a)=>{"use strict";a.d(t,{ParticipantSuggest:()=>o});var n=a(667294),r=a(248586),i=a(659397);function o(e){var t=e.member,a=e.selected,o=void 0!==a&&a,l=e.disabled,s=void 0!==l&&l,c=(0,i.classNames)("ParticipantSuggest",{"ParticipantSuggest--selected":o,"ParticipantSuggest--disabled":s});return n.createElement("div",{className:c,"data-id":t.id},n.createElement(r.default,{size:"34",title:t.name,photo:t.photo}))}},338374:(e,t,a)=>{"use strict";a.d(t,{TransferAdminRightsModal:()=>g});var n=a(667294),r=a(50533),i=a(881150),o=a(138671),l=a(838480),s=a(774415),c=a(662208),u=a(670546),d=a(295886),p=a(750598),A=a(248586),_=a(595775),m=a(884143),g=function(e){var t=e.participants,a=e.selected,g=e.onSelect,v=e.onClose,f=e.onCallForceFinish,E=e.onRightsTransfer,C=e.onSearch,h=(0,n.useContext)(c.LangContext).getLang,S=(0,r.useSelector)((function(e){return e.me}));return n.createElement(o.default,{className:"TransferAdminRightsModal",disableBodyScroll:!1,onClose:v},n.createElement(l.ModalHeader,{title:h("calls_dialog_creator_exit_title"),onClose:v}),n.createElement("div",{className:"TransferAdminRightsModal__content"},n.createElement(_.default,{onChange:function(e){return C(e.target.value)},placeholder:h("calls_search_participants_placeholder"),className:"TransferAdminRightsModal__searchInput"}),n.createElement(u.default,{border:!1},n.createElement(d.ListHeader,{extra:t.length},h("calls_call_participants")),0===t.filter((function(e){return e.peerId!==S})).length&&n.createElement(m.default,null,h("calls_participants_not_found")),t.filter((function(e){return e.peerId!==S})).map((function(e){return n.createElement(p.default,{key:e.peerId,className:"TransferAdminRightsModal__item",onClick:function(){return g(a!==e.peerId?e:null)},aside:n.createElement("span",{className:"TransferAdminRightsModal__label","aria-selected":a===e.peerId},a===e.peerId?h("calls_dialog_creator_exit_selected"):h("calls_dialog_creator_exit_select"))},n.createElement(A.default,{size:"34",title:e.name,photo:e.photo}))})))),n.createElement(s.ModalFooter,{actionButtons:[n.createElement(i.default,{key:"force",appearance:"secondary",onClick:f},h("calls_force_call_finish")),n.createElement(i.default,{key:"action",onClick:E},h(null===a?"calls_leave_call":"calls_dialog_creator_exit_action"))]}))}},958713:(e,t,a)=>{"use strict";a.d(t,{TranslationCreateForm:()=>S});var n,r,i=a(570655),o=a(667294),l=a(595775),s=a(244809),c=a(662208),u=a(942019),d=a(750598),p=a(448625),A=a(670546),_=a(539503),m=a(823694),g=a(449608),v=a(329538),f=a(326542),E=a(874023),C=a(613335),h=a(50533);function S(e){var t=e.onSubmit,a=e.onClose,S=(0,o.useContext)(c.LangContext),T=S.getLang,I=S.langShortDateTime,N=(0,h.useSelector)((function(e){return e})),y=function(){var e=(new Date).toISOString().split("T")[0];return T("calls_translation_title_default_value").replace("%s",e)},P=function(e,t,a){return void 0===t&&(t=""),void 0===a&&(a=""),{id:e,name:t,photo:a,isGroup:e<0}},b=function(e){var t=[{value:n.ONLY_ME,label:T("calls_translation_privacy_only_me_and_chat")},{value:n.FRIENDS,label:T("calls_translation_privacy_friends_and_chat")}];return e&&t.push({value:n.ALL,label:T("calls_translation_privacy_all_users")}),t},L=(0,C.getMe)(N),M=N.config,w=(0,i.__read)((0,o.useState)(y()),2),O=w[0],k=w[1],D=(0,i.__read)((0,o.useState)(""),2),R=D[0],B=D[1],G=(0,i.__read)((0,o.useState)(N.groupId?n.ALL:n.ONLY_ME),2),H=G[0],x=G[1],U=(0,i.__read)((0,o.useState)((function(){return b(!L.isClosed||!!N.groupId)})),2),V=U[0],F=U[1],W=(0,i.__read)((0,o.useState)((function(){var e,t;return N.groupId?P(N.groupId,null===(e=N.meGroup)||void 0===e?void 0:e.name,null===(t=N.meGroup)||void 0===t?void 0:t.photo):P(L.peerId,L.name,L.photo)})),2),z=W[0],Q=W[1],j=(0,i.__read)((0,o.useState)(r.MAIN),2),Y=j[0],K=j[1],J=(0,i.__read)((0,o.useState)({}),2),q=J[0],Z=J[1],X=(0,i.__read)((0,o.useState)((function(){return N.groupId&&N.meGroup?[{value:N.meGroup.peerId,label:N.meGroup.name}]:[{value:L.peerId,label:L.name}]})),2),$=X[0],ee=X[1],te=(0,i.__read)((0,o.useState)([]),2),ae=te[0],ne=te[1],re=(0,i.__read)((0,o.useState)(!1),2),ie=re[0],oe=re[1],le=(0,i.__read)((0,o.useState)([]),2),se=le[0],ce=le[1],ue=(0,i.__read)((0,o.useState)([]),2),de=ue[0],pe=ue[1],Ae=(0,o.useCallback)((function(){var e=O.trim(),a=R.trim(),n={};if(Object.keys(q).length>0){e||(e=q.title),a||(a=q.description);var r=a!=q.title||e!=q.description;r||(r=z.id>0&&q.privacy_view.category!=H),r&&(0,v.sendVideoEdit)(z.id,q.id,e,a,H).catch((function(e){return console.error(e)}));var i={ovId:q.ov_id};q.live_start_time&&(i.startTime=q.live_start_time),n.upcomingStreamParams=i}else n.streamParams={name:e||y(),description:a,privacy_view:H,group_id:z.id<0?-z.id:0,call:!0};t(n)}),[O,R,H,z,q]);(0,o.useEffect)((function(){N.groupId||(0,v.loadUserAdminedGroupsAction)(M.sferum).then((function(e){var t=(0,i.__spreadArray)([],(0,i.__read)($));e.count>0&&(e.items.forEach((function(e){e.can_upload_video&&t.push({value:-e.id,label:e.name})})),ee(t),ne(e.items))})).catch((function(e){return console.error(e)}))}),[]),(0,o.useEffect)((function(){Z({}),oe(!1),ce([]),(0,v.getUpcomingLives)([z.id]).then((function(e){var t=[];e.count>0&&(t=e.items.filter((function(e){return""!==e.ov_id})));var a=t.length>0;if(oe(a),ce(t),a){var n=[];t.forEach((function(e){e.owner_id&&e.owner_id>0&&n.push(e.owner_id.toString())})),n&&(0,v.loadUsers)({user_ids:n.join(",")}).then((function(e){var t=[];e.forEach((function(e){t.push({id:e.id,name:e.first_name+" "+e.last_name})})),pe(t)})).catch((function(e){return console.error(e)}))}})).catch((function(e){return console.error(e)}))}),[z]);var _e=function(e){var t=e.date;e.live_start_time&&(t=e.live_start_time);var a=t-Date.now()/1e3;return a>0&&a<E.WEEK?T("calls_translation_date_label_soon"):""};return o.createElement(o.Fragment,null,Y===r.MAIN&&o.createElement(u.TranslationCreateModal,{onClose:a,onSubmit:Ae,title:T("calls_translation_box_title")},o.createElement("div",{className:"TranslationCreateForm__link"},o.createElement(A.default,null,$.length>0&&o.createElement(d.default,{border:!0,canBeHovered:!1,selectable:!1,icon:o.createElement(p.ListIcon,{icon:o.createElement("img",{className:"TranslationCreateForm__ownerIcon",src:z.photo,alt:z.name}),color:p.ListIconColors.GRAY}),aside:o.createElement(_.default,{className:"TranslationCreateFormOptions__longselect",options:$,value:z.id,onChange:function(e){var t=e.selected.value;t<0?ae.forEach((function(e){e.id==-t&&(x(n.ALL),F(b(!0)),Q(P(-e.id,e.name,e.photo_100)))})):(F(b(!L.isClosed)),x(n.ONLY_ME),Q(P(L.peerId,L.name,L.photo)))},disabled:$.length<=1})},T("calls_translation_owner_title")),ie&&o.createElement(d.default,{onClick:function(){ie&&K(r.SELECT_POSTPONE)},chevron:!0,border:!0,icon:o.createElement(p.ListIcon,{icon:o.createElement(g.TimeIcon,null),color:p.ListIconColors.GREEN})},T("calls_translation_postponed_title"),Object.keys(q).length>0&&o.createElement("div",{className:"TranslationCreateForm__copyControl"},o.createElement(f.default,{className:"TranslationCreateForm__copyButton",onClick:function(e){e.preventDefault(),e.stopPropagation(),Z({}),k(y()),B("")}},T("calls_translation_postponed_reset")))),!M.sferum&&o.createElement(d.default,{border:!1,canBeHovered:!1,selectable:!1,icon:o.createElement(p.ListIcon,{icon:o.createElement(m.PrivacyIcon,null),color:p.ListIconColors.GRAY}),aside:o.createElement(_.default,{className:"TranslationCreateForm__privacySelector TranslationCreateFormOptions__longselect",disabled:z.isGroup,options:V,value:H,onChange:function(e){x(e.selected.value)}})},T("calls_translation_who_can_see_video_privacy"))),o.createElement("div",{className:"TranslationCreateForm__privacyHint"},T("calls_translation_who_can_see_video_privacy_hint"))),o.createElement("form",{className:"TranslationCreateForm__main",onSubmit:Ae},o.createElement("div",{className:"TranslationCreateForm__section"},o.createElement("div",{className:"TranslationCreateForm__block"},o.createElement("label",{className:"TranslationCreateForm__label"},T("calls_translation_title"),o.createElement(l.default,{className:"TranslationCreateForm__field",value:O,onChange:function(e){var t=e.target;k(t.value)},placeholder:T("calls_translation_name_placeholder")}))),o.createElement("div",{className:"TranslationCreateForm__block"},o.createElement("label",{className:"TranslationCreateForm__label"},T("calls_translation_description"),o.createElement(s.default,{className:"TranslationCreateForm__field",placeholder:T("calls_translation_description_placeholder"),value:R,onChange:function(e){var t=e.target;B(t.value)}})))),o.createElement("div",{className:"TranslationCreateForm__tabSection"},o.createElement("div",{className:"TranslationCreateForm__warning"},T("calls_translation_notification_warning"))))),Y===r.SELECT_POSTPONE&&o.createElement(u.TranslationCreateModal,{title:T("calls_translation_select_upcoming_box_title"),isWithBackButton:!0,onBackClick:function(){return K(r.MAIN)},onClose:a,contentClassName:"TranslationCreateForm__modalVideo"},o.createElement("div",null,se.length>0&&o.createElement(A.default,{className:"TranslationCreateForm__VideoList"},se.map((function(e,t){return o.createElement(d.default,{className:"TranslationCreateForm__videoItem",active:e.id===q,key:t,border:!0,canBeHovered:!0,selectable:!0,onClick:function(){return(t=e).owner_id>0&&(0,v.getVideos)(t.owner_id,[t.owner_id+"_"+t.id],!0).then((function(e){if(e.count>0){var a=e.items.filter((function(e){return e.id==t.id}));a.length>0&&(t.privacy_view=a[0].privacy_view,Z(t),t.privacy_view&&x(t.privacy_view.category))}})),Z(t),K(r.MAIN),k(t.title),void B(t.description);var t},aside:o.createElement("span",{className:"TranslationCreateForm__videoLink"},T("calls_translation_select_video_link"))},o.createElement("div",{className:"TranslationCreateForm__videoImagePreview"},o.createElement("img",{className:"TranslationCreateForm__videoImage",src:e.image&&e.image[0]&&e.image[0].url?e.image[0].url:"",alt:e.title}),_e(e)&&o.createElement("span",{className:"TranslationCreateForm__videoImageLabel"},_e(e))),o.createElement("div",{className:"TranslationCreateForm__videoDescription"},o.createElement("div",{className:"TranslationCreateForm__videoTitle"},e.title),o.createElement("div",{className:"TranslationCreateForm__videoOwner"},function(e){if(!(e>0))return z.name;var t=de.filter((function(t){return t.id==e}));if(t.length>0){var a=t[0];if(a)return a.name}return""}(e.owner_id)),o.createElement("div",{className:"TranslationCreateForm__videoDate"},(n=(a=e).date,a.live_start_time&&(n=a.live_start_time),I(1e3*n)))));var a,n}))))))}!function(e){e.ONLY_ME="only_me",e.FRIENDS="friends",e.ALL="all"}(n||(n={})),function(e){e[e.MAIN=0]="MAIN",e[e.SELECT_POSTPONE=1]="SELECT_POSTPONE"}(r||(r={}))},942019:(e,t,a)=>{"use strict";a.d(t,{TranslationCreateModal:()=>c});var n=a(667294),r=a(881150),i=a(662208),o=a(138671),l=a(838480),s=a(774415);function c(e){var t=e.onClose,a=e.onSubmit,c=e.title,u=e.children,d=e.isWithBackButton,p=e.onBackClick,A=e.contentClassName,_=void 0===A?"TranslationCreateModal__content":A,m=n.useContext(i.LangContext).getLang,g=a&&t;return n.createElement(o.default,{disableBodyScroll:!0,onClose:t,className:"TranslationCreateModal",hasScroll:!1},n.createElement(l.ModalHeader,{title:c,onClose:t,backText:d?m("calls_back"):void 0,onBack:p}),n.createElement("div",{className:_},u),g&&n.createElement(s.ModalFooter,{actionButtons:n.createElement(n.Fragment,null,n.createElement(r.default,{onClick:t,appearance:"tertiary"},m("calls_cancel")),n.createElement(r.default,{onClick:a},m("calls_translation_start")))}))}},162144:(e,t,a)=>{"use strict";a.d(t,{TranslationLink:()=>u});var n=a(570655),r=a(667294),i=a(595775),o=a(881150),l=a(629142),s=a(58600),c=a(662208),u=function(e){var t=e.link,a=r.useContext(c.LangContext).getLang,u=(0,n.__read)((0,r.useState)(!1),2),d=u[0],p=u[1],A=(0,r.useCallback)((function(){return p(!0)}),[]),_=(0,r.useCallback)((function(){return p(!1)}),[]);return r.createElement("div",{className:"TranslationLink"},r.createElement("p",{className:"TranslationLink__info"},a("calls_translation_link_info")),r.createElement(i.default,{readOnly:"readonly",className:"TranslationLink__input",value:t}),t&&r.createElement(s.CopyText,{text:t,onCopyDone:A},r.createElement(o.default,null,a("calls_translation_link_copy"))),r.createElement(l.default,{className:"TranslationLink__copied",shown:d,callback:_},a("calls_translation_link_copied")))}},979414:(e,t,a)=>{"use strict";a.d(t,{TranslationStartCountdownModal:()=>l});var n=a(667294),r=a(138671),i=a(662208),o=a(881150),l=function(e){var t=e.onCloseModal,a=e.counter,l=e.onStopTranslation,s=n.useContext(i.LangContext).getLang;return n.createElement(r.default,{disableBackdropClick:!0,disableEscapeClose:!0,className:"TranslationStartCountdownModal",onClose:t},n.createElement("div",{className:"TranslationStartCountdownModal__content"},n.createElement("div",{className:"TranslationStartCountdownModal__counter"},a),n.createElement(o.default,{className:"TranslationStartCountdownModal__stop",onClick:l,appearance:"overlay_secondary"},s("calls_translation_cancel_button"))))}},880076:(e,t,a)=>{"use strict";a.d(t,{TranslationStatus:()=>u});var n=a(667294),r=a(801513),i=a(30933),o=a(659397),l=a(309739),s=a(607910),c=a(641221),u=function(e){var t=e.translationTimer,a=e.viewersCount,u=void 0===a?0:a,d=e.isLiveIndicatorOff,p=void 0!==d&&d,A=e.actions,_=void 0===A?[]:A,m=e.tooltipText,g=void 0===m?"":m,v=(0,o.classNames)("TranslationStatus__translationIndicator",{"TranslationStatus__translationIndicator--disabled":p}),f=(null==_?void 0:_.length)>0,E=(0,o.classNames)("TranslationStatus__translationTimer",{"TranslationStatus__translationTimer--hasIndicator":!p}),C=n.createElement("div",{className:"TranslationStatus__translation",key:"translation"},n.createElement(r.LiveIcon,{className:v}),n.createElement(n.Fragment,null,!!t&&n.createElement("div",{className:E},t),!p&&n.createElement("div",{className:"TranslationStatus__translationViewersCount"},n.createElement(i.ViewersCountIcon,null),n.createElement("div",{className:"TranslationStatus__translationViewersCountNumber"},u)),f&&n.createElement("div",{className:"TranslationStatus__translationDropdown"},n.createElement(s.TranslationStatusChevronIcon,null))));return f?C=n.createElement(l.default,{position:"b",align:"center",horizontalPosition:"right",trigger:"hover",marginLeft:-10,data:_,className:"TranslationStatus_dropdown"},C):g&&(C=n.createElement(c.TooltipNew,{content:n.createElement(n.Fragment,null,g)},C)),n.createElement("div",{className:"TranslationStatus"},C)}},389809:(e,t,a)=>{"use strict";a.d(t,{TranslationStopModal:()=>o});var n=a(667294),r=a(7692),i=a(662208),o=function(e){var t=e.onClose,a=e.actionButtons,o=n.useContext(i.LangContext).getLang;return n.createElement(r.default,{onClose:t,title:o("calls_translation_stop_confirmation"),appearance:"blue",actionButtons:a,className:"TranslationStopModal"},n.createElement("div",{className:"TranslationStopModal__text"},o("calls_translation_stop_sure")))}},904992:(e,t,a)=>{"use strict";a.d(t,{UnbanMembersModal:()=>l});var n=a(667294),r=a(7692),i=a(662208),o=a(685537),l=function(e){var t=e.onClose,a=e.actionButtons,l=e.description,s=e.subDescription,c=e.avatarsItems,u=(0,n.useContext)(i.LangContext).getLang;return n.createElement(r.default,{className:"UnbanMembersModal",appearance:"blue",title:u("calls_unban_participant_title"),actionButtons:a,onClose:t,hasScroll:!1},n.createElement("div",{className:"UnbanMembersModal__content"},n.createElement(o.AvatarsStack,{items:c}),n.createElement("div",{className:"UnbanMembersModal__description"},l),n.createElement("div",{className:"UnbanMembersModal__subDescription"},s)))}},860925:(e,t,a)=>{"use strict";a.d(t,{UnmuteRequestModal:()=>i});var n=a(667294),r=a(7692),i=function(e){var t=e.onClose,a=e.actionButtons,i=e.title,o=e.description;return n.createElement(r.default,{className:"UnmuteRequestModal",appearance:"blue",title:i,actionButtons:a,onClose:t},n.createElement("div",{className:"UnmuteRequestModal__content"},o))}},690128:(e,t,a)=>{"use strict";a.d(t,{UserBadge:()=>o});var n=a(667294),r=a(659397),i=a(995811),o=function(e){var t=e.className,a=e.type;return n.createElement("div",{className:(0,r.classNames)("UserBadge","UserBadge--"+a,t)},n.createElement(i.StarIcon,null))}},952152:(e,t,a)=>{"use strict";a.d(t,{Video:()=>l});var n=a(667294),r=a(659397),i=a(604233),o=new WeakMap,l=(0,n.memo)((function(e){var t=e.stream,a=e.isMirrored,l=void 0!==a&&a,s=e.isContained,c=void 0!==s&&s,u=e.isStartWithVisible,d=void 0!==u&&u,p=e.className,A=n.useRef(null),_=n.useRef(null),m=n.useRef(t);return n.useEffect((function(){var e,a,n,s;if(!(null===(e=A.current)||void 0===e?void 0:e.lastElementChild)||m.current!==t){var u=d;if(t&&(o.has(t)?null===(null===(a=o.get(t))||void 0===a?void 0:a.closest("body"))?(_.current=null!==(n=o.get(t))&&void 0!==n?n:null,u=!0):_.current=(0,i.createVideoTag)(t):(_.current=(0,i.createVideoTag)(t),o.set(t,_.current))),_.current&&A.current&&A.current.lastElementChild!==_.current){var p=(0,r.classNames)("Video",{"Video--contain":c,"Video--mirrored":l,"Video--visible":u||(null===(s=_.current)||void 0===s?void 0:s.classList.contains("Video--visible"))});A.current.lastElementChild&&(A.current.innerHTML=""),_.current.className=p,A.current.appendChild(_.current),_.current.play()}return function(){_.current&&_.current!==o.get(t)&&(_.current.srcObject=null,_.current.src="",_.current.pause(),_.current.removeAttribute("src"),_.current.load()),A.current&&(A.current.innerHTML="")}}}),[t,A.current]),n.createElement("div",{ref:A,className:p})}))},449587:(e,t,a)=>{"use strict";a.d(t,{VolumeMeterAnimation:()=>i});var n=a(667294),r=a(911099),i=function(){var e=(0,r.classNames)("VolumeMeterAnimation","VolumeMeterAnimation--withAnimation");return n.createElement("div",{className:e})}},100741:(e,t,a)=>{"use strict";a.d(t,{WaitingHall:()=>i});var n=a(667294),r=a(75794),i=function(e){var t=e.id,a=e.name,i=e.letter,o=e.hasAudio,l=e.hasVideo,s=e.stream,c=e.wasConnected;return n.createElement("div",{className:"WaitingHall"},n.createElement("main",{className:"WaitingHall__main"},n.createElement(r.Participant,{id:t,hasVideo:l,hasAudio:o,isSharingScreen:!1,stream:s,isMe:!0,name:a,letter:i,photoSize:"m",allowContain:!0,wasConnected:c,networkStatus:1})))}},51443:(e,t,a)=>{"use strict";a.d(t,{WaitingHallInfo:()=>r});var n=a(667294),r=function(e){var t=e.text;return n.createElement("div",{className:"WaitingHallInfo"},n.createElement("div",{className:"WaitingHallInfo__text"},t))}},428990:(e,t,a)=>{"use strict";a.d(t,{WaitingHallList:()=>d});var n=a(667294),r=a(295886),i=a(662208),o=a(248586),l=a(279060),s=a(750598),c=a(881150),u=a(670546),d=function(e){var t=e.members,a=void 0===t?[]:t,d=e.totalCount,p=void 0===d?0:d,A=e.navigateToProfile,_=e.onPromote,m=e.onForbid,g=n.useContext(i.LangContext).getLang;return 0===a.length?n.createElement(n.Fragment,null):n.createElement(n.Fragment,null,n.createElement(r.ListHeader,{extra:p||""},g("calls_waiting_hall_list_header")),n.createElement(u.default,{border:!1,className:"CallParticipantList__list CallParticipantList__list--waitingList"},a.map((function(e){return n.createElement(s.default,{selectable:!1,border:!1,key:e.peerId,aside:n.createElement(n.Fragment,null,n.createElement(c.default,{onClick:function(){return m(e.peerId)},appearance:"secondary"},g("calls_waiting_hall_forbid")),n.createElement(c.default,{onClick:function(){return _(e.peerId)}},g("calls_waiting_hall_join")))},n.createElement(o.default,{onLinkClick:A,photo:n.createElement(l.CallPhoto,{id:e.peerId,photo:e.photo,alt:e.name||"",size:"xxxs"}),title:e.name,href:e.link,target:"_blank"}))}))))}},782605:(e,t,a)=>{"use strict";a.d(t,{AddParticipantContainer:()=>E});var n,r=a(570655),i=a(667294),o=a(50533),l=a(121255),s=a(587551),c=a(697483),u=a(389953),d=a(431469),p=a(152205),A=a(662208),_=a(788822),m=a(820717),g=a(745284),v=function(e){return e?(0,_.escape)(e.replace(/\t/g,"\n")):""},f=!1,E=function(e){var t=e.onChange,a=e.onClickCallAll,u=e.groupId,_=(0,o.useSelector)((function(e){return e})),E=i.useContext(A.LangContext).getLang,I=(0,o.useDispatch)(),N=(0,r.__read)((0,i.useState)(""),2),y=N[0],P=N[1],b=(0,r.__read)((0,i.useState)({}),2),L=b[0],M=b[1],w=(0,r.__read)((0,i.useState)(!1),2),O=w[0],k=w[1],D=(0,r.__read)((0,i.useState)(!1),2),R=D[0],B=D[1],G=(0,r.__read)((0,i.useState)(!1),2),H=G[0],x=G[1],U=(0,r.__read)((0,i.useState)(C(_.chatMembers,u?[]:_.friends)),1)[0],V=(0,r.__read)((0,i.useState)(h(_.chatMembers,U,_.groupMembers)),2),F=V[0],W=V[1],z=(0,r.__read)((0,i.useState)(C(_.chatMembers,_.groupMembers)),2),Q=z[0],j=z[1],Y=(_.preselectedIds||[]).filter((function(e){return!(0,c.isParticipantAnonym)(e)&&F[e]})),K=(0,r.__read)((0,i.useState)(Y),2),J=K[0],q=K[1],Z=(0,r.__read)((0,i.useState)(!1),2),X=Z[0],$=Z[1],ee=(0,i.useCallback)((function(e){return e.name}),[]),te=(0,i.useCallback)((function(e){return e.peerId}),[]),ae=(0,d.useIndexer)((0,r.__spreadArray)((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(_.chatMembers)),(0,r.__read)(U)),(0,r.__read)(Q)),ee,te),ne=_.groupMembersCount>l.COUNT_OF_GROUP_MEMBERS_TO_LOAD,re=(0,i.useCallback)((function(e){if(e){var t=ae.search(e);if(f){var a={};return t.forEach((function(e){a[e.id]=e})),Object.values(a)}return t}return function(e,t,a,n,i,o,s,c,u){var d=5,p=10,A=10,_={type:l.SearchResultType.MEMBERS_MORE,text:u("calls_show_all_members")},m={type:l.SearchResultType.FRIENDS_MORE,text:u("calls_show_all_friends")},g={type:l.SearchResultType.GROUP_MEMBERS_MORE,text:u("calls_show_all_group_members")},v={type:l.SearchResultType.HEADER,text:u("calls_chat_members"),count:e.length},f={type:l.SearchResultType.HEADER,text:u("calls_chat_group_members"),count:s},E={type:l.SearchResultType.HEADER,text:u("calls_friends")},C={type:l.SearchResultType.CALL_ALL_IN_CHAT,text:u("calls_call_all")},h=[];if(e.length>0)if(h.push(v),e.length<=c&&h.push(C),n||e.length<=d)h.push.apply(h,(0,r.__spreadArray)([],(0,r.__read)(e)));else{for(var S=0;S<d;S++)h.push(e[S]);h.push(_)}if(t.length>0)if(h.push(E),i||t.length<=p)h.push.apply(h,(0,r.__spreadArray)([],(0,r.__read)(t)));else{for(S=0;S<p;S++)h.push(t[S]);h.push(m)}if(a.length>0)if(h.push(f),o||a.length<=A)h.push.apply(h,(0,r.__spreadArray)([],(0,r.__read)(a)));else{for(S=0;S<A;S++)h.push(a[S]);h.push(g)}return h}(_.chatMembers,U,Q,O,R,H,_.groupMembersCount,_.participantLimit,E)}),[_,O,R,H]),ie=(0,r.__read)((0,i.useState)(re(y)),2),oe=ie[0],le=ie[1],se=function(e){q(e),t(e)},ce=(0,i.useCallback)((function(e){return se((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(J)),[+e]))}),[J]),ue=(0,i.useCallback)((function(e){return se(J.filter((function(t){return t!==+e})))}),[J]),de=(0,c.getActiveParticipants)(_.participants,_.me,_.groupId,_.meGroup).map((function(e){return{id:e.peerId.toString(),text:v(e.name),locked:!0}})).concat(J.map((function(e){return{text:v(F[e].name),id:e.toString(),locked:!1}})));(0,i.useEffect)((function(){M(J.reduce((function(e,t){return e[t]=!0,e}),{}))}),[]),(0,i.useEffect)((function(){le(re(y))}),[J,O,R,H]),(0,i.useEffect)((function(){var e=y;return ne&&(e.length>=3&&!X?n=setTimeout((function(){(0,m.serverSearchGroupMembers)(-_.groupId,e,_,I).then((function(t){if($(!1),t.length>0){f=!0;var a=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(Q)),(0,r.__read)(t));j(C(_.chatMembers,a)),W(h(_.chatMembers,U,a)),t.forEach((function(e){ae.add(e)})),le(re(e))}}))}),1e3):n&&($(!1),clearTimeout(n))),function(){clearTimeout(n)}}),[y]);var pe=(0,i.useCallback)((function(e){P(e.target.value),le(re(e.target.value))}),[]),Ae=(0,i.useCallback)((function(e){var t;return ue(e),M((0,r.__assign)((0,r.__assign)({},L),((t={})[e]=!1,t))),Promise.resolve()}),[L]),_e=(0,i.useCallback)((function(e){var t,a;return S(e,_,L)?(ue(e),M((0,r.__assign)((0,r.__assign)({},L),((t={})[e]=!1,t)))):T(F[e],_,de,L,(0,g.isAuthedByGroupId)(_))||(ce(e),M((0,r.__assign)((0,r.__assign)({},L),((a={})[e]=!0,a))),P(""),le(re(""))),Promise.resolve()}),[J,_,L]),me=(0,i.useCallback)((function(){var e=(0,c.getActiveParticipants)(_.participants,_.me,_.groupId,_.meGroup).reduce((function(e,t){return e[t.peerId]=!0,e}),{}),t=_.chatMembers.reduce((function(t,a){var n=a.peerId;return e[n]||T(a,_,de,L,(0,g.isAuthedByGroupId)(_))||t.push(n),t}),[]);a(t)}),[_,J,L]),ge=(0,i.useCallback)((function(e,t){if(!("type"in e))return t;switch(e.type){case l.SearchResultType.CALL_ALL_IN_CHAT:return function(){return me()};case l.SearchResultType.MEMBERS_MORE:return function(){return k(!0)};case l.SearchResultType.FRIENDS_MORE:return function(){return B(!0)};case l.SearchResultType.GROUP_MEMBERS_MORE:return function(){return x(!0)};default:return function(){}}}),[me]);return i.createElement(s.CallsMultiSelect,{tokens:de,onRemoveToken:Ae,value:y,onChange:pe,onSelect:_e,renderSuggest:function(e,t){return function(e,t){var a="peerId"in e?e.peerId:0;return i.createElement(p.CallsSearchResult,{data:e,onClick:ge(e,t),selected:S(a,_,L),disabled:T(F[a],_,de,L,(0,g.isAuthedByGroupId)(_)),key:a||"text"in e&&e.text||void 0})}(e,t)},data:oe})};function C(e,t){var a=e.reduce((function(e,t){return e[t.id]=!0,e}),{});return t.filter((function(e){return!a[e.id]}))}function h(e,t,a){return[].concat(t,e,a).reduce((function(e,t){return e[t.id]=t,e}),{})}function S(e,t,a){return a&&a[e]||(0,c.isParticipantInCall)(t,e)}function T(e,t,a,n,r){void 0===r&&(r=!1);var i=(null==e?void 0:e.peerId)||0;if((0,c.isParticipantInCall)(t,i))return!0;if(S(i,t,n))return!1;if(r){if((0,c.isParticipantUnavailableToCallFromGroup)(t,i))return!0}else if(!(null==e?void 0:e.canCall))return!0;return a.length>=t.participantLimit||!(0,u.isUserPeer)(i)}},358898:(e,t,a)=>{"use strict";a.d(t,{AdminPinUnmuteRequestContainer:()=>d});var n=a(667294),r=a(50533),i=a(881150),o=a(121255),l=a(662208),s=a(169610),c=a(734273),u=a(464380),d=function(e){var t=e.SDK,a=(0,r.useDispatch)(),d=n.useContext(l.LangContext).getLang,p=(0,r.useSelector)((function(e){return e})),A=p.participants[p.me].mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},_=function(){a({type:o.TOGGLE_POPUP})};return n.createElement(c.AdminPinUnmuteRequestModal,{onClose:_,title:d("calls_admin_pin_dialog_title"),description:d("calls_admin_pin_dialog_description"),actionButtons:[n.createElement(i.default,{onClick:_,appearance:"secondary",key:"cancel"},d("calls_admin_pin_dialog_cancel")),n.createElement(i.default,{onClick:function(){(A.isAudioEnabled?Promise.resolve():(0,s.checkPermissions)(t,[u.MediaOption.AUDIO])).then((function(){var e;(null===(e=p.notification)||void 0===e?void 0:e.type)===o.NotificationType.SPEAKING_ON_MUTE&&a({type:o.CALL_NOTIFICATION,notification:null}),t.toggleLocalAudio(!0).catch(console.log)})).then((function(){return _()}))},key:"mic"},d("calls_admin_pin_dialog_action"))]})}},262891:(e,t,a)=>{"use strict";a.d(t,{App:()=>U});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(536559),s=a(410531),c=a(923947),u=a(108519),d=a(187252),p=a(48755),A=a(165999),_=a(139230),m=a(656504),g=a(599648),v=a(94303),f=a(431469),E=a(474803),C=a(963532),h=a(325496),S=a(927229),T=a(353506),I=a(706885),N=a(485525),y=a(537817),P=a(410038),b=a(978335),L=a(358898),M=a(152532),w=a(350594),O=a(989819),k=a(379981),D=a(450273),R=a(858101),B=a(174635),G=a(241715),H=a(637880),x=a(464380),U=function(e){var t,a,U,V,F=e.SDK,W=e.bridge,z=e.onBeforeCallStart,Q=e.onAfterCallFinish,j=e.tabIsMaster,Y=e.navigateToConvo,K=e.callSounds,J=e.navigateToProfile,q=e.onHandCountChanged,Z=e.onSuccessFeedback,X=e.okPublicKey,$=e.config,ee=e.streamUrlExtractor,te=$.allowAddMembers,ae=$.incomingCall,ne=$.showFeedbackScreen,re=(0,i.useSelector)((function(e){return e})),ie=(0,i.useDispatch)(),oe=r.useCallback((function(){ie({type:o.CHANGE_MODE,mode:o.Mode.READY})}),[]),le=(0,n.__read)(r.useState(null),2),se=le[0],ce=le[1],ue=r.useCallback((function(e){ie({type:o.ERROR,text:e})}),[]),de=r.useCallback((function(){return ie({type:o.CHANGE_MODE,mode:o.Mode.READY})}),[]);return r.useEffect((function(){return re.mode===o.Mode.CALL?((0,N.wakeLockRequest)(),function(){(0,N.wakeLockRelease)()}):function(){}}),[re.mode]),(0,f.useFullScreen)(re.uiMode===o.UIMode.FULLSCREEN&&re.mode===o.Mode.CALL,(function(){var e;window.FastChat&&(ce(window.FastChat.getFullScreenState()),window.FastChat.toggleFullScreenState(!0)),(null===(e=null===window||void 0===window?void 0:window.reforgedME)||void 0===e?void 0:e.setCollapsed)&&window.reforgedME.setCollapsed(!0,"call")}),(function(){var e;re.uiMode===o.UIMode.FULLSCREEN&&ie({type:o.CHANGE_UI_MODE,mode:o.UIMode.DEFAULT}),window.FastChat&&(window.FastChat.toggleFullScreenState(se),ce(null)),(null===(e=null===window||void 0===window?void 0:window.reforgedME)||void 0===e?void 0:e.setCollapsed)&&window.reforgedME.setCollapsed(!1,"call")}),[re.uiMode,re.mode]),(0,E.usePriorities)(F,re),r.createElement(A.CallsErrorBoundary,{SDK:F,mode:re.mode,onReset:de},r.createElement(r.Fragment,null,(ae||j())&&r.createElement(u.AudioContainer,{onBeforeCallStart:z,onAfterCallFinish:Q,callSounds:K}),re.localStatus!==x.ParticipantStatus.WAITING_HALL&&re.mode===o.Mode.CALL&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(s.CallContainer,{SDK:F,navigateToConvo:Y,navigateToProfile:J,onHandCountChanged:q}),re.localStatus===x.ParticipantStatus.WAITING_HALL&&re.mode===o.Mode.CALL&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(H.WaitingHallContainer,{SDK:F,navigateToConvo:Y,navigateToProfile:J}),re.mode===o.Mode.INCOMING&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(l.IncomingCallContainer,{SDK:F,bridge:W}),re.localStatus!==x.ParticipantStatus.WAITING_HALL&&re.mode!==o.Mode.READY&&re.uiMode===o.UIMode.COLLAPSED&&r.createElement(c.CollapsedCallContainer,{SDK:F}),re.localStatus===x.ParticipantStatus.WAITING_HALL&&re.mode!==o.Mode.READY&&re.uiMode===o.UIMode.COLLAPSED&&r.createElement(G.CollapsedWaitingHallContainer,{SDK:F}),re.mode===o.Mode.START&&re.uiMode!==o.UIMode.COLLAPSED&&r.createElement(R.StartCallContainer,null),ne&&re.mode===o.Mode.FEEDBACK&&r.createElement(k.FeedbackContainer,{onSuccessFeedback:Z}),re.mode===o.Mode.CALL_BY&&r.createElement(B.CallByNameContainer,{bridge:W}),re.mode===o.Mode.JOIN&&r.createElement(m.JoinScreenContainer,(0,n.__assign)({},re.join,{bridge:W,withPopup:!0,onClose:oe,onError:ue,okPublicKey:X})),re.errorShown&&r.createElement(g.ErrorContainer,{title:null===(t=re.error)||void 0===t?void 0:t.title,text:null===(a=re.error)||void 0===a?void 0:a.text,handleType:null===(U=re.error)||void 0===U?void 0:U.handleType,callId:null===(V=re.error)||void 0===V?void 0:V.callId,bridge:W,onCloseFatal:oe}),re.cautionShown&&r.createElement(C.CautionContainer,{isIncoming:re.isIncoming}),re.groupCallSetup&&r.createElement(d.GroupCallSetupContainer,{bridge:W,SDK:F}),re.isManagementOpen&&r.createElement(_.CallManagementContainer,{bridge:W,SDK:F,navigateToProfile:J,navigateToConvo:Y,allowAddMembers:te}),re.popup===o.POPUP_SETTINGS&&r.createElement(p.SettingsContainer,{SDK:F}),re.popup===o.POPUP_TRANSLATION&&r.createElement(y.TranslationContainer,null),re.popup===o.POPUP_TRANSLATION_START_COUNTDOWN&&r.createElement(w.TranslationStartCountdownContainer,null),re.popup===o.POPUP_TRANSLATION_STOP&&r.createElement(P.TranslationStopContainer,null),re.popup===o.POPUP_TRANSLATION_SHARE&&r.createElement(b.TranslationShareContainer,{link:re.translation.link,linkExtractor:ee}),re.popup===o.POPUP_EXIT&&r.createElement(v.CallExitContainer,{SDK:F}),re.popup===o.POPUP_TRANSFER_ADMIN_RIGHTS&&r.createElement(M.TransferAdminRightsContainer,{SDK:F}),re.popup===o.POPUP_UNMUTE_REQUEST&&r.createElement(S.UnmuteRequestContainer,{SDK:F}),re.popup===o.POPUP_ADMIN_PIN_UNMUTE_REQUEST&&r.createElement(L.AdminPinUnmuteRequestContainer,{SDK:F}),re.participantKick&&r.createElement(O.KickParticipantContainer,{SDK:F}),re.membersUnban&&r.createElement(D.UnbanParticipantContainer,{SDK:F}),re.participantsManagement&&r.createElement(h.MuteParticipantContainer,{SDK:F}),re.adminAssignment&&r.createElement(T.AssignAdminContainer,{SDK:F}),re.isLoaderVisible&&r.createElement(I.default,null)))}},353506:(e,t,a)=>{"use strict";a.d(t,{AssignAdminContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(881150),l=a(121255),s=a(697483),c=a(662208),u=a(329538),d=a(908651),p=a(614914),A=a(745284),_=a(464380),m=function(e){var t=e.SDK,a=(0,i.useSelector)((function(e){return e.adminAssignment?e.participants[e.adminAssignment.participant.peerId]:void 0})),m=(0,i.useSelector)((function(e){return e})),g=(0,i.useDispatch)(),v=(0,n.__read)((0,r.useState)(!0),2),f=v[0],E=v[1],C=(0,n.__read)((0,r.useState)(""),2),h=C[0],S=C[1],T=r.useContext(c.LangContext).getLang;(0,r.useEffect)((function(){g({type:l.SHOW_LOADER,isLoaderVisible:!0}),new Promise((function(e,t){a&&a.peerId<0?(0,u.getGroupById)(-a.peerId).then((function(t){var a,n=t.groups;e(n&&n.length>0?null===(a=n[0])||void 0===a?void 0:a.name:"")})).catch((function(e){return t(e)})):(0,u.loadUsers)({user_ids:a&&String(a.peerId),name_case:"dat"}).then((function(t){var a=(0,n.__read)(t,1)[0];e((null==a?void 0:a.first_name)+" "+(null==a?void 0:a.last_name))})).catch((function(e){return t(e)}))})).then((function(e){S(e),E(!1),g({type:l.SHOW_LOADER,isLoaderVisible:!1})})).catch(console.log)}),[a]);var I=(0,r.useCallback)((function(){g({type:l.TOGGLE_ADMIN_ASSIGNMENT})}),[]),N=(0,r.useCallback)((function(){var e=(0,s.getParticipantExternalId)(a);e?(t.grantRoles(e,[_.UserRole.ADMIN],!1).then((function(){a&&g({type:l.CHANGE_PARTICIPANT_ROLES,participantId:a.peerId,data:a.roles?(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(a.roles)),[_.UserRole.ADMIN]):[_.UserRole.ADMIN]})})).catch(console.log),p.callStats.logEvent({call_event_type:l.CallActionEventType.ASSIGN_ADMIN,session_id:m.callData.callId,peer_id:m.peer,is_group_call:(0,A.isGroupCallByPeer)(m.peer)}),I()):I()}),[]);return f?null:r.createElement(d.AssignAdminModal,{onClose:I,title:T("calls_dialog_assign_admin_role_title"),description:T("calls_dialog_assign_admin_role_description").replace("{name}",h),actionButtons:[r.createElement(o.default,{onClick:I,appearance:"secondary",key:"cancel"},T("calls_dialog_assign_admin_role_action_later")),r.createElement(o.default,{onClick:N,key:"primary"},T("calls_dialog_assign_admin_role_action_primary"))]})}},108519:(e,t,a)=>{"use strict";a.d(t,{AudioContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(483379),s=a(745284),c=a(464380),u="incoming",d="outgoing",p="connecting",A="connected",_="end";function m(e){var t,a=e.onBeforeCallStart,m=e.onAfterCallFinish,g=e.callSounds,v=(0,i.useSelector)((function(e){return e})),f=(0,r.useRef)(),E=((t={}).incoming=(0,r.useRef)(null),t.outgoing=(0,r.useRef)(null),t.connecting=(0,r.useRef)(null),t.connected=(0,r.useRef)(null),t.end=(0,r.useRef)(null),t),C={controls:!1,preload:"auto"},h=(0,r.useCallback)((function(e){var t=E[e].current;t&&t.paused&&t.play().catch((function(){}))}),[]),S=(0,r.useCallback)((function(e){var t=E[e].current;t&&!t.paused&&(t.pause(),t.currentTime=0)}),[]),T=(0,r.useCallback)((function(){Object.keys(E).forEach(S)}),[]),I=(0,r.useCallback)((function(e){var t=E[e].current;if(t){var a=t.volume;t.volume=0,t.play().catch((function(){})),t.pause(),t.currentTime=0,t.volume=a}}),[]),N=(0,r.useCallback)((function(){a&&a()}),[a]),y=(0,r.useCallback)((function(){m&&m()}),[m]);return(0,r.useEffect)((function(){return l.browser.safari&&document.body.addEventListener("mousedown",(function e(){Object.keys(E).forEach(I),document.body.removeEventListener("mousedown",e)})),function(){T(),y()}}),[]),(0,r.useEffect)((function(){var e,t,a=f.current||v,r=v;a.mode!==r.mode&&(a.mode!==o.Mode.READY||r.mode!==o.Mode.INCOMING&&r.mode!==o.Mode.CALL||N(),a.mode===o.Mode.INCOMING&&S(u),r.mode===o.Mode.INCOMING&&h(u),r.mode!==o.Mode.READY||a.mode!==o.Mode.INCOMING&&a.mode!==o.Mode.CALL||(T(),h(_),y()));var i=r.me,l=a.participants,m=r.participants,g=null===(e=l[i])||void 0===e?void 0:e.status,E=null===(t=m[i])||void 0===t?void 0:t.status;g!==E&&(g===c.ParticipantStatus.CONNECTING&&S(p),E===c.ParticipantStatus.CONNECTING&&h(p));var C=Object.keys(m).some((function(e){return l[e]&&l[e].status===c.ParticipantStatus.CONNECTED})),I=Object.keys(m).some((function(e){var t=l[e],a=m[e];return t&&t.status!==a.status&&a.status===c.ParticipantStatus.CONNECTED}));!C&&I&&h(A),r.mode===o.Mode.CALL&&(!function(e,t,a,r){var i,o,l=!1;try{for(var s=(0,n.__values)(Object.values(e)),u=s.next();!u.done;u=s.next()){var d=u.value;if(d.peerId!==t){if(d.status===c.ParticipantStatus.CONNECTED)return!1;d.status===c.ParticipantStatus.WAITING&&(!r||a.has(d.peerId))&&(l=!0)}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return l}(m,i,r.participantsAddedByMe,(0,s.isGroupCallByPeer)(v.peer))?S(d):h(d)),f.current=v}),[v]),r.createElement(r.Fragment,null,r.createElement("audio",(0,n.__assign)({src:g.incoming,ref:E.incoming,loop:!0},C)),r.createElement("audio",(0,n.__assign)({src:g.outgoing,ref:E.outgoing,loop:!0},C)),r.createElement("audio",(0,n.__assign)({src:g.connected,ref:E.connected,loop:!1},C)),r.createElement("audio",(0,n.__assign)({src:g.connecting,ref:E.connecting,loop:!0},C)),r.createElement("audio",(0,n.__assign)({src:g.end,ref:E.end,loop:!1},C)))}},174635:(e,t,a)=>{"use strict";a.d(t,{CallByNameContainer:()=>_});var n=a(570655),r=a(667294),i=a(790281),o=a(662208),l=a(50533),s=a(121255),c=a(329538),u=a(881150),d=a(706885),p=a(431469),A=a(788822),_=function(e){var t=e.bridge,a=(0,l.useSelector)((function(e){return e})),_=(0,l.useDispatch)(),m=(0,n.__read)((0,r.useState)([]),2),g=m[0],v=m[1],f=(0,n.__read)((0,r.useState)(a.me),2),E=f[0],C=f[1],h=r.useContext(o.LangContext).getLang,S=(0,n.__read)((0,r.useState)(""),2),T=S[0],I=S[1],N=(0,r.useCallback)((function(e){return e.name}),[]),y=(0,r.useCallback)((function(e){return e.id}),[]),P=(0,p.useIndexer)([],N,y),b=a.participants[a.me],L=T?P.search(T):g,M=(0,r.useCallback)((function(e){I(e.target.value)}),[]),w=function(e,t){void 0===t&&(t=!1);var a="id"in e?e.id:e.peerId,n="screen_name"in e?"/"+e.screen_name:e.link,r="photo_100"in e?e.photo_100:e.photo;return{id:t?a:-a,name:(0,A.escape)(e.name),link:n,photo:r}};(0,r.useEffect)((function(){var e=[w(b,!0)];(0,c.getGroupsForCall)().then((function(t){t.count>0&&t.items.forEach((function(t){e.push(w(t))}))})).finally((function(){v(e),e.forEach((function(e){return P.add(e)}))}))}),[]);var O=(0,r.useCallback)((function(e){if(a.callByName){var n=a.callByName,r=n.peerId,i=n.entryPoint,o=n.joinLink;o?t.joinCallByLink(o,void 0,e,i,E>0?0:E):r?t.call(r,e,void 0,i,E>0?0:E):t.startCall(e,i,!0,E>0?0:E)}}),[E]);if(!g.length)return r.createElement(d.default,null);var k=[r.createElement(u.default,{onClick:function(){return O(!1)},key:"callByNameByAudio",appearance:"secondary"},h("calls_call_by_name_audio_button")),r.createElement(u.default,{onClick:function(){return O(!0)},key:"callByNameByVideo"},h("calls_call_by_name_video_button"))];return r.createElement(i.CallByNameModal,{items:L,actionButtons:k,selectedId:E,onListItemClick:function(e){C(e)},onClose:function(){_({type:s.CHANGE_MODE,mode:s.Mode.READY})},participantMe:b,onSearchChange:M})}},410531:(e,t,a)=>{"use strict";a.d(t,{CallContainer:()=>R});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(242422),s=a(492512),c=a(362542),u=a(548237),d=a(269481),p=a(75794),A=a(884143),_=a(279060),m=a(169610),g=a(690015),v=a(745284),f=a(697483),E=a(614914),C=a(561235),h=a(662208),S=a(498110),T=a(774351),I=a(464380),N=a(139230),y=a(613335),P=a(674543),b=a(659397),L=a(768606),M=a(290514),w=a(147853),O=a(259684),k=a(662727),D=a(766610);function R(e){var t,a,y,R,G,H=e.SDK,x=e.navigateToConvo,U=e.navigateToProfile,V=e.onHandCountChanged,F=(0,i.useSelector)((function(e){return e})),W=(0,i.useDispatch)(),z=(0,r.useContext)(h.LangContext).getLang,Q=(0,r.useContext)(S.ConfigContext),j=Q.isModalView,Y=Q.debugLog,K=Q.enableScreenTrack,J=Q.enableProducerScreenTrack,q=Q.allowPushToTalk,Z=F.peer,X=(0,r.useMemo)((function(){var e,t,a,n;return(0,v.isGroupCallByPeer)(Z)||(null===(t=null===(e=F.participants[F.me])||void 0===e?void 0:e.mediaSettings)||void 0===t?void 0:t.isScreenSharingEnabled)||(null===(n=null===(a=F.participants[Z])||void 0===a?void 0:a.mediaSettings)||void 0===n?void 0:n.isScreenSharingEnabled)}),[F.peer,F.participants]),$=X?F.callData.conversation:F.participants[Z],ee=F.participants[F.me],te=ee.mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},ae=ee.permissions,ne=(0,r.useMemo)((function(){return(0,f.getActiveParticipants)(F.participants,F.me,F.groupId,F.meGroup,F.adminPinnedParticipant)}),[F.participants,F.me,F.groupId,F.meGroup,F.adminPinnedParticipant,F.screenSharingPinnedParticipant,F.pinnedParticipant,F.speakers]),re=ne.length>1,ie=re||(0,f.isParticipantWithVideo)(ee),oe=(0,f.getNonAnonymousConnectParticipantsCount)(F),le=X&&((0,f.isAdmin)(ee)||(0,f.isCreator)(ee))&&oe>1&&1===(0,f.getConnectedAdminsCount)(F),se=X||ne.length>2,ce=se&&ie&&!F.isOratorMode,ue=se&&ie&&F.isOratorMode,de=null!==F.adminPinnedParticipant,pe=!de&&null!==F.pinnedParticipant,Ae=!pe&&null!==F.screenSharingPinnedParticipant,_e=F.uiMode===o.UIMode.FULLSCREEN,me=(0,r.useMemo)((function(){return H.browser.isScreenCapturingSupported()}),[]),ge=(null===(t=F.callData)||void 0===t?void 0:t.canFinishCall)||X&&0===Z&&(0,f.participantIsAdmin)(ee),ve=!!F.translation.deferredId&&!F.translation.isOn,fe=(0,n.__read)((0,r.useState)(!1),2),Ee=fe[0],Ce=fe[1],he=(0,n.__read)((0,r.useState)(!1),2),Se=he[0],Te=he[1],Ie=(0,n.__read)((0,r.useState)(0),2),Ne=Ie[0],ye=Ie[1],Pe=function(e){return W({type:o.CHANGE_UI_MODE,mode:e})},be=function(){(0,m.checkPermissions)(H,[I.MediaOption.AUDIO,I.MediaOption.VIDEO]).then((function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_SETTINGS})}))},Le=function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION})},Me=(0,r.useCallback)((function(){j&&(F.uiMode===o.UIMode.FULLSCREEN?((0,T.pause)(.3,null).then((function(){Pe(o.UIMode.COLLAPSED)})),Pe(o.UIMode.DEFAULT)):Pe(o.UIMode.COLLAPSED))}),[F.uiMode]),we=(0,r.useCallback)((function(){W({type:o.TOGGLE_ORATOR_MODE,isOratorMode:!F.isOratorMode})}),[F.isOratorMode]),Oe=(0,r.useCallback)((function(){W({type:o.TOGGLE_PARTICIPANTS_ASIDE,isShownParticipantsAside:!F.isShownParticipantsAside})}),[F.isShownParticipantsAside]),ke=(0,r.useCallback)((function(e,t){var a=F.pinnedParticipant===t?null:t;F.screenSharingPinnedParticipant===t&&(a=null),F.screenSharingPinnedParticipant&&W({type:o.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:null}),W({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:a})}),[F.pinnedParticipant,F.screenSharingPinnedParticipant]),De=(0,r.useCallback)((function(e,t){F.isOratorMode||W({type:o.TOGGLE_ORATOR_MODE,isOratorMode:!0}),F.pinnedParticipant!==t&&W({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:t})}),[F.isOratorMode,F.pinnedParticipant]),Re=(0,r.useCallback)((function(){W({type:o.MANAGEMENT,isOpen:!0})}),[]),Be=(0,r.useCallback)((function(){W({type:o.MANAGEMENT,isOpen:!0,managementView:N.ManagementViews.CALL_LINK})}),[]),Ge=(0,r.useCallback)((function(){if(!Se){var e=!te.isVideoEnabled||te.isScreenSharingEnabled&&!K;(e?(0,m.checkPermissions)(H,[I.MediaOption.VIDEO]):Promise.resolve()).then((function(){Te(!0),K||te.isScreenSharingEnabled&&H.captureScreen(!1),H.toggleLocalVideo(e).finally((function(){Te(!1)}))})),E.callStats.logEvent({call_event_type:e?o.CallActionEventType.VIDEO_ENABLED:o.CallActionEventType.VIDEO_DISABLED,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,v.isGroupCallByPeer)(F.peer),reason:e?void 0:"manual"})}}),[te,Se]),He=(0,r.useCallback)((function(){H.captureScreen(!te.isScreenSharingEnabled).catch((function(){W({type:o.ERROR,text:z("calls_error_disabled_screen_sharing")})})),E.callStats.logEvent({call_event_type:te.isScreenSharingEnabled?o.CallActionEventType.SCREEN_SHARING_STOPPED:o.CallActionEventType.SCREEN_SHARING_STARTED,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,v.isGroupCallByPeer)(F.peer)})}),[te.isScreenSharingEnabled,F.screenSharers,F.callData.callId,F.peer]),xe=(0,r.useCallback)((function(){Me(),x(F.peer)}),[F.peer,F.uiMode]),Ue=(0,r.useCallback)((function(){if(!Ee){var e=!te.isAudioEnabled;(e?(0,m.checkPermissions)(H,[I.MediaOption.AUDIO]):Promise.resolve()).then((function(){var t;Ce(!0),(null===(t=F.notification)||void 0===t?void 0:t.type)===o.NotificationType.SPEAKING_ON_MUTE&&W({type:o.CALL_NOTIFICATION,notification:null}),H.toggleLocalAudio(e).finally((function(){Ce(!1)}))}))}}),[te,Ee]),Ve=(0,r.useCallback)((function(){var e,t,a=!(null===(e=ee.statusData)||void 0===e?void 0:e.hand);H.changeParticipantState({hand:a?o.SdkHandType.RAISED:o.SdkHandType.LOWERED}),W({type:o.CHANGE_PARTICIPANT_STATE,participantId:ee.peerId,data:(0,n.__assign)((0,n.__assign)({},ee.statusData),{hand:!(null===(t=ee.statusData)||void 0===t?void 0:t.hand)})}),E.callStats.logEvent({call_event_type:a?o.CallActionEventType.HAND_RAISED:o.CallActionEventType.HAND_LOWERED,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,v.isGroupCallByPeer)(F.peer)})}),[null===(a=ee.statusData)||void 0===a?void 0:a.hand]),Fe=(0,r.useCallback)((function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_EXIT})}),[]),We=(0,r.useCallback)((function(){W({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSFER_ADMIN_RIGHTS})}),[]),ze=(0,r.useCallback)((function(){H.hangup(),E.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,v.isGroupCallByPeer)(F.peer),reason:"none",group_call_users_count:ne.length})}),[F.callData.callId,F.peer,ne]),Qe=(0,r.useCallback)((function(){W({type:o.CHANGE_UI_MODE,mode:_e?o.UIMode.DEFAULT:o.UIMode.FULLSCREEN}),W({type:o.SET_TOOLTIP,tooltips:null})}),[F.uiMode]),je=(0,r.useCallback)((function(e,t){var a;W({type:o.SET_TOOLTIP,tooltips:(a={},a[e]=t,a)})}),[]),Ye=(0,r.useCallback)((function(){W({type:o.SET_TOOLTIP,tooltips:null})}),[]);(0,r.useEffect)((function(){ve&&je("streaming",!0)}),[ve]);(0,r.useEffect)((function(){F.isOratorMode||function(e){var t;console.log("onScrollGrid");for(var a=(null===(t=document.querySelectorAll('[data-calls-id="grid-item"]')[0])||void 0===t?void 0:t.offsetWidth)||1/0,n=6*Math.floor(e/a),r=0;r<ne.length;r++){var i=r>=n&&r<n+30;ne[r].visible!==i&&(0,L.throttleAccumulateDispatchParticipant)(W,ne[r].peerId,{visible:i})}}(F.gridScrollPosition)}),[F.isOratorMode,F.gridScrollPosition,ne]),(0,r.useEffect)((function(){F.isOratorMode&&function(e){var t;console.log("onScrollOrator");for(var a=document.querySelectorAll('[data-calls-id="participant"]')[0],n=a?a.offsetWidth+8:1/0,r=(null===(t=document.querySelectorAll('[data-calls-id="content"]')[0])||void 0===t?void 0:t.offsetHeight)||0,i=Math.floor(e/n)-1,o=Math.min(F.config.videoSlotsCount,r/n+3),l=0;l<ne.length;l++){var s=l>=i&&l<i+o;ne[l].visible!==s&&(0,L.throttleAccumulateDispatchParticipant)(W,ne[l].peerId,{visible:s})}}(F.oratorScrollPosition)}),[F.isOratorMode,F.oratorScrollPosition,ne]);var Ke=(0,r.useCallback)((0,b.debounce)((function(e){W({type:o.SET_GRID_SCROLL_POSITION,data:e})}),200),[F]),Je=(0,r.useCallback)((0,b.debounce)((function(e){W({type:o.SET_ORATOR_SCROLL_POSITION,data:e})}),200),[F]),qe=(0,r.useMemo)((function(){var e,t=[{text:z("calls_call_menu_settings"),key:"settings",onClick:be,disabled:!1}];F.config.streaming&&!(0,f.isParticipantAnonym)(F.me)&&t.push({text:z("calls_call_menu_translation"),key:"translation",onClick:Le,disabled:!!(null===(e=F.translation)||void 0===e?void 0:e.isOn)&&(0,P.canStopTranslation)(F)}),(0,f.canMuteParticipants)(ee)&&X&&t.push({text:z("calls_call_menu_mute_audio_video_all"),key:"muteAll",onClick:function(){W({type:o.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:o.ParticipantsManagementMode.ALL}})}}),(0,f.canMuteParticipants)(ee)&&X&&re&&t.push({text:z("calls_call_menu_enable_media_request"),key:"unmuteRequest",onClick:function(){H.unmuteRequest(void 0,[I.MediaOption.AUDIO,I.MediaOption.VIDEO,I.MediaOption.SCREEN_SHARING]).catch(console.log),E.callStats.logEvent({call_event_type:o.CallActionEventType.ASK_ALL_TO_UNMUTE,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,v.isGroupCallByPeer)(F.peer)})}});return Y&&t.push({text:z("calls_call_menu_debug"),key:"debugLog",onClick:function(){window.__VKCallsSDKLogs__()},disabled:!1}),t}),[F.config.streaming,F.me,null===(y=F.translation)||void 0===y?void 0:y.isOn,F.participants[F.me],F.conversationOptions]);(0,r.useEffect)((function(){return function(){W({type:o.SET_TOOLTIP,tooltips:null})}}),[]);var Ze=(0,r.useCallback)((function(){de&&(0,f.canPinParticipants)(ee)?(H.pinParticipant(F.adminPinnedParticipant,!0).then((function(){W({type:o.SET_ADMIN_PINNED_PARTICIPANT,data:null})})).catch(console.log),E.callStats.logEvent({call_event_type:o.CallActionEventType.ADMIN_UNPIN,session_id:F.callData.callId,peer_id:F.peer,is_group_call:(0,v.isGroupCallByPeer)(F.peer)})):(W({type:o.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:null}),W({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:null}))}),[F.adminPinnedParticipant,F.participants[F.me].roles,F.peer,F.callData.callId]),Xe=(0,r.useCallback)((function(e){ae.audio>0&&(0,w.onPushToTalkHandler)(e,te.isAudioEnabled,W,F)}),[ae.audio,te.isAudioEnabled,F.speakers,F.notification]);(0,r.useEffect)((function(){q&&ae.audio>0&&(0,w.pushToTalkToggleAudio)(F.pushToTalkEnabled,te,!1)}),[]),(0,r.useEffect)((function(){return q&&!(0,O.isCollapsedLayout)(F)&&F.pushToTalkEnabled?((0,w.pushToTalkActivate)(Xe),function(){(0,w.pushToTalkDeactivate)(Xe)}):function(){}}),[F.uiMode,F.pushToTalkEnabled,Xe]);var $e=(0,r.useMemo)((function(){var e;return r.createElement(g.CallNotificationContainer,{dispatch:W,notification:F.notification,participant:F.participants[null===(e=F.notification)||void 0===e?void 0:e.data]})}),[F.notification,F.participants[null===(R=F.notification)||void 0===R?void 0:R.data]]),et=(0,r.useMemo)((function(){return r.createElement(M.NotificationWithButtonContainer,null)}),[F.waitingHall]);(0,r.useEffect)((function(){if(!F.callData.localTimeStamp&&!(0,v.isGroupCallByPeer)(F.peer)&&!(0,k.getHangupStatus)(F,z)){var e=F.participants[F.peer];e&&e.status===I.ParticipantStatus.CONNECTED&&W({type:o.LOCAL_TIME_START,data:Date.now()})}}),[F]);var tt=(0,r.useMemo)((function(){return(0,f.getActiveParticipantsCount)(F)}),[F.participants]);return(0,r.useEffect)((function(){X&&ye(tt)}),[tt]),r.createElement(d.CallModal,{onClose:le?We:ze,isCautionBoxShown:!le,onBackdropClick:Me},r.createElement(s.Call,{info:r.createElement(C.CallHeaderContainer,{onHandCountChanged:V}),callMenuActions:qe,isVideoAllowed:te.isVideoEnabled||ae.video>0,isAudioAllowed:te.isAudioEnabled||ae.audio>0,isVideoEnabled:K?te.isVideoEnabled:te.isVideoEnabled&&!te.isScreenSharingEnabled,isAudioEnabled:te.isAudioEnabled,isScreenSharingEnabled:te.isScreenSharingEnabled,isOratorMode:F.isOratorMode,isFullScreen:_e,onToggleVideo:Ge,onToggleAudio:Ue,onToggleScreenShare:He,onLeaveCall:le?We:ge?Fe:ze,onCollapseCall:j?Me:null,onToggleOratorMode:we,onFullScreenToggle:Qe,onTooltipChange:je,onHidePanel:Ye,onChat:xe,onHandClick:Ve,isParticipantControlActive:F.isManagementOpen,isLayoutSwitchShown:X&&re,isHandRaised:null===(G=ee.statusData)||void 0===G?void 0:G.hand,isHandControlShown:X,isChatControlShown:!!Z&&!F.groupId,isScreenShareControlShown:ae.screenSharing>0&&me,isStreamingControlShown:ve,isChainControlShown:!(0,f.isParticipantAnonym)(ee.peerId),onDeferredStreamStart:function(){if(F.translation.deferredId){var e={isOn:!1,startStreamParams:{upcomingStreamParams:{ovId:F.translation.deferredId}}};W({type:o.SET_TRANSLATION,data:e}),W({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_START_COUNTDOWN})}},onParticipantsClick:Re,chatUnreadCount:F.chatUnreadCount,notification:$e,tooltips:F.tooltips,amISpeaking:!!F.speakers[F.me],onChainClick:Be,waitingHallNotification:et,participantCount:Ne},r.createElement(r.Fragment,null,!se&&r.createElement(l.OneToOne,(0,n.__assign)({},function(e,t,a,n){var r,i=e[t]||{},o=e[a]||{},l=i.mediaSettings,s=o&&o.mediaSettings?o.mediaSettings:{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},c=(0,f.isParticipantWithVideo)(i),u=(0,f.getStream)(i),d=(0,f.isParticipantWithVideo)(o),p=(0,f.getStream)(o);return{hasAudio:!!(null==l?void 0:l.isAudioEnabled),hasVideo:c,isSharingScreen:!!(null==l?void 0:l.isScreenSharingEnabled),stream:u,id:t,name:n("calls_own_label"),letter:null===(r=i.name)||void 0===r?void 0:r.slice(0,1),wasConnected:!!i.wasConnected,networkStatus:i.networkStatus,opponentHasAudio:!!(null==s?void 0:s.isAudioEnabled),opponentHasVideo:d,opponentIsSharingScreen:!!(null==s?void 0:s.isScreenSharingEnabled),opponentStream:p,opponentPhoto:o.photo,opponentId:a,opponentName:o.name||a.toString(),opponentWasConnected:!!o.wasConnected,opponentNetworkStatus:o.networkStatus}}(F.participants,F.me,F.peer,z))),ce&&r.createElement(c.CallGridNew,{limit:F.participantLimit,onScroll:Ke,scrollPosition:F.gridScrollPosition},ne.map((function(e,t,a){var n,i,o,l=e.mediaSettings||{},s=l.isAudioEnabled,c=l.isScreenSharingEnabled,u=e.peerId===F.me?z("calls_own_label"):e.shortName?e.shortName:e.name,d=(0,f.isParticipantWithVideo)(e),A=(0,f.getStream)(e),_=F.localStatus===I.ParticipantStatus.CONNECTED?e.status:I.ParticipantStatus.CONNECTED,m=(0,f.getParticipantActions)(F,H,W,e,!0,z,x,U,!1);return r.createElement(p.Participant,{id:e.peerId,key:e.peerId,isVisible:e.visible,isInfoShown:!0,isMe:e.peerId===F.me,isHandRaised:null===(n=e.statusData)||void 0===n?void 0:n.hand,hasVideo:!!d,hasAudio:!!s,isSharingScreen:!!c,isSpeaking:s&&F.speakers[e.peerId]&&e.visible,stream:A,photo:e.photo,photoSize:a.length<=8||_e?"s":"xs",name:u,letter:null!==(o=null===(i=null==e?void 0:e.name)||void 0===i?void 0:i[0])&&void 0!==o?o:"",status:_,allowContain:!1,wasConnected:e.wasConnected,networkStatus:e.networkStatus,onDblClickParticipant:De,actions:m})}))),ue&&r.createElement(u.CallOrator,{orator:B(F,z,He),oratorTitle:r.createElement(D.OratorTitle,{orator:(0,f.getOrator)(F),me:F.me,isPinned:pe,isPinnedByAdmin:de,isPinnedByShareScreen:Ae,isUnpinAllowed:(0,f.canPinParticipants)(ee)||!de,onUnpin:Ze,tooltips:F.tooltips,onTooltipChange:je}),onToggleParticipantsAside:Oe,isShownParticipantsAside:F.isShownParticipantsAside,onScroll:Je,scrollPosition:F.oratorScrollPosition},ne.map((function(e){var t,a,n,i=e.mediaSettings||{},o=i.isVideoEnabled,l=i.isAudioEnabled,s=i.isScreenSharingEnabled,c=e.peerId===F.me,u=c?z("calls_own_label"):e.shortName?e.shortName:e.name,d=(0,f.getStream)(e,!0),A=!!s;(K||J)&&(o?A=!1:d=(0,f.getStream)(e));var _=(0,f.isParticipantWithVideo)(e),m=F.localStatus===I.ParticipantStatus.CONNECTED?e.status:I.ParticipantStatus.CONNECTED,g=(0,f.getParticipantActions)(F,H,W,e,!0,z,x,U,!1);return r.createElement(p.Participant,{id:e.peerId,key:e.peerId,isVisible:e.visible,isInfoShown:!0,isMe:c,isPinned:Number(e.peerId)===Number(F.pinnedParticipant)||Number(e.peerId)===Number(F.screenSharingPinnedParticipant),isPinnedByAdmin:e.peerId===Number(F.adminPinnedParticipant),isHandRaised:null===(t=e.statusData)||void 0===t?void 0:t.hand,hasVideo:!!_,hasAudio:!!l,isSharingScreen:A,isSpeaking:l&&F.speakers[e.peerId]&&e.visible,stream:d,photo:e.photo,photoSize:"xxs",name:u,letter:null!==(n=null===(a=null==e?void 0:e.name)||void 0===a?void 0:a[0])&&void 0!==n?n:"",status:m,allowContain:!1,wasConnected:e.wasConnected,networkStatus:e.networkStatus,onClickParticipant:ke,actions:g})}))),se&&!ie&&r.createElement(A.default,null,r.createElement(_.CallPhoto,{id:Z,photo:$&&$.photo||"",size:"l",waves:!0,alt:$&&$.tab||""})))))}function B(e,t,a){var n,i=null!==(n=e.participants[e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me])&&void 0!==n?n:{},o=i.mediaSettings||{},l=o.isAudioEnabled,s=o.isScreenSharingEnabled,c=i.peerId===e.me;c&&e.groupId&&e.meGroup&&(i=(0,y.mergeGroupToParticipant)(e.meGroup,i));var u=(0,f.isParticipantWithVideo)(i),d=(0,f.getStream)(i);return r.createElement(p.Participant,{id:i.peerId,key:i.peerId,isOrator:!0,isInfoShown:!0,isMe:c,hasVideo:!!u,hasAudio:!!l,isSharingScreen:!!s,stream:d,photo:i.photo,photoSize:"l",name:c?t("calls_own_label"):i.name,status:i.status,wasConnected:i.wasConnected,networkStatus:i.networkStatus,allowContain:!0,onStopScreenShare:a})}},94303:(e,t,a)=>{"use strict";a.d(t,{CallExitContainer:()=>A});var n=a(667294),r=a(50533),i=a(225652),o=a(881150),l=a(121255),s=a(444083),c=a(614914),u=a(745284),d=a(697483),p=a(662208),A=function(e){var t=e.SDK,a=(0,r.useSelector)((function(e){return e})),A=(0,r.useDispatch)(),_=n.useContext(p.LangContext).getLang,m=function(){return c.callStats.logEvent({call_event_type:l.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:a.callData.callId,peer_id:a.peer,is_group_call:(0,u.isGroupCallByPeer)(a.peer),reason:"none",group_call_users_count:(0,d.getActiveParticipantsCount)(a)})},g=(0,n.useCallback)((function(){A({type:l.TOGGLE_POPUP})}),[]);return n.createElement(i.CallExitModal,{onClose:g,actionButtons:[n.createElement(o.default,{onClick:function(){A({type:l.TOGGLE_POPUP}),m(),(0,s.onForceCallFinish)(t,a,A,_)},key:"forceCallFinish",appearance:"secondary"},_("calls_force_call_finish")),n.createElement(o.default,{onClick:function(){return A({type:l.TOGGLE_POPUP}),m(),t.hangup()},key:"leave"},_("calls_leave_call"))]})}},561235:(e,t,a)=>{"use strict";a.d(t,{CallHeaderContainer:()=>A});var n=a(570655),r=a(667294),i=a(50533),o=a(910472),l=a(745284),s=a(503592),c=a(697483),u=a(298811),d=a(662208),p=a(662727);function A(e){var t,a,A=e.onHandCountChanged,_=(0,i.useSelector)((function(e){return e})),m=(0,l.isGroupCallByPeer)(_.peer),g=(0,r.useContext)(d.LangContext),v=g.getLang,f=g.langNumeric,E=(0,n.__read)((0,r.useState)(null),2),C=E[0],h=E[1],S=(0,n.__read)((0,r.useState)(0),2),T=S[0],I=S[1],N=(0,n.__read)((0,r.useState)(null),2),y=N[0],P=N[1],b=(0,n.__read)((0,r.useState)(""),2),L=b[0],M=b[1];return r.useEffect((function(){var e=(0,l.isGroupCallByPeer)(_.peer)?_.callData.ts:_.callData.localTimeStamp;P((0,p.getCallTimer)(e));var t=setInterval((function(){return P((0,p.getCallTimer)(e))}),1e3);return function(){return clearInterval(t)}}),[_.peer,_.callData.localTimeStamp,_.callData.ts]),(0,r.useEffect)((function(){var e=(0,c.getRaisedHands)(_);e!==T&&(I(e),A&&A(e))}),[_.participants]),(0,r.useEffect)((function(){if(m){var e=_.speakersInHeader.reduce((function(e,t){return _.participants[t]&&(_.participants[t].shortName||_.participants[t].name)&&e.push(_.participants[t]),e}),[]);if(e.length>0){var t=v("calls_participants_speak",e.length).split(" ");h(r.createElement(r.Fragment,null,r.createElement("span",{className:"CallHeader__speak"},t[0]," "),(0,u.getParticipantsListLabel)(e,e.slice(0,2),(function(e){return e.shortName||e.name}),v,f,0,2)))}else h(null)}}),[_.participants,_.speakersInHeader]),(0,r.useEffect)((function(){var e="";_.translation.isOn&&(e=r.createElement(o.TranslationStatusContainer,null)),M(e)}),[_.translation.isOn]),r.createElement(s.CallHeader,{translation:L,speakers:m?C:null,hands:T,time:y,network:null!==(a=null===(t=_.participants[_.me])||void 0===t?void 0:t.networkStatus)&&void 0!==a?a:1,networkTooltipText:v("calls_status_bad_internet_connection")})}},139230:(e,t,a)=>{"use strict";a.d(t,{ManagementViews:()=>n,CallManagementContainer:()=>N});var n,r=a(570655),i=a(667294),o=a(50533),l=a(121255),s=a(186983),c=a(445586),u=a(177774),d=a(154463),p=a(881150),A=a(187252),_=a(820717),m=a(444083),g=a(389953),v=a(662208),f=a(697483),E=a(562192),C=a(58600),h=a(745284),S=a(498110),T=a(719481),I=a(564840);!function(e){e[e.MAIN=0]="MAIN",e[e.CALL_LINK=1]="CALL_LINK",e[e.ADD_PARTICIPANTS=2]="ADD_PARTICIPANTS",e[e.WAITING_HALL=3]="WAITING_HALL"}(n||(n={}));var N=function(e){var t,a,N=e.bridge,y=e.SDK,P=e.navigateToConvo,b=e.navigateToProfile,L=e.allowAddMembers,M=void 0!==L&&L,w=(0,o.useSelector)((function(e){return e})),O=(0,o.useDispatch)(),k=(0,i.useContext)(S.ConfigContext).allowWaitingHall,D=(0,r.__read)((0,i.useState)(w.callData.callUrlLink||""),2),R=D[0],B=D[1],G=w.managementView||n.MAIN,H=(0,r.__read)((0,i.useState)(G),2),x=H[0],U=H[1],V=(0,r.__read)((0,i.useState)(!1),2),F=V[0],W=V[1],z=(0,r.__read)((0,i.useState)(!1),2),Q=z[0],j=z[1],Y=(0,r.__read)((0,i.useState)(!1),2),K=Y[0],J=Y[1],q=(0,r.__read)((0,i.useState)(!1),2),Z=q[0],X=q[1],$=(0,r.__read)((0,i.useState)(!1),2),ee=$[0],te=$[1],ae=M||!!(null===(t=w.callData.conversation)||void 0===t?void 0:t.canAddMembers),ne=null===(a=w.callData)||void 0===a?void 0:a.canFinishCall,re=i.useContext(v.LangContext).getLang,ie=(0,h.isRequireAuthToJoin)(w),oe=(0,h.isWaitingHallEnabled)(w),le=(0,i.useCallback)((function(){O({type:l.MANAGEMENT,isOpen:!1})}),[]),se=(0,i.useCallback)((function(){U(n.MAIN)}),[]),ce=function(e){var t=w.callData.callId||"";return W(!0),(0,_.loadCallUrlLink)(O,t,e,(0,h.isAuthedByGroupId)(w)?w.groupId:0).then((function(e){B(e),W(!1)})).catch((function(e){console.error(e),W(!1),O({type:l.ERROR,text:re("calls_get_url_link_error_text")})}))},ue=(0,i.useCallback)((function(){U(n.CALL_LINK),R||ce(!1).catch((function(){U(n.MAIN)}))}),[w.callData.callId,R]),de=(0,i.useCallback)((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!0});var e=[(0,_.loadFriendsAction)(N,w,O)].concat((0,g.isChatPeer)(w.peer)?[(0,_.loadChatMembersAction)(w,O,w.peer,w.callData.conversation)]:[]).concat(N.authorizedGroupId?[(0,_.loadAllowedToCallGroupMembersAction)(N,w,O)]:[]);return Promise.all(e).then((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!1}),U(n.ADD_PARTICIPANTS)})).catch((function(e){console.error(e),O({type:l.SHOW_LOADER,isLoaderVisible:!1})}))}),[w.peer,w.callData,w.friends,w.groupMembers]),pe=(0,i.useCallback)((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!0});var e=[(0,T.loadAdditionalWaitingHall)(w,O)];return Promise.all(e).then((function(){O({type:l.SHOW_LOADER,isLoaderVisible:!1}),U(n.WAITING_HALL)})).catch((function(e){console.error(e),O({type:l.SHOW_LOADER,isLoaderVisible:!1})}))}),[w.waitingHall]),Ae=(0,i.useCallback)((function(){O({type:l.TOGGLE_POPUP}),(0,m.onForceCallFinish)(y,w,O,re)}),[w.callData.callId,w.imHash]);(0,i.useEffect)((function(){G===n.CALL_LINK&&ue()}),[]),(0,i.useEffect)((function(){var e=w.participants[w.me],t=(0,f.participantIsAdmin)(e),a=t;J(t),X(a),te(k&&t)}),[w.participants[w.me]]);var _e=(0,i.useCallback)((function(e){(0,_.setAnonymousJoin)(e)}),[]),me=(0,i.useCallback)((function(e){(0,_.setWaitingHall)(e)}),[]),ge=(0,i.useCallback)((function(){return j(!0)}),[]),ve=(0,i.useCallback)((function(){return j(!1)}),[]),fe=(0,i.useCallback)((function(){ce(!0).catch((function(){U(n.MAIN)}))}),[w.callData.callId,R]);return i.createElement(i.Fragment,null,x===n.MAIN&&i.createElement(s.CallManagementModal,{title:re("calls_management_participants"),actionButtons:(ne?[i.createElement(p.default,{onClick:Ae,key:"forceCallFinish",appearance:"secondary"},re("calls_force_call_finish"))]:[]).concat([i.createElement(p.default,{onClick:y.hangup,key:"leave"},re("calls_leave_call"))]),onCloseModal:le},i.createElement(c.CallManagementMenu,{isLinkBlockShown:ae,linkBlockTitle:re("calls_menu_link"),onLinkBlockClick:ue,callUrlLink:R}),i.createElement(d.CallParticipantListContainer,{SDK:y,onAddClick:de,onShowMoreWaitingHall:pe,navigateToProfile:b,navigateToConvo:P})),x===n.CALL_LINK&&i.createElement(s.CallManagementModal,{title:re("calls_management_link"),hint:ie?re("calls_management_link_anonymous_disallowed_hint"):"",onCloseModal:le,isWithBackButton:G!==n.CALL_LINK,onBackClick:se,actionButtons:(Z?[i.createElement(p.default,{key:"invalidate-link",appearance:"tertiary",onClick:fe},re("calls_link_invalidate"))]:[]).concat([i.createElement(C.CopyText,{key:"copy-link",text:R},i.createElement(p.default,{className:"CallManagementModal__copyTextButton",disabled:F,onClick:ge},re("calls_link_copy")))])},i.createElement(u.CallLink,{link:R,isLinkLoading:F,isCopied:Q,hideCopiedText:ve}),K&&i.createElement(E.CallLinkSettings,{onRequireAuthToJoinChanged:_e,requireAuthToJoin:ie,isWaitingHallBlockShown:ee,onWaitingHallEnabledChanged:me,isWaitingHallEnabled:oe})),x===n.ADD_PARTICIPANTS&&i.createElement(A.GroupCallSetupContainer,{bridge:N,SDK:y,isWithBackButton:!0,onBackClick:se}),x===n.WAITING_HALL&&i.createElement(I.WaitingHallListContainer,{isModal:!0,isWithBackButton:!0,onBackClick:se,navigateToProfile:b}))}},690015:(e,t,a)=>{"use strict";a.d(t,{CallNotificationContainer:()=>g});var n=a(570655),r=a(667294),i=a(121255),o=a(80125),l=a(662208),s=a(925082),c=a(112877),u=a(818114),d=a(911099),p=a(50533),A=a(745284),_=a(662727),m=a(697483),g=function(e){var t=e.dispatch,a=e.notification,g=e.participant,v=r.useContext(l.LangContext),f=v.getLang,E=v.langSex,C=(0,p.useSelector)((function(e){return e})),h=(0,r.useMemo)((function(){return function(e,t,a,n){void 0===n&&(n={name:"",sex:"0",shortName:""});if(!e)return null;switch(e.type){case i.NotificationType.SPEAKING_ON_MUTE:return t("calls_notification_mic_is_mute");case i.NotificationType.SCREEN_SHARING_STARTED:if(!n||!n.name)return r.createElement("span",null,t("calls_notification_screen_sharing_started"));var l=a(n.sex,"calls_notification_user_started_screen_sharing",t("calls_notification_user_started_screen_sharing",!0));return r.createElement("span",null,l.replace("{user}",n.name));case i.NotificationType.RAISED_HAND:if(!n||!n.name)return null;l=a(n.sex,"calls_notification_raised_hand",t("calls_notification_raised_hand",!0));return r.createElement("span",null,l.replace("{user}",n.name));case i.NotificationType.BAD_NETWORK_CONNECTION:return r.createElement("span",null,t("calls_notification_bad_network_connection"));case i.NotificationType.BAD_NETWORK_CONNECTION_DISABLE_CAMERA:return[r.createElement(o.DisabledVideoIconS,{key:"icon"}),r.createElement("span",{key:"text"},t("calls_notification_bad_network_connection_disable_camera"))];case i.NotificationType.ADMIN_MUTE:return r.createElement("span",{key:"text"},t("calls_notification_admin_mute"));case i.NotificationType.ADMIN_MUTE_PERMANENT:return r.createElement("span",{key:"text"},t("calls_notification_admin_permanent_mute"));case i.NotificationType.ADMIN_ROLE_GRANTED:return r.createElement("span",{key:"text"},t("calls_notification_admin_role_granted"));case i.NotificationType.USER_GRANTED_WITH_ADMIN_ROLE:var s=t("calls_notification_user_granted_with_admin_role").replace("{name}",n.shortName||n.name);return r.createElement("span",{key:"text"},s);case i.NotificationType.PINNED_BY_ADMIN:return r.createElement("span",{key:"text"},t("calls_notification_admin_pinned_self"));case i.NotificationType.USER_PINNED_BY_ADMIN:s=t("calls_notification_admin_pinned_user").replace("{name}",n.shortName||n.name);return r.createElement("span",{key:"text"},s);case i.NotificationType.PUSH_TO_TALK:s=t("calls_notification_push_to_talk_enabled");return[e.data?r.createElement(c.MicIconWithSpeakingIndicator,{key:"icon"}):r.createElement(u.MicIcon,{key:"icon"}),r.createElement("div",{key:"text",className:"CallNotification__pushToTalkText"},s)];default:return null}}(a,f,E,g)}),[a]),S=(0,r.useRef)(0);(0,r.useEffect)((function(){return S.current&&window.clearTimeout(S.current),a&&0!==a.timer&&(S.current=window.setTimeout((function(){t({type:i.CALL_NOTIFICATION,notification:null}),S.current=0}),a.timer||i.defaultNotificationLifeSpan)),function(){S.current&&window.clearTimeout(S.current)}}),[a]);var T=(0,r.useMemo)((function(){return(0,m.getActiveParticipants)(C.participants,C.me,C.groupId,C.meGroup)}),[C.participants,C.me,C.groupId,C.meGroup]),I=(0,r.useMemo)((function(){return(0,A.isGroupCallByPeer)(C.peer)}),[C.peer]),N=T.length>1,y=I||T.length>2,P=N||(0,m.isParticipantWithVideo)(C.participants[C.me]),b=y&&P&&C.isOratorMode,L=(0,d.classNames)("",{CallNotification__pushToTalk:(null==a?void 0:a.type)===i.NotificationType.PUSH_TO_TALK,CallNotification__orator:b&&C.isShownParticipantsAside}),M=C.peer,w=(0,A.isGroupCallByPeer)(M)?C.callData.conversation:C.participants[M],O=(0,n.__read)(r.useState(),2),k=O[0],D=O[1],R=(0,n.__read)(r.useState(""),2),B=R[0],G=R[1];return(null==w?void 0:w.status)!==k&&(G((0,_.getCallStatus)(C,f)),D(null==w?void 0:w.status)),r.useEffect((function(){G((0,_.getCallStatus)(C,f))}),[C]),a||B?r.createElement(s.CallNotification,{className:L},B||h):null}},154463:(e,t,a)=>{"use strict";a.d(t,{CallParticipantListContainer:()=>C});var n=a(570655),r=a(667294),i=a(50533),o=a(813245),l=a(750598),s=a(248586),c=a(884143),u=a(431469),d=a(279060),p=a(310765),A=a(51247),_=a(916972),m=a(697483),g=a(662208),v=a(613335),f=a(564840),E=a(464380),C=function(e){var t=e.SDK,a=e.onAddClick,C=e.navigateToProfile,h=e.navigateToConvo,S=e.onShowMoreWaitingHall,T=(0,i.useSelector)((function(e){return e})),I=r.useContext(g.LangContext).getLang,N=(0,n.__read)(function(e){var t=!!e.groupId;return Object.values(e.participants).reduce((function(a,n){var r=n,i=!1;return n.peerId===e.me?(t&&(null==e?void 0:e.meGroup)&&(r=(0,v.mergeGroupToParticipant)(e.meGroup,n)),i=!0):n.status&&(i=!0),i&&(a[0].push(r),r.name&&a[1].push(r)),a}),[[],[]])}(T),2),y=N[0],P=N[1],b=(0,n.__read)((0,r.useState)(""),2),L=b[0],M=b[1],w=(0,r.useCallback)((function(e){return e.name}),[]),O=(0,r.useCallback)((function(e){return e.peerId}),[]),k=(0,u.useIndexer)(P,w,O),D=(0,m.canMuteParticipants)(T.participants[T.me]),R=L?k.search(L):y,B=(0,r.useCallback)((function(e){M(e.target.value)}),[]),G=!(0,m.isParticipantAnonym)(T.me);return r.createElement(o.CallParticipantList,{searchQuery:L,onSearchChange:B,length:R.length,waitingHallList:T.waitingHall&&r.createElement(f.WaitingHallListContainer,{isModal:!1,navigateToProfile:C,onMore:S})},!L&&G&&r.createElement(l.default,{selectable:!1,border:!1,key:"add"},r.createElement(_.ListAddControl,{onClick:a},I("calls_add_participants"))),R.length>0&&R.map((function(e){var a,n,i,o=e.peerId!==T.me&&e.status===E.ParticipantStatus.WAITING,c=!o&&!(null===(a=e.mediaSettings)||void 0===a?void 0:a.isAudioEnabled),u=!o&&!(null===(n=e.mediaSettings)||void 0===n?void 0:n.isVideoEnabled),_=!o&&!!(null===(i=e.statusData)||void 0===i?void 0:i.hand),g=!!T.speakers[e.peerId],v=o||c||_||g,f=e.peerId===T.me,S=!o&&(c||u)&&D&&!f;return r.createElement(l.default,{selectable:!1,border:!1,key:e.peerId,aside:r.createElement(r.Fragment,null,v&&r.createElement(A.ParticipantIndicators,{showSpeaking:g,showRaisedHand:_,showAudioDisabled:c,showConnecting:o,showRaisedHandTooltip:S,onRaisedHandClick:S?function(){return function(e){var a=T.participants[e],n=(0,m.getParticipantExternalId)(a);n&&t.unmuteRequest(n,[E.MediaOption.AUDIO,E.MediaOption.VIDEO,E.MediaOption.SCREEN_SHARING]).catch(console.log)}(e.peerId)}:void 0,key:"indicators"}),r.createElement(p.ParticipantMenuContainer,{SDK:t,participant:e,key:"menu",navigateToConvo:h,navigateToProfile:C}))},r.createElement(s.default,{onLinkClick:C,photo:r.createElement(d.CallPhoto,{id:e.peerId,photo:e.photo,alt:e.name||"",size:"xxxs",showCreatorBadge:(0,m.isCreator)(e),showAdminBadge:(0,m.isAdmin)(e)}),title:e.name,href:e.link,target:"_blank"}))})),L&&0===R.length&&r.createElement(c.default,null,I("calls_participants_not_found")))}},165999:(e,t,a)=>{"use strict";a.d(t,{CallsErrorBoundary:()=>o});var n=a(570655),r=a(667294),i=a(121255),o=function(e){function t(t){var a=e.call(this,t)||this;return a.state={hasError:!1},a}return(0,n.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e){switch(this.props.mode){case i.Mode.CALL:this.props.SDK.hangup();break;case i.Mode.INCOMING:this.props.SDK.declineCall()}this.props.onReset(),this.setState({hasError:!1}),console.error("Calls crashed:",e,e)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(r.Component)},963532:(e,t,a)=>{"use strict";a.d(t,{CautionContainer:()=>A});var n=a(667294),r=a(50533),i=a(881150),o=a(121255),l=a(464380),s=a(614914),c=a(745284),u=a(697483),d=a(662208),p=a(440896),A=function(e){var t=e.isIncoming,a=void 0!==t&&t,A=(0,r.useSelector)((function(e){return e})),_=(0,r.useDispatch)(),m=(0,n.useContext)(d.LangContext).getLang,g=m(a?"calls_reject_title":"calls_hangup_description"),v=m(a?"calls_reject_description":"calls_hangup_description"),f=(0,n.useCallback)((function(){_({type:o.SHOW_CAUTION_BOX,isOpen:!1})}),[]);return n.createElement(p.CallError,{title:g,onClose:f,actionButtons:n.createElement(n.Fragment,null,n.createElement(i.default,{onClick:function(){f(),a?(0,l.declineCall)().catch((function(){})):((0,l.hangup)().catch((function(){})),s.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:A.callData.callId,peer_id:A.peer,is_group_call:(0,c.isGroupCallByPeer)(A.peer),reason:"none",group_call_users_count:(0,u.getActiveParticipants)(A.participants,A.me,A.groupId,A.meGroup).length}))}},m("calls_yes")),n.createElement(i.default,{onClick:f},m("calls_no"))),text:n.createElement("span",{dangerouslySetInnerHTML:{__html:v}})})}},923947:(e,t,a)=>{"use strict";a.d(t,{CollapsedCallContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(275109),l=a(400412),s=a(180474),c=a(121255),u=a(298811),d=a(745284),p=a(697483),A=a(662208),_=a(464380),m=function(e){var t,a,m,g,v=e.SDK,f=(0,i.useSelector)((function(e){return e})),E=(0,i.useDispatch)(),C=r.useContext(A.LangContext).getLang,h=f.peer,S=(0,u.isAnyoneWithVideo)(f),T=(0,d.isGroupCallByPeer)(h)?f.callData.conversation:f.participants[h],I=f.participants[f.me],N=(0,p.getCallVisibleParticipant)(f,S),y=(0,p.isParticipantWithVideo)(I)&&N&&N.peerId!==f.me,P=(0,r.useCallback)((function(){E({type:c.CHANGE_UI_MODE,mode:c.UIMode.DEFAULT})}),[]),b=(null===(t=null==I?void 0:I.mediaSettings)||void 0===t?void 0:t.isAudioEnabled)||(null===(a=I.permissions)||void 0===a?void 0:a.audio)>0,L=(0,r.useCallback)((function(){var e;v.toggleLocalAudio(!(null===(e=I.mediaSettings)||void 0===e?void 0:e.isAudioEnabled))}),[f]);return r.createElement(o.CollapsedCall,null,f.mode===c.Mode.INCOMING&&r.createElement(l.CallWidget,{id:h,title:(null==T?void 0:T.tab)||"",photo:(null==T?void 0:T.photo)||"",status:C("calls_incoming_collapsed"),isIncoming:!0,onClick:P}),f.mode!==c.Mode.INCOMING&&r.createElement(s.CallVideoWidget,(0,n.__assign)({localVideoStream:y?(0,p.getStream)(I):void 0,isLocalAudioEnabled:!!(null===(m=I.mediaSettings)||void 0===m?void 0:m.isAudioEnabled),isLocalAudioAllowed:b,isLocalScreenSharing:!!(null===(g=I.mediaSettings)||void 0===g?void 0:g.isScreenSharingEnabled)},function(e,t,a){var n,r;return e?{participantId:e.peerId,isMe:e.peerId===a,isWithVideo:(0,p.isParticipantWithVideo)(e),isWithAudio:!!(null===(n=e.mediaSettings)||void 0===n?void 0:n.isAudioEnabled),isScreenSharing:!!(null===(r=e.mediaSettings)||void 0===r?void 0:r.isScreenSharingEnabled),stream:(0,p.getStream)(e),photo:e.photo,name:e.name,status:e.status,networkStatus:e.networkStatus}:{participantId:t&&t.peerId||0,isMe:!1,isWithVideo:!1,isWithAudio:!1,isScreenSharing:!1,stream:void 0,photo:t&&t.photo||"",name:t&&t.tab||"",status:t&&t.status||_.ParticipantStatus.CONNECTED,networkStatus:1}}(N,T,f.me),{onRestoreCall:P,onToggleAudio:L})))}},241715:(e,t,a)=>{"use strict";a.d(t,{CollapsedWaitingHallContainer:()=>u});var n=a(570655),r=a(667294),i=a(50533),o=a(275109),l=a(180474),s=a(121255),c=a(697483),u=function(e){var t,a=e.SDK,u=(0,i.useSelector)((function(e){return e})),d=(0,i.useDispatch)(),p=u.participants[u.me],A=(0,r.useCallback)((function(){d({type:s.CHANGE_UI_MODE,mode:s.UIMode.DEFAULT})}),[]),_=(0,r.useCallback)((function(){var e;a.toggleLocalAudio(!(null===(e=p.mediaSettings)||void 0===e?void 0:e.isAudioEnabled))}),[u]);return r.createElement(o.CollapsedCall,null,r.createElement(l.CallVideoWidget,(0,n.__assign)({},function(e){var t,a;return{participantId:e.peerId,isMe:!0,isWithVideo:(0,c.isParticipantWithVideo)(e),isWithAudio:!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),isScreenSharing:!!(null===(a=e.mediaSettings)||void 0===a?void 0:a.isScreenSharingEnabled),stream:(0,c.getStream)(e),photo:e.photo,name:e.name,status:e.status,networkStatus:e.networkStatus}}(p),{onRestoreCall:A,isMe:!0,isLocalAudioEnabled:!!(null===(t=p.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),isLocalAudioAllowed:!0,isLocalScreenSharing:!1,onToggleAudio:_})))}},599648:(e,t,a)=>{"use strict";a.d(t,{ErrorContainer:()=>u});var n=a(667294),r=a(50533),i=a(881150),o=a(121255),l=a(662208),s=a(464380),c=a(440896),u=function(e){var t=e.title,a=e.text,u=e.onCloseFatal,d=e.handleType,p=e.callId,A=e.bridge,_=(0,r.useDispatch)(),m=n.useContext(l.LangContext).getLang,g=function(){switch(_({type:o.ERROR,isClosed:!0}),d){case o.ErrorHandleType.FATAL:u();break;case o.ErrorHandleType.DECLINE:(0,s.declineCall)().catch((function(){}));break;case o.ErrorHandleType.PROCESS:(0,s.processPush)(p||"").then((function(){(0,s.declineCall)().catch((function(){}))})).catch((function(e){A.debug&&console.error("Delayed by error push process error",e)}))}},v=a||m("calls_error"),f=v.match(/<\s?[a-zA-Z0-9]+\s?\/?>/)?n.createElement("span",{dangerouslySetInnerHTML:{__html:v}}):v;return n.createElement(c.CallError,{title:t||m("calls_oops"),onClose:g,actionButtons:n.createElement(i.default,{onClick:g},m("calls_close")),text:f})}},379981:(e,t,a)=>{"use strict";a.d(t,{FeedbackContainer:()=>f});var n,r=a(570655),i=a(667294),o=a(50533),l=a(269481),s=a(121255),c=a(25947),u=a(662208),d=a(614914),p=a(745284),A=a(950890),_=a(659397),m=a(254060),g=a(731585),v=a(244809);!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ADVANCE=1]="ADVANCE"}(n||(n={}));var f=function(e){var t=e.onSuccessFeedback,a=(0,o.useDispatch)(),f=(0,o.useSelector)((function(e){return e})),E=i.useContext(u.LangContext).getLang,C=(0,r.__read)((0,i.useState)(n.DEFAULT),2),h=C[0],S=C[1],T=(0,r.__read)((0,i.useState)(!0),2),I=T[0],N=T[1],y=(0,r.__read)((0,i.useState)(!1),2),P=y[0],b=y[1],L=new Map([["DID_NOT_HEAR_INTERLOCUTOR",E("calls_feedback_reason_did_not_hear_interlocutor")],["DID_NOT_SEE_INTERLOCUTOR",E("calls_feedback_reason_did_not_see_interlocutor")],["BAD_VIDEO_QUALITY",E("calls_feedback_reason_bad_video_quality")],["VIDEO_FREEZES",E("calls_feedback_reason_video_freezes")],["VERY_QUIET_SOUND",E("calls_feedback_reason_very_quiet_sound")],["BAD_SOUND_QUALITY",E("calls_feedback_reason_bad_sound_quality")],["SOUND_DID_NOT_MATCH_THE_VIDEO",E("calls_feedback_reason_sound_did_not_match_the_video")],["FAILED_TO_TURN_ON_CAMERA_OR_MICROPHONE",E("calls_feedback_reason_failed_to_turn_on_camera_or_microphone")]]),M=(0,r.__read)((0,i.useState)({user_response:0,feedback:[],custom_feedback:void 0}),2),w=M[0],O=M[1],k=(0,r.__read)((0,i.useState)(Array.from(L,(function(e){return{name:(0,r.__read)(e,1)[0],checked:!1}}))),1)[0],D=function(){a({type:s.CHANGE_MODE,mode:s.Mode.READY})},R=function(e){var t=e.target.getAttribute("data-response");if(t){var a=parseInt(t,10);a<=3&&S(n.ADVANCE),O((0,r.__assign)((0,r.__assign)({},w),{user_response:a})),N(!1)}},B=function(e,t){k.forEach((function(a){a.name===e&&(a.checked=t)})),O((function(e){return(0,r.__assign)((0,r.__assign)({},e),{feedback:k.filter((function(e){return e.checked})).map((function(e){return e.name}))})}))},G=function(e,t){b(t)},H=function(e){O((0,r.__assign)((0,r.__assign)({},w),{custom_feedback:e.currentTarget.value}))};return i.createElement(l.CallModal,{onClose:D,onBackdropClick:D},i.createElement("section",{className:"Call"},i.createElement(c.FeedbackScreen,{title:h===n.DEFAULT?E("calls_feedback_default_title"):E("calls_feedback_advance_title"),sendButtonClick:function(){var e=f.lastCallData?f.lastCallData.peerId:0;d.callStats.logEvent({call_event_type:s.CallActionEventType.USER_FEEDBACK_RECEIVED,session_id:f.lastCallData?f.lastCallData.callId:"",peer_id:e,is_group_call:(0,p.isGroupCallByPeer)(e),user_response:w.user_response,feedback:w.feedback,custom_feedback:P&&w.custom_feedback?w.custom_feedback:void 0}),a({type:s.CHANGE_MODE,mode:s.Mode.READY}),t&&t()},skipButtonClick:D,sendButtonDisabled:I},h===n.DEFAULT?i.createElement("div",{className:"FeedbackScreen__stars",onClick:R},[1,2,3,4,5].map((function(e,t){return i.createElement("div",{className:(0,_.classNames)("FeedbackScreen__star",{"FeedbackScreen__star--active":e<=w.user_response}),"data-response":e,key:t},i.createElement(A.StarOutline,{className:"FeedbackScreen__starIcon FeedbackScreen__starIcon--outline"}),i.createElement(m.StarFilled,{className:"FeedbackScreen__starIcon FeedbackScreen__starIcon--filled"}))}))):i.createElement("div",{className:"FeedbackScreen__voting"},Array.from(L,(function(e){var t=(0,r.__read)(e,2),a=t[0],n=t[1];return i.createElement("div",{className:"FeedbackScreen__votingItem",key:a},i.createElement(g.default,{name:a,className:"FeedbackScreen__votingItemCheckbox",onChange:B},n))})),i.createElement("div",{className:"FeedbackScreen__votingItem FeedbackScreen__votingItem--custom"},i.createElement(g.default,{name:"CUSTOM_FEEDBACK",className:"FeedbackScreen__votingItemCheckbox",onChange:G}),i.createElement(v.default,{className:"FeedbackScreen__votingItemTextArea",placeholder:E("calls_feedback_custom_reason_placeholder"),grow:!1,disabled:!P,onChange:H}))))))}},187252:(e,t,a)=>{"use strict";a.d(t,{GroupCallSetupContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(881150),s=a(186983),c=a(782605),u=a(298811),d=a(614914),p=a(745284),A=a(697483),_=a(662208),m=function(e){var t=e.SDK,a=e.bridge,m=e.isWithBackButton,v=e.onBackClick,f=(0,i.useSelector)((function(e){return e})),E=(0,i.useDispatch)(),C=r.useContext(_.LangContext).getLang,h=(0,n.__read)((0,r.useState)(f.preselectedIds||[]),2),S=h[0],T=h[1],I=(0,n.__read)((0,r.useState)((0,A.getActiveParticipantsCount)(f)),1)[0]+S.length,N=function(){E({type:o.GROUP_CALL_SETUP,open:!1,preselectedIds:null}),E({type:o.MANAGEMENT,isOpen:!1})},y=0===S.length,P=function(e){N(),E({type:o.MANUAL_ADD_PARTICIPANTS,participants:e});var a=e.map((function(e){return new Promise((function(a){t.addParticipant(String(e)).then(a).catch((function(t){"auth.banned"===t.message?a(e):"vk-participant-is-rejected-error"===t.message?E({type:o.ERROR,text:C("calls_error_cant_add_because_of_privacy")}):a(null)}))}))}));Promise.all(a).then((function(e){if((e=e.filter((function(e){return void 0!==e}))).length){var t=function(e,t){var a=(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(e.friends)),(0,n.__read)(e.chatMembers)),(0,n.__read)(e.groupMembers)),r=[];return a.filter((function(e){var a=e.id;return!(!t.includes(a)||r.includes(a))&&(r.push(a),!0)}))}(f,e);E({type:o.UNBAN_PARTICIPANTS,data:{members:t}})}}));var r=(0,n.__read)((0,u.convertClientData)(function(e,t){var a=e.chatData||e.callData.conversation,r=t.reduce((function(t,a){return e.participants[a]||t.set(a,!0),t}),new Map);if(0===r.size)return[a,[]];var i=e.chatMembers.length<e.friends.length?e.chatMembers:e.friends,o=e.chatMembers.length<e.friends.length?e.friends:e.chatMembers,l=i.reduce((function(e,t){return r.get(t.id)&&(e.smallerListData.push(t),e.smallerListMap.set(t.id,!0)),e}),{smallerListData:[],smallerListMap:new Map}),s=l.smallerListData,c=l.smallerListMap;if(s.length===r.size)return[a,s];var u=o.filter((function(e){return!c.get(e.id)&&r.get(e.id)}));return[a,(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(s)),(0,n.__read)(u))]}(f,e)),2),i=r[0],l=r[1];E({type:o.LOAD_PEERS,conversation:i,members:l}),d.callStats.logEvent({call_event_type:o.CallActionEventType.OUTGOING_CALL_ADD_PARTICIPANTS_SENT,session_id:f.callData.callId,peer_id:f.peer.toString(),is_group_call:(0,p.isGroupCallByPeer)(f.peer),group_call_users_count:S.length})},b=(0,r.useCallback)((function(){P(S)}),[S]);return r.createElement(s.CallManagementModal,{title:C("calls_add_participants_to_call"),onCloseModal:N,actionButtons:r.createElement(l.default,{key:"add",disabled:y,onClick:b},C("calls_add")),hint:g(I,f.participantLimit,C),isWithBackButton:m,onBackClick:m?v:function(){}},r.createElement(c.AddParticipantContainer,{groupId:a.authorizedGroupId||0,onChange:T,onClickCallAll:function(e){P(e)}}))};function g(e,t,a){return e<2?a("calls_management_add_warning"):a("calls_selected").replace("{selected}",""+e).replace("{limit}",""+t)}},536559:(e,t,a)=>{"use strict";a.d(t,{IncomingCallContainer:()=>m});var n=a(667294),r=a(50533),i=a(309605),o=a(826988),l=a(995420),s=a(44781),c=a(789241),u=a(269481),d=a(745284),p=a(121255),A=a(614914),_=a(662208);function m(e){var t=e.SDK,a=e.bridge,m=(0,r.useSelector)((function(e){return e})),g=m.peer,v=m.callData,f=m.participants,E=m.caller,C=(0,r.useDispatch)(),h=n.useContext(_.LangContext).getLang,S=E;S||(S=(0,d.isGroupCallByPeer)(g)?v.conversation:f[g]);var T=v.type===p.CallType.VIDEO,I=h(T?"calls_incoming_videocall":"calls_incoming_audiocall"),N=h(T?"calls_reply_with_audio":"calls_reply"),y=h(T?"calls_reject_call":"calls_reject"),P=function(){t.declineCall(),A.callStats.logEvent({call_event_type:p.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:v.callId,peer_id:g,is_group_call:(0,d.isGroupCallByPeer)(g),reason:"none"})};return n.createElement(u.CallModal,{onClose:P,isIncoming:!0,isCautionBoxShown:!0},n.createElement(c.IncomingCall,{id:g,title:(null==S?void 0:S.tab)||"",description:I,photo:(null==S?void 0:S.photo)||"",onCollapseCall:function(){C({type:p.CHANGE_UI_MODE,mode:p.UIMode.COLLAPSED})}},n.createElement(n.Fragment,null,T&&n.createElement(i.CallButton,{text:h("calls_reply_with_video"),type:i.CallButtonTypes.POSITIVE,icon:n.createElement(o.VideoIcon,null),onClick:function(){return a.acceptCall(!0,!0)}}),n.createElement(i.CallButton,{text:N,type:T?i.CallButtonTypes.REGULAR:i.CallButtonTypes.POSITIVE,icon:n.createElement(l.PhoneIcon,null),onClick:function(){return a.acceptCall(!1,!0)}}),n.createElement(i.CallButton,{text:y,type:i.CallButtonTypes.NEGATIVE,icon:n.createElement(s.RejectIcon,null),onClick:P}))))}},656504:(e,t,a)=>{"use strict";a.d(t,{JoinScreenContainer:()=>g});var n=a(570655),r=a(667294),i=a(991390),o=a(138671),l=a(838480),s=a(121255),c=a(298811),u=a(788822),d=a(329538),p=a(662208),A=a(253312),_=a(498110),m=a(697483),g=function(e){var t=e.isAnonym,a=e.joinLink,g=e.vkJoinLink,f=e.title,E=e.members,C=e.membersCount,h=e.conversationData,S=e.withPopup,T=e.onBeforeCallStart,I=e.onAfterCallFinish,N=e.onClose,y=e.bridge,P=e.entryPoint,b=e.tabIsMaster,L=e.tabIsIdle,M=e.onError,w=e.isDev,O=e.okPublicKey,k=r.useContext(p.LangContext),D=k.getLang,R=k.langNumeric,B=(0,n.__read)((0,r.useState)(""),2),G=B[0],H=B[1],x=(0,n.__read)((0,r.useState)(null),2),U=x[0],V=x[1],F=(0,n.__read)((0,r.useState)(!1),2),W=F[0],z=F[1],Q=!1,j=r.useContext(_.ConfigContext),Y=j.allowCallByName,K=j.nativeAppJoin,J=E?E.slice(0,3).map((function(e){var t=e.firstName||e.shortName||e.name||"";return e.photo_100?{src:e.photo_100,alt:t,key:e.peerId}:{id:e.peerId,text:t.slice(0,1)}})):[],q=(0,r.useCallback)((function(e){H(e.target.value)}),[]),Z=(0,r.useCallback)((function(e){if(t)return Q?Promise.resolve():(Q=!0,function(e,t,a,n,r,i){if(e)return Promise.resolve(e);return(0,d.getJoinLinkDetails)(a,!0).then((function(e){var o=e.secret,l=void 0===o?"":o,c=e.user_id,u=void 0===c?0:c,p=e.preview;return(0,d.getAnonymCallToken)(a,u,n,l).then((function(e){var a=e.token,o=e.secret,l=void 0===o?"":o,c={is_dev:v(i),key:r,token:a,ok_user:u,secret:l,is_anonym:!0,me:{canAddMembers:!1,firstName:n,peerId:u,id:u,sex:"0",shortName:n,name:n,lastName:"",link:"",photo:"",photo_100:""}},d={callPreview:{tab:p.title,photo:p.photo.photo_200},callsCredentials:c,participantLimit:128,callsOkStaging:v(i),callsLogging:!1,CallsIncomingCall:!1,callsAllowBanParticipant:!1,callsFeedbackScreenEnabled:!1,callsVideoSlotsEnabled:!0,videoSlotsCount:s.VIDEO_SLOTS_COUNT,callsAllowCallByName:!1,callsNativeApp:!1,callsNativeAppJoin:!1,callsEnableScreenTrack:!0,callsEnableProducerScreenTrack:!0,callsAllowWaitingHall:!1,callsAllowPushToTalk:!1,callsBadNetwork:!1,callsBadNetworkP2P:!1};return t(d),d}))}))}(U,V,g,G,O,w).then((function(e){return function(e){var t=e.bridge,a=e.inited,n=e.setInited,r=e.data,i=e.onBeforeCallStart,o=e.onAfterCallFinish,l=e.tabIsMaster,s=e.tabIsIdle,c=e.langUtils;if(a)return Promise.resolve();var u=r.callPreview,d=r.callsCredentials,p=r.participantLimit,A=r.callsOkStaging,_=r.callsLogging,m=r.CallsIncomingCall,g=r.callsAllowBanParticipant,v=r.callsFeedbackScreenEnabled,f=r.callsVideoSlotsEnabled,E=r.videoSlotsCount,C=r.callsAllowCallByName,h=r.callsNativeApp,S=r.callsNativeAppJoin,T=r.callsEnableScreenTrack,I=r.callsEnableProducerScreenTrack,N=r.callsAllowWaitingHall,y=r.callsAllowPushToTalk,P=r.callsBadNetwork,b=r.callsBadNetworkP2P;return t.init({callPreview:u,callsCredentials:d,imHash:"",participantLimit:p,callsOkStaging:A,onBeforeCallStart:i,onAfterCallFinish:o,tabIsMaster:l,tabIsIdle:s,langUtils:c,toggles:{debugLog:_,incomingCall:m,allowBanParticipant:g,showFeedbackScreen:v,enableVideoSlots:f,videoSlotsCount:E,allowCallByName:C,nativeApp:h,nativeAppJoin:S,enableScreenTrack:T,enableProducerScreenTrack:I,allowWaitingHall:N,allowPushToTalk:y,badNetwork:P,badNetworkP2P:b}}).then((function(){return n(!0)}))}({bridge:y,inited:W,setInited:z,data:e,onBeforeCallStart:T,onAfterCallFinish:I,tabIsMaster:b,tabIsIdle:L,langUtils:k})})).then((function(){return y.joinCallByLink(a,null,e,P)})).catch((function(e){y.eventHandlers.onError&&e&&y.eventHandlers.onError(e);var t="";t="string"==typeof e?e:e&&e.error&&e.error.error_code?(0,c.getTextForApiErrorByCode)(e.error.error_code,!0,D):(0,A.getCallStartErrorText)(e,!0,D)||D("calls_unknown_error"),M&&M(t)})).finally((function(){Q=!1})));if(N&&N(),!h)throw Error("no peer_id to join");return y.joinCallByLink(a,[h,E],e,P).catch((function(e){var t="";t="string"==typeof e?e:e&&e.error&&e.error.error_code?(0,c.getTextForApiErrorByCode)(e.error.error_code,!0,D):D("calls_unknown_error"),M&&M(t)})),Promise.resolve()}),[a,N,G,U,W,O]),X=(0,r.useCallback)((function(){N&&N()}),[N]),$=(0,r.useMemo)((function(){return(0,u.escape)((0,u.decodeHTMLEntities)(f))}),[f]),ee=(0,r.useCallback)((function(){y.showCallByNamePopup(null,P,a)}),[]),te=(0,r.useCallback)((function(){y.showStartCallModal(null,a)}),[]),ae=r.createElement(i.JoinScreen,{isAnonym:t,name:G,onChangeName:q,namePlaceholder:D("calls_name_placeholder"),title:$,label:(0,c.getParticipantsListLabel)(E||[],J,(function(e){return(0,m.isParticipantGroup)(e.peerId)?e.name:e.firstName}),D,R,C),items:J,joinWithVideoText:D("calls_join_with_video"),joinWithAudioText:D("calls_join_with_audio"),onJoinWithVideo:function(){return Z(!0)},onJoinWithAudio:function(){return Z(!1)},disabled:t&&!/^[A-Za-zА-Яа-яЁё0-9_\- ]{2,25}$/.test(G),inputDisabled:!!U,callByNameShow:Y&&!t,callByNameTitle:D("calls_call_by_name_join_by"),callByNameDescription:"",onCallByNameClick:ee,callViaNativeAppShow:K&&!t,callViaNativeAppTitle:D("calls_call_via_native_app_join"),onCallViaNativeAppClick:te});return S?r.createElement(o.default,{onClose:X},r.createElement(l.ModalHeader,{title:D("calls_invite"),onClose:X}),ae):ae},v=function(e){return void 0!==e?e:!(!window.vk||void 0===window.vk.isCallsDevEnv)&&window.vk.isCallsDevEnv}},989819:(e,t,a)=>{"use strict";a.d(t,{KickParticipantContainer:()=>p});var n=a(570655),r=a(667294),i=a(50533),o=a(881150),l=a(121255),s=a(662208),c=a(963985),u=a(697483),d=a(719481),p=function(){var e,t,a,p=(0,i.useDispatch)(),A=r.useContext(s.LangContext),_=A.getLang,m=A.langSex,g=(0,i.useSelector)((function(e){return e})),v=null===(e=g.participantKick)||void 0===e?void 0:e.participant,f=(null===(t=g.participantKick)||void 0===t?void 0:t.type)===l.KickParticipantType.CALL,E=(0,n.__read)((0,r.useState)(!0),2),C=E[0],h=E[1],S=!!v&&(!(0,u.participantIsAdmin)(v)&&!(0,u.participantIsChatAdmin)(v,g.callData.conversation)),T=(0,r.useCallback)((function(){p({type:l.TOGGLE_PARTICIPANTS_KICK})}),[]),I=(0,r.useCallback)((function(){(0,u.kickParticipant)(v,!C).then((function(){!f&&g.waitingHall&&(null==v?void 0:v.peerId)&&(0,d.removeUserFromWaitingHall)(null==v?void 0:v.peerId,g.waitingHall,p)})),T()}),[g.participantKick,C]),N=(0,r.useCallback)((function(e){h(e)}),[]),y=f?"calls_kick_participant_text":"calls_kick_participant_from_waiting_hall_text",P=m(null==v?void 0:v.sex,y,_(y,!0)).replace("{user}",null!==(a=null==v?void 0:v.name)&&void 0!==a?a:""),b=_(f?"calls_kick_participant_kick_button_text":"calls_kick_participant_from_waiting_hall_button_text"),L=_(f?"calls_kick_participant_with_ban_setting":"calls_kick_participant_from_waiting_hall_with_ban_setting");return r.createElement(c.KickParticipantModal,{onClose:T,onAllowReconnectChange:N,description:P,allowBan:S,banText:L,actionButtons:[r.createElement(o.default,{onClick:T,appearance:"secondary",key:"cancel"},_("calls_cancel")),r.createElement(o.default,{onClick:I,key:"stop"},b)]})}},325496:(e,t,a)=>{"use strict";a.d(t,{MuteParticipantContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(881150),l=a(467667),s=a(121255),c=a(697483),u=a(662208),d=a(614914),p=a(745284),A=a(329538),_=a(464380),m=function(e){var t,a,m,g=e.SDK,v=(0,i.useSelector)((function(e){return e})),f=(0,n.__read)((0,r.useState)(!0),2),E=f[0],C=f[1],h=(0,n.__read)((0,r.useState)(""),2),S=h[0],T=h[1],I=(0,n.__read)((0,r.useState)(!0),2),N=I[0],y=I[1],P=(0,i.useDispatch)(),b=r.useContext(u.LangContext).getLang,L=null===(t=v.participantsManagement)||void 0===t?void 0:t.mode,M=null===(a=v.participantsManagement)||void 0===a?void 0:a.participant,w=L===s.ParticipantsManagementMode.SINGLE&&((0,c.isAdmin)(M)||(0,c.isCreator)(M));(0,r.useEffect)((function(){var e;if(L!==s.ParticipantsManagementMode.SINGLE||(0,c.isParticipantAnonym)((null==M?void 0:M.peerId)||0))C(!1);else{P({type:s.SHOW_LOADER,isLoaderVisible:!0});var t=null===(e=v.participantsManagement)||void 0===e?void 0:e.participant;new Promise((function(e,a){t&&t.peerId<0?(0,A.getGroupById)(-t.peerId).then((function(t){var a,n=t.groups;e(n&&n.length>0?null===(a=n[0])||void 0===a?void 0:a.name:"")})).catch((function(e){return a(e)})):(0,A.loadUsers)({user_ids:t&&String(t.peerId),name_case:"acc"}).then((function(t){var a=(0,n.__read)(t,1)[0];e(null==a?void 0:a.first_name)})).catch((function(e){return a(e)}))})).then((function(e){T(e),C(!1),P({type:s.SHOW_LOADER,isLoaderVisible:!1})})).catch(console.log)}}),[L,null===(m=v.participantsManagement)||void 0===m?void 0:m.participant]);var O=(0,r.useCallback)((function(){P({type:s.TOGGLE_PARTICIPANTS_MANAGEMENT})}),[]),k=(0,r.useCallback)((function(){if(L===s.ParticipantsManagementMode.SINGLE){var e=(0,c.getParticipantExternalId)(M);g.muteParticipant(e,[_.MediaOption.AUDIO,_.MediaOption.VIDEO,_.MediaOption.SCREEN_SHARING],!N).catch(console.log).finally(O),d.callStats.logEvent({call_event_type:s.CallActionEventType.USER_MICS_AND_VIDEO_DISABLED,session_id:v.callData.callId,peer_id:v.peer,is_group_call:(0,p.isGroupCallByPeer)(v.peer),mute_permanent:N?s.CallStatMuteType.ONCE:s.CallStatMuteType.PERMANENT})}else L===s.ParticipantsManagementMode.ALL&&(g.muteParticipant(void 0,[_.MediaOption.AUDIO,_.MediaOption.VIDEO,_.MediaOption.SCREEN_SHARING],!N).catch(console.log).finally(O),d.callStats.logEvent({call_event_type:s.CallActionEventType.ALL_MICS_AND_VIDEO_DISABLED,session_id:v.callData.callId,peer_id:v.peer,is_group_call:(0,p.isGroupCallByPeer)(v.peer),mute_permanent:N?s.CallStatMuteType.ONCE:s.CallStatMuteType.PERMANENT}))}),[N]);return L===s.ParticipantsManagementMode.SINGLE&&E?null:r.createElement(l.MuteParticipantModal,{onClose:O,allowUnmute:N,unmuteToggleDisabled:w,onUnmuteToggle:function(e,t){return y(t)},title:L===s.ParticipantsManagementMode.SINGLE?b("calls_mute_participant_dialog_title").replace("{name}",null!=S?S:null==M?void 0:M.name):b("calls_mute_all_participants_dialog_title"),description:L===s.ParticipantsManagementMode.SINGLE?b("calls_mute_participant_dialog_description").replace("{name}",null!=S?S:null==M?void 0:M.name):b("calls_mute_all_participants_dialog_description"),toggleSign:L===s.ParticipantsManagementMode.SINGLE?b("calls_mute_participant_dialog_permanent_toggle"):b("calls_mute_all_participants_dialog_permanent_toggle"),actionButtons:[r.createElement(o.default,{onClick:O,appearance:"secondary",key:"cancel"},b("calls_cancel")),r.createElement(o.default,{onClick:k,key:"disable"},b("calls_mute_participant_dialog_action"))]})}},290514:(e,t,a)=>{"use strict";a.d(t,{NotificationWithButtonContainer:()=>A});var n=a(667294),r=a(121255),i=a(662208),o=a(50533),l=a(881150),s=a(298811),c=a(719481),u=a(139230),d=a(700881),p=a(170181),A=function(){var e,t,a,A=(0,o.useSelector)((function(e){return e})),_=(0,o.useDispatch)(),m=n.useContext(i.LangContext),g=m.getLang,v=m.langNumeric,f=(0,n.useCallback)((function(e){var t,a=null===(t=A.waitingHall)||void 0===t?void 0:t.members.get(e);a&&_({type:r.TOGGLE_PARTICIPANTS_KICK,data:{type:r.KickParticipantType.WAITING_HALL,participant:a}})}),[null===(e=A.waitingHall)||void 0===e?void 0:e.members]),E=(0,n.useCallback)((function(){var e=[(0,c.loadAdditionalWaitingHall)(A,_)];return Promise.all(e).then((function(){_({type:r.MANAGEMENT,isOpen:!0,managementView:u.ManagementViews.WAITING_HALL})}))}),[A.waitingHall]),C=(0,n.useCallback)((function(e){A.waitingHall&&(0,c.promoteUserAndRemoveFromWaitingHall)(e,A.waitingHall,_)}),[null===(t=A.waitingHall)||void 0===t?void 0:t.members]),h=(0,n.useCallback)((function(){(0,c.resetWaitingHallNew)(A.waitingHall,_)}),[null===(a=A.waitingHall)||void 0===a?void 0:a.hasNew]);if(!A.waitingHall)return null;if(0===A.waitingHall.members.size)return null;if(!A.waitingHall.hasNew)return null;var S=Array.from(A.waitingHall.members.values()),T=g("calls_notification_users_in_waiting_hall_notification",A.waitingHall.totalCount).replace("{names}",(0,s.getParticipantsListLabel)(S,S.slice(0,3),(function(e){return e.shortName||e.name}),g,v,A.waitingHall.totalCount)),I=null;if(1===S.length){var N=S[0];I=n.createElement(n.Fragment,null,n.createElement(l.default,{onClick:function(){return C(N.peerId)},appearance:"overlay_primary"},g("calls_waiting_hall_join")),n.createElement(l.default,{onClick:function(){return f(N.peerId)},appearance:"overlay_secondary"},g("calls_waiting_hall_forbid")))}else I=n.createElement(l.default,{onClick:function(){return E()},appearance:"overlay_primary"},g("calls_waiting_show_participants"));return n.createElement(p.NotificationWithButton,null,n.createElement("div",null,n.createElement(d.default,{className:"NotificationWithButton--close",onClick:h}),n.createElement("span",null,T),n.createElement("div",{className:"NotificationWithButton--buttons"},I)))}},310765:(e,t,a)=>{"use strict";a.d(t,{ParticipantMenuContainer:()=>s});var n=a(667294),r=a(50533),i=a(697483),o=a(662208),l=a(95939),s=function(e){var t=e.SDK,a=e.participant,s=e.navigateToConvo,c=e.navigateToProfile,u=(0,r.useSelector)((function(e){return e})),d=(0,r.useDispatch)(),p=n.useContext(o.LangContext).getLang,A=(0,i.getParticipantActions)(u,t,d,a,!1,p,s,c,!0);return A.length>0?n.createElement(l.ParticipantMenu,{position:"b",align:"right",trigger:"hover",marginTop:-8,marginLeft:1,actions:A}):null}},670778:(e,t,a)=>{"use strict";a.d(t,{ParticipantStatusContainer:()=>l});var n=a(667294),r=a(580248),i=a(662208),o=a(464380),l=function(e){var t=e.status,a=n.useContext(i.LangContext).getLang;switch(t){case o.ParticipantStatus.WAITING:return n.createElement(r.default,null,a("calls_status_waiting"));case o.ParticipantStatus.CONNECTING:case o.ParticipantStatus.RECONNECT:return n.createElement(r.default,null,a("calls_status_connecting"));case o.ParticipantStatus.ERROR:return a("calls_error");case o.ParticipantStatus.HANGUP:return n.createElement(r.default,null,a("calls_status_hangup"));case o.ParticipantStatus.PERMISSIONS:return a("calls_status_no_permissions");case o.ParticipantStatus.CONNECTED:default:return null}}},48755:(e,t,a)=>{"use strict";a.d(t,{SettingsContainer:()=>_});var n=a(570655),r=a(667294),i=a(659397),o=a(50533),l=a(471304),s=a(555700),c=a(121255),u=a(662208),d=a(498110),p=a(147853),A=r.useState;function _(e){var t=e.SDK,a=r.useContext(u.LangContext).getLang,_=r.useContext(d.ConfigContext).fullHD,m=[{label:a("calls_noise_neural"),value:c.NoiseCancellationTypes.NEURAL,data:{denoise:!0,denoiseAnn:!0}},{label:a("calls_noise_simple"),value:c.NoiseCancellationTypes.SIMPLE,data:{denoise:!0,denoiseAnn:!1}},{label:a("calls_noise_none"),value:c.NoiseCancellationTypes.NONE,data:{denoise:!1,denoiseAnn:!1}}],g=[{label:a("calls_video_resolution_sd"),value:c.VideoResolutionTypes.SD},{label:a("calls_video_resolution_hd"),value:c.VideoResolutionTypes.HD}];_&&g.push({label:a("calls_video_resolution_fhd"),value:c.VideoResolutionTypes.FHD});var v=(0,o.useSelector)((function(e){return e})),f=(0,n.__read)((0,o.useSelector)((function(e){var t;return[e.mode,null===(t=e.participants[e.me].mediaSettings)||void 0===t?void 0:t.isVideoEnabled]})),2),E=f[0],C=f[1],h=(0,o.useDispatch)(),S=t.browser.getCameras(),T=t.browser.getMicrophones(),I=t.browser.hasCamera()&&t.browser.hasCameraPermission(),N=t.browser.hasMicrophone()&&t.browser.hasMicrophonePermission(),y=t.browser.getSavedCamera(),P=t.browser.getSavedMicrophone(),b=I&&(y&&y.deviceId||S[0].deviceId),L=N&&(P&&P.deviceId||T[0].deviceId),M=(0,n.__read)(A(!1===b?void 0:b),2),w=M[0],O=M[1],k=(0,n.__read)(A(!1===L?void 0:L),2),D=k[0],R=k[1],B=(0,n.__read)(A(v.noiseCancellation),2),G=B[0],H=B[1],x=i.localStorage.getItem(c.VIDEO_RESOLUTION_STORAGE_KEY),U=(0,n.__read)(A(x===c.VideoResolutionTypes.FHD?c.VideoResolutionTypes.FHD:x===c.VideoResolutionTypes.HD?c.VideoResolutionTypes.HD:c.VideoResolutionTypes.SD),2),V=U[0],F=U[1],W=(0,n.__read)(A(v.pushToTalkEnabled),2),z=W[0],Q=W[1];return r.createElement(s.CallSettingsModal,{onClose:function(){h({type:c.TOGGLE_POPUP})},onSubmit:function(){var e,a=[Promise.resolve()];if(!y&&b===w&&E!==c.Mode.READY&&!C||!w||y&&y.deviceId===w||a.push(t.changeDevice("videoinput",w)),!D||P&&P.deviceId===D||a.push(t.changeDevice("audioinput",D)),v.noiseCancellation!==G&&a.push(t.setMediaModifiers((null===(e=m.find((function(e){return e.value===G})))||void 0===e?void 0:e.data)||{denoise:!0,denoiseAnn:!0}).then((function(){h({type:c.SET_NOISE_CANCELLATION,data:G})}))),v.localVideoResolution!==V&&(console.debug("set resolution from -> to: ",v.localVideoResolution,V,c.VideoWidth[V],c.VideoHeight[V]),a.push(t.setLocalResolution(c.VideoWidth[V],c.VideoHeight[V]).catch((function(e){console.error(e)})).finally((function(){i.localStorage.setItem(c.VIDEO_RESOLUTION_STORAGE_KEY,V),h({type:c.CHANGE_LOCAL_VIDEO_RESOLUTION,data:V})})))),v.pushToTalkEnabled!==z){var n=v.participants[v.me];n.permissions.audio>0&&(0,p.pushToTalkToggleAudio)(z,n.mediaSettings),h({type:c.SET_PUSH_TO_TALK_ENABLE,data:z})}Promise.all(a).then((function(){h({type:c.TOGGLE_POPUP})})).catch((function(e){console.error("Device change failed",e),h({type:c.TOGGLE_POPUP})}))}},r.createElement(l.CallSettings,{mics:T,cameras:S,noiseCancellationOptions:m,videoResolutionOptions:g,currentCamId:w,currentMicId:D,currentNoiseCancellation:G,currentVideoResolution:V,isCamAvailable:I,isMicAvailable:N,onCameraChange:function(e){return O(e)},onMicChange:function(e){return R(e)},onNoiseCancellationChange:function(e){return H(e)},onVideoResolutionChange:function(e){return F(e)},pushToTalkEnabled:z,onPushToTalkChange:function(){Q(!z)}}))}},858101:(e,t,a)=>{"use strict";a.d(t,{StartCallContainer:()=>f});var n=a(570655),r=a(667294),i=a(659397),o=a(86894),l=a(835849),s=a(443774),c=a(121255),u=a(233194),d=a(662208),p=a(394886),A=a(767497),_=a(50533),m=a(269481),g=a(153907),v=a(30081);function f(){var e,t=(0,_.useSelector)((function(e){return e})),a=(0,_.useDispatch)(),f=r.useContext(d.LangContext).getLang,E=!(null===(e=t.join)||void 0===e?void 0:e.joinLink),C=(0,n.__read)((0,r.useState)(null!==i.localStorage.getItem(c.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED)),2),h=C[0],S=C[1],T=(0,n.__read)((0,r.useState)(!h),2),I=T[0],N=T[1],y=(0,r.useRef)(null);u.Platform.OS===u.OS.MAC?y.current={url:c.DESKTOP_CALLS_DOWNLOAD[u.OS.MAC],filename:c.DESKTOP_CALLS_FILENAME[u.OS.MAC]}:u.Platform.OS===u.OS.WINDOWS&&(y.current={url:c.DESKTOP_CALLS_DOWNLOAD[u.OS.WINDOWS],filename:c.DESKTOP_CALLS_FILENAME[u.OS.WINDOWS]});var P=null!==y.current,b=(0,n.__read)((0,r.useState)(!h),2),L=b[0],M=b[1],w=function(){i.localStorage.setItem(c.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED,"true")},O=function(){var e,a;return(null===(e=t.join)||void 0===e?void 0:e.joinLink)?(0,p.openDesktopDeepLink)((0,A.generateJoinCallsDeepLink)({joinLink:null===(a=t.join)||void 0===a?void 0:a.joinLink,userId:window.vk.id})):(0,p.openDesktopDeepLink)((0,A.generateStartCallsDeepLink)({peerId:t.peer,userId:window.vk.id}))};(0,r.useEffect)((function(){O().then((function(){N(!1)})).catch((function(){N(!1)}))}),[h]);var k=function(){a({type:c.CHANGE_MODE,mode:c.Mode.READY})};return r.createElement(m.CallModal,{onClose:k,onBackdropClick:k},r.createElement(o.ModalCard,{nav:"StartCallModal",header:r.createElement(v.default,null,f(I&&P?"calls_download_started":h?"calls_app_title":E?"calls_start_call_after_install_app":"calls_join_call_after_install_app")),subheader:L?f("calls_download_and_install_app_for_pc"):h?f(E?"calls_try_manual_start_lesson":"calls_try_manual_join_lesson"):I?f("calls_wait_until_app_downloaded"):"",className:"StartCallModal"},I&&P&&y.current?r.createElement(r.Fragment,null,r.createElement(o.Spinner,{size:"large",className:"StartCallModal__action"}),r.createElement("div",{className:"StartCallModal__text"},f("calls_downloading_file").replace("{file}",y.current.filename))):L?y.current&&P?r.createElement(o.Button,{size:"l",before:r.createElement(l.default,null),onClick:function(){return e=y.current.url,t=y.current.filename,w(),(0,g.download)(e,t),N(!0),void setTimeout((function(){S(!0),N(!1),M(!1)}),3e3);var e,t},className:"StartCallModal__action"},f("calls_download_app")):r.createElement(o.Button,{size:"l",before:r.createElement(l.default,null),href:c.DESKTOP_CALLS_DOWNLOAD_PAGE,target:"_blank",onClick:function(){w(),M(!1)},className:"StartCallModal__action"},f("calls_download_app")):r.createElement(o.Button,{mode:"secondary",size:"l",before:r.createElement(s.default,null),onClick:O,className:"StartCallModal__action"},f(E?"calls_start_in_app":"calls_join_call_in_app")),!L&&r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},r.createElement("div",null,f("calls_apps_for_all_platform")),r.createElement(o.Link,{href:c.DESKTOP_CALLS_DOWNLOAD_PAGE,target:"_blank"},f("calls_open_app_list"))),r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},f("calls_calls_troubles_with_app"),r.createElement("br",null),r.createElement(o.Link,{onClick:function(){var e,a,n=t.peer;if(window.Calls)if(null===(e=t.join)||void 0===e?void 0:e.joinLink)window.Calls.joinCallByLink(null===(a=t.join)||void 0===a?void 0:a.joinLink,void 0,!1,c.CallStatSource.CONVO_JOIN_SNIPPET);else{var r=c.CallStatSource.CONVO_LIST;if(n)n>2e9?window.Calls.startGroupCall(n,void 0,null,!1,r):window.Calls.call(n,!1,void 0,r);else window.Calls.startCall(!1,r)}}},f(E?"calls_calls_start_lesson_in_browser":"calls_join_call_in_browser")))))}},152532:(e,t,a)=>{"use strict";a.d(t,{TransferAdminRightsContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(431469),s=a(338374),c=a(662208),u=a(614914),d=a(745284),p=a(697483),A=a(444083),_=a(464380),m=function(e){var t=e.SDK,a=(0,i.useDispatch)(),m=(0,i.useSelector)((function(e){return e})),g=r.useContext(c.LangContext).getLang,v=(0,n.__read)((0,r.useState)(Object.values(m.participants).filter((function(e){return e.peerId===m.me||e.status===_.ParticipantStatus.CONNECTED&&!(0,p.isParticipantAnonym)(e.peerId)}))),2),f=v[0],E=v[1],C=(0,n.__read)((0,r.useState)(null),2),h=C[0],S=C[1],T=(0,r.useCallback)((function(e){return e.name}),[]),I=(0,r.useCallback)((function(e){return e.peerId}),[]),N=(0,l.useIndexer)(f,T,I),y=(0,r.useMemo)((function(){return(0,p.getActiveParticipantsCount)(m)}),[m.participants]),P=function(){return u.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:m.callData.callId,peer_id:m.peer,is_group_call:(0,d.isGroupCallByPeer)(m.peer),reason:"none",group_call_users_count:y})},b=(0,r.useCallback)((function(e){E(e?N.search(e):N.list),S(null)}),[m]),L=function(){a({type:o.TOGGLE_POPUP})},M=function(){a({type:o.TOGGLE_POPUP}),P(),t.hangup().catch(console.log)},w=(0,r.useCallback)((function(e){S(null===e?null:e.peerId)}),[]);return(0,r.useEffect)((function(){h&&!f.find((function(e){return e.peerId===h}))&&S(null)}),[h]),r.createElement(s.TransferAdminRightsModal,{participants:f,onClose:L,onSelect:w,selected:h,onCallForceFinish:function(){a({type:o.TOGGLE_POPUP}),P(),t.hangup(),(0,A.onForceCallFinish)(t,m,a,g)},onRightsTransfer:function(){if(null!==h){var e=(0,p.getParticipantExternalId)(m.participants[h]);e&&(t.grantRoles(e,[_.UserRole.ADMIN],!1).then((function(){return M()})).catch(console.log),L())}else M()},onSearch:b})}},537817:(e,t,a)=>{"use strict";a.d(t,{TranslationContainer:()=>A});var n=a(667294),r=a(958713),i=a(121255),o=a(50533),l=a(881150),s=a(186983),c=a(445586),u=a(662208),d=a(820717),p=a(674543);function A(){var e,t=(0,o.useSelector)((function(e){return e})),a=(0,o.useDispatch)(),A=n.useContext(u.LangContext).getLang,_=(0,n.useCallback)((function(){a({type:i.TOGGLE_POPUP})}),[]),m=(0,p.canStopTranslation)(t),g=(0,n.useCallback)((function(){a({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_STOP})}),[]),v=(0,n.useCallback)((function(e){if(null==e?void 0:e.upcomingStreamParams){var t=e.upcomingStreamParams,n=t.startTime,r=t.ovId;if(n&&n>Date.now()/1e3+4)return(0,d.startUpcomingStream)(r).finally(_)}var o={isOn:!1,startStreamParams:e};return a({type:i.SET_TRANSLATION,data:o}),a({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_START_COUNTDOWN}),Promise.resolve()}),[]),f=(0,n.useCallback)((function(){a({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_SHARE})}),[]);return(null===(e=t.translation)||void 0===e?void 0:e.isOn)?n.createElement(s.CallManagementModal,{title:A("calls_translation_menu_title"),actionButtons:m?[n.createElement(l.default,{onClick:g,appearance:"negative",key:"stop"},A("calls_translation_menu_stop"))]:[],onCloseModal:_},n.createElement(c.CallManagementMenu,{isLinkBlockShown:!0,linkBlockTitle:A("calls_translation_menu_link"),onLinkBlockClick:f,callUrlLink:t.translation.link})):n.createElement(r.TranslationCreateForm,{onSubmit:v,onClose:_})}},978335:(e,t,a)=>{"use strict";a.d(t,{TranslationShareContainer:()=>c});var n=a(667294),r=a(50533),i=a(121255),o=a(662208),l=a(186983),s=a(162144),c=function(e){var t,a=e.onBack,c=e.link,u=e.linkExtractor,d=(0,r.useDispatch)(),p=n.useContext(o.LangContext).getLang,A=(0,r.useSelector)((function(e){return e.translation})),_=(0,n.useCallback)((function(){d({type:i.TOGGLE_POPUP})}),[]);return n.createElement(l.CallManagementModal,{title:p("calls_translation_link"),onCloseModal:_,isWithBackButton:!!a,onBackClick:a},n.createElement(s.TranslationLink,{link:null!==(t=null==u?void 0:u(A))&&void 0!==t?t:c}))}},350594:(e,t,a)=>{"use strict";a.d(t,{TranslationStartCountdownContainer:()=>d});var n=a(570655),r=a(667294),i=a(121255),o=a(50533),l=a(979414),s=a(874023),c=a(820717),u=a(329538);function d(){var e=(0,o.useDispatch)(),t=(0,o.useSelector)((function(e){return e})),a=(0,n.__read)((0,r.useState)(3),2),d=a[0],p=a[1],A=(0,r.useCallback)((function(){e({type:i.TOGGLE_POPUP})}),[]),_=(0,r.useCallback)((function(){var e,a=null===(e=t.translation)||void 0===e?void 0:e.startTime;a&&a>=Date.now()&&(0,u.stopVideoStream)(),A()}),[]);return(0,r.useEffect)((function(){var e=setInterval((function(){return p(d-1)}),s.SECOND_JS);return function(){return clearInterval(e)}}),[d]),(0,r.useEffect)((function(){var e;if(d<=0){var a=null===(e=t.translation)||void 0===e?void 0:e.startStreamParams;(null==a?void 0:a.streamParams)?(0,c.startCallStream)(a.streamParams):(null==a?void 0:a.upcomingStreamParams)&&(0,c.startUpcomingStream)(a.upcomingStreamParams.ovId),A()}}),[d]),r.createElement(l.TranslationStartCountdownModal,{onCloseModal:A,counter:d,onStopTranslation:_})}},910472:(e,t,a)=>{"use strict";a.d(t,{TranslationStatusContainer:()=>g});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(880076),s=a(52777),c=a(659397),u=a(462480),d=a(923522),p=a(662208),A=a(874023),_=a(329538),m=a(674543);function g(){var e=(0,r.useContext)(p.LangContext),t=e.getLang,a=e.langNumeric,s=(0,i.useSelector)((function(e){return e})),c=(0,i.useDispatch)(),g=(0,n.__read)((0,r.useState)(null),2),S=g[0],T=g[1],I=(0,n.__read)((0,r.useState)(!1),2),N=I[0],y=I[1],P=(0,n.__read)((0,r.useState)(""),2),b=P[0],L=P[1],M=(0,n.__read)((0,r.useState)(0),2),w=M[0],O=M[1],k=(0,n.__read)((0,r.useState)([]),2),D=k[0],R=k[1],B=(0,n.__read)((0,r.useState)(h(s.translation.startTime)),2),G=B[0],H=B[1],x=(0,n.__read)((0,r.useState)(C(G)),2),U=x[0],V=x[1],F=(0,n.__read)((0,r.useState)(""),2),W=F[0],z=F[1],Q=(0,n.__read)((0,r.useState)(!1),2),j=Q[0],Y=Q[1];return(0,r.useEffect)((function(){var e=(0,m.canStopTranslation)(s);y(e)}),[s.translation,s.participants[s.me]]),(0,r.useEffect)((function(){var e,t;if(null===(e=s.translation.host)||void 0===e?void 0:e.id){var a=s.participants[null===(t=s.translation.host)||void 0===t?void 0:t.id],n=(null==a?void 0:a.shortName)||(null==a?void 0:a.name);n!==S&&T(n)}else S&&T(null)}),[s.translation,s.participants]),(0,r.useEffect)((function(){var e=[];if(N){if(U){var a={text:r.createElement("div",{className:"TranslationStatus__dropdownItemWillStartSoon"},t("calls_info_translation_will_start_soon"))};e.push(a)}e.push(v(r.createElement(u.ShareIcon,null),t("calls_info_translation_share_menu_item"),(function(){return c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_SHARE})}))),e.push(v(r.createElement(d.CancelIcon,null),t("calls_translation_stop_menu_item"),(function(){return c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_STOP})})))}R(e)}),[N,U]),(0,r.useEffect)((function(){var e=C(G);e&&G>-4&&N&&!j&&(Y(!0),c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_START_COUNTDOWN})),V(e)}),[G]),(0,r.useEffect)((function(){var e=h(s.translation.startTime);H(e);var t=setInterval((function(){return H(h(s.translation.startTime))}),A.SECOND_JS);return function(){return clearInterval(t)}}),[s.translation.startTime]),(0,r.useEffect)((function(){var e="";if(U){var n=Math.abs(G);if(n>A.DAY){var r=Math.floor(n/A.DAY);e=a(r,"calls_translation_upcoming_time_more_day_short",t("calls_translation_upcoming_time_more_day_short",r)).replace("%s",r)}else e=f("-"+E(n))}else e=f(E(G));L(e)}),[G,U]),(0,r.useEffect)((function(){var e,t=s.translation,a=t.ownerId,n=t.videoId;if(a&&n&&!U){var r=function(){var e={owner_id:a,video_id:n};(0,_.videoLiveGetSpectators)(e).then((function(e){var t;O(null===(t=e.spectators)||void 0===t?void 0:t.count)}))};r(),e=setInterval(r,15*A.SECOND_JS)}return function(){return clearInterval(e)}}),[U,s.translation.ownerId,s.translation.videoId]),(0,r.useEffect)((function(){if(!N){var e="";e=U?t("calls_info_translation_will_start_soon"):S?t("calls_translation_host_info").replace("{name}",S):t("calls_translation_host_info_unknown"),z(e)}}),[U,S,N]),r.createElement(l.TranslationStatus,{translationTimer:b,viewersCount:w,isLiveIndicatorOff:U,actions:D,tooltipText:W})}function v(e,t,a){return{text:r.createElement("div",{className:"TranslationStatus__dropdownItem"},e,r.createElement("div",{className:"TranslationStatus__dropdownItemText"},t)),onClick:a}}function f(e){return r.createElement(s.CallTimer,{duration:e})}function E(e){return 0===e?"00:00":e<=599?"0"+(0,c.formatDuration)(e):(0,c.formatDuration)(e)}function C(e){return e<0}function h(e){var t=Date.now();return Math.floor((t-e)/1e3)}},410038:(e,t,a)=>{"use strict";a.d(t,{TranslationStopContainer:()=>u});var n=a(667294),r=a(50533),i=a(881150),o=a(121255),l=a(662208),s=a(389809),c=a(329538),u=function(){var e=(0,r.useDispatch)(),t=n.useContext(l.LangContext).getLang,a=(0,n.useCallback)((function(){e({type:o.TOGGLE_POPUP})}),[]);return n.createElement(s.TranslationStopModal,{onClose:a,actionButtons:[n.createElement(i.default,{onClick:a,appearance:"secondary",key:"cancel"},t("calls_cancel")),n.createElement(i.default,{onClick:function(){(0,c.stopVideoStream)().then((function(){e({type:o.TOGGLE_POPUP})}))},key:"stop"},t("calls_translation_stop"))]})}},450273:(e,t,a)=>{"use strict";a.d(t,{UnbanParticipantContainer:()=>d});var n=a(667294),r=a(50533),i=a(881150),o=a(121255),l=a(662208),s=a(697483),c=a(904992),u=function(e){var t=e.name||"";return e.photo?{src:e.photo,alt:t,key:e.peerId}:{id:e.peerId,text:t.slice(0,1)}},d=function(e){var t,a=e.SDK,d=(0,r.useDispatch)(),p=n.useContext(l.LangContext),A=p.getLang,_=p.langNumeric,m=p.langSex,g=(0,r.useSelector)((function(e){return e})),v=g.participants[g.me],f=(0,s.participantIsAdmin)(v),E=null===(t=g.membersUnban)||void 0===t?void 0:t.members,C=(0,n.useCallback)((function(){d({type:o.UNBAN_PARTICIPANTS})}),[]),h=(0,n.useCallback)((function(){null==E||E.forEach((function(e){a.addParticipant(String(e.id),{unban:!0})})),C()}),[g.membersUnban]);if(!E||0===E.length)return n.createElement(n.Fragment,null);var S=null==E?void 0:E.length,T=_(S,"calls_unban_participant_text",A("calls_unban_participant_text",!0)),I="",N=[];if(1===S){var y=E[0];I=m(y.sex,"calls_unban_participant_description_text_one_person",A("calls_unban_participant_description_text_one_person",!0)).replace("{user}",y.name),N.push(u(y))}else{var P=[E[0].name,E[1].name];N=E.slice(0,2).map((function(e){return u(e)}));if(S<=3)3===S&&(P.push(E[2].name),N.push(u(E[2]))),I=A("calls_unban_participant_description_text_two_persons").replace("{users}",P.join(", "));else{var b=S-2;I=_(b,"calls_unban_participant_description_text_more_persons",A("calls_unban_participant_description_text_more_persons",!0)).replace("{users}",P.join(", ")).replace("{users_count}",b),N.push({id:b,text:"+"+b})}}var L=f?[n.createElement(i.default,{onClick:C,appearance:"secondary",key:"cancel"},A("calls_unban_participant_cancel_button_text")),n.createElement(i.default,{onClick:h,key:"stop"},A("calls_unban_participant_ok_button_text"))]:[n.createElement(i.default,{onClick:C,key:"cancel"},A("calls_unban_participant_disallowed_button_text"))];return n.createElement(c.UnbanMembersModal,{onClose:C,description:T,subDescription:I,actionButtons:L,avatarsItems:N})}},927229:(e,t,a)=>{"use strict";a.d(t,{UnmuteRequestContainer:()=>d});var n=a(667294),r=a(50533),i=a(881150),o=a(121255),l=a(662208),s=a(860925),c=a(169610),u=a(464380),d=function(e){var t=e.SDK,a=(0,r.useDispatch)(),d=n.useContext(l.LangContext).getLang,p=(0,r.useSelector)((function(e){return e})),A=p.participants[p.me],_=A.mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},m=function(){a({type:o.TOGGLE_POPUP})},g=function(){var e=A.mediaSettings;(null==e?void 0:e.isAudioEnabled)||(_.isAudioEnabled?Promise.resolve():(0,c.checkPermissions)(t,[u.MediaOption.AUDIO])).then((function(){var e;(null===(e=p.notification)||void 0===e?void 0:e.type)===o.NotificationType.SPEAKING_ON_MUTE&&a({type:o.CALL_NOTIFICATION,notification:null}),t.toggleLocalAudio(!0).catch(console.log)}))};return n.createElement(s.UnmuteRequestModal,{onClose:m,title:d("calls_dialog_unmute_request_title"),description:d("calls_dialog_unmute_request_description"),actionButtons:[n.createElement(i.default,{onClick:function(){g(),m()},appearance:"secondary",key:"mic"},d("calls_dialog_unmute_request_mic_only_action")),n.createElement(i.default,{onClick:function(){var e;g(),(null==(e=A.mediaSettings)?void 0:e.isVideoEnabled)||(null==e?void 0:e.isScreenSharingEnabled)||(!_.isVideoEnabled||_.isScreenSharingEnabled?(0,c.checkPermissions)(t,[u.MediaOption.VIDEO]):Promise.resolve()).then((function(){t.toggleLocalVideo(!0).catch(console.log)})),m()},key:"all"},d("calls_dialog_unmute_request_action"))]})}},699637:(e,t,a)=>{"use strict";a.d(t,{WaitingContainer:()=>o});var n=a(667294),r=a(50533),i=a(706885);function o(){return(0,r.useSelector)((function(e){return e})).isLoaderVisible?n.createElement(i.default,null):null}},637880:(e,t,a)=>{"use strict";a.d(t,{WaitingHallContainer:()=>f});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(492512),s=a(269481),c=a(169610),u=a(690015),d=a(697483),p=a(662208),A=a(498110),_=a(774351),m=a(100741),g=a(464380),v=a(51443);function f(e){var t,a=e.SDK,f=e.navigateToConvo,E=(0,i.useSelector)((function(e){return e})),C=(0,i.useDispatch)(),h=(0,r.useContext)(p.LangContext).getLang,S=(0,r.useContext)(A.ConfigContext),T=S.isModalView,I=S.enableScreenTrack,N=E.peer,y=E.participants[E.me].mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},P=(0,r.useMemo)((function(){return(0,d.getActiveParticipants)(E.participants,E.me,E.groupId,E.meGroup)}),[E.participants,E.me,E.groupId,E.meGroup]),b=E.uiMode===o.UIMode.FULLSCREEN,L=(0,n.__read)((0,r.useState)(!1),2),M=L[0],w=L[1],O=(0,n.__read)((0,r.useState)(!1),2),k=O[0],D=O[1],R=function(e){return C({type:o.CHANGE_UI_MODE,mode:e})},B=(0,r.useCallback)((function(){T&&(E.uiMode===o.UIMode.FULLSCREEN?((0,_.pause)(.3,null).then((function(){R(o.UIMode.COLLAPSED)})),R(o.UIMode.DEFAULT)):R(o.UIMode.COLLAPSED))}),[E.uiMode]),G=(0,r.useCallback)((function(){if(!M){var e=!y.isAudioEnabled;(e?(0,c.checkPermissions)(a,[g.MediaOption.AUDIO]):Promise.resolve()).then((function(){var t;w(!0),(null===(t=E.notification)||void 0===t?void 0:t.type)===o.NotificationType.SPEAKING_ON_MUTE&&C({type:o.CALL_NOTIFICATION,notification:null}),a.toggleLocalAudio(e).finally((function(){w(!1)}))}))}}),[y,M]),H=(0,r.useCallback)((function(){if(!k){var e=!y.isVideoEnabled||y.isScreenSharingEnabled&&!I;(e?(0,c.checkPermissions)(a,[g.MediaOption.VIDEO]):Promise.resolve()).then((function(){D(!0),I||y.isScreenSharingEnabled&&a.captureScreen(!1),a.toggleLocalVideo(e).finally((function(){D(!1)}))}))}}),[y,k]),x=(0,r.useCallback)((function(){B(),f(E.peer)}),[E.peer,E.uiMode]),U=(0,r.useCallback)((function(){a.hangup()}),[E.callData.callId,E.peer,P]),V=(0,r.useCallback)((function(){C({type:o.CHANGE_UI_MODE,mode:b?o.UIMode.DEFAULT:o.UIMode.FULLSCREEN}),C({type:o.SET_TOOLTIP,tooltips:null})}),[E.uiMode]),F=(0,r.useCallback)((function(e,t){var a;C({type:o.SET_TOOLTIP,tooltips:(a={},a[e]=t,a)})}),[]),W=(0,r.useCallback)((function(){C({type:o.SET_TOOLTIP,tooltips:null})}),[]);(0,r.useEffect)((function(){return function(){C({type:o.SET_TOOLTIP,tooltips:null})}}),[]);var z=(0,r.useMemo)((function(){var e;return r.createElement(u.CallNotificationContainer,{dispatch:C,notification:E.notification,participant:E.participants[null===(e=E.notification)||void 0===e?void 0:e.data]})}),[E.notification,E.participants[null===(t=E.notification)||void 0===t?void 0:t.data]]),Q=E.hangupType===o.HANGUP_TYPE_REMOVED?h("calls_waiting_hall_removed"):h("calls_waiting_hall_info");return r.createElement(s.CallModal,{onClose:U,onBackdropClick:B},r.createElement(l.Call,{info:null,isVideoAllowed:!0,isAudioAllowed:!0,isVideoEnabled:y.isVideoEnabled,isAudioEnabled:y.isAudioEnabled,isFullScreen:b,onToggleAudio:G,onToggleVideo:H,onLeaveCall:U,onCollapseCall:T?B:null,onFullScreenToggle:V,onTooltipChange:F,onHidePanel:W,onChat:x,isChatControlShown:!!N&&!E.groupId,chatUnreadCount:E.chatUnreadCount,notification:z,tooltips:E.tooltips,amISpeaking:!!E.speakers[E.me],waitingHallNotification:null,withoutPadding:!0},r.createElement(r.Fragment,null,y.isVideoEnabled&&r.createElement(m.WaitingHall,(0,n.__assign)({},function(e,t){var a,n=e[t],r=n.mediaSettings,i=(0,d.isParticipantWithVideo)(n),o=(0,d.getStream)(n);return{id:t,name:"",letter:null===(a=n.name)||void 0===a?void 0:a.slice(0,1),hasAudio:!!(null==r?void 0:r.isAudioEnabled),hasVideo:i,stream:o,wasConnected:!!n.wasConnected}}(E.participants,E.me))),r.createElement(v.WaitingHallInfo,{text:Q}))))}},564840:(e,t,a)=>{"use strict";a.d(t,{WaitingHallListContainer:()=>m});var n=a(570655),r=a(667294),i=a(50533),o=a(121255),l=a(662208),s=a(428990),c=a(956462),u=a(719481),d=a(186983),p=a(736434),A=a(431469),_=a(884143),m=function(e){var t,a,m,v,f,E=e.isModal,C=e.onMore,h=e.navigateToProfile,S=e.isWithBackButton,T=e.onBackClick,I=S?T:function(){},N=(0,i.useSelector)((function(e){return e})),y=(0,i.useDispatch)(),P=r.useContext(l.LangContext).getLang,b=(0,n.__read)((0,r.useState)(g(N,E)),2),L=b[0],M=b[1],w=(0,n.__read)((0,r.useState)(""),2),O=w[0],k=w[1],D=N.waitingHall?Array.from(null===(t=N.waitingHall)||void 0===t?void 0:t.members.values()):[],R=(0,r.useCallback)((function(e){return e.name}),[]),B=(0,r.useCallback)((function(e){return e.peerId}),[]),G=(0,A.useIndexer)(E?D:[],R,B),H=(0,r.useCallback)((function(e){k(e.target.value)}),[]),x=E?D:D.slice(0,5);O&&(x=G.search(O)),(0,r.useEffect)((function(){M(g(N,E))}),[null===(a=N.waitingHall)||void 0===a?void 0:a.totalCount]);var U=(0,r.useCallback)((function(e){var t,a=null===(t=N.waitingHall)||void 0===t?void 0:t.members.get(e);a&&y({type:o.TOGGLE_PARTICIPANTS_KICK,data:{type:o.KickParticipantType.WAITING_HALL,participant:a}})}),[null===(m=N.waitingHall)||void 0===m?void 0:m.members]),V=(0,r.useCallback)((function(e){N.waitingHall&&(0,u.promoteUserAndRemoveFromWaitingHall)(e,N.waitingHall,y)}),[null===(v=N.waitingHall)||void 0===v?void 0:v.members]),F=(0,r.useCallback)((function(){C&&C()}),[N.waitingHall]),W=r.createElement(r.Fragment,null,r.createElement(s.WaitingHallList,{members:x,totalCount:null===(f=N.waitingHall)||void 0===f?void 0:f.totalCount,navigateToProfile:h,onPromote:V,onForbid:U}),L&&r.createElement(c.ListMore,{onClick:F},P("calls_waiting_hall_more_text")));return E?r.createElement(d.CallManagementModal,{title:P("calls_waiting_hall_title"),onCloseModal:function(){y({type:o.GROUP_CALL_SETUP,open:!1,preselectedIds:null}),y({type:o.MANAGEMENT,isOpen:!1})},isWithBackButton:S,onBackClick:I},r.createElement("div",{className:"CallParticipantList"},D.length>0&&r.createElement(r.Fragment,null,r.createElement(p.BlockSearchInput,{value:O,placeholder:P("calls_search_participants_placeholder"),onChange:H,onInput:H,onPaste:H,className:"CallParticipantList__input"}),W,O&&0===x.length&&r.createElement(_.default,null,P("calls_participants_not_found"))),0===D.length&&r.createElement(_.default,null,P("calls_waiting_hall_not_users")))):W};function g(e,t){if(t)return!1;var a=e.waitingHall;return!!a&&a.totalCount>5}},498110:(e,t,a)=>{"use strict";a.d(t,{ConfigContext:()=>i});var n=a(667294),r=a(121255),i=n.createContext({isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,incomingCall:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:r.VIDEO_SLOTS_COUNT,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,sferum:!1})},662208:(e,t,a)=>{"use strict";a.d(t,{LangContext:()=>n});var n=a(667294).createContext({getLang:function(e){return e},langSex:function(e,t){return t},langNumeric:function(e,t){return""+t},langShortDateTime:function(e){return""+e}})},641196:(e,t,a)=>{"use strict";a.d(t,{setApiWrappers:()=>i,getApiWrapper:()=>o});var n=null,r=null,i=function(e,t){n=e,r=t},o=function(e){return void 0===e&&(e=!0),e?n:r}},483379:(e,t,a)=>{"use strict";a.d(t,{browser:()=>r});var n=navigator.userAgent.toLowerCase(),r={version:(n.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:!/chrome/i.test(n)&&/webkit|safari|khtml/i.test(n)}},745284:(e,t,a)=>{"use strict";a.d(t,{isGroupCallByPeer:()=>o,isActiveGroupCallMessage:()=>l,isRequireAuthToJoin:()=>s,isWaitingHallEnabled:()=>c,getDefaultConversation:()=>u,isAuthedByGroupId:()=>d,getMediaOptions:()=>p,isIAmSpeaking:()=>A});var n=a(389953),r=a(121255),i=a(464380),o=function(e){return 0===e||(0,n.isChatPeer)(e)||null===e};function l(e){return e&&e.attaches&&e.attaches[0]&&"group_call_in_progress"===e.attaches[0].type}function s(e){return e.conversationOptions.includes(i.ConversationOption.REQUIRE_AUTH_TO_JOIN)}function c(e){return e.conversationOptions.includes(i.ConversationOption.WAITING_HALL)}function u(e){return{peerId:0,canAddMembers:!0,tab:e("calls_new_call_title"),photo:r.DEFAULT_GROUP_CALL_PHOTO}}function d(e){return!!e.groupId}function p(e){var t=e.audio,a=e.video,n=[];return t&&n.push(i.MediaOption.AUDIO),a&&n.push(i.MediaOption.VIDEO),n}function A(e){return!!e.speakers[e.me]}},874023:(e,t,a)=>{"use strict";a.d(t,{DAY:()=>n,WEEK:()=>r,SECOND_JS:()=>i});var n=86400,r=7*n,i=1e3},767497:(e,t,a)=>{"use strict";a.d(t,{generateStartCallsDeepLink:()=>r,generateJoinCallsDeepLink:()=>i});var n=a(121255),r=function(e){var t=e.peerId,a=e.userId,r=""+n.DESKTOP_CALLS_SCHEME+n.DESKTOP_CALLS_HOST+"/start?peerId="+t+"&userId="+a;return console.log("deeplink: ",r),r},i=function(e){var t=e.joinLink,a=e.userId;return""+n.DESKTOP_CALLS_SCHEME+n.DESKTOP_CALLS_HOST+"/join?joinLink="+t+"&userId="+a}},307915:(e,t,a)=>{"use strict";a.d(t,{getPermissionsErrorMessage:()=>r,getMediaErrorMessage:()=>i});var n=a(121255);function r(e,t,a){void 0===t&&(t=!0);var n="";return e&&t?n=a("calls_error_no_cam_and_mic"):e?n=a("calls_error_no_cam"):t&&(n=a("calls_error_no_mic")),n}function i(e,t){var a;return((a={})[n.MediaError.CAMERA_PERMISSION]=t("calls_error_no_cam"),a[n.MediaError.MIC_PERMISSION]=t("calls_error_no_mic"),a[n.MediaError.CAMERA_ACCESS]=t("calls_error_cameralock"),a[n.MediaError.MIC_ACCESS]=t("calls_error_miclock"),a[n.MediaError.MIC_NOT_FOUND]=t("calls_error_nomic"),a[n.MediaError.SCREEN_PERMISSION]=t("calls_error_screenpermission"),a[n.MediaError.SCREEN_ACCESS]=t("calls_error_screenlock"),a)[e]}},153907:(e,t,a)=>{"use strict";a.d(t,{download:()=>n});var n=function(e,t){var a=document.createElement("a");a.download=t,a.href=e,document.body.appendChild(a),a.click(),a.remove()}},298811:(e,t,a)=>{"use strict";a.d(t,{fetchUserShortName:()=>_,convertClientData:()=>m,convertServerData:()=>g,convertCallerFromLongpoll:()=>v,convertChatFromLongpoll:()=>f,getPeerIdFromLongpoll:()=>E,isGroupCallEvent:()=>C,isAnyoneWithVideo:()=>h,calculateCallDuration:()=>S,getTextForApiErrorByCode:()=>T,getTextForServerError:()=>I,getTextForClientError:()=>N,createPayload:()=>y,isInReconnect:()=>P,compose:()=>b,exponentialRetry:()=>L,startCallRetryWrapper:()=>M,getParticipantsListLabel:()=>w,unpackState:()=>O,normalizePreviewData:()=>k});var n=a(570655),r=a(389953),i=a(745284),o=a(121255),l=a(774351),s=a(659397),c=a(788822),u=a(613335),d=a(464380),p=a(697483);function A(e){var t,a=e.shortName,r=e.firstName;e.lastName;return a&&r||(a=_(r=(t=(0,n.__read)(e.name.split(" "),2))[0],t[1],e.name)),(0,n.__assign)((0,n.__assign)({},e),{peerId:+e.id,tab:e.name,shortName:a,firstName:r})}function _(e,t,a){if(e){var n=t?t.length>2?t.substring(0,1)+".":t:"";return n?e+" "+n:e}return a}function m(e){var t=(0,n.__read)(e,2),a=t[0],r=t[1],i=a&&function(e){var t=e.callInProgress,a=void 0!==t&&t,r=(0,n.__rest)(e,["callInProgress"]);return!r.call_in_progress&&a&&(r.call_in_progress=a),r}(a);return[i&&("peerId"in i?i:A(i)),r?r.map(A):[]]}function g(e){var t,a=e.items,i=e.profiles,o=(0,n.__read)(a,1)[0],l=function(e){if(e.chat_settings){var t={peerId:e.peer.id,tab:e.chat_settings.title,name:e.chat_settings.title,canAddMembers:e.chat_settings.acl.can_invite,adminIds:e.chat_settings.admin_ids,ownerId:e.chat_settings.owner_id||-1};return e.chat_settings.photo&&(t.photo=e.chat_settings.photo.photo_100),t}return{canAddMembers:!0,peerId:e.peer.id}}(o),s=function(e){return e.map(u.normalizeUser)}(i);return[(0,n.__assign)((0,n.__assign)({},l),{tab:l.name}),(0,r.isUserPeer)(null!==(t=l.peerId)&&void 0!==t?t:0)?[(0,n.__assign)((0,n.__assign)({},s&&s.filter((function(e){return e.peerId===l.peerId}))[0]),l)]:s,o]}function v(e){var t=e.caller_info,a=t.first_name+" "+t.last_name;return{peerId:+t.user_id,name:a,tab:a,photo:t.photo_400,firstName:t.first_name,lastName:t.last_name,shortName:_(t.first_name,t.last_name,a)}}function f(e){var t=e.chat_info;return{peerId:2e9+t.chat_id,tab:t.title,name:t.title,photo:t.photo_400}}function E(e){var t=e.caller_info,a=e.chat_info;return a?2e9+a.chat_id:t.user_id}function C(e){return!!e.payload.chat_info}function h(e){return!!Object.values(e.participants).find((function(t){return(t.peerId===e.me||t.wasConnected)&&t.mediaSettings&&(0,p.isParticipantWithVideo)(t)}))}function S(e){var t=Date.now(),a=Math.max(0,Math.floor((t-e)/1e3));return 0===a?"00:00":a<=599?"0"+(0,s.formatDuration)(a):(0,s.formatDuration)(a)}function T(e,t,a){switch(+e){case o.SERVER_ERROR_MESSAGES_CALL_JOIN_NOT_ALLOWED:return a("calls_join_error_require_access");case o.SERVER_ERROR_MESSAGES_CALL_NOT_FOUND:return a("calls_join_error_text");case o.SERVER_ERROR_PRIVACY:return a("calls_privacy_error");case o.SERVER_ERROR_BUSY:return a(t?"calls_chat_busy_error":"calls_busy_error");case o.SERVER_ERROR_FLOOD_CONTROL:return a("calls_flood_error");case o.SERVER_ERROR_REQUIRE_AUTH:return a("calls_join_error_require_auth");case o.SERVER_ERROR_UNKNOWN:case o.SERVER_ERROR_INVALID_REQUEST:case o.SERVER_ERROR_INTERNAL:case o.SERVER_ERROR_OLD_RECEIVER_APP:default:return a("calls_start_error")}}function I(e,t,a){var n,r,i=0===e.search("EXTERNAL_API_ERROR"),l=e.match(/\d+/g),s=l?Number(null===(n=e.match(/\d+/g))||void 0===n?void 0:n[1]):o.CLIENT_ERROR_UNKNOWN,c=l?Number(null===(r=e.match(/\d+/g))||void 0===r?void 0:r[0]):o.CLIENT_ERROR_UNKNOWN;if(!i||Number.isNaN(s)){switch(c){case o.SDK_ERROR_AUTH:return a("calls_start_error_auth")}return function(e,t,a){switch(!0){case-1!==e.search("error.webrtc.auth.required"):return a("calls_join_error_require_auth");case-1!==e.search("error.webrtc.auth.banned"):case-1!==e.search("error.webrtc.participant.check.privacy"):return a("calls_join_error_banned");case-1!==e.search("error.webrtc.participant.check.killed_call"):return a("calls_join_error_killed_call");case-1!==e.search("not.found.webrtc.conversation"):return a("calls_join_error_not_found_conversation");default:return a("calls_start_error")}}(e,0,a)}switch(e){case d.HangupType.CANCELED:return a("calls_hangup_error_canceled");case d.HangupType.REJECTED:return a("calls_hangup_error_rejected");case d.HangupType.REMOVED:return a("calls_hangup_error_removed");case d.HangupType.HUNGUP:return a("calls_hangup_error_hangup");case d.HangupType.MISSED:return a("calls_hangup_error_missed");case d.HangupType.BUSY:return a("calls_hangup_error_busy");case d.HangupType.FAILED:return a("calls_hangup_error_failed");case d.HangupType.NETWORK_ERROR:return a("calls_hangup_error_network_error");case d.HangupType.CALLER_IS_BLOCKED:return a("calls_hangup_error_caller_is_blocked");case d.HangupType.NOT_FRIENDS:return a("calls_hangup_error_not_friends");case d.HangupType.CALLEE_IS_OFFLINE:return a("calls_hangup_error_callee_is_offline");case d.HangupType.UNKNOWN_ERROR:return a("calls_hangup_error_unknown_error");case d.HangupType.UNSUPPORTED:return a("calls_hangup_error_unsupported");case d.HangupType.OLD_VERSION:return a("calls_hangup_error_old_version");case d.HangupType.SERVICE_DISABLED:return a("calls_hangup_error_service_disabled");case d.HangupType.EXTERNAL_API_ERROR:return a("calls_hangup_error_external_api_error");case d.HangupType.SOCKET_CLOSED:return a("calls_hangup_error_socket_closed")}return T(+s,t,a)}function N(e,t,a){return a("calls_sorry_error")}function y(e,t){return JSON.stringify({is_video:t.includes(d.MediaOption.VIDEO),chat_id:(0,r.isChatPeer)(e)?e-2e9:void 0,with_join_link:(0,i.isGroupCallByPeer)(e),join_by_link:(0,i.isGroupCallByPeer)(e)})}function P(e){return!!Object.values(e.participants).find((function(e){return e.status===d.ParticipantStatus.RECONNECT}))}var b=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return function(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];return t.reduce((function(e,t){return t(e)}),e).apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(a)))}};function L(e,t){return void 0===t&&(t={attempts:10,timeout:0}),function(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];return t.attempts>0?(0,l.pause)(t.timeout,null).then((function(){return e.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(a)))})).catch((function(r){return!t.timeout&&(t.timeout=1),t.attempts=r.type===o.SdkErrorType.API?0:t.attempts-1,t.timeout=Math.min(2*t.timeout,300),L(e,t).apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(a)))})):Promise.reject(o.CallErrorType.CANT_REACH_API)}}var M=function(e,t){return function(){for(var a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];return t.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(a))).catch((function(r){if(r.error===o.FatalError.AUTH)return e().then((function(){return t.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(a)))}));throw r}))}};function w(e,t,a,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=3);var l=function(e){return(0,c.decodeHTMLEntities)(a(e)||"")};if(0===i&&e.length>0&&(i=e.length),i>t.length){var s=i-t.length,u=e.slice(0,o).map(l).join(", ");return r(s,"calls_members_list_label",n("calls_members_list_label",s)).replace("{name}",u)}if(t.length>1){var d=t.length>2?e.slice(0,2).map(l).join(", "):l(e[0]),p=l(e[t.length-1]);return n("calls_and").replace("{before}",d).replace("{after}",p)}return 1===t.length?l(e[0]):""}function O(e){return"current"in e?e.current:e}function k(e,t){var a=t.join_link,r=t.preview,i=t.profiles,o=t.anonyms,l=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(o)),(0,n.__read)(i)).map(u.normalizeUser);return{joinLink:a,title:r.title,membersCount:r.members_count,photo_100:r.photo.photo_100,photo_200:r.photo.photo_200,members:l,conversationData:{peerId:0,canAddMembers:!0,tab:e("calls_new_call_title"),photo:"https://vk.com/images/call_convo_stub.png"}}}},697483:(e,t,a)=>{"use strict";a.d(t,{isParticipantAnonym:()=>c,isParticipantGroup:()=>u,getParticipantExternalId:()=>d,getParticipantActions:()=>A,isParticipantInCall:()=>_,isParticipantUnavailableToCallFromGroup:()=>m,getCallVisibleParticipant:()=>g,getActiveParticipants:()=>f,getActiveParticipantsCount:()=>E,getNonAnonymousConnectParticipantsCount:()=>C,getConnectedAdminsCount:()=>h,canPinParticipants:()=>N,isAdmin:()=>y,isCreator:()=>P,canMuteParticipants:()=>b,getRaisedHands:()=>M,kickParticipant:()=>w,participantIsChatAdmin:()=>O,participantIsAdmin:()=>k,isMutedPermanently:()=>D,getMeId:()=>R,getStream:()=>B,isParticipantWithVideo:()=>G,getOrator:()=>H});var n=a(570655),r=a(121255),i=a(745284),o=a(464380),l=a(614914),s=a(613335),c=function(e){return e>-19e8&&e<-189e7},u=function(e){return e<0&&e>-1e9},d=function(e){return(null==e?void 0:e.peerId)?c(e.peerId)?e.peerId.toString():{id:e.peerId.toString(),type:o.ExternalIdType.USER}:null},p={},A=function(e,t,a,n,s,A,_,m,g){void 0===g&&(g=!1);var v=n.peerId===e.me,f=c(n.peerId),E=(0,i.isGroupCallByPeer)(e.peer),C=e.participants[e.me],h=!!e.groupId,S=[],T=[],M=e.config.isModalView,w=u(n.peerId);if(v||!s||f||void 0===m||S.push({text:A(w?"calls_go_to_community":"calls_go_to_profile"),onClick:function(e){m(e,n.link)}}),v||f||c(e.me)||void 0===_||h||S.push({text:A(w?"calls_go_to_chat_with_community":"calls_go_to_chat_with_participant"),onClick:function(){M&&a({type:r.CHANGE_UI_MODE,mode:r.UIMode.COLLAPSED}),a({type:r.MANAGEMENT,isOpen:!1}),_(n.peerId)}}),!v&&E&&!c(e.me)&&function(e){return k(e)}(C)&&!P(n)){var O={negative:!0,text:A("calls_participant_menu_kick"),onClick:function(){a({type:r.TOGGLE_PARTICIPANTS_KICK,data:{type:r.KickParticipantType.CALL,participant:n}})}};g?T.push(O):S.push(O)}if(!v&&E&&!c(e.me)&&b(C)&&S.push({text:A("calls_participant_menu_mute_audio_video"),onClick:function(){a({type:r.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:r.ParticipantsManagementMode.SINGLE,participant:n}})}}),v||E||c(e.me)||!b(C)||S.push({text:A("calls_participant_menu_mute"),onClick:function(){var e=d(n);e&&t.muteParticipant(e,[o.MediaOption.AUDIO],!1).catch(console.log)}}),v||!E||c(e.me)||!b(e.participants[e.me])||function(e){if(!e.mediaSettings)return!1;var t=e.mediaSettings,a=t.isAudioEnabled,n=t.isVideoEnabled,r=t.isScreenSharingEnabled;return a&&(n||r)}(n)||S.push({text:A("calls_participant_menu_enable_media_request"),onClick:function(){t.unmuteRequest(d(n),[o.MediaOption.AUDIO,o.MediaOption.VIDEO,o.MediaOption.SCREEN_SHARING]).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ASK_USER_TO_UNMUTE,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)})}}),v||!E||c(e.me)||c(n.peerId)||!L(e.participants[e.me])||y(n)||P(n)||n.status!==o.ParticipantStatus.CONNECTED||S.push({text:A("calls_participant_menu_assign_admin_role"),onClick:function(){a({type:r.TOGGLE_ADMIN_ASSIGNMENT,data:{participant:n}})}}),!v&&E&&!c(e.me)&&L(e.participants[e.me])&&y(n)&&S.push({text:A("calls_participant_menu_revoke_admin_role"),onClick:function(){var s=d(n);s&&(t.grantRoles(s,[o.UserRole.ADMIN],!0).then((function(){a({type:r.CHANGE_PARTICIPANT_ROLES,participantId:n.peerId,data:n.roles.filter((function(e){return e!==o.UserRole.ADMIN}))})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.RETRIEVE_ADMIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),E&&!c(e.me)&&N(e.participants[e.me])&&!I(e,n)&&S.push({text:A("calls_participant_menu_pin"),onClick:function(){var o=d(n);o&&(t.pinParticipant(o,!1).then((function(){a({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:n.peerId}),a({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ADMIN_PIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),E&&!c(e.me)&&N(e.participants[e.me])&&I(e,n)&&S.push({text:A("calls_participant_menu_pin_cancel"),onClick:function(){var o=d(n);o&&(t.pinParticipant(o,!0).then((function(){a({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:null})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ADMIN_UNPIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),g&&T.length>0&&(S.push({separator:!0}),S=S.concat(T)),p[n.peerId]){var D=S.length===p[n.peerId].length;if(D)for(var R=0;R<S.length;R++)S[R].text!==p[n.peerId].text&&(D=!1);D?S=p[n.peerId]:p[n.peerId]=S}else p[n.peerId]=S;return S},_=function(e,t){var a=e.participants[t];return a&&(a.peerId===e.me||!!a.status)},m=function(e,t){return!!e.unableToCallGroupMembersIds&&e.unableToCallGroupMembersIds.indexOf(t)>-1};function g(e,t){var a,r,o=(0,i.isGroupCallByPeer)(e.peer)?e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator:e.peer;if(o)return e.participants[o];var l=e.participants[e.me];try{for(var s=(0,n.__values)(Object.values(e.participants)),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.peerId!==e.me&&u.wasConnected&&(l||(l=u),!t||G(u)))return u}}catch(e){a={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return null!=l?l:e.participants[e.me]}var v=[];function f(e,t,a,r,i){var o,l,c,u,d,p=[],A=[],_=[],m=[],g=[],f=[];try{for(var E=(0,n.__values)(Object.values(e)),C=E.next();!C.done;C=E.next()){var h=C.value;h.status&&((null===(c=h.statusData)||void 0===c?void 0:c.hand)?p.push(h):h.peerId===i?A.push(h):h.peerId===t?_.push(a&&r?(0,s.mergeGroupToParticipant)(r,e[t]):e[t]):(null===(u=h.mediaSettings)||void 0===u?void 0:u.isScreenSharingEnabled)?m.push(h):(null===(d=h.mediaSettings)||void 0===d?void 0:d.isVideoEnabled)?g.push(h):f.push(h))}}catch(e){o={error:e}}finally{try{C&&!C.done&&(l=E.return)&&l.call(E)}finally{if(o)throw o.error}}var S=(0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(p)),(0,n.__read)(A)),(0,n.__read)(_)),(0,n.__read)(m)),(0,n.__read)(g)),(0,n.__read)(f));if(S.length!==v.length)v=S;else for(var T=0;T<S.length;T++)if(S[T]!==v[T]){v=S;break}return v}function E(e){var t=e.participants,a=0;for(var n in t)t.hasOwnProperty(n)&&T(e,t[n])&&a++;return a}function C(e){return S(e).filter((function(e){return!c(e.peerId)})).length}function h(e){return S(e).filter((function(e){return y(e)||P(e)})).length}function S(e){return Object.values(e.participants).filter((function(e){return e.status===o.ParticipantStatus.CONNECTED})).concat(e.participants[e.me])}function T(e,t){return t.peerId===e.me||t.status}function I(e,t){return e.adminPinnedParticipant===t.peerId}function N(e){return y(e)||P(e)}function y(e){return!!(null==e?void 0:e.roles)&&e.roles.some((function(e){return e===o.UserRole.ADMIN}))}function P(e){return!!(null==e?void 0:e.roles)&&e.roles.some((function(e){return e===o.UserRole.CREATOR}))}function b(e){return!!e.roles&&(P(e)||y(e))}function L(e){return!!e.roles&&(P(e)||y(e))}function M(e){var t,a,n=e.participants,r=0;for(var i in n)n.hasOwnProperty(i)&&T(e,n[i])&&(null===(a=null===(t=n[i])||void 0===t?void 0:t.statusData)||void 0===a?void 0:a.hand)&&r++;return r}function w(e,t){void 0===t&&(t=!1);var a=d(e);return a?(0,o.removeParticipant)(a,t):Promise.resolve()}function O(e,t){if(!t)return!1;var a=null==e?void 0:e.peerId;return!!a&&(a===t.ownerId||!!t.adminIds&&t.adminIds.includes(a))}function k(e){return y(e)||P(e)}function D(e){var t=e.permissions||{};return[t.audio,t.video,t.screenSharing].some((function(e){return e===r.MediaPermissionType.DENY}))}function R(e){return(0,i.isAuthedByGroupId)(e)?e.groupId:e.me}function B(e,t){return void 0===t&&(t=!1),t?e.stream:e.screenSharingStream?e.screenSharingStream:e.stream}function G(e){var t;return!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isVideoEnabled)||function(e){var t;return!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isScreenSharingEnabled)&&!!e.screenSharingStream}(e)}function H(e){var t;return null!==(t=e.participants[e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me])&&void 0!==t?t:{}}},757054:(e,t,a)=>{"use strict";a.d(t,{getParticipantLayout:()=>c,getParticipantsLayoutDiff:()=>u});var n,r=a(121255),i=a(298811),o=a(464380),l=a(697483),s=a(745284);!function(e){e.CONTAIN="cn",e.COVER="cv"}(n||(n={}));function c(e,t,a){return(0,s.isGroupCallByPeer)(e.peer)?e.uiMode===r.UIMode.COLLAPSED?function(e){var t=(0,i.isAnyoneWithVideo)(e),a=(0,l.getCallVisibleParticipant)(e,t),n=(0,l.getActiveParticipants)(e.participants,e.me,e.groupId,e.meGroup),r=e.config,s=r.enableScreenTrack,c=r.enableProducerScreenTrack;return n.reduce((function(e,t){var n=t.peerId,r=t.mediaSettings;if(s||c){var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),l=Boolean(null==r?void 0:r.isVideoEnabled),u=n===(null==a?void 0:a.peerId);u&&i&&(e.set(v(n,o.MediaType.SCREEN),p(a,o.MediaType.SCREEN)),e.set(v(n,o.MediaType.CAMERA),d(t,o.MediaType.CAMERA))),u&&!i&&l&&(e.set(v(n,o.MediaType.CAMERA),p(a,o.MediaType.CAMERA)),e.set(v(n,o.MediaType.SCREEN),d(t,o.MediaType.SCREEN))),u&&(i||l)||(e.set(v(n,o.MediaType.SCREEN),d(t,o.MediaType.SCREEN)),e.set(v(n,o.MediaType.CAMERA),d(t,o.MediaType.CAMERA)))}else n===(null==a?void 0:a.peerId)&&g(r)?e.set(n,p(a)):e.set(n,d(t));return e}),new Map)}(e):e.isOratorMode?function(e,t,a){var n,i,s,c,u=e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me,p=(0,l.getActiveParticipants)(e.participants,e.me,e.groupId,e.meGroup),A=0,f=e.config,E=f.enableScreenTrack,C=f.enableProducerScreenTrack;if(E||C){var h=new Map,S=Boolean(null===(i=null===(n=e.participants[u])||void 0===n?void 0:n.mediaSettings)||void 0===i?void 0:i.isScreenSharingEnabled),T=Boolean(null===(c=null===(s=e.participants[u])||void 0===s?void 0:s.mediaSettings)||void 0===c?void 0:c.isVideoEnabled),I=e.uiMode===r.UIMode.FULLSCREEN;return S&&(A++,h.set(v(u,o.MediaType.SCREEN),_(e.participants[u],I,!1,t,a,o.MediaType.SCREEN))),S&&T&&(A++,h.set(v(u,o.MediaType.CAMERA),m(e.participants[u],o.MediaType.CAMERA))),S&&!T&&h.set(v(u,o.MediaType.CAMERA),d(e.participants[u],o.MediaType.CAMERA)),!S&&T&&(A++,h.set(v(u,o.MediaType.CAMERA),_(e.participants[u],I,!1,t,a,o.MediaType.CAMERA)),h.set(v(u,o.MediaType.SCREEN),d(e.participants[u],o.MediaType.SCREEN))),S||T||(h.set(v(u,o.MediaType.CAMERA),d(e.participants[u],o.MediaType.CAMERA)),h.set(v(u,o.MediaType.SCREEN),d(e.participants[u],o.MediaType.SCREEN))),p.reduce((function(t,a){var n=a.peerId,r=a.mediaSettings;if(n===e.me||n===u)return t;var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),l=Boolean(null==r?void 0:r.isVideoEnabled),s=a.visible&&A<=e.config.videoSlotsCount;return s&&l&&(A++,t.set(v(n,o.MediaType.CAMERA),m(a,o.MediaType.CAMERA)),t.set(v(n,o.MediaType.SCREEN),d(a,o.MediaType.SCREEN))),s&&!l&&i&&(A++,t.set(v(n,o.MediaType.SCREEN),m(a,o.MediaType.SCREEN)),t.set(v(n,o.MediaType.CAMERA),d(a,o.MediaType.CAMERA))),s&&(l||i)||(t.set(v(n,o.MediaType.SCREEN),d(a,o.MediaType.SCREEN)),t.set(v(n,o.MediaType.CAMERA),d(a,o.MediaType.CAMERA))),t}),h),h}return p.reduce((function(n,i){var o=i.peerId,l=i.mediaSettings;if(o===e.me)return n;if(u===o&&g(l)){var s=_(i,e.uiMode===r.UIMode.FULLSCREEN,!1,t,a);n.set(i.peerId,s)}else g(l)&&i.visible&&A<=e.config.videoSlotsCount?(A++,n.set(i.peerId,m(i))):n.set(i.peerId,d(i));return n}),new Map)}(e,t,a):function(e,t,a){var n=e.uiMode===r.UIMode.FULLSCREEN,i=n?t:900,s=n?a:504,c=(0,l.getActiveParticipants)(e.participants,e.me,e.groupId,e.meGroup),u=function(e,t,a){switch(a){case 1:return t;case 2:return Math.round(e/2);case 3:return Math.round(e/3);case 4:case 5:case 6:return Math.round(t/2);case 7:case 8:return Math.round(e/4);case 9:case 10:return Math.round(e/5);case 11:case 12:case 13:case 14:case 15:return Math.round(t/3);default:return Math.round(e/6)}}(i,s,c.length),p=u<200?1:2,_=0,m=e.config,f=m.enableScreenTrack,E=m.enableProducerScreenTrack;return c.reduce((function(t,a){if(!(0,l.getParticipantExternalId)(a)||a.peerId===e.me)return t;var n=a.peerId,r=a.mediaSettings;if(f||E){var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),s=Boolean(null==r?void 0:r.isVideoEnabled),c=a.visible&&_<=e.config.videoSlotsCount;return c&&i&&(_++,t.set(v(n,o.MediaType.SCREEN),A(a,u,p,o.MediaType.SCREEN)),t.set(v(n,o.MediaType.CAMERA),d(a,o.MediaType.CAMERA))),c&&!i&&s&&(_++,t.set(v(n,o.MediaType.CAMERA),A(a,u,p,o.MediaType.CAMERA)),t.set(v(n,o.MediaType.SCREEN),d(a,o.MediaType.SCREEN))),c&&(i||s)||(t.set(v(n,o.MediaType.CAMERA),d(a,o.MediaType.CAMERA)),t.set(v(n,o.MediaType.SCREEN),d(a,o.MediaType.SCREEN))),t}return g(r)&&a.visible&&_<=e.config.videoSlotsCount?(t.set(a.peerId,A(a,u,p)),_++):t.set(a.peerId,d(a)),t}),new Map)}(e,t,a):function(e,t,a){var n=new Map,i=e.participants[e.peer];if(!i)return n;var l=e.config,s=l.enableScreenTrack,c=l.enableProducerScreenTrack,u=e.uiMode===r.UIMode.FULLSCREEN,p=e.uiMode===r.UIMode.COLLAPSED,A=i.peerId,f=i.mediaSettings;if(A===e.me)return n;if(s||c){var E=Boolean(null==f?void 0:f.isScreenSharingEnabled),C=Boolean(null==f?void 0:f.isVideoEnabled);if(E&&C&&(n.set(v(A,o.MediaType.SCREEN),_(i,u,p,t,a,o.MediaType.SCREEN)),n.set(v(A,o.MediaType.CAMERA),m(i,o.MediaType.CAMERA))),E!==C){var h=E?o.MediaType.SCREEN:o.MediaType.CAMERA,S=E?o.MediaType.CAMERA:o.MediaType.SCREEN;n.set(v(A,h),_(i,u,p,t,a,h)),n.set(v(A,S),d(i,S))}return E||C||(n.set(v(A,o.MediaType.SCREEN),d(i,o.MediaType.SCREEN)),n.set(v(A,o.MediaType.CAMERA),d(i,o.MediaType.CAMERA))),n}return n.set(i.peerId,g(f)?_(i,u,p,t,a):d(i)),n}(e,t,a)}function u(e,t){var a=[];return t.forEach((function(t,n){var r=e.get(n);r&&function(e,t){var a=e,n=t;if(!0===a.stopStream&&!0===n.stopStream)return!0;if(!0===a.stopStream||!0===n.stopStream)return!1;var r=e,i=t;return r.fit===i.fit&&r.width===i.width&&r.height===i.height&&r.priority===i.priority}(r,t)||a.push(t)})),a}function d(e,t){return void 0===t&&(t=null),{stopStream:!0,uid:(0,l.getParticipantExternalId)(e)||"",mediaType:t}}function p(e,t){void 0===t&&(t=null);var a=(0,l.getParticipantExternalId)(e);return{fit:n.CONTAIN,width:265,height:200,priority:2,uid:a||"",keyFrame:!1,mediaType:t}}function A(e,t,a,r){void 0===r&&(r=null);var i=(0,l.getParticipantExternalId)(e);return{fit:n.COVER,width:t,height:t,priority:a,uid:i||"",keyFrame:!1,mediaType:r}}function _(e,t,a,r,i,o){void 0===o&&(o=null);var s=(0,l.getParticipantExternalId)(e);return{fit:n.CONTAIN,width:t?r:a?265:900,height:t?i:a?200:504,priority:3,uid:s||"",keyFrame:!1,mediaType:o}}function m(e,t){void 0===t&&(t=null);var a=e.mediaSettings,r=(0,l.getParticipantExternalId)(e);return{fit:(null==a?void 0:a.isScreenSharingEnabled)?n.CONTAIN:n.COVER,width:140,height:140,priority:1,uid:r||"",keyFrame:!1,mediaType:t}}function g(e){var t;return null!==(t=!!(null==e?void 0:e.isVideoEnabled)||!!(null==e?void 0:e.isScreenSharingEnabled))&&void 0!==t&&t}function v(e,t){return void 0===t&&(t=null),t?e+":"+t:e}},768606:(e,t,a)=>{"use strict";a.d(t,{throttleAccumulateDispatchParticipant:()=>l,applyParticipantsBatch:()=>s});var n=a(570655),r=a(121255),i=a(464380),o={acc:{},timer:0,tasks:0};function l(e,t,a,i){!function(e,t,a,r,i){void 0===r&&(r=100);i.acc[e]=i.acc[e]&&"object"==typeof i.acc[e]?(0,n.__assign)((0,n.__assign)({},i.acc[e]),t):t,i.tasks++,i.timer&&clearTimeout(i.timer);i.timer=window.setTimeout((function(){i.tasks>0&&(a(i.acc),i.acc={},i.tasks=0),i.timer=0}),r)}(t,a,(function(t){e({type:r.UPDATE_PARTICIPANTS_BATCH,data:t})}),i,o)}function s(e,t){var a,r=(0,n.__assign)((0,n.__assign)({},e),{participants:(0,n.__assign)({},e.participants)});for(var o in t)if(t.hasOwnProperty(o))if(void 0===(null===(a=e.participants[o])||void 0===a?void 0:a.status)&&t[o].status===i.ParticipantStatus.HANGUP)delete r.participants[o];else{var l=e.participants[o]||{},s=t[o],c=s.statusData?(0,n.__assign)((0,n.__assign)({},l.statusData),s.statusData):l.statusData,u=l.wasConnected||s.status===i.ParticipantStatus.CONNECTED;r.participants[o]=(0,n.__assign)((0,n.__assign)((0,n.__assign)({peerId:o},e.participants[o]),t[o]),{statusData:c,wasConnected:u})}return r}},674543:(e,t,a)=>{"use strict";a.d(t,{canStopTranslation:()=>i});var n=a(697483),r=a(613335);function i(e){var t,a,i,o,l=(0,r.getMe)(e);return!(!(0,n.isAdmin)(l)&&!(0,n.isCreator)(l))||!!(null===(a=null===(t=e.translation)||void 0===t?void 0:t.host)||void 0===a?void 0:a.id)&&+(null===(o=null===(i=e.translation)||void 0===i?void 0:i.host)||void 0===o?void 0:o.id)===(0,n.getMeId)(e)}},613335:(e,t,a)=>{"use strict";a.d(t,{normalizeUser:()=>s,normalizeGroup:()=>c,createFriendsCache:()=>u,getMe:()=>d,mergeGroupToParticipant:()=>p,getExternalIdByUserId:()=>A});var n=a(570655),r=a(298811),i=a(788822),o=a(697483),l=a(464380),s=function(e){var t=e.id,a=e.photo_400_orig,l=e.sex,s=e.first_name,c=e.last_name,u=e.screen_name,d=e.first_name_gen,p=e.name,A=e.photo_400,_=e.can_call;return(0,o.isParticipantGroup)(+t)&&(s=(0,i.escape)(s)),(0,n.__assign)({id:+t,peerId:+t,name:p||s+" "+c,firstName:s,shortName:(0,r.fetchUserShortName)(s,c,p),shortNameGen:(0,r.fetchUserShortName)(d,c,p),link:u&&"/"+u,sex:l,canCall:_},a||A?{photo:a||A}:{})},c=function(e){var t=e.id,a=e.name,n=e.screen_name,r=e.photo_400_orig,o=e.photo_100;return{id:-t,peerId:-t,name:(0,i.escape)(a),firstName:"",lastName:"",shortName:"",shortNameGen:"",link:n&&"/"+n,photo:r||o,photo_100:o}};function u(e){return e.reduce((function(e,t){return e[t.id]=!0,e}),{})}function d(e){return e.participants[e.me]}function p(e,t){var a=(0,n.__assign)({},t);return e.photo&&(a.photo=e.photo),e.name&&(a.name=e.name),e.link&&(a.link=e.link),a}function A(e){var t=l.ExternalIdType.USER;return(0,o.isParticipantGroup)(e)&&(t=l.ExternalIdType.GROUP),{id:e.toString(),type:t}}},604233:(e,t,a)=>{"use strict";function n(e,t){return"/video"+e+"_"+t}function r(e){var t=document.createElement("video"),a=function(){t.classList.add("Video--visible"),t.removeEventListener("loadeddata",a)};return t.addEventListener("loadeddata",a),t.autoplay=!0,t.controls=!1,t.crossOrigin="anonymous",t.playsInline=!0,t.preload="metadata",t.srcObject=e,t.volume=0,t}a.d(t,{getShortVideoUrl:()=>n,createVideoTag:()=>r})},474803:(e,t,a)=>{"use strict";a.d(t,{usePriorities:()=>l});var n=a(570655),r=a(667294),i=a(757054),o=a(121255),l=function(e,t){var a=(0,n.__read)((0,r.useState)([0,0]),2),l=(0,n.__read)(a[0],2),s=l[0],c=l[1],u=a[1],d=(0,r.useRef)(new Map);(0,r.useEffect)((function(){var e=function(){return u([window.innerWidth,window.innerHeight])};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((function(){if(t.mode===o.Mode.CALL){var a=(0,i.getParticipantLayout)(t,s,c),n=(0,i.getParticipantsLayoutDiff)(d.current,a);n.length>0&&(d.current=a,e.updateDisplayLayout(n))}else d.current=new Map}),[s,c,t.participants,t.mode,t.uiMode,t.isOratorMode,t.orator,t.pinnedParticipant,t.adminPinnedParticipant,t.screenSharingPinnedParticipant,t.translation])}},594504:(e,t,a)=>{"use strict";a.d(t,{AnonymousIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"28",height:"28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#paint0_linear)"}),r.createElement("path",{d:"M6.746 14.391c-.165-1.078-.204-1.206-.493-1.614-.363-.513-.415-1.1.38-1.255 2.042-.397 4.252-.1 6.265.268a5.546 5.546 0 002.204 0c2.013-.368 4.223-.665 6.264-.268.796.154.744.742.38 1.255-.288.408-.327.536-.492 1.614-.248 1.617-1.607 2.275-3.29 2.276-1.85 0-2.465-1.055-3.04-2.494-.557-1.398-1.29-1.398-1.849 0-.574 1.439-1.19 2.494-3.038 2.494-1.684 0-3.043-.66-3.29-2.276z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"paint0_linear",x1:"0",y1:"0",x2:"28.733",y2:".773",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#99A2AD"}),r.createElement("stop",{offset:"1",stopColor:"#99A2AD"}))))}},923522:(e,t,a)=>{"use strict";a.d(t,{CancelIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"20",height:"20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.72 4.72a.75.75 0 011.06 0L10 8.94l4.22-4.22a.75.75 0 111.06 1.06L11.06 10l4.22 4.22a.75.75 0 11-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 01-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 010-1.06z",fill:"#99A2AD"}))}},968125:(e,t,a)=>{"use strict";a.d(t,{ChainIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.49 4.293a4.402 4.402 0 116.225 6.225l-1.072 1.072a.9.9 0 01-1.273-1.273l1.071-1.072a2.601 2.601 0 10-3.678-3.678l-3.537 3.537a2.601 2.601 0 000 3.678.9.9 0 01-1.274 1.273 4.402 4.402 0 010-6.225l3.537-3.537zm-.708 5.66a.9.9 0 011.273 0 4.402 4.402 0 010 6.225l-3.537 3.537a4.402 4.402 0 11-6.225-6.226l1.122-1.121a.9.9 0 111.273 1.273l-1.121 1.122a2.601 2.601 0 103.678 3.678l3.537-3.537a2.601 2.601 0 000-3.678.9.9 0 010-1.274z",fill:"#fff"}))}},701683:(e,t,a)=>{"use strict";a.d(t,{DisabledVideoIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"16",width:"22",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M1.514.242A.9.9 0 00.286 1.558l1.092 1.02C1.13 3.053 1 3.548 1 4.846v6.308c0 1.338.14 1.822.4 2.311.262.49.646.873 1.135 1.134.489.262.974.401 2.31.401h7.31c1.207 0 1.72-.114 2.168-.328l1.163 1.086a.9.9 0 001.228-1.316L1.514.242zM15.999 11.346L4.924 1h7.23c1.338 0 1.822.14 2.311.4.49.262.873.646 1.134 1.135.262.489.401.974.401 2.31 0 2.167.023 4.335-.001 6.501zM22 4.497v7.006c0 .815-.964 1.277-1.6.8l-2.2-1.653a.5.5 0 01-.2-.4v-4.5a.5.5 0 01.2-.4l2.2-1.652c.651-.49 1.6.003 1.6.8z"}))}},80125:(e,t,a)=>{"use strict";a.d(t,{DisabledVideoIconS:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"14",height:"12",fill:"currentColor"},t,{xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M9.574 11.13a.751.751 0 001.061-1.06L1.48.92A.75.75 0 10.42 1.98l.82.82c-.153.282-.24.606-.24.95v4.5a2 2 0 002 2h5a2 2 0 00.601-.092l.973.972zM13.897 3.664A.454.454 0 0114 3.95v4.075c0 .415-.392.602-.825.382-.475-.24-1.572-.789-1.572-.789a.233.233 0 01-.103-.19v-2.88c0-.075.038-.146.103-.19 0 0 1.378-.694 1.572-.79.193-.094.55-.115.722.096zM10 7.425V3.75a2 2 0 00-2-2H4.32L10 7.425z"}))}},815155:(e,t,a)=>{"use strict";a.d(t,{EndCallIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"24",height:"24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4.3 4.3a1 1 0 011.4 0l6.3 6.29 6.3-6.3a1 1 0 111.4 1.42L13.42 12l6.3 6.3a1 1 0 01-1.42 1.4L12 13.42l-6.3 6.3a1 1 0 01-1.4-1.42L10.58 12l-6.3-6.3a1 1 0 010-1.4z"}))}},172397:(e,t,a)=>{"use strict";a.d(t,{FullScreenIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6.5 15a1 1 0 01-1 1H1a1 1 0 01-1-1v-4.5a1 1 0 012 0v2.071l3.363-3.364a1 1 0 011.414 0l.016.016a1 1 0 010 1.414L3.428 14H5.5a1 1 0 011 1zM14 3.428l-3.363 3.365a1 1 0 01-1.414 0l-.016-.016a1 1 0 010-1.414L12.571 2H10.5a1 1 0 010-2H15a1 1 0 011 1v4.5a1 1 0 01-2 0z"}))}},167903:(e,t,a)=>{"use strict";a.d(t,{FullScreenOffIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6.1 9a.9.9 0 01.9.9v4.2a.9.9 0 11-1.8 0v-2.027l-3.664 3.663a.9.9 0 11-1.272-1.272L3.927 10.8H1.9a.9.9 0 110-1.8zM15.736.264a.9.9 0 010 1.272L12.073 5.2h2.025a.9.9 0 010 1.8H9.9a.9.9 0 01-.9-.9V1.9a.9.9 0 111.8 0v2.027L14.464.264a.9.9 0 011.272 0z"}))}},801513:(e,t,a)=>{"use strict";a.d(t,{LiveIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"28px",height:"10px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 28 10"},t),r.createElement("path",{fill:"#F2F3F5",fillRule:"evenodd",d:"M1 0a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 100-2H2V1a1 1 0 00-1-1zm7 1a1 1 0 112 0v8a1 1 0 11-2 0V1zm15-1a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 100-2h-3V6h3a1 1 0 100-2h-3V2h3a1 1 0 100-2h-4zm-8.325 9.31l-2.55-7.824a.993.993 0 01-.117-.363L12 1.1h.005A1 1 0 1113.995.9L14 .9l2 6.4 2-6.4h.005a1 1 0 011.99.2H20l-.008.023a.993.993 0 01-.118.363l-2.55 7.824a1 1 0 01-.95.69h-.748a1 1 0 01-.95-.69z",clipRule:"evenodd"}))}},818114:(e,t,a)=>{"use strict";a.d(t,{MicIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M8 0a4 4 0 00-4 4v5a4 4 0 008 0V4a4 4 0 00-4-4z"}),r.createElement("path",{d:"M1.1 10c-.551 0-.982.486-.843 1.02A8.007 8.007 0 007.1 16.95v2.15a.9.9 0 101.8 0v-2.15a8.007 8.007 0 006.843-5.93c.139-.534-.292-1.02-.843-1.02-.45 0-.826.329-.953.76a6.203 6.203 0 01-11.894 0C1.926 10.33 1.55 10 1.1 10z"}))}},830810:(e,t,a)=>{"use strict";a.d(t,{MoreIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"12",height:"20",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4 3a2 2 0 104 0 2 2 0 00-4 0zm0 7a2 2 0 104 0 2 2 0 00-4 0zm2 9a2 2 0 110-4 2 2 0 010 4z",fill:"currentColor"}))}},747212:(e,t,a)=>{"use strict";a.d(t,{MutedMicIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M1.721 2.307L4 4.586v-.002l7.029 7.029 4.693 4.695a1 1 0 01-1.414 1.414l-1.938-1.937A8.482 8.482 0 019 16.941V19a1 1 0 01-1.993.117L7.001 19v-2.06c-3.234-.384-5.995-2.611-6.955-5.646a.995.995 0 01.681-1.25 1.035 1.035 0 011.287.662C2.808 13.216 5.257 15 7.999 15c1.03 0 2.016-.25 2.89-.695l-1.538-1.539A4 4 0 014 9V7.414L.307 3.721a1 1 0 011.414-1.414zm13.55 7.737c.544.162.85.72.684 1.249a7.825 7.825 0 01-.75 1.666l-1.51-1.51c.113-.239.21-.487.29-.742a1.035 1.035 0 011.287-.663zM8 0a4 4 0 014 4v5c0 .237-.02.468-.06.694L4.433 2.188A4 4 0 018 0z"}))}},942775:(e,t,a)=>{"use strict";a.d(t,{MutedMicIconS:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"13",width:"12",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 13",fill:"currentColor"},t),r.createElement("path",{d:"M3.497 5.06v.44a2.501 2.501 0 002.91 2.467l1.199 1.198a4.005 4.005 0 01-5.521-2.822.75.75 0 00-1.469.314A5.508 5.508 0 005.25 10.95v1.301a.75.75 0 001.501 0v-1.3a5.472 5.472 0 001.973-.669l1.25 1.25a.751.751 0 001.062-1.061L1.88 1.32A.75.75 0 10.82 2.38l2.677 2.68zM9.672 7.097l1.117 1.117a5.463 5.463 0 00.594-1.557.75.75 0 10-1.468-.314 3.963 3.963 0 01-.243.754zM3.827 1.258l4.644 4.64c.02-.13.031-.263.031-.398v-3a2.502 2.502 0 00-4.675-1.242z"}))}},494549:(e,t,a)=>{"use strict";a.d(t,{ParticipantsIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M17 12.5c2.294 0 6.5.857 6.5 4.286 0 1.5-.382 1.714-1.147 1.714h-6.09c.158-.488.237-1.062.237-1.714 0-1.723-.631-3.067-1.672-4.062.783-.16 1.548-.224 2.172-.224zm-9 0c2.294 0 6.5.857 6.5 4.286 0 1.5-.382 1.714-1.147 1.714H2.647c-.765 0-1.147-.214-1.147-1.714C1.5 13.357 5.706 12.5 8 12.5zM8 5a3 3 0 110 6 3 3 0 110-6zm9 0a3 3 0 110 6 3 3 0 110-6z"}))}},995420:(e,t,a)=>{"use strict";a.d(t,{PhoneIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"18",width:"18",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M11.112 12.259c1.354-1.354 3.486-1.48 4.903-.287l1.025.863c1.168.983 1.287 2.757.263 3.96a3.318 3.318 0 01-2.195 1.133c-3.273.44-6.707-1.137-10.303-4.733C1.21 9.6-.369 6.165.072 2.892a3.25 3.25 0 01.159-.752c.19-.56.527-1.058.974-1.443C2.41-.327 4.181-.21 5.165.96l.862 1.024c1.194 1.416 1.07 3.55-.284 4.903l-.736.735a.712.712 0 00-.164.748c.267.732.95 1.645 2.046 2.74 1.096 1.097 2.01 1.78 2.74 2.048.26.095.553.03.749-.166z"}))}},780573:(e,t,a)=>{"use strict";a.d(t,{PhoneIconS:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"16",height:"16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.3 9.99c.93-.93 2.32-.75 3.63.35.94.79.82 2.85-1.18 3.12s-4.11-.7-6.32-2.9c-2.2-2.2-3.1-4.1-2.9-6.3a1.8 1.8 0 013.12-1.18c1.06 1.25 1.38 2.6.36 3.62-.48.48-.67.6-.56.91.41 1.1 2.19 2.65 2.94 2.93.35.13.46-.1.9-.55z"}))}},711034:(e,t,a)=>{"use strict";a.d(t,{PinDotIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"25",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M10 8a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"}),r.createElement("path",{d:"M6.558 10a.024.024 0 00-.017.04l3.254 3.255-2.947 2.948a1 1 0 001.414 1.414l2.948-2.948 3.25 3.25c.015.015.04.005.04-.017v-2.114c0-1.81.72-3.547 2-4.828l1.658-.414a.2.2 0 00.093-.336l-4-4a.2.2 0 00-.336.093L13.5 8a6.828 6.828 0 01-4.829 2H6.558z"}))}},748972:(e,t,a)=>{"use strict";a.d(t,{RaiseHandIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6 5.18c.65 0 1 .54 1 1.2v5.48c0 .22.26.4.47.4.23 0 .52-.18.52-.4V4c0-.66.33-1.2.99-1.2.65 0 1.02.54 1.02 1.2v7.08c0 .22.29.4.5.4.22 0 .5-.18.5-.4V3.19c0-.66.31-1.2.97-1.2.66 0 1.04.54 1.04 1.2v7.88c0 .22.24.4.46.4.22 0 .52-.18.52-.4V4.79c0-.67.32-1.18.98-1.18.66 0 1.02.51 1.02 1.17v10.73l2.29-2.67c.33-.45 1-.68 1.65-.26.34.2.86.81.2 1.68 0 0-2.45 3.09-3.81 4.74-1.3 1.65-3.81 2.5-5.51 2.5C5.25 21.5 5 17.71 5 16.43V6.37c0-.65.33-1.19 1-1.19z"}))}},595285:(e,t,a)=>{"use strict";a.d(t,{RaisedHandContourIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 21 24"},t),r.createElement("path",{d:"M21.442 10.058c.513.77.588 1.831.192 2.663l-2.679 5.625C17.435 21.538 13.54 24 9.998 24H9c-4.422 0-8-3.58-8-8.009V8.128a2.746 2.746 0 013.5-2.642v-.732a2.75 2.75 0 013.571-2.629A2.749 2.749 0 0110.75 0c1.47 0 2.67 1.15 2.746 2.604A2.748 2.748 0 0117 5.254v4.264c1.299-1.278 3.357-1.087 4.442.54zM3.75 7.383a.746.746 0 00-.75.745v7.863A5.998 5.998 0 009 22h.998c2.773 0 5.964-2.02 7.152-4.514l2.678-5.625a.787.787 0 00-.05-.694c-.428-.642-1.123-.65-1.55-.01l-2.177 3.267c-.576.864-1.051.726-1.051-.323V5.255a.748.748 0 00-.75-.755.746.746 0 00-.75.747v5.757c0 .55-.448.996-1 .996-.556 0-1-.446-1-.995V2.752a.75.75 0 10-1.5 0v8.253c0 .54-.448.995-1 .995-.556 0-1-.446-1-.997v-6.25A.756.756 0 007.25 4a.75.75 0 00-.75.754v6.738c0 .551-.448 1.008-1 1.008-.556 0-1-.447-1-.999V8.138a.751.751 0 00-.75-.755z"}))}},135063:(e,t,a)=>{"use strict";a.d(t,{RaisedHandIconS:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"15",height:"15",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M2.75 3a.75.75 0 01.75.75V7.5a.5.5 0 001 0V2A.75.75 0 016 2v4.75a.5.5 0 001 0v-5.5a.75.75 0 011.5 0v5.5a.5.5 0 001 0V2.5a.75.75 0 011.5 0v7.25l1.614-1.796a.9.9 0 011.36 1.177c-.73.873-2.044 2.449-2.809 3.367C9.913 14 8.08 14.5 6.701 14.5 2.2 14.5 2 11.47 2 10.444V3.75A.75.75 0 012.75 3z"}))}},796726:(e,t,a)=>{"use strict";a.d(t,{RaisedHandIconXs:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"10px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 10 11"},t),r.createElement("path",{fill:"#F5F5F5",d:"M.5 2.5A.5.5 0 011 3v2.5a.5.5 0 001 0v-4a.5.5 0 011 0V5a.5.5 0 001 0V1a.5.5 0 011 0v4.063a.5.5 0 001 0V1.938a.5.5 0 011 0V7.5l-.28-.032L8.494 5.57a.67.67 0 01.995.9 232.32 232.32 0 00-2.615 3.029C5.935 10.624 4.56 11 3.526 11 .15 11 0 8.727 0 7.958V3a.5.5 0 01.5-.5z"}))}},44781:(e,t,a)=>{"use strict";a.d(t,{RejectIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"14",width:"14",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M13.3.7a.99.99 0 00-1.4 0L7 5.6 2.1.7A.99.99 0 00.7 2.1L5.6 7 .7 11.9a.99.99 0 001.4 1.4L7 8.4l4.9 4.9a.99.99 0 001.4-1.4L8.4 7l4.9-4.9a.99.99 0 000-1.4z"}))}},462480:(e,t,a)=>{"use strict";a.d(t,{ShareIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"20",height:"20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.978 3.423a1.792 1.792 0 00-1.645 1.785v1.765l-.1.021a8.254 8.254 0 00-6.44 8.917.75.75 0 001.343.379l.175-.22a7.577 7.577 0 015.022-2.721v2.08a1.792 1.792 0 002.897 1.41l6.52-5.11a1.792 1.792 0 000-2.82l-6.52-5.11a1.791 1.791 0 00-1.105-.382l-.147.006zm.147 1.494c.065 0 .129.021.18.062l6.52 5.11a.292.292 0 010 .459l-6.52 5.11a.292.292 0 01-.472-.23v-2.873a.75.75 0 00-.767-.75l-.215.005-.305.016a9.065 9.065 0 00-5.162 2.056l-.037.032.004-.027a6.752 6.752 0 015.823-5.533.75.75 0 00.659-.744V5.208c0-.16.13-.291.292-.291z",fill:"#99A2AD"}))}},122317:(e,t,a)=>{"use strict";a.d(t,{ShareScreenBigIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"56",height:"56",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M28.5 37.5A1.5 1.5 0 0030 36V22.622l4.94 4.939a1.5 1.5 0 002.007.103l.114-.103a1.5 1.5 0 000-2.122l-7.5-7.5a1.5 1.5 0 00-2.122 0l-7.5 7.5a1.5 1.5 0 002.122 2.122l4.938-4.939L27 36a1.5 1.5 0 001.355 1.493l.145.007z"}),r.createElement("path",{d:"M19.883 8c-5.019 0-7.117.465-9.244 1.603a10.924 10.924 0 00-4.536 4.536C4.965 16.266 4.5 18.364 4.5 23.383v9.234c0 5.019.465 7.117 1.603 9.244a10.924 10.924 0 004.536 4.536C12.766 47.535 14.864 48 19.883 48h17.234c5.019 0 7.117-.465 9.244-1.603a10.924 10.924 0 004.536-4.536c1.138-2.127 1.603-4.225 1.603-9.244v-9.234c0-5.019-.465-7.117-1.603-9.244a10.924 10.924 0 00-4.536-4.536C44.234 8.465 42.136 8 37.117 8H19.883zm-7.83 4.248c1.486-.794 3-1.248 7.83-1.248h17.234c4.83 0 6.344.454 7.83 1.248a7.925 7.925 0 013.305 3.306c.794 1.485 1.248 3 1.248 7.83v9.233c0 4.83-.454 6.344-1.248 7.83a7.925 7.925 0 01-3.306 3.305c-1.485.794-3 1.248-7.83 1.248H19.884c-4.83 0-6.344-.454-7.83-1.248a7.925 7.925 0 01-3.305-3.306c-.794-1.485-1.248-3-1.248-7.83v-9.233c0-4.83.454-6.344 1.248-7.83a7.925 7.925 0 013.306-3.305z"}))}},156482:(e,t,a)=>{"use strict";a.d(t,{ShareScreenIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"24",height:"24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M20.465 4.4c-.489-.26-.974-.4-2.31-.4H5.844c-1.336 0-1.821.14-2.31.4A2.726 2.726 0 002.4 5.536C2.139 6.024 2 6.509 2 7.845v8.31c0 1.336.14 1.821.4 2.31.262.49.646.873 1.135 1.134.489.262.974.401 2.31.401h12.31c1.336 0 1.821-.14 2.31-.4a2.726 2.726 0 001.134-1.135c.262-.489.401-.974.401-2.31v-8.31c0-1.336-.14-1.821-.4-2.31A2.726 2.726 0 0020.464 4.4zm-11.81 5.728l2.97-2.978c.207-.2.543-.2.75 0l2.97 2.978c.33.318.077.872-.376.872H13v4.979c0 .564-.442 1.021-1 1.021s-1-.457-1-1.021V11H9.031c-.44 0-.715-.545-.375-.872z"}))}},254060:(e,t,a)=>{"use strict";a.d(t,{StarFilled:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"28",width:"28",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M14 21.5l-4.6 2.9A2.2 2.2 0 016 22l1.2-5.3L3.2 13a2.2 2.2 0 011.2-3.8l5.5-.5 2-5a2.2 2.2 0 014.1 0l2.1 5 5.5.5a2.2 2.2 0 011.2 3.8l-4.1 3.6 1.2 5.3a2.2 2.2 0 01-3.3 2.4L14 21.5z"}))}},995811:(e,t,a)=>{"use strict";a.d(t,{StarIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"10",height:"10",viewBox:"0 0 10 10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M6.80486 3.06621L9.19457 3.30079C10.0261 3.38241 10.2811 4.21346 9.63901 4.75944L7.76813 6.35033L8.46267 8.94201C8.69075 9.79313 7.98312 10.3084 7.27435 9.79614L5.0011 8.15325L2.72785 9.79614C2.02194 10.3063 1.31141 9.79324 1.53953 8.94201L2.23406 6.35033L0.363183 4.75944C-0.281598 4.21116 -0.0275869 3.38278 0.807493 3.30079L3.19677 3.06621L4.24943 0.583062C4.57908 -0.194562 5.42332 -0.194173 5.75269 0.583142L6.80486 3.06621Z"}))}},950890:(e,t,a)=>{"use strict";a.d(t,{StarOutline:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"28",width:"28",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M14 19.2l5.7 3.5a.2.2 0 00.3-.3L18.4 16l5.1-4.3a.2.2 0 00-.1-.4l-6.7-.5-2.5-6.1a.2.2 0 00-.4 0l-2.5 6.1-6.7.5a.2.2 0 00-.1.4l5 4.3L8 22.4a.2.2 0 00.3.3zm0 2.3l-4.6 2.9A2.2 2.2 0 016 22l1.2-5.3L3.2 13a2.2 2.2 0 011.2-3.8l5.5-.5 2-5a2.2 2.2 0 014.1 0l2.1 5 5.5.5a2.2 2.2 0 011.2 3.8l-4.1 3.6 1.2 5.3a2.2 2.2 0 01-3.3 2.4z"}))}},607910:(e,t,a)=>{"use strict";a.d(t,{TranslationStatusChevronIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"4",viewBox:"0 0 10 5",fill:"currentColor","aria-hidden":"true"},t),r.createElement("path",{d:"M5 4.8c-.2 0-.3 0-.4-.1l-4.3-3.2c-.3-.3-.4-.8-.2-1.1.2-.3.7-.4 1-.2l3.9 2.9 3.8-2.9c.3-.3.8-.2 1 .1.3.3.2.8-.1 1.1l-4.2 3.2c-.2.1-.3.2-.5.2z"}))}},826988:(e,t,a)=>{"use strict";a.d(t,{VideoIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({height:"14",width:"21",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M11.154 0c1.337 0 1.822.14 2.311.4.49.262.873.646 1.134 1.135.262.489.401.974.401 2.31v6.31c0 1.336-.14 1.821-.4 2.31a2.726 2.726 0 01-1.135 1.134c-.489.262-.974.401-2.31.401h-7.31c-1.336 0-1.821-.14-2.31-.4A2.726 2.726 0 01.4 12.464C.139 11.976 0 11.491 0 10.155v-6.31c0-1.336.14-1.821.4-2.31A2.726 2.726 0 011.536.4C2.024.139 2.509 0 3.845 0zM20.8 2.897a1 1 0 01.2.6v7.006a1 1 0 01-1.6.8L17.2 9.65a.5.5 0 01-.2-.4v-4.5a.5.5 0 01.2-.4l2.2-1.652a1 1 0 011.4.199z"}))}},168634:(e,t,a)=>{"use strict";a.d(t,{VideoIconS:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"16",height:"16",fill:"currentColor"},t,{xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M3.14 3C1.96 3 1 3.96 1 5.14v5.72C1 12.04 1.96 13 3.14 13h5.72c1.18 0 2.14-.96 2.14-2.14V5.14C11 3.96 10.04 3 8.86 3H3.14zM14.95 4.87c.23-.17.55 0 .55.28v5.7c0 .28-.32.45-.55.28L12 9.01V6.99l2.95-2.12z"}))}},30933:(e,t,a)=>{"use strict";a.d(t,{ViewersCountIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"16",height:"10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 0C4.546 0 1.596 2.073.4 5c1.196 2.927 4.146 5 7.6 5 3.455 0 6.405-2.073 7.6-5-1.195-2.927-4.145-5-7.6-5zm3.5 5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zM8 7a2 2 0 100-4 2 2 0 000 4z",fill:"#F5F5F5"}))}},294757:(e,t,a)=>{"use strict";a.d(t,{init:()=>I});var n=a(570655),r=a(667294),i=a(973935),o=a(659397),l=a(262891),s=a(656504),c=a(641196),u=a(89085),d=a(253312),p=a(464380),A=a(662208),_=a(498110),m=a(170794),g=a(614914),v=a(699637),f=a(14890),E=a(989189),C=a(815615),h=a(50533),S=a(121255),T=a(613335);a(329538);function I(e){var t=e.actionStatCollector,a=e.saveStatlogEvents,I=e.langUtils,y=e.navigateToConvo,P=e.navigateToProfile,b=e.apiWrapperWithAuth,L=e.apiWrapper,M=e.callSounds,w=e.config,O=void 0===w?{isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,incomingCall:!1,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:S.VIDEO_SLOTS_COUNT,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,sferum:!1}:w,k=e.eventHandlers,D=e.streamUrlExtractor;return(0,c.setApiWrappers)(b,L),{initialized:!1,initializing:!1,eventHandlers:null!=k?k:{},init:function(e){var s,c=this,b=e.callPreview,L=e.callsCredentials,w=e.imHash,R=e.participantLimit,B=e.callsOkStaging,G=e.tabIsMaster,H=e.onBeforeCallStart,x=e.onAfterCallFinish,U=e.onError,V=e.toggles,F=void 0===V?{}:V,W=e.friends,z=e.isFriend,Q=e.getFriends,j=e.pushToTalkEnabled;if(!(null==L?void 0:L.me))return console.log("Calls were not initialized as there are no callsCredentials.me"),!1;this.initialized=!0,this.isFriend=z,this.getFriends=Q;var Y=(0,n.__assign)((0,n.__assign)({},O),F);if(!p.browser.isBrowserSupported()){var K=function(){var e=I.getLang("calls_unsupported_browser_error");return U&&U({msg:e}),(null==k?void 0:k.onError)&&k.onError(new Error(e)),console.error(e),Promise.resolve()};return this.call=K,this.startGroupCall=K,this.startCall=K,this.acceptCall=K,this.joinCallByLink=K,this.showJoinPopup=K,void(this.showCallByNamePopup=K)}this.id=window.vk&&window.vk.id||L.me.peerId;var J=G||function(){return!0},q=null!==(s=o.localStorage.getItem(S.VIDEO_RESOLUTION_STORAGE_KEY))&&void 0!==s?s:S.VideoResolutionTypes.SD,Z=(0,f.createStore)(C.callsReducer,(0,E.getInitialState)(L.me,w,b,{participantLimit:R,isDev:!!L.is_dev,token:L.secret,config:Y,localVideoResolution:Y.fullHD?q:q===S.VideoResolutionTypes.HD?S.VideoResolutionTypes.HD:S.VideoResolutionTypes.SD,friends:W||[],friendsCache:(0,T.createFriendsCache)(W||[]),ipSettingEnabled:L.ip_setting_enabled,privacySettings:L.privacySettings,pushToTalkEnabled:j}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());return this.collapseCall=function(){Z.dispatch({type:S.MANAGEMENT,isOpen:!1}),Z.dispatch({type:S.CHANGE_UI_MODE,mode:S.UIMode.COLLAPSED})},this.restoreCall=function(){Z.dispatch({type:S.CHANGE_UI_MODE,mode:S.UIMode.DEFAULT})},this.showStartCallModal=function(e,t){Z.dispatch({type:S.CHANGE_MODE,mode:S.Mode.START,peerId:e,joinLink:t})},a&&(0,m.setStatlogEventsHandler)(a),t&&g.callStats.setActionStatCollector(t),i.render(r.createElement(h.Provider,{store:Z},r.createElement(A.LangContext.Provider,{value:I},r.createElement(_.ConfigContext.Provider,{value:Y},r.createElement(v.WaitingContainer,null)))),N("calls")),this.initializing=(0,d.sdkService)(this,p,L,Z,I.getLang,B).finally((function(){(0,u.longpollService)(c,p,I.getLang,Z);var e=N("calls");i.unmountComponentAtNode(e),i.render(r.createElement(h.Provider,{store:Z},r.createElement(A.LangContext.Provider,{value:I},r.createElement(_.ConfigContext.Provider,{value:Y},r.createElement(l.App,{bridge:c,SDK:p,tabIsMaster:J,onBeforeCallStart:H,onAfterCallFinish:x,callSounds:M,navigateToConvo:y,onHandCountChanged:null==k?void 0:k.onHandCountChanged,onSuccessFeedback:null==k?void 0:k.onSuccessFeedback,navigateToProfile:P,okPublicKey:L.key,config:Y,streamUrlExtractor:D})))),e)})),this.initializing.catch((function(e){if(null==k?void 0:k.onError){var t=e?e.message||e.msg:"sdk did not send the reasons for the error",a=e?e.error:"";[401].includes(a)||k.onError(new Error("Could not init calls. "+t+": "+a))}console.error("Could not init calls",e.error,e)}))},showJoinScreen:function(e,o,l,c,u){var d=function(e){c&&c({msg:e}),(null==k?void 0:k.onError)&&k.onError(new Error(e)),console.error(e)};if(!p.browser.isBrowserSupported())return d(I.getLang("calls_unsupported_browser_error"));(0,m.setStatlogEventsHandler)(a),g.callStats.setActionStatCollector(t);var v=e.callsAllowCallByName,f=e.callsAllowWaitingHall,E=document.querySelector(o),C=(0,n.__assign)((0,n.__assign)({},O),{allowCallByName:v,allowWaitingHall:f});i.render(r.createElement(A.LangContext.Provider,{value:I},r.createElement(_.ConfigContext.Provider,{value:C},r.createElement(s.JoinScreenContainer,(0,n.__assign)({},e,{withPopup:!1,bridge:this,entryPoint:l,onError:d,okPublicKey:u})))),E)},debug:!1,setDebug:function(e){this.debug=e,p.debug(e)}}}function N(e){var t=document.getElementById(e);if(t)return t;var a=document.createElement("section");return a.setAttribute("id",e),document.body.appendChild(a),a}},169610:(e,t,a)=>{"use strict";a.d(t,{checkPermissions:()=>r});var n=a(464380);function r(e,t){var a=e.browser.hasMicrophonePermission(),r=e.browser.hasCameraPermission(),i=t.includes(n.MediaOption.AUDIO)&&!a,o=t.includes(n.MediaOption.VIDEO)&&!r;return(i||o)&&function(e,t,a){e.browser.getUserMedia(t,a).then((function(e){e.getTracks().forEach((function(e){return e.stop()}))}))}(e,o,i),Promise.resolve()}},989189:(e,t,a)=>{"use strict";a.d(t,{getInitialState:()=>o});var n=a(570655),r=a(121255),i=a(464380),o=function(e,t,a,o){var l,s=o.participantLimit,c=void 0===s?128:s,u=o.isDev,d=void 0!==u&&u,p=o.token,A=o.config,_=void 0===A?{isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,incomingCall:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:r.VIDEO_SLOTS_COUNT,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,sferum:!1}:A,m=o.localVideoResolution,g=void 0===m?r.VideoResolutionTypes.SD:m,v=o.friends,f=void 0===v?[]:v,E=o.friendsCache,C=o.privacySettings,h=o.ipSettingEnabled,S=o.pushToTalkEnabled,T=void 0!==S&&S,I=window.vk&&window.vk.id||e.peerId;return{anonymSecret:p,me:I,groupId:0,mode:r.Mode.READY,peer:0,participants:(l={},l[I]=(0,n.__assign)((0,n.__assign)({},e),{mediaSettings:{isAudioEnabled:!0,isVideoEnabled:!1,isScreenSharingEnabled:!1},statusData:{hand:!1},roles:[],permissions:{audio:r.MediaPermissionType.ALLOW,video:r.MediaPermissionType.ALLOW,screenSharing:r.MediaPermissionType.ALLOW}}),l),callData:{type:null,ts:null,localTimeStamp:null,conversation:a},imHash:t,participantLimit:c,isDev:d,popup:null,uiMode:r.UIMode.DEFAULT,orator:null,adminPinnedParticipant:null,screenSharingPinnedParticipant:null,screenSharingNeedDisableOratorModeAfterStop:!0,screenSharingOldPinnedParticipant:null,pinnedParticipant:null,screenSharers:{},isShownParticipantsAside:!0,isOratorMode:!0,chatMembers:[],groupMembers:[],groupMembersCount:0,preselectedIds:null,friends:f,speakers:{},speakersInHeader:[],chatUnreadCount:0,chatUpToMsgId:null,tooltips:{chat:!1,hand:!1,screenShare:!1,layout:!1,collapse:!1,fullscreen:!1},participantsAddedByMe:new Set,groupCallSetup:!1,isManagementOpen:!1,notification:null,errorShown:!1,cautionShown:!1,isLoaderVisible:!1,translation:{deferredId:null,isOn:!1},participantsManagement:null,adminAssignment:null,participantKick:null,membersUnban:null,noiseCancellation:r.NoiseCancellationTypes.NEURAL,config:_,localVideoResolution:g,conversationOptions:[],privacySettings:{callsIp:(null==C?void 0:C.callsIp)||"friends"},friendsCache:E||{},groupMembersCache:{},unableToCallGroupMembersIds:[],ipSettingEnabled:h||!1,localStatus:i.ParticipantStatus.WAITING,isIncoming:!1,pushToTalkEnabled:T,gridScrollPosition:0,oratorScrollPosition:0}}},815615:(e,t,a)=>{"use strict";a.d(t,{callsReducer:()=>s});var n=a(570655),r=a(121255),i=a(989189),o=a(768606),l=a(613335);function s(e,t){var a,s,u,d;switch(t.type){case r.LOAD_PEERS:var p=t.conversation||e.callData.conversation,A=t.members;return(0,n.__assign)((0,n.__assign)({},e),{participants:(0,n.__assign)((0,n.__assign)({},e.participants),A.reduce((function(t,a){return a&&a.peerId&&(t[a.peerId]=(0,n.__assign)((0,n.__assign)({mediaSettings:{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1}},e.participants[a.peerId]||{}),a)),t}),{})),callData:(0,n.__assign)((0,n.__assign)({},e.callData),{conversation:p}),peer:"peerId"in t?t.peerId:e.peer,caller:"caller"in t?t.caller:e.caller});case r.CHANGE_MODE:var _=t.mode!==r.Mode.READY&&t.data&&t.data.type?t.data.type:null;if(t.mode===r.Mode.READY||t.mode===r.Mode.FEEDBACK){p=e.callData&&e.callData.conversation;var m=(0,i.getInitialState)(e.participants[e.me],e.imHash,p,{participantLimit:e.participantLimit,token:e.anonymSecret,config:e.config,localVideoResolution:e.localVideoResolution,friends:e.friends,privacySettings:e.privacySettings,friendsCache:e.friendsCache,ipSettingEnabled:e.ipSettingEnabled,isDev:e.isDev});return t.mode===r.Mode.FEEDBACK&&(m.mode=r.Mode.FEEDBACK,m.lastCallData={callId:null!==(u=null===(s=e.callData)||void 0===s?void 0:s.callId)&&void 0!==u?u:"",peerId:null!==(d=e.peer)&&void 0!==d?d:0}),m}return(0,n.__assign)((0,n.__assign)({},e),{mode:t.mode,peer:"peerId"in t?t.peerId:e.peer,callData:(0,n.__assign)((0,n.__assign)({},e.callData),{type:_,ts:t.ts||e.callData.ts||null}),hangupType:e.hangupType,join:t.joinLink?{joinLink:t.joinLink}:e.join});case r.HANGUP:return(0,n.__assign)((0,n.__assign)({},e),{hangupType:t.data});case r.TIME_START:return(0,n.__assign)((0,n.__assign)({},e),{callData:(0,n.__assign)((0,n.__assign)({},e.callData),{ts:t.data})});case r.LOCAL_TIME_START:return(0,n.__assign)((0,n.__assign)({},e),{callData:(0,n.__assign)((0,n.__assign)({},e.callData),{localTimeStamp:t.data})});case r.REMOVE_USER:var g=c(e,t.participantId,{status:void 0,statusData:void 0,wasConnected:void 0});if(e.screenSharers[t.participantId]&&delete g.screenSharers[t.participantId],e.orator===t.participantId&&(g.orator=null),e.pinnedParticipant===t.participantId&&(g.pinnedParticipant=null),e.adminPinnedParticipant===t.participantId&&(g.adminPinnedParticipant=null),e.screenSharingPinnedParticipant===t.participantId&&(g.screenSharingPinnedParticipant=null),e.participantsAddedByMe.has(t.participantId)){var v=new Set(e.participantsAddedByMe);v.delete(t.participantId),g.participantsAddedByMe=v}return g;case r.SET_CHAT_INFO:return(0,n.__assign)((0,n.__assign)({},e),{chatMembers:t.data,chatData:t.conversation});case r.GROUP_CALL_SETUP:return(0,n.__assign)((0,n.__assign)({},e),{groupCallSetup:t.open,peer:t.peerId||e.peer||0,preselectedIds:t.preselectedIds});case r.TOGGLE_POPUP:return(0,n.__assign)((0,n.__assign)({},e),{popup:t.data||null});case r.UPDATE_HASH:return(0,n.__assign)((0,n.__assign)({},e),{imHash:t.hash});case r.CHANGE_UI_MODE:return(0,n.__assign)((0,n.__assign)({},e),{uiMode:t.mode||r.UIMode.DEFAULT});case r.TOGGLE_ORATOR_MODE:return(0,n.__assign)((0,n.__assign)({},e),{isOratorMode:t.isOratorMode});case r.TOGGLE_PARTICIPANTS_ASIDE:return(0,n.__assign)((0,n.__assign)({},e),{isShownParticipantsAside:t.isShownParticipantsAside});case r.SET_ORATOR:return(0,n.__assign)((0,n.__assign)({},e),{orator:t.orator||null});case r.SET_PINNED_PARTICIPANT:return(0,n.__assign)((0,n.__assign)({},e),{pinnedParticipant:t.pinnedParticipant});case r.SET_ADMIN_PINNED_PARTICIPANT:return(0,n.__assign)((0,n.__assign)({},e),{adminPinnedParticipant:t.data});case r.SET_SCREEN_SHARING_PINNED_PARTICIPANT:return(0,n.__assign)((0,n.__assign)({},e),{screenSharingPinnedParticipant:t.screenSharingPinnedParticipant,screenSharingNeedDisableOratorModeAfterStop:t.screenSharingNeedDisableOratorModeAfterStop,screenSharingOldPinnedParticipant:t.screenSharingOldPinnedParticipant});case r.MANAGEMENT:return(0,n.__assign)((0,n.__assign)({},e),{isManagementOpen:t.isOpen,managementView:t.managementView});case r.CALL_STATE:return(0,n.__assign)((0,n.__assign)({},e),{callData:(0,n.__assign)((0,n.__assign)({},e.callData),t.callData)});case r.CALL_NOTIFICATION:return(0,n.__assign)((0,n.__assign)({},e),{notification:t.notification});case r.JOIN:return(0,n.__assign)((0,n.__assign)({},e),{mode:r.Mode.JOIN,join:t.data});case r.CALL_BY_NAME:return(0,n.__assign)((0,n.__assign)({},e),{mode:r.Mode.CALL_BY,callByName:t.data});case r.ERROR:return(0,n.__assign)((0,n.__assign)({},e),{mode:t.handleType===r.ErrorHandleType.FATAL?r.Mode.ERROR:e.mode,errorShown:!t.isClosed,error:{title:t.title,text:t.text,handleType:t.handleType,callId:t.callId}});case r.CHANGE_PARTICIPANT_STATE:var f=e.participants[t.participantId].statusData;return c(e,t.participantId,{statusData:(0,n.__assign)((0,n.__assign)({},f),t.data)});case r.CHANGE_PARTICIPANT_ROLES:return c(e,t.participantId,{roles:t.data});case r.CHANGE_PARTICIPANT_PERMISSIONS:var E=e.participants[t.participantId];return c(e,t.participantId,{permissions:(0,n.__assign)((0,n.__assign)({},E.permissions),t.data)});case r.SET_SCREEN_SHARER:return(0,n.__assign)((0,n.__assign)({},e),{screenSharers:(0,n.__assign)((0,n.__assign)({},e.screenSharers),(a={},a[t.participantId]=t.isScreenSharingEnabled,a))});case r.SET_FRIENDS:return(0,n.__assign)((0,n.__assign)({},e),{friends:t.data,friendsCache:(0,l.createFriendsCache)(t.data)});case r.SET_GROUP_MEMBERS:return(0,n.__assign)((0,n.__assign)({},e),{groupMembersCount:t.groupMembersCount,groupMembers:t.groupMembers,unableToCallGroupMembersIds:t.unableToCallGroupMembersIds,groupMembersCache:(0,l.createFriendsCache)(t.groupMembers)});case r.SET_SPEAKERS:var C=t.data,h=C.speakers,S=C.speakersInHeader;return(0,n.__assign)((0,n.__assign)({},e),{speakers:h||e.speakers,speakersInHeader:S||e.speakersInHeader});case r.UPDATE_PARTICIPANTS_BATCH:return(0,o.applyParticipantsBatch)(e,t.data);case r.SET_UNREAD_COUNT:return(0,n.__assign)((0,n.__assign)({},e),{chatUnreadCount:t.chatUnreadCount,chatUpToMsgId:"chatUpToMsgId"in t?t.chatUpToMsgId:e.chatUpToMsgId});case r.SHOW_CAUTION_BOX:return(0,n.__assign)((0,n.__assign)({},e),{cautionShown:t.isOpen,isIncoming:t.isIncoming});case r.SHOW_LOADER:return(0,n.__assign)((0,n.__assign)({},e),{isLoaderVisible:t.isLoaderVisible});case r.SET_TOOLTIP:var T=t.tooltips?t.tooltips:Object.keys(e.tooltips).reduce((function(e,t){return e[t]=!1,e}),{});return(0,n.__assign)((0,n.__assign)({},e),{tooltips:(0,n.__assign)((0,n.__assign)({},e.tooltips),T)});case r.MANUAL_ADD_PARTICIPANTS:return(0,n.__assign)((0,n.__assign)({},e),{participantsAddedByMe:(t.participants||[]).reduce((function(e,t){return e.add(t)}),new Set(e.participantsAddedByMe))});case r.SET_TRANSLATION:return(0,n.__assign)((0,n.__assign)({},e),{translation:(0,n.__assign)((0,n.__assign)({},e.translation),t.data)});case r.UPDATE_ANON_SECRET:return(0,n.__assign)((0,n.__assign)({},e),{anonymSecret:t.secret});case r.TOGGLE_PARTICIPANTS_KICK:return(0,n.__assign)((0,n.__assign)({},e),{participantKick:t.data?{participant:t.data.participant,type:t.data.type}:null});case r.UNBAN_PARTICIPANTS:return(0,n.__assign)((0,n.__assign)({},e),{membersUnban:t.data?{members:t.data.members}:null});case r.TOGGLE_PARTICIPANTS_MANAGEMENT:return(0,n.__assign)((0,n.__assign)({},e),{participantsManagement:t.data?{mode:t.data.mode,participant:t.data.participant}:null});case r.TOGGLE_ADMIN_ASSIGNMENT:return(0,n.__assign)((0,n.__assign)({},e),{adminAssignment:t.data?{participant:t.data.participant}:null});case r.SET_NOISE_CANCELLATION:return(0,n.__assign)((0,n.__assign)({},e),{noiseCancellation:t.data});case r.CHANGE_LOCAL_VIDEO_RESOLUTION:return(0,n.__assign)((0,n.__assign)({},e),{localVideoResolution:t.data});case r.SET_CONVERSATION_OPTIONS:return(0,n.__assign)((0,n.__assign)({},e),{conversationOptions:t.data});case r.SET_PRIVACY_SETTINGS:return(0,n.__assign)((0,n.__assign)({},e),{privacySettings:t.data});case r.SET_GROUP:return(0,n.__assign)((0,n.__assign)({},e),{groupId:t.groupId,meGroup:t.meGroup});case r.SET_WAITING_HALL:return(0,n.__assign)((0,n.__assign)({},e),{waitingHall:t.data});case r.SET_LOCAL_STATUS:return(0,n.__assign)((0,n.__assign)({},e),{localStatus:t.data});case r.SET_PUSH_TO_TALK_ENABLE:return(0,n.__assign)((0,n.__assign)({},e),{pushToTalkEnabled:t.data});case r.SET_GRID_SCROLL_POSITION:return(0,n.__assign)((0,n.__assign)({},e),{gridScrollPosition:t.data});case r.SET_ORATOR_SCROLL_POSITION:return(0,n.__assign)((0,n.__assign)({},e),{oratorScrollPosition:t.data})}return e}function c(e,t,a){var r;return(0,n.__assign)((0,n.__assign)({},e),{participants:(0,n.__assign)((0,n.__assign)({},e.participants),(r={},r[t]=(0,n.__assign)((0,n.__assign)({},e.participants[t]),a),r))})}},329538:(e,t,a)=>{"use strict";a.d(t,{loadCallPeers:()=>u,retryLoadCallPeers:()=>_,loadChatMembers:()=>m,getCallAuthToken:()=>g,getCallUrlLink:()=>v,getJoinLinkDetails:()=>f,loadFriends:()=>E,forceCallFinish:()=>C,getConversationsByCall:()=>h,getAnonymCallToken:()=>S,getCallParticipants:()=>T,videoStartStreaming:()=>I,loadUserAdminedGroupsAction:()=>N,getGroupById:()=>y,getUpcomingLives:()=>P,getVideos:()=>b,sendVideoEdit:()=>L,loadUsers:()=>M,logCallReceived:()=>w,videoLiveGetSpectators:()=>O,stopVideoStream:()=>k,loadPrivacySettings:()=>D,getGroupsForCall:()=>R,getGroupMembers:()=>B,searchGroupMembers:()=>G,getCallParticipantsApiCall:()=>H});var n=a(570655),r=a(298811),i=a(641196),o=a(464380),l=["photo_400","photo_400_orig","sex","screen_name","first_name_gen"].join(","),s=["photo_400","photo_400_orig","sex","screen_name","first_name_gen"].join(","),c=["name","photo_100","photo_400_orig","can_upload_video"].join(","),u=function(e){return(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:[e],extended:1,fields:s})},d=0,p=[],A=[],_=(0,r.exponentialRetry)((function(e,t){return void 0===t&&(t=50),p.push(e),new Promise((function(e){A.push(e),d||(d=window.setTimeout((function(){(function(e){return(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:e,extended:1,fields:s})})(p).then((function(e){A.forEach((function(t){t(e)})),A=[]})),p=[],d=0}),t))}))})),m=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationMembers",data:{peerId:e}}),(0,i.getApiWrapper)()()("messages.getConversationMembers",{peer_id:e,fields:l.concat(",can_call")}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationMembers",data:e}),e}))},g=function(e,t){return void 0===t&&(t=0),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:{isDev:e,groupId:t}}),(0,i.getApiWrapper)()()("messages.getCallToken",{env:e?"development":"production",group_id:t},{version:"5.149"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallToken",data:e}),e}))},v=((0,r.exponentialRetry)(g),function(e,t,a){void 0===a&&(a=0);var n={call_id:e,invalidate:t?1:0,group_id:a};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:n}),(0,i.getApiWrapper)()()("messages.getJoinLink",n).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getJoinLink",data:e}),e}))}),f=function(e,t){return void 0===t&&(t=!1),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallPreview",data:{link:e,fields:s,device_id:"anyId"}}),(0,i.getApiWrapper)(!t)()("messages.getCallPreview",{link:e,fields:s,device_id:"anyId"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallPreview",data:e}),e}))},E=function(){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"friends.get",data:{fields:l,order:"hints"}}),(0,i.getApiWrapper)()()("friends.get",{fields:l.concat(",can_call"),order:"hints"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"friends.get",data:e}),e}))},C=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.forceCallFinish",data:{call_id:e}}),(0,i.getApiWrapper)()()("messages.forceCallFinish",{call_id:e}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.forceCallFinish",data:e}),e}))},h=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationsByCall",data:{call_ids:e,fields:s}}),(0,i.getApiWrapper)()()("messages.getConversationsByCall",{call_ids:e,fields:s}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationsByCall",data:e}),e}))},S=function(e,t,a,n){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getAnonymCallToken",data:{link:e,user_id:t,name:a,secret:n,device_id:"anyId"}}),(0,i.getApiWrapper)(!1)()("messages.getAnonymCallToken",{link:e,user_id:t,name:a,secret:n,device_id:"anyId"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getAnonymCallToken",data:e}),e}))},T=function(e,t,a,n,o){void 0===n&&(n=!1);for(var l=[],c=Array.from(new Set(t));c.length;)c.length>100?(l.push(c.slice(0,100)),c=c.slice(100)):(l.push(c),c=[]);var u=(0,r.exponentialRetry)((function(t,r){var o=n?{call_id:e,peer_ids:r.join(","),fields:s,device_id:"anyId",secret:t.secret,user_id:a}:{call_id:e,peer_ids:r.join(","),fields:s};return(0,i.getApiWrapper)(!n)()("messages.getCallParticipants",o,{version:"5.149"}).then((function(e){return{count:e.count+t.count,secret:e.secret,profiles:(t.profiles||[]).concat(e.profiles||[]),anonyms:(t.anonyms||[]).concat(e.anonyms||[]),groups:(t.groups||[]).concat(e.groups||[])}}))})),d=Promise.resolve({secret:o,count:0});return l.reduce((function(e,t){return e.then((function(e){return u(e,t)}))}),d)},I=function(e){return(0,i.getApiWrapper)()()("video.startStreaming",e)},N=function(e){return(0,i.getApiWrapper)()()("groups.get",{fields:c,filter:e?void 0:"admin",extended:!0})},y=function(e){return(0,i.getApiWrapper)()()("groups.getById",{group_id:e,fields:c},{version:"5.149"})},P=function(e){return(0,i.getApiWrapper)()()("video.getUpcomingLives",{owner_ids:e})},b=function(e,t,a){return(0,i.getApiWrapper)()()("video.get",{owner_id:e,videos:t,need_privacy:a})},L=function(e,t,a,n,r){return(0,i.getApiWrapper)()()("video.edit",{owner_id:e,video_id:t,name:a,desc:n,privacy_view:r})},M=function(e){return(0,i.getApiWrapper)()()("users.get",e)},w=function(e){return(0,i.getApiWrapper)()()("messages.callReceived",{call_id:e})},O=function(e){return(0,i.getApiWrapper)()()("video.liveGetSpectators",{owner_id:e.owner_id,video_id:e.video_id})},k=function(){return(0,o.stopStream)()},D=function(e){return(0,i.getApiWrapper)()()("account.getPrivacySettings",e)},R=function(){return(0,i.getApiWrapper)()()("messages.getGroupsForCall",{count:200})},B=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=10);var n={fields:l.concat(",can_call_from_group"),group_id:e,offset:t,count:a,sort:"time_asc"};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"groups.getMembers",params:n}),(0,i.getApiWrapper)()()("groups.getMembers",n).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"groups.getMembers",data:e}),e}))},G=function(e,t){return void 0===t&&(t=""),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"users.search",data:{groupId:e,q:t}}),(0,i.getApiWrapper)()()("users.search",{fields:l.concat(",can_call_from_group"),group_id:e,q:t}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"users.search",data:e}),e}))};function H(e,t,a,r,l){void 0===a&&(a=!1),void 0===r&&(r=""),void 0===l&&(l=0);var c={call_id:e,peer_ids:t.join(","),fields:s};return a&&(c=(0,n.__assign)((0,n.__assign)({},c),{device_id:"anyId",secret:r,user_id:l})),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallParticipants",data:c}),(0,i.getApiWrapper)(!a)()("messages.getCallParticipants",c,{version:"5.149"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallParticipant",response:e}),e}))}},394886:(e,t,a)=>{"use strict";a.d(t,{openDesktopDeepLink:()=>r});var n=a(233194);function r(e){return new Promise((function(t,a){if(n.Platform.isMobile)a("is_mobile");else if(document.body.focus(),"hidden"===document.visibilityState||document.hidden)a("hidden_page");else{var r,i=function(){r&&clearTimeout(r),window.removeEventListener("blur",i),t(!0)};if(window.addEventListener("blur",i),r=setTimeout((function(){window.removeEventListener("blur",i),a("timed_out")}),3e3),n.Platform.BROWSER===n.BROWSER.SAFARI||n.Platform.BROWSER===n.BROWSER.FIREFOX){var o=document.createElement("iframe");o.style.display="none",document.body.appendChild(o);var l=o.contentWindow;l?(l.location.href=e,setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o)}),100)):window.location.href=e}else window.location.href=e}}))}},834735:(e,t,a)=>{"use strict";a.d(t,{preloadImage:()=>r,preloadImagesFromResponse:()=>i});var n=a(570655);function r(e){return new Promise((function(t,a){var n=new Image;n.src=e,n.onload=t,n.onerror=a}))}function i(e){var t=[].concat.apply([],(0,n.__spreadArray)([],(0,n.__read)(e))).map((function(e){var t=e.photo;return t?r(t):Promise.resolve()}));return Promise.all(t).then((function(){return e})).catch((function(){return e}))}},431469:(e,t,a)=>{"use strict";a.d(t,{useIndexer:()=>o,usePseudoLayer:()=>l,useFullScreen:()=>s});var n=a(570655),r=a(667294),i=a(337057),o=function(e,t,a){var o=(0,r.useRef)(null);o.current=o.current?o.current:new i.VkIndexer(e,t);var l=o.current,s=(0,r.useCallback)((function(e){return e.reduce((function(e,t){return e[a(t)]=!0,e}),{})}),[]),c=(0,n.__read)((0,r.useState)(e),2),u=c[0],d=c[1],p=(0,n.__read)((0,r.useState)(s(e)),2),A=p[0],_=p[1];return(0,r.useEffect)((function(){var t=s(e),n=e.filter((function(e){return!A[a(e)]})),r=u.filter((function(e){return!t[a(e)]}));(n.length||r.length)&&(n.forEach((function(e){l.add(e)})),r.forEach((function(e){l.remove(e)})),d(e),_(t))}),[e]),l};function l(){(0,r.useEffect)((function(){return document.body.classList.add("layers_shown"),function(){document.body.classList.remove("layers_shown")}}),[])}var s=function(e,t,a,n){void 0===n&&(n=[]);var i=window.document,o=i.documentElement,l=o.requestFullscreen||o.webkitRequestFullscreen;if(l){var s=!o.requestFullscreen,c=s?i.webkitExitFullscreen:i.exitFullscreen,u=s?"webkitfullscreenchange":"fullscreenchange",d=s?"webkitFullscreenElement":"fullscreenElement";(0,r.useEffect)((function(){var e=function(){i.fullscreenElement?t&&t():a&&a()};return i.addEventListener(u,e),function(){return i.removeEventListener(u,e)}}),[]),(0,r.useEffect)((function(){e&&!i[d]?l.call(i.documentElement):!e&&i[d]&&c.call(i)}),n)}}},259684:(e,t,a)=>{"use strict";a.d(t,{isCollapsedLayout:()=>r});var n=a(121255);function r(e){return e.uiMode===n.UIMode.COLLAPSED}},89085:(e,t,a)=>{"use strict";a.d(t,{longpollService:()=>_});var n=a(570655),r=a(121255),i=a(298811),o=a(788822),l=a(834735),s=a(862191),c=a(614914),u=a(389953),d=a(745284),p=a(820717),A=a(329538);function _(e,t,a,l){var _=l.dispatch,v=function(){for(var v=[],f=0;f<arguments.length;f++)v[f]=arguments[f];v.forEach((function(e){e.type===r.INCOMING_CALL&&(0,A.logCallReceived)(e.payload.call_id)}));var E=l.getState();m(E,_,e,v,a).then((function(){v.forEach((function(a){switch(a.type){case r.INCOMING_CALL:if(g(E,a))l.getState().ipSettingEnabled&&t.forceRelayPolicy(!a.payload.p2p_allowed),t.processPush(a.payload.call_id).then((function(){var e=JSON.parse((0,o.decodeHTMLEntities)(a.payload.payload)),t=e.is_video?r.CallType.VIDEO:r.CallType.AUDIO,l=(0,i.getPeerIdFromLongpoll)(a.payload),u=(0,i.isGroupCallEvent)(a);l<0&&(u=e.with_join_link),_({type:r.CHANGE_MODE,mode:r.Mode.INCOMING,peerId:l<0&&u?0:l,data:(0,n.__assign)((0,n.__assign)({},a.payload),{type:t,payload:e})}),s.callStatDataStorage.set({timeStart:Date.now(),startType:t}),c.callStats.logEvent({call_event_type:r.CallActionEventType.INCOMING_CALL_RECEIVED,session_id:a.payload.call_id,peer_id:l,is_group_call:u,reason:e.is_video?r.CallType.VIDEO:r.CallType.AUDIO})})).catch((function(t){if(e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug)if("object"==typeof t){var a=t.hangup,n=t.message;console.error("Push process error",a,n)}else console.error("Push process error",t)}));else if(a.type===r.INCOMING_CALL){var A=function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(new Error(t)),e.debug&&console.warn("Incoming push skipped:",t,a)};switch(!0){case!a.payload.call_id:A("old lib call");break;case E.mode===r.Mode.CALL||E.mode===r.Mode.INCOMING:A("already in a call"),t.processPush(a.payload.call_id).then((function(){e.eventHandlers.onError&&e.eventHandlers.onError(new Error("processPush was incorrect accepted with call_id: "+a.payload.call_id)),e.debug&&console.warn("processPush was incorrect accepted",a.payload.call_id)})).catch((function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug&&console.warn("processPush rejected:",t,a.payload.call_id)}));break;default:A("reason of decline is unknown")}}break;case r.ADD_MESSAGE:var m=l.getState(),v=(0,u.isChatPeer)(m.peer),f=m.callData.callId;if(m.peer!==a.peerId||a.flags&r.FLAG_OUTBOUND||m.me===a.userId||_({type:r.SET_UNREAD_COUNT,chatUnreadCount:m.chatUnreadCount?m.chatUnreadCount+1:1}),v||!(0,d.isActiveGroupCallMessage)(a))return;var C=a.peerId;if(f===a.kludges.attach1_call_id)return(0,p.loadCallPeersWithWaitingImagesAction)(l.getState(),_,C);break;case r.READ_INBOUND:null!==a.chatUnreadCount&&l.getState().peer===a.peerId&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:a.unread,chatUpToMsgId:a.upToId});break;case r.SET_FLAGS:(m=l.getState()).peer===a.peerId&&null!==m.chatUpToMsgId&&a.messageId>m.chatUpToMsgId&&!(a.flags&r.FLAG_OUTBOUND)&&(a.flags&r.FLAG_DELETED||a.flags&r.FLAG_SPAM)&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:m.chatUnreadCount?m.chatUnreadCount-1:0});break;case r.DELETE_DIALOG:l.getState().peer===a.peerId&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:0,chatUpToMsgId:null});break;case r.EDIT_MESSAGE:case r.REPLACE_MESSAGE:(m=l.getState()).peer===a.peerId&&null!==m.chatUpToMsgId&&a.messageId>m.chatUpToMsgId&&a.kludges.is_expired&&_({type:r.SET_UNREAD_COUNT,chatUnreadCount:m.chatUnreadCount?m.chatUnreadCount-1:0});break;case r.CONVERSATION_UPDATED:C=a.peerId;var h=a.updateType;if(l.getState().peer!==C)return;if(h!==r.MAIL_CHAT_UPDATE_TYPE_CALL_IN_PROGRESS_CHANGED)return;void 0!==l.getState().callData.canFinishCall&&l.getState().callData.hasUrlLink||(0,p.loadActiveCallDataAction)(l.getState(),_,C)}}))})).catch((function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug&&console.error("Resource loading error",t),v.forEach((function(e){switch(e.type){case r.INCOMING_CALL:if(!g(E,e))return;_({type:r.ERROR,text:a("calls_incoming_process_error"),handleType:r.ErrorHandleType.PROCESS,callId:e.payload.call_id})}}))}))};if(e.handleEvent=v,void 0!==window.Notifier){var f=window.Notifier.getLpInstance();f&&f.onData(v)}}function m(e,t,a,n,s){var c=n.reduce((function(n,c){switch(c.type){case r.INCOMING_CALL:if(!g(e,c)){n.push(Promise.resolve());break}var u=(0,i.isGroupCallEvent)(c),A=u,_=(0,i.convertCallerFromLongpoll)(c.payload);if(!u&&_.peerId<0)JSON.parse((0,o.decodeHTMLEntities)(c.payload.payload)).with_join_link&&(A=!0);if(A){var m=u?(0,i.convertChatFromLongpoll)(c.payload):(0,d.getDefaultConversation)(s);if(t({type:r.LOAD_PEERS,conversation:m,members:[_],peerId:m.peerId,caller:u?m:_}),m.photo&&n.push((0,l.preloadImage)(m.photo)),u){var v=(0,p.loadCallPeersWithoutWaitingImagesAction)(e,t,a,m.peerId);n.push(v)}}else t({type:r.LOAD_PEERS,conversation:_,members:[_],peerId:_.peerId});_.photo&&n.push((0,l.preloadImage)(_.photo))}return n}),[]);return Promise.all(c)}function g(e,t){return function(e){return!!e.payload.call_id}(t)&&e.mode!==r.Mode.INCOMING&&e.mode!==r.Mode.CALL}},147853:(e,t,a)=>{"use strict";a.d(t,{pushToTalkToggleAudio:()=>l,pushToTalkActivate:()=>s,pushToTalkDeactivate:()=>c,onPushToTalkHandler:()=>p});var n=a(745284),r=a(121255),i=a(464380),o=!1;function l(e,t,a){if(void 0===a&&(a=!0),e){var n=!(!t||!t.isAudioEnabled);a&&(o=n),n&&(0,i.toggleLocalAudio)(!1)}else o&&(0,i.toggleLocalAudio)(!0)}function s(e){window.addEventListener("keydown",e),window.addEventListener("keyup",e)}function c(e){window.removeEventListener("keydown",e),window.removeEventListener("keyup",e)}var u,d=!1;function p(e,t,a,o){var l=e.keyCode,s=e.type,c=e.repeat,p="keydown"===s;if(32===l){if(e&&e.target){if(["FCComposer__input","FCSearch__input","fc_editable","fc_clist_filter_text"].some((function(t){return e.target.classList.contains(t)})))return}if(e.preventDefault(),c)return;if(d)return clearTimeout(u),void(d=!1);d=!0,u=setTimeout((function(){(function(e,t,a,o){var l=function(){var t,i,l=(null===(t=o.notification)||void 0===t?void 0:t.type)===r.NotificationType.PUSH_TO_TALK,s=!1;if(e&&!l?s=!0:e&&l?s=(null===(i=o.notification)||void 0===i?void 0:i.data)!==(0,n.isIAmSpeaking)(o):!e&&l&&(s=!0),s){var c=null;e&&(c={type:r.NotificationType.PUSH_TO_TALK,timer:0,data:(0,n.isIAmSpeaking)(o)}),a({type:r.CALL_NOTIFICATION,notification:c})}};return e&&t||!e&&!t?Promise.resolve().then(l):(0,i.toggleLocalAudio)(e).then(l)})(p,t,a,o).then((function(){d=!1}))}),p?200:100)}}},253312:(e,t,a)=>{"use strict";a.d(t,{sdkService:()=>y,getCallStartErrorText:()=>D});var n=a(570655),r=a(121255),i=a(329538),o=a(298811),l=a(834735),s=a(387691),c=a(169610),u=a(525046),d=a(774351),p=a(389953),A=a(745284),_=a(170794),m=a(862191),g=a(614914),v=a(820717),f=a(307915),E=a(697483),C=a(768606),h=a(464380),S=a(604233),T=a(613335),I=a(719481),N=a(233194);function y(e,t,a,T,y,D){var G=T.dispatch,H=T.getState(),x=H.me,U=(0,o.compose)(w,o.startCallRetryWrapper.bind(null,b.bind(null,t,e,T))),V=(0,o.compose)(t.joinCallByLink,o.startCallRetryWrapper.bind(null,b.bind(null,t,e,T))),F={apiKey:a.key,apiEnv:a.is_dev?"VIDEOTEST":"PROD",anonymToken:a.is_anonym?a.token:"",filteredMessages:!0,batchParticipantsOnStart:!1,participantStateMapped:!1,voiceParams:{speakerLevelMultiplier:1.3,smoothing:.5},domain:D?"vk_corp":void 0,videoTracksCount:H.config.enableVideoSlots?H.config.videoSlotsCount:void 0,videoMaxHeight:H.localVideoResolution===r.VideoResolutionTypes.SD?r.VideoHeight.SD:r.VideoHeight.HD,videoMaxWidth:H.localVideoResolution===r.VideoResolutionTypes.SD?r.VideoWidth.SD:r.VideoWidth.HD,debugLog:H.config.debugLog,consumerScreenTrack:H.config.enableScreenTrack,producerScreenTrack:H.config.enableProducerScreenTrack,onLocalStream:function(t,a){e.debug&&console.warn("onLocalStream",t,a),(0,C.throttleAccumulateDispatchParticipant)(G,x,{stream:t,mediaSettings:a}),m.callStatDataStorage.set({hadVideoEnabled:a.isVideoEnabled})},onLocalStreamUpdate:function(t,a){e.debug&&console.warn("onLocalStreamUpdate",t,a);var n=T.getState(),i=n.participants[x],o=i.mediaSettings,l=i.permissions,s={mediaSettings:t};l.audio!==r.MediaPermissionType.ONCE&&l.video!==r.MediaPermissionType.ONCE&&l.screenSharing!==r.MediaPermissionType.ONCE||(s.permissions={},l.audio===r.MediaPermissionType.ONCE&&(null==o?void 0:o.isAudioEnabled)&&!t.isAudioEnabled&&(s.permissions.audio=r.MediaPermissionType.DENY),l.video===r.MediaPermissionType.ONCE&&(null==o?void 0:o.isVideoEnabled)&&!t.isVideoEnabled&&(s.permissions.video=r.MediaPermissionType.DENY),l.screenSharing===r.MediaPermissionType.ONCE&&(null==o?void 0:o.isScreenSharingEnabled)&&!t.isScreenSharingEnabled&&(s.permissions.screenSharing=r.MediaPermissionType.DENY)),(0,C.throttleAccumulateDispatchParticipant)(G,x,s),t.isScreenSharingEnabled!==(null==o?void 0:o.isScreenSharingEnabled)&&(B(n,G,t.isScreenSharingEnabled,x),t.isScreenSharingEnabled?e.eventHandlers.onScreenSharingEnabled&&e.eventHandlers.onScreenSharingEnabled():e.eventHandlers.onScreenSharingDisabled&&e.eventHandlers.onScreenSharingDisabled()),m.callStatDataStorage.set({hadVideoEnabled:t.isVideoEnabled})},onRemoteStream:function(t,a){e.debug&&console.warn("onRemoteStream",t.id,a),(0,C.throttleAccumulateDispatchParticipant)(G,t.id,{stream:a})},onScreenStream:function(t,a){e.debug&&console.warn("onScreenStream",t,a);var n={screenSharingStream:t,mediaSettings:a};(0,C.throttleAccumulateDispatchParticipant)(G,x,n)},onRemoteScreenStream:function(t,a){e.debug&&console.warn("onRemoteScreenStream",t.id,a),(0,C.throttleAccumulateDispatchParticipant)(G,t.id,{screenSharingStream:a})},onConversation:function(a){if(e.debug&&(console.warn("onConversation",a),(0,h.debugMessage)(h.DebugMessageType.LOG,{type:"start call info",os:N.Platform.OS,arch:N.Platform.ARCH,isMobile:N.Platform.isMobile,browser:(0,N.getBrowserInfo)(),config:T.getState().config,cameras:t.browser.getCameras(),microphones:t.browser.getMicrophones(),hasMicrophonePermission:t.browser.hasMicrophonePermission(),hasCameraPermission:t.browser.hasCameraPermission(),screenHeight:window.screen.availHeight,screenWidth:window.screen.availWidth,windowHeight:window.screen.height,windowWidth:window.screen.width})),!T.getState().callData.ts){var n=Date.now();G({type:r.TIME_START,data:n})}var i=T.getState().peer;0!==i&&(0,v.loadActiveCallDataAction)(H,G,i)},onRemoteMediaSettings:function(t,a){var n,r;e.debug&&console.warn("onRemoteMediaSettings",t.id,a);var i=+t.id,o=T.getState(),l=(null===(r=null===(n=o.participants[i])||void 0===n?void 0:n.mediaSettings)||void 0===r?void 0:r.isScreenSharingEnabled)||!1;a.isScreenSharingEnabled!==l&&B(o,G,a.isScreenSharingEnabled,i,!0),(0,C.throttleAccumulateDispatchParticipant)(G,i,{mediaSettings:a}),m.callStatDataStorage.set({hadVideoEnabled:a.isVideoEnabled})},onParticipantStatus:function(t,a,n){var i=+t.id,o=T.getState(),l=a;e.debug&&console.warn("onParticipantStatus",i,l,n);var s=o.peer;if(!(0,A.isGroupCallByPeer)(s)){var c=Object.keys(o.participants).length;2!==c||i in o.participants?c>2&&(s=0):s=0}if(!(o.participants[i]&&o.participants[i].mediaSettings&&o.participants[i].shortName||l!==h.ParticipantStatus.WAITING)){var u=[i],d=o.callData.callId||"",p={withConversation:!T.getState().callData.conversation,awaitImages:!1};(0,v.loadCallParticipantsAccumulate)(o,G,e,d,u,p)}if((0,C.throttleAccumulateDispatchParticipant)(G,i,{status:l,statusData:n}),m.callStatDataStorage.set({connectionStep:l}),i===o.peer){var _=function(e,t){var a={call_event_type:e,session_id:o.callData.callId,peer_id:o.peer,is_group_call:!1};t&&(a.reason=t),g.callStats.logEvent(a)};if(l===h.ParticipantStatus.CONNECTED){if(_(r.CallActionEventType.CALL_CONNECTED),!o.participants[o.peer].wasConnected&&(0,E.isCreator)(o.participants[o.me])){var f=m.callStatDataStorage.get().startType;_(r.CallActionEventType.OUTGOING_CALL_ACCEPTED_REMOTELY,null==f?void 0:f.toString())}}else l===h.ParticipantStatus.WAITING&&_(r.CallActionEventType.OUTGOING_CALL_REMOTE_RINGING)}},onPermissionsError:function(a){if(e.debug&&console.warn("onPermissionsError",a),T.getState().mode===r.Mode.CALL){switch(a){case r.MediaError.CAMERA_PERMISSION:case r.MediaError.CAMERA_ACCESS:t.toggleLocalVideo(!1);break;case r.MediaError.MIC_ACCESS:case r.MediaError.MIC_NOT_FOUND:t.toggleLocalAudio(!1);break;case r.MediaError.SCREEN_PERMISSION:case r.MediaError.SCREEN_ACCESS:t.captureScreen(!1)}G({type:r.ERROR,text:(0,f.getMediaErrorMessage)(a,y)})}},onPermissionsRequested:function(){e.debug&&console.warn("onPermissionsRequested")},onRemoteRemoved:function(t){e.debug&&console.warn("onRemoteRemoved",t.id),G({type:r.REMOVE_USER,participantId:+t.id})},onCallState:function(t,a,i){e.debug&&console.warn("onCallState",t,a,i);var o=i.id,l=i.direction;if(!o||!T.getState().callData.callId){if(G({type:r.CALL_STATE,callData:{callId:o}}),!T.getState().peer){var s=Object.keys(T.getState().participants||{}).map((function(e){return Number(e)}));s.length&&(0,v.loadCallParticipantsAccumulate)(H,G,e,o,(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(s)),[T.getState().me]),{withConversation:!0,withChatMembers:!0,withCallParticipants:!0,awaitImages:!1})}!(0,A.isGroupCallByPeer)(T.getState().peer||0)||"JOINING"!==l&&"OUTGOING"!==l||g.callStats.logEvent({call_event_type:r.CallActionEventType.CALL_CONNECTED,session_id:o,peer_id:T.getState().peer||0,is_group_call:!0})}},onRateNeeded:function(){e.debug&&console.warn("onRateNeeded")},onSpeakerChanged:function(t){var a=t.id;e.debug&&console.warn("onSpeakerChanged",a),G({type:r.SET_ORATOR,orator:+a})},onJoinStatus:function(t,a){e.debug&&console.warn("onJoinStatus",t,a)},onHangup:function(a,n){var i=a.hangup;e.debug&&console.warn("onHangup",i,n);var l=i&&![r.HANGUP_TYPE_CANCELED,r.HANGUP_TYPE_MISSED,r.HANGUP_TYPE_HUNGUP,r.HANGUP_TYPE_REMOVED].includes(i),s=i&&i===r.HANGUP_TYPE_HUNGUP,c=(0,A.isGroupCallByPeer)(T.getState().peer);if(T.getState().mode===r.Mode.CALL&&l||T.getState().localStatus===h.ParticipantStatus.WAITING_HALL&&i===r.HANGUP_TYPE_REMOVED)G({type:r.HANGUP,data:i}),(0,d.pause)(r.HANGUP_DELAY,null).finally((function(){G({type:r.CHANGE_MODE,mode:r.Mode.READY})}));else if(H.config.showFeedbackScreen&&s){var u=T.getState().callData.ts,p=(u?Math.floor((Date.now()-u)/1e3):0)>10&&0===Math.floor(3*Math.random()),v=0===Math.floor(5*Math.random());c&&p||v?(G({type:r.MANAGEMENT,isOpen:!1}),G({type:r.CHANGE_MODE,mode:r.Mode.FEEDBACK})):T.getState().mode!==r.Mode.ERROR&&G({type:r.CHANGE_MODE,mode:r.Mode.READY})}else T.getState().mode!==r.Mode.ERROR&&G({type:r.CHANGE_MODE,mode:r.Mode.READY});e.isInActiveCall=!1;var f=(0,o.isInReconnect)(T.getState());if(n=n||"",(0,_.addCallStatEvent)(i,n,f,e.debug),!f&&!c){var E="none";i===h.HangupType.MISSED?E="timeout":i===h.HangupType.BUSY&&(E="busy");var C=T.getState().callData.conversation,S={call_event_type:r.CallActionEventType.CALL_DECLINED_OR_HANGED_REMOTELY,session_id:n,peer_id:(null==C?void 0:C.peerId)||0,is_group_call:!1,reason:E};g.callStats.logEvent(S)}e.authorizedGroupId&&function(e,t,a,n){M(e,t,a,0,n)}(t,e,T,G),m.callStatDataStorage.reset()},onCallAccepted:function(){e.debug&&console.warn("onCallAccepted"),(0,A.isGroupCallByPeer)(T.getState().peer)&&g.callStats.logEvent({call_event_type:r.CallActionEventType.CALL_CONNECTED,session_id:T.getState().callData.callId,peer_id:T.getState().peer,is_group_call:(0,A.isGroupCallByPeer)(T.getState().peer)})},onTokenExpired:function(){e.debug&&console.warn("onTokenExpired"),(e.tokenAttempts||0)<3&&(b(t,e,T),e.tokenAttempts=(e.tokenAttempts||0)+1)},onDeviceChange:function(){e.debug&&console.warn("onDeviceChange")},onMultipartyChatCreated:function(){e.debug&&console.warn("onMultipartyChatCreated")},onFingerprintChange:function(t){e.debug&&console.warn("onFingerprintChange",t)},onVolumesDetected:(0,s.volumesDetectorGenerator)({onUpdate:function(e){G({type:r.SET_SPEAKERS,data:e})},volumeLevelDetection:r.VOLUME_LEVEL_DETECTION,debugCallback:function(){e.debug}}),onLocalVolume:(0,s.localVolumeDetectorGenerator)({onVolumeLevelReached:function(){var e=T.getState();G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.SPEAKING_ON_MUTE}}),g.callStats.logEvent({call_event_type:r.CallActionEventType.MIC_OFF_WHILE_TALKING_ALERT,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,A.isGroupCallByPeer)(e.peer)})},onVolumeLevelUpdated:function(e){var t,a=null===(t=T.getState().participants[x].mediaSettings)||void 0===t?void 0:t.isAudioEnabled,n=T.getState().speakers,i=Object.assign({},n);e&&a?i[x]=!0:e||delete i[x],i[x]!==n[x]&&G({type:r.SET_SPEAKERS,data:{speakers:i}})},needCheckMicEnabled:!0,volumeLevelDetection:r.VOLUME_LEVEL_DETECTION,vectorLength:5,callbackFactorStep:0,sensitivityCoefficient:.45,debugCallback:function(){e.debug}}),onChatMessage:function(t,a,n){e.debug&&console.warn("onChatMessage",t,a,n)},onCustomData:function(t,a){e.debug&&console.warn("onCustomData",t,a)},onNetworkStatusChanged:function(t){var a,r;if(e.debug&&console.warn("onNetworkStatusChanged",t),(0,A.isGroupCallByPeer)(H.peer)&&H.config.badNetwork||!(0,A.isGroupCallByPeer)(H.peer)&&H.config.badNetworkP2P)try{for(var i=(0,n.__values)(t),o=i.next();!o.done;o=i.next()){var l=o.value;(0,C.throttleAccumulateDispatchParticipant)(G,+l.uid.id,{networkStatus:l.rating})}}catch(e){a={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}},onLocalNetworkStatusChanged:function(t){e.debug&&console.warn("onLocalNetworkStatusChanged",t),((0,A.isGroupCallByPeer)(H.peer)&&H.config.badNetwork||!(0,A.isGroupCallByPeer)(H.peer)&&H.config.badNetworkP2P)&&(0,C.throttleAccumulateDispatchParticipant)(G,H.me,{networkStatus:t})},onDebugMessage:function(t){for(var a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];e.debug&&console.warn.apply(console,(0,n.__spreadArray)(["onDebugMessage",t],(0,n.__read)(a)))},onRemoteParticipantState:function(t,a){var i,o,l;e.debug&&console.warn("onRemoteParticipantState",t,a);var s=function(e){return e.hand?(0,n.__assign)((0,n.__assign)({},e),{hand:e.hand===r.SdkHandType.RAISED}):e}(a),c=t.id,u=!!(null===(o=null===(i=T.getState().participants[c])||void 0===i?void 0:i.statusData)||void 0===o?void 0:o.hand),d=!!(null===(l=T.getState().participants[c])||void 0===l?void 0:l.name);(0,C.throttleAccumulateDispatchParticipant)(G,c,{statusData:s}),(null==s?void 0:s.hand)&&!u&&d&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.RAISED_HAND,data:c}})},onRolesChanged:function(t,a){e.debug&&console.warn("onRolesChanged",t,a);var n=T.getState().participants[t.id];a.includes(h.UserRole.ADMIN)&&n&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.USER_GRANTED_WITH_ADMIN_ROLE,data:t.id}}),(0,C.throttleAccumulateDispatchParticipant)(G,t.id,{roles:a})},onLocalRolesChanged:function(t){e.debug&&console.warn("onLocalRolesChanged",t),(t.includes(h.UserRole.ADMIN)||t.includes(h.UserRole.CREATOR))&&(0,C.throttleAccumulateDispatchParticipant)(G,x,{permissions:{audio:r.MediaPermissionType.ALLOW,video:r.MediaPermissionType.ALLOW,screenSharing:r.MediaPermissionType.ALLOW}}),t.includes(h.UserRole.ADMIN)&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.ADMIN_ROLE_GRANTED}}),t.includes(h.UserRole.ADMIN)||t.includes(h.UserRole.CREATOR)?H.config.allowWaitingHall&&(0,A.isWaitingHallEnabled)(T.getState())&&(0,I.loadAdditionalWaitingHall)(T.getState(),G,!0):T.getState().waitingHall&&(0,I.clearWaitingList)(G),G({type:r.CHANGE_PARTICIPANT_ROLES,participantId:x,data:t})},onDeviceSwitched:function(t,a){e.debug&&console.warn("onDeviceSwitched",t,a)},onUnmutePermission:function(t){e.debug&&console.warn("onUnmutePermission",t);var a=T.getState(),n=a.participants[x],i=a.popup;if(t||i!==r.POPUP_UNMUTE_REQUEST||G({type:r.TOGGLE_POPUP}),!(0,E.isAdmin)(n)&&!(0,E.isCreator)(n)){var o=n.permissions,l=o.audio,s=o.video,c=o.screenSharing;l===r.MediaPermissionType.DENY&&s===r.MediaPermissionType.DENY&&c===r.MediaPermissionType.DENY||G({type:r.CALL_NOTIFICATION,notification:{type:t?r.NotificationType.ADMIN_MUTE:r.NotificationType.ADMIN_MUTE_PERMANENT}}),(0,C.throttleAccumulateDispatchParticipant)(G,x,{permissions:{audio:t?r.MediaPermissionType.ALLOW:r.MediaPermissionType.DENY,video:t?r.MediaPermissionType.ALLOW:r.MediaPermissionType.DENY,screenSharing:t?r.MediaPermissionType.ALLOW:r.MediaPermissionType.DENY}}),t&&g.callStats.logEvent({call_event_type:r.CallActionEventType.MIC_OFF_WHILE_TALKING_ENABLE_CLICK,session_id:a.callData.callId,peer_id:a.peer,is_group_call:(0,A.isGroupCallByPeer)(a.peer)})}},onUnmuteRequest:function(a){var i;if(e.debug&&console.warn("onUnmuteRequest",a),a!==h.MediaOption.VIDEO){var o=T.getState(),l=o.participants[o.me],s=l.permissions,c=s.audio,u=s.video,d=s.screenSharing,p=(0,E.isMutedPermanently)(l),A=!!(null===(i=l.statusData)||void 0===i?void 0:i.hand);A&&t.changeParticipantState({hand:r.SdkHandType.LOWERED}).catch(console.log),(0,C.throttleAccumulateDispatchParticipant)(G,x,(0,n.__assign)({permissions:{audio:p?r.MediaPermissionType.ONCE:c,video:p?r.MediaPermissionType.ONCE:u,screenSharing:p?r.MediaPermissionType.ONCE:d}},A&&{statusData:(0,n.__assign)((0,n.__assign)({},l.statusData),{hand:!1})})),G({type:r.TOGGLE_POPUP,data:r.POPUP_UNMUTE_REQUEST})}},onRecordStarted:function(t,a,n,i,o,l){e.debug&&console.warn("onRecordStarted",t,a,n,i);var s={isOn:!0,videoId:parseInt(o),ownerId:parseInt(l),host:t,startTime:n,link:"https://"+window.location.host+(0,S.getShortVideoUrl)(l,o),startStreamParams:void 0};G({type:r.SET_TRANSLATION,data:s})},onRecordStopped:function(){e.debug&&console.warn("onRecordStopped"),G({type:r.SET_TRANSLATION,data:{isOn:!1,hasPermission:!1}})},onLocalPin:function(t){var a;e.debug&&console.warn("onLocalPin",{unpin:t});var n=T.getState(),i=n.participants[x];t||G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.PINNED_BY_ADMIN}}),!t&&(0,E.isMutedPermanently)(i)&&(0,C.throttleAccumulateDispatchParticipant)(G,x,{permissions:{audio:r.MediaPermissionType.ONCE,video:r.MediaPermissionType.ONCE,screenSharing:r.MediaPermissionType.ONCE}}),t||(null===(a=i.mediaSettings)||void 0===a?void 0:a.isAudioEnabled)||G({type:r.TOGGLE_POPUP,data:r.POPUP_ADMIN_PIN_UNMUTE_REQUEST}),t||n.isOratorMode||G({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0}),G({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:t?null:x})},onPinnedParticipant:function(t,a){e.debug&&console.warn("onPinnedParticipant",t,a);var n=T.getState(),i=n.participants[t.id];!a&&i&&((null==i?void 0:i.shortName)||(null==i?void 0:i.name))&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.USER_PINNED_BY_ADMIN,data:t.id}}),n.isOratorMode||G({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0}),G({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:a?null:Number(t.id)})},onOptionsChanged:function(t){e.debug&&console.warn("onOptionsChanged",t),G({type:r.SET_CONVERSATION_OPTIONS,data:t})},onLocalStatus:function(t){e.debug&&console.warn("onLocalStatus",t);var a=T.getState(),o=a.localStatus,s=a.callData,c=a.me;o!==h.ParticipantStatus.WAITING_HALL||t!==h.ParticipantStatus.WAITING||(0,E.isParticipantAnonym)(c)||(null==s?void 0:s.callId)&&(0,i.getConversationsByCall)([s.callId]).then((function(e){var t=e.items,a=(0,n.__read)(t,1)[0].peer.id;return O(T,a,void 0).then((function(e){return(0,l.preloadImagesFromResponse)(e)})).then((function(){return a}))})).catch((function(e){var t;8===(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_code)&&Promise.resolve(0)})),G({type:r.SET_LOCAL_STATUS,data:t}),(0,C.throttleAccumulateDispatchParticipant)(G,H.me,{status:t,wasConnected:!0})},onChatRoomUpdated:function(t,a,n){e.debug&&console.warn("onChatRoomUpdated",t,a,n),t===h.ChatRoomEventType.ATTENDEE&&(0,I.loadWaitingHall)(a,n,T.getState(),G)}};e.authorized=!1,e.authorizedGroupId=0,e.debugMessage=h.debugMessage,e.call=function(e,t,a,n,i){var o=n.dispatch;return function(s,u,d,p,_){void 0===_&&(_=0);var v=(0,A.getMediaOptions)({video:u,audio:!0});return e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(P):(e.isInActiveCall=!0,Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return L(e)})).then((function(){return M(t,e,n,_,o)})).then((function(){return(0,c.checkPermissions)(t,v)})).then((function(){return O(n,s,d)})).then((function(a){return Promise.all([(0,l.preloadImagesFromResponse)(a),i(e,t,n,v,s)])})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:s}),m.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,entryPoint:p,startType:u?r.CallType.VIDEO:r.CallType.AUDIO}),g.callStats.logEvent({call_event_type:u?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:n.getState().callData.callId,peer_id:s,is_group_call:!1,source:p,group_call_users_count:2}),k(n,s,d)})).catch((function(n){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),R(n,t,e,(0,A.isGroupCallByPeer)(s),a,o)})))}}(e,t,y,T,U),e.startGroupCall=function(e,t,a,n,i){var o=n.dispatch;return function(l,s,u,d,_,f,E){void 0===f&&(f=!0),void 0===E&&(E=null);var C=(0,A.getMediaOptions)({video:d,audio:!0}),h=u?u.filter(p.isUserPeer):[];return e.debug&&u&&u.length!==h.length&&console.warn("Some ids cannot get into the call.",u.filter((function(e){return!(0,p.isUserPeer)(e)}))),e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(P):(e.isInActiveCall=!0,Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return L(e)})).then((function(){return M(t,e,n,0,o)})).then((function(){return(0,c.checkPermissions)(t,C)})).then((function(){return O(n,l,s)})).then((function(e){return(0,v.loadChatMembersAction)(n.getState(),o,l,e[0])})).then((function(){return i(e,t,n,C,l)})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:l}),f&&(h&&h.length?o({type:r.GROUP_CALL_SETUP,open:!0,peerId:l,preselectedIds:h}):o({type:r.MANAGEMENT,isOpen:!0})),E&&o({type:r.SET_TRANSLATION,data:{deferredId:E}}),k(n,l,s),m.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,startType:d?r.CallType.VIDEO:r.CallType.AUDIO,entryPoint:_,isGroupCall:!0}),g.callStats.logEvent({call_event_type:d?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:n.getState().callData.callId,peer_id:l,is_group_call:!0,source:_,group_call_users_count:1})})).catch((function(n){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),R(n,t,e,(0,A.isGroupCallByPeer)(l),a,o)})))}}(e,t,y,T,U),e.startCall=function(e,t,a,n,i){var o=n.dispatch;return function(s,u,d,p){void 0===d&&(d=!0),void 0===p&&(p=0);var _=(0,A.getMediaOptions)({video:s,audio:!0});if(e.isInActiveCall)return Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(P);e.isInActiveCall=!0;var v=(0,A.getDefaultConversation)(a);return Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return L(e)})).then((function(){return M(t,e,n,p,o)})).then((function(){return(0,c.checkPermissions)(t,_)})).then((function(){return Promise.all([i(e,t,n,_),(0,l.preloadImagesFromResponse)([v])])})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.LOAD_PEERS,conversation:v,members:[],peerId:0}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL}),d&&o({type:r.MANAGEMENT,isOpen:!0}),m.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,entryPoint:u,startType:s?r.CallType.VIDEO:r.CallType.AUDIO,isGroupCall:!0}),g.callStats.logEvent({call_event_type:s?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:n.getState().callData.callId,peer_id:0,is_group_call:!0,source:u,group_call_users_count:1})})).catch((function(n){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),R(n,t,e,!0,a,o)}))}}(e,t,y,T,U),e.joinCallByLink=function(e,t,a,o,s){var u=o.dispatch;return function(d,p,_,m,v,f){void 0===_&&(_=!1),void 0===v&&(v=0),void 0===f&&(f=void 0);var C=(0,A.getMediaOptions)({video:_,audio:!0});return e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(P):(e.isInActiveCall=!0,(0,E.isParticipantAnonym)(o.getState().me)?Promise.resolve().then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return L(e)})).then((function(){return(0,c.checkPermissions)(t,C)})).then((function(){return s(d,C).then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!1}),u({type:r.CHANGE_MODE,mode:r.Mode.CALL})}))})).catch((function(n){e.isInActiveCall=!1,u({type:r.SHOW_LOADER,isLoaderVisible:!1}),R(n,t,e,!0,a,u)})):Promise.resolve().then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return L(e)})).then((function(){return M(t,e,o,v,u)})).then((function(){return(0,c.checkPermissions)(t,C)})).then((function(){return s(d,C)})).then((function(e){var t=e.id;return(0,i.getConversationsByCall)([t])})).then((function(e){var t=e.items,a=(0,n.__read)(t,1)[0].peer.id;return O(o,a,p).then((function(e){return(0,l.preloadImagesFromResponse)(e)})),a})).catch((function(e){var t,a;if(8===(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_code))return 0;if(951===(null===(a=null==e?void 0:e.error)||void 0===a?void 0:a.error_code))return 0;throw e})).then((function(e){u({type:r.SHOW_LOADER,isLoaderVisible:!1}),u({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:e}),f&&u({type:r.SET_TRANSLATION,data:{deferredId:f}}),e&&k(o,e,p),g.callStats.logEvent({call_event_type:r.CallActionEventType.GROUP_CALL_JOINED,session_id:o.getState().callData.callId,peer_id:null!=e?e:0,is_group_call:!0,source:m,group_call_users_count:(0,E.getActiveParticipants)(o.getState().participants,o.getState().me,o.getState().groupId,o.getState().meGroup).length})})).catch((function(n){e.isInActiveCall=!1,u({type:r.SHOW_LOADER,isLoaderVisible:!1}),R(n,t,e,!0,a,u)})))}}(e,t,y,T,V),e.showJoinPopup=function(e,t,a){var l=a.dispatch;return function(s,c){var u=a.getState().mode;return u===r.Mode.CALL||u===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch((function(){l({type:r.ERROR,text:t("calls_already_in_call_error")})})):(l({type:r.SHOW_LOADER,isLoaderVisible:!0}),(0,i.getJoinLinkDetails)(s).then(o.normalizePreviewData.bind(null,t)).then((function(e){l({type:r.SHOW_LOADER,isLoaderVisible:!1}),l({type:r.JOIN,data:(0,n.__assign)((0,n.__assign)({},e),{entryPoint:c})})})).catch((function(a){var n;e.eventHandlers.onError&&a&&e.eventHandlers.onError(a),e.debug&&console.warn("getJoinLinkDetails",a);var i=(0,o.getTextForApiErrorByCode)(null===(n=null==a?void 0:a.error)||void 0===n?void 0:n.error_code,!0,t);console.error(i),l({type:r.SHOW_LOADER,isLoaderVisible:!1}),l({type:r.ERROR,text:i,handleType:r.ErrorHandleType.FATAL})})))}}(e,y,T),e.acceptCall=function(e,t,a,n){var i=n.dispatch;return function(o,l){var s=n.getState(),u=s.peer,d=s.callData,p=(0,A.getMediaOptions)({video:o,audio:l});return(0,c.checkPermissions)(t,p).then((function(){return t.acceptCall(p)})).then((function(t){var a=t.acceptTime;i({type:r.CHANGE_MODE,mode:r.Mode.CALL,ts:a}),e.isInActiveCall=!0,g.callStats.logEvent({call_event_type:r.CallActionEventType.INCOMING_CALL_ACCEPTED,session_id:d.callId,peer_id:u,is_group_call:(0,A.isGroupCallByPeer)(u),reason:o?r.CallType.VIDEO:r.CallType.AUDIO})})).catch((function(t){i({type:r.ERROR,text:(0,f.getPermissionsErrorMessage)(o,!0,a),handleType:r.ErrorHandleType.DECLINE}),e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),(0,h.debugMessage)(h.DebugMessageType.ERROR,t),console.error(t)}))}}(e,t,y,T),e.showCallByNamePopup=function(e,t,a,n){var i=n.dispatch;return function(e,t,o){var l=n.getState().mode;return l===r.Mode.CALL||l===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch((function(){i({type:r.ERROR,text:a("calls_already_in_call_error")})})):Promise.resolve().then((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!1}),i({type:r.CALL_BY_NAME,data:{peerId:e,joinLink:o,entryPoint:t}})})).catch((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!1})}))}}(0,0,y,T),e.store=T;var W=a.token?Promise.resolve(a.token):(0,u.fetchToken)(a.is_dev);return W.then((function(a){return t.init(F).then((function(){H.config.debugLog&&e.setDebug(!0)})).then((function(){return function(a){return Promise.resolve().then((function(){return(0,E.isParticipantAnonym)(T.getState().me)?Promise.resolve():t.authorize(a).then((function(){return(0,u.saveLocalToken)(a)})).then((function(){return e.authorized=!0})).catch((function(e){throw(0,u.removeLocalToken)(),e}))}))}(a)}))}))}function P(e){switch(e){case r.CallErrorType.ALREADY_IN_CALL:console.log("Already in call");break;default:console.log(e)}}function b(e,t,a){return function(e,t,a){return(0,i.getCallAuthToken)(a.getState().isDev).then((function(a){var n=a.token;return e.authorize(n).then((function(){return(0,u.saveLocalToken)(n)})).then((function(){return t.authorized=!0}))}))}(e,t,a).catch((function(e){t.eventHandlers.onError&&e&&t.eventHandlers.onError(e),console.error("Could not authorize with token request",e)}))}function L(e){return new Promise((function(t){e.initializing.finally((function(){t()}))}))}function M(e,t,a,n,o){return new Promise((function(l,s){n||t.authorizedGroupId||l(),n&&t.authorizedGroupId===n&&l(),g.callStats.setEventCommonData(),o({type:r.SET_GROUP_MEMBERS,groupMembersCount:0,groupMembers:[],unableToCallGroupMembersIds:[]}),(0,i.getCallAuthToken)(a.getState().isDev,n).then((function(a){var c=a.token;e.authorize(c).then((function(){t.authorizedGroupId=n,n?(0,i.getGroupById)(-n).then((function(e){if(e.groups){var t=e.groups[0];o({type:r.SET_GROUP,groupId:n,meGroup:(0,T.normalizeGroup)(t)}),g.callStats.setEventCommonData({group_id:n}),l()}})).catch((function(e){s(e)})):l()}))}))}))}function w(e,t,a,n,r,i){void 0===r&&(r=0),void 0===i&&(i=[]);var l=(0,o.createPayload)(r,n);if(!r)return t.callTo(void 0,n,l,!0);if(!(0,A.isGroupCallByPeer)(r))return G(e,a,r).then((function(e){return t.forceRelayPolicy(e),t.callTo(r.toString(),n,l)}));var s=i.filter((function(e){return e=Number(e),(0,p.isUserPeer)(e)&&e!==a.getState().me}));return t.callTo(s,n,l,!0)}function O(e,t,a){var l=e.dispatch;return!!a||t?(a?Promise.resolve((0,o.convertClientData)(a)):(0,i.retryLoadCallPeers)(t).then(o.convertServerData)).then((function(e){var a=(0,n.__read)(e,3),i=a[0],o=a[1],s=a[2];return(0,v.setActiveCallData)(l,s||i),l({type:r.LOAD_PEERS,conversation:i,members:o,peerId:t}),e})):Promise.reject("Cannot load data")}function k(e,t,a){var s=e.dispatch;return!!a&&t?(0,i.retryLoadCallPeers)(t).then((function(e){var t=(0,n.__read)((0,o.convertServerData)(e),2),a=t[0],r=t[1];return(0,v.setActiveCallData)(s,e.items[0]),(0,l.preloadImagesFromResponse)([a,r])})).then((function(e){var t=(0,n.__read)(e,2),a=t[0],i=t[1];s({type:r.LOAD_PEERS,conversation:a,members:i})})):Promise.resolve()}function D(e,t,a){switch(!0){case function(e){var t=e||{},a=t.hangup,n=t.message;return!(!a||!n)}(e):case function(e){var t=e||{},a=t.hangup;return t.message&&void 0===a}(e):return(0,o.getTextForServerError)(e.message,t,a);case function(e){var t;return["TypeError","SyntaxError","RangeError","EvalError","URIError"].includes(null===(t=null==e?void 0:e.__proto__)||void 0===t?void 0:t.name)}(e):return a("calls_error");case function(e){return!!e.error_msg}(e):return(0,o.getTextForServerError)(e.error_msg,t,a);case function(e){return"number"==typeof e}(e):return(0,o.getTextForClientError)(e,t,a);case function(e){return!!e}(e):default:return a("calls_sorry_error")}}function R(e,t,a,n,i,o){var l,s;try{var c=D(e,n,i);t.hangup(),a.eventHandlers.onError&&e&&a.eventHandlers.onError(e),(0,h.debugMessage)(h.DebugMessageType.ERROR,e),console.error(e),o({type:r.ERROR,text:c,handleType:r.ErrorHandleType.FATAL}),(null===(l=a.eventHandlers)||void 0===l?void 0:l.onErrorStartCall)&&(null===(s=a.eventHandlers)||void 0===s||s.onErrorStartCall())}catch(a){throw(0,h.debugMessage)(h.DebugMessageType.ERROR,a),console.error(a),t.hangup(),e}}function B(e,t,a,n,i){var o,l,s=Object.keys(e.screenSharers).filter((function(t){return e.screenSharers[t]})).length,c=function(a,n){var i=function(e){t({type:r.TOGGLE_ORATOR_MODE,isOratorMode:e})},o=function(e){t({type:r.SET_PINNED_PARTICIPANT,pinnedParticipant:e})};a&&!e.isOratorMode&&i(!0),!a&&e.screenSharingNeedDisableOratorModeAfterStop&&i(!1),t({type:r.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:n,screenSharingNeedDisableOratorModeAfterStop:!e.isOratorMode,screenSharingOldPinnedParticipant:e.pinnedParticipant}),n&&e.pinnedParticipant&&o(null),n||e.pinnedParticipant||!e.screenSharingOldPinnedParticipant||o(e.screenSharingOldPinnedParticipant)};0===s&&a?c(!0,n):1!==s||a||c(!(!e.adminPinnedParticipant&&!e.pinnedParticipant),null),!!(null===(l=null===(o=e.participants[n])||void 0===o?void 0:o.mediaSettings)||void 0===l?void 0:l.isScreenSharingEnabled)!==a&&t({type:r.SET_SCREEN_SHARER,participantId:n,isScreenSharingEnabled:a}),a&&i&&t({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.SCREEN_SHARING_STARTED,data:n}})}function G(e,t,a){var n=t.getState();return n.ipSettingEnabled&&"all"!==n.privacySettings.callsIp?(0,p.isChatPeer)(a)?Promise.resolve(!0):e.isFriend?Promise.resolve(!e.isFriend(a)):Object.keys(n.friendsCache).length>0?Promise.resolve(!n.friendsCache[a]):(0,o.exponentialRetry)(v.loadFriendsAction)(e,n,t.dispatch).then((function(){return G(e,t,a)})):Promise.resolve(!1)}},662727:(e,t,a)=>{"use strict";a.d(t,{getCallTimer:()=>p,getHangupStatus:()=>A,getCallStatus:()=>_});var n=a(121255),r=a(52777),i=a(298811),o=a(667294),l=a(464380),s=a(670778),c=a(580248),u=a(745284),d=a(697483);function p(e){return e?o.createElement(r.CallTimer,{duration:(0,i.calculateCallDuration)(e)}):null}function A(e,t){if(e.hangupType)switch(e.hangupType){case n.HANGUP_TYPE_BUSY:return t("calls_busy");case n.HANGUP_TYPE_CALLEE_IS_OFFLINE:return t("calls_callee_is_offline");case n.HANGUP_TYPE_REJECTED:return t("calls_rejected_status");case n.HANGUP_TYPE_CANCELED:case n.HANGUP_TYPE_MISSED:case n.HANGUP_TYPE_HUNGUP:case n.HANGUP_TYPE_REMOVED:return null;case n.HANGUP_TYPE_CALLER_IS_BLOCKED:case n.HANGUP_TYPE_EXTERNAL_API_ERROR:case n.HANGUP_TYPE_FAILED:case n.HANGUP_TYPE_NOT_FRIENDS:case n.HANGUP_TYPE_OLD_VERSION:case n.HANGUP_TYPE_SERVICE_DISABLED:case n.HANGUP_TYPE_UNKNOWN_ERROR:case n.HANGUP_TYPE_UNSUPPORTED:return t("calls_error")}return null}var _=function(e,t){return e?A(e,t)||function(e,t){var a,n=e.participants[t];return n&&n.status===l.ParticipantStatus.CONNECTED||n&&n.status===l.ParticipantStatus.WAITING_HALL||(0,d.getActiveParticipantsCount)(e)<2?null:o.createElement(s.ParticipantStatusContainer,{status:null!==(a=null==n?void 0:n.status)&&void 0!==a?a:l.ParticipantStatus.WAITING})}(e,(0,u.isGroupCallByPeer)(e.peer)?e.me:e.peer)||function(e,t){return void 0===((0,u.isGroupCallByPeer)(e.peer)?e.callData.ts:e.callData.localTimeStamp)?o.createElement(c.default,null,t("calls_status_waiting")):null}(e,t):""}},387691:(e,t,a)=>{"use strict";a.d(t,{localVolumeDetectorGenerator:()=>r,volumesDetectorGenerator:()=>i});var n=a(570655);function r(e){var t=e.onVolumeLevelReached,a=e.needCheckMicEnabled,r=e.vectorLength,i=e.volumeLevelDetection,o=e.callbackFactorStep,l=e.sensitivityCoefficient,s=e.onVolumeLevelUpdated,c=e.debugCallback,u=function(e){var t=[],a=0;return function(n){if(t.push(n),a+=n,t.length>e){var r=t.shift();a-=r||0}return a/t.length}}(r),d=0,p=!1;return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];c&&c(e);var A=(0,n.__read)(e,2),_=A[0],m=A[1],g=_>i;p!==g&&s&&s(g),p=g,0!==d&&m&&(d=0);var v=u(_);a&&m||_/v>(1+d)/l&&_>i&&(d+=o,t())}}function i(e){var t=e.onUpdate,a=e.volumeLevelDetection,r=e.debugCallback,i={},s=[],c={},u=[];return function(){for(var e=[],d=0;d<arguments.length;d++)e[d]=arguments[d];r&&r(e);var p=(0,n.__read)(e,1),A=p[0];c=Object.keys(c).reduce((function(e,t){return c[t]-1>0&&(e[t]=c[t]-1),e}),{});var _=A.reduce((function(e,t){var n=t.uid.id;return t.volume>a&&(e[n]=!0,c[n]=3),e}),{});u=Object.keys(c);var m=!1,g={speakers:null,speakersInHeader:null};o(i,_)||(g.speakers=_,i=_,m=!0),l(s,u)||(g.speakersInHeader=u,s=u,m=!0),m&&t(g)}}function o(e,t){var a=Object.keys(e),n=Object.keys(t);return a.length===n.length&&a.every((function(e){return t[e]}))}function l(e,t){return e.length===t.length&&e.every((function(e,a){return e===t[a]}))}},485525:(e,t,a)=>{"use strict";a.d(t,{wakeLockRequest:()=>c,wakeLockRelease:()=>u});var n,r="wakeLock"in navigator&&!0,i=null,o=!1,l=function(){null!==i&&"visible"===document.visibilityState&&c()},s=function(){var e,t,a,r;n||((n=document.createElement("video")).setAttribute("title","Wake lock"),n.setAttribute("playsinline",""),e=n,t="mp4",a="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA=",(r=document.createElement("source")).src=a,r.type="video/"+t,e.appendChild(r),n.addEventListener("loadedmetadata",(function(){n&&n.addEventListener("timeupdate",(function(){n&&n.currentTime>.5&&(n.currentTime=Math.random())}))}))),n.play().catch((function(){}))};function c(){if(!r)return s();o||(o=!0,document.addEventListener("visibilitychange",l));try{navigator.wakeLock.request("screen").then((function(e){(i=e).addEventListener("release",(function(){}))}))}catch(e){console.error(e.name+", "+e.message)}}function u(){r?i&&i.release().then((function(){i=null})):n&&n.pause()}},862191:(e,t,a)=>{"use strict";a.d(t,{callStatDataStorage:()=>l});var n=a(570655),r=a(464380),i={timeStart:null,entryPoint:null,startType:null,isGroupCall:!1,hadVideoEnabled:!1,isOutgoingCall:!1,connectionStep:null};function o(e){switch(e){case r.ParticipantStatus.WAITING:return 1;case r.ParticipantStatus.CONNECTING:return 2;case r.ParticipantStatus.CONNECTED:return 3;default:return 0}}var l={get:function(){return i},set:function(e){var t,a;i=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},i),e),{connectionStep:(t=e.connectionStep,a=i.connectionStep,t&&o(t)&&o(t)>o(a)?t:a)})},reset:function(){i={timeStart:null,entryPoint:null,startType:null,isGroupCall:!1,hadVideoEnabled:!1,isOutgoingCall:!1,connectionStep:null}}}},614914:(e,t,a)=>{"use strict";a.d(t,{callStats:()=>o});var n=a(570655),r=a(697483),i="type_voip_call_item",o=new(function(){function e(){this.eventCommonData={}}return e.prototype.setActionStatCollector=function(e){this.actionStatCollector=e},e.prototype.setEventCommonData=function(e){void 0===e&&(e={}),this.eventCommonData=e},e.prototype.logEvent=function(e){var t,a=e.peer_id,o=(0,r.isParticipantGroup)(a)?a:0,l=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},e),{peer_id:e.peer_id.toString(),session_id:e.session_id||"",lib_version:"calls_v2",group_id:o}),this.eventCommonData);this.actionStatCollector&&this.actionStatCollector.logEvent(((t={type:i}).type_voip_call_item=l,t))},e}())},170794:(e,t,a)=>{"use strict";a.d(t,{setStatlogEventsHandler:()=>l,addCallStatEvent:()=>s});var n,r=a(121255),i=a(862191),o=a(464380);function l(e){n=e}function s(e,t,a,o){var l,s,u,d=i.callStatDataStorage.get(),p=d.startType,A=d.entryPoint,_=d.timeStart,m=d.isGroupCall,g=d.hadVideoEnabled,v=d.isOutgoingCall,f=!e||e===r.HANGUP_TYPE_HUNGUP&&!a,E={type:p&&function(e,t,a){var n;n=e===r.CallType.VIDEO?t?r.CallStatReachedType.GROUP_VIDEO:r.CallStatReachedType.VIDEO:a?t?r.CallStatReachedType.GROUP_AUDIO_TO_VIDEO:r.CallStatReachedType.AUDIO_TO_VIDEO:t?r.CallStatReachedType.GROUP_AUDIO:r.CallStatReachedType.AUDIO;return n}(p,m,g),result:f?r.CallStatResult.SUCCESS:r.CallStatResult.FAIL,failReason:f?null:c(e,a),callSource:A,totalDuration:_?Date.now()-_:0};v&&(o&&console.log(E),l=t,u=[(s=E).type||"",s.result,s.failReason||"",s.callSource||"",s.totalDuration],n&&n({name:"call_stats",value:l,keys:u}))}function c(e,t){var a=i.callStatDataStorage.get().isOutgoingCall,n=i.callStatDataStorage.get().connectionStep;switch(!0){case t:return r.CallStatFailReason.CONNECTION_LOST;case e===r.HANGUP_TYPE_CANCELED:return r.CallStatFailReason.LOCAL_DECLINE;case e===r.HANGUP_TYPE_REJECTED:return r.CallStatFailReason.REMOTE_DECLINE;case e===r.HANGUP_TYPE_BUSY:return r.CallStatFailReason.REMOTE_BUSY;case e===r.HANGUP_TYPE_MISSED:return a?r.CallStatFailReason.REMOTE_TIMEOUT:null;case n===o.ParticipantStatus.CONNECTING:return r.CallStatFailReason.REMOTE_FAILED_ACCEPT;case!n:return r.CallStatFailReason.REMOTE_NO_CONNECT;default:return null}}},525046:(e,t,a)=>{"use strict";a.d(t,{saveLocalToken:()=>o,removeLocalToken:()=>l,fetchToken:()=>s});var n=a(659397),r=a(329538),i="calls_token";function o(e){n.localStorage.setItem(i,e)}function l(){n.localStorage.removeItem(i)}function s(e){var t=n.localStorage.getItem(i);return t?Promise.resolve(t):(0,r.getCallAuthToken)(e).then((function(e){return e.token}))}},580248:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var n=a(570655),r=a(667294),i=a(45697),o=a.n(i),l=a(659397),s=function(e){var t=e.children,a=e.className,i=(0,n.__rest)(e,["children","className"]),o=(0,l.classNames)("ActivityIndicator",a);return r.createElement("span",(0,n.__assign)({},i,{className:o}),t)};s.propTypes={className:o().string,children:o().node};const c=s},685537:(e,t,a)=>{"use strict";a.d(t,{AvatarsStack:()=>o});var n=a(667294),r=a(211941),i=a(906942),o=function(e){var t=e.items;return n.createElement("figure",{className:"AvatarsStack"},n.createElement(r.default,null,n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},n.createElement("defs",null,n.createElement("clipPath",{id:"users-mask"},n.createElement("path",{d:"M43.56 8.25a25 25 0 100 33.5A27.88 27.88 0 0138 25c0-6.28 2.07-12.08 5.56-16.75z"}))))),t.map((function(e,t){return"src"in e?n.createElement("img",{src:e.src,className:"AvatarsStack__item",alt:e.alt,key:e.key||t}):n.createElement(i.ConversationNoPhoto,{text:e.text,id:e.id,size:"50",className:"AvatarsStack__item",key:e.key||t})})))}},58600:(e,t,a)=>{"use strict";a.d(t,{CopyText:()=>r});var n=a(667294),r=function(e){var t=e.text,a=e.onCopyDone,r=e.children,i=(0,n.useRef)(null),o=(0,n.useCallback)((function(e){i.current&&(i.current.focus(),i.current.select(),document.execCommand("copy"),e.preventDefault(),e.stopPropagation(),a&&a())}),[a]);return n.createElement("div",{className:"CopyText",onClick:o},n.createElement("input",{type:"text",readOnly:!0,value:t||"",ref:i,className:"CopyText__input"}),r)}},607691:(e,t,a)=>{"use strict";a.d(t,{ListCopyControl:()=>c});var n=a(570655),r=a(667294),i=a(58600),o=a(326542),l=a(629142),s=a(659397),c=function(e){var t=e.value,a=e.copyText,c=e.doneText,u=e.className,d=(0,n.__read)((0,r.useState)(!1),2),p=d[0],A=d[1],_=(0,r.useCallback)((function(){A(!0)}),[]),m=(0,r.useCallback)((function(){A(!1)}),[]),g=(0,s.classNames)("ListCopyControl",u,{"ListCopyControl--copied":p});return r.createElement("div",{className:g},r.createElement(i.CopyText,{text:t,onCopyDone:_},r.createElement(o.default,{className:"ListCopyControl__copyButton"},a)),r.createElement(l.default,{shown:p,callback:m,className:"ListCopyControl__copyDone"},c))}},295886:(e,t,a)=>{"use strict";a.d(t,{ListHeader:()=>i});var n=a(667294),r=a(659397),i=function(e){var t=e.headingElement,a=void 0===t?"h3":t,i=e.extra,o=e.className,l=e.children,s=a;return n.createElement("header",{className:(0,r.classNames)("ListHeader",o)},n.createElement(s,{className:"ListHeader__text"},l),n.createElement("span",{className:"ListHeader__extra"},i))}},489685:(e,t,a)=>{"use strict";a.d(t,{LinkIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"14",height:"14",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t,{"aria-hidden":"true"}),r.createElement("path",{d:"M6.022 9.184a.837.837 0 01-1.187-.001 3.861 3.861 0 010-5.419l2.618-2.643a3.772 3.772 0 015.366 0c1.261 1.274 1.557 3.033.67 4.508-.296.49-.947.47-1.325.09-.275-.276-.254-.707-.077-1.019.465-.817.24-1.683-.456-2.379a2.094 2.094 0 00-2.997 0L6.023 4.956a2.143 2.143 0 00-.001 3.025.83.83 0 010 1.202zm1.95-3.166c.833.835.832 2.19-.001 3.025L5.36 11.68a2.094 2.094 0 01-2.998 0c-.695-.696-.91-1.555-.446-2.371.178-.313.199-.744-.076-1.019-.379-.38-1.03-.4-1.325.09-.888 1.474-.602 3.226.659 4.5a3.772 3.772 0 005.367 0l2.617-2.643a3.861 3.861 0 000-5.419.837.837 0 00-1.187 0 .83.83 0 000 1.2z"}))}},823694:(e,t,a)=>{"use strict";a.d(t,{PrivacyIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"20",height:"20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4 9.6c0-.56 0-.84.109-1.054a1 1 0 01.437-.437C4.76 8 5.04 8 5.6 8h8.8c.56 0 .84 0 1.054.109a1 1 0 01.437.437C16 8.76 16 9.04 16 9.6v4.8c0 .56 0 .84-.109 1.054a1 1 0 01-.437.437C15.24 16 14.96 16 14.4 16H5.6c-.56 0-.84 0-1.054-.109a1 1 0 01-.437-.437C4 15.24 4 14.96 4 14.4V9.6z",fill:"#fff"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2 6a2.2 2.2 0 00-4.4 0v4a2.2 2.2 0 104.4-.001V6zM10 2a4 4 0 00-4 4v4a4 4 0 108-.001V6A4 4 0 0010 2z",fill:"#fff"}))}},449608:(e,t,a)=>{"use strict";a.d(t,{TimeIcon:()=>i});var n=a(570655),r=a(667294),i=function(e){var t=(0,n.__rest)(e,[]);return r.createElement("svg",(0,n.__assign)({width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.8 8a6.2 6.2 0 1112.4 0A6.2 6.2 0 011.8 8zM0 8a8 8 0 1116 0A8 8 0 010 8zm8.9-3a.9.9 0 00-1.8 0v4a.9.9 0 00.498.805l2 1a.9.9 0 10.804-1.61L8.9 8.444V5z",fill:"#fff"}))}},641221:(e,t,a)=>{"use strict";a.d(t,{TooltipNew:()=>s});var n,r=a(570655),i=a(667294),o=a(617841),l=a(659397);function s(e){var t=e.children,a=e.content,s=e.position,c=void 0===s?"auto":s,u=e.align,d=void 0===u?"auto":u,p=e.appearance,A=void 0===p?"dark":p,_=e.open,m=void 0!==_&&_,g=e.onOpen,v=e.onClose,f=e.delay,E=void 0===f?50:f,C=(0,r.__rest)(e,["children","content","position","align","appearance","open","onOpen","onClose","delay"]),h=(0,r.__read)((0,i.useState)(m?n.OPENED:n.CLOSED),2),S=h[0],T=h[1],I=(0,i.useRef)(null);(0,i.useEffect)((function(){var e=null,t=null,a=function(){e&&(clearTimeout(e),e=null)},r=function(){a(),e=window.setTimeout((function(){T(n.OPENED),g&&g()}),E)},i=function(){a(),t=window.setTimeout((function(){S===n.OPENED?T(n.IS_CLOSING):(T(n.CLOSED),v&&v())}),0)};return I&&I.current&&(I.current.addEventListener("mouseenter",r),I.current.addEventListener("mouseleave",i)),function(){I&&I.current&&(I.current.removeEventListener("mouseenter",r),I.current.removeEventListener("mouseleave",i)),a(),t&&(window.clearTimeout(t),t=null)}}),[I,S]),(0,i.useEffect)((function(){var e=m?n.OPENED:n.CLOSED;S!==e&&T(e)}),[m]);var N=(0,i.useCallback)((function(){S===n.IS_CLOSING&&(T(n.CLOSED),v&&v())}),[S]),y=(0,l.classNames)("TooltipNew",{"TooltipNew--removed":"isClosing"===S,"TooltipNew--dark":"dark"===A,"TooltipNew--light":"light"===A}),P=i.createElement("div",{className:y,onTransitionEnd:N},a);return i.createElement(o.Popper,(0,r.__assign)({open:S!==n.CLOSED,position:c,align:d,content:P,ref:I},C),t)}!function(e){e.OPENED="opened",e.IS_CLOSING="isClosing",e.CLOSED="closed"}(n||(n={}))},211941:(e,t,a)=>{"use strict";a.d(t,{default:()=>r});var n=a(667294);const r=function(e){var t=e.children;return n.createElement("div",{className:"VisuallyHidden"},t)}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={id:e,loaded:!1,exports:{}};return n[e].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.m=n,e=[],i.O=(t,a,n,r)=>{if(!a){var o=1/0;for(u=0;u<e.length;u++){for(var[a,n,r]=e[u],l=!0,s=0;s<a.length;s++)(!1&r||o>=r)&&Object.keys(i.O).every((e=>i.O[e](a[s])))?a.splice(s--,1):(l=!1,r<o&&(o=r));if(l){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[a,n,r]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var r=Object.create(null);i.r(r);var o={};t=t||[null,a({}),a([]),a(a)];for(var l=2&n&&e;"object"==typeof l&&!~t.indexOf(l);l=a(l))Object.getOwnPropertyNames(l).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(r,o),r},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.e=()=>Promise.resolve(),i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={4387:0};i.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[o,l,s]=a,c=0;for(n in l)i.o(l,n)&&(i.m[n]=l[n]);if(s)var u=s(i);for(t&&t(a);c<o.length;c++)r=o[c],i.o(e,r)&&e[r]&&e[r][0](),e[o[c]]=0;return i.O(u)},a=self.webpackChunkvk=self.webpackChunkvk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=i.O(void 0,[8592,4509,6392,7113,9429,1690],(()=>i(366206)));o=i.O(o)})();