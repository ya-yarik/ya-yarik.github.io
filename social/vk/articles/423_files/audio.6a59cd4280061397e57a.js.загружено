(()=>{"use strict";var __webpack_modules__={401730:(t,e,i)=>{function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return e.querySelector(t)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return e.querySelectorAll(t)}i.d(e,{$:()=>o,$$:()=>s}),window.$=o,window.$$=s,function(){HTMLElement.prototype.$=HTMLElement.prototype.querySelector,HTMLElement.prototype.$$=HTMLElement.prototype.querySelectorAll;try{SVGElement.prototype.$=SVGElement.prototype.querySelector,SVGElement.prototype.$$=SVGElement.prototype.querySelectorAll}catch(t){}}()},299340:(t,e,i)=>{function o(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M15.88 18.12a1.25 1.25 0 01-1.76 1.76l-7-7a1.25 1.25 0 010-1.76l7-7a1.25 1.25 0 011.76 1.76L9.77 12z" fill="currentColor"/></svg>',name:"chevron_left_24"}}i.d(e,{getIcon24ChevronLeft:()=>o})},558672:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{currentAudioPage:()=>currentAudioPage,AudioPage:()=>AudioPage});var core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(283946),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(991181),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(296253),core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(820075),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(751876),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(59357),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(976142),_lib_stats__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(109847),_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(709961),_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(443946),_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(920832),_web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(602872),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(311046),_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(917999),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(257367),_web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(49282),_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(561393),_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(414914),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(791563),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(587041),_web_lib_utils__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(907851),_web_grid_sorted__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(513e3),_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(705456),_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(116886),_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(718737),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(719016),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(80909),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(541650),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(442699),_web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(162440),_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(165003),_icons_desktop_getIcon24ChevronLeft__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(299340),SLIDER_TIMEOUT=1e4,sectionsToUpdate=[];function currentAudioPage(t){var e=gpeByClass("_audio_page_layout",t);return!!e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(e,"audioPage")}function AudioPage(t,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(t,"audioPage",this),extend(cur.lang||{},e.langs),getAudioPlayer().langs=e.langs,this._data=e,this._ownerId=e.ownerId,this.isLayer()||(cur.audioPage=this),this.isLayer()&&uiSearch.init("audio_search_layer"),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.toggleAudioHQBodyClass(),this._els={pageContainer:t,sections:geByClass1("_audio_page_sections",t),playerWrap:geByClass1("_audio_page_player_wrap",t),player:geByClass1("_audio_page_player",t),contentBlock:geByClass1("_audio_page_content_block",t)||geByClass1("_playlist_page_content_block",t),scrollWrap:geByClass1("_audio_page_content_block_wrap",t),searchSectionAudios:geByClass1("_audio_section_search__local_audios_list",t),searchSectionAudiosHeader:geByClass1("audio_section_search__local_audios_header",t),searchSectionPlaylists:geByClass1("_audio_section_search__local_playlists_list",t),searchSectionPlaylistsHeader:geByClass1("_audio_section_search__local_playlists_header",t),searchNoLocalResults:geByClass1("_audio_local_no_results",t),searchGlobalBlocks:geByClass1("_audio_section_global_search__blocks",t),searchGlobalCommunitiesPlace:geByClass1("_audio_section_global_search__communities_place",t),searchGlobalPlaylistsPlace:geByClass1("_audio_section_global_search__playlists_place",t),searchGlobalArtistsPlace:geByClass1("_audio_section_global_search__artists_place",t),searchGlobalAudiosBlock:geByClass1("_audio_section_global_search__audios_block",t),searchGlobalAudiosBlockHeader:geByClass1("_audio_section_global_search__audios_header",t),searchGlobalAudiosList:geByClass1("_audio_section_global_search__audios_list",t),searchInput:geByClass1("ui_search_field",geByClass1("_audio_search",t)),footer:geByClass1("_audio_page__footer",t),footerNowPlayingInfo:geByClass1("_audio_page__footer_now_playing",t),footerClearNowPlayingButton:geByClass1("_audio_page__footer_clear_playlist",t)},this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_14__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),this._readyAudio=this._data.readyAudio;var i=this._data.readyPlaylist;i&&(this._pagePlaylist=getAudioPlayer().getPlaylist(i.type,i.ownerId,i.id),this._pagePlaylist.mergeWith(i)),!this._readyAudio&&this._pagePlaylist&&(this._readyAudio=this._pagePlaylist.getAudioAt(0)),this._data.playlistCoverUploadOptions&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[this._ownerId]=this._data.playlistCoverUploadOptions),this.isLayer()||(cur.module=e.module||"audio",cur.oid=this._ownerId,+this._ownerId==+vk.id?cur.submodule="my":this._ownerId<0?cur.submodule="group_list":cur.submodule="user_list"),vk.id&&this._initPlayer(),this._initPlaylists(),this.initNavigation(),this.catalogController=new _web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_29__.CatalogController(t),this.showSection(e.initSection);var o=new URLSearchParams(location.search);this.defaultSection=!o.get("section")&&e.initSection||"all",this._initSearchParams(),this.promoAlbumSlideInit(),this._els.searchInput&&this._els.searchInput.focus(),this.isLayer()||this.isPodcastPage()||!nav.objLoc.q||"search_playlists"===nav.objLoc.section||(this._els.searchInput&&(this._els.searchInput.value=winToUtf(nav.objLoc.q)),this._showSearchSection(nav.objLoc)),this.updateCurrentPlayingInfo(),getAudioPlayer().setStatusExportInfo(this._data.export),this.updateStatusExportControls(),this._initKeyEvents(),window.onAudioPageLoaded&&(window.onAudioPageLoaded.call(this),delete window.onAudioPageLoaded),this.updateShuffleButton()}AudioPage.address="audio",AudioPage.updateSearchHighlight=function(t){var e=geByClass1("_audio_playlist",gpeByClass("_audio_layout",this));toggleClass(e,"audio_search_focused","focus"===t.type)},AudioPage.onSearchFocused=function(t){AudioPage.updateSearchHighlight(t)},AudioPage.prototype.updatePlaylistsCounter=function(t){var e;if(cur.audioPage&&t===cur.audioPage.getOwnerId()&&(e=cur.audioPage._els.pageContainer.querySelector(".CatalogBlock__own_only_playlists_header .CatalogBlock__title"))){var i=cur.audioPage._data.playlists.length;e.innerHTML=langNumeric(i,cur.lang.audio_playlists_count_title),toggleClass(gpeByClass("_audio_page_section_layout",e),"audio_section_empty",!i)}},AudioPage.deletePlaylist=function(t,e,i){var o=getAudioPlayer().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,t,e),s=AudioPlayer.getLang("audio_sure_delete_playlist_box_text");s='<div style="overflow: hidden; text-overflow: ellipsis;">'+(s=s.replace("{name}",o.getTitle()))+"</div>",(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__.showFastBox)({title:AudioPlayer.getLang("audio_sure_delete_playlist_box_title"),dark:1},s,AudioPlayer.getLang("audio_sure_delete_playlist_box_yes"),function(){if(ajax.post("al_audio.php?act=delete_playlist",{hash:i,playlist_owner_id:t,playlist_id:e,page_owner_id:cur.audioPage?cur.audioPage.getOwnerId():0},{onDone:function(t){if(cur.audioPage){var e=geByClass1("_audio_section__all",cur.audioPage.getPageContainer()),i=geByClass1("_audio_page_block__playlists_items",e);if(e&&i){var o=intval(domData(i,"max-items"));t&&i.children.length<o&&i.appendChild(se(getTemplate("audio_pl_item",t))),i.children.length||(addClass(gpeByClass("_audio_page_section_layout",i),"no_playlists"),re(gpeByClass("_audio_page_titled_block",i)))}}},onFail:()=>!0}),boxQueue&&boxQueue.hideAll(),layers&&layers.fullhide&&layers.fullhide(),each(geByClass("_audio_pl_"+t+"_"+e),(function(){re(this)})),window.location.pathname.includes(`/music/playlist/${window.vk.id}`))return window.history.length>2?void window.history.back():void document.location.replace(`https://${window.vk.apiConfigDomains.domain}/music?section=${cur.audioPage.defaultSection}`);if(cur.audioPage){if(cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((function(i){return!(i.id==e&&i.owner_id==t)})),!cur.audioPage._data.playlists.length)return void nav.reload();cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(t)}}.bind(this),getLang("global_cancel"))},AudioPage.prototype.getCurrentSection=function(){return this._currentSection},AudioPage.prototype._initPlaylists=function(t){if(this._data.generic)return t&&t([]);AudioPage.loadPlaylists(this.getOwnerId(),this._data.playlistsTotal,!0,!1,function(e){this._data.playlists=this._data.playlists.concat(e),this._data.playlistsIndex=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_19__.vkIndexer(this._data.playlists,(function(t){return t.title})),t&&t()}.bind(this))},AudioPage.prototype.getOwnerPlaylists=function(){return this._data.playlists},AudioPage.loadPlaylists=function(ownerId,totalCount,skipFirstChunk,forAttachBox,onDone){var chunkSize=50,chunks=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__.isFunction)(totalCount)&&(onDone=totalCount,totalCount=void 0,skipFirstChunk=!1),cur.playlistsCache=cur.playlistsCache||{};var cacheKey=ownerId+"_"+intval(skipFirstChunk);if(cur.playlistsCache[cacheKey])return onDone(cur.playlistsCache[cacheKey]);function onAllLoaded(){var t=[];each(chunks,(function(e,i){i&&(t=t.concat(i))})),cur.playlistsCache[cacheKey]=t,onDone&&onDone(t)}function _loadChunk(chunkIndex,_cb){var groupId=cur.group_id||(cur.oid<0?-cur.oid:0);ajax.post("al_audio.php?act=owner_playlists",{owner_id:ownerId,group_id:groupId,offset:chunkIndex*chunkSize,is_attach:forAttachBox?1:0},{onDone:function onDone(playlists,totalCount,additionalData){additionalData.templates_script&&eval(additionalData.templates_script),additionalData.langs&&extend(cur.lang,additionalData.langs),additionalData.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[ownerId]=additionalData.audio_playlist_cover_upload_options),chunks[chunkIndex]=playlists,_cb(totalCount)},onFail:function(t){if(hide(boxLoader),t)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__.showFastBox)({title:getLang("global_error")},t),!0}})}function _loadAllChunks(t,e,i){var o=Math.ceil(t/chunkSize);o&&o-e!=0?function(){for(var t=new callHub(i,o-e),s=e;s<o;s++)_loadChunk(s,(function(){t.done()}))}():i()}isUndefined(totalCount)?_loadChunk(0,(function(t){_loadAllChunks(t,1,onAllLoaded)})):_loadAllChunks(totalCount,skipFirstChunk?1:0,onAllLoaded)},AudioPage.prototype.getOwnerId=function(){return+this._ownerId},AudioPage.prototype.getPageContainer=function(){return this._els.pageContainer},AudioPage.prototype.getCurrentSectionEl=function(){return this.catalogController.currentSection&&this.catalogController.currentSection.getSectionElement()},AudioPage.prototype.canAddToGroup=function(){return this._data.canAudioAddToGroup},AudioPage.prototype.canEditGroup=function(){return this._data.canEdit},AudioPage.prototype.updateCurrentPlayingInfo=function(){if(this.isLayer()){var t=getAudioPlayer(),e=t.getCurrentPlaylist(),i=e?e.getTitle():"";if(e&&window.langConfig&&window.langConfig.id!==e.getTitleLang()&&ajax.post("al_audio.php?act=get_playlist_info",{owner_id:e.getOwnerId(),playlist_id:e.getAlbumId(),access_hash:e.getAccessHash()},{onDone:i=>{e.updatePlaylist(i)&&(t.saveStateCurrentPlaylist(),this.updateCurrentPlayingInfo())},onFail:()=>{}}),i){var o=e.getOriginalPlaylistRawId();if(e.getBlockId())i=`<a href="${`/audio?section=recoms_block&type=${e.getBlockId()}`}"\n                  class="audio_page__footer_now_playing_link">\n                  ${i}\n                </a>`;else if(o||e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST&&0!==e.getAlbumId()){var s,a,r;o?(s=(o=o.split("_"))[0],a=o[1],r=o[2]||""):(s=e.getOwnerId(),a=e.getAlbumId(),r=e.getAccessHash()||""),i=`<a href="${nav.toStr(extend({},nav.objLoc,{z:"audio_playlist"+s+"_"+a+(r?"/"+r:"")}))}"\n                  class="audio_page__footer_now_playing_link"\n                  onclick="if (checkEvent(event)) { return true } else { AudioUtils.showAudioPlaylist(${s}, ${a}, '${r}'); return cancelEvent(event) }">\n                  ${i}\n                </a>`}this._els.footerNowPlayingInfo.innerHTML=getLang("audio_current_playing_from").replace("{playlist}",i)}else{var l=getAudioPlayer().getCurrentAudio();_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(l)?this._els.footerNowPlayingInfo.innerHTML=getLang("audio_current_playing_from").replace("{playlist}",getLang("audio_podcast_playing").replace("{name}",l[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER])):this._els.footerNowPlayingInfo.innerHTML=""}this._els.footerClearNowPlayingButton.innerHTML=getLang("audio_clear_current_playlist"),toggle(this._els.footer,!!e)}},AudioPage.prototype.onSearchFiltersChanged=function(t){var e=window.radioBtns["audio_search_type_"+intval(this.isLayer())],i=intval(this._searchSortFilter.selectedItems()[0][0]),o={performer:e.val?1:null,lyrics:hasClass(geByClass1("_audio_fltr_with_lyrics",this._els.pageContainer),"on")?1:null,sort:i?1:null};this.syncParametersUI(o);var s=t&&isObject(t)?t:o;this.isLayer()&&(s=extend({},this._prevLoc,s)),nav.change(s,!1,{fromSearch:!0,filtersChanged:!0})},AudioPage.prototype._initSearchParams=function(){window.radioBtns["audio_search_type_"+intval(this.isLayer())]={els:geByClass("_audio_search_type",this._els.pageContainer),keep:this.isLayer()};var t=geByClass1("_audio_fltr_sort",this._els.pageContainer);t&&(this._searchSortFilter=new Dropdown(t,this._data.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)})),this.isLayer()||this.syncParametersUI(nav.objLoc)},AudioPage.prototype.syncParametersUI=function(t){var e="audio_search_type_"+intval(this.isLayer()),i=window.radioBtns[e];i&&radiobtn(i.els[t.performer?1:0],!!t.performer,e);var o=geByClass1("_audio_fltr_with_lyrics",this._els.pageContainer);toggleClass(o,"on",!!t.lyrics);var s={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")},a=this._els.searchInput;each(["performer","lyrics","sort"],(function(e,i){uiSearch.toggleFilter(a,i,s[i],!!t[i])}))},AudioPage.onFilterRemoved=function(t,e,i){var o=currentAudioPage(e);(function(){switch(t){case"performer":var e="audio_search_type_"+intval(this.isLayer()),o=window.radioBtns[e];radiobtn(o.els[0],0,e);break;case"sort":var s=this._searchSortFilter.options.defaultItems[0][0];this._searchSortFilter.selectItem(s,!1);break;case"lyrics":removeClass(geByClass1("_audio_fltr_with_lyrics",this._els.pageContainer),"on")}i||this.onSearchFiltersChanged()}).apply(o)},AudioPage.prototype._showSearchSection=function(t){this._toggleSearchProgress(!0);var e=getAudioPlayer().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID);if(geByClass1("audio_page_player2")){var i=t.globalQuery||t.q;this._sectionData={q:i,performer:t.performer},this.showSection("search",function(){if(i){var t=this._data.sectionData.search?this._data.sectionData.search.qid:0;(0,_lib_stats__WEBPACK_IMPORTED_MODULE_7__.saveSearchAttemptStats)(_lib_stats__WEBPACK_IMPORTED_MODULE_7__.serviceAudio,0,!isVisible(this._els.searchNoLocalResults),i,t)}this._toggleSearchProgress(!1)}.bind(this))}else e.loadAll(function(){this._toggleSearchProgress(!1),this._doShowSearchSection(t)}.bind(this))},AudioPage.prototype._toggleSearchProgress=function(t){this._els.searchInput&&!this._muteSearch&&(t?uiSearch.showProgress(this._els.searchInput):uiSearch.hideProgress(this._els.searchInput))},AudioPage.prototype._doShowSearchSection=function(t){var e=getAudioPlayer();if(t&&(this._prevSearchParams=t),t=t||this._prevSearchParams){var i=replaceEntities(t.q)+replaceEntities(t.globalQuery||"");each(["performer","lyrics","sort"],(function(e,o){i+=t[o]||0})),i+=this._ownerId,this._toggleSearchProgress(!0);var o=getAudioPlayer().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,this._ownerId,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID);o.loadAll(function(){clearTimeout(this._onSilendLoadedTO),this._onSilendLoadedTO=setTimeout(function(){s.call(this)}.bind(this))}.bind(this))}function s(){o.search(t,function(o){var s="",a=this._data.playlistsIndex?this._data.playlistsIndex.search(t.q):[];if(this.showSection("search"),a.length){var r="";each(a,(function(t,e){r+=getTemplate("audio_pl_item",e)})),show(this._els.searchSectionPlaylistsHeader),show(this._els.searchSectionPlaylists),s=+this._ownerId===vk.id?e.langs.audio_found_your_local_playlists:this._ownerId>0?e.langs.audio_found_user_local_playlists:e.langs.audio_found_group_local_playlists,this._els.searchSectionPlaylistsHeader.innerHTML=langNumeric(a.length,s),this._els.searchSectionPlaylists.innerHTML=r}else hide(this._els.searchSectionPlaylistsHeader),hide(this._els.searchSectionPlaylists);var l=getAudioPlayer().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_20__.hashCode)(i));l.mergeWith({list:o,searchParams:{globalQuery:t.globalQuery||t.q,performer:t.performer,lyrics:t.lyrics,sort:t.sort}}),l.setLocalFoundCount(o.length),o.length||a.length?hide(this._els.searchNoLocalResults):(show(this._els.searchNoLocalResults),s=vk.id===+this._ownerId?e.langs.audio_no_local_results:this._ownerId>0?e.langs.audio_no_user_local_results:e.langs.audio_no_group_local_results,this._els.searchNoLocalResults.innerHTML=s.replace("{query}","<strong>"+clean(t.q)+"</strong>")),o.length||(hide(this._els.searchSectionAudiosHeader),hide(this._els.searchSectionAudios)),this._pagePlaylist=l,this._toggleSearchProgress(!1)}.bind(this))}},AudioPage.prototype.showFriendMusic=function(t,e){return statlogsValueEvent("audio_friends_block","click_friend"),this.isLayer()?nav.go({0:"/audios"+e},!1,{friendId:e}):nav.go("/audios"+e,t),cancelEvent(t)},AudioPage.prototype._deinitNavigation=function(){cur.nav.pop(),this._navigationInited=!1},AudioPage.PageSections=["recoms_audio","recoms_block","search_block","recoms_personal","my"];var layerSectionsToMainFrame=["search_block","search_playlists","recoms_block"];AudioPage.prototype.initNavigation=function(){this._navigationInited||this.isPodcastPage()||(this._navigationInited=!0,this._prevLoc={},!this.isLayer()&&nav.objLoc.popup&&"recoms_onboarding"===nav.objLoc.popup&&AudioPage.showRecomsOnboarding(),cur.nav.push(function(t,e,i,o){var s=this._ignoreResetedSearch;if(delete this._ignoreResetedSearch,s&&o.fromSearch)return!1;if(o.isLayer&&!this.isLayer())return!1;if(i.popup&&"recoms_onboarding"===i.popup)return AudioPage.showRecomsOnboarding(),nav.setLoc(i),!1;if(this.isLayer()&&!1!==this._prevLoc)for(var a in e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_28__.clone)(this._prevLoc),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_28__.clone)(i),e)e.hasOwnProperty(a)&&(e[a]&&void 0===i[a]?t[a]=!1:e[a]==i[a]&&delete t[a]);if(t&&Object.keys(t).length){this._deleteDeletedAudios();var r=i.section||this.defaultSection,l=!1;return 0===i[0].indexOf("podcasts")&&(r="podcast"),o.tab||o.fromSearch||!1===t.q&&1===Object.keys(t).length||o.searchPerformer?l=!1:o.friendId&&this.isLayer()?(r="friend",this.resetSection(r),this._sectionData={friend_id:o.friendId},l=!1):(2!==Object.keys(t).length||!1!==t.q||isUndefined(t[0]))&&isUndefined(t[0])?(inArray(t.section,AudioPage.PageSections)||t.hasOwnProperty("block")||inArray(e.section,AudioPage.PageSections)&&!inArray(t.section,AudioPage.PageSections))&&(!this.isLayer()||layerSectionsToMainFrame.includes(i.section)||t.hasOwnProperty("block")?l=!0:(l=!1,this._sectionData={audio_id:t.audio_id},r="recoms",delete this._currentSection)):l=!0,l?(this.catalogController&&this.catalogController.destroy(),!0):(i.q?(this._els.searchInput&&!o.fromSearch&&(this._els.searchInput.value=i.q,triggerEvent(this._els.searchInput,"keyup",{},!0),this.lastQuery=i.q),this._showSearchSection(extend({},i,o))):(this._ignoreResetedSearch=!1===t.q,this._els.searchInput&&uiSearch.reset(this._els.searchInput,!0),this.showSection(r),this._switchTab(r)),this.isLayer()?this._prevLoc=i:nav.setLoc(i),(o.back||o.hist||o.nav)&&this.syncParametersUI(i),!1)}}.bind(this)))},AudioPage.prototype._deleteDeletedAudios=function(){var t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAddRestoreInfo();each(t,(function(t,e){"deleted"!==e.state&&"recom_hidden"!==e.state||getAudioPlayer().deleteAudioFromAllPlaylists(t)}))},AudioPage.prototype._switchTab=function(t){if(!this.isPodcastPage()){var e=geByClass1("_audio_section_tab__"+t,this._els.pageContainer);e?uiTabs.switchTab(domFC(e)):removeClass(geByClass1("ui_tab_sel",this._els.pageContainer),"ui_tab_sel")}},AudioPage.prototype.onLayerHide=function(){this._deinitNavigation(),this._deinitKeyEvents(),this._onSectionOut(),delete this._currentSection,this._muteSearch=!0,geByClass1("audio_page_player2")&&hide(this._els.searchNoLocalResults),setTimeout((()=>uiSearch.reset(this._els.searchInput)),1e3)},AudioPage.prototype.updateLayerHeight=function(){var t=700;t=Math.min(t,window.innerHeight-150),t=Math.max(t,400),isVisible(this._els.footer)&&(t-=getSize(this._els.footer)[1]),setStyle(this._els.scrollWrap,{height:t}),this._els&&this._els.scrollWrap&&"function"==typeof this._els.scrollWrap.updateScroll&&this._els.scrollWrap.updateScroll()},AudioPage.prototype.onLayerShow=function(t){var e=getAudioPlayer().getCurrentPlaylist(),i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(getAudioPlayer().getCurrentAudio());i?this.showSection("podcast"):e?this.showSection("current"):t?this.showSection(t):this.showSection("all"),toggleClass(geByClass1("_audio_section_tab__current",this._els.pageContainer),"unshown",!e||i),this.initNavigation(),this.updateCurrentPlayingInfo(),this._initKeyEvents(),this.updateLayerHeight(),this.updateShuffleButton();var o=this.getPageCurrentPlaylist(),s=getAudioPlayer().getCurrentAudio();if(this._audioRowsAutoList&&o&&s&&o.indexOfAudio(s)>=0)for(var a=10;a--;){var r=geByClass1(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_CURRENT_CLS,this._audioRowsAutoList.getListEl());if(r){var l=getXY(r)[1];this._scroll.scroller.scrollTop=l-scrollGetY()-300,this._scroll.update();break}this._audioRowsAutoList.drawMore(),getAudioPlayer().updateCurrentPlaying()}delete this._muteSearch},AudioPage.prototype.resetSection=function(t){var e=geByClass1("_audio_section__"+t,this._els.sections);this.catalogController.deleteSection(t),re(e)},AudioPage.prototype.isUpdateRequested=function(t){return Array.isArray(sectionsToUpdate)&&sectionsToUpdate.includes(t+this.getOwnerId())},AudioPage.disableAdsClick=function(t){statlogsValueEvent("audio_web_ad_link","click"),nav.go(t)},AudioPage.prototype.requestUpdate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";sectionsToUpdate=t.map((t=>t+e))},AudioPage.prototype.showSection=function(t,e,i){this.isPodcastPage()&&(t="podcast"),"search"!==this._currentSection||"all"!==t&&"current"!==t||uiSearch.reset(this._els.searchInput,!0),layers.fullhide&&layers.fullhide(),this._switchTab(t);var o=geByClass1("audio_page_player2")&&"search"===t||this.isUpdateRequested(t);if(this._currentSection!==t||"search"===this._currentSection){this._currentSection=t;var s=geByClass1("_audio_section__"+t,this._els.sections),a=this._data.sectionData&&this._data.sectionData[t]||{};if(s&&(!o||!1===i)){if(each(geByClass("_audio_section",this._els.pageContainer),(function(){hide(this)})),hide(this._els.searchGlobalBlocks),hide(this._els.searchGlobalCommunitiesPlace),hide(this._els.searchGlobalPlaylistsPlace),hide(this._els.searchGlobalArtistsPlace),hide(this._els.searchGlobalAudiosBlock),show(s),geByClass1("audio_page_player2")&&(hide(this._els.searchNoLocalResults),"search"===t&&!s.innerHTML)){show(this._els.searchNoLocalResults);var r=getAudioPlayer(),l=vk.id===+this._ownerId?r.langs.audio_no_local_results:this._ownerId>0?r.langs.audio_no_user_local_results:r.langs.audio_no_group_local_results,n=winToUtf(clean(a.searchParams.globalQuery));this._els.searchNoLocalResults.innerHTML=l.replace("{query}","<strong>"+n+"</strong>")}if(this._onSectionOut(),delete cur._back,"podcast"!==t&&(this.catalogController.setSection(t,s,a||{}),this.isLayer()||_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_30__.FullscreenBanner.initiate(a.sectionId)),this._onSectionOut((()=>{this.catalogController.disableSection(t)})),this.isLayer()||getAudioPlayer().getCurrentPlaylist()||!a.title||setDocumentTitle(a.title),!["podcast","current"].includes(t))return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__.isFunction)(e)&&e(),void getAudioPlayer().updateCurrentPlaying();switch(t){case"current":this._initSection_current(s,a,!0);break;case"podcast":this._initSection_podcast(s,a)}return getAudioPlayer().updateCurrentPlaying(),void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__.isFunction)(e)&&e())}var _=this._ownerId;if("podcast"===t&&!this.isPodcastPage())_=(getAudioPlayer().getCurrentAudio()||this._readyAudio)[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID];this.isUpdateRequested(t)&&(sectionsToUpdate=null),ajax.post("al_audio.php",extend({act:"section",section:t,owner_id:_,is_layer:this.isLayer()?1:0,claim:intval(nav.objLoc.claim)},this._sectionData||{}),{onDone:(i,s)=>{if(this._data.sectionData=this._data.sectionData||{},this._data.sectionData[t]=s,o){var a=geByClass1("_audio_section__"+t,this._els.sections);a&&re(a)}var r=se('<div class="audio_section _audio_section _audio_section__'+t+" audio_section__"+t+' clear_fix audio_w_covers">'+i+"</div>");this._els.sections.appendChild(r),delete this._currentSection,this.showSection(t,e,!1)},onFail:()=>!0}),delete this._sectionData}else(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__.isFunction)(e)&&e()},AudioPage.prototype._onSectionOut=function(t){t?(this._onSectionOutCbs=this._onSectionOutCbs?this._onSectionOutCbs:[],this._onSectionOutCbs.push(t)):(each(this._onSectionOutCbs||[],(function(t,e){e()})),this._onSectionOutCbs=[])},AudioPage.prototype.onPlaylistsReorder=function(t,e,i){var o=domData(t,"raw-id"),s=domData(i,"raw-id");ajax.post("al_audio.php",{act:"reorder_playlist",owner_id:this.getOwnerId(),playlist_id:o.split("_")[1],prev_playlist_id:s?s.split("_")[1]:0,hash:this._data.reorderHash},{onFail:()=>!0})},AudioPage.prototype._initSection_current=function(t,e){var i;if(extend(this._els,{audioRows:geByClass1("_audio_page__audio_rows_list",t),audioRowsMore:geByClass1("_audio_more_rows",t),friendsBlock:geByClass1("_audio_friends_list_wrap",t),friendsBlockContent:geByClass1("_audio_friends_list_content",t)}),!(i=getAudioPlayer().getCurrentPlaylist())&&!this.retriedCurrent)return this.retriedCurrent=!0,setTimeout((()=>this._initSection_current(t,e)));this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_14__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),i&&(this._pagePlaylist=i,domData(this._els.audioRows,"playlist-id",i.getId()));var o=geByClass1("_audio_friends_search",t);o&&uiSearch.init(o),this._initAudioRowsAutoList(!0),setTimeout((()=>this._initFixedFriendsBlock(t)))},AudioPage.prototype.drawMore=function(){this._audioRowsAutoList&&this._audioRowsAutoList.drawMore()},AudioPage.prototype.scrollIntoView=function(t,e){this._scroll.scrollIntoView(t,e)},AudioPage.prototype._initSection_podcast=function(t,e){extend(this._els,{audioRows:geByClass1("_audio_page__audio_rows_list",t),audioRowsMore:geByClass1("podcast_episodes_more",t)});var i=getAudioPlayer().getCurrentPlaylist();if(!i){var o=e.playlistData;o&&((i=getAudioPlayer().getPlaylist(o.type,o.ownerId,o.id)).getAudiosCount()||(i.mergeWith(o),i.load()))}i&&(this._pagePlaylist=i,domData(this._els.audioRows,"playlist-id",i.getId())),this._initAudioRowsAutoList(),this._data.reverse||this._enableAudioRowsSorter()},AudioPage.prototype.setPagePlaylist=function(t){this._pagePlaylist=t},AudioPage.prototype.getSortedList=function(){return this._sortedList},AudioPage.prototype.clearSortedList=function(){this._sortedList=null},AudioPage.prototype.shuffleAudioPage=function(){if(!this.isPodcastPage()){var t=this.getPageCurrentPlaylist(),e=domData(this._els.audioRows,"audio-context");t.loadAll(function(){this._sortedList=[].concat(t.getUnshuffledAudiosList()),this._sortedList.fullId=t.getFullId(),(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_20__.shuffle)(this._sortedList);var i=new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_TEMP,t.getOwnerId(),t.getAlbumId());i.mergeWith({list:this._sortedList}),getAudioPlayer().play(i.getAudioAt(0),i,e),this._disableAudioRowsSorter(),this._initAudioRowsAutoList(),this._sortDD&&this._sortDD.select("random",!0)}.bind(this)),statlogsValueEvent("audio_sort_stat","audio_sort","shuffle_page",this.isLayer()?"layer":"page")}},AudioPage.prototype._initFixedFriendsBlock=function(){if(this._els.friendsBlock){this._isFixed=!1,this._isDraggable=!1,this._initialPos=getXY(this._els.friendsBlock);var t=this.isLayer(),e=getSize("page_header")[1],i=getSize(this._els.playerWrap)[1],o=t?13:15;this._fixedThreshold=t?e+i+o:this._initialPos[1]-e-i-o;var s=t?this._scroll.scroller:window;if(!(this._fixedThreshold<0)){addEvent(window,"resize",this._resizeHandler=()=>{this._initialPos=getXY(this._els.friendsBlock)}),addEvent(s,"scroll",this._scrollHandler=()=>{this._moveFriendsBlock()});var a=this;AudioPage.onUpdateDraggablePosition=()=>{a._isDraggable=!0,a._moveFriendsBlock(),requestAnimationFrame((()=>a._isDraggable=!1))},AudioPage.forceFix=()=>{var t=a._els.friendsBlockContent.getBoundingClientRect();if(t.width>0&&t.height>0){var e=a.isLayer()?a._scroll.scroller.scrollTop:scrollGetY();a._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,e-a._fixedThreshold-9)}px)`,a._unfixedFriendsBlock()}},this._onSectionOut((()=>{this._scrollHandler&&removeEvent(s,"scroll",this._scrollHandler),this._resizeHandler&&removeEvent(window,"resize",this._resizeHandler),this._fixedBlockScrollHandler&&removeEvent(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler),removeClass(this._els.friendsBlockContent,"audio_friends_fixed")}))}}},AudioPage.prototype._moveFriendsBlock=function(){var t=this.isLayer()?this._scroll.scroller.scrollTop:scrollGetY(),e=this._els.friendsBlockContent.getBoundingClientRect(),i=e.width>0&&e.height>0;this._isDraggable&&i?(this._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,t-this._fixedThreshold-9)}px)`,this._unfixedFriendsBlock()):(this._els.friendsBlockContent.style.transform="",t>this._fixedThreshold?this._fixedFriendsBlock():this._unfixedFriendsBlock())},AudioPage.prototype._fixedFriendsBlock=function(){this._isFixed||(this._initialPos=getXY(this._els.friendsBlock),addClass(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!0,this.isLayer()&&(this._fixedBlockScrollHandler=addEvent(this._els.friendsBlockContent,"mousewheel",(t=>(this._scroll.scroller.scrollTop=this._scroll.scroller.scrollTop+t.deltaY,cancelEvent(t))))))},AudioPage.prototype._unfixedFriendsBlock=function(){this._isFixed&&(removeClass(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!1,this._fixedBlockScrollHandler&&removeEvent(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler))},AudioPage.prototype.playPlaylist=function(t,e,i,o){var s=getAudioPlayer(),a=s.getCurrentPlaylist(),r=s.getPlaylist(t,e,i);a&&a.equals(r)&&s.isPlaying()?s.pause():r.load(0,(function(){s.play(r.getAudiosList()[0],r,o)}))},AudioPage.prototype.playShuffledBlockPlaylist=function(t){var e=getAudioPlayer(),i=e.getPlaylistByBlockId(t)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist({hasMore:!0,blockId:t});i.clean(),i.loadByBlockId("",(function(t){e.play(t.getAudiosList()[0],t,t.getContext())}))},AudioPage.prototype.playBlockPlaylist=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=getAudioPlayer(),o=i.getCurrentPlaylist(),s=i.getPlaylistByBlockId(t)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist({hasMore:!0,blockId:t});if(o&&o.equals(s)&&i.isPlaying())i.pause();else{var a=s.getContext()||e&&e.dataset.context||"";s.loadByBlockId("",(t=>i.play(t.getAudiosList()[0],t,a)))}},AudioPage.prototype.onAudioRowsReorder=function(t,e,i,o){var s,a=getAudioPlayer(),r=domData(e,"full-id"),l=domData(o,"full-id"),n=t?a.getCurrentPlaylist():this.getPageCurrentPlaylist(),_=n.indexOfAudio(r);l?(s=n.indexOfAudio(l),s++):s=0,n.moveAudio(_,s),t&&a.saveStateCurrentPlaylist(),this.isPodcastPage()?ajax.post("al_podcasts.php",{act:"a_reorder_episodes",hash:this._data.audiosReorderHash,oid:this.getOwnerId(),episode_id:r?r.split("_")[1]:0,next_episode_id:l?l.split("_")[1]:0},{onFail:()=>!0}):t||ajax.post("al_audio.php",{act:"reorder_audios",hash:this._data.audiosReorderHash,owner_id:this.getOwnerId(),audio_id:r?r.split("_")[1]:0,next_audio_id:l?l.split("_")[1]:0},{onFail:()=>!0})},AudioPage.prototype._enableAudioRowsSorter=function(t){(this._data.audiosReorderHash||t)&&(this._audioRowsSorter&&this._audioRowsSorter.destroy(),this._audioRowsSorter=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_21__.default(this._els.audioRows,"",{wrapNode:this.isLayer()?this._scroll.scroller:void 0,onReorder:(e,i,o)=>this.onAudioRowsReorder(t,e,i,o)}),this._onSectionOut(function(){this._audioRowsSorter&&this._audioRowsSorter.destroy()}.bind(this)))},AudioPage.prototype._disableAudioRowsSorter=function(){this._audioRowsSorter&&this._audioRowsSorter.disable()},AudioPage.prototype._initAudioRowsAutoList=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._els.audioRows){var e=this.isPodcastPage()||"podcast"===this._currentSection,i=this._pagePlaylist;this._els.audioRows.innerHTML="",toggleClass(this._els.audioRows,"audio_owner_list_canedit",!e&&!!this._data.canEdit),this._audioRowsAutoList&&this._audioRowsAutoList.destroy(),this._audioRowsAutoList=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_11__.default(this._els.audioRows,{scrollNode:!!this._scroll&&this._scroll.scroller,onRendered:function(){getAudioPlayer().updateCurrentPlaying()},onNoMore:function(){hide(this._els.audioRowsMore)}.bind(this),onNeedRows:function(o,s,a,r,l){var n=[];e?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.lockButton)(this._els.audioRowsMore),this._loadPodcastEpisodes(s,function(t){(t||[]).slice(s).forEach((function(t){n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.drawAudio(t))})),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.unlockButton)(this._els.audioRowsMore),o(n)}.bind(this))):i&&i.load(s,(()=>{var e;e=t?((e=i.getAudiosList())||[]).map((t=>{if(t[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_27__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]){var e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_28__.clone)(t);return e[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_27__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,e}return t})):this._sortedList&&this._sortedList.fullId===i.getFullId()?this._sortedList:i.getUnshuffledAudiosList();for(var a=s;a<s+30&&e[a];a++)n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.drawAudio(e[a]));o(n),0===s&&this._audioRowsSorter&&this._audioRowsSorter.update(),0===s&&1===n.length&&l.drawMore()}))}.bind(this)}),this._onSectionOut(function(){this._audioRowsAutoList.destroy(),this._els.audioRows.innerHTML=""}.bind(this))}},AudioPage.prototype._loadPodcastEpisodes=function(t,e){var i,o=getAudioPlayer().getCurrentAudio()||this._readyAudio;i=this.isPodcastPage()?this._ownerId:o[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],cur._podcastsEpisodes=cur._podcastsEpisodes||{},cur._podcastsEpisodes[i]=cur._podcastsEpisodes[i]||[];var s=cur._podcastsEpisodes[i];s.length&&t<s.length?e(s):ajax.post("al_podcasts.php",{act:"a_episodes",oid:i,episode_full_id:o?o[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+o[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_ID]:"",offset:t,rev:this._data.reverse},{onDone:function(t){cur._podcastsEpisodes[i]=s.concat(t||[]),e(cur._podcastsEpisodes[i])},onFail:function(){return e(cur._podcastsEpisodes[i]),!0}})},AudioPage.showAttachBox=function(t,e){curBox()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(geByClass1("_ape_item_list",curBox().bodyNode),"offset")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(geByClass1("_ape_item_list",curBox().bodyNode),"offset",0),1===vk.widget?showBox("al_audio.php",{act:"choose_box",owner_id:t,options:JSON.stringify(e)}):AudioPage.editPlaylist(t,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",e)},AudioPage.editPlaylist=function(t,e,i,o){if(vk.widget)for(var s in o)o.hasOwnProperty(s)&&(isString(o[s])?o[s]=clean(o[s]):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__.isFunction)(o[s])?delete o[s]:o[s]=intval(o[s]));var a,r;if("edit"===i&&o&&(o.audioAttachSwitchOwnerId=!1),o&&o.audioAttachSwitchOwnerId&&(cur.audioAttachSwitchOwnerId=o.audioAttachSwitchOwnerId),i=i||"edit",e)a=getAudioPlayer().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,t,e);else if(cur.audioPage){var l=cur.audioPage._data.maxPlaylistsCount;if(isArray(cur.audioPage._data.playlists)&&cur.audioPage._data.playlists.length>=l){var n=langNumeric(l,cur.lang.audio_playlists_limit_error).replace("{limit}",l);return void new MessageBox({title:getLang("global_error")}).content(n).setButtons("Ok",(function(){curBox().hide()})).show()}}show(boxLoader),show(boxLayerWrap),boxRefreshCoords(boxLoader),(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_20__.parallel)((t=>{stManager.add(["audio.css",jsc("web/indexer.js"),jsc("web/auto_list.js"),jsc("web/grid_sorter.js"),"edit"===i&&jsc("web/upload.js")],t)}),(t=>{a?a.loadAll(t,i):t()}),(e=>{cur.audioPage&&cur.audioPage.getOwnerId()===+t&&(r=cur.audioPage.getOwnerPlaylists()),r?e():AudioPage.loadPlaylists(t,void 0,!1,"attach"===i,(t=>{r=t,e()}))}),(()=>{AudioPage._openEditPlaylist(i,t,e,r,o)}))},AudioPage.initBoxEls=function(t){return{boxContent:geByClass1("_audio_pl_edit_box",t.bodyNode),playlistNameInput:geByClass1("ape_pl_input",geByClass1("ape_pl_title",t.bodyNode)),playlistDescriptionInput:geByClass1("ape_pl_input",geByClass1("ape_pl_description",t.bodyNode)),playlistDiscoverToggle:geByClass1("ape_discover_checkbox",geByClass1("ape_pl_discover",t.bodyNode)),playlistUpdateIdInput:t.bodyNode.querySelector("#ape_pl_to_update_id"),playlistUpdateTimeInput:t.bodyNode.querySelector("#ape_pl_to_update_time"),playlistUpdateCutInput:t.bodyNode.querySelector("#ape_pl_to_update_cut"),playlistUpdateFilterInput:t.bodyNode.querySelector("#ape_pl_to_update_filter"),stat:geByClass1("_ape_pl_stat",t.bodyNode),uploadCoverButtonWrapper:geByClass1("_ape_cover",t.bodyNode),uploadCoverInput:geByClass1("_ape_cover_upload",t.bodyNode),errorMsg:geByClass1("_ape_error_msg",t.bodyNode),header:geByClass1("_ape_header",t.bodyNode),search:geByClass1("_ape_search",t.bodyNode),searchInput:geByClass1("_field",t.bodyNode),addAudiosButton:geByClass1("ape_add_audios_btn",t.bodyNode),addAudiosFromPlaylistsButton:geByClass1("ape_add_pl_audios_btn",t.bodyNode),listWrap:geByClass1("_ape_list_wrap",t.bodyNode),list:geByClass1("_ape_item_list",t.bodyNode),globalResults:geByClass1("_ape_item_global_results",t.bodyNode),globalResultsList:geByClass1("_ape_item_global_list",t.bodyNode),emptyPlaceholder:geByClass1("_ape_audios_empty_list",t.bodyNode),emptyPlaylistsPlaceholder:geByClass1("_ape_audios_empty_playlists_list",t.bodyNode),emptyGlobalPlaceholder:geByClass1("_ape_audios_empty_global_list",t.bodyNode)}},AudioPage.showRecomsOnboarding=function(){show(boxLoader),show(boxLayerWrap),boxRefreshCoords(boxLoader),ajax.post("al_audio.php?act=get_recoms_onboarding",{},{onDone:t=>{(hide(boxLoader),hide(boxLayerWrap),t)&&(window.AudioRecomsOnboarding&&new window.AudioRecomsOnboarding(t)).show()}})},AudioPage._openEditPlaylist=function(t,e,i,o,s){var a,r,l,n,_,d,u,h=getAudioPlayer(),c=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_TEMP,e,irand(0,999999));if(curBox()){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(geByClass1("_ape_item_list",curBox().bodyNode),"offset"),d=val("ape_edit_playlist_search");var p=geByClass1("_ape_item_list",curBox().bodyNode);p&&(u=p.scrollTop)}hide(boxLoader),curBox()||hide(boxLayerWrap),cur.apLayer&&(n=cur.apLayerPlaylistId,layers.fullhide()),s=extend({audioPickerButtonText:getLang("global_add_media"),playlistPickerButtonText:getLang("audio_attach_playlist_button"),canPlaylistAttach:!1,onAudioChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.onAudioChoose,onPlaylistChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.onPlaylistChoose},s),cur.onChooseAudio=s.onAudioChoose,cur.onChoosePlaylist=s.onPlaylistChoose;var g,y=!i||i===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID,f="attach"===t,E=!1,v=!1,m=!1,P=!1,b=0,w=null,C=!0,A=!1;o=o.filter((t=>t.id!==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID&&t.size>0));var D=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_19__.vkIndexer(o,(t=>t.title)),B=o.length>0,O=!1;!y||f?(O=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,e,i),c.addAudio(O.getUnshuffledAudiosList()),c.mergeWith({title:O.getTitle(),description:O.getDescription(),rawDescription:O.getRawDescription(),coverUrl:O.getCoverUrl(),editHash:O.getEditHash(),noDiscover:O.getNoDiscover()})):s.addAudio&&c.addAudio(s.addAudio);var I=f?getLang("audio_choose_audio_title"):i?getLang("audio_edit_playlist_title"):getLang("audio_new_playlist_title");function M(t){if(t=trim(t)){var e=" "+(t+"|")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.parseLatin)(t)||"")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_23__.parseCyr)(t)||"");e=trim(e.replace(/\)/g,"").replace(/&/,"&amp;")),P=new RegExp("(\\s|^)("+e.replace(_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_19__.vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}else P=!1;H(v,"playlists"!==E,t),hide(r.emptyGlobalPlaceholder)}function L(){s.onClose&&s.onClose(),C||(c.clean(),h.deletePlaylist(c),n&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.showAudioPlaylist(n[0],n[1]))}function T(e){return!(A&&!e&&"attach"!==t)||(i?(o=getLang("audio_edit_playlist_cancel_confirm_text"),s=getLang("audio_edit_playlist_cancel_confirm_yes")):(o=getLang("audio_new_playlist_remove_confirm_text"),s=getLang("audio_new_playlist_remove_confirm_continue")),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__.showFastBox)(getLang("global_warning"),o,s,(()=>{C=!1,curBox().hide(),a.hide(!0)}),getLang("global_cancel")),!1);var o,s}function S(){return trim(r.searchInput.value)}function k(e){var i=c.indexOfAudio(e)>=0?"ape_selected":"",o=e;P&&((e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_28__.clone)(o))[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(P,"$1<em>$2</em>"),e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(P,"$1<em>$2</em>"));var a="";if("edit"===t)a='<div class="ape_check"><div class="ape_check_icon"></div></div>';else{var r=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(o);if(s&&s.wiki)a='<div role="button" class="ape_attach" onclick="'+`editorChooseAudio(\n        '${clean(r.performer)}',\n        '${clean(r.title)}',\n        ${r.duration},\n        '${r.fullId}',\n        '${r.url}',\n        ${r.duration},\n        this)`+'">'+s.audioPickerButtonText+"</div>";else a=`<div role="button" class="ape_attach" onclick="cur.onChooseAudio(event, this, ${r=clean(JSON.stringify(r))}, ${clean(JSON.stringify(o))})">${s.audioPickerButtonText}</div>`}return'<div class="ape_audio_item_wrap _ape_audio_item '+i+'">'+a+_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.drawAudio(e)+"</div>"}(2===vk.widget||3===vk.widget)&&window.box&&(!boxQueue.count()&&!curBox()||cur.audioChooseBox===curBox())?(a=window.box).setOptions({title:I,bodyStyle:"padding: 0",width:560,onBeforeHide:L,onHideAttempt:T,hideButtons:!0}):(cur.audioChooseBox&&cur.audioChooseBox===curBox()&&curBox().hide(),a=new MessageBox({title:I,bodyStyle:"padding: 0",width:560,onBeforeHide:L,onHideAttempt:T})),cur.audioChooseBox=a,a.content(getTemplate("audio_edit_playlist")),a.show(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(a,"ownerId",e),r=AudioPage.initBoxEls(a),function(){var i=window.innerHeight;setStyle(r.boxContent,"height",Math.min(800,Math.max(i-200,500))),addEvent(r.addAudiosFromPlaylistsButton,"click",q.bind(this,"playlists")),addEvent(r.addAudiosButton,"click",q.bind(this,"default")),addEvent(r.list,"click",Y),f&&domData(r.list,"audio-context","attach");addEvent(a.titleWrap,"click",(function(t){hasClass(t.target,"_back")&&function(){switch(E){case"initial":break;case"default":q("initial");break;case"playlists":q("default");break;case"playlist":q("playlists")}}()})),uiSearch.init("ape_edit_playlist_search",{onChange:M}),"edit"===t&&(q("initial"),j(),function(){if(!cur.audioCoverUploadOptions||!cur.audioCoverUploadOptions[e])return;var t=cur.audioCoverUploadOptions[e],i={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(t,e){show(geByClass1("_ape_cover_progress"))},onUploadComplete:function(t,e){(e=JSON.parse(e)).error?(show(r.errorMsg),K()):(hide(r.errorMsg),V((b=e).url),Q(),K()),hide(geByClass1("_ape_cover_progress"))},onUploadProgress:function(t,e,i){},onUploadError:function(t,e){hide(geByClass1("_ape_cover_progress"))},clear:1,type:"photo",max_attempts:3,server:t.server,noCheck:!0,chooseBox:!0,uploadButton:!0,accept:".jpg,.jpeg,.png",filesize_hide_last:!0,label:t.button};function o(){isObject(b)&&!isVisible(geByClass1("_ape_cover_progress"))||geByTag1("input",r.uploadCoverButtonWrapper).click()}Upload.init(r.uploadCoverButtonWrapper,t.url,t.vars,i),r.uploadCoverButton=geByClass1("ape_cover_accessibility_upload_btn",a.bodyNode),addEvent(geByClass1("_ape_cover_delete"),"click",X),addEvent(r.uploadCoverButton,"click",(()=>o())),r.coverThumb=geByClass1("_ape_cover_thumb")}(),c.getCoverUrl()&&V(c.getCoverUrl()),autosizeSetup(r.playlistDescriptionInput,{minHeight:30,maxHeight:150,onResize:K}),r.playlistNameInput.value=replaceEntities(c.getTitle()),r.playlistDescriptionInput.value=replaceEntities(c.getRawDescription().replace(/<br>/g,"\n")),r.playlistDiscoverToggle&&r.playlistDiscoverToggle.classList.toggle("on",c.getNoDiscover()),r.playlistNameInput.addEventListener("input",Q),r.playlistDescriptionInput.addEventListener("input",Q),r.playlistDiscoverToggle&&r.playlistDiscoverToggle.addEventListener("click",Q),r.playlistUpdateIdInput&&cur.editorialPlaylistsParams&&(r.playlistUpdateIdInput.value=cur.editorialPlaylistsParams.target_playlist,r.playlistUpdateTimeInput.valueAsNumber=1e3*cur.editorialPlaylistsParams.update_time-6e4*(new Date).getTimezoneOffset(),r.playlistUpdateCutInput.valueAsNumber=cur.editorialPlaylistsParams.update_cut,r.playlistUpdateFilterInput.classList.toggle("on",1===cur.editorialPlaylistsParams.update_filter),r.playlistUpdateFilterInput.setAttribute("aria-checked",1===cur.editorialPlaylistsParams.update_filter),r.playlistUpdateIdInput.addEventListener("input",Q),r.playlistUpdateTimeInput.addEventListener("input",Q),r.playlistUpdateCutInput.addEventListener("input",Q),r.playlistUpdateFilterInput.addEventListener("click",Q)));f&&q("default");W(),O&&"attach"!==t&&a.setControlsText(`<a onclick="AudioPage.deletePlaylist(${O.getOwnerId()}, ${O.getPlaylistId()}, '${O.getEditHash()}')">\n                              ${getLang("audio_delete_playlist")}\n                            </a>`)}(a.bodyNode),d&&val(r.searchInput,d),U();var R=0;function U(){clearTimeout(R);var t=S();t&&(R=setTimeout((function(){R=!1,(m=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_20__.hashCode)(t+"no conflict"))).mergeWith({searchParams:{globalQuery:t},hasMore:!0});var e=0;l&&(e=l.getOffset(),l.destroy()),(l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_11__.default(r.list,{scrollNode:r.list,onNeedRows:function(t,i){i-=e,m.load(i,(function(){var e=[],o=m.getAudiosList();if(0==+i&&o.length&&e.push('<div class="ape_list_header">'+getLang("audio_edit_playlist_global_results")+"<div>"),o.length)for(var s=Math.min(o.length,i+20),a=i;a<s;a++)e.push(k(o[a]));m.getAudiosCount()||l&&l._offset?(hide(r.emptyGlobalPlaceholder),show(r.list)):(show(r.emptyGlobalPlaceholder),hide(r.list)),t(e)}))}})).drawMore()}),300),w=null)}function x(){a.setOptions({title:'<div class="back _back"><span class="back__icon">'+(0,_icons_desktop_getIcon24ChevronLeft__WEBPACK_IMPORTED_MODULE_31__.getIcon24ChevronLeft)().icon+"</span>"+getLang("global_back")+"</div>",bodyStyle:"padding: 0"})}function W(){var t="";cur.audioAttachSwitchOwnerId&&cur.audioAttachOriginalOwnerId&&(t='<span class="dvd"></span><a class="tab_link" onclick="cur.audioAttachSwitch()">',t+=getLang(c.getOwnerId()<0?"audio_choose_wall_to_my_audios":"audio_choose_wall_to_group_audios"),c.getOwnerId()===cur.audioAttachOriginalOwnerId?cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachSwitchOwnerId,s)}:cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachOriginalOwnerId,s)},t+="</a>"),a.setOptions({title:I+t,bodyStyle:"padding: 0"})}function K(){var t=r.boxContent.getBoundingClientRect();if(t.height&&t.width){var e=r.list.getBoundingClientRect();setStyle(r.list,{height:t.height-(e.y-t.y)})}}function H(t,e,i){v=t,e?i?t.search({q:i},(function(t){F(!0,t)})):F(!0,t.getUnshuffledAudiosList(),t):F(!1,i?D.search(i):o),z("initial"===E&&!i)}function F(t,e,i){r.list.innerHTML="",l&&l.destroy(),show(r.list),hide(r.emptyPlaceholder),hide(r.emptyGlobalPlaceholder),hide(r.emptyPlaylistsPlaceholder),K();var o=0;l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_11__.default(r.list,{scrollNode:r.list,onNoMore:function(){0===o&&(S()?t||(hide(r.list),show(r.emptyPlaylistsPlaceholder)):(hide(r.list),show(r.emptyPlaceholder))),t&&U()},onNeedRows:function(s,a){var r=_||20,l=i&&i.hasMore()?a+r:Math.min(e.length,a+r);if(l>e.length&&i&&i.hasMore())i.load(a+r,(r=>{var n=N((e=(i=r).getUnshuffledAudiosList()).slice(a,l),t);o+=n.length,s(n)}));else{var n=N(e.slice(a,l),t);o+=n.length,s(n)}},onRendered:t=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(r.list,"offset",t),u&&_&&(r.list.scrollTop=u,_=0,u=0)}})}function N(t,e){return t.map((t=>{if(e)return k(t);var i='<div class="ape_pl_item_inner"><span class="ape_pl_title">'+(P?t.title.replace(P,"$1<em>$2</em>"):t.title)+'</span> <span class="ape_pl_size">'+langNumeric(t.size,cur.lang.audio_playlist_audios_count,!0).replace("{count}",t.size)+"</span></div>";return`<div class="ape_pl_item"\n                        data-playlist-access-hash="${t.access_hash}"\n                        data-playlist-owner-id="${t.owner_id}"\n                        data-playlist-id="${t.id}">\n                          ${i}\n                        </div>`}))}function z(t){g||(g=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_21__.default(r.list,"ape_audio_item_wrap",{wrapNode:r.list,onReorder:function(t,e){var i,o=domData(geByClass1("_audio_row",t),"full-id"),s=c.indexOfAudio(o);e?(o=domData(geByClass1("_audio_row",e),"full-id"),i=c.indexOfAudio(o)):i=c.getAudiosCount(),c.moveAudio(s,i)}})),t?g.enable():g.disable()}function q(i,l){if("default"===i&&cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__.showFastBox)({title:getLang("global_error")},cur.audioPage._data.addBannedText);else{switch(E=i,a.removeButtons(),domData(r.list,"view",i),i){case"initial":show(r.header),hide(r.addAudiosFromPlaylistsButton),show(r.addAudiosButton),show(r.search),hide(r.globalResults),H(c,!0),G(),W();break;case"default":var n=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,e,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.disableEl)(r.addAudiosButton),showProgress(r.addAudiosButton),n.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.enableEl)(r.addAudiosButton),hideProgress(r.addAudiosButton),hide(r.header),show(r.search),toggle(r.addAudiosFromPlaylistsButton,B),hide(r.addAudiosButton),"edit"===t?x():W(),H(n,!0,d),K(),"edit"===t&&G()}));break;case"playlists":hide(r.header),show(r.search),hide(r.addAudiosFromPlaylistsButton),hide(r.addAudiosButton),hide(r.globalResults),x(),H(o);break;case"playlist":hide(r.header),show(r.search),hide(r.addAudiosFromPlaylistsButton),hide(r.addAudiosButton),x(),H(l,!0),f&&function(t){if(!s.canPlaylistAttach)return;function e(e){cur.onChoosePlaylist(e,t)}a.addButton(s.playlistPickerButtonText,e,"ok",!0)}(l),"edit"===t&&G()}K(),r.searchInput.value="",elfocus(r.searchInput),P=!1,w=null,clearTimeout(R),h&&h.updateCurrentPlaying&&h.updateCurrentPlaying()}}function G(){a.addButton(getLang("audio_save_playlist_button"),$,"ok",!0)}function Y(t){var e=domClosest("ape_pl_item",t.target);if(e){var i=domData(e,"playlist-id"),o=domData(e,"playlist-owner-id"),s=domData(e,"playlist-access-hash"),a=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,o,i,s);showProgress(e),a.load((function(){hideProgress(e),q("playlist",a)}))}if(hasClass(t.target,"ape_check")){function l(t,e){if(cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__.showFastBox)({title:getLang("global_error")},cur.audioPage._data.addBannedText);else{var i=toggleClass(t,"ape_selected",e),o=geByClass1("_audio_row",t),s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAudioFromEl(o);i?c.addAudio(s,0):c.removeAudio(s)}}var n=domClosest("_ape_audio_item",t.target);if(t.shiftKey&&w){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.domChildIndex)(w),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.domChildIndex)(n),u=domPN(n);if(_>d){var p=d;d=_,_=p}for(var g=hasClass(w,"ape_selected"),y=_;y<=d;y++)l(u.children[y],g)}else l(n),w=n;j(),Q()}if(f&&hasClass(t.target,"artist_link")){if(t.metaKey&&browser.mac||t.ctrlKey)return;var E=domData(t.target,"performer")||trim(t.target.innerText);E&&(val(r.searchInput,E),uiSearch.onChanged(r.searchInput),M(E))}return cancelEvent(t)}function j(){var t,e=c.getAudiosCount(),i=c.getTotalDuration();if(e){var o;t=(t=langNumeric(e,cur.lang.audio_edit_playlist_audios_info)).replace("{count}",e);var s=i%60,a=Math.floor(i/60)%60,l=Math.floor(i/3600);i<60?o=langNumeric(i,cur.lang.audio_total_dur_seconds):i<3600?(o=langNumeric(a,cur.lang.audio_total_dur_minutes),s&&(o+=" "+langNumeric(s,cur.lang.audio_total_dur_seconds))):(o=langNumeric(l,cur.lang.audio_total_dur_hours),a&&(o+=" "+langNumeric(a,cur.lang.audio_total_dur_minutes))),t+='<span class="dvd">'+o+"</span>"}else t=getLang("audio_edit_playlist_no_audios");r.stat.innerHTML=t}function $(t){var i=trim(val(r.playlistNameInput)),o=trim(val(r.playlistDescriptionInput)),l=+(r.playlistDiscoverToggle&&r.playlistDiscoverToggle.classList.contains("on"));if(r.playlistUpdateIdInput&&(i=`${trim(r.playlistUpdateIdInput.value)}_${r.playlistUpdateTimeInput.valueAsNumber}_${r.playlistUpdateCutInput.valueAsNumber}`),!i)return q("initial"),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.notaBene)(ge("ape_pl_name"));var n=[];each(c.getUnshuffledAudiosList(),(function(t,e){n.push(e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_ID]+"_"+e[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_27__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY])}));var _=s.newPlaylistHash||cur.audioPage&&cur.audioPage._data.newPlaylistHash||"",d={hash:y?_:O.getEditHash(),owner_id:e,playlist_id:y?0:O.getPlaylistId(),title:i,description:o,Audios:n.join(","),cover:isObject(b)?JSON.stringify(b):b};r.playlistUpdateIdInput&&(d.update_id=trim(r.playlistUpdateIdInput.value),d.update_time=(r.playlistUpdateTimeInput.valueAsNumber+6e4*(new Date).getTimezoneOffset())/1e3,d.update_cut=r.playlistUpdateCutInput.valueAsNumber,d.update_filter=r.playlistUpdateFilterInput.classList.contains("on")?1:0),null!==l&&(d.no_discover=l),ajax.post("al_audio.php?act=save_playlist",d,{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.lockButton)(t),onDone:(t,i)=>{y&&!document.querySelector(".CatalogSection ._audio_page__playlists")?nav.reload():(each(geByClass("_audio_pl_"+t.ownerId+"_"+t.id),(function(){var e=geByClass1("audio_pl__cover",this);if(e){setStyle(e,"background-image",t.coverUrl?"url("+t.coverUrl+")":null),setStyle(e,"background-size",t.coverUrl?"cover":null);var i=geByClass1("_audio_pl_grid_covers_wrap",this);i&&(i.innerHTML=t.coverUrl?"":t.gridCovers)}var o=geByClass1("audio_pl__title",this);if(o){var s=geByClass1("audio_item__title",o);s?val(s,t.title):val(o,t.title)}var a=geByClass1("_audio_pl__stats_count",this);a&&(a.innerHTML=t.totalCount)})),y&&cur.audioPage&&e==cur.audioPage.getOwnerId()&&["all","my_playlists"].includes(cur.audioPage._currentSection)&&(each(geByClass("_audio_page_block__playlists_items",cur.audioPage._els.pageContainer),(function(){var t=se(getTemplate("audio_pl_item",i)),e=this;e.insertBefore(t,e.firstChild);var o=intval(domData(e,"max-items"));o&&e.children.length>o&&e.removeChild(e.lastChild),show(gpeByClass("_audio_page__playlists",e))})),cur.audioPage._data.playlists=cur.audioPage._data.playlists||[],cur.audioPage._data.playlists.unshift(i)),y&&cur.audioPage&&cur.audioPage.catalogController.updateSectionReorder(),cur.audioPage&&cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(e),O&&(O.clean(),O.mergeWith(t)),a.hide(!0),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_13__.isFunction)(s.onPlaylistSave)&&s.onPlaylistSave(O))},onFail:()=>(a.hide(!0),!0)})}function V(t){show(r.coverThumb),setStyle(r.coverThumb,"background-image","url("+t+")"),addClass(r.uploadCoverButtonWrapper,"ape_thumb_set"),hide(r.uploadCoverButton)}function X(t){return removeClass(r.uploadCoverButtonWrapper,"ape_thumb_set"),hide(geByClass1("_ape_cover_thumb")),show(r.uploadCoverButton),b=-1,cancelEvent(t)}function Q(){A=!0}},AudioPage.prototype._deinitKeyEvents=function(){this._audioHQKeyEventHandler1&&removeEvent(window.document,"keydown",this._audioHQKeyEventHandler1),this._audioHQKeyEventHandler2&&removeEvent(window.document,"keyup",this._audioHQKeyEventHandler2),this._audioHQKeyEventHandler3&&removeEvent(window.document,"visibilitychange",this._audioHQKeyEventHandler3),this._audioHQKeyEventHandler4&&removeEvent(window.document,"mousedown",this._audioHQKeyEventHandler4),this._audioSeekKeyEventHandler&&removeEvent(window.document,"keydown",this._audioSeekKeyEventHandler)},AudioPage.prototype._initKeyEvents=function(){this._deinitKeyEvents();var t=getAudioPlayer(),e=()=>!this.isLayer()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getLayer().isShown();addEvent(window.document,"mousedown",this._audioHQKeyEventHandler4=function(t){t.ctrlKey&&(cur.ctrlMouseDown=!0,cur.ctrlPressed=!1)},!0),addEvent(window.document,"keydown",this._audioHQKeyEventHandler1=function(t){e()||(cur.ctrlPressed=t.keyCode===KEY.CTRL)}),addEvent(window.document,"keyup",this._audioHQKeyEventHandler2=function(t){e()||(t.keyCode!==KEY.CTRL||cur.ctrlMouseDown)&&(delete cur.ctrlMouseDown,delete cur.ctrlPressed)}),addEvent(window.document,"keydown",this._audioSeekKeyEventHandler=function(i){var o=i.target,s=o&&inArray(o.tagName.toLowerCase(),["input","textarea"])&&""!==val(o),a=o&&o.isContentEditable,r=cur&&cur.pvShown;s||a||r||e()||!t.isPlaying()||!inArray(i.keyCode,[KEY.RIGHT,KEY.LEFT])||cur.wallLayer||i.ctrlKey||t.seekCurrentAudio(i.keyCode===KEY.RIGHT)}),cur.destroy.push((()=>this._deinitKeyEvents()))},AudioPage.prototype.editFeed=function(){var t=this;showTabbedBox("al_settings.php",{act:"a_edit_owners_list",list:"audio",height:lastWindowHeight},{stat:[jsc("web/privacy.js"),"privacy.css","ui_controls.js","ui_controls.css",jsc("web/indexer.js")],dark:1}),cur.onOListSave=function(e,i,o,s){var a=curBox(),r={act:"a_ignore_olist",hash:s.hash};return e.length<i.length?r.White=e.join(","):r.Black=i.join(","),ajax.post("al_audio.php",r,{onDone:function(){a.hide(),t.getCurrentPlaylist().clean(),t.refreshCurrentPage()},onFail:()=>!0,showProgress:a.showProgress,hiderogress:a.hideProgress}),!1}},AudioPage.prototype.updateStatusExportControls=function(t){var e=getAudioPlayer(),i=e.getStatusExportInfo();each(geByClass("_audio_export_status",this._els.pageContainer),(function(){toggleClass(this,"on",i&&!!i[domData(this,"oid")])}));var o=e.hasStatusExport(),s=geByClass1("_audio_page_player_status",this._els.pageContainer);if(toggleClass(s,"audio_page_player_btn_enabled",o),!t)if(this.isLayer())cur.audioPage&&cur.audioPage.updateStatusExportControls(!0);else{var a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getLayer().getPageInstance();a&&a.updateStatusExportControls(!0)}return!1},AudioPage.prototype.updateStatusExport=function(t,e){t&&checkbox(t),e=intval(e);var i,o,s=getAudioPlayer(),a=s.getStatusExportInfo()||{};if(e)a[e]?(delete a[e],i=!1):(a[e]=1,i=!0);else if(s.hasStatusExport()){for(var r in a)a.hasOwnProperty(r)&&delete a[r];i=!1}else a[e=vk.id]=1,i=!0;s.setStatusExportInfo(a),e!=vk.id&&e||checkbox("currinfo_audio",s.hasStatusExport()),this.updateStatusExportControls();var l=s.getCurrentAudio();l&&(o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(l).fullId);var n=null;s.stats.sendCurrentAudioEvent({type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_9__.TYPE_BROADCASTING,subtype:i?_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_9__.SUBTYPE_ON:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_9__.SUBTYPE_OFF,targetOwnerId:e}),ajax.post("al_audio.php?act=toggle_status",{exp:intval(i),oid:e,hash:vk.statusExportHash,id:o,top:intval(n)},{onFail:()=>!0})},AudioPage.prototype.playStatusAudio=function(t,e,i){var o=gpeByClass("_audio_friend",i);getAudioPlayer().playLive(t,{showProgress:showProgress.pbind(o),hideProgress:hideProgress.pbind(o)}),cancelEvent(e)},AudioPage.showActionTooltip=function(t,e){var i=[3,-8,0],o=currentAudioPage(t),s=o&&o.isLayer();hasClass(t,"_audio_page_player_add")?(0,_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_24__.audioShowActionTooltip)(t,i,s):(hasClass(t,"_audio_page_player_play_rate")&&(i[0]=-17),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_25__.showTooltip)(t,{text:e,black:1,shift:i,appendParentCls:"_audio_page_player",forcetodown:s,needLeft:s}))},AudioPage.prototype.onHide=function(){var t=this;cur.nav=cur.nav.filter((function(e){return t._nav_func!=e})),this._deinitKeyEvents()},AudioPage.prototype.showRecoms=function(t,e){if(!e){var i=this._readyAudio?this._readyAudio:getAudioPlayer().getCurrentAudio();e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(i).fullId}statlogsValueEvent("audio_recoms_by_track_button_click",!0),nav.go({0:"audio",section:"recoms_audio",audio_id:e},null,{nocur:!0})},AudioPage.prototype.onAudioUploaded=function(t,e){if(e){var i=getAudioPlayer(),o=i.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID);o.addAudio(e,0);var s=i.getCurrentPlaylist();s&&s.getSelf()==o&&s.addAudio(e),"all"!==this._currentSection&&this.resetSection("all");var a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(e);(0,_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_10__.onAdditionalEvent)(null,a,{type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_9__.TYPE_ADDED,subtype:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_9__.SUBTYPE_UPLOAD,context:"on_audio_uploaded",playlistId:o.getOwnerId()+"_"+o.getPlaylistId()});var r=5,l=this;!function t(i){--r<0||setTimeout((function(){ajax.post("al_audio.php?act=check_audio_data",{audio_owner_id:a.ownerId,audio_id:a.id},{onDone:function(o){if(o){var s=o[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_TITLE];(s=(s=s||o[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER])||o[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS])&&(getAudioPlayer().updateAudio(a.fullId,o),"all"===l._currentSection&&"audio"===cur.module&&l._initAudioRowsAutoList(),a=o),t(1.5*i)}},onFail:()=>!0})}),i)}(1e3)}},AudioPage.prototype.onAudioAllUploaded=function(){"all"===this._currentSection&&nav.reload()},AudioPage.prototype.uploadAudio=function(t){this._data.uploadBanned?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_18__.showFastBox)({title:getLang("global_error")},this._data.uploadBannedText):showBox("al_audio.php",extend(t||{},{act:"new_audio",gid:this.getOwnerId()<0?-this.getOwnerId():0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"},dark:1})},AudioPage.prototype.editAudio=function(t,e,i){return showBox("al_audio.php",{act:"edit_audio_box",aid:e},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1},dark:1}),i&&cancelEvent(i),!1},AudioPage.prototype.restoreRecommendation=function(t){var e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAudioFromEl(t,!0),i={act:"restore_recommendation",hash:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAudioExtra(e).recom.hash,audio_id:e.fullId};nav.objLoc.audio_id&&(i.recommendation_type="query"),nav.objLoc.album_id&&(i.recommendation_type="album"),ajax.post("al_audio.php",i,{onFail:()=>!0}),removeClass(t,"audio_row__deleted");var o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAddRestoreInfo(),s=o[e.fullId].removedCurrentPos,a=getAudioPlayer().getCurrentPlaylist();s>=0&&a&&a.getType()==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_RECOM&&a.addAudio(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAudioFromEl(t),s),delete o[e.fullId],_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.onRowOver(t,!1,!0)},AudioPage.isInRecentPlayed=function(t){var e=gpeByClass("_audio_playlist",t);return!(!e||!hasClass(e,"audio_recent_rows"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(e,"playlist")},AudioPage.prototype.chooseFromMyAudios=function(t){var e=!1;AudioPage.editPlaylist(vk.id,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",{audioPickerButtonText:getLang("global_add"),playlistPickerButtonText:getLang("global_add"),onClose:()=>{e&&nav.reload()},onAudioChoose:(i,o,s)=>{var a=i.ctrlKey||i.metaKey;if(ajax.post("al_audio.php?act=add",{group_id:t,audio_owner_id:s.ownerId,audio_id:s.id,hash:s.addHash},{onDone:t=>{t&&(e=!0)},onFail:()=>!0}),a)o.innerHTML=getLang("audio_choose_added"),addClass(o,"ape_added");else{e=!0;var r=window.__bq;if(r)for(;r.count();)r.hideLast()}}})},AudioPage.prototype.updateShuffleButton=function(){var t,e=getAudioPlayer().getCurrentPlaylist()||this._pagePlaylist;t=!!e&&(e.isShuffled()&&!e.isInitedSortedList()),toggleClass(geByClass1("_audio_page_player_shuffle",this._els.pageContainer),"audio_page_player_btn_enabled",t),this.isLayer()&&cur.audioPage&&cur.audioPage.updateShuffleButton()},AudioPage.prototype.togglePodcast=function(t,e){if(toggleClass(this._els.player,"audio_player_podcast",t),this._updatePlaybackRate(),!this.isPodcastPage()){this.isLayer()&&toggleClass(geByClass1("_audio_section_tab__current",this._els.pageContainer),"unshown",t||!getAudioPlayer().getCurrentPlaylist());var i=geByClass1("_audio_section_tab__podcast",this._els.pageContainer);toggle(i,t),i&&t&&(e=e||getAudioPlayer().getCurrentAudio(),attr(geByClass1("ui_tab",i),"href","podcasts"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]))}},AudioPage.prototype.updateFaveButton=function(){var t=getAudioPlayer().getCurrentFaveStatus(),e=geByClass1("audio_page_player_fave",this._els.player);e&&toggleClass(e,"activated",t)},AudioPage.prototype.toggleRepeat=function(){if(!this.isPodcastPage()){var t=getAudioPlayer();t.isRepeatAll()||t.isRepeatCurrentAudio()?t.toggleRepeatCurrentAudio():t.toggleRepeatAll(),this.updateRepeatButton()}},AudioPage.prototype.updateRepeatButton=function(){var t=geByClass("_audio_page_player_repeat");if(t&&t.length){var e=getAudioPlayer(),i=e.isRepeatAll(),o=e.isRepeatCurrentAudio();each(t,((t,e)=>{e.ariaLabel=e.ariaLabel&&AudioPage.getRepeatButtonText(),e.onmouseover=e.onmouseover&&AudioPage.showActionTooltip.bind(void 0,e,AudioPage.getRepeatButtonText),toggleClass(e,"audio_page_player_btn_enabled",i),toggleClass(e,"audio_page_player_btn_repeat_one",o)}))}},AudioPage.getRepeatButtonText=function(){var t=getAudioPlayer(),e=t.isRepeatAll(),i=t.isRepeatCurrentAudio(),o="audio_repeat_tooltip";return e?o="audio_repeat_track_tooltip":i&&(o="audio_dont_repeat_tooltip"),getLang(o)},AudioPage.prototype.toggleShuffle=function(t){if(!this.isPodcastPage()){toggleClass(t,"audio_page_player_btn_enabled")&&statlogsValueEvent("audio_sort_stat","audio_sort","shuffle_player",this.isLayer()?"layer":"page");var e=getAudioPlayer().getCurrentPlaylist()||this._pagePlaylist;e.loadAll(function(){e.isShuffled()&&e.isInitedSortedList()?(e.shuffle(0),e.shuffle(irand(1,999999))):e.isShuffled()?e.shuffle(0):e.shuffle(irand(1,999999)),"current"===this._currentSection&&this._initAudioRowsAutoList(!0);var t=getAudioPlayer().getCurrentAudio()||e.getAudioAt(0);getAudioPlayer().play(t,e),this.updateShuffleButton()}.bind(this))}},AudioPage.prototype.toggleFave=function(t){var e=getAudioPlayer().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(e)&&AudioPlayer.podcastToggleFave(t,e)},AudioPage.prototype.changePlaybackRate=function(t,e){var i=getAudioPlayer().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(i)&&(getAudioPlayer().podcastChangePlaybackRate(!!e.shiftKey),this._updatePlaybackRate())},AudioPage.prototype._updatePlaybackRate=function(){var t=geByClass1("audio_page_player_play_rate",this._els.player);t&&val(geByClass1("btn_icon",t),AudioPlayer.podcastGetPlaybackRate()+"x")},AudioPage.prototype._getCurrentSearchParams=function(){var t=window.radioBtns["audio_search_type_"+intval(this.isLayer())],e=intval(this._searchSortFilter.selectedItems()[0][0]);return{performer:t&&t.val?1:null,lyrics:hasClass(geByClass1("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:e?1:null}},AudioPage.searchAudios=function(t,e,i){currentAudioPage(this).searchAudios(t,e,i)},AudioPage.prototype.searchAudios=function(t,e,i){this.lastQuery!==t&&(this.lastQuery=t,this._muteSearch?delete this._muteSearch:(t=trim(t),nav.change(extend(this._getCurrentSearchParams(),{q:t||null}),!1,{fromSearch:!0,globalQuery:t,fromHistory:i,isLayer:this.isLayer()})))},AudioPage.prototype.onUserAction=function(t,e){var i=e.indexOfAudio(t);if(-1!=+i&&e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_SEARCH&&(!(e.getOwnerId()===vk.id&&i>=0&&i<e.getLocalFoundCount())&&e.getSearchParams())){var o=e.getSearchParams();o.globalQuery&&uiSearch.saveHistorySearch(this.searchInputEl,o.globalQuery,t.ownerId,t.id,e.getTotalCount(),e.getTotalCountHash())}},AudioPage.prototype._updateFriendsList=function(t,e,i){if(t=trim(t),this._friendSearchInProgress=!1,t){var o=geByClass1("_audio_friends_list",this._els.pageContainer),s=se('<div class="audio_friends_list _audio_friends_list" style="">'+t+"</div>");i&&(this._shownFriends=[]),domPN(o).appendChild(s),re(o)}},AudioPage.prototype.shareAudio=function(){var t=t||getAudioPlayer().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.shareAudio(!1,t)},AudioPage.prototype.showStatusTooltip=function(t){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php?act=status_tt",{},{onDone:(e,i)=>{this.statusTT=new ElementTooltip(t,{content:i,width:250,offset:[1,14],elClassWhenShown:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(t){this.sb=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_14__.default(geByClass1("audio_status_wrap",t),{global:!0})},onShow:function(){setTimeout(function(){this.statusTT.sb.update()}.bind(this),0)}.bind(this)}),cur._onStatusExportBtn&&(this.statusTT.show(),this.statusTT.sb.update())},onFail:()=>!0}))},AudioPage.prototype.isLayer=function(){return this._data.isLayer},AudioPage.prototype.isPodcastPage=function(){return!this.isLayer()&&!!this._data.podcastPage},AudioPage.prototype.destroy=function(){this._trackSlider&&this._trackSlider.destroy(),this._volumeSlider&&this._volumeSlider.destroy(),removeEvent(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getPageCurrentPlaylist=function(){return this._pagePlaylist},AudioPage.prototype.clearCurrentPlaylist=function(){if(this.isLayer()){var t=getAudioPlayer();t.deleteCurrentPlaylist(),this.updateCurrentPlayingInfo();var e=geByClass1("_audio_section_tab__current",this._els.pageContainer);addClass(e,"unshown"),"current"===this.getCurrentSection()&&(uiTabs.goTab(domFC(geByClass1("_audio_section_tab__all",this._els.pageContainer)),null,!0),this.updateShuffleButton(),this.updateCurrentPlayingInfo(),this.togglePodcast(!1)),this._initPlayer(!0);var i=t.getPlaylistsByType(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_MY).find((t=>t.getAudiosList().length)),o=i&&i.getUnshuffledAudiosList()[0];if(o&&(this._readyAudio=o,this._initPlayer(!0)),cur.audioPage){cur.audioPage._readyAudio=o,cur.audioPage._initPlayer(!0);try{var s=cur.audioPage._data.sectionData[cur.audioPage._currentSection].title;setDocumentTitle(s)}catch(t){}}this.updateLayerHeight()}},AudioPage.prototype.setTooltipTitle=function(t){if(!t.titleSet){var e=geByClass1("audio_page_player_title_performer",t),i=geByClass1("audio_page_player_title_song",t);(e.scrollWidth>e.clientWidth||i.scrollWidth>i.clientWidth)&&t.setAttribute("title",t.innerText),t.titleSet=!0}},AudioPage.prototype._initPlayer=function(t){var e=this,i=getAudioPlayer(),o=this._els.pageContainer,s=geByClass1("_audio_page_player",o),a=geByClass1("audio_page_player_title",s),r=geByClass1("audio_page_player_title_performer",s),l=geByClass1("audio_page_player_title_song",s),n=geByClass1("audio_page_player_title_song_title",s),_=geByClass1("audio_page_player_title_song_subtitle",s),d=geByClass1("audio_page_player_duration",s),u=geByClass1("_audio_page_player__cover",s),h=geByClass1("_audio_page_player_play",s),c=geByClass1("_play_blind_label",h),p=geByClass1("_audio_page_player_add",s),g=void 0;function y(t){if(i.ads.isPlaying())r.innerHTML=getLang("global_audio_ad"),setStyle(l,"display","none"),toggleClass(s,"audio_song_is_explicit",!1);else{var o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAudioPerformers(t);t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(t),setStyle(l,"display","block"),r.innerHTML=geByClass1("audio_page_player2")?o:t.performer,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(t)?n.innerHTML=`<a href="/podcast${t.fullId}" onclick="return showPodcast(this, '${t.fullId}', event, 'player');" class="audio_player_podcast_title">${t.title}</a>`:n.innerHTML=t.title,_.innerHTML=t.subTitle?t.subTitle:"",t.coverUrl_p?(setStyle(u,"background-image","url("+t.coverUrl_p+")"),setStyle(u,"background-size","cover")):(setStyle(u,"background-image",null),setStyle(u,"background-size","")),toggleClass(s,"audio_title_long_performer",t.isLongPerformer),toggleClass(s,"audio_song_is_explicit",t.isExplicit),!e.isLayer()&&i.getCurrentAudio()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(i.getCurrentAudio()).fullId==t.fullId&&(setDocumentTitle(replaceEntities(stripHTML(t.performer+" — "+t.title))),clearTimeout(window.pageSetTitleTimer)),l&&setStyle(l,"display","none"),r&&setStyle(r,"display","none"),requestAnimationFrame((()=>{var t=i.ads.isPlaying()?"none":"block";l&&setStyle(l,"display",t),r&&setStyle(r,"display","block")}))}}function f(t,e){return e=intval(e),AudioPlayer.getDurationType()&&1!=t?"-"+formatTime(Math.round(e-t*e)):formatTime(Math.round(t*e))}function E(){if(e._trackSlider){var t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(i.getCurrentAudio()||e._readyAudio);if(t){var o;o=e.getOwnerId()<0&&e.canAddToGroup()?t.ownerId!=e.getOwnerId():t.ownerId!=vk.id,g!==o&&(toggle(p,o),g=o),cur._audioAddRestoreInfo=cur._audioAddRestoreInfo||{};var s=cur._audioAddRestoreInfo[t.fullId];addClass(p,"no_transition"),toggleClass(p,"audio_player_btn_added",!(!s||"added"!=s.state)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.removeClassDelayed)(p,"no_transition"),e.updateRepeatButton()}}}if(!this._trackSlider){var v=i.ads.isPlaying()?i.ads.getCurrentProgress():i.getCurrentProgress(),m=i.ads.isPlaying()?0:i.getCurrentBuffered(),P=geByClass1("audio_page_player_track_slider",s),b=geByClass1("audio_page_player_volume_slider",s);P&&(this._trackSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_15__.default(P,{value:v,backValue:m,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:t=>{var e=i.getCurrentAudio()||this._readyAudio;return e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(e),formatTime(Math.round(t*(e?e.duration:0)))},onEndDragging:t=>{var e=i.getCurrentAudio()||this._readyAudio;(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(e))&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(e)&&i.podcastSetActionRef(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.PodcastsLogs.ACTION_SEEK,"",s),i.seek(t)}}),i.ads.isPlaying()&&(this._trackSlider.toggleAdState(!0),this.toggleRemoveAdsLink(!0))),b&&(this._volumeSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_15__.default(b,{value:i.getVolume(),size:1,hintClass:"audio_player_hint",log:!0,formatHint:t=>Math.round(100*t)+"%",onChange:t=>{i.setVolume(t)}})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.AD_DEINITED,(()=>{})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.AD_READY,(()=>{})),[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.MUSIC_PLAYLISTS_ADD].forEach((t=>i.on(this,t,(()=>this.catalogController&&this.catalogController.emitEvent(t))))),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.MUSIC_PLAYLISTS_ADD,((t,e)=>{var i=this._data,o=i.playlists,s=i.playlistsIndex;Array.isArray(o)&&o.find((t=>t.id===e.id&&t.owner_id===e.owner_id))||(o&&(o.unshift(e),s&&s.add(e)),this.updatePlaylistsCounter(vk.id))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.AD_STARTED,(()=>{this.toggleRemoveAdsLink(!0),this._trackSlider&&(this._trackSlider.toggleAdState(!0),this._trackSlider.setBackValue(0))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.AD_COMPLETED,(()=>{this.toggleRemoveAdsLink(!1),this._trackSlider&&this._trackSlider.toggleAdState(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.START_LOADING,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!0)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.CAN_PLAY,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.ADDED,((t,e)=>{(t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(t))&&t.fullId==e&&addClass(p,"audio_player_btn_added")})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.REMOVED,((t,e)=>{(t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(t))&&t.fullId==e&&removeClass(p,"audio_player_btn_added")})),i.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.PLAY_REQUESTED],((t,e,o)=>{delete this._readyAudio,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(s,"audio",t),E(),y(t),addClass(h,"audio_playing"),e&&!cur.audioStartReadyAudio&&(this._trackSlider&&this._trackSlider.setBackValue(0),i.ads.isPlaying()||(d.innerHTML=f(0,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(t).duration)),a.setAttribute("title",""),a.titleSet=!1),c.innerHTML=getLang("global_audio_pause"),this.updateCurrentPlayingInfo(),this.updateShuffleButton(),this.updateFaveButton()})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.PAUSE,(()=>{removeClass(h,"audio_playing"),c.innerHTML=getLang("global_audio_play")})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.STOP,(()=>{removeClass(h,"audio_playing"),c.innerHTML=getLang("global_audio_play")})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.BUFFERED,((t,e)=>{this._trackSlider&&this._trackSlider.setBackValue(e)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.VOLUME,((t,e)=>{this._volumeSlider&&this._volumeSlider.setValue(e,!0)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.ENDED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.UPDATE,((t,e)=>{t&&y(t),i.ads.isPlaying()||t&&e&&(d.innerHTML=f(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(t).duration))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.PROGRESS,((t,e,i)=>{this._trackSlider&&(this._trackSlider.toggleLoading(!1),this._trackSlider.setValue(e)),isUndefined(i)||isNaN(i)||(d.innerHTML=f(e,i))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.FAILED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_8__.events.CURRENT_CHANGED,(()=>{var t=i.getCurrentAudio()||this._readyAudio;domData(this._els.player,"audio",JSON.stringify(t)),y(t),this.togglePodcast(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(t),t),this._trackSlider.setValue(0)}))}var w=i.getCurrentAudio()||this._readyAudio;w&&(domData(s,"audio",JSON.stringify(w)),y(w),toggleClass(h,"audio_playing",i.isPlaying()),d.innerHTML=f(1,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(w).duration),t&&this._trackSlider&&(this._trackSlider.setValue(0),this._trackSlider.setBackValue(0),this._trackSlider.toggleLoading(!1))),E();var C=i.getCurrentAudio()||this._readyAudio;this.togglePodcast(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isPodcast(C),C),this.isLayer()||this._initFixedPlayer()},AudioPage.prototype._initFixedPlayer=function(){var t=getSize(this._els.playerWrap);setStyle(this._els.playerWrap,{width:t[0],height:t[1]});var e=getSize(this._els.player);setStyle(this._els.player,{width:e[0],height:e[1]});var i,o,s=getSize("page_header_wrap")[1],a=getXY(this._els.contentBlock)[1],r=getXY(this._els.playerWrap)[1]+getSize(this._els.playerWrap)[1]-s,l=!1,n=()=>{var t=scrollGetY(),e=t>a;if(t<r&&(i||l))return clearTimeout(i),clearTimeout(o),removeClass(this._els.player,"audio_page_player_fixed_shown"),removeClass(this._els.player,"audio_page_player_fixed"),void(l=i=!1);e&&!l&&(clearTimeout(i),i=0,addClass(this._els.player,"audio_page_player_fixed"),o=setTimeout((()=>addClass(this._els.player,"audio_page_player_fixed_shown"))),l=!0),!e&&l&&(clearTimeout(i),i=0,removeClass(this._els.player,"audio_page_player_fixed_shown"),i=setTimeout((()=>{removeClass(this._els.player,"audio_page_player_fixed"),i=!1}),250),l=!1)};addEvent(window,"scroll",n),cur.destroy.push((()=>{n&&removeEvent(window,"scroll",n)}))},AudioPage.prototype.togglePlayerPlay=function(t){var e=getAudioPlayer();if(e.isPlaying()){var i=e.getCurrentAudio();i&&e.podcastSetActionRef(i,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.PodcastsLogs.ACTION_PAUSE,"",t),e.pause()}else{var o,s=this.getPageCurrentPlaylist(),a=e.getCurrentPlaylist(),r=e.getCurrentAudio()||this._readyAudio;if(r=r||s.getAudioAt(0),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.isClaimedAudio(r)){r=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.asObject(r);var l=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.getAudioExtra(r).claim;return void(0,_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_16__.showAudioClaimWarning)(r,l)}a&&-1!==a.indexOfAudio(r)?o=a:s&&-1!==s.indexOfAudio(r)?o=s:(o=new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_12__.AudioPlaylist.TYPE_TEMP,vk.id)).addAudio(r),delete this._readyAudio,cur.audioStartReadyAudio=!0,e.podcastSetActionRef(r,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_26__.AudioUtils.PodcastsLogs.ACTION_PLAY,"",t),e.play(r,o)}},AudioPage.prototype.promoAlbumSlideInit=function(){var t=geByClass1("audio_promo");if(!this.isLayer()&&t){var e=geByClass1("audio_promo__items",t);if(e&&!(e.children.length<=1)){this.promoAlbumSlideAutoStart(e);var i=()=>this.promoAlbumSlideAutoStop(),o=()=>this.promoAlbumSlideAutoStart(e);addEvent(t,"mouseenter",i),addEvent(t,"mouseleave",o),window.cur&&cur.destroy.push((()=>{this.promoAlbumSlideAutoStop(),removeEvent(t,"mouseenter",i),removeEvent(t,"mouseleave",o)}))}}},AudioPage.prototype.promoAlbumSlideAutoStart=function(t){window.cur&&(cur._promoAlbumSlideTO=setTimeout((()=>this.promoAlbumSlide(t,1)),SLIDER_TIMEOUT))},AudioPage.prototype.promoAlbumSlideAutoStop=function(){window.cur&&clearTimeout(cur._promoAlbumSlideTO)},AudioPage.prototype.promoAlbumSlide=function(t,e){var i=vk.rtl?e>0?-1:1:e<0?-1:1,o=gpeByClass("audio_promo",t);if(o){var s=geByClass1("audio_promo__items",o);if(s&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(s,"sliding")){this.promoAlbumSlideAutoStop();var a=s.scrollLeft,r=s.offsetWidth,l=s.children,n=l.length,_=t=>vk.rtl?s.scrollWidth-t*r-r:t*r;if(l.length>1){this.promoAlbumSlideAutoStart(t);var d=!1,u=null,h=!1,c=Math.round(a/r);(c+=i)>=n||c<0?(d=l[0].cloneNode(!0),s.appendChild(d),c>=n?(h=!0,u=_(c)):c<0&&(s.scrollLeft=_(n),u=_(c=n-1))):u=_(c),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(s,"sliding",!0),animate(s,{scrollLeft:u},{duration:500,transition:Fx.Transitions.swiftOut,onComplete:()=>{h&&(s.scrollLeft=_(0)),d&&re(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_17__.data)(s,"sliding",!1)}})}}}},AudioPage.prototype.toggleRemoveAdsLink=function(t){toggleClass(this._els.player,"audio_page_player_show_remove_ads",!!t)}},195435:(t,e,i)=>{i.d(e,{default:()=>u});var o=i(401730),s=i(709961),a=i(469433),r=i(337662),l=i(534778),n=i(646784),_=i(311046),d=i(558672);class u{constructor(t,e){this.playlistElement=(0,o.$)(`#playlist-${t}`),this.playlist=e,this.playlistList=(0,o.$)(`.${u.playListClass}__list`,this.playlistElement),this.playlistListAll=(0,o.$)(`.${u.actionButtonsClass}--all`,this.playlistList),this.audio={},this.audioElements=(0,o.$$)(`.${u.playListClass}__audioRow`,this.playlistList);for(var i=0;i<this.audioElements.length;i++)this.audio[this.audioElements[i].dataset.fullId]=this.audioElements[i];this.body=(0,o.$)(`.${u.playListClass}__body`,this.playlistElement),this.shuffle=(0,o.$)(`.${u.actionButtonsClass}--shuffle`,this.body),this.actions=(0,o.$)(`.${u.playListClass}__actions`,this.playlistElement),this.actions&&(this.add=(0,o.$)(`.${u.actionButtonsClass}--add`,this.actions),this.addText=(0,o.$)(`.${u.actionButtonsClass}--add__text`,this.add),this.share=(0,o.$)(`.${u.actionButtonsClass}--share`,this.actions),this.add.addEventListener("click",this.addPlayList.bind(this)),this.share.addEventListener("click",this.sharePlayList.bind(this))),this.menu=(0,o.$)(`.${u.menuButtonsClass}__inner`,this.playlistElement),this.menu&&(this.playNext=(0,o.$)(`.${u.menuButtonsClass}__item--playNext`,this.menu),this.editPlaylist=(0,o.$)(`.${u.menuButtonsClass}__item--editPlaylist`,this.menu),this.deletePlaylist=(0,o.$)(`.${u.menuButtonsClass}__item--deletePlaylist`,this.menu),this.addToGroup=(0,o.$)(`.${u.menuButtonsClass}__item--addToGroup`,this.menu),this.removeFromGroup=(0,o.$)(`.${u.menuButtonsClass}__item--removeFromGroup`,this.menu),this.copyLink=(0,o.$)(`.${u.menuButtonsClass}__item--copyLink`,this.menu)),this.play=(0,o.$)(`.${u.playListClass}__play`,this.playlistElement),this.play&&(this.player=getAudioPlayer(),this.player.addPlaylist(new _.AudioPlaylist(this.playlist,this.playlist.ownerId,this.playlist.albumId)),this.player.on(this.playlist.context,s.events.PLAY,this.onPlay.bind(this)),this.player.on(this.playlist.context,s.events.PAUSE,this.onStop.bind(this)),this.player.on(this.playlist.context,s.events.STOP,this.onStop.bind(this)),this.play.addEventListener("click",this.playSong.bind(this)),this.playlistList.addEventListener("click",this.playFromList.bind(this))),this.playlistListAll&&this.playlistListAll.addEventListener("click",this.showAllAudio.bind(this)),this.shuffle&&this.shuffle.addEventListener("click",this.shufflePlayList.bind(this)),this.playNext&&this.playNext.addEventListener("click",this.playNextSong.bind(this)),this.editPlaylist&&this.editPlaylist.addEventListener("click",this.handleEditPlaylist.bind(this)),this.deletePlaylist&&this.deletePlaylist.addEventListener("click",this.handleDeletePlaylist.bind(this)),this.addToGroup&&this.addToGroup.addEventListener("click",this.handleAddToGroup.bind(this)),this.removeFromGroup&&this.removeFromGroup.addEventListener("click",this.handleRemoveFromGroup.bind(this)),this.copyLink&&this.copyLink.addEventListener("click",this.copyPlayListLink.bind(this))}showAllAudio(){this.playlistList.classList.add(`${u.playListClass}__list--all`)}shufflePlayList(){this.showAllAudio(),this.player.playPlaylist(this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash,this.playlist.context,!0)}addPlayList(){AudioUtils.followPlaylist(this.addText,this.playlist.ownerId,this.playlist.albumId,this.playlist.followHash),this.add.classList.toggle(`${u.actionButtonsClass}--add--added`),this.add.classList.contains(`${u.actionButtonsClass}--add--added`)?this.addText.innerText=this.addText.dataset.textFollowed:this.addText.innerText=this.addText.dataset.textFollow}sharePlayList(t){(0,a.shareAudioPlaylist)(t,this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash)}playNextSong(){this.player.playNextPlaylist(this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash,this.playlist.context)}copyPlayListLink(){AudioUtils.copyPlaylistLink(this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash)}playSong(){this.isCurrentPlaylist()?!0===this.isPlaying?this.player.pause():this.player.play():this.player.playPlaylist(this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash,this.playlist.context)}playFromList(t){var e,i=t.target;if(-1!==i.className.indexOf("AudioRow")){for(;i&&!i.classList.contains(`${u.playListClass}__audioRow`);)i=i.parentNode;e=i.dataset.id}if(e){var o=this.player.getPlaylist(this.playlist.type,this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash);this.player.play(e,o,this.playlist.context)}}onPlay(){this.isCurrentPlaylist()&&(this.isPlaying=!0,this.play.classList.add(`${u.playListClass}__stop`),this.play.classList.remove(`${u.playListClass}__play`))}onStop(){this.isCurrentPlaylist()&&(this.isPlaying=!1,this.play.classList.add(`${u.playListClass}__play`),this.play.classList.remove(`${u.playListClass}__stop`))}isCurrentPlaylist(){var t=this.player.getCurrentAudio();return Boolean(t)&&this.playlist.list.some((e=>e[0]===t[0]&&e[1]===t[1]))}handleEditPlaylist(){(0,n.editPlaylist)(this.playlist.ownerId,this.playlist.albumId,"edit",{onPlaylistSave:()=>nav.reload()})}handleDeletePlaylist(){d.AudioPage.deletePlaylist(this.playlist.ownerId,this.playlist.albumId,this.playlist.editHash)}handleAddToGroup(){(0,l.addToGroupBox)(this.playlist.ownerId,this.playlist.albumId,this.playlist.accessHash)}handleRemoveFromGroup(){(0,r.removeFromGroup)(this.playlist.ownerId,this.playlist.albumId,this.playlist.followHash)}}u.playListClass="AudioPlaylistSnippet",u.actionButtonsClass="ActionButton",u.menuButtonsClass="ActionsMenu"},304418:(t,e,i)=>{i.d(e,{uiGetGallery:()=>a,UIGallery:()=>r});var o=i(257451),s=(0,o.makeSharedState)("ui-gallery",(()=>({galleries:{},incIndex:0})));function a(t){var e=domData(ge(t),"gallery-id");return e&&s().galleries[e]}class r{constructor(t,e){if(!t)throw new Error("No element was provided for UIGallery");if(t=ge(t),!hasClass(t,"ui_gallery"))throw new Error("Provided incorrect element for UIGallery");var i=a(t);if(i)return i;this._opts=extend({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1},e),this._id=s().incIndex,s().incIndex+=1,this._el=t,this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._itemWidth=getSize(this._items[0])[0],this._itemOffset=intval(getStyle(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=intval(getStyle(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=geByClass1("ui_gallery__inner_cont",this._el),this._inner=geByClass1("ui_gallery__inner",this._el),this._scroll=function(){var t={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return t;if(!cur._scrollInfo){var e=se('<div style="position: fixed; left: -1000; width: 0; overflow: scroll">x</div>');ge("content").appendChild(e);var i=e.scrollLeft;t.rtl=vk.rtl,t.backward=i>0,e.scrollLeft=1e3,t.delta=e.scrollLeft===i?-1:1,t.negative=!t.backward&&t.delta<0,t.rtlSame=t.rtl&&!t.backward&&!t.negative,re(e),cur._scrollInfo=t}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[]},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),domData(this._el,"gallery-id",this._id),s().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&addEvent(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this))}_initArrows(){this._opts.noArrows?addClass(this._el,"ui_gallery_no_arrows"):(this._leftArrow=geByClass1("ui_gallery__arrow_left",this._el),this._rightArrow=geByClass1("ui_gallery__arrow_right",this._el),this._arrowWidth=getSize(this._leftArrow)[0],addEvent(this._leftArrow,"click",this._onArrowScroll.bind(this,-1)),addEvent(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),addEvent(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),addEvent(this._rightArrow,"click",this._onArrowScroll.bind(this,1)),addEvent(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),addEvent(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(t){if(this._opts.scrollX||this._opts.scrollY){var e;if("wheel"==t.type)if(Math.abs(t.deltaY)>Math.abs(t.deltaX)){if(!this._opts.scrollY)return;e=-t.deltaY}else{if(!this._opts.scrollX)return;e=-t.deltaX}else if(void 0!==t.wheelDeltaY){if(!this._opts.scrollY)return;e=t.wheelDeltaY}else if(void 0!==t.wheelDelta)e=t.wheelDelta;else{if(!t.detail||1!==t.axis)return;e=-t.detail}e=this._scroll.rtlSame?-e:e,Math.abs(e)>=120&&(e=74*Math.max(-1,Math.min(1,e))),this._innerCont.scrollLeft-=e,this._checkItemsAfterScroll(this._innerCont.scrollLeft),cancelEvent(t)}}_onArrowScroll(t,e){if(!this._opts.noArrows){var i=this._innerCont.scrollLeft+(this._scroll.rtlSame?-t:t)*(this._width-2*this._arrowWidth),o=this._innerCont.scrollWidth-this._width;this._scroll.negative?(i=Math.min(i,0),i=Math.abs(i)):i=Math.max(0,i),i=Math.min(o,i);var s=this._scroll.negative||this._scroll.rtlSame?-t:t;if(s>0&&i<o)i=Math.floor(i/this._itemFullWidth)*this._itemFullWidth;else if(s<0&&i>0){i=Math.floor(i/this._itemFullWidth)*this._itemFullWidth}if(0===i||i===o){var a=this._innerCont.scrollWidth;addClass(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),i&&(i+=t*(this._innerCont.scrollWidth-a))}this._scroll.negative&&(i=-i),animate(this._innerCont,{scrollLeft:i},{duration:Math.abs(this._innerCont.scrollLeft-i)+50,transition:Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(i),setTimeout((()=>removeClass(this._inner,"ui_gallery__inner_shift_instant")),0),cancelEvent(e)}}_checkItemsAfterScroll(t,e){if(this._scroll.negative&&(t=Math.abs(t)),this._opts.markOutside||this._opts.onViewItem){var i,o=this._itemWidth/3,s=(this._scroll.backward?this._inner.scrollWidth-this._width-t:t)-this._scrollOffset,a=t&&Math.floor(s/this._itemFullWidth),r=a*this._itemFullWidth+2*o;i=this._scroll.backward?t+this._width<this._inner.scrollWidth-r:t>r;var l,n=Math.min(this._items.length-1,Math.floor((s+this._width)/this._itemFullWidth)),_=n*this._itemFullWidth+2*o;if(l=this._scroll.backward?t>this._inner.scrollWidth-_:t+this._width<_,this._opts.onViewItem){var d=i?Math.min(this._items.length-1,a+1):a,u=l?Math.max(0,n-1):n;if(e||d!==this._visible.left||u!==this._visible.right){for(var h=d;h<=u;h++)(this._visible.left<0||e&&!inArray(this._items[h],this._visible.items)||h<this._visible.left||h>this._visible.right)&&this._opts.onViewItem(this._items[h],h);this._visible.left=d,this._visible.right=u,this._visible.items=this._items.slice(d,u+1)}}this._opts.markOutside&&(e?(geByClass("ui_gallery_item_outside",this._inner).forEach((t=>{removeClass(t,"ui_gallery_item_outside")})),this._outside.left=-1,this._outside.right=-1):((a!==this._outside.left||!i)&&this._outside.left>=0&&(removeClass(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(n!==this._outside.right||!l)&&this._outside.right>=0&&(removeClass(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),i&&a!==this._outside.left&&(addClass(this._items[a],"ui_gallery_item_outside"),this._outside.left=a),l&&n!==this._outside.right&&(addClass(this._items[n],"ui_gallery_item_outside"),this._outside.right=n))}if(!this._opts.noArrows){var c=t>0,p=t+this._width<this._inner.scrollWidth;toggleClass(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?p:c),toggleClass(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?c:p)}(!this._scroll.backward&&this._inner.scrollWidth-t-this._width<1e3||this._scroll.backward&&t<1e3)&&this._onLoadMore()}_onArrowMouseOver(t){this._opts.noArrows||addClass(this._inner,"ui_gallery__inner_shift_"+t)}_onArrowMouseOut(){this._opts.noArrows||(removeClass(this._inner,"ui_gallery__inner_shift_left"),removeClass(this._inner,"ui_gallery__inner_shift_right"))}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(t,e){t=t||[],this.addItems(t),this._finised=!!e||!t.length,this._loadingMore=!1}addItems(t,e){if((t=t||[]).length){var i=e>=0&&e<this._items.length?this._items[e]:null;t.forEach((t=>{i?domInsertBefore(t,i):this._inner.appendChild(t)})),this.refresh()}}destroy(){removeEvent(this._innerCont),removeEvent(this._leftArrow),removeEvent(this._rightArrow),domData(this._el,"gallery-id",null),delete s().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),re(this._el)}removeItem(t){return isNumeric(t)&&(t=this._items[t]),!(!t||!inArray(t,this._items))&&(re(t),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}getItems(){return this._items}getVisibleItems(){return this._visible.items.map(((t,e)=>[t,this._visible.left+e]))}}},513e3:(t,e,i)=>{i.d(e,{default:()=>_});var o=i(927663),s=i(907851),a=i(414914),r=i(442699),l=i(917685);function n(t,e,i){if((0,r.isObject)(e)?i=e:this._dragElClass=e,this.options=(0,r.extend)({dragThreshold:n.DRAG_THRESHOLD_DIST},i),this._contEl=(0,a.ge)(t),this._contEl){this._excludedCount=0;for(var o=0;o<this._contEl.children.length;o++)this._contEl.children[o].getAttribute("nodrag")&&this._excludedCount++;(0,l.addEvent)(this._contEl,"mousedown",this._ev_mousedown_handler=this._onMouseDown.bind(this)),(0,a.setStyle)(this._contEl,"position","relative"),this._inited=!0,this._updateScrollbar=this._initUpdaterScrollbar()}}n.AUTO_SCROLL_DY=10,n.DRAG_THRESHOLD_DIST=0,n.AUTO_SCROLL_DISTANCE_THRESHOLD=300,n.AUTO_SCROLL_GAP=300,n.prototype.destroy=function(){this._inited&&(this._inited=!1,this._deinitEvents(!0))},n.prototype._getParentDragItemEl=function(t){for(var e,i=t;i&&(e=(0,a.domPN)(i))!==this._contEl;)i=e;return i===this._curPlaceholderEl&&(i=null),i},n.prototype._onKey=function(t){t.keyCode===l.KEY.ESC&&this.isCurrentlyDragging()&&this._onMouseUp()},n.prototype._onMouseDown=function(t){if(!(this._disabled||0!=t.button||this._curDragEl||(0,a.attr)(t.target,"nodrag")||this._dragElClass&&!(0,a.domClosest)(this._dragElClass,t.target))){for(var e=t.target;e&&e!==window.document;){if((0,r.intval)((0,a.domData)(e,"nodrag")))return;e=(0,a.domPN)(e)}var i=this._getParentDragItemEl(t.target);if(i&&!(0,a.attr)(i,"nodrag")&&((0,a.re)((0,a.geByClass1)("ui_gridsorter_placeholder"),this._contEl),this._contInfo=this._contInfo||{prevSize:(0,a.getSize)(this._contEl)},this._ensureGridIsActual(),!(this._grid.length<=1))){var o=window.getComputedStyle(i),s=(0,a.getXY)(i);this._initial={candidateEl:i,x:t.clientX,y:t.clientY,itemMargin:{x:parseInt(o.marginLeft),y:parseInt(o.marginTop)},shift:{x:t.pageX-s[0],y:t.pageY-s[1]}},(0,l.addEvent)(document,"mousemove",this._ev_mousemove_handler=this._onMouseMove.bind(this)),(0,l.addEvent)(document,"mouseup",this._ev_mouseup_handler=this._onMouseUp.bind(this)),(0,l.addEvent)(document,"keydown",this._ev_keydown_handler=this._onKey.bind(this)),cur.cancelClick=!1,(0,l.cancelEvent)(t)}}},n.prototype._dist=function(t){return Math.abs(t.clientX-this._initial.x)+Math.abs(t.clientY-this._initial.y)},n.prototype._onMouseUp=function(t){var e=this._curDragEl,i=!t;if(this._curDragEl){this._curDragEl=null,(0,a.removeClass)(e,"ui_gridsorter_moveable_notrans"),this._curOverCell||(this._curOverCell={el:this._curPlaceholderEl,pos:(0,a.getXY)(this._curPlaceholderEl),size:(0,a.getSize)(this._curPlaceholderEl)});var o=this._curOverCell.pos,s=this._curOverCell.el,r=this._grid[this._curDragCellIndex],n=r&&r.size;(0,a.gpeByClass)("_ape_item_list",e)&&(o[0]+=20,o[1]+=20),n&&this._isShiftToLeft&&(o[1]-=n[1]-this._curOverCell.size[1]),setTimeout((()=>{if(i){for(var t=0,s=this._grid.length;t<s;t++){var a=this._grid[t];a.dirty&&this._setPos(a.el,{left:0,top:0})}this._setPos(e,this._initialCurDragPos)}else this._setPos(e,{left:o[0],top:o[1]})})),setTimeout((()=>{if((0,a.re)(this._curPlaceholderEl),(0,a.removeClass)(this._contEl,"ui_gridsorter_cont"),this.options.dragCls&&(0,a.removeClass)(e,this.options.dragCls),this._inited){var t;if(i){for(var o=this._grid.length,r=0;r<o;r++){var l=this._grid[r];l.dirty&&this._setPos(l.el,{left:null,top:null})}this._setPos(e,{left:null,top:null,width:null,height:null})}else{var n;t=this._isShiftToLeft?(0,a.domNS)(s):s,this._contEl.insertBefore(e,t);var _=-1,d=this._initial.hasInlineSize;this._setPos(e,{left:null,top:null}),d||(0,a.setStyle)(e,{width:null,height:null});for(var u=this._grid.length,h=0;h<u;h++){var c=this._grid[h];(c.dirty||c.el===e)&&(this._setPos(c.el,{left:null,top:null}),d||(0,a.setStyle)(c.el,{width:null,height:null}),c.pos=this._calcElementPos(c.el),c.dirty=!1),c.el===e?n=h:c.el===s&&(_=h)}if(_>=0){var p=this._grid.splice(n,1);this._grid.splice(_,0,p[0])}}(0,a.removeClass)(e,"ui_gridsorter_moveable"),this._curOverCell=this._curPlaceholderEl=null,i&&this.update(),this.options.onDragFinish&&this.options.onDragFinish(e),s!==e&&!i&&this.options.onReorder&&this.options.onReorder(e,t,(0,a.domPS)(e))}}),210),t&&this._dist(t)>5&&((0,l.cancelEvent)(t),cur.cancelClick=!0)}this._updateScrollbar(),this._deinitEvents(),e&&this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,e),i||e&&this._overEl&&this.options.onDragDrop&&(i=this.options.onDragDrop(this._overEl,e)),this._overEl=null},n.prototype._deinitEvents=function(t){t&&(this._onMouseUp(),(0,l.removeEvent)(this._contEl,"mousedown",this._ev_mousedown_handler)),clearTimeout(this._autoScrollTO),this._autoScrollTO=!1,this._ev_mousemove_handler&&(0,l.removeEvent)(document,"mousemove",this._ev_mousemove_handler),this._ev_mouseup_handler&&(0,l.removeEvent)(document,"mouseup",this._ev_mouseup_handler),this._ev_keydown_handler&&(0,l.removeEvent)(document,"keydown",this._ev_keydown_handler)},n.prototype._setPos=function(t,e){this.options.noPosTransform||!this._hasTranslateFeauture&&!(this._hasTranslateFeauture=window.getComputedStyle(t).getPropertyValue("transform"))?(0,a.setStyle)(t,(0,r.extend)({transform:null},e)):null===e.left||null===e.top?(0,a.setStyle)(t,{transform:null,top:null,left:null}):(0,a.setStyle)(t,{transform:"translate("+e.left+"px, "+e.top+"px)",top:null,pos:null})},n.prototype._recalc=function(){var t=this._curDragEl,e=this._curOverCell.el;if(this._initGrid(),e!==t){for(var i=0,o=!1,s=!1,a=this._grid.length,r=0;r<a;r++){var l=this._grid[r];if(l.el===t){o=!0;break}if(l.el===e){o=!1;break}}this._isShiftToLeft=o;for(var n=o?0:this._grid.length-1,_=o?this._grid.length:-1,d=o?1:-1,u=[0,0];n!==_;n+=d){var h=this._grid[n];if(2!==i)if(h.el!==t){if(h.el===e&&i++,1===i||2===i){var c=0,p=0;o?(c=s.pos[0]+u[0],p=s.pos[1]+u[1],u[0]+=h.size[0]-s.size[0],u[1]+=h.size[1]-s.size[1]):(u[0]+=s.size[0]-h.size[0],u[1]+=s.size[1]-h.size[1],c=s.pos[0]+u[0],p=s.pos[1]+u[1]),this._setPos(h.el,{left:c-h.pos[0],top:p-h.pos[1]}),h.dirty=!0}else h.dirty&&(this._setPos(h.el,{left:null,top:null}),h.dirty=!1);s=h}else i++,s=h;else h.dirty&&(this._setPos(h.el,{left:null,top:null}),h.dirty=!1),s=h}}else for(var g=this._grid.length,y=0;y<g;y++){var f=this._grid[y];f.el!==t&&f.dirty&&(f.dirty=!1,this._setPos(f.el,{left:null,top:null}))}},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1,this._initGrid(!0)},n.prototype.update=function(){this._disabled||this._initGrid(!0)},n.prototype._ensureGridIsActual=function(){this._initGrid()},n.prototype._needGridUpdate=function(){if(!this._grid)return 1;this._contInfo.prevSize=this._contInfo.prevSize||(0,a.getSize)(this._contEl);var t=0,e=this._contEl.children.length-this._excludedCount-(0,r.intval)(!!this._curPlaceholderEl);if(e!==this._grid.length)t=e>this._grid.length?2:1,this._contInfo.prevSize=(0,a.getSize)(this._contEl);else{var i=(0,a.getSize)(this._contEl),o=this._contInfo.prevSize;(Math.abs(o[0]-i[0])>5||Math.abs(o[1]-i[1])>5)&&(t=1),this._contInfo.prevSize=i}return t},n.prototype._initGrid=function(t){var e=t?1:this._needGridUpdate();if(e){1===e&&(this._grid=[],this._contInfo&&(delete this._contInfo.pos,delete this._contInfo.size));var i=this._grid?this._grid[this._grid.length-1]:null;this._grid=this._grid||[];var o,s=!!i,r=this._contEl.children;if(r.length)for(var l=this._getItemMargins(),n=this._curDragEl?this._grid.length:0,_=r.length;n<_;n++){var d=r[n];i&&d===i.el?s=!1:s||d===this._curPlaceholderEl||d.getAttribute("nodrag")||((o=(0,a.getSize)(d))[0]+=l[0],o[1]+=l[1],this._grid.push({el:d,size:o,pos:this._calcElementPos(d)}))}}},n.prototype._getRelativeMousePos=function(t){var e=this._getContPos(),i=this._getContShift();return{left:t.clientX-e[0]-i[0],top:t.clientY-e[1]-i[1]}},n.prototype._updateDraggablePosition=function(t){if(this._curDragEl){var e=this._getRelativeMousePos(t),i=this._getItemShift(),o=this._getContShift(),s=this._getContSize(),r=e.top-this._initial.shift.y-i[1]+o[1];this.options.limitBottomMove&&(r=Math.min(r,s[1]+30)),(0,a.hasClass)(this._contEl,"_ape_item_list")&&(r+=this._contEl.scrollTop),this._setPos(this._curDragEl,{left:e.left-this._initial.shift.x-i[0]+o[0],top:r}),window.AudioPage&&window.AudioPage.onUpdateDraggablePosition&&window.AudioPage.onUpdateDraggablePosition()}},n.prototype._getContShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.shift){var t=window.getComputedStyle(this._contEl);this._contInfo.shift=[parseFloat(t.paddingLeft),parseFloat(t.paddingTop)]}return this._contInfo.shift},n.prototype._getContSize=function(){return this._contInfo=this._contInfo||{},this._contInfo.size=(0,a.getSize)(this._contEl),this._contInfo.size},n.prototype._getContPos=function(){return this._contInfo=this._contInfo||{},this._contInfo.pos=(0,a.getXY)(this._contEl),this._contInfo.pos[1]-=(0,o.scrollGetY)(),this._contInfo.pos},n.prototype._getItemShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemShift){var t=window.getComputedStyle((0,a.domFC)(this._contEl));this._contInfo.itemShift=[parseFloat(t.marginLeft),parseFloat(t.marginTop)]}return this._contInfo.itemShift},n.prototype._getItemMargins=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemMargins){var t=window.getComputedStyle((0,a.domFC)(this._contEl));this._contInfo.itemMargins=[parseFloat(t.marginLeft)+parseFloat(t.marginRight),parseFloat(t.marginTop)+parseFloat(t.marginBottom)]}return this._contInfo.itemMargins},n.prototype._calcElementPos=function(t){var e=this._getContShift(),i=this._getItemShift();return[t.offsetLeft-e[0]-i[0],t.offsetTop-e[1]-i[1]]},n.prototype.isCurrentlyDragging=function(){return!!this._curDragEl},n.prototype._initUpdaterScrollbar=function(){return(0,s.throttle)((t=>{var e=this.options.wrapNode||t,i=(0,a.data)(e,"sb");i&&i.update(!1,!0)}),500)},n.prototype._onMouseMove=function(t){var e=()=>this.options.wrapNode?this.options.wrapNode.scrollTop:(0,o.scrollGetY)(),i=t=>{this.options.wrapNode?this.options.wrapNode.scrollTop=t:(0,o.scrollToY)(t,0,!1,!0)};if(this._curDragEl){this._ensureGridIsActual(),!t&&(t={clientX:this._lastMousePos.x,clientY:this._lastMousePos.y}),this._lastMousePos={x:t.clientX,y:t.clientY},this._updateDraggablePosition(t);var s=this._getContSize(),r=this._getRelativeMousePos(t),n=!1;if((0,a.hasClass)(this._contEl,"_ape_item_list")&&(r.top+=this._contEl.scrollTop),r.left>0&&r.left<s[0]&&r.top>0&&r.top<s[1])for(var _=0,d=this._grid.length-1,u=50;u;){var h=_+Math.floor((d-_)/2),c=this._grid[h];if(r.left>c.pos[0]&&r.top>c.pos[1]&&r.left<c.pos[0]+c.size[0]&&r.top<c.pos[1]+c.size[1]){n=c;break}if(_===d)break;r.top<c.pos[1]||r.left<c.pos[0]&&r.top<c.pos[1]+c.size[1]?d=d===h?d-1:h:_=_===h?_+1:h,u--}else{for(var p,g,y,f=this._grid.length,E=999999,v=0;v<f;v++){var m=this._grid[v],P=(g=r.left-(m.pos[0]+m.size[0]/2))*g+(y=r.top-(m.pos[1]+m.size[1]/2))*y;E>P&&(E=P,p=m)}n=p}!n||this._curOverCell&&this._curOverCell.el===n.el||(this._curOverCell=n,this._recalc());var b,w,C,A,D=0;if(this.options.wrapNode)b=A=this.options.wrapNode,w=(0,a.getSize)(b),(C=(0,a.getXY)(b))[1]-=(0,o.scrollGetY)(),D=t.clientY;else{var B=window,O=document.documentElement,I=document.getElementsByTagName("body")[0],M=B.innerWidth||O.clientWidth||I.clientWidth,L=B.innerHeight||O.clientHeight||I.clientHeight;A=B.bodyNode,w=[M,L],C=[0,0],D=t.clientY}var T=Math.max(20,w[1]/10),S=C[1]+T-D,k=T-(C[1]+w[1]-D);if(k>0||S>0){var R=Math.min(1,S/T),U=Math.min(1,k/T);this._autoScrollTO||(this._autoScrollTO=setTimeout((()=>{this._autoScrollTO=!1;var t=e();i(t+16*(R>0?-R:U)),t!==A.scrollTop&&(this._updateScrollbar(A),this._onMouseMove())}),20))}if(this.options.onDragOverElClass){var x=t.target;(0,a.hasClass)(x,this.options.onDragOverElClass)||(x=(0,a.gpeByClass)(this.options.onDragOverElClass,x))?this._overEl!==x&&(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this.options.onDragEnter&&this.options.onDragEnter(x,this._curDragEl),this._overEl=x):(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this._overEl=null)}}else if(this._dist(t)>this.options.dragThreshold){this._curDragEl=this._initial.candidateEl;for(var W=this._grid.length,K=0;K<W;K++)if(this._grid[K].el===this._curDragEl){this._curDragCellIndex=K;break}this.options.dragCls&&(0,a.addClass)(this._curDragEl,this.options.dragCls);var H=(0,a.getSize)(this._curDragEl),F=(0,a.getXY)(this._curDragEl),N=window.getComputedStyle(this._curDragEl),z=this._getContPos();this._initial.hasInlineSize=!(!this._curDragEl.style.width&&!this._curDragEl.style.height),(0,a.setStyle)(this._curDragEl,{width:H[0],height:H[1]}),this._initialCurDragPos={left:F[0]-z[0],top:F[1]-z[1]-bodyNode.scrollTop},this._curPlaceholderEl=(0,a.ce)("div",{className:"ui_gridsorter_placeholder"}),(0,a.setStyle)(this._curPlaceholderEl,{width:H[0]+parseFloat(N.marginLeft)+parseFloat(N.marginRight),height:H[1]+parseFloat(N.marginTop)+parseFloat(N.marginBottom)}),this._contEl.insertBefore(this._curPlaceholderEl,this._curDragEl),(0,a.addClass)(this._curDragEl,"ui_gridsorter_moveable"),(0,a.addClass)(this._curDragEl,"ui_gridsorter_moveable_notrans"),(0,a.addClass)(this._contEl,"ui_gridsorter_cont"),this._onMouseMove(t),this._updateDraggablePosition(t),this.options.onDragStart&&this.options.onDragStart(this._curDragEl)}(0,l.cancelEvent)(t)};const _=n},412685:(t,e,i)=>{i.d(e,{ON_BOARDING_BG_RECT_ID:()=>n,default:()=>u});i(530522),i(66108),i(296253),i(991181),i(579665),i(95767);var o=i(414914),s=i(927663),a=i(491792);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],o=!0,s=!1,a=void 0;try{for(var r,l=t[Symbol.iterator]();!(o=(r=l.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){s=!0,a=t}finally{try{o||null==l.return||l.return()}finally{if(s)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}var n="onboarding_bg_rect",_="page_header_cont",d="onboarding";class u{constructor(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.el=t,this.text=e,this.hideDarkness=!0,this.oldColor=!1;var o=i.class?i.class:"",s={autoShow:!1,noAutoHideOnWindowClick:!0,content:e instanceof HTMLElement?e:`${e}`,cls:`feature_intro_tt feature_intro_blue_tt tutorial_tip_tt ${o}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:i.scrollOffset||0};i.side&&(s.forceSide=i.side),i.offset&&(s.offset=i.offset),i.width&&(s.width=i.width),i.shift&&(s.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.ttOnHide&&(s.onHide=i.ttOnHide),i.withCloseButton&&(s.withCloseButton=i.withCloseButton,s.onCloseButtonClick=i.onCloseButtonClick),i.align&&(s.align=i.align),this.ttParams=s,this.opts=i,this.initOnboardingBG()}initOnboardingBG(){if(!window.onboardingBG){var t=se('\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ');(0,o.domInsertBefore)(t,window.layerBG),window.onboardingBGHeader=ge("onboarding_bg_header"),window.onboardingBG=ge("onboarding_bg"),window.onboardingBGRect=ge(n),window.onboardingBGClip=ge("onboarding_bg_clip"),window.cur.destroy.push((()=>{hide(window.onboardingBG),hide(window.onboardingBGHeader),removeClass(ge(_),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&removeEvent(window.onboardingBG,"click",this.opts.onBGClick)})),this.opts.onBGClick&&addEvent(window.onboardingBG,"click",this.opts.onBGClick)}}showTT(){var t=r((0,o.getXY)(this.el),2)[1];this.tt=new window.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();var e=this.tt.getContent();(0,a.isElementInViewport)(this.el)&&(0,a.isElementInViewport)(e)||(0,s.scrollToY)(t-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&(removeEvent(window,"scroll"),removeEvent(window,"resize")))}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),addEvent(window,"scroll",this.onScrollTT.bind(this)),addEvent(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){var t=this.el.offsetWidth,e=this.el.offsetHeight,i=(0,o.getXY)(this.el);attr(window.onboardingBGClip,"width",t+this.border[1]+this.border[3]),attr(window.onboardingBGClip,"height",e+this.border[0]+this.border[2]),attr(window.onboardingBGClip,"x",i[0]-this.border[1]),attr(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){var t=this.getPageHeight();window.onboardingBG.height!=t&&this.setDartToFullHeight()}setDartToFullHeight(){attr(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){attr(window.onboardingBG,"width",this.getPageWidth()),attr(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,o.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),show(window.onboardingBG),(0,o.isVisible)(window.onboardingBGHeader)||(show(window.onboardingBGHeader),addClass(ge(_),d)))}removeDarkens(){this.hideDarkness&&(hide(window.onboardingBG),hide(window.onboardingBGHeader),removeClass(ge(_),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){var t=document.documentElement,e=document.body;return Math.max(e.scrollWidth,t.scrollWidth,e.offsetWidth,t.offsetWidth,e.clientWidth,t.clientWidth)}getPageHeight(){var t=document.documentElement,e=document.body;return Math.max(e.scrollHeight,t.scrollHeight,e.offsetHeight,t.offsetHeight,e.clientHeight,t.clientHeight)}}},491792:(t,e,i)=>{function o(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}i.d(e,{isElementInViewport:()=>o})},587041:(t,e,i)=>{i.d(e,{vkIndexer:()=>o});i(820075),i(976142),i(66108),i(296253),i(751876),i(283946);function o(t,e,i){this.list=t,this.iterCur=0,this.iterEnd=t?t.length:0,this.index={},this.callback=i||function(){},this.prepareFunc=e||function(t){return t},setTimeout(this.indexIteration.bind(this),10)}o.prototype.delimiter=o.delimiter=new RegExp("[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\#\\+\\?\\\\]+","g"),o.prototype.trimmer=new RegExp("^[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\+\\?\\\\]+|[\\s\\-,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\\\]+$","g"),o.prototype.toTranslit={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1078:"zh",1079:"z",1080:"i",1081:"y",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"ts",1095:"ch",1096:"sh",1097:"sh",1099:"y",1101:"e",1102:"yu",1103:"ya",1105:"e",1098:"",1100:""},o.prototype.toLocalCase={f:"a",",":"b","<":"b",d:"v",u:"g",l:"d",t:"e",";":"zh",":":"zh",p:"z",b:"i",q:"y",r:"k",k:"l",v:"m",y:"n",j:"o",g:"p",h:"r",c:"s",n:"t",e:"u",a:"f","[":"h","{":"kh",w:"ts",x:"ch",i:"sh",o:"sh",s:"y","'":"e",'"':"e",".":"yu",">":"yu",z:"ya","`":"e","~":"e",m:"","]":"","}":""},o.prototype.toLocalTranslit={1072:"f",1074:"d",1075:"u",1076:"l",1077:"t",1079:"p",1080:"b",1081:"q",1082:"r",1083:"k",1084:"v",1085:"y",1086:"j",1087:"g",1088:"h",1089:"c",1090:"n",1091:"e",1092:"a",1094:"w",1095:"x",1096:"i",1097:"o",1099:"s",1103:"z",1098:"m"},o.prototype.indexIteration=function(){for(var t=Math.min(this.iterEnd,this.iterCur+200),e=this.iterCur;e<t;e++){var i=this.list[e];try{i._order=e}catch(t){}this.add(i)}this.iterCur=e,e>=this.iterEnd?this.callback(this):setTimeout(this.indexIteration.bind(this),10)},o.prototype.strToPrefixes=function(t){for(var e={},i=winToUtf(t).toLowerCase().split(this.delimiter),o=i.length;o--;){var s=i[o],a="";if(s){for(var r=0;r<6;r++){var l=s.charCodeAt(r);if(l){var n=this.toTranslit[l],_=s.substr(r,1);a+=null!=n?n:_}}e[a]=1}}return e},o.prototype.strToSearchPrefixes=function(t){for(var e=[],i=t.toLowerCase().split(this.delimiter),o=i.length;o--;){var s={},a=i[o],r="",l="",n="",_=a.length>1;if(a){for(var d=0;d<6;d++){var u=a.charCodeAt(d);if(u){var h=this.toTranslit[u],c=a.substr(d,1);if(r+=null!=h?h:c,_){var p=this.toLocalCase[c],g=this.toLocalTranslit[u];l+=null!=p?p:c,n+=null!=g?g:c}}}s[r]=1,_&&(s[l]=2,s[n]=3),e.push(s)}}return e},o.prototype.toIndexTree=function(t,e){for(var i=this.index,o=0;o<6;o++){var s=t.substr(o,1)||-1;i=i[s]?i[s]:i[s]=5==o?[]:{}}i.push(e)},o.prototype.remove=function(t){var e=this.prepareFunc(t),i=this.strToPrefixes(e);for(var o in i)if(i.hasOwnProperty(o)){for(var s=this.index,a=0;a<6;a++){var r=o.substr(a,1)||-1;if(!s[r])break;s=s[r]}if(s.length)for(var l in s)if(this.equals(s[l],t)){s.splice(l,1);break}}},o.prototype.equals=function(t,e){for(var i in t)if(t.hasOwnProperty(i))switch(typeof t[i]){case"object":if(!this.equals(t[i],e[i]))return!1;break;case"function":if(void 0===t[i]||t[i].toString()!=e[i].toString())return!1;break;default:if(t[i]!=e[i])return!1}for(var o in e)if(void 0===e[o])return!1;return!0},o.prototype.intersect=function(t,e){var i=[];if(isNumeric(t[0])||isNumeric(e[0]))return t.filter((function(t){return-1!==e.indexOf(t)}));for(;t.length>0&&e.length>0;)t[0]._order<e[0]._order?t.shift():(t[0]._order>e[0]._order||this.equals(t[0],e[0])&&i.push(t.shift()),e.shift());return i},o.prototype.add=function(t){var e=this.prepareFunc(t),i=this.strToPrefixes(e);for(var o in i)i.hasOwnProperty(o)&&this.toIndexTree(o,t)},o.prototype.search=function(t){var e=this.index,i=this.strToSearchPrefixes(t),o=[],s=!1;for(var a in i)if(i.hasOwnProperty(a)){if(s&&!o)break;var r=this.localSearch(i[a],0,e);r.sort((function(t,e){return t._order-e._order})),o=s?this.intersect(o,r):r,s=!0}for(var l=o[0],n=o.length+1,_=[],d=1;d<n;d++){var u=o[d];u!=l&&(_.push(l),l=u)}return _},o.prototype.localSearch=function(t,e,i){if(!i)return[];var o={};for(var s in t)if(t.hasOwnProperty(s)){var a=s.substr(e,1)||-1;o[a]||(o[a]={}),o[a][s]=1}if(6==e++||!i)return i;var r=[];for(var l in o)if(-1==l)for(var n in i)i.hasOwnProperty(n)&&r.push.apply(r,this.localSearch(o[l],e,i[n]));else{var _=this.localSearch(o[l],e,i[l]);r.push.apply(r,_)}return r}},49282:(t,e,i)=>{i.d(e,{default:()=>l});var o=i(414914),s=i(917685),a=i(503369);function r(t,e){if(this.constructor!=r)throw new Error("Slider was called without 'new' operator");if(!t)throw new Error("No element was provided for Slider");t=ge(t),this.options=e||{size:1},this.options.backValue=this.options.backValue||0;var i=100*this.options.backValue,s=`<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> ${this.options.withBackLine?'<div class="slider_back" style="width:'+i+'%"></div>':""} <div class="slider_amount"></div> <div class="slider_handler"></div> </div>`;this._el=ce("div",{innerHTML:s,className:"slider",id:t.getAttribute("id")||""});for(var l=t.classList||[],n=this,_=0,d=l.length;_<d;_++)addClass(this._el,l[_]);each(this._el.attributes,(function(t,e){"id"==e.name&&"class"==e.name||n._el.setAttribute(e.name,e.value)})),t.parentNode.replaceChild(this._el,t),(0,o.data)(this._el,"slider",this),this._amountEl=geByClass1("slider_amount",this._el),this._handlerEl=geByClass1("slider_handler",this._el),this._slideEl=geByClass1("slider_slide",this._el),this._backEl=geByClass1("slider_back",this._el),this._progressEl=geByClass1("slider_loading_bar",this._el),this.options.color&&(setStyle(this._amountEl,{backgroundColor:this.options.color}),setStyle(this._handlerEl,{backgroundColor:this.options.color})),this.options.handlerColor&&setStyle(this._handlerEl,{backgroundColor:this.options.handlerColor}),this.options.backColor&&setStyle(this._slideEl,{backgroundColor:this.options.backColor}),addClass(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,a.debounce)(this._onValueChange,this.options.debounce)),e.formatHint&&(addEvent(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),addEvent(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),addEvent(this._el,"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}r.prototype.toggleAdState=function(t){this._adState=!!t,(0,o.toggleClass)(this._el,"slider_ad_mode",!!t)},r.prototype.toggleAdMarker=function(t){t=!!t;var e=geByClass1("slider_ad_marker",this._el);if(t){if(!e){var i="onmouseover=\"showTooltip(this, {text: '"+getLang("global_audio_ad")+"', black: 1, shift: [16, 9, 10]})\"";e=(0,o.se)('<div class="slider_ad_marker_wrap" '+i+'><div class="slider_ad_marker"></div></div>'),(0,o.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,addClass(this._el,"slider_ad_marker_shown")}}else(0,o.re)(e),delete this._width,removeClass(this._el,"slider_ad_marker_shown")},r.prototype.showAdMarker=function(t){var e=(0,o.se)('<div class="slider_ad_marker"></div>');(0,o.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,addClass(this._el,"slider_ad_marker_shown")},r.prototype.isAdMode=function(){return hasClass(this._el,"slider_ad_mode")},r.prototype.setBlocked=function(t){this.blocked=t,addClass(this._el,"slider_blocked")},r.prototype.getBlocked=function(){return this.blocked},r.prototype.isBlocked=function(){return this.isAdMode()||this.getBlocked()},r.prototype.toggleLoading=function(t){t=!!t,(0,o.toggle)(this._progressEl,t),setStyle(this._progressEl,"opacity",t?1:0)},r.prototype.destroy=function(t){this.options.formatHint&&(removeEvent(this._el,"mousemove",this._ev_onMouseOver),removeEvent(this._el,"mouseleave",this._ev_onMouseLeave),removeEvent(this._el,"mousedown",this._ev_onMouseDown)),(0,o.re)(this._el),(0,o.re)(this._currHintEl)},r.prototype._updateHint=function(t,e){this._currHintEl||(this._currHintEl=(0,o.se)('<div class="slider_hint" id="slider_hint"></div>'),this.options.hintClass&&addClass(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl)),this._width=this._width||getSize(this._slideEl)[0];var i=this._getPos(),s=Math.round(t.pageX-i[0]),a=this._width;if((s=e?Math.min(Math.max(0,s),a):s)>=0&&s<=a){var r=s/a;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,r):r;var l=getSize(this._currHintEl);setStyle(this._currHintEl,{left:this._slideEl.offsetLeft+s-l[0]/2,top:this._slideEl.offsetTop-l[1]-10}),!e&&this._toggleHint(!0)}else!e&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},r.prototype._toggleHint=function(t){this.isAdMode()&&(t=!1),(0,o.toggleClass)(this._currHintEl,"visible",t)},r.prototype._onMouseOver=function(t){r._currenSliderDrag||hasClass(this._el,"active")||this._updateHint(t)},r.prototype._onMouseLeave=function(t){hasClass(this._el,"active")||this._toggleHint(!1)},r.prototype._onMouseDown=function(t){0==t.button&&(delete cur._sliderMouseUpNowEl,this._adState||this.getBlocked()||(addEvent(window,"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),addEvent(window,"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._width=getSize(this._slideEl)[0],this._onMouseMove(t),r._currenSliderDrag=this,addClass(this._el,"active"),(0,s.cancelEvent)(t)))},r.prototype._onMouseUp=function(t){cur._sliderMouseUpNowEl=this._el,removeEvent(window,"mousemove",this._ev_onMouseMove),removeEvent(window,"mouseup",this._ev_onMouseUp),clearTimeout(this._debounceto),this._onValueChange(),removeClass(this._el,"active"),r._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue)},r.prototype._onMouseMove=function(t){var e=this._getPos(),i=Math.max(t.pageX,e[0]);i=Math.min(i,e[0]+this._width),i-=e[0],this.setValue(i/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(t,!0),(0,s.cancelEvent)(t)},r.prototype._getPos=function(){return this._slidePos=getXY(this._slideEl)},r.LOGFBASE=35,r.prototype._logf=function(t){if(!this.options.log)return t;var e=r.LOGFBASE;return(Math.pow(e,t)-1)/(e-1)},r.prototype._unlogf=function(t){if(!this.options.log)return t;var e,i,o=r.LOGFBASE;return e=o,i=1+t*(o-1),Math.log(i)/Math.log(e)},r.prototype.setValue=function(t,e,i){if(!hasClass(this._el,"active")||i){var o=i?this._logf(t):t;if(this._currValue!=o){this._currValue=o;var s=i?t:this._unlogf(t);s=100*s+"%",setStyle(this._amountEl,{width:s}),setStyle(this._handlerEl,{left:s}),!e&&this._onValueChange()}}},r.prototype.setBackValue=function(t){(0,o.toggleClass)(this._backEl,"slider_back_transition",t>this._backValue),this._backValue=t;var e=100*t+"%";setStyle(this._backEl,{width:e})},r.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))};const l=r},257367:(t,e,i)=>{i.d(e,{default:()=>d});i(59357),i(751876);var o=i(206566),s=i(442699),a=i(414914),r=i(917685),l=i(190148),n=i(433394);class _{constructor(t,e){if(!(t=(0,n.getScrollElement)(t)))throw new Error("uiScroll container is undefined");t.__uiScroll__&&t.__uiScroll__.destroy(),this.options=extend({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1,noLazyLoadWatch:!1},e),this.options.native&&(this.options.shadows=!1),o.browser.mobile&&(this.options.stopScrollPropagation=!1),isArray(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:t,overflow:ce("div",{className:"ui_scroll_overflow"}),outer:ce("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:ce("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:ce("div",{className:"ui_scroll_shadow_top"}),shadowBottom:ce("div",{className:"ui_scroll_shadow_bottom"}),content:ce("div",{className:"ui_scroll_content clear_fix"}),barContainer:ce("div",{className:"ui_scroll_bar_container"}),barOuter:ce("div",{className:"ui_scroll_bar_outer"}),barInner:ce("div",{className:"ui_scroll_bar_inner"})},(0,a.data)(this.el.container,"ui-scroll",this);var i=(0,a.cf)(),l=["ui_scroll_container"];for(each(isArray(this.options.theme)?this.options.theme:trim(this.options.theme+"").split(/\s+/),(function(t,e){e&&l.push("ui_scroll_"+e+"_theme")})),addClass(this.el.container,l.join(" ")),this.options.hidden&&addClass(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=ce("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),i.appendChild(this.el.overflow),this.options.native?addClass(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),i.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),o.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){var d=(0,n.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),u=(0,n.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(d[0]),this.removeElements.push(u[0]),this.startResizeListening=function(){d[1](),u[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(i),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init(),this.options.noLazyLoadWatch||(window.LazyLoad&&LazyLoad.watch(this.el.outer),window.LazyLoad&&LazyLoad.scanDelayed());var h="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":o.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,h,function(t){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,r.cancelEvent)(t):this.isScrollEventUnused(t)?(0,r.cancelEvent)(t):(0,r.stopEvent)(t))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),each(this.options.scrollElements,function(t,e){this.addEvent(e,h,function(t){this.disabled||this.unnecessary||(this.scrollBy(_.scrollEventDelta(t)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(t)||(0,r.cancelEvent)(t))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(t){this.released=!1,this.noMore=!0;var e=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(t){removeEvent(document,"mouseup contextmenu touchend pointerup",e),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,addClass(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||removeClass(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(t,e,i,o){return this.removeEvents.push([t,e,i]),addEvent(t,e,i,void 0,void 0,o?{passive:!0}:void 0),i}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&removeEvent(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&removeEvent(document,"mousemove",this.dragHandler),each(this.removeEvents,(function(t,e){removeEvent.apply(null,e)})),this.el.overflow.parentNode==this.el.container){for(var t=(0,a.cf)();this.el.content.firstChild;)t.appendChild(this.el.content.firstChild);this.el.container.appendChild(t)}return(0,a.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),each(this.removeElements,(function(t,e){(0,a.re)(e)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(t){if((0,s.isFunction)(t)){this.animation&&this.animation.stop();var e=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;t(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-e}return this.api}updateBelow(t){if((0,s.isFunction)(t)){this.animation&&this.animation.stop();var e=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;t(),e&&this.scrollBottom(!1)}return this.api}fixBlocker(){o.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(t){this.options.native||(t&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),setStyle(this.el.container,"width",t?(0,a.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(t){this.disabled||this.inited&&this.emitter.emitEvent(t,[this.api])}static scrollEventDelta(t){var e=0,i=void 0!==t.deltaMode?t.deltaMode:"MozMousePixelScroll"==t.type?0:1;return"wheel"==t.type?e=t.deltaY:void 0!==t.wheelDeltaX&&void 0!==t.wheelDeltaY?(e=1/40*-t.wheelDeltaY,o.browser.mac&&o.browser.opera&&(e*=.1)):void 0!==t.wheelDelta?e=1/40*-t.wheelDelta:t.detail&&2===t.axis&&(e=t.detail),e*(1==i?15:2==i?450:1)}isScrollEventUnused(t){return _.scrollEventDelta(t)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(t){if(!t&&this.options.preserveEdgeBelow){var e=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),e&&this.scrollBottom(),this.options.stopScrollPropagation&&!t&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!t&&this.fixBlocker(),this.emitEvent("resize"))}disable(t){return this.disabled=!!t,t?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,a.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(t){if(!(this.disabled||this.dragging||this.options.native))return t||(t=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),addEvent(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),addEvent(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=t.screenY,(0,r.cancelEvent)(t),this.emitEvent("dragstart"),this.api}dragstop(t){if(!this.disabled&&this.dragging&&!this.options.native){if(t||(t=window.event),this.dragging=!1,this.dragstopHandler&&removeEvent(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&removeEvent(document,"mousemove",this.dragHandler),setStyle(bodyNode,"cursor",""),removeClass(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);var e=(t.pageY-(0,a.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,e,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,t&&"contextmenu"!==t.type&&(0,r.cancelEvent)(t),this.emitEvent("dragstop"),this.api}}drag(t){if(!this.disabled&&this.dragging&&!this.options.native){t||(t=window.event);var e=(t.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+e:this.dragScroll+e,this.dragged||(this.dragged=!0,setStyle(bodyNode,"cursor","pointer"),addClass(this.el.container,"ui_scroll_dragging")),(0,r.cancelEvent)(t),this.emitEvent("drag"),this.api}}scroll(t,e,i){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==t&&this.update(!0),e?(e="number"!=typeof e||!isFinite(e)||e%1?300:Math.abs(e),this.animation=new l.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:l.Fx.Transitions.easeOutCubic,onStep:function(t){this.el.outer.scrollTop=t.scrollTop}.bind(this),duration:e,onComplete:(0,s.isFunction)(i)?i.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:t})):(this.el.outer.scrollTop=t,(0,s.isFunction)(i)&&i(this.api)),this.api}scrollTop(t,e,i,o){if(t&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(e),i,o)}scrollBottom(t,e,i,o){if(t&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(e),i,o)}scrollBy(t,e,i){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(t),e,i)}scrollIntoView(t,e,i,o){if(t&&this.options.stopScrollPropagation&&this.fixBlocker(),(e=(0,n.getScrollElement)(e))&&e.compareDocumentPosition&&e.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){var r=(0,a.getXY)(e)[1],l=(0,a.getXY)(this.el.overflow)[1],_=(0,a.getSize)(e)[1];if(r<=l&&r+_>=l+this.api.data.viewportHeight||r>=l&&r+_<=l+this.api.data.viewportHeight)(0,s.isFunction)(o)&&(i?setTimeout(o.bind(this.api),0):o(this.api));else if(_>this.api.data.viewportHeight||r<l)this.scrollTop(!1,r-l+this.api.data.scrollTop-(this.options.shadows?(0,a.getSize)(this.el.shadowTop)[1]:0),i,o);else{var d=this.options.shadows?(0,a.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,r-l+this.api.data.scrollTop+_-this.api.data.viewportHeight+d,i,o)}}return this.api}update(t){var e,i;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));var o=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(t&&(e=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==e)||this.api.data.scrollTop!==o)){if(t&&(this.api.data.scrollHeight=e),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,o))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(!(i=(e=Math.max(this.options.minContentHeight,this.api.data.scrollHeight))<=this.api.data.viewportHeight)){var s=this.el.barOuter.offsetHeight;(t||this.barOuterHeight!==s)&&(this.barOuterHeight=s,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/e),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,n.nextFrame)((()=>{var t=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(e-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${t}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!i)&&(0,a.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!i),this.shadowBottom!=(this.api.data.scrollBottom&&!i)&&(0,a.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!i)),this.unnecessary!==i&&((0,a.toggleClass)(this.el.container,"ui_scroll_unnecessary",i),this.unnecessary=i,this.options.stopScrollPropagation&&this.fixBlocker(),i&&this.barInnerHeight&&this.barOuterHeight&&(0,n.nextFrame)(function(t){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";var i=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(e-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${i}%)`}.bind(this)))}return this.emitEvent("update"),this.options.noLazyLoadWatch||window.LazyLoad&&LazyLoad.scanDelayed(this.el.outer),(!this.options.reversed||o>=0)&&this.more(),!0}return!1}more(){var t=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,e=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&t<=e&&this.emitEvent("more")}}_.addResizeSensor=n.addResizeSensor;const d=_},433394:(t,e,i)=>{i.d(e,{nextFrame:()=>n,getScrollElement:()=>_,addResizeSensor:()=>d});var o,s=i(442699),a=i(206566),r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(t=>setTimeout(t,1)),l=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function n(t){o&&l(o),o=r(t)}function _(t){return(0,s.isString)(t)&&"_"===t[0]?geByClass1(t):ge(t)}function d(t,e){if((t=_(t))&&(0,s.isFunction)(e)){if(a.browser.msie9||a.browser.opera&&a.browser.version<13){var i=!1,o=!1,r=function t(){if(!l.contentDocument)return setTimeout(t,100);l.contentDocument.defaultView.removeEventListener("resize",e),l.contentDocument.defaultView.addEventListener("resize",e),e()},l=ce("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){o=!0,i&&r()}});return t.appendChild(l),t.__resizeSensor__=[l,function(){i=!0,o&&r()}]}var n=ce("div",{className:"ui_scroll_resize_sensor"}),d=ce("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),u=ce("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),h=ce("div"),c=ce("div"),p=null;return d.appendChild(h),u.appendChild(c),n.appendChild(d),n.appendChild(u),t.appendChild(n),t.__resizeSensor__=[n,d.onscroll=u.onscroll=function(){var i=(t.offsetWidth||1e4)+10,o=(t.offsetHeight||1e4)+10;h.style.width=i+"px",h.style.height=o+"px",d.scrollLeft=i,d.scrollTop=o,u.scrollLeft=i,u.scrollTop=o,p!==(p=i+" "+o)&&e()}]}}},881308:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21466),_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(414914),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(313020),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(442699),_web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(45150),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(917685),_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(892862),_web_lib_browser__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(206566),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(519921),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(927663),uiSearch={destroy:function(t){var e=uiSearch.getFieldEl(t);uiSearch.stopEvents(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeData)(e)},getWrapEl:function(t){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domClosest)("_wrap",t)},getFieldEl:function(t){return t=ge(t),hasClass("_field",t)?t:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domByClass)(uiSearch.getWrapEl(t),"_field")},stopEvents:function(t){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"eventHandlers")||[];each(e,(function(t,e){e.stop()}))},startEvents:function(t){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"eventHandlers")||[];each(e,(function(t,e){e.stop(),e.start()}))},init:function init(el,options){if(el&&(el=uiSearch.getFieldEl(el),el)){var wrapEl=uiSearch.getWrapEl(el),delayedInitOptions=!options&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domData)(wrapEl,"init-options");if(delayedInitOptions){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domData)(wrapEl,"init-options",null);var evalScript="(function() { return "+delayedInitOptions+" })()";try{uiSearch.init(el,eval(evalScript))}catch(t){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(t,evalScript)}}else if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(el,"inited")){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(el,"inited",1);var onKeyDown=uiSearch.onKeyDown.pbind(el),onBuffer=function(t){if("input"===t.type&&_web_lib_browser__WEBPACK_IMPORTED_MODULE_7__.browser.msie){var e=val(el);if(e===((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domData)(el,"prev-value")||""))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domData)(el,"prev-value",e)}setTimeout(uiSearch.onChanged.pbind(el,!1,t),0)},onBlur=uiSearch.onBlurred.pbind(el),mainHandler;if((0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_2__.placeholderInit)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(el,"opts",options),options.suggester)options.suggester.instance=new Suggester(el,extend(options.suggester,{type:options.suggester.type,historyItems:!!options.suggester.history&&options.suggester.historyItems,onSearch:function(t,e,i){t||(options.allowFiltersForEmpty||uiSearch.removeAllFilters(el),uiSearch.hideProgress(el)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.toggleClass)(wrapEl,"ui_search_field_empty",!t),options.onChange&&options.onChange.call(el,t,e,i)}})),mainHandler={start:function(){addEvent(el,"blur",onBlur),options.onBlur&&addEvent(el,"blur",options.onBlur),options.onFocus&&addEvent(el,"focus",options.onFocus)},stop:function(){removeEvent(el,"blur",onBlur),options.onBlur&&removeEvent(el,"blur",options.onBlur),options.onFocus&&removeEvent(el,"focus",options.onFocus)}};else{var searchBtn=geByClass1("_ui_search_button_search",wrapEl),onBtnClick=function(t){uiSearch.onEnter(el,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.elfocus)(el)};mainHandler={start:function(){addEvent(el,"keydown",onKeyDown),addEvent(el,"paste cut input",onBuffer),addEvent(el,"blur",onBlur),options.onBlur&&addEvent(el,"blur",options.onBlur),options.onFocus&&addEvent(el,"focus",options.onFocus),searchBtn&&addEvent(searchBtn,"click",onBtnClick)},stop:function(){removeEvent(el,"keydown",onKeyDown),removeEvent(el,"paste cut input",onBuffer),removeEvent(el,"blur",onBlur),options.onBlur&&removeEvent(el,"blur",options.onBlur),options.onFocus&&removeEvent(el,"focus",options.onFocus),searchBtn&&removeEvent(searchBtn,"click",onBtnClick)}}}if(mainHandler.start(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(el,"eventHandlers",[mainHandler]),options.params){var content=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.trim)(options.params.html));options.paramsTooltip=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_4__.default(geByClass1("_ui_search_params_button",wrapEl),{appendTo:wrapEl,content,autoShow:!1,customShow:!0,offset:[0,-2],shift:options.params.shift?options.params.shift:0}),options.paramsTooltip.build(),setTimeout((function(){(function initScript(){try{eval(options.params.script)}catch(t){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(t,options.params.script)}}).call(el)}))}options.fixed&&uiSearch.setFixed(el),options.noAutoDestroy||cur.destroy.push(uiSearch.stopEvents.pbind(el)),uiSearch.initFilters(el,options),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.isFunction)(options.onInit)&&options.onInit(el,options)}}},getOptions:function(t){var e=uiSearch.getWrapEl(t),i=geByClass1("_field",e);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(i,"opts")},toggleParameters:function(t){var e=uiSearch.getOptions(t);e.paramsTooltip&&e.paramsTooltip.toggle()},hideParameters:function(t){var e=uiSearch.getOptions(t);e.paramsTooltip&&e.paramsTooltip.hide()},saveHistorySearch:function(t,e,i,o,s,a){e||(e=val(t));var r=uiSearch.getOptions(t);r.suggester&&r.suggester.instance&&r.suggester.instance.saveHistoryItem(e,i,o,s,a)},onEnter:function(t,e){t=uiSearch.getFieldEl(t);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"opts"),o=t.getValue?t.getValue():t.value;return i.onEnter&&i.onEnter(t,o,e),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_5__.cancelEvent)(e)},onKeyDown:function(t,e){if(cur.preventInputActions&&-1!=[KEY.RETURN,KEY.ESC,KEY.DOWN,KEY.UP].indexOf(e.keyCode))return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_5__.cancelEvent)(e);if(e.keyCode==KEY.RETURN)return uiSearch.onEnter(t,e);if(e.keyCode==KEY.ESC){var i=!!val(t);return uiSearch.reset(t,!1,e),!i||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_5__.cancelEvent)(e)}setTimeout.pbind(uiSearch.onChanged.pbind(t,!1,e),0)},onBlurred:function(t,e){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"opts");i.onBlur&&i.onBlur.call(t,e)},onChanged:function(t,e,i){t=uiSearch.getFieldEl(t);var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"opts"),s=uiSearch.getWrapEl(t),a=t.getValue?t.getValue():t.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.toggleClass)(s,"ui_search_field_empty",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.trim)(a)),a||o.allowFiltersForEmpty||uiSearch.removeAllFilters(t),e||o.onChange&&o.onChange.call(t,a,i)},focus:function(t){t=uiSearch.getFieldEl(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.elfocus)(t)},reset:function(t,e,i){t=uiSearch.getFieldEl(t);var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"opts")||{},s=uiSearch.getWrapEl(t);(t.getValue?t.getValue():t.value)?(val(t,""),uiSearch.onChanged(t,e,i),e||o.onEnter&&o.onEnter(t,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.elfocus)(t)):o.in_tabs&&_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_6__.default.hideSearch(s),window.tooltips&&tooltips.destroyAll()},showProgress:function(t){t=uiSearch.getFieldEl(t);var e=uiSearch.getWrapEl(t);addClass(e,"ui_search_loading");var i=t.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.trim)(t.getValue()):t.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.toggleClass)(e,"ui_search_field_empty",!i)},hideProgress:function(t){t=uiSearch.getFieldEl(t);var e=uiSearch.getWrapEl(t);removeClass(e,"ui_search_loading");var i=t.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.trim)(t.getValue()):t.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.toggleClass)(e,"ui_search_field_empty",!i)},scrollResize:function(t){if(!_web_lib_browser__WEBPACK_IMPORTED_MODULE_7__.browser.mobile){t=uiSearch.getFieldEl(t);var e,i=uiSearch.getWrapEl(t),o=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domPN)(i),s=i&&hasClass(i,"ui_search_fixed"),a=ge(cur.uiSearchPageBlock)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("page_block",t),r=vk.staticheader?Math.max(0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getSize)(ge("page_header"))[1]-scrollNode.scrollTop):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getSize)(ge("page_header"))[1],l=i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isAncestor)(i,boxLayerWrap);if(i&&o&&(l||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("scroll_fix",i))&&(!t.ignoreFixed||s)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isVisible)(o))if(l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getXY)(o,!0)[1]<0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getXY)(o,!0)[1]<r){var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getStyle)(t,"width"));!s&&n&&(setStyle(o,"height",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getSize)(i)[1]),setStyle(i,"width",n),addClass(i,"ui_search_fixed"));var _=Math.min(0,Math.max(-bodyNode.scrollLeft,bodyNode.clientWidth-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getSize)(ge("page_layout"))[0]));if(setStyle(i,{marginLeft:_}),a){var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getXY)(a)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getSize)(a)[1]-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_9__.scrollGetY)()-t.offsetHeight;(e=Math.min(r,Math.max(-t.offsetHeight,d)))!==cur.lastUISearchPos&&(setStyle(i,"top",e),cur.lastUISearchPos=e)}}else s&&(setStyle(o,"height",""),setStyle(i,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,removeClass(i,"ui_search_fixed"))}},setStatic:function(t){t.ignoreFixed=!0;var e=uiSearch.getWrapEl(t),i=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domPN)(e);e&&i&&(setStyle(i,"height",""),setStyle(e,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,removeClass(e,"ui_search_fixed"))},setFixed:function(t){if(t.ignoreFixed=!1,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"resizeEventHandler")){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isAncestor)(t,boxLayerWrap)?boxLayerWrap:window,i=uiSearch.scrollResize.pbind(t),o={stop:removeEvent.pbind(e,"scroll",i),start:addEvent.pbind(e,"scroll",i)};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"eventHandlers")||[]).concat([o])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"resizeEventHandler",!0),o.start()}uiSearch.scrollResize(t)},initFilters:function(t,e){if(t){var i=uiSearch.getWrapEl(t),o=geByClass1("ui_search_fltr_control",i),s={start:function(){addEvent(o,"click",(function(t){hasClass(o,"shown")&&!hasClass(t.target,"ui_search_fltr_control")||r(o)})),addEvent(o,"mouseover",(function(){if(hasClass(o,"shown")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"hidetimer");t&&(clearTimeout(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"hidetimer",0)),r(o,!0)}})),addEvent(o,"mouseout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"hidetimer")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"hidetimer",setTimeout((function(){r(o,!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"hidetimer",0)}),200))}))},stop:removeEvent.pbind(o,"click mouseover mouseout")};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"eventHandlers")||[]).concat([s])),s.start();var a=uiSearch._getFiltersPane(t);addEvent(a,"click",(function(e){if(hasClass(e.target,"token_title")||hasClass(e.target,"token_del")){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("token",e.target),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domData)(i,"id");uiSearch.removeFilter(t,o)}}))}function r(t,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.toggleClass)(t,"shown",e)}},removeAllFilters:function(t){var e=uiSearch._getFiltersPane(t),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(e,"cur_filters");each(extend({},i),(function(e){uiSearch.removeFilter(t,e,!0)}))},toggleFilter:function(t,e,i,o){o?uiSearch.addFilter(t,e,i):uiSearch.removeFilter(t,e)},addFilter:function(t,e,i){if(e&&i){var o=uiSearch._getFiltersPane(t),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"cur_filters")||{};s[e]=i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"cur_filters",s);var a=uiSearch.getOptions(t);a.onFiltersChanged&&a.onFiltersChanged(s),uiSearch._renderFilters(t)}},removeFilter:function(t,e,i){var o=uiSearch._getFiltersPane(t),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"cur_filters")||{};if(s[e]){delete s[e],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(o,"cur_filters",s);var a=uiSearch.getOptions(t);a.onFilterRemoved&&a.onFilterRemoved(e,t,i),a.onFiltersChanged&&a.onFiltersChanged(s),uiSearch._renderFilters(t)}},_getFiltersPane:function(t){var e=uiSearch.getWrapEl(t)||t;return geByClass1("ui_search_filters_pane",e)},_renderFilters:function(t){clearTimeout((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"renderFiltersTO")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(t,"renderFiltersTO",setTimeout(uiSearch._doRenderFilters.pbind(t)))},_doRenderFilters:function(t){var e=uiSearch._getFiltersPane(t),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.data)(e,"cur_filters")||{},o=geByClass1("ui_search_filters",e);if(o)if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.isEmpty)(i))removeClass(e,"expanded"),setTimeout((function(){o.innerHTML="",hide(e)}),200);else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.show)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.addClassDelayed)(e,"expanded");var s=[],a={},r=0;each(i,(function(t,e){var i=!1,o=!1,l=t.match(/(.*?)_([^_]+)$/),n=l&&l[2]||!1;(l=l&&l[1]||!1)&&(void 0!==a[l]&&"from"===n?o=a[l]:void 0!==a[l]&&(i=a[l]+1),a[l]=r);var _=`<div class="token" id="token${t}" data-id="${t}">\n                         <div class="token_title">${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.replaceEntities)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_3__.clean)(e))}</div>\n                         <div class="token_del"></div>\n                       </div>`;!1!==o?s.splice(o,0,_):!1!==i?s.splice(i,0,_):s.push(_),r++})),o.innerHTML=s.join("")}}};const __WEBPACK_DEFAULT_EXPORT__=uiSearch},892862:(t,e,i)=>{i.d(e,{default:()=>n});var o=i(414914),s=i(442699),a=i(206566),r=i(917685),l={initTabs:function(t,e){if(!(a.browser.msie&&(0,s.intval)(a.browser.version)<10||a.browser.opera&&(0,s.intval)(a.browser.version)<15||hasClass(t,"ui_tabs_sliding"))){var i=(0,o.getSize)(e)[0],r=e.offsetLeft,l=(0,o.geByClass1)("_ui_tabs_slider",t);if(!(0,o.domData)(t,"inited"))setStyle(l,{width:i+"px",marginLeft:r})}},tryInit:function(t){if(!(0,o.domData)(t,"inited")){var e=(0,o.geByClass1)("ui_tab_group_sel",t)||(0,o.geByClass1)("ui_tab_sel",t);e&&l.initTabs(t,e),(0,o.domData)(t,"inited",1)}},goTab:function(t,e,i){if((0,r.checkEvent)(e))return!0;var s=(0,o.gpeByClass)("ui_tabs",t);return!(!i&&(0,o.geByClass1)("ui_tab_sel",s)==t)&&(l.switchTab(t),l.showProgress(s),nav.go(t,e,{tab:t}))},switchTab:function(t,e){var i=(0,o.gpeByClass)("ui_tabs",t),a=(0,o.geByClass1)("ui_tab_sel",i),r=null,n=null,_=hasClass(a,"ui_tab_group_item")?n=(0,o.gpeByClass)("ui_tab_group",a):a,d=hasClass(t,"ui_tab_group_item")?r=(0,o.gpeByClass)("ui_tab_group",t):t;if(t!=a){if(t!=d&&(l.toggleGroup(d,!1),l.resetLabel(d,t)),_){l.initTabs(i,_),(e=e||{}).noAnim||d===_||(addClass(i,"ui_tabs_sliding"),clearTimeout(cur.tabSlidingTO),cur.tabSlidingTO=setTimeout(removeClass.pbind(i,"ui_tabs_sliding"),300));var u=(0,o.geByClass1)("_ui_tabs_slider",i),h=(0,s.intval)(u.style.marginLeft),c={width:(0,o.getSize)(d)[0]+"px"};c[cssTransformProp]="translateX("+(d.offsetLeft-h)+"px)",setStyle(u,c),a!=_&&d!=_&&l.resetLabel(_),_!=a&&removeClass(_,"ui_tab_group_sel"),removeClass(a,"ui_tab_sel")}if(d!=t&&addClass(d,"ui_tab_group_sel"),addClass(t,"ui_tab_sel"),n&&removeClass(n,"ui_tab_hide_separator"),r){i=(0,o.geByClass1)("ui_tab_group_items",r,"div").children;var p=null;each(i,(function(t,e){"SPAN"===e.tagName?p=e:hasClass((0,o.domFC)(e),"ui_tab_sel")||hasClass(e,"unshown")||(p=null)})),p&&addClass(r,"ui_tab_hide_separator")}}return!1},resetLabel:function(t,e){var i=(0,o.geByClass1)("ui_tab_group_label",t,"span");i&&(i.innerHTML=(e||i).getAttribute("data-default-label"))},toggleGroup:function(t,e){var i=(0,o.data)(t,"visibletimer");i&&clearTimeout(i),(0,o.data)(t,"visibletimer",setTimeout(o.toggleClass.pbind(t,"visible",e),e?0:100)),(0,o.toggleClass)(t,"shown",e)},showGroup:function(t){var e=(0,o.data)(t,"hidetimer");e&&(clearTimeout(e),(0,o.data)(t,"hidetimer",0)),l.toggleGroup(t,!0)},hideGroup:function(t){(0,o.data)(t,"hidetimer")||(0,o.data)(t,"hidetimer",setTimeout((function(){l.toggleGroup(t,!1),(0,o.data)(t,"hidetimer",0)}),200))},showProgress:function(t){hasClass(t,"ui_tabs")||(t=(0,o.gpeByClass)("ui_tabs",t)),addClass(t,"ui_tabs_loading")},hideProgress:function(t){hasClass(t,"ui_tabs")||(t=(0,o.gpeByClass)("ui_tabs",t)),removeClass(t,"ui_tabs_loading")},showSearch:function(t,e){if(cur.viewAsBox)return cur.viewAsBox();if((0,r.checkEvent)(e))return!0;var i=(0,o.gpeByClass)("ui_tabs",t),s=(0,o.domByClass)(i,"_field");return addClass(i,"ui_tabs_search_opened"),uiSearch.focus(s),!1},hideSearch:function(t,e){if((0,r.checkEvent)(e))return!0;var i=(0,o.gpeByClass)("ui_tabs",t);return removeClass(i,"ui_tabs_search_opened"),!1}};const n=l},368887:(t,e,i)=>{i.d(e,{CatalogBannerStatCollector:()=>r});var o=i(570655),s=i(136471),a=i(76238),r=function(){function t(t,e){var i=this;this.blockId=e;this.observed_items=[],this.observer=new IntersectionObserver((function(t){return i.onView(t)}),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new a.ProductionStatCollector,this.viewCollector=new a.ViewStatCollector(this.productCollector),this.clickCollector=new a.ClickStatCollector(this.productCollector),this.elements=t,this.addHandlers()}return t.prototype.destroy=function(){var t=this;this.observer.disconnect(),this.observed_items.forEach((function(e,i){return t.sendViewStat(i)})),this.elements.forEach((function(e){return e.removeEventListener("mousedown",t.clickHandler)}))},t.prototype.addHandlers=function(){var t=this;this.clickHandler=this.onClick.bind(this),this.elements.forEach((function(e){return e.addEventListener("mousedown",t.clickHandler)})),this.elements.forEach((function(e){return t.observer.observe(e)}))},t.prototype.onClick=function(t){if(t.currentTarget&&t.currentTarget instanceof HTMLElement&&t.currentTarget.parentElement&&t.currentTarget.dataset.id){var e=parseInt(t.currentTarget.dataset.id),i={type:s.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:(0,o.__spreadArray)([],(0,o.__read)(t.currentTarget.parentElement.children)).indexOf(t.currentTarget)+1},a={type:s.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.clickCollector.logEvent(i,a)}},t.prototype.sendViewStat=function(t){if(void 0!==this.observed_items[t]){var e=(0,o.__assign)((0,o.__assign)({},this.observed_items[t]),{end_view:this.productCollector.getCurrentTime()}),i={type:s.EventItemType.CATALOG_BANNER,id:t,track_code:this.blockId};this.viewCollector.logEvent(e,i),delete this.observed_items[t]}},t.prototype.onView=function(t){var e=this;t.forEach((function(t){var i=t.target;if(i instanceof HTMLElement&&i.parentElement&&i.dataset.id){var a=parseInt(i.dataset.id);t.isIntersecting?void 0===e.observed_items[a]&&(e.observed_items[a]={type:s.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:e.productCollector.getCurrentTime(),end_view:"0",position:(0,o.__spreadArray)([],(0,o.__read)(i.parentElement.children)).indexOf(i)+1}):e.sendViewStat(a)}}))},t}()},190128:(t,e,i)=>{i.d(e,{ConsumeReason:()=>o,BannersController:()=>a});var o,s=i(368887);!function(t){t.Click="click",t.Close="close"}(o||(o={}));var a=function(){function t(t,e){this.blockContent=t,this.blockId=e;var i=this.getBanners();this.bannerStatCollector=new s.CatalogBannerStatCollector(i,e)}return t.prototype.getBanners=function(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))},t.prototype.setBannersEvents=function(){var t=this;this.getBanners().forEach((function(e){if(e.dataset.id){var i=parseInt(e.dataset.id);t.addConsumableClick(e,i),t.addConsumableCloseClick(e,i)}}))},t.prototype.checkItems=function(){this.getBanners().length||this.blockContent&&this.blockContent.remove()},t.prototype.destroy=function(){this.bannerStatCollector.destroy()},t}()},953514:(t,e,i)=>{i.d(e,{BannersController:()=>r});var o=i(570655),s=i(190128),a=i(64385),r=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.setBannersEvents(),o}return(0,o.__extends)(e,t),e.prototype.consumeBanner=function(t,e){a.ajax.post("/al_audio.php?act=consume_banner",{id:t,ref:this.blockId,reason:e},{onFail:function(){return!0}})},e.prototype.addConsumableClick=function(t,e){var i=this;t.classList.contains("BannerItem--consumable")&&t.dataset.id&&t.addEventListener("click",(function(){return i.consumeBanner(e,s.ConsumeReason.Click)}))},e.prototype.addConsumableCloseClick=function(t,e){var i=this,o=t.querySelector(".BannerItem__close");o instanceof HTMLElement&&(o.onclick=function(o){i.consumeBanner(e,s.ConsumeReason.Close),t.remove(),i.checkItems(),o.stopPropagation(),o.preventDefault()})},e.prototype.checkItems=function(){var t=this.getBanners();if(t.length){if(1===t.length){var e=this.blockContent.querySelectorAll(".audio_promo__control");e&&e.forEach((function(t){return t.remove()}))}}else this.blockContent&&this.blockContent.remove()},e}(s.BannersController)},207446:(t,e,i)=>{i.d(e,{BaseController:()=>l});var o=i(570655),s=i(41951),a=i(211553),r=i(96070),l=function(){function t(){}return t.prototype.fetchNext=function(){return this.fetchSection(this.id,this.nextFrom)},t.prototype.fetchSection=function(t,e,i){var s=this;return void 0===i&&(i={}),this.fetchInProgress=!0,new Promise((function(a,r){var l=(0,o.__assign)({section_id:t,start_from:e},i);window.nav.objLoc.claim&&(l.claim=window.nav.objLoc.claim),window.ajax.post("al_audio.php?act=load_catalog_section",l,{onDone:function(t,e,i){s.fetchInProgress=!1,a({blocks:t,data:e,blockItems:i})},onFail:function(){return r(),s.fetchInProgress=!1,!0}})}))},t.prototype.getId=function(){return this.id},t.getHint=function(t,e){switch(e.type){case s.HintType.Tooltip:return new a.TooltipHint(e,t);case s.HintType.Highlight:return new r.HighlightHint(e,t)}return null},t}()},375584:(t,e,i)=>{i.d(e,{BlockController:()=>f});var o=i(570655),s=i(602872),a=i(989646),r=i(207446),l=i(971456),n=i(513e3),_=i(304418),d=i(881308),u=i(953514),h=i(414914),c=i(311046),p=i(923678),g=i(395748),y=i(64385),f=function(t){function e(e,i){var s=t.call(this)||this;return s.section=e,s.block=i,s.listenEvents=[],s.setFromBlockContent(),s.blockItemsContainer=i.querySelector("."+a.BLOCK_ITEMS_CONTAINER),s.blockItemsContainer&&(s.initialItems=(0,o.__spreadArray)([],(0,o.__read)(s.blockItemsContainer.children))),s.blockContent&&"catalog_banners"==s.blockContent.dataset.type&&(s.bannersController=new u.BannersController(s.blockContent,s.getId())),s.initGallery(),s.loader=i.getElementsByClassName(a.AUTO_LIST_LOADER)[0],s.initSearch(),s.initSortSelector(),s.initHints(),s.initListenEvents(),s}return(0,o.__extends)(e,t),e.prototype.enable=function(){this.reorderer&&this.reorderer.enable()},e.prototype.disable=function(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.disable()},e.prototype.emitEvent=function(t){this.listenEvents.includes(t)&&this.reloadData()},e.prototype.initSearch=function(){var t=this.block.getElementsByClassName("ui_search");t.length&&Array.prototype.forEach.call(t,(function(t){return d.default.init(t)}))},e.prototype.initListenEvents=function(){var t,e;if(null===(t=this.blockContent)||void 0===t?void 0:t.dataset.listenEvents)try{this.listenEvents=JSON.parse(null===(e=this.blockContent)||void 0===e?void 0:e.dataset.listenEvents)}catch(t){}},e.prototype.onSectionInit=function(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(a.BLOCK_ITEMS_REORDERABLE)&&this.initListReorder(!!this.section.getId())},e.prototype.hasBlockName=function(t){return this.blockContent&&this.blockContent.classList.contains(a.BLOCK_ELEMENT+"__"+t)},e.prototype.reloadData=function(){var t=this;this.fetchSection(this.id,"").then((function(i){var o=i.blockItems,s=i.data;if(t.clearItems(),t.setItems(e.createNodesFromItems(o)),s.playlists&&s.playlists.length){var a=window.getAudioPlayer();a&&a.addWithReplacePlaylists(s.playlists.map((function(t){return new c.AudioPlaylist(t)})))}})).catch((function(){return!0}))},e.prototype.setFromBlockContent=function(){if(this.blockContent=this.block.classList.contains(a.BLOCK_CONTENT)?this.block:this.block.querySelector("."+a.BLOCK_CONTENT),this.blockContent){this.id=this.blockContent.dataset.id||"",this.nextFrom=this.blockContent.dataset.next||"",this.dataType=this.blockContent.dataset.type||null;var t=this.blockContent.classList.toString().match(/CatalogBlock__layout--(.*)/);this.layoutName=t&&t[1]}},e.prototype.clearList=function(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")},e.prototype.destroy=function(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.destroy(),this.bannersController&&this.bannersController.destroy()},e.prototype.hideLoader=function(){this.loader&&(this.loader.style.display="none")},e.prototype.showLoader=function(){this.loader&&(this.loader.style.display="")},e.prototype.setNextFrom=function(t){this.nextFrom=t,this.blockContent&&(this.blockContent.dataset.next=this.nextFrom)},e.prototype.setId=function(t){this.id=t,this.blockContent&&(this.blockContent.dataset.id=this.id),this.blockItemsContainer&&this.blockItemsContainer.dataset.playlistId&&(this.blockItemsContainer.dataset.playlistId=this.id)},e.prototype.setItems=function(t){this.blockItemsContainer&&this.dataType&&this.layoutName&&new p.BlockItemsReplacer(this.blockItemsContainer,this.dataType,this.layoutName).replaceItems(t)},e.prototype.resetItems=function(){var t;this.blockItemsContainer&&(this.clearItems(),(t=this.blockItemsContainer).append.apply(t,(0,o.__spreadArray)([],(0,o.__read)(this.initialItems))))},e.prototype.clearItems=function(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")},e.prototype.initAutoList=function(t){var e=this;void 0===t&&(t=[]);var i=t;this.blockItemsContainer&&(this.blockAutoList&&this.blockAutoList.destroy(),this.blockAutoList=new s.default(this.blockItemsContainer,{scrollNode:!1,onRendered:function(){return window.getAudioPlayer().updateCurrentPlaying()},onNoMore:function(){return e.hideLoader()},onNeedRows:function(t){if(e.showLoader(),i.length){var o=i;return i=[],void t(o)}e.nextFrom?e.fetchNext().then((function(i){var o=i.blockItems,s=i.data;e.setNextFrom(s.nextFrom),t(o)})).catch((function(){})):t(null)}}))},e.prototype.updateListReorder=function(){this.reorderer&&this.reorderer.update()},e.prototype.initListReorder=function(t){var e,i=this;switch(void 0===t&&(t=!0),this.dataType){case g.DataType.MusicAudios:e=function(e,o,s){return i.onAudioBlockReorder(e,o,s,t)};break;case g.DataType.MusicPlaylists:e=this.onPlaylistsBlockReorder.bind(this);break;default:e=function(){}}this.reorderer=new n.default(this.blockItemsContainer,"",{onReorder:e.bind(this)})},e.prototype.onAudioBlockReorder=function(t,e,i,o){window.currentAudioPage(this.block).onAudioRowsReorder(!o,t,e,i)},e.prototype.onPlaylistsBlockReorder=function(t,e,i){window.currentAudioPage(this.block).onPlaylistsReorder(t,e,i)},e.prototype.initSortSelector=function(){var t=this,e=this.block.querySelector("."+a.SORTER_ACTION);e&&(this.sortSelector=new l.BlockSorter(e,(function(e){y.ajax.post("/al_audio.php?act=replace_blocks",{replacement_ids:e},{onDone:function(e){return t.section.replaceBlocks(e.replacements,e.nextFrom,e.playlists)}})})))},e.prototype.initGallery=function(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(a.GALLERY)&&(this.gallery=new _.UIGallery(this.blockItemsContainer,{scrollY:!1}))},e.search=function(t,i,o,s){var a=e.findBlockById(t,s.target);a&&!a.fetchInProgress&&(o?a.fetchSection(i,"",{search_query:o}).then((function(t){var i=t.blockItems;a.setItems(e.createNodesFromItems(i))})).catch((function(){return!0})):a.resetItems())},e.showMore=function(t,i){var o=e.findBlockById(t,i);o&&!o.fetchInProgress&&o.fetchNext().then((function(t){var i=t.blockItems,s=t.data;o.setItems(e.createNodesFromItems(i)),o.nextFrom=s.nextFrom})).catch((function(){return!0}))},e.findBlockById=function(t,e){var i=window.currentAudioPage(e).catalogController.currentSection;return i?i.getBlockById(t):null},e.findBlockByElement=function(t){var e=(0,h.gpeByClass)("CatalogBlock__content",t);return(null==e?void 0:e.dataset.id)||null},e.createNodesFromItems=function(t){return t.map((function(t){var e=document.createElement("template");return e.innerHTML=t,e.content.firstChild}))},e.prototype.initHints=function(){var t=this;if(this.block.dataset.catalogHintId){var e=this.section.getHintById(this.block.dataset.catalogHintId);if(e){var i=r.BaseController.getHint(this.block,e);i&&this.section.hintsToShow.push(i),delete this.block.dataset.catalogHintId}}var s=this.block.querySelectorAll("[data-catalog-hint-id]");if(s.length){var a={};s.forEach((function(t){t.dataset.catalogHintId&&(Array.isArray(a[t.dataset.catalogHintId])?a[t.dataset.catalogHintId].push(t):a[t.dataset.catalogHintId]=[t],delete t.dataset.catalogHintId)})),Object.entries(a).forEach((function(e){var i=(0,o.__read)(e,2),s=i[0],a=i[1],l=t.section.getHintById(s);if(l){var n;n=1===a.length?a[0]:t.block;var _=r.BaseController.getHint(n,l);_&&t.section.hintsToShow.push(_)}}))}},e}(r.BaseController)},923678:(t,e,i)=>{i.d(e,{BlockItemsReplacer:()=>r});var o=i(570655),s=i(395748),a=i(845413),r=function(){function t(t,e,i){this.container=t,this.dataType=e,this.layoutName=i}return t.prototype.replaceItems=function(t){switch(this.dataType){case s.DataType.MusicAudios:this.replaceItemsBase(t);break;case s.DataType.MusicPlaylists:this.replaceMusicPlaylists(t);break;default:this.replaceItemsBase(t)}},t.prototype.replaceMusicPlaylists=function(t){var e=t;this.layoutName===a.LayoutName.LargeSlider&&(e=t.slice(0,5)),this.replaceItemsBase(e)},t.prototype.replaceItemsBase=function(t){var e;this.container.innerHTML="",(e=this.container).append.apply(e,(0,o.__spreadArray)([],(0,o.__read)(t)))},t}()},971456:(t,e,i)=>{i.d(e,{BlockSorter:()=>a});var o=i(570655),s=i(989646),a=function(){function t(t,e){this.element=t;var i=this.getConfig();this.dropdown=new window.InlineDropdown(t,(0,o.__assign)({onSelect:e},i))}return t.prototype.getConfig=function(){var t=this.element.querySelector("."+s.SORTER_ACTION_DATA);if(!t)return null;var e=Array.from(t.querySelectorAll("li"));if(0===e.length)return null;var i={};return i.items=e.map((function(t){var e=t.dataset.id||"";return t.dataset.selected&&(i.selected=e),[e,t.innerText]})),i.withArrow=!0,t.remove(),i},t}()},162440:(t,e,i)=>{i.d(e,{CatalogController:()=>a});var o=i(570655),s=i(113669),a=function(){function t(t){this.sections={},this.root=t;var e=this.root.querySelector(".CatalogSection--header_section");e instanceof HTMLElement&&(this.headerSection=new s.SectionController(e,{})),this.tabs=Array.from(this.root.querySelectorAll("._audio_section_tab .ui_tab"))}return t.prototype.setSection=function(t,e,i){this.sections[t]&&this.sections[t].getId()===i.sectionId?(this.currentSection=this.sections[t],this.enableSection(t)):(this.currentSection=new s.SectionController(e,i,this),this.sections[t]=this.currentSection)},t.prototype.disableSection=function(t){this.sections[t]&&this.sections[t].disable()},t.prototype.enableSection=function(t){this.sections[t]&&this.sections[t].enable()},t.prototype.emitEvent=function(t){Object.values(this.sections).forEach((function(e){return e.emitEvent(t)}))},t.prototype.deleteSection=function(t){var e=this.sections[t];e&&(e.destroy(),delete this.sections[t])},t.prototype.destroy=function(){Object.entries(this.sections).forEach((function(t){(0,o.__read)(t,2)[1].destroy()})),this.headerSection&&this.headerSection.destroy()},t.prototype.updateSectionReorder=function(){this.currentSection&&this.currentSection.updateReorder()},t}()},96070:(t,e,i)=>{i.d(e,{HighlightHint:()=>n});var o=i(570655),s=i(41951),a=i(160217),r=i(412685),l=i(927663),n=function(t){function e(e,i){var o=t.call(this,s.HintType.Highlight,e)||this,a={highlight:!0,width:280,offset:[0,-17],scrollOffset:40,side:"bottom"};return e.unskipable?a.ttOnHide=function(){}:a.onBGClick=function(){return o.hide()},o.highlight=new r.default(i,o.generateContent(),a),(0,l.disableBodyScroll)(),o}return(0,o.__extends)(e,t),e.prototype.show=function(){this.highlight.showTT()},e.prototype.hide=function(){this.highlight.hideTT(),(0,l.enableBodyScroll)(),t.prototype.hide.call(this)},e}(a.Hint)},160217:(t,e,i)=>{i.d(e,{Hint:()=>l});var o=i(570655),s=i(116886),a=i(917685),r=i(64385),l=function(){function t(t,e){this.type=t,this.id=e.id,this.title=e.title,this.text=e.text,this.hintId=e.hintId,this.hideHash=e.hideHash,this.actions=e.actions,e.currentStep&&e.totalSteps&&(this.tutorialSteps={current:e.currentStep,total:e.totalSteps})}return t.prototype.hide=function(){this.onHide&&this.onHide(),r.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:this.hintId,hash:this.hideHash})},t.prototype.generateContent=function(){var t=this,e=document.createElement("div");if(this.title&&(e.innerHTML+='<div class="CatalogHint__title">'+this.title+"</div>"),this.text&&(e.innerHTML+='<div class="CatalogHint__text">'+this.text+"</div>"),this.actions){var i=document.createElement("div");i.classList.add("CatalogHint__actions");var r=this.actions.map((function(e){var i=document.createElement("a");switch(i.classList.add("flat_button"),e.type){case"open_url":i.href=e.url,i.onclick=function(i){window.nav.go(e.url),t.hide(),(0,a.cancelEvent)(i)};break;case"switch_section":i.onclick=function(o){(0,a.cancelEvent)(o),window.currentAudioPage(i).catalogController.currentSection.switchSection(e.targetSectionId),t.hide()}}return i.innerHTML=e.label,i}));if(i.append.apply(i,(0,o.__spreadArray)([],(0,o.__read)(r))),this.tutorialSteps){var l=document.createElement("div");l.classList.add("CatalogHint__tutorialSteps"),l.innerHTML=(0,s.langStr)((0,s.getLang)("audio_onboarding_tutorial_progress"),"step",this.tutorialSteps.current,"total_steps",this.tutorialSteps.total),i.append(l)}e.append(i)}return e},t}()},41951:(t,e,i)=>{var o;i.d(e,{HintType:()=>o}),function(t){t.Tooltip="tooltip",t.Highlight="highlight"}(o||(o={}))},211553:(t,e,i)=>{i.d(e,{TooltipHint:()=>l});var o=i(570655),s=i(41951),a=i(160217),r=i(45150),l=function(t){function e(e,i){var a=this,l=i,n="center",_="top";i.classList.contains("CatalogBlock__layout--header")&&(l=i.querySelector(".CatalogBlock__title")||i,n="left"),i.classList.contains("MusicAuthor__follow_btn")&&(n="right",_="bottom"),a=t.call(this,s.HintType.Tooltip,e)||this;var d=(0,o.__assign)({force_side:_,align:n,offset_left:0,offset_top:0,width:"250px"},e);return a.tooltip=new r.default(l,{content:a.title||a.text||"",cls:"feature_intro_tt "+a.id+" CatalogTooltip",forceSide:d.force_side,align:d.align,width:d.width,offset:[d.offset_left,d.offset_top],autoShow:!1,onHide:function(){return a.hide()}}),a}return(0,o.__extends)(e,t),e.prototype.show=function(){this.tooltip.show()},e}(a.Hint)},113669:(t,e,i)=>{i.d(e,{SectionController:()=>d});var o=i(570655),s=i(311046),a=i(602872),r=i(375584),l=i(989646),n=i(207446),_=i(96070),d=function(t){function e(e,i,o){var s=t.call(this)||this;s.sectionData=i,s.catalogController=o,s.blocks=[],s.hintsToShow=[];var a=e.classList.contains(l.SECTION)?e:e.querySelector("."+l.SECTION);return a?(s.sectionEl=a,s.initBlocks(),s.nextFrom=void 0===s.sectionEl.dataset.next?i.nextFrom:s.sectionEl.dataset.next,s.id=i.sectionId,i.playlists&&i.playlists.length&&s.addPlaylists(i.playlists),i.playlist&&s.setPagePlaylist(i.playlist),s.isBlockPagination=s.sectionData.isBlockPagination,s.initSectionAutoList(),s.hideShowMoreLoaders(),s.initTabsHints(),s.sectionInited(),s.showHints(),s):s}return(0,o.__extends)(e,t),e.prototype.showHints=function(){var t=this;if(this.hintsToShow.length){var e=void 0,i=this.hintsToShow.filter((function(t){return t instanceof _.HighlightHint}));i.length?(e=i[0],this.hintsToShow.splice(this.hintsToShow.indexOf(e),1),e.onHide=function(){return t.showHints()},e.show()):this.hintsToShow.forEach((function(t){return t.show()}))}},e.prototype.getSectionElement=function(){return this.sectionEl},e.prototype.enable=function(){this.initSectionAutoList(),this.blocks.forEach((function(t){return t.enable()}))},e.prototype.disable=function(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks.forEach((function(t){return t.disable()}))},e.prototype.emitEvent=function(t){this.blocks.forEach((function(e){return e.emitEvent(t)}))},e.prototype.switchSection=function(t){var e,i=null===(e=this.catalogController)||void 0===e?void 0:e.tabs;i&&i.forEach((function(e){e.dataset.sectionId===t&&e.click()}))},e.prototype.replaceBlocks=function(t,e,i){var s=this,a=!1;i&&this.addPlaylists(i),t.forEach((function(t){var e,i,l=t.fromIds.map((function(t){return s.getBlockById(t)})).filter((function(t){return null!==t})),n=null;if(l.length&&(null===(i=l[l.length-1])||void 0===i?void 0:i.block)&&(n=l[l.length-1].block),n){var _=r.BlockController.createNodesFromItems(t.toBlocks);_.forEach((function(t){return null==n?void 0:n.insertAdjacentElement("beforebegin",t)})),a=a||l.some((function(t){return t===s.paginatedBlockController})),l.forEach((function(t){t.block.remove(),t.destroy(),s.blocks=s.blocks.filter((function(e){return e!==t}))}));var d=_.map((function(t){return new r.BlockController(s,t)}));(e=s.blocks).push.apply(e,(0,o.__spreadArray)([],(0,o.__read)(d))),s.hideShowMoreLoaders()}})),"string"==typeof e&&this.setNextFrom(e),a&&(this.initPaginatedBlock(),e&&(this.isBlockPagination?this.initBlockAutoList([],this.nextFrom):this.sectionAutoList.isDone()&&this.initSectionAutoList()))},e.prototype.sectionInited=function(){this.blocks.forEach((function(t){return t.onSectionInit()}))},e.prototype.initTabsHints=function(){var t,e=this,i=null===(t=this.catalogController)||void 0===t?void 0:t.tabs;i&&i.forEach((function(t){if(t.dataset.catalogHintId){var i=e.getHintById(t.dataset.catalogHintId);if(i){var o=n.BaseController.getHint(t,i);o&&e.hintsToShow.push(o),delete t.dataset.catalogHintId}}}))},e.prototype.getHintById=function(t){return this.sectionData.hints&&this.sectionData.hints[t]||null},e.prototype.destroy=function(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks&&this.blocks.forEach((function(t){return t.destroy()}))},e.prototype.getBlockById=function(t){return this.blocks&&this.blocks.find((function(e){return e.getId()===t}))||null},e.prototype.reloadBlock=function(t){var e=this.findBlockByBlockName(t);e&&e.reloadData()},e.prototype.updateReorder=function(){this.blocks&&this.blocks.forEach((function(t){t.updateListReorder()}))},e.prototype.hideShowMoreLoaders=function(){this.blocks.forEach((function(t){return t.hideLoader()}))},e.prototype.addPlaylists=function(t){var e=window.getAudioPlayer();t.forEach((function(t){if(t){var i=new s.AudioPlaylist(t);i.getAudiosList().length||i.mergeWith(t),e.addPlaylist(i)}}))},e.prototype.setPagePlaylist=function(t){var e=window.currentAudioPage(this.sectionEl),i=window.getAudioPlayer().getPlaylist(t.type,t.ownerId,t.id,"",t.blockId);i.getAudiosCount()||(i.mergeWith(t),i.load()),e.setPagePlaylist(i)},e.prototype.setNextFrom=function(t){this.nextFrom=t,this.sectionEl&&(this.sectionEl.dataset.next=t)},e.prototype.initSectionAutoList=function(){var t=this;this.sectionAutoList&&this.sectionAutoList.destroy(),this.sectionAutoList=new a.default(this.sectionEl,{fetchImmediate:!1,onNeedRows:function(e){var i;if(t.isBlockPagination)return t.initBlockAutoList(),void e(null);t.nextFrom?(null===(i=t.paginatedBlockController)||void 0===i||i.showLoader(),t.fetchNext().then((function(i){var o=i.blocks,s=i.data,a=i.blockItems;(t.nextFrom=s.nextFrom,t.setNextFrom(s.nextFrom),s.isBlockPagination||s.blockIds&&1===s.blockIds.length&&t.getBlockById(s.blockIds[0]))?(e(null),t.isBlockPagination=t.isBlockPagination||s.isBlockPagination,t.initBlockAutoList(a,t.nextFrom),s.playlist&&"search"===s.playlist.type&&window.getAudioPlayer().getPlaylist().sendSearchStats("search_view")):(s.playlists&&t.addPlaylists(s.playlists),e(o||null),t.initBlocks())})).catch((function(){}))):e(null)}})},e.prototype.initBlocks=function(){var t=this;this.blocks=[];var e=[];(0,o.__spreadArray)([],(0,o.__read)(this.sectionEl.getElementsByClassName(l.BLOCK_ELEMENT))).forEach((function(t){t.classList.contains(l.BLOCK_DIVIDED)?t.querySelectorAll("."+l.BLOCK_CONTENT).forEach((function(t){return e.push(t)})):e.push(t)})),this.blocks=e.map((function(e){return new r.BlockController(t,e)})),this.initPaginatedBlock()},e.prototype.initPaginatedBlock=function(){var t=this.sectionEl.querySelector("."+l.PAGINATED_BLOCKS_CONTAINER);if(t){var e=(0,o.__spreadArray)([],(0,o.__read)(t.getElementsByClassName(l.BLOCK_CONTENT))),i=e[e.length-1].dataset.id;i&&(this.paginatedBlockController=this.getBlockById(i))}else this.paginatedBlockController=this.blocks[this.blocks.length-1]},e.prototype.initBlockAutoList=function(t,e){void 0===t&&(t=[]),this.paginatedBlockController&&(void 0!==e&&this.paginatedBlockController.setNextFrom(e),this.paginatedBlockController.initAutoList(t))},e.prototype.findBlockByBlockName=function(t){return this.blocks.find((function(e){return e.hasBlockName(t)}))},e}(n.BaseController)},395748:(t,e,i)=>{var o;i.d(e,{DataType:()=>o}),function(t){t.MusicAudios="music_audios",t.MusicPlaylists="music_playlists"}(o||(o={}))},845413:(t,e,i)=>{var o;i.d(e,{LayoutName:()=>o}),function(t){t.LargeSlider="large_slider",t.List="list"}(o||(o={}))},989646:(t,e,i)=>{i.d(e,{SECTION:()=>o,PAGINATED_BLOCKS_CONTAINER:()=>s,BLOCK_ITEMS_CONTAINER:()=>a,BLOCK_ITEMS_REORDERABLE:()=>r,BLOCK_ELEMENT:()=>l,BLOCK_DIVIDED:()=>n,AUTO_LIST_LOADER:()=>_,BLOCK_CONTENT:()=>d,SORTER_ACTION:()=>u,SORTER_ACTION_DATA:()=>h,GALLERY:()=>c});var o="CatalogSection",s="CatalogSection__paginatedBlocks",a="CatalogBlock__itemsContainer",r="CatalogBlock__itemsContainer--reorderable",l="CatalogBlock",n="CatalogBlock--divided",_="CatalogBlock__autoListLoader",d="CatalogBlock__content",u="CatalogBlock__sorter",h="CatalogBlock__sortingData",c="ui_gallery"},165003:(t,e,i)=>{i.d(e,{FullscreenBanner:()=>n});var o=i(64385),s=i(791563),a=i(190128),r=i(76238),l=i(136471),n=function(){function t(t,e,i){this.sectionId=t,this.bannerId=e,this.productCollector=new r.ProductionStatCollector,this.viewCollector=new r.ViewStatCollector(this.productCollector),this.box=new s.MessageBox({bodyStyle:"padding: 0",width:655,containerClass:"FullscreenBanner",noControls:!0}),this.box.content(i),this.addEventListeners(),this.show()}return t.initiate=function(e){t.fetch(e).then((function(i){var o=i.banner,s=i.bannerId;return o?new t(e,s,o):null})).catch((function(){return null}))},t.prototype.show=function(){this.box.show(),this.startView=this.productCollector.getCurrentTime()},t.prototype.hide=function(){this.box.hide(),this.sendViewStat()},t.prototype.sendViewStat=function(){var t={end_view:this.productCollector.getCurrentTime(),start_view:this.startView},e={type:l.EventItemType.AUDIO_FULLSCREEN_BANNER,id:this.bannerId,track_code:this.sectionId};this.viewCollector.logEvent(t,e)},t.fetch=function(t){return new Promise((function(e,i){o.ajax.post("/audio?act=get_fullscreen_banner",{section_id:t},{onDone:function(t){(null==t?void 0:t.bannerId)?e(t):i()},onFail:function(){return i(),!0}})}))},t.prototype.addEventListeners=function(){var t=this,e=this.box.bodyNode.querySelector(".FullscreenBanner__closeButton");e&&e.addEventListener("click",this.close.bind(this)),this.box.bodyNode.querySelectorAll(".FullscreenBanner__button").forEach((function(e){e.addEventListener("click",(function(){t.consume(e.dataset.reason||a.ConsumeReason.Click)}))}))},t.prototype.close=function(){this.consume(a.ConsumeReason.Close),this.hide()},t.prototype.consume=function(t){o.ajax.post("/al_audio.php?act=consume_banner",{id:this.bannerId,type:"fullscreen",track_code:this.sectionId,reason:t})},t}()},370885:(t,e,i)=>{var o=i(195435),s=i(558672),a=i(375584);window.AudioPage||(window.AudioPage=s.AudioPage,window.currentAudioPage=s.currentAudioPage),window.PlayList||(window.PlayList=o.default),window.BlockController=a.BlockController;try{window.stManager.done(window.jsc("web/audio.js"))}catch(t){}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto;function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(t,e,i,o)=>{if(!e){var s=1/0;for(n=0;n<deferred.length;n++){for(var[e,i,o]=deferred[n],a=!0,r=0;r<e.length;r++)(!1&o||s>=o)&&Object.keys(__webpack_require__.O).every((t=>__webpack_require__.O[t](e[r])))?e.splice(r--,1):(a=!1,o<s&&(s=o));if(a){deferred.splice(n--,1);var l=i();void 0!==l&&(t=l)}}return t}o=o||0;for(var n=deferred.length;n>0&&deferred[n-1][2]>o;n--)deferred[n]=deferred[n-1];deferred[n]=[e,i,o]},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},getProto=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,__webpack_require__.t=function(t,e){if(1&e&&(t=this(t)),8&e)return t;if("object"==typeof t&&t){if(4&e&&t.__esModule)return t;if(16&e&&"function"==typeof t.then)return t}var i=Object.create(null);__webpack_require__.r(i);var o={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var s=2&e&&t;"object"==typeof s&&!~leafPrototypes.indexOf(s);s=getProto(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>t[e]));return o.default=()=>t,__webpack_require__.d(i,o),i},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.e=()=>Promise.resolve(),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={5318:0};__webpack_require__.O.j=e=>0===t[e];var e=(e,i)=>{var o,s,[a,r,l]=i,n=0;for(o in r)__webpack_require__.o(r,o)&&(__webpack_require__.m[o]=r[o]);if(l)var _=l(__webpack_require__);for(e&&e(i);n<a.length;n++)s=a[n],__webpack_require__.o(t,s)&&t[s]&&t[s][0](),t[a[n]]=0;return __webpack_require__.O(_)},i=self.webpackChunkvk=self.webpackChunkvk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var __webpack_exports__=__webpack_require__.O(void 0,[885,8592],(()=>__webpack_require__(370885)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();