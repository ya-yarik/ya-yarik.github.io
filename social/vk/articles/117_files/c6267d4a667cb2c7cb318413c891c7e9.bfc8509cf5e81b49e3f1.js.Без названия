(window.webpackJsonp=window.webpackJsonp||[]).push([["c6267d4a667cb2c7cb318413c891c7e9"],{"36Mz":function(e,t,o){"use strict";o.r(t),o.d(t,"Settings",(function(){return M}));o("91GP"),o("Oyvg"),o("OG14"),o("hhXQ"),o("SRfc"),o("rGqo"),o("pIFo"),o("KKXr"),o("HEwt"),o("VRzm"),o("Btvt");var s,n=o("q1tI"),i=o.n(n),a=o("zxIV"),c=o("t7n3"),r=o("ryw6"),l=o("lXE5"),u=o("Egk5"),p=o("v+DW"),d=o("4+be"),g=o("4tce"),_=o("Xrg9"),h=o("98sY"),b=o("wVf2"),f=o("aong"),m=o("EasH"),O=o("FWc3"),j=o("dV62"),w=o("jmhT"),v=o("BiHW"),y=o("6krn"),B=o("WfnU"),k=o("n3cE"),x=o("ngxX"),S=o("ZxpX"),C=o("jE6c"),T=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),P=function(){return(P=Object.assign||function(e){for(var t,o=1,s=arguments.length;o<s;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},L=function(e){function t(t){var o=e.call(this,t)||this;o.save=function(){var e=o.props,t=e.onSave,s=e.data,n=o.state,i=n.isRecognitionMeEnabled,a=n.showMyRecognizedPhotosToFriends,c=n.isRecognitionFriendsEnabled,r=n.showMyRecognizedPhotosBlock,l=n.showFriendsRecognizedPhotosBlock;o.setState({isLoad:!0}),window.ajax.post("al_settings.php",{act:"save_recognition",is_recognition_me_disabled:Object(C.intval)(!i.value),show_recognition_photos_to_friends:Object(C.intval)(a.value),is_recognition_friends_enabled:Object(C.intval)(c.value),show_my_recognized_photos_block:Object(C.intval)(r.value),show_friends_recognized_photos_block:Object(C.intval)(l.value),hash:s.hash},{onDone:function(){t&&t()},hideProgress:function(){o.setState({isLoad:!1})},onFail:function(e){return Object(m.showFastBox)(Object(y.getLang)("global_error"),e||Object(y.getLang)("global_unknown_error")),!0}})},o.onRecognitionMeChange=function(e,t){o.setState({showMyRecognizedPhotosBlock:{disabled:!t,value:!!t&&o.state.showMyRecognizedPhotosBlock.value},showMyRecognizedPhotosToFriends:{disabled:!t,value:!!t&&o.state.showMyRecognizedPhotosToFriends.value},isRecognitionMeEnabled:P(P({},o.state.isRecognitionMeEnabled),{value:t})})},o.onShowMyRecognizedPhotoToFriendsChange=function(e,t){o.setState({showMyRecognizedPhotosToFriends:P(P({},o.state.showMyRecognizedPhotosToFriends),{value:t})})},o.onRecognitionFriendsChange=function(e,t){o.setState({isRecognitionFriendsEnabled:P(P({},o.state.isRecognitionFriendsEnabled),{value:t})})},o.onShowMyRecognizedBlockChange=function(e,t){o.setState({showMyRecognizedPhotosBlock:P(P({},o.state.showMyRecognizedPhotosBlock),{value:t})})},o.onShowFriendsRecognizedBlockChange=function(e,t){o.setState({showFriendsRecognizedPhotosBlock:P(P({},o.state.showFriendsRecognizedPhotosBlock),{value:t})})};var s=t.data;return o.state={isLoad:!1,isRecognitionMeEnabled:{value:s.isRecognitionMeEnabled.value},showMyRecognizedPhotosToFriends:{value:s.showMyRecognizedPhotosToFriends.value,disabled:!s.isRecognitionMeEnabled.value},isRecognitionFriendsEnabled:{value:s.isRecognitionFriendsEnabled.value},showMyRecognizedPhotosBlock:{value:s.showMyRecognizedPhotosBlock.value,disabled:!s.isRecognitionMeEnabled.value},showFriendsRecognizedPhotosBlock:{value:s.showFriendsRecognizedPhotosBlock.value}},o}return T(t,e),t.prototype.render=function(){var e=this.props,t=e.onClose,o=e.data,s=this.state,n=s.isRecognitionMeEnabled,a=s.showMyRecognizedPhotosToFriends,c=s.isRecognitionFriendsEnabled,r=s.showMyRecognizedPhotosBlock,l=s.showFriendsRecognizedPhotosBlock;return i.a.createElement(w.BoxModal,{className:"PhotoRecognitionSettingsBox",appearance:"white",hasScroll:!1,title:Object(y.getLang)("photo_recognition_settings_box_title"),actionButtons:this.getActionModalButtons(),onClose:t},i.a.createElement("div",{className:"PhotoRecognitionSettingsBox__content"},i.a.createElement("section",{className:"PhotoRecognitionSettingsBox__section"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__wrapper"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__info"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__title"},Object(y.getLang)("photo_recognition_settings_is_recognize_me")),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__description"},Object(y.getLang)("photo_recognition_settings_is_recognize_me_description"),i.a.createElement(k.default,{href:"/@vk-ai-photo-tags",className:"PhotoRecognitionSettingsBoxRow__learnMore",target:"_blank"},Object(y.getLang)("photo_recognition_settings_learn_more")))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__control"},i.a.createElement(x.default,{checked:n.value,onChange:this.onRecognitionMeChange})))),i.a.createElement("div",{className:Object(S.classNames)("PhotoRecognitionSettingsBoxRow",{"PhotoRecognitionSettingsBoxRow--disabled":a.disabled||o.showMyRecognizedPhotosToFriends.forceDisable})},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__wrapper"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__info"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__title"},Object(y.getLang)("photo_recognition_settings_show_recognition_photos_to_friends")),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__description"},Object(y.getLang)("photo_recognition_settings_show_recognition_photos_to_friends_description"))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__control"},i.a.createElement(x.default,{checked:a.value,onChange:this.onShowMyRecognizedPhotoToFriendsChange})))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__wrapper"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__info"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__title"},Object(y.getLang)("photo_recognition_settings_recognition_friends_enabled")),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__description"},Object(y.getLang)("photo_recognition_settings_recognition_friends_enabled_description"))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__control"},i.a.createElement(x.default,{checked:c.value,onChange:this.onRecognitionFriendsChange}))))),i.a.createElement("section",{className:"PhotoRecognitionSettingsBox__section"},i.a.createElement("div",{className:Object(S.classNames)("PhotoRecognitionSettingsBoxRow",{"PhotoRecognitionSettingsBoxRow--disabled":r.disabled})},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__wrapper"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__info"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__title"},Object(y.getLang)("settings_photos_user_recognition_block")),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__description"},Object(y.getLang)("photo_recognition_settings_show_my_recognized_photos_block_description"))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__control"},i.a.createElement(x.default,{checked:r.value,onChange:this.onShowMyRecognizedBlockChange})))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__wrapper"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__info"},i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__title"},Object(y.getLang)("settings_photos_friends_recognition_block")),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__description"},Object(y.getLang)("photo_recognition_settings_show_friends_recognized_photos_block_description"))),i.a.createElement("div",{className:"PhotoRecognitionSettingsBoxRow__control"},i.a.createElement(x.default,{checked:l.value,onChange:this.onShowFriendsRecognizedBlockChange})))))))},t.prototype.getActionModalButtons=function(){var e=this.props.onClose,t=this.state.isLoad;return[i.a.createElement(v.default,{key:"close",appearance:"tertiary",onClick:function(){return e()}},Object(y.getLang)("global_cancel")),i.a.createElement(B.default,{key:"publish",appearance:"primary",onClick:this.save,loading:t},Object(y.getLang)("global_save"))]},t}(i.a.Component),N=o("HLtZ"),R=o("MJEz");function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e}).apply(this,arguments)}var M={registerStartupHandlers:function(){Object(R.tq)().setStartupHandler("Settings/update_lang",e=>(window.cur.lang=E({},window.cur.lang||{},{},e.payload.data),Promise.resolve(!1))),Object(R.tq)().setStartupHandler("Settings/update_options",e=>{window.cur.options=JSON.parse(e.payload.data)}),Object(R.tq)().setStartupHandler("Settings/init_blacklist",()=>{M.initBlacklist()})},registerInteractiveHandlers:function(){Object(R.tq)().setInteractiveHandler("Settings/add_to_blacklist_dialog",()=>{M.addToBlacklist()}),Object(R.tq)().setInteractiveHandler("Settings/add_to_blacklist",e=>{var t=e.payload.dataAttrs,o=t.id,s=t.hash;M.addToBl(parseInt(o),s,e.payload.event.target)}),Object(R.tq)().setInteractiveHandler("Settings/do_add_to_blacklist",e=>{var t=e.payload.dataAttrs.mid;M.doAddToBlacklist(parseInt(t),e.payload.event.target)}),Object(R.tq)().setInteractiveHandler("Settings/remove_from_blacklist",e=>{var t=e.payload.dataAttrs,o=t.id,s=t.hash;M.delFromBl(parseInt(o),s,e.payload.event.target)}),Object(R.tq)().setInteractiveHandler("Settings/remove_top_from_blacklist",e=>{var t=e.payload.dataAttrs,o=t.id,s=t.hash;M.delTopFromBl(parseInt(o),s,e.payload.event.target)}),Object(R.tq)().setInteractiveHandler("Settings/more_search_box",()=>{M.moreSearchBox(!1)})},go:function(e,t){var o=M.getsect();return!1===Object(u.checkEvent)(t)&&(o.className="",e.parentNode.className="active_link"),nav.go(e,t)},getsect:function(){for(var e=Object(a.ge)("settings_filters").firstChild;!Object(a.hasClass)(e,"active_link");)e=e.nextSibling;return e},showMsg:function(e,t){t||(t=Object(a.ge)("settings_result")),e?(Object(r.showMsg)(t,e,"ok_msg",!0),Object(a.show)(t)):Object(a.hide)(t),Object(l.scrollToTop)(0)},showError:function(e,t){e=e||Object(d.getLang)("global_unknown_error");var o=t?Object(a.ge)("settings_error_"+t):Object(a.ge)("settings_result");Object(r.showMsg)(o,e,"error",!0),Object(a.show)(o),t||Object(l.scrollToTop)(0)},toggleBlock:function(e,t){var o,s;e&&e.target?(o=e.target,s=Object(a.hasClass)(o,"settings_line")?o:Object(a.gpeByClass)("settings_line",o)):(e=Object(a.ge)(e),o=Object(a.geByClass1)("settings_right_control",e),s=Object(a.hasClass)(e,"settings_line")?e:Object(a.gpeByClass)("settings_line",e)),s&&Object(a.geByClass1)("settings_change_block",s)&&(!Object(a.hasClass)(s,"unfolded")||Object(a.hasClass)(o,"settings_right_control"))&&(cur.changingSetting&&cur.changingSetting!==s&&(Object(a.removeClass)(cur.changingSetting,"unfolded"),window.tooltips&&tooltips.hideAll()),Object(a.toggleClass)(s,"unfolded"),cur.changingSetting=s,t&&Object(a.elfocus)(t))},savePrivacyKey:function(e){if("friends"!==e){var t,o={key:e,val:Privacy.getValue(e),hash:cur.options.hash};if("search_access"===e||"updates"===e||"company_messages"===e||"profile_closed"===e){if("updates"===e){var s=Privacy.getValue(e);if("0"!==s.substr(0,1))s.substr(2).length||(Object(a.ge)("privacy_header").innerHTML=Object(a.ge)("privacy_edit_updates").innerHTML=Object(d.getLang)("settings_updates_no_news"))}t="al_settings.php",o.act="a_save_special"}else t="al_friends.php",o.act="save_privacy";clearTimeout(cur["privacy_timer_"+e]),cur["privacy_timer_"+e]=setTimeout(ajax.post.pbind(t,o,{onDone:function(t){if(t)return nav.reload({preventScroll:!0,onDone:function(e){M.savePrivacyShowSaved(e),updateNarrow()}.pbind(e)});M.savePrivacyShowSaved(e)}}),500)}else window.uiPageBlock&&uiPageBlock.showSaved("privacy_friends_hide")},savePrivacyShowSaved:function(e){window.uiPageBlock&&uiPageBlock.showSaved("privacy_edit_"+e)},initPrivacy:function(){if(cur.onPrivacyChanged=M.savePrivacyKey,cur.privacyNeedConfirm=function(e,t,o){if("profile_closed"===e&&Object(c.intval)(t)){var s=new MessageBox({title:Object(d.getLang)("settings_closed_profile_confirm_title")});return s.content(Object(d.getLang)("settings_closed_profile_confirm_text")),s.removeButtons().addButton(Object(d.getLang)("settings_closed_profile_confirm_btn"),(function(){o(),s.hide()})),s.addButton(Object(d.getLang)("global_cancel"),s.hide,"no"),void s.show()}o()},nav.objLoc.hl){var e=Object(a.geByClass1)("_"+nav.objLoc.hl);M.scrollHighlightPrivacy(e)}},highlightPrivacy(e){(e=Object(a.ge)(e))&&(Object(a.addClass)(e,"setting_row_selected"),Object(a.addClassDelayed)(e,"setting_row_animated",1500),Object(a.removeClassDelayed)(e,"setting_row_selected",2500),Object(a.removeClassDelayed)(e,"setting_row_animated",2500))},scrollHighlightPrivacy:function(e){(e=Object(a.ge)(e))&&setTimeout((function(){var t=Object(a.getXY)(e)[1],o=Object(a.getSize)("page_header")[1],s=Object(l.scrollGetY)(),n=Object(a.clientHeight)();t<o+s||t>s+n?(Object(l.scrollToY)(t),setTimeout(M.highlightPrivacy.pbind(e),300)):M.highlightPrivacy(e)}),0)},initSearchBox:function(e,t,o){Object(c.extend)(cur,t),o&&ajax.preload(cur.searchBoxAddress,cur.searchBoxParams,o),window.uiScrollBox&&uiScrollBox.init(e,{onShow:function(){Object(u.addEvent)(boxLayerWrap,"scroll",M.boxScrollResize),setTimeout(M.boxScrollResize,0)},onHide:function(){Object(u.removeEvent)(boxLayerWrap,"scroll",M.boxScrollResize)}}),Object(u.addEvent)(boxLayerWrap,"scroll",M.boxScrollResize),M.boxScrollResize()},boxScrollResize:function(){if(!browser.mobile){var e=lastWindowHeight,t=Object(a.ge)(cur.boxMoreLink);t&&Object(a.isVisible)(t)&&e>Object(a.getXY)(t,!0)[1]&&cur.boxShowMore()}},moreSearchBoxLoaded:function(e,t,o){cur.loading=!1,cur.searchBoxParams.offset=t;var s=cur.boxRows,n=Object(a.ce)("div",{innerHTML:e});for(Object(a.toggle)(cur.boxMoreLink,o);n.firstChild;)s.appendChild(n.firstChild)},moreSearchBox:function(e,t,o){var s=cur.boxMoreLink;!(e||Object(a.isVisible)(s)&&!Object(a.hasClass)(s,"loading"))||e&&o==cur.searchBoxParams.q||(cur.loading?cur.loading=2:(e&&(cur.oldBoxParams={q:cur.searchBoxParams.q,offset:cur.searchBoxParams.offset},Object(c.extend)(cur.searchBoxParams,{q:o,offset:0})),ajax.post(cur.searchBoxAddress,cur.searchBoxParams,{onDone:function(o,s,n,i){if(e){if(i)return Object(c.extend)(cur.searchBoxParams,cur.oldBoxParams),Object(a.val)(t,cur.oldBoxParams.q),void(cur.searchBoxFound&&cur.searchBoxFound(i));cur.boxRows.innerHTML=o?"":cur.boxNoRowsTpl,curBox().tbToTop()}M.moreSearchBoxLoaded.apply(window,arguments)},onFail:function(){return cur.loading=0,!0},showProgress:function(){Object(a.addClass)(s,"loading")},hideProgress:function(){Object(a.removeClass)(s,"loading")}})))},moreSearchBoxChange:function(e,t){t&&"paste"==t.type?M.moreSearchBox(!0,curBox().tbSearchField,e):e.length||M.moreSearchBox(!0,curBox().tbSearchField,"")},initBlacklist:function(){Object(a.ge)("settings_bl_msg")&&setTimeout(a.removeClass.pbind(Object(a.ge)("settings_bl_msg"),"msg_appear"),0),Object(a.elfocus)("settings_bl_search")},searchBlacklist:function(e){e&&(e=e.toLowerCase());var t=Object(a.ge)("settings_bl_empty"),o=Object(d.getLang)("settings_blacklist_not_found_by_query"),s=Object(a.ge)("settings_bl_list"),n=0;Array.from(Object(a.geByClass)("settings_bl_row",s)).forEach(t=>{if(e){var o=Object(a.geByClass1)("settings_bl_name",t);(Object(a.val)(Object(a.geByTag1)("a",o))||Object(a.val)(Object(a.geByClass1)("name_label"))).toLowerCase().indexOf(e)>-1?(Object(a.show)(t),n++):Object(a.hide)(t)}else Object(a.show)(t),n++}),e&&!n?(t.innerHTML=o.split("{query}").join("<b>"+e.replace(/([<>&#]*)/g,"")+"</b>"),Object(a.show)(t),Object(a.hide)("settings_bl_noempty")):(Object(a.hide)(t),Object(a.show)("settings_bl_noempty"))},doAddToBlacklist:function(e,t){ajax.post("al_settings.php",{act:"search_blacklist",query:e,hash:cur.options.blacklist_hash},{onDone:function(e,t,o){curBox().emit("success",o),curBox().hide();var s=Object(a.ge)("settings_bl_summary");e&&-1!=e&&s&&(s.innerHTML=Object(d.langNumeric)(e,"%s",!0));var n=Object(a.ce)("div",{innerHTML:t}).firstChild,i=Object(a.ge)("settings_bl_list");Object(a.re)(n.id),i&&(i.insertBefore(n,i.firstChild),Object(a.show)("settings_bl_noempty"),Object(a.hide)("settings_bl_empty"),Object(r.showMsg)("settings_bl_result",o,"ok_msg",!0))},onFail:function(e){return Object(r.showMsg)("settings_search_rows",e,"error",!0),!0},showProgress:function(){"BUTTON"===t.tagName?Object(p.lockButton)(t):uiSearch.showProgress(t)},hideProgress:function(){"BUTTON"===t.tagName?Object(p.unlockButton)(t):uiSearch.hideProgress(t)}})},addToBlacklist:function(){return showBox("al_settings.php",{act:"blacklist_box"},{params:{dark:!0}}),!1},addToBl:function(e,t,o){ajax.post("al_settings.php",{act:"a_add_to_bl",id:e,hash:t,from:"settings"},{onDone:function(t){t&&(Object(a.ge)("settings_bl_summary").innerHTML=Object(d.langNumeric)(t,"%s",!0)),Object(a.hide)("settings_bl_label"+e),o.setAttribute("data-task-click","Settings/remove_from_blacklist"),o.innerHTML=Object(d.getLang)("settings_remove")},onFail:function(e){return setTimeout(Object(m.showFastBox)({title:Object(d.getLang)("global_error"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},e).hide,2e3),!0},showProgress:function(){Object(a.hide)(o),Object(a.show)("settings_progress"+e)},hideProgress:function(){Object(a.show)(o),Object(a.hide)("settings_progress"+e)}})},delFromBl:function(e,t,o){ajax.post("al_settings.php",{act:"a_del_from_bl",id:e,hash:t,from:"settings"},{onDone:function(t){Object(a.ge)("settings_bl_summary").innerHTML=t?Object(d.langNumeric)(t,"%s",!0):"",Object(a.setStyle)("settings_bl_label"+e,"display","inline"),o.setAttribute("data-task-click","Settings/add_to_blacklist"),o.innerHTML=Object(d.getLang)("settings_restore_blacklist")},onFail:function(e){return setTimeout(Object(m.showFastBox)({title:Object(d.getLang)("global_error"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},e).hide,2e3),!0},showProgress:function(){Object(a.hide)(o),Object(a.show)("settings_progress"+e)},hideProgress:function(){Object(a.show)(o),Object(a.hide)("settings_progress"+e)}})},delTopFromBl:function(e,t,o){var s=Object(a.ce)("img",{src:"/images/upload.gif"});ajax.post("al_settings.php",{act:"a_del_from_bl",id:e,hash:t,from:"settings"},{onDone:function(t){t&&(Object(a.ge)("settings_bl_summary").innerHTML=t?Object(d.langNumeric)(t,"%s",!0):""),Object(a.setStyle)("settings_bl_label"+e,"display","inline");var o=Object(a.geByTag1)("a",Object(a.geByClass1)("settings_bl_action",Object(a.ge)("settings_bl_row"+e)));o.setAttribute("data-task-click","Settings/add_to_blacklist"),o.innerHTML=Object(d.getLang)("settings_restore_blacklist"),Object(a.hide)("settings_bl_result")},showProgress:function(){o.parentNode.replaceChild(s,o)},hideProgress:function(){s.parentNode.replaceChild(o,s)}})},saveSmsNotify:function(e){Object(p.lockButton)(e);var t={act:"a_save_sms_notify",hash:cur.options.notify_hash};Object(c.each)(cur.options.notify_sms_keys,(function(e,o){t[o]=Privacy.getValue(o)})),t.smsenabled=Object(p.isChecked)("smsenabled")?1:0,Object(p.isChecked)("daytime")?(t.daytime_from=Object(a.ge)("daytime_from").value,t.daytime_to=Object(a.ge)("daytime_to").value):(t.daytime_from=0,t.daytime_to=0),Object(a.val)("settings_notify_sms_result",""),ajax.post("al_settings.php",t,{onDone:function(t,o,s){Object(p.unlockButton)(e),o&&s?Object(m.showFastBox)({title:t,dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},o,Object(d.getLang)("settings_subscribe_to_service_btn"),(function(){window.open(s),curBox().hide()}),Object(d.getLang)("box_cancel"),(function(){Object(p.checkbox)("smsenabled",0),M.smsNotifyCheck(),M.saveSmsNotify(),curBox().hide()})):Object(r.showMsg)("settings_notify_sms_result",t,"ok_msg",!0)},onFail:function(t){Object(p.unlockButton)(e),Object(p.checkbox)("smsenabled",0),M.smsNotifyCheck(),M.saveSmsNotify()}})},updateInstantSounds:function(e){Object(a.toggleClass)(Object(a.geByClass1)("_ui_toggler",e),"on"),_.default.set("sound_notify_off",Object(a.hasClass)(Object(a.geByClass1)("_settings_isounds"),"on")?0:1),uiPageBlock.showSaved(e)},saveSiteNotify:function(e){Object(a.toggleClass)(Object(a.geByClass1)("_ui_toggler",e),"on");var t={act:"a_save_site_notify",hash:cur.options.notify_hash,ienable:Object(a.hasClass)(Object(a.geByClass1)("_settings_ienable"),"on")?1:0,itexts:Object(a.hasClass)(Object(a.geByClass1)("_settings_itexts"),"on")?1:0};Object(c.each)(Object(a.geByClass)("_settings_nf_bt"),(function(e,o){t["nf_bt_"+o.getAttribute("data-id")]=+Object(a.hasClass)(o,"on")})),cur.options.notify_privacy_keys&&cur.options.notify_privacy_keys.forEach((function(e){t["nf_"+e]=0|Privacy.getValue(e)})),clearTimeout(cur.instantNotifyTO),clearTimeout(cur.instantNotifySaveTO),cur.instantNotifyTO=setTimeout(ajax.post.pbind("al_settings.php",t,{onDone:function(){cur.instantNotifySaveTO=setTimeout(window.uiPageBlock&&uiPageBlock.showSaved.pbind(e),1e3)}}),500),TopNotifier&&TopNotifier.invalidate()},saveBrowserNotify:function(e){var t="browser_notification",o=Object(a.ge)("privacy_edit_"+t),s=Number(Privacy.getValue(t));Object(a.addClass)(o,"privacy_link_disabled"),pushNotifier.canBeEnabled().then((function(n){n?pushNotifier.setupSubscription().then((function(){return Object(a.removeClass)(o,"privacy_link_disabled"),pushNotifier.setState(s,cur.options.push_notify_hash)})).catch((function(s){g.default.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS===s?pushNotifier.showPopupAllowNotification():Object(m.showFastBox)(Object(d.getLang)("global_error"),Object(d.getLang)("notifications_native_common_error")),Privacy.setValue(t,e),Object(a.removeClass)(o,"privacy_link_disabled")})):(Privacy.setValue(t,e),Object(a.removeClass)(o,"privacy_link_disabled"),Object(m.showFastBox)(Object(d.getLang)("global_error"),Object(d.getLang)("notifications_native_common_error")))}))},saveGroupNotify:function(e,t){if(Object(a.hasClass)(Object(a.geByClass1)("_ui_toggler",e),"ui_toggler_disable"))return!1;Object(a.toggleClass)(Object(a.geByClass1)("_ui_toggler",e),"on");var o={act:"a_save_group_notify",hash:cur.options.notify_hash,gid:t};Object(c.each)(Object(a.geByClass)("ui_toggler",Object(a.domClosest)("wide_column",e)),(function(e,t){o[t.getAttribute("data-id")]=+Object(a.hasClass)(t,"on")})),clearTimeout(cur.instantNotifyTO),clearTimeout(cur.instantNotifySaveTO),cur.instantNotifyTO=setTimeout(ajax.post.pbind("al_settings.php",o,{onDone:function(){cur.instantNotifySaveTO=setTimeout(window.uiPageBlock&&uiPageBlock.showSaved.pbind(e),1e3)}}),500),TopNotifier&&TopNotifier.invalidate()},checkboxSiteNotify:function(e,t){t.target&&Object(a.hasClass)(t.target,"item_sel")||(Object(p.checkbox)(e),M.saveSiteNotify(e))},saveMailNotify:function(e){var t={act:"a_save_mail_notify",hash:cur.options.notify_hash,mail_period:Privacy.getValue("mail_period")};Object(c.each)(cur.options.notify_mail_keys,(function(e,o){t[o]=Object(p.isChecked)(o)?1:0})),clearTimeout(cur.mailNotifyTO),cur.mailNotifyTO=setTimeout(ajax.post.pbind("al_settings.php",t,{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind(e)}),500)},saveNotifyPrivacyKey:function(e,t){"browser_notification"===e?M.saveBrowserNotify(t):"mail_period"===e?(M.saveMailNotify("privacy_edit_"+e),3==Privacy.getValue(e)?Object(a.hide)("mail_options"):Object(a.show)("mail_options")):cur.options.notify_privacy_keys&&~cur.options.notify_privacy_keys.indexOf(e)?M.saveSiteNotify("privacy_edit_"+e):"sms_pm_notify"===e&&(0!=Privacy.getValue(e)?Object(a.hide)("sms_pm_privacy_row"):Object(a.show)("sms_pm_privacy_row"))},initNotify:function(){cur.options.msg&&M.showMsg(cur.options.msg);var e=Object(a.geByClass1)("_settings_isounds");Object(a.toggleClass)(e,"on",!_.default.get("sound_notify_off")),Object(a.removeClassDelayed)(e,"no_transition"),cur.reloadOnMailBind=!0,cur.onPrivacyChanged=M.saveNotifyPrivacyKey;for(var t=[],o=24;o--;)t.unshift((o<10?"0":"")+o+":00");var s=Object(a.ge)("daytime_from"),n=Object(a.ge)("daytime_to");s&&n&&(void 0!==cur.options.time_from&&new Dropdown(s,t,{selectedItems:cur.options.time_from}),void 0!==cur.options.time_to&&new Dropdown(n,t,{selectedItems:cur.options.time_to}))},smsNotifyCheck:function(){Object(p.isChecked)("smsenabled")?(slideDown(Object(a.ge)("sms_options"),200),Object(a.show)("sms_options_msg")):Object(a.isVisible)("sms_options")&&(Object(a.hide)("sms_options_msg"),slideUp(Object(a.ge)("sms_options"),200))},smsDayTimeCheck:function(){Object(p.isChecked)("daytime")?slideDown(Object(a.ge)("daytime_from_to"),200):slideUp(Object(a.ge)("daytime_from_to"),200)},checkPIN:function(e){var t=e.value.replace(/[^0-9]/g,"");e.value!==t&&(e.value=t)},updatePIN:function(e){Object(p.lockButton)(Object(a.ge)("pin_btn")),Object(a.val)("settings_pin_result","");var t={act:"a_change_pin",pin:Object(a.ge)("pin").value,hash:e};ajax.post("al_settings.php",t,{onDone:function(e){Object(p.unlockButton)(Object(a.ge)("pin_btn")),Object(a.val)("settings_pin_value",t.pin),Object(r.showMsg)("settings_pin_result",e,"ok_msg",!0)},onFail:function(e){return Object(p.unlockButton)(Object(a.ge)("pin_btn")),Object(r.showMsg)("settings_pin_result",e,"error",!0),!0}})},getAdminSelectShowCt:function(e){return Object.keys(e).filter((function(t){return e[t]})).length},initMenuBox:function(e,t,o){this.initMenuEvents(e),e.setOptions({onHide:function(){cur.adminGroupsDirty&&(window.Notifier&&Notifier.resetCommConnection(),ajax.post("al_settings.php",{act:"a_get_left_menu"},{onDone:function(e){Object(a.geByTag1)("ol",Object(a.ge)("side_bar")).innerHTML=e}})),2==t&&Object(c.isFunction)(cur.settingsBoxSetLeftMenuAppCallback)&&cur.settingsBoxSetLeftMenuAppCallback(!1)}}),cur.menuSettings=o,this.updateMenuBoxCount(t)},initMenuEvents:function(e){var t=Object(a.geByClass1)("olist",e.bodyNode),o=Object(a.geByClass1)("summary_tabs",e.bodyNode);Object(a.setStyle)(o,"display","inline-block");var s=Object(a.getSize)(o)[0]+parseInt(Object(a.getStyle)(o,"marginLeft"))+parseInt(Object(a.getStyle)(o,"marginRight"));s>450&&e.setOptions({width:Math.ceil(s)}),Object(a.setStyle)(o,"display",null),Object(u.addEvent)(t,"scroll",this.onMenuBoxScroll.pbind(e,t)),this.onMenuBoxScroll(e,t)},onMenuBoxScroll:function(e,t){var o=Object(a.domPN)(e.bodyNode),s=t.scrollHeight,n=t.scrollTop,i=t.offsetHeight||t.clientHeight;Object(a.toggleClass)(o,"olist_topsh",n>0),Object(a.toggleClass)(o,"olist_botsh",n+i<s)},updateMenuBoxCount:function(e){var t=curBox(),o=cur.menuSettings[e]||{},s=M.getAdminSelectShowCt(o),n="";if(1==e||2==e){var i=cur.menuSettings.limits[e];n='<span class="settings_menu_box_counter">'+Object(d.getLang)("settings_admin_groups_left").replace("{count}",s).replace("{amt}",i)+"</span>"}t.setControlsText(n)},toggleMenuBoxRow:function(e,t,o){var s=cur.menuSettings[t]||{},n=M.getAdminSelectShowCt(s),i=s[o];if(curBox().changed=!0,1==t||2==t){var c=cur.menuSettings.limits[t];if(Object(a.toggleClass)(Object(a.gpeByClass)("olist_section",e),"settings_menu_rows_disabled",!i&&n>=c-1),!i&&n>=c)return!1}return Object(a.toggleClass)(e,"olist_item_wrap_on",!i),s[o]=i?0:1,M.updateMenuBoxCount(t),!1},switchMenuBoxSection:function(e,t){var o=curBox();Object(c.each)(Object(a.geByClass)("olist_section",o.bodyNode),(function(){Object(a.hide)(this)})),Object(a.show)("settings_menu_"+t),Object(a.geByClass1)("olist",o.bodyNode).scrollTop=0,M.updateMenuBoxCount(t)},saveMenu:function(e,t){for(var o=curBox(),s=[],n=[],i=[],r=[],l={hash:e,act:"a_change_services"},u=!1,d=function(e){var t=cur.menuSettings[e]||{};Object(c.each)(t,(function(t,o){switch(e){case 1:o&&n.push(t);break;case 2:i.push(t),o&&(cur.aid==t&&(u=!0),s.push(t));break;case 3:o||r.push(t);break;default:l[t]=o}}))},g=0;g<=3;g++)d(g);i.length&&(l.apps_all=i.join(","),l.apps_on=s.join(",")),l.groups_list=n.join(","),l.service_hidden=r.join(","),ajax.post("al_settings.php",l,{onDone:function(e){Object(a.geByTag1)("ol",Object(a.ge)("side_bar")).innerHTML=e,window.uiPageBlock&&uiPageBlock.showSaved("settings_services"),Object(c.isFunction)(cur.settingsBoxSetLeftMenuAppCallback)&&cur.settingsBoxSetLeftMenuAppCallback(u),o.hide(),window.Apps&&window.Apps.updateAddToMenuAction()},showProgress:p.lockButton.pbind(t),hideProgress:p.unlockButton.pbind(t)})},giftsCheck:function(){clearTimeout(cur.giftsUpdateTO),cur.giftsUpdateTO=setTimeout(M.giftsSubmit,200)},giftsSubmit:function(){ajax.post("/al_profile.php",{act:"hide_gifts",hash:cur.options.hide_gifts_hash,shown:Object(a.ge)("settings_hide_gifts").checked?0:1},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},gifCheck:function(){clearTimeout(cur.gifUpdateTO),cur.gifUpdateTO=setTimeout(M.gifSubmit,200)},gifSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_autoplay_gif",hash:cur.options.gif_autoplay_hash,no_autoplay:Object(a.ge)("settings_gif_autoplay").checked?0:1},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},accessCheck:function(){clearTimeout(cur.accessUpdateTO),cur.accessUpdateTO=setTimeout(M.accessSubmit,200)},accessSubmit:function(){ajax.post("/al_settings.php",{act:"a_toggle_access_mode",hash:cur.options.a11y_hash,mode:Object(c.intval)(Object(a.ge)("settings_a11y").checked)},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("settings_a11y")})},stickersHintsCheck:function(){clearTimeout(cur.stickersHintsTO),cur.stickersHintsTO=setTimeout(M.stickersHintsSubmit,200)},stickersHintsSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_stickers_hints",hash:cur.options.stickers_hints_hash,hints:Object(a.ge)("settings_stickers_hints").checked?1:0},{onDone:function(){window.uiPageBlock&&uiPageBlock.showSaved("cposts"),window.Emoji&&Emoji.updateTabs.apply(window,arguments)}})},videoCheck:function(){clearTimeout(cur.videoUpdateTO),cur.videoUpdateTO=setTimeout(M.videoSubmit,200)},videoSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_autoplay_video",hash:cur.options.video_autoplay_hash,video_autoplay:Object(a.ge)("settings_video_autoplay").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},videostartCheck:function(){clearTimeout(cur.videostartUpdateTO),cur.videostartUpdateTO=setTimeout(M.videostartSubmit,200)},videostartSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_autostart_video",hash:cur.options.video_autostart_hash,video_autostart:Object(a.ge)("settings_video_autostart").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},hintachCheck:function(){clearTimeout(cur.hintachUpdateTO),cur.hintachUpdateTO=setTimeout(M.hintachSubmit,200)},hintachSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_hintach",hash:cur.options.hintach_hash,hintach:Object(a.ge)("settings_hintach").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},drCheck:function(){clearTimeout(cur.drUpdateTO),cur.drUpdateTO=setTimeout(M.drSubmit,200)},drSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_dr",hash:cur.options.dr_hash,dr:Object(a.ge)("settings_dr").checked?1:0},{onDone:nav.reload.pbind()})},externalAuthCheck:function(){clearTimeout(cur.externalAuthUpdateTO),cur.externalAuthUpdateTO=setTimeout((function(){ajax.post("al_settings.php",{act:"a_change_external_auth",hash:cur.options.external_auth_hash,state:Object(a.ge)("settings_external_auth").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})}),200)},videoadsCheck:function(){clearTimeout(cur.videoadsUpdateTO),cur.videoadsUpdateTO=setTimeout(M.videoadsSubmit,200)},videoadsSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_ads_video",hash:cur.options.video_ads_hash,video_ads:Object(a.ge)("settings_video_ads").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},vkPayEndpointCheck:function(){clearTimeout(cur.vkPayEndpointUpdateTO),cur.vkPayEndpointUpdateTO=setTimeout(M.vkPayEndpointSubmit,200)},vkPayEndpointSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_vk_pay_endpoint",hash:cur.options.vk_pay_endpoint_hash,vk_pay_endpoint:Object(a.ge)("settings_vk_pay_endpoint").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},microblogCheck:function(e){Object(a.hasClass)(Object(a.ge)("settings_"+e),"disabled")||Object(a.ge)("settings_"+e).disabled||(clearTimeout(cur.microblogUpdateTO),cur.microblogUpdateTO=setTimeout(M.microblogSubmit,200))},microblogSubmit:function(){var e={act:"a_change_microblog",hash:cur.options.microblog_hash};Object(c.each)(["status_default","no_wall_replies"],(function(t,o){var s=Object(a.ge)("settings_"+o);s&&(e[o]=s.checked?1:0)})),ajax.post("/al_settings.php",e,{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},photoTagFriendsCheck:function(){clearTimeout(cur.photoAutoTagFriendsUpdateTO),cur.photoAutoTagFriendsUpdateTO=setTimeout(M.photoTagFriendsSubmit,200)},recognitionUserBlockCheck(){clearTimeout(cur.recognitionUserBlockUpdateTO),cur.recognitionUserBlockUpdateTO=setTimeout(M.recognitionUserBlockSubmit,200)},recognitionFriendsBlockCheck(){clearTimeout(cur.recognitionFriendsBlockUpdateTO),cur.recognitionFriendsBlockUpdateTO=setTimeout(M.recognitionFriendsBlockSubmit,200)},recognitionUserBlockSubmit(){ajax.post("/al_settings.php",{act:"toggle_user_recognition_block",hash:cur.options.recognition_user_hash,enabled:Object(a.ge)("settings_recognition_user").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},recognitionFriendsBlockSubmit(){ajax.post("/al_settings.php",{act:"toggle_friends_recognition_block",hash:cur.options.recognition_friends_hash,enabled:Object(a.ge)("settings_recognition_friends").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},photoTagFriendsSubmit:function(){ajax.post("/al_settings.php",{act:"a_change_autotag_friends",hash:cur.options.autotag_friends_hash,autotag_friends:Object(a.ge)("settings_autotag_friends").checked?1:0},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("cposts")})},OTPAuthEnable:function(e){return showBox("al_settings.php",{act:"otp_auth_box",confirm:e,hash:cur.options.otp_hash},{params:{dark:!0}}),!1},OTPAuthAppSet:function(e){var t={act:"otp_auth_app_box"};return e?(curBox().hide(),t.force=1,t.hash=e):t.hash=cur.options.otp_hash,showBox("al_settings.php",t),!1},OTPAuthDisable:function(e){if(Object(p.isButtonLocked)(e))return!1;var t={type:"otp_auth",hash:cur.options.otp_hash};ajax.post("al_settings.php?act=a_otp_auth_save",t,{showProgress:()=>Object(p.lockButton)(e),hideProgress:()=>Object(p.unlockButton)(e),onFail:e=>void 0!==e&&Object(f.showErrorBox)(e)})},OTPAuthAppDisable:function(){if(Object(a.isVisible)(curBox().progress))return!1;var e={type:"otp_auth_by_app",hash:cur.options.otp_hash};ajax.post("al_settings.php?act=a_otp_auth_save",e,{showProgress:curBox().showProgress,hideProgress:curBox().hideProgress,onDone:function(){Object(a.addClass)("settings_otp_auth_app_set","settings_otp_app_disabled"),Object(a.val)("settings_otp_auth_app_set_link",Object(d.getLang)("settings_otp_auth_by_app_enable")),curBox().hide()}})},OTPAuthShowReserveCodes:function(e,t){return showBox("al_settings.php",{act:"otp_auth_reserve_codes_box",hash:e,force_new:t?1:0},{params:{dark:!0}}),!1},OTPAuthGetTrusted:function(e){var t=Object(a.ge)("settings_otp_auth_trusted");if(t&&Object(a.isVisible)(t)&&(e||Object(a.geByTag1)("img",t))){var o=vk.loginscheme!=location.protocol.substr(0,location.protocol.length-1)?1:0;ajax.post(vk.loginscheme+"://"+location.host+"/al_login.php",{act:"is_trusted_browser",_http:o},{frame:o,onDone:function(e){t.innerHTML=e}})}},OTPAuthClearTrusted:function(e,t,o){var s=!1,n=e.getAttribute("confirm");function i(){if(!t&&cur.options.otp_reset_hash)return cur.onReLoginDoneCallback=function(){var e=Object(a.ge)("settings_reset_sessions_link");e&&(e.parentNode.innerHTML='<div class="settings_labeled_notice">'+Object(d.getLang)("setting_all_sessions_reset")+"</div>")},M.reset_sessions=!1,M.resetAllSessions(e,'<input name="otp_reset_hash" value="'+cur.options.otp_reset_hash+'" type="hidden" />',e.getAttribute("complete"),cur.options.logout_hash),void(s&&s.hide());var n=Object(a.ce)("img",{src:"/images/upload"+(window.devicePixelRatio>=2?"_2x":"")+".gif"},{width:32}),i=vk.loginscheme!=location.protocol.substr(0,location.protocol.length-1)?1:0;ajax.post(vk.loginscheme+"://"+location.host+"/al_login.php",{act:"clear_trusted_browsers",only_cur:t,hash:o,_http:i},{frame:i,onDone:function(t){s&&s.hide(),e.parentNode.innerHTML='<div class="settings_labeled_notice">'+e.getAttribute("complete")+"</div>"},showProgress:function(){s?s.showProgress():e.parentNode.replaceChild(n,e)},hideProgress:function(){s?s.hideProgress():n.parentNode.replaceChild(e,n)}})}n?(n=n.split("<!!>"),s=Object(m.showFastBox)({title:n[0],dark:1,bodyStyle:"padding: 20px;"},n[1],n.length>2?n[2]:Object(d.getLang)("box_yes"),i)):i()},OTPAppPasswords:function(){return showBox("al_settings.php",{act:"otp_auth_app_passwords_box"},{params:{dark:!0}}),!1},OTPCreateAppPassword:function(e,t){if(!Object(p.isButtonLocked)(e)){var o=Object(a.val)("settings_app_password_name");o.length?(Object(a.val)("settings_app_passwords_error",""),ajax.post("al_settings.php",{act:"a_otp_auth_create_app_password",name:o,hash:t},{onDone:function(e,t,o){Object(m.showFastBox)({title:e,width:450},t),Object(a.ge)("settings_app_passwords_table_wrap").innerHTML=o,Object(a.hide)("settings_app_passwords_empty"),Object(a.val)("settings_app_password_name","")},onFail:function(e){return e&&Object(r.showMsg)("settings_app_passwords_error",e,"error",!0),!0},showProgress:p.lockButton.pbind(e),hideProgress:p.unlockButton.pbind(e)})):Object(p.notaBene)("settings_app_password_name")}},OTPRemoveAppPassword:function(e,t,o){return ajax.post("al_settings.php",{act:"a_otp_auth_remove_app_password",id:t,hash:o},{onDone:function(){Object(a.re)("settings_app_password"+t),Object(a.geByTag)("tr","settings_app_passwords_table_wrap").length<=1&&(Object(a.ge)("settings_app_passwords_table_wrap").innerHTML="",Object(a.show)("settings_app_passwords_empty"))},showProgress:function(){Object(p.showProgress)(e.parentNode),Object(a.hide)(e)},hideProgress:function(){Object(p.hideProgress)(e.parentNode),Object(a.show)(e)}}),!1},passwordDone:function(e,t){var o;Object(a.re)(cur.pwchFrame),Object(p.unlockButton)(cur.pwchDestroy),cur.pwchFrame=!1;var s="settings_new_pwd";switch(e){case 1:o="settings_cant_set_this_password";break;case-2:o="settings_oldpwd_notcorr",s="settings_old_pwd";break;case-3:o="settings_newpwd_not_good",s="settings_new_pwd";break;case 2:return Object(a.hide)("settings_error_pwd"),Object(a.val)(Object(a.geByClass1)("settings_labeled_text","chgpass"),Object(d.getLang)("settings_pass_update_just_now")),Object(a.val)("settings_old_pwd",""),Object(a.val)("settings_new_pwd",""),Object(a.val)("settings_confirm_pwd",""),M.toggleBlock("chgpass"),M.showMsg(Object(d.getLang)("settings_pass_success")),void(cur.pwchCaptchaBox&&(cur.pwchCaptchaBox.hide(),cur.pwchCaptchaBox=!1));case-1:return void(cur.pwchCaptchaBox=showCaptchaBox(t,1,cur.pwchCaptchaBox,{onSubmit:M.passwordSubmit.pbind(cur.pwchDestroy),onDestroy:function(){}}));default:o="settings_cant_change_password"}cur.pwchCaptchaBox&&(cur.pwchCaptchaBox.hide(),cur.pwchCaptchaBox=!1),M.showError(Object(d.getLang)(o),"pwd"),Object(p.notaBene)(s)},passwordSubmit:function(e,t,o){var s=Object(a.val)("settings_old_pwd"),n=Object(a.val)("settings_new_pwd"),i=Object(a.val)("settings_confirm_pwd"),c=Object(a.ge)("settings_pwd_tt_place").tt;if(!cur.pwchFrame)if(s)if(n)if(i){if(c&&c.hide({fasthide:!0}),n.match(/\s/))return M.showError(Object(d.getLang)("settings_pwd_bad"),"pwd"),Object(p.notaBene)("settings_new_pwd"),void(c&&setTimeout(c.show,10));if(n.length<6)return M.showError(Object(d.getLang)("settings_pwd_bad"),"pwd"),Object(p.notaBene)("settings_new_pwd"),void(c&&setTimeout(c.show,10));if(i!=n)return M.showError(Object(d.getLang)("settings_newpwd_notcorr"),"pwd"),Object(p.notaBene)("settings_confirm_pwd"),void(c&&setTimeout(c.show,10));cur.pwchDestroy||cur.destroy.push((function(e){Object(a.re)(e.pwchFrame)})),cur.pwchDestroy=e,curBox()||Object(p.lockButton)(cur.pwchDestroy);var r={act:"changepass",_origin:locProtocol+"//"+locHost,pass:s,new_pass:n};t&&o&&(r.captcha_sid=t,r.captcha_key=o),r.phash=cur.options.phash,cur.pwchDone=M.passwordDone,cur.pwchFrame=utilsNode.appendChild(Object(a.ce)("iframe",{src:Object(b.getLoginDomain)()+"?"+AjaxConvert.toQueryString(r)}))}else Object(p.notaBene)("settings_confirm_pwd");else Object(p.notaBene)("settings_new_pwd");else Object(p.notaBene)("settings_old_pwd")},mailSubmit:function(e,t){var o;if(t)o="",Object(a.re)(e);else{if(!(o=Object(c.trim)(Object(a.val)("settings_new_mail"))))return void Object(p.notaBene)("settings_new_mail");Object(p.lockButton)(e)}var s={act:"a_bind_mail",email:o,is_new:1,hash:cur.options.mail_hash};return Object(a.ge)("settings_new_mail").blur(),Object(a.hide)("settings_error_mail"),ajax.post("al_settings.php",s,{onDone:function(t,o){if(Object(p.unlockButton)(e),o){var s=Object(a.ge)("chgmail");s.parentNode.replaceChild(Object(a.se)(o),s)}Object(a.ge)("settings_new_mail").value="",showDoneBox(t,{out:4e3,w:400})},onFail:function(t){return Object(p.unlockButton)(e),Object(c.isUndefined)(t)||M.showError(t,"mail"),!0}}),!1},phoneSubmit:function(){showBox("activation.php",{act:"change_phone_box",hash:cur.options.phone_hash})},regionalSubmit:function(e){var t=(Object(a.ge)("timezone")||{}).value,o={act:"a_change_regional",timeoffset:t,hash:cur.options.regional_hash||cur.options.regional_hashes[t]};Object(p.lockButton)(e),ajax.post("al_settings.php",o,{onDone:function(t){Object(p.unlockButton)(e),M.showMsg(t)},onFail:function(t){return Object(p.unlockButton)(e),M.showError(t),!0}})},reset_sessions:!1,resetAllSessions:function(e,t,o,s){if(M.reset_sessions)return!1;M.reset_sessions=!0;var n=bodyNode.appendChild(Object(a.ce)("div",{innerHTML:`<form action="${Object(b.getLoginDomain)()}" method="POST" target="reset_sessions_frame">\n  <input name="_origin" value="${locProtocol+"//"+locHost}" type="hidden" />\n  <input name="role" value="al_frame" type="hidden" />\n  <input name="ip_h" value="${vk.ip_h}" type="hidden" />\n  <input name="reset_hash" value="${cur.options.reset_hash}" type="hidden" />${void 0!==t?t:""}\n</form><iframe class="upload_frame" name="reset_sessions_frame"></iframe>`})),i=n.firstChild,r=Object(a.ce)("img",{src:"/images/upload"+(window.devicePixelRatio>=2?"_2x":"")+".gif"},{width:32});return window.onReLoginDone=function(t,s,i){if(Object(a.re)(n),"object"==typeof s&&(s=i),cur.options.reset_hash=s,e)!0!==e&&r.parentNode.replaceChild(Object(a.ce)("div",{className:"settings_labeled_notice",innerHTML:o||Object(d.getLang)("setting_all_sessions_reset")}),r);else{var l=curBox();l&&(l.hideProgress(),l.setControlsText(Object(d.getLang)("setting_all_sessions_reset")));var u=0;Object(c.each)(Object(a.ge)("activity_history").childNodes,(function(e,t){1===t.nodeType&&(u>0&&!Object(a.hasClass)(t,"settings_old_session")&&(Object(a.addClass)(t,"settings_old_session"),Object(a.re)(Object(a.geByClass1)("settings_cur_session",t))),u++)}))}Object(c.isFunction)(cur.onReLoginDoneCallback)&&cur.onReLoginDoneCallback(),M.reset_sessions=!1},e?!0!==e&&e.parentNode.replaceChild(r,e):curBox().showProgress(),i.submit(),!1},resetSession:function(e,t,o){var s={reset_data:t,hash:o},n=function(t){var o=document.querySelector('.settings_history_row[data-id="'+e+'"]');Object(a.addClass)(o,"settings_old_session"),Object(a.re)(document.querySelector("._settings_reset_session"+e)),showDoneBox(t)},i=Object(d.getLang)("settings_activity_session_reset_box_title"),c=Object(d.getLang)("settings_activity_session_reset_box_text"),r=Object(d.getLang)("settings_activity_session_reset_box_button");Object(m.showFastBox)(i,c,r,(function(){ajax.post("/settings?act=a_reset_session",s,{onDone:n}),curBox().hide()}),Object(d.getLang)("global_cancel"))},ipTTClick:function(e,t){Object(u.cancelEvent)(t);var o=document.createRange();o.selectNodeContents(e);var s=getSelection();s.removeAllRanges(),s.addRange(o),document.execCommand("copy"),s.removeAllRanges()},showUserClientTT:function(e,t){var o="";Object(a.hasClass)(e.parentNode.parentNode,"settings_old_session")&&(o='<div style="font-weight:bold; margin-bottom:5px;">'+Object(d.getLang)("settings_session_terminated")+"</div>"),cur.options.ua_tooltips[t]&&(o+=cur.options.ua_tooltips[t]),o&&Object(O.showTooltip)(e,{text:o,dir:"auto",slide:15,className:"settings_user_client_tt",hasover:1})},disabledPrivacy:function(){var e=Object(a.geByClass1)("settings_privacy_add_replies_view",Object(a.ge)("content"));e&&Object(O.showTooltip)(e,{black:!0,hasover:1,className:"settings_comments_disabled_tt",shift:[0,5],text:Object(d.getLang)("settings_comments_disabled_tt").replace("{link}",'<a href="/settings?f=cposts" onclick="return nav.go(this, event, {nocur: true})">').replace("{/link}","</a>")})},checkAddress:function(e){cur.addrUnchecked=0,clearTimeout(cur.addressCheckTO),cur.lastAddress!=Object(a.val)("settings_addr")&&(cur.addressCheckTO=setTimeout(M.doCheckAddress,e||0))},doCheckAddress:function(){var e=Object(a.ge)("settings_address_submit");cur.lastAddress=Object(a.val)("settings_addr"),ajax.post("al_settings.php",{act:"a_check_address",name:cur.lastAddress},{onDone:function(t){cur.addrChecked=1,Object(p.disableButton)(e,!1),e.innerHTML=t},onFail:function(t){return cur.addrChecked=-1,e.innerHTML=t,Object(p.disableButton)(e,!0),!0},showProgress:function(){Object(p.lockButton)(e),Object(p.disableButton)(e,!1)},hideProgress:function(){Object(p.unlockButton)(e)}})},addressSubmit:function(e){1==cur.addrChecked?(Object(p.lockButton)(e),ajax.post("al_settings.php",{act:"a_change_address",hash:cur.options.address_hash,name:Object(a.val)("settings_addr")},{onDone:function(t){Object(p.unlockButton)(e),M.showMsg(t)},onFail:function(t){return Object(p.unlockButton)(e),t&&M.showError(t,"addr"),!0}})):Object(p.notaBene)("settings_addr")},init:function(){cur.checkboxResultsTOs={},cur.module="settings",cur.options.msg?M.showMsg(cur.options.msg):cur.options.err&&M.showError(cur.options.err),Object(c.each)({settings_status_default:Object(d.getLang)("settings_status_default_about"),settings_no_wall_replies:Object(d.getLang)("settings_no_wall_replies_about"),settings_video_autoplay:Object(d.getLang)("settings_video_autoplay")},(function(e,t){(e=Object(a.domQuery1)('label[for="'+e+'"]'))&&(e.onmouseover=function(){Object(O.showTooltip)(this,{shift:[-20,8,8],dir:"auto",text:t,slide:15,className:"settings_tt",hasover:1})})}));var e=Object(a.ge)("settings_pwd_tt_place");Object(c.each)([Object(a.ge)("settings_new_pwd"),Object(a.ge)("settings_confirm_pwd")],(function(){this&&(this.onfocus=function(){Object(O.showTooltip)(e,{text:Object(d.getLang)("settings_password_about"),dir:"left",slideX:15,className:"settings_pwd_tt",shift:[-12,-15,0],onCreate:function(){Object(u.removeEvent)(e,"mouseout")}})},this.onblur=function(){e.tt&&e.tt.hide&&e.tt.hide()})}));var t=Object(a.ge)("settings_addr");t.onfocus=function(){Object(O.showTooltip)(t,{text:Object(d.getLang)("settings_addr_intro"),dir:"auto",slide:15,className:"settings_toup_tt",shift:[Object(a.getSize)("prefix_input_prefix")[0],10],onCreate:function(){Object(u.removeEvent)(t,"mouseout"),t.onblur=function(){t.tt.hide()}}})},cur.lastAddress=Object(a.val)(t);var o=Object(a.ge)("settings_new_mail");o&&(o.onfocus=function(){Object(O.showTooltip)(o,{text:Object(d.getLang)("settings_email_about"),dir:"auto",slide:15,className:"settings_toup_tt",shift:[0,10],onCreate:function(){Object(u.removeEvent)(o,"mouseout"),o.onblur=function(){o.tt.hide()}}})}),Object(c.extend)(cur,{validationLastCallback:function(e){curBox()&&curBox().hide(),e?M.phoneSubmit():Object(a.elfocus)("settings_new_phone")}}),M.initRepliesOrder(),setTimeout((function(){if(nav.objLoc.f){var e=Object(a.ge)(nav.objLoc.f.split(",")[0]);e&&Object(a.hasClass)(e,"settings_line")&&M.toggleBlock(Object(a.domFC)(e))}}),100),cur.destroy.push((function(){window.onLoginDone=nav.reload}))},emailPosts:function(e,t){ajax.post("al_settings.php",{act:"send_email_post",hash:e},{onDone:function(e,o){Object(a.ge)("settings_email_post_msg").innerHTML=e,Object(a.setStyle)(Object(a.ge)("settings_email_post_msg"),{borderColor:"#D4BC4C",backgroundColor:"#F9F6E7"}),animate(Object(a.ge)("settings_email_post_msg"),{borderColor:"#B9C4DA",backgroundColor:"#FFFFFF"},3e3),t.innerHTML=o},showProgress:function(){Object(p.lockButton)(t)},hideProgress:function(){Object(p.unlockButton)(t)}})},showPaymentsMethods:function(e,t,o){return ajax.post("al_settings.php",{act:"a_payments_methods",money_transfer:o?1:0,hash:t},{onDone:function(t){if(o)return cur.autoacceptCards=t.cards,cur.autoacceptCardSelected=t.cardSeleceted,void M.initAutoAcceptDD(t.cards,t.cardSeleceted);var s=Object(a.ce)("div",{innerHTML:t,className:"unshown"});e.parentNode.replaceChild(s,e),slideDown(s,100)},stat:o?["ui_controls.js","ui_controls.css"]:[]}),!1},initAutoAcceptDD:function(e,t){cur.autoacceptCardDD=new InlineDropdown("settings_p2p_receive_card",{items:e,selected:t,withArrow:!0,onSelect:function(e){if(-1==e)M.bindMoneyTransferCard();else if(e!=cur.autoacceptCardSelected){var t=cur.autoacceptCardDD.getSelected()[2];M.saveMoneyTransferCard(e,t),cur.autoacceptCardSelected=e}}})},saveMoneyTransferCard:function(e,t){ajax.post("al_payments.php",{act:"a_remember_money_transfer_accept_card",card_id:e,hash:t,from:"settings"},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("settings_p2p_receive_card")})},bindMoneyTransferCard:function(){return showBox("al_payments.php",{act:"card_payment_box",type:"card_bind"},{stat:["ui_controls.js","ui_controls.css"]}),!1},deletePaymentMethod:function(e,t,o,s){if(s){var n=e.parentNode;return ajax.post("al_payments.php",{act:"a_del_instant_method",type:t,hash:o},{onDone:function(e){n.innerHTML=e},onFail:function(e){return n.innerHTML=e,!0},showProgress:function(){cur.confirmBox.showProgress()},hideProgress:function(){cur.confirmBox.hide()}}),!1}cur.confirmBox=Object(m.showFastBox)({title:cur.lang.global_action_confirmation,dark:1,forceNoBtn:1,bodyStyle:"padding: 20px; line-height: 160%;"},cur.lang.settings_delete_payment_method_confirm,Object(d.getLang)("global_delete"),(function(){M.deletePaymentMethod(e,t,o,!0)}),Object(d.getLang)("global_cancel"))},showNextPaymentsHistory:function(e,t){var o,s;if(!Object(p.isButtonLocked)(e))return Object(p.lockButton)(e),t||(t="votes"),void 0===cur.historyOffset[t]&&(cur.historyOffset[t]=5),"transfer"===t?(o={act:"a_transfer_history"},s=Object(a.ge)("settings_transfer_history")):"subscriptions"===t?(o={act:"a_payments_subsciptions"},s=Object(a.ge)("settings_payments_subscriptions")):"games"===t?(o={act:"a_payments_games"},s=Object(a.ge)("settings_payments_games")):(o={act:"a_votes_history"},s=Object(a.ge)("settings_votes_history")),o.offset=s.rows.length,"subscriptions"===t&&(o.extra_items_count=cur.historyExtraItemsSubscriptions),ajax.post("al_settings.php",o,{onDone:function(o,n,i){var c=s.tBodies[0];if(o){if(Object(p.unlockButton)(e),browser.msie){var r=Object(a.se)("<table>"+o+"</table>");Array.from(Object(a.geByTag)("tr",r)).forEach(e=>{1===e.nodeType&&c.appendChild(e)})}else c.insertAdjacentHTML("beforeEnd",o);"subscriptions"===t&&i&&(cur.historyExtraItemsSubscriptions=i)}o&&!n||(Object(a.addClass)(c.lastChild,"settings_votes_history_last"),Object(a.hide)(e))}}),!1},switchPaymentsHistoryTab:function(e,t,o){if(Object(u.checkEvent)(o))return!0;var s=Object(c.clone)(nav.objLoc);return uiTabs.switchTab(e),M.hideMoneyLinksTooltip(),Object(a.hide)("settings_votes_history_wrap","settings_payments_subscriptions_wrap","settings_transfer_history_wrap","settings_payments_transfer_msg","settings_payments_games_wrap"),"transfer"===t?(Object(a.show)("settings_transfer_history_wrap","settings_payments_transfer_msg"),s.section=t,M.showMoneyLinksTooltip()):"subscriptions"===t?(Object(a.show)("settings_payments_subscriptions_wrap"),s.section=t):"games"===t?(Object(a.show)("settings_payments_games_wrap"),s.section=t):(Object(a.show)("settings_votes_history_wrap"),delete s.section),nav.setLoc(s),!1},moneyTransferCancel:function(e,t,o,s,n){var i,c,r=Object(a.domClosest)("_row",e),l=Object(a.geByClass1)("_status",r);if(!n)return s?(i=Object(d.getLang)("settings_transfer_decline_confirm"),c=Object(d.getLang)("settings_transfer_decline_btn")):(i=Object(d.getLang)("settings_transfer_cancel_confirm"),c=Object(d.getLang)("settings_transfer_cancel_btn")),void(cur.confirmBox=Object(m.showFastBox)(Object(d.getLang)("global_action_confirmation"),i,c,M.moneyTransferCancel.pbind(e,t,o,s,1),Object(d.getLang)("global_cancel")));2!==n&&(Object(a.addClass)(r,"settings_history_row_progress"),cur.confirmBox&&cur.confirmBox.hide()),ajax.post("al_payments.php?act=a_cancel_money_transfer",{tx_id:t,hash:o},{onDone:function(e,i){if(0===e)return 2!==n&&(Object(a.val)(l,Object(d.getLang)("settings_transfer_status_cancelling")),Object(a.removeClass)(l,"settings_transfer_receive")),void setTimeout(M.moneyTransferCancel.pbind(r,t,o,s,2),2e3);Object(a.removeClass)(r,"settings_history_row_progress"),Object(a.val)(l,Object(d.getLang)("settings_transfer_status_cancelled")),Object(a.removeClass)(l,"settings_transfer_receive"),Object(a.addClass)(l,"settings_transfer_status_cancelled"),TopNotifier.invalidate()},onFail:function(e){return Object(a.removeClass)(r,"settings_history_row_progress"),setTimeout(Object(m.showFastBox)(Object(d.getLang)("global_error"),e).hide,2e3),!0}})},moneyTransferRepeat:function(e,t){return showBox("al_payments.php?act=money_transfer_box",{repeat_id:e,hash:t}),!1},paymentsSubscriptionBox:function(e,t,o,s){if(s){var n=Object(a.domClosest)("_row",s);cur.onSubscriptionDone=function(e){var t=Object(a.geByClass1)("settings_history_amount",n);Object(a.val)(t,e.status),Object(a.removeClass)(t,"settings_history_btn"),Object(a.val)(Object(a.geByClass1)("settings_history_actions",n),e.actions)}}showBox("al_apps.php?act=show_subscription_box",{aid:e,item:t,action:"create",hash:o},{onFail:function(e){return setTimeout(Object(m.showFastBox)(Object(d.getLang)("global_error"),e).hide,2e3),!0}})},paymentsSubscriptionCancel:function(e,t,o,s,n){var i=Object(a.domClosest)("_row",e);n?(Object(a.addClass)(i,"settings_history_row_progress"),cur.confirmBox&&cur.confirmBox.hide(),ajax.post("al_apps.php?act=a_cancel_subscription",{aid:t,subscription_id:o,hash:s,from:"settings"},{onDone:function(e,t){Object(a.removeClass)(i,"settings_history_row_progress"),e?(Object(a.val)(Object(a.geByClass1)("settings_history_amount",i),e),Object(a.val)(Object(a.geByClass1)("settings_history_actions",i),t)):Object(a.addClass)(i,"settings_history_row_deleted")},onFail:function(e){return Object(a.removeClass)(i,"settings_history_row_progress"),setTimeout(Object(m.showFastBox)(Object(d.getLang)("global_error"),e).hide,2e3),!0}})):cur.confirmBox=Object(m.showFastBox)(Object(d.getLang)("global_action_confirmation"),Object(d.getLang)("settings_subscription_cancel_confirm"),Object(d.getLang)("settings_subscription_cancel_btn"),M.paymentsSubscriptionCancel.pbind(e,t,o,s,1),Object(d.getLang)("global_cancel"))},paymentsSubscriptionReactivate:function(e,t,o,s){var n=Object(a.domClosest)("_row",e);cur.onSubscriptionDone=function(e){Object(a.val)(Object(a.geByClass1)("settings_history_amount",n),e.status),Object(a.val)(Object(a.geByClass1)("settings_history_actions",n),e.actions)},showBox("al_apps.php?act=show_subscription_box",{aid:t,subscription_id:o,action:"resume",hash:s},{onFail:function(e){return setTimeout(Object(m.showFastBox)(Object(d.getLang)("global_error"),e).hide,2e3),!0}})},initAppOrdersDD:function(e,t,o){cur.appOrdersDD=new InlineDropdown("settings_app_orders",{items:e,selected:t,onShow:function(){if(cur.appOrdersDD){Object(O.showTooltip)(cur.appOrdersDD._els.popupHeader,{text:Object(d.getLang)("settings_payments_app_orders_tt"),width:250,slideX:-15,className:"pedit_tt",nohide:!0,asrtl:!0,shift:[263,-15,-15],dir:"left"})}},onHide:function(){cur.appOrdersDD&&cur.appOrdersDD._els.popupHeader.tt&&cur.appOrdersDD._els.popupHeader.tt.destroy()},onSelect:function(e){M.toggleAppOrders(e&&"0"!==e,o)}})},toggleAppOrders:function(e,t){ajax.post("al_payments.php?act=a_toggle_app_orders",{autoconfirm:e,hash:t},{onDone:window.uiPageBlock&&uiPageBlock.showSaved.pbind("settings_app_orders")})},initApps:function(e,t){Object(c.extend)(cur,{aSearch:Object(a.ge)("s_search"),lShowMoreButton:Object(a.ge)("ui_apps_load_more"),lContent:Object(a.ge)("settings_apps_list"),aEmptyCont:Object(a.ge)("settings_apps_empty"),aSummaryCounter:Object(a.geByClass1)("page_block_header_count","wide_column"),onSilentLoad:{},apps:{},deletedApps:{},appTpl:t||function(){return""}}),Object(c.extend)(cur,e),cur.defaultCount=cur.shownApps,cur.appTpl=t||function(){return""},M.scrollNode=browser.msie6?pageNode:window,Object(u.addEvent)(M.scrollNode,"scroll",M.scrollCheckApps.bind(this)),setTimeout((function(){cur.destroy.push((function(){Object(u.removeEvent)(M.scrollNode,"scroll",M.scrollCheckApps.bind(M))}))}),0),cur.silent=!0,ajax.post("/al_settings.php",{act:"load_apps_silent"},{cache:1,local:1,onDone:function(e){var t=e;try{e=JSON.parse(e)}catch(e){Object(h.logEvalError)(e,t)}if(!e)return cur.silent=!1;void 0===cur.searchOffset&&(cur.searchOffset=0),cur.curList="all",cur.appsList=e[cur.curList]?e:{all:[]},cur.appsCount=cur.appsList.all.length,this.indexApp((function(){cur.silent=!1,"object"==typeof cur.onSilentLoad&&Object.values(cur.onSilentLoad).forEach(e=>{Object(c.isFunction)(e)&&e()})}))}.bind(this)})},isDelayedOnSilentLoad:function e(t,o){if(cur.silent)return e.count=e.count||0,e.count++,cur.onSilentLoad[t||"key_"+e.count]=o,!0},indexApp:function(e){cur.appsIndex=new vkIndexer(cur.appsList.all,(function(e){try{return cur.apps[parseInt(e[0])]=e,e[3]}catch(e){return""}}),e)},scrollCheckApps:function(){this.isDelayedOnSilentLoad("scrollCheck",this.scrollCheckApps.bind(this))||!browser.mobile&&!cur.isAppsLoading&&!cur.disableAutoMore&&Object(a.isVisible)(cur.lShowMoreButton)&&(window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight)+Object(l.scrollGetY)()+400>=cur.lShowMoreButton.offsetTop&&this.showAppsRows()},showAppsRows:function(){if(!this.isDelayedOnSilentLoad("showAppsRows",this.showAppsRows.bind(this))&&cur.defaultCount&&cur.shownApps<cur.appsCount){var e=Object(c.clean)(cur.searchStr),t="",o=cur.appsList[cur.curList]||[],s=o.length;if((o=this.filterApps(o.slice(cur.shownApps)).slice(0,cur.defaultCount)).length&&cur.appTpl){var n=[];Object(c.each)(o,(function(e,t){t=Object(c.clone)(t),cur.selection&&(t[3]=t[3].replace(cur.selection.re,cur.selection.val)),n.push(cur.appTpl(t,e==o.length-1,!1))})),t=n.join("")}if(cur.shownApps)t&&cur.lContent.appendChild(Object(a.cf)(t));else if(t)cur.lContent.innerHTML=t,cur.aSummaryCounter&&(cur.aSummaryCounter.innerHTML=Object(d.langNumeric)(s,"%s",!0)),Object(a.show)("settings_apps_noempty"),Object(a.hide)(cur.aEmptyCont);else{var i=Object(d.getLang)("settings_apps_not_found_by_query").split("{query}").join("<b>"+e.replace(/([<>&#]*)/g,"")+"</b>");cur.aEmptyCont.innerHTML=i,cur.aSummaryCounter&&(cur.aSummaryCounter.innerHTML=""),Object(a.show)(cur.aEmptyCont),Object(a.hide)("settings_apps_noempty")}cur.shownApps+=cur.defaultCount,cur.shownApps>=cur.appsCount?Object(a.hide)(cur.lShowMoreButton):(Object(a.show)(cur.lShowMoreButton),this.scrollCheckApps()),cur.aSearch&&uiSearch.hideProgress(cur.aSearch)}},filterApps:function(e){for(var t=e.length,o=[],s=0;s<t;s++){var n=e[s];cur.apps&&cur.apps[n[0]]&&!cur.apps[n[0]].deleted&&o.push(n)}return o},searchApps:function(e){if(!this.isDelayedOnSilentLoad("searchApps",this.searchApps.bind(this,e))){if(e&&" "==e[e.length-1]&&(e[e.length-1]="_"),e.length<2&&(e=""),cur.ignoreEqual||cur.searchStr!==e){if(cur.searchStr=e||"",e){var t=cur.appsIndex.search(Object(c.clean)(e));cur.curList="all_search_"+e,cur.appsList[cur.curList]=t,e+=" "+(Object(d.parseLatin)(e)||""),e=Object(c.trim)(Object(c.escapeRE)(e).split("&").join("&amp;")),cur.selection={re:new RegExp("("+e.replace(cur.appsIndex.delimiter,"|")+")","gi"),val:'<em class="highlight">$1</em>'}}else cur.curList="all",cur.selection=!1;window.tooltips&&tooltips.hideAll(),cur.aSearch&&uiSearch.showProgress(cur.aSearch),this.scrollToSearch(),Object(a.hide)(cur.lShowMoreButton),cur.loadMore=1,cur.shownApps=cur.searchOffset=0,this.showAppsRows()}delete cur.ignoreEqual}},showAppSettings:function(e){window.tooltips&&tooltips.hideAll(),showBox("/al_apps.php",{act:"settings_box_info",aid:e,from:"profile_settings"},{stat:["apps.css"],dark:1})},removeApp:function(e,t,o,s){if(s&&Object(u.cancelEvent)(s),this.removingApp)return!1;if(this.isDelayedOnSilentLoad("removeApp"+e,this.removeApp.bind(this,e,t,o)))return!1;window.tooltips&&tooltips.hideAll();var n=Object(a.ge)("app"+e),i="profile_settings";(function(){ajax.post("/al_apps.php",{act:"quit",id:e,hash:t,from:i},{onDone:function(t){window.appsListChanged=!0,cur.apps[e]&&(cur.appsIndex.remove(cur.apps[e]),cur.apps[e].deleted=!0),cur.deletedApps[e]={from:i,html:n.innerHTML},n&&n.appendChild(Object(a.cf)(t.html)),Object(a.addClass)(n,"deleted")},showProgress:function(){Object(a.addClass)(n,"loading"),this.removingApp=!0}.bind(this),hideProgress:function(){Object(a.removeClass)(n,"loading"),this.removingApp=!1}.bind(this)})}).bind(this)()},restoreApp:function(e,t){if(this.restoringApp)return!1;var o=Object(a.ge)("app"+e);return ajax.post("/al_apps.php",{act:"join",id:e,hash:t,restore:1,from:"al_apps",section:"settings"},{onDone:function(t){cur.deletedApps[e]&&(o.innerHTML=cur.deletedApps[e].html,delete cur.deletedApps[e]),cur.apps[e]&&(delete cur.apps[e].deleted,cur.appsIndex.add(cur.apps[e])),Object(a.removeClass)(o,"deleted")},showProgress:function(){this.restoringApp=!0,Object(a.addClass)(o,"loading")}.bind(this),hideProgress:function(){this.restoringApp=!1,Object(a.removeClass)(o,"loading")}.bind(this)}),!1},ttCommon:function(e,t,o,s,n){return s&&Object(u.cancelEvent)(s),o?Object(O.showTooltip)(e,{center:o,shift:n||[0,8,8],black:1,text:t}):showTitle(e,t,n)},scrollToSearch:function(){var e=Object(a.ge)("page_header_cont"),t=Object(a.ge)("settings_search_wrap");if(t&&e){var o=Object(a.getXY)(Object(a.domPN)(t))[1]-Object(a.getSize)(e)[1];scrollNode.scrollTop>o&&Object(l.scrollToY)(o,200)}},deactivateBox:function(){return showBox("al_settings.php",{act:"deactivate_box"},{params:{dark:!0}}),!1},showValidateDevices:function(e,t){return ajax.post("al_settings.php",{act:"a_validate_devices",hash:t},{onDone:function(t){tooltips.hideAll();var o=Object(a.ce)("div",{innerHTML:t,className:"unshown"});e.parentNode.replaceChild(o,e),slideDown(o,100)}}),!1},deleteValidateDevice:function(e,t,o,s){if(s){var n=e.parentNode;return ajax.post("al_settings.php",{act:"a_del_validate_device",dhash:t,hash:o},{onDone:function(e){n.innerHTML=e},showProgress:function(){cur.confirmBox.showProgress()},hideProgress:function(){cur.confirmBox.hide()}}),!1}cur.confirmBox=Object(m.showFastBox)({title:cur.lang.global_action_confirmation,dark:1,forceNoBtn:1,bodyStyle:"padding: 20px; line-height: 160%;"},cur.lang.settings_delete_validate_device_confirm,Object(d.getLang)("global_delete"),(function(){M.deleteValidateDevice(e,t,o,!0)}),Object(d.getLang)("global_cancel"))},showNotifySubscriptions:function(e){return Object(a.hasClass)(e,"settings_no_subscriptions")||showBox("al_settings.php",{act:"notify_subscriptions_box"},{stat:[jsc("web/indexer.js")]}),!1},notifySubscriptionsInit:function(e,t,o){o.onListClick=M.notifySubscriptionToggle,cur.subsOList=new OList(e,t,{},o),e.removeButtons().addButton(Object(d.getLang)("global_close"),(function(){e.hide(200)}),"yes")},notifySubscriptionToggle:function(e,t){var o=Object(a.geByClass1)("_subscriptions_count"),s=e.id.match(/-?\d+/)[0],n=!1,i=0;Object(c.each)(cur.subsOList.owners,(function(e,t){cur.subsOList.selected[t[0]]||i++,!1===n&&this[0]==s&&(n=this[4])})),o&&(Object(a.toggleClass)(o,"settings_no_subscriptions",!i),Object(a.val)(o,i?Object(d.getLang)("settings_notify_subscriptions_count",i):Object(d.getLang)("settings_notify_no_subscriptions"))),ajax.post("/al_wall.php",{act:"a_toggle_posts_subscription",subscribe:t?1:0,oid:s,hash:n},{showProgress:a.addClass.pbind(e,"olist_item_loading"),hideProgress:a.removeClass.pbind(e,"olist_item_loading")})},showGroupNotifySources:function(e,t){return Object(u.cancelEvent)(e),showBox("al_settings.php",{act:"group_notify_sources_box",source:t},{params:{dark:1,width:450,bodyStyle:"padding: 0",containerClass:"group_notify_sources_box flist_list_radio"}}),!1},initShowGroupNotifySourcesBox:function(e,t){var o=window.cur||{};Object(c.extend)(o,t),e.removeButtons(),e.addButton(t.okBtnText,this.groupNotifyPopupSubmit.bind(this)),Object(c.extend)(o,{popupSubmitBtnEl:curBox().btns.ok[0],popupSelectedGroup:0,popupGroupsWrapperEl:Object(a.geByClass1)("_add_community_app_groups"),popupContentEl:Object(a.geByClass1)("_add_community_app_content")}),Object(p.disableButton)(o.popupSubmitBtnEl,!0),o.popupGroupsEls=Object(a.geByClass)("flist_item",o.popupGroupsWrapperEl,"div"),1===o.popupGroupsEls.length&&this.groupNotifyPopup(o.popupGroupsEls[0]),Object(c.each)(o.popupGroupsEls,function(e,t){Object(u.addEvent)(t,"click",this.groupNotifyPopup.bind(this,t))}.bind(this))},groupNotifyPopup:function(e){var t=Object(c.intval)(e.getAttribute("data-id"));cur.popupSelectedGroup=t,Object(c.each)(cur.popupGroupsEls,(function(t,o){(o===e?a.addClass:a.removeClass)(o.parentNode,"flist_item_checked")})),Object(p.disableButton)(cur.popupSubmitBtnEl,0===cur.popupSelectedGroup)},groupNotifyPopupSubmit:function(){var e=cur.popupSelectedGroup;Object(a.isVisible)(cur.popupSubmitBtnEl)&&!Object(p.isButtonLocked)(cur.popupSubmitBtnEl)&&0!==e&&TopNotifier.addNewSource(e,cur.popup_hash,2)},delGroupNotifySource:function(e,t,o,s){Object(u.cancelEvent)(e);var n=Object(m.showFastBox)(Object(d.getLang)("settings_group_notify_disable_title"),Object(d.getLang)("settings_group_notify_disable_text"),Object(d.getLang)("settings_group_notify_disable_yes"),(function(){n.hide(),ajax.post("al_settings.php",{act:"a_group_notify_del_source",gid:t,hash:o},{onDone:function(e){t==s?(TopNotifier&&TopNotifier.changeSource("",null,null),nav.go("/settings?act=notify")):nav.reload()},showProgress:p.lockButton.pbind(cur.popupSubmitBtnEl),hideProgress:p.unlockButton.pbind(cur.popupSubmitBtnEl)})}),Object(d.getLang)("global_cancel"))},addSourcePopup:function(e){Object(a.hide)(Object(a.geByClass1)("notify_sources")),TopNotifier&&TopNotifier.hide(),this.showGroupNotifySources(e,"popup")},groupNotify_disabledSetting:function(e){showTitle(e,Object(d.getLang)("settings_group_notify_disable_tooltip"),null,{shift:[-17,14],className:"settings_group_notifications_disable_tooltip",needLeft:1})},initRepliesOrder:function(){var e=Object(a.ge)("settings_replies_order");e&&cur.options.replies_order_items&&(cur.repliesReorderDD=new InlineDropdown(e,{items:cur.options.replies_order_items,selected:cur.options.replies_order_cur||cur.options.replies_order_items[0][0],onSelect:function(e){ajax.post("al_settings.php",{act:"change_replies_order",order:e,hash:cur.options.replies_order_hash},{onDone:function(){window.uiPageBlock&&window.uiPageBlock.showSaved("settings_replies_order")}})}}),cur.options.order_settings_feature_tooltip&&setTimeout((function(){cur.options&&cur.options.order_settings_feature_tooltip_hash&&M.showOrderSettingsTooltip(cur.options.order_settings_feature_tooltip_hash)}),800))},showOrderSettingsTooltip:function(e){var t=Object(a.ge)("settings_replies_order");t&&(cur.orderSettingsFeatureTT=new ElementTooltip(t,{content:'<div class="feature_tooltip__close" onclick="cur.orderSettingsFeatureTT.hide();"></div>'+Object(d.getLang)("wall_order_settings_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip order_settings_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[0,-4],onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"order_settings_web"}),cur.orderSettingsFeatureTT.destroy(),delete cur.orderSettingsFeatureTT}}),cur.orderSettingsFeatureTT.show())},showMoneyLinksTooltip:function(){var e=Object(a.geByClass1)("_money_request_btn","wide_column");cur.moneylinks_feature_tooltip&&e&&setTimeout((function(){cur.moneyLinksTooltip=new ElementTooltip(e,{content:'<div class="feature_tooltip__close" onclick="cur.moneyLinksTooltip.hide();"></div>'+Object(d.getLang)("settings_payments_moneylinks_feature_text"),cls:"feature_intro_tt feature_info_tooltip moneylinks_feature_tooltip",forceSide:"top",width:270,autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[0,-4],onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.moneylinks_feature_tooltip_hash,type:"moneylinks"}),M.hideMoneyLinksTooltip()}}),cur.moneyLinksTooltip.show(),cur.destroy.push(M.hideMoneyLinksTooltip)}),1e3)},hideMoneyLinksTooltip:function(){cur.moneyLinksTooltip&&(cur.moneyLinksTooltip.destroy(),delete cur.moneyLinksTooltip)},cancelDonutSubscription:function(e,t,o){return showBox("al_settings.php",{act:"a_cancel_donut",owner_id:t,hash:o},{onDone:function(e){e.setButtons(Object(d.getLang)("settings_donut_confirm"),(function(){Object(p.lockButton)(e.btns.ok[0]),M.applyCancelDonutSubscription(t,o,e)}),Object(d.getLang)("settings_donut_cancel_button_cancel"))},onFail:f.showErrorBox}),Object(u.cancelEvent)(e)},applyCancelDonutSubscription:function(e,t,o){ajax.post("al_settings.php",{act:"a_cancel_donut_apply",owner_id:e,hash:t},{onDone:function(){o&&o.hide(),window.nav.reload({noback:!0})},onFail:function(e){if(o){var t=Object(a.geByClass1)("error",o.bodyNode);t&&(Object(a.val)(t,e),Object(a.show)(t)),Object(p.unlockButton)(o.btns.ok[0])}}})},showGroupMessagesNotifyBox:function(e,t){return Object(u.cancelEvent)(e),showBox("al_settings.php",{act:"group_notify_messages_box",source:t},{params:{dark:1,width:560,bodyStyle:"padding: 0",containerClass:"group_notify_messages_box"}}),!1},initShowGroupMessagesNotifyBox:function(e,t){var o=this,s=window.cur||{};Object(c.extend)(s,t),e.removeButtons(),e.addButton(t.okBtnText,this.submitSettingsGroupMessagesNotifyPopup.bind(this)),e.addButton(t.cancelBtnText,e.hide,"no"),Object(c.extend)(s,{popupGroupRowsWrapperToggler:Object(a.geByClass1)("settings_group_rows_wrapper_toggler"),popupGroupRowsWrapper:Object(a.geByClass1)("settings_group_rows_wrapper"),popupSubmitBtnEl:curBox().btns.ok[0]}),this.toggleSettingsGroupMessagesNotifyRows(!0),s.popupGroupsEls=Object(a.geByClass)("flist_item",s.popupGroupRowsWrapper,"div"),Object(c.each)(s.popupGroupsEls,(function(e,t){Object(u.addEvent)(t,"click",o.changeSettingsGroupMessagesNotifyRowState.bind(o,t))}))},toggleSettingsGroupMessagesNotifyRows:function(e){e||Object(a.toggleClass)(cur.popupGroupRowsWrapperToggler,"on");var t=Object(a.hasClass)(cur.popupGroupRowsWrapperToggler,"on");Object(a.toggleClass)(cur.popupGroupRowsWrapper,"hidden",!t)},changeSettingsGroupMessagesNotifyRowState:function(e){Object(a.toggleClass)(e,"flist_item_checked")},saveGroupMessagesNotifySettings:function(e){var t={is_enabled:e.is_enabled?1:0,groups_map:JSON.stringify(e.groups_map),promo_group_id:cur.gid,hash:cur.popup_hash};clearTimeout(cur.instantNotifyTO),clearTimeout(cur.instantNotifySaveTO),cur.instantNotifyTO=setTimeout(ajax.post.pbind("/settings?act=a_group_messages_notify_save",t,{onDone:e=>{curBox().hide(),cur.instantNotifySaveTO=setTimeout(window.uiPageBlock&&uiPageBlock.showSaved.pbind("settings_notify_group_messages_link"),1e3);var t=Object(a.geByClass1)("settings_separated_row_hint","settings_group_messages_row");t&&(t.innerHTML=e.hint);var o=Object(a.geByClass1)("group-messages-notify-block");o&&e.hide_promo&&slideUp(o,200,a.re.pbind(o))},showProgress:p.lockButton.pbind(cur.popupSubmitBtnEl),hideProgress:p.unlockButton.pbind(cur.popupSubmitBtnEl)}),500),TopNotifier&&TopNotifier.invalidate()},submitSettingsGroupMessagesNotifyPopup:function(){var e={is_enabled:null,groups_map:{}};Object(a.isVisible)(cur.popupSubmitBtnEl)&&!Object(p.isButtonLocked)(cur.popupSubmitBtnEl)&&(e.is_enabled=Object(a.hasClass)(cur.popupGroupRowsWrapperToggler,"on"),Object(c.each)(cur.popupGroupsEls,(function(t,o){e.groups_map[o.getAttribute("data-id")]=Object(a.hasClass)(o,"flist_item_checked")?"1":"0"})),this.saveGroupMessagesNotifySettings(e))},refreshPaymentHistory:function(){var e=document.getElementById("settings_payments_history_panel");if(e){var t={act:"payments_history"};if(nav){var o=nav.fromStr(nav.strLoc).section;o&&(t.section=o)}ajax.post("al_settings.php",t,{onDone:function(t){t&&(e.innerHTML=t)}})}},showPhotoRecognitionBoxSettings(){ajax.post("al_settings.php",{act:"get_recognition_box_data"},{loader:!0,onDone:e=>{var t=Object(j.showComponentInBox)(n.createElement(L,{data:e,onClose:o,onSave:function(){showDoneBox(Object(d.getLang)("photo_recognition_settings_saved")),o()}}),{width:450,onDestroy:e=>{Object(j.destroyComponentInBox)(e)}});function o(){t&&t.hide()}},onFail:e=>(Object(m.showFastBox)(Object(d.getLang)("global_error"),e||Object(d.getLang)("global_unknown_error")),Object(N.logError)(new Error("get RecognitionBoxSettings error"+(e?": "+e:""))),!0)})}}},jmhT:function(e,t,o){"use strict";o.r(t),o.d(t,"BoxModal",(function(){return l}));var s,n=o("q1tI"),i=o.n(n),a=o("ZxpX"),c=o("GSQL"),r=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.className,o=e.appearance,s=e.title,n=e.actionButtons,r=e.onClose,l=e.children,u=e.hint,p=e.hasScroll;return i.a.createElement("div",{className:"BoxModal"},i.a.createElement("div",{className:Object(a.classNames)("Modal","Modal--"+o,t)},i.a.createElement(c.default.Header,{title:s,onClose:r,appearance:o}),Boolean(l)&&i.a.createElement(c.default.Body,{hasScroll:p},l),i.a.createElement(c.default.Footer,{actionButtons:n,hint:u})))},t.defaultProps={appearance:"white",hasScroll:!0},t}(i.a.Component)}}]);try{stManager.done("cmodules/bundles/c6267d4a667cb2c7cb318413c891c7e9.bfc8509cf5e81b49e3f1.js")}catch(e){}