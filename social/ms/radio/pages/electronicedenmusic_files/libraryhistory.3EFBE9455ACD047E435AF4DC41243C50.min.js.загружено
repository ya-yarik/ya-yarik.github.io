/* music */(function(a){var b=context.pfc=="history"||context.pfc=="library"||context.pfc=="queue"?"body":".scroller",c=new Myspace.Scroller(b,{content:".scroller > .infinite",type:"vertical",offset:500},function(){var b=a(".scroller> .infinite"),d=b.data("totalrecords"),e=b.data("nextstart"),f=b.data("nextfetch");d>e?(c.beginLoading(),a.ajax({type:"POST",url:"/ajax"+window.location.pathname+window.location.search,data:{start:e,max:f},success:function(g){c.endLoading();var h=a(g.trim()),i=a(">li",b).length;b.append(h);var j=a(">li",b).length-i;comm.send("page.changed",h);if(window.location.pathname.match(/\/music\/albums$/)){if(!j){b.data("totalrecords",i);return}j=h.first().data("totalrecords")}d==1e4&&j<f&&b.data("totalrecords",j+i),b.data("nextstart",e+f)}}).fail(function(){c.error()})):c.stop()})})(jQuery);
(function(a){function h(){b.removeClass("hide"),c.addClass("hide"),d.hide(),d.find(">ol>li:not(.heading)").remove()}var b=a("#medialist"),c=a("#wrap").find(".noResults"),d=a("#wrap").find(".searchResult"),e=a("#library-search-query, #history-search"),f={},g=!1;a(".upload-audio").on("click",function(){comm.send("location.href","/manage/music")}),a("#clear-history").click(function(b){b.preventDefault(),Myspace.Confirm({text:"Are you sure you want to clear the history?",yes:{text:"Yes",onClick:function(){a.save({type:"POST",url:"/ajax/history/delete",success:function(b){a("#musicQueue").replaceWith('<div class="exception">We cannot find any media in your history. </div>'),a("#sidebar .stats span").html("No Items")}});var b=new Tracking("history","ClearAll")}},no:{text:"No"}})}),a(".table").on("dblclick","li",function(){var b=a(this);b.find(".playBtn")[0].click()}),f.onHide=h,f.url="/ajax"+window.location.pathname+"/search?q="+e.val(),f.onLoading=function(a){b.addClass("hide"),c.addClass("hide"),d.find(">ol>li:not(.heading)").remove(),d.addClass("inprogress").show()},f.onSuccess=function(e){if(!g){var f=new Tracking("librarySongs","Search");g=!0}a.trim(e)!=""?(d.find(">ol>li:not(.heading)").remove(),d.removeClass("inprogress").show(),d.find(">ol").append(e),comm.send("page.changed",d)):(b.addClass("hide"),c.removeClass("hide"),d.find(">ol>li:not(.heading)").remove(),d.hide())},f.onError=function(a){},f.onClear=h;var i=new Myspace.AutocompleteSearchV1(e,f);comm.listen("disconnect",function(b){a("#library .playBtn[data-uid ="+b.uid+"]").closest("li").slideUp()})})(jQuery);
